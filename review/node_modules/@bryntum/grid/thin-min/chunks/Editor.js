/*!
 *
 * Bryntum Grid 5.3.0
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function t(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?e(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}class r{static cacheFlags(e=navigator.platform,t=navigator.userAgent){const n=this;n._isLinux=Boolean(e.match(/Linux/)),n._isMac=Boolean(e.match(/Mac/)),n._isWindows=Boolean(e.match(/Win32/)),n._isWebkit=Boolean(t.match(/WebKit/)&&!t.match(/Edg/)),n._firefoxVersion=n.getVersion(t,/Firefox\/(\d+)\./),n._isFirefox=n._firefoxVersion>0,n._chromeVersion=n.getVersion(t,/Chrom(?:e|ium)\/(\d+)\./),n._isChrome=n._chromeVersion>0,n._isSafari=Boolean(t.match(/Safari/))&&!n._isChrome,n._isMobileSafari=Boolean(t.match(/Mobile.*Safari/)),n._safariVersion=n.getVersion(t,/Version\/(.*).Safari/),n._isAndroid=Boolean(t.match(/Android/g))}static get supportsOverflowClip(){if(null==this._supportsOverflowClip){const e=document.createElement("div");e.style.overflow="clip",e.style.display="none",document.documentElement.appendChild(e),this._supportsOverflowClip="clip"===e.ownerDocument.defaultView.getComputedStyle(e).getPropertyValue("overflow"),e.remove()}return this._supportsOverflowClip}static get supportsSticky(){return!0}static getVersion(e,t){const n=e.match(t);return n?parseFloat(n[1]):0}static get isTouchDevice(){return void 0===this._isTouchDevice&&(this._isTouchDevice=globalThis.matchMedia("(pointer:coarse)").matches),this._isTouchDevice}static get isHoverableDevice(){return void 0===this._isHoverableDevice&&(this._isHoverableDevice=globalThis.matchMedia("(any-hover: hover)").matches),this._isHoverableDevice}static get isBrowserEnv(){return"undefined"!=typeof window}static get isMac(){return this._isMac}static get isWindows(){return this._isWindows}static get isLinux(){return this._isLinux}static get isAndroid(){return this._isAndroid}static get isWebkit(){return this._isWebkit}static get isChrome(){return this._isChrome}static get chromeVersion(){return this._chromeVersion}static get isFirefox(){return this._isFirefox}static get firefoxVersion(){return this._firefoxVersion}static get isSafari(){return this._isSafari}static get safariVersion(){return this._safariVersion}static get isMobileSafari(){return this._isMobileSafari}static get platform(){const e=this;return e._isLinux?"linux":e._isMac?"mac":e._isWindows?"windows":e._isAndroid?"android":e._isMobileSafari?"ios":null}static get supportsPassive(){return!0}static get supportsRandomUUID(){if(void 0===this._supportsRandomUUID)try{this._supportsRandomUUID=Boolean(globalThis.crypto.randomUUID().length>0)}catch(e){this._supportsRandomUUID=!1}return this._supportsRandomUUID}static get storageAvailable(){let e,t;try{return e=localStorage,t="__storage_test__",e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}static setLocalStorageItem(e,t){this.storageAvailable&&localStorage.setItem(e,t)}static getLocalStorageItem(e){return this.storageAvailable&&localStorage.getItem(e)}static removeLocalStorageItem(e){this.storageAvailable&&localStorage.removeItem(e)}static searchParam(e,t=null,n=document.location.search){const i=new RegExp(`[?&]${e}=?([^&]*)`),r=n.match(i);return r&&r[1]||t}static getCookie(e){const t=encodeURIComponent(e)+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let i=n[e];for(;" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return""}static download(e,t){const n=document.createElement("a");n.download=e,n.href=t||e,n.style.cssText="display:none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}static downloadBlob(e,t){const n=globalThis.URL.createObjectURL(e);this.download(t,n),globalThis.URL.revokeObjectURL(n)}static get queryString(){var e;const t=new URL(globalThis.location.href).searchParams;return null===(e=Object.fromEntries)||void 0===e?void 0:e.call(Object,t.entries())}static copyToClipboard(e){let t=!0;const n=document.createElement("textarea");n.value=e,n.style.height=n.style.width=0,document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(e){t=!1}return n.remove(),t}static isBryntumOnline(e){var t;return e=Array.isArray(e)?e:[e],Boolean(/^(www\.)?bryntum\.com/.test(globalThis.location.host)||(null===(t=e)||void 0===t?void 0:t.some((e=>null!=this.queryString[e]))))}static get isCSP(){const{bryntum:e,document:t}=globalThis;return null==e.CSP&&(e.CSP=Boolean(t.querySelector('meta[http-equiv="Content-Security-Policy"]'))),e.CSP}static async setupClipboard(){return window.bryntum.clipboard||(window.bryntum.clipboard={hasNativeAccess:!0,async writeText(e,t){if(t&&this.hasNativeAccess)try{await navigator.clipboard.writeText(e)}catch(e){this.hasNativeAccess=!1}this._content=e},async readText(e){if(e&&this.hasNativeAccess)try{return await navigator.clipboard.readText()}catch(e){this.hasNativeAccess=!1}return this._content}}),window.bryntum.clipboard}static async writeToClipboard(e,t=!0){const n=await this.setupClipboard();return await n.writeText(e,t)}static async readFromClipboard(e=!0){const t=await this.setupClipboard();return await t.readText(e)}}let s,o,l,a;n(r,"supportsPointerEvents",Boolean(globalThis.PointerEvent||globalThis.MSPointerEvent)),n(r,"supportsPointerEventConstructor","undefined"!=typeof PointerEvent),r.isBrowserEnv&&r.cacheFlags(),r._$name="BrowserHelper";const c=/([a-z])([A-Z])/g,d=/[\n\r]/g,u=/[.*+?^${}()|[\]\\]/g,h=/[&<]/,g=/(^[^a-z]+[^\w]+)/gi,m=/\s+/,p=/^[^a-z]+|[^\w:.-]+/gi,f=(e,t)=>o[t.toLowerCase()]||String.fromCharCode(parseInt(t.substr(2),10)),v=(e,t)=>s[t],y=(e,t,n)=>`${t}-${n.toLowerCase()}`,b=(e,t,n)=>`${t} ${n.toLowerCase()}`,C=e=>e?`_x${[...e].map((e=>e.charCodeAt(0).toString(16))).join("")}`:"__blank__",w={},E={};class S{static capitalize(e){return e&&e[0].toUpperCase()+e.substr(1)}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substr(1)}static hyphenate(e){const t=w[e];return t||(w[e]=e.replace(c,y))}static separate(e){const t=E[e];return t||(E[e]=this.capitalize(e.replace(c,b)))}static createId(e){return String(e).replace(g,C)}static makeValidDomId(e,t=""){return null==e?null:String(e).replace(p,t)}static escapeRegExp(e,t){let n=e.replace(u,"\\$&");return void 0!==t&&(n=new RegExp(n,t)),n}static decodeHtml(e){return e&&String(e).replace(a,f)}static encodeHtml(e=""){return e&&String(e).replace(l,v)}static encodeHtmlBR(e){var t;return null===(t=S.encodeHtml(e))||void 0===t?void 0:t.replace(d,"<br>")}static isHtml(e){return"string"==typeof e&&h.test(e||"")}static initHtmlEntities(e){e=e||{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};const t=Object.keys(e);s=e,o=t.reduce(((t,n)=>(t[e[n]]=n,t)),{}),l=new RegExp(`([${t.map((e=>"[-]".includes(e)?"\\"+e:e)).join("")}])`,"g"),a=new RegExp(`(${Object.values(e).join("|")}|&#[0-9]+;)`,"ig")}static safeJsonParse(e){let t=null;try{t=JSON.parse(e)}catch(e){}return t}static safeJsonStringify(e,t=null,n=null){let i=null;try{i=JSON.stringify(e,t,n)}catch(e){}return i}static joinPaths(e,t="/"){return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}static split(e,t=m){let n=e;return"string"==typeof n&&(n=e.trim(),n=n?n.split(t):[]),n}static xss(e,...t){const n=[];let i=t.length;for(n[i]=e[i];i-- >0;)n[i]=e[i]+S.encodeHtml(t[i]);return n.join("")}static xssBR(e,...t){const n=[];let i=t.length;for(n[i]=e[i];i-- >0;)n[i]=e[i]+S.encodeHtmlBR(t[i]);return n.join("")}static toJavaScriptValue(e,t){const n=L.typeOf(e);if("boolean"===n||"string"===n||"number"===n||null===e)return S.safeJsonStringify(e);if(e===globalThis)return"window";if("date"===n)return`new Date(${e.getFullYear()}, ${e.getMonth()}, ${e.getDate()}, ${e.getHours()}, ${e.getMinutes()}, ${e.getSeconds()}, ${e.getMilliseconds()})`;if("array"===n)return`[${e.map((e=>S.toJavaScriptValue(e,t)))}]`;if("object"===n||"instance"===n)return this.toJavaScriptString(e,t);if("function"===n){let t=e.toString();return t.match(/^async (\w+?)\(/)?t=t.replace(/^async (\w+?)\(/,"async function("):!t.startsWith("async(")&&t.match(/^(\w+?)\(/)&&(t=t.replace(/^(\w+?)\(/,"function(")),t}return"class"===n?e.toJavaScriptValue?e.toJavaScriptValue(t):Object.prototype.hasOwnProperty.call(e,"$name")?e.$name:e.name:void 0}static toJavaScriptString(e,n={}){var i;const r=null!==(i=n.level)&&void 0!==i?i:0;return"{\n"+Object.keys(e).map((i=>" ".repeat(2*(r+1))+(i.match(/[- *]/)?`"${i}"`:i)+`: ${S.toJavaScriptValue(e[i],t(t({},n),{},{level:r+1}))}`)).join(",\n")+"\n"+" ".repeat(2*r)+"}"}static encodeAttributeSelector(e,t){return`[${e}="${String(t).replace(/["\\]/g,"\\$&")}"]`}static generateUUID(){var e;return r.supportsRandomUUID?globalThis.crypto.randomUUID():null!==(e=globalThis.crypto)&&void 0!==e&&e.getRandomValues?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^globalThis.crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))):`${Date.now()}-${++S.fakeNodeUUIDIndex}`}}n(S,"fakeNodeUUIDIndex",0),S.initHtmlEntities(),S._$name="StringHelper";const{hasOwnProperty:T,toString:x}=Object.prototype,{isFrozen:D}=Object,O=/\s*<\s*/,M=/\s*>\s*/,I={},F={},k=Object.freeze({});class L{static assign(e,...t){for(let n,i,r=0;r<t.length;r++)if(n=t[r],n)for(i in n)e[i]=n[i];return e}static assignIf(e,...t){for(let n,i,r=0;r<t.length;r++)if(n=t[r],n)for(i in n)i in e&&void 0!==e[i]||(e[i]=n[i]);return e}static blend(e,t,n){n=n||I,e=e||{};const{clone:i=L.clone,merge:r=L.blend}=n;if(Array.isArray(t)){if(t.length>1)return t.forEach((t=>{e=L.blend(e,t,n)})),e;t=t[0]}if(t){let s,o,l;for(o in t)l=t[o],l&&L.isObject(l)&&(s=e[o],n.key=o,s&&L.isObject(s)?(D(s)&&(e[o]=s=i(s,n)),l=r(s,l,n)):l=D(l)?l:i(l,n)),e[o]=l}return e}static clone(e,t){let n,i=e;if(e&&"object"==typeof e){if(t&&"object"==typeof t&&t&&(t=null),L.isObject(e))if(e.skipClone)i=e;else for(n in i={},e)i[n]=L.clone(e[n]);else if(Array.isArray(e))for(i=[],n=e.length;n-- >0;)i[n]=L.clone(e[n]);else L.isDate(e)?i=new Date(e.getTime()):t&&(i=t(e))}return i}static createTruthyKeys(e){const t=S.split(e),n=t&&{};if(t)for(const e of t)e&&(n[e]=!0);return n}static getPath(e,t){return t.split(".").reduce(((e,t)=>(e||k)[t]),e)}static getPathDefault(e,t,n){const i=Array.isArray(t)?t:"string"==typeof t?t.split("."):[t],r=i.length-1;return i.reduce(((e,t,i)=>(n&&!(t in e)&&(e[t]=i===r?n:{}),(e||k)[t])),e)}static hasPath(e,t){return t.split(".").every((t=>t in e&&(e=e[t],!0)))}static getTruthyKeys(e){const t=[];for(const n in e)e[n]&&t.push(n);return t}static getTruthyValues(e){const t=[];for(const n in e)e[n]&&t.push(e[n]);return t}static isClass(e){var t;return"function"==typeof e&&(null===(t=e.prototype)||void 0===t?void 0:t.constructor)===e}static isDate(e){return Boolean(null==e?void 0:e.getUTCDate)&&"date"===L.typeOf(e)}static isPromise(e){if(Promise&&Promise.resolve)return Promise.resolve(e)===e||"function"==typeof(null==e?void 0:e.then);throw new Error("Promise not supported in your environment")}static isEmpty(e){if(e&&"object"==typeof e)for(const t in e)return!1;return!0}static isObject(e){const t=null==e?void 0:e.constructor;return Boolean(t?t===Object||t.getPrototypeOf&&t.prototype&&!Object.getPrototypeOf(t.prototype):e&&"object"==typeof e)}static isInstantiated(e){return!!e&&("object"==typeof e&&!L.isObject(e))}static merge(e,...t){return L.blend(e,t)}static mergeItems(e,t,n){let i,r,s,o,l,a,c;n=n||I;const{merge:d=L.blend}=n;if(e=e||{},Array.isArray(t))t.forEach((t=>{e=L.mergeItems(e,t,n)}));else if(t)for(l in t)if(c=t[l],i=null,l.includes(">")?([l,i]=l.split(M),r=0):l.includes("<")&&([i,l]=l.split(O),r=1),l in e)c&&e[l]&&d&&(n.key=l,c=d(e[l],c,n)),e[l]=c;else if(i){if(!o){o=new Map,s=0;for(const t in e)o.set(t,s++)}if(s=o.get(i),e[l]=c,null==s&&r)s=o.size;else{a=a||[],s=(s||0)+r;for(const e of o){const[t,n]=e;s<=n&&(a&&(a[o.size-n-1]=t),o.set(t,n+1))}if(a)for(;a.length;){const t=a.pop(),n=e[t];delete e[t],e[t]=n}}o.set(l,s)}else{var u;e[l]=c,null===(u=o)||void 0===u||u.set(l,o.size)}return e}static setPath(e,t,n){return t.split(".").reduce(((e,t,i,r)=>i===r.length-1?e[t]=n:(e[t]instanceof Object||(e[t]={}),e[t])),e),e}static typeOf(e){let t,n;return null===e?n="null":e!=e?n="nan":(n=typeof e,"object"===n?e.isBase?n="instance":Array.isArray(e)?n="array":(n=F[t=x.call(e)])||(F[t]=n=t.slice(8,-1).toLowerCase()):"function"===n&&e.isBase&&(n="class")),n}}Object.defineProperty(L,"hasOwn",{value:Object.hasOwn||((e,t)=>T.call(e,t))}),L._$name="Objects";class A{static setVersion(e,t){e=e.toLowerCase(),$[e]={version:t,isNewerThan:e=>A.semanticCompareVersion(e,t,"<"),isOlderThan:e=>A.semanticCompareVersion(e,t,">")};let n="";"undefined"!=typeof productName&&(n=productName);const i=`${n}.${e}${t.replace(/\./g,"-")}`;if(r.isBrowserEnv&&!globalThis.bryntum.silenceBundleException)if(!0===globalThis.bryntum[i]){if(!this.isTestEnv){let t=n||e;"core"===t&&(t="grid");let i=S.capitalize(t);throw"schedulerpro"===t&&(i="SchedulerPro"),new Error(`The Bryntum ${i} bundle was loaded multiple times by the application.\n\nCommon reasons you are getting this error includes:\n\n* Imports point to different types of the bundle (e.g. *.module.js and *.umd.js)\n* Imports point to both sources and bundle\n* Imports do not use the shortest relative path, JS treats them as different files\n* Cache busters differ between imports, JS treats ${t}.module.js?1 and ${t}.module.js?2 as different files\n* Imports missing file type, verify they all end in .js\n\nSee https://bryntum.com/products/${t}/docs/guide/${i}/gettingstarted/es6bundle#troubleshooting for more information\n\n`)}globalThis.BUNDLE_EXCEPTION=!0}else globalThis.bryntum[i]=!0}static getVersion(e){if(e=e.toLowerCase(),!$[e])throw new Error("No version specified! Please check that you import VersionHelper correctly into the class from where you call `deprecate` function.");return $[e].version}static semanticCompareVersion(e,t,n="="){t=t||"";const i=(e=e||"").split(/[-.]/),r=t.split(/[-.]/),s=n.includes("<"),o=(e,t)=>{const n=["rc","beta","alpha"],i=e.map((e=>{if(n.includes(e))return-n.indexOf(e)-2;const t=Number.parseInt(e);return Number.isNaN(t)?-n.length:t}));for(;i.length<t;)i.push(-1);return i},l=()=>{const e=Math.max(i.length,r.length),t=o(i,e),n=o(r,e);for(let i=0;i<e;i++)if(t[i]!==n[i])return s?t[i]<n[i]:t[i]>n[i];return!0};switch(n){case"=":return e===t;case"<=":case">=":return e===t||l();case"<":case">":return e!==t&&l()}return!1}static checkVersion(e,t,n){return A.semanticCompareVersion($.getVersion(e),t,n)}static deprecate(e,t,n){if(!$.checkVersion(e,t,"<"))throw new Error(`Deprecated API use. ${n}`);console.warn(`Deprecation warning: You are using a deprecated API which will change in v${t}. ${n}`)}static get isTestEnv(){var e;const t=Boolean(null===(e=globalThis.bryntum)||void 0===e?void 0:e.isTestEnv);try{var n,i;return t||Boolean(null===(n=globalThis.parent)||void 0===n||null===(i=n.bryntum)||void 0===i?void 0:i.isTestEnv)}catch(e){return t}}static get isDebug(){return!1}}const $=A;r.isBrowserEnv&&($.isTestEnv&&(r._isHoverableDevice=!0),globalThis.bryntum=Object.assign(globalThis.bryntum||{},{getVersion:$.getVersion.bind($),checkVersion:$.checkVersion.bind($),deprecate:$.deprecate.bind($),license:"%LICENSE%"})),A._$name="VersionHelper";const{defineProperty:R,getOwnPropertyDescriptor:P}=Reflect,{hasOwnProperty:_,toString:N}=Object.prototype,j=Symbol("instanceProperties"),V=Symbol("configuring"),z=Symbol("lazyConfigValues"),B=N.call(new Date),W=/\s+/,H=(e,t)=>(e[t]=1,e);class U{static get(e,t){const{cache:n}=this,i=n[e]||(n[e]=new U(e));let r,s=i;return t&&(r=U.makeCacheKey(e,t),(s=r&&n[r])||(s=i.extend(t),r&&(n[r]=s))),s}constructor(e){const t=this,n=e[0].toUpperCase()+e.substr(1);t.base=t,t.name=e,t.field="_"+e,t.capName=n,t.changer="change"+n,t.initializing="initializing"+n,t.updater="update"+n}get descriptor(){let e=this._descriptor;return e&&_.call(this,"_descriptor")||(this._descriptor=e=this.makeDescriptor()),e}get initDescriptor(){let e=this._initDescriptor;return e&&_.call(this,"_initDescriptor")||(this._initDescriptor=e=this.makeInitter()),e}equal(e,t){return e===t}extend(e){const t=Object.assign(Object.create(this),e),{equal:n,merge:i}=e,{equalityMethods:r}=U;return"string"==typeof n&&(n.endsWith("[]")?t.equal=U.makeArrayEquals(r[n.substr(0,n.length-2)]):t.equal=r[n]),"string"==typeof i&&(t.merge=U.mergeMethods[i]),t}define(e){const t=P(e,this.name);let n=this.descriptor;t&&t.get&&(n=Object.assign({},n),n.get=t.get),R(e,this.name,n)}defineInitter(e,t){const{name:n}=this,i=e[j];let r,s;i[n]||!(s=P(e,n))||"value"in s||(i[n]=s),R(e,n,this.initDescriptor),this.lazy&&(r=e[z]||(e[z]=new Map),r.set(n,t))}static makeArrayEquals(e){return(t,n)=>{let i,r=t&&n&&t.length===(i=n.length);if(r&&Array.isArray(t)&&Array.isArray(n))if(e)for(;r&&i-- >0;)r=e(t[i],n[i]);else for(;r&&i-- >0;)r=t[i]===n[i];else r=e?e(t,n):t===n;return r}}static makeCacheKey(e,t){const n=Object.keys(t).sort();for(let e,i,r,s=n.length;s-- >0;)if(r=t[e=n[s]],null==r&&!1===r)n.splice(s,1);else{if(i=typeof r,"function"===i)return null;"string"===i?n[s]=`${e}:"${r}"`:"number"===i&&(n[s]=`${e}:${r}`)}return n.length?`${e}>${n.join("|")}`:e}makeDescriptor(){const e=this,{base:t,field:n,changer:i,updater:r,name:s}=e;return t!==e&&t.equal===e.equal?t.descriptor:{get(){var e;return null===(e=this.configObserver)||void 0===e||e.get(s,this),this[n]},set(t){const o=this;let l,a,c=o[n];if("string"==typeof t){let e=t;var d;if(t.startsWith("up."))e=null===(d=o.owner)||void 0===d?void 0:d.resolveProperty(t.substr(3));else t.startsWith("this.")&&(e=o.resolveProperty(t.substr(5)));void 0!==e&&"function"!=typeof e&&(t=e)}var u;(o[i]&&(l=void 0===(a=o[i](t,c)),l||(t=a,c=o[n])),l||(e.equal===Y?c===t:e.equal(c,t)))||(o[n]=t,l=!0,null===(u=o[r])||void 0===u||u.call(o,t,c));l&&!o.onConfigChange.$nullFn&&o.onConfigChange({name:s,value:t,was:c,config:e})}}}makeInitter(){const e=this;return e!==e.base?e.lazy?e.makeLazyInitter():e.base.initDescriptor:e.makeBasicInitter()}makeBasicInitter(){const e=this,{initializing:t,name:n}=e;return{configurable:!0,get(){const i=this;return e.removeInitter(i),i[t]=!0,i[n]=i[V][n],i[t]=!1,i.configDone[n]=!0,i[n]},set(t){e.removeInitter(this),this.configDone[n]=!0,this[n]=t}}}makeLazyInitter(){const e=this,{initializing:t,name:n}=e;return{configurable:!0,get(){const i=this,r=i[z].get(n);return e.removeInitter(i),i.isDestroying||(i[t]=!0,i[n]=r,i[t]=!1),i[n]},set(t){e.removeInitter(this),this[n]=t}}}removeInitter(e){const{name:t}=this,n=e[j][t],i=e[z];n?R(e,t,n):delete e[t],null!=i&&i.delete(t)&&!i.size&&delete e[z]}setDefault(e,t){R(e.prototype,this.field,{configurable:!0,writable:!0,value:t})}merge(e,t){if(t&&e&&L.isObject(e)){if(t.isBase)return t.setConfig(e);L.isObject(t)&&(e=L.merge(L.clone(t),e))}return e}}const{prototype:q}=U,{equal:Y}=q;U.symbols={configuring:V,instanceProperties:j,lazyConfigs:z},U.cache=Object.create(null),U.equalityMethods={array:U.makeArrayEquals(),date:(e,t)=>e===t||!(!e||!t||N.call(e)!==B||N.call(t)!==B)&&e.getTime()===t.getTime(),strict:U.equal=Y},U.mergeMethods={distinct(e,t){let n=t?t.slice():[];if(null!=e)if(L.isObject(e))if(void 0===t)n=e;else{let t,i;for(t in e)i=n.indexOf(t),e[t]?i<0&&n.push(t):i>-1&&n.splice(i,1)}else Array.isArray(e)?e.forEach((e=>!n.includes(e)&&n.push(e))):n.includes(e)||n.push(e);return n},merge:U.merge=q.merge,classList(e,t){if("string"==typeof e){if(!e.length)return t;e=e.split(W)}return Array.isArray(e)&&(e=e.reduce(H,{})),U.merge(e,t)},objects:(e,t)=>!0===e?t||{}:U.merge(e,t),replace:e=>e,items:(e,t,n,i)=>i?L.mergeItems(t,e,{merge:(e,t)=>q.merge(t,e)}):q.merge(e,t)},Object.assign(q,{_descriptor:null,_initDescriptor:null,lazy:!1,nullify:!1,render:!1}),U._$name="Config";class K{constructor(e){e&&Object.assign(this,e)}getInherited(e,t=!0){let n=this[e];var i;e in this||(n=null===(i=this.super)||void 0===i?void 0:i.getInherited(e,t),(n||t)&&(this[e]=n=Object.create(n||null)));return n}}const{getPrototypeOf:G}=Object,{hasOwn:X}=L,{defineProperty:J}=Reflect,Z=Symbol("classMetaData"),Q=Symbol("mixinTag"),ee=Symbol("originalConfig"),te=U.symbols.configuring,ne=U.symbols.instanceProperties,ie=U.symbols.lazyConfigs,re={merge:"replace",simple:!0},se=()=>{},oe=e=>new K(e),le={},ae=Object.freeze({}),ce=Object.freeze([]);class de{static get isBase(){return!0}get isBase(){return!0}static get declarable(){return["declarable","configurable","defaultConfig","properties","prototypeProperties"]}constructor(...e){const t=this,n=t.constructor;t.$meta.class!==n&&n.$meta,t.construct(...e),t.afterConstruct(),t.isConstructing=!1}static new(...e){return new this((e=e.filter((e=>e))).length>1?this.mergeConfigs(...e):e[0])}construct(...e){null!==e[0]&&this.configure(...e),this.afterConfigure()}static destroy(...e){const t=e=>{null!=e&&e.destroy?e.destroy():Array.isArray(e)&&e.forEach(t)};t(e)}destroy(){const e=this,{id:t}=e;e.isDestroying=!0,e.destroy=se,e.doDestroy(),Object.setPrototypeOf(e,null);for(const t in e)"destroy"!==t&&"isDestroying"!==t&&delete e[t];delete e[ee],e.isDestroyed=!0,e.id=t}_thisIsAUsedExpression(e){}static get $$name(){return X(this,"$name")&&this.$name||X(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}startConfigure(e){}finishConfigure(e){}afterConfigure(){}afterConstruct(){}callback(e,t,n=ce){const{handler:i,thisObj:r}=this.resolveCallback(e,"this"===t?this:t)||ae;return null==i?void 0:i.apply(r,n)}resolveProperty(e){let t=this;for(;t;){if(L.hasPath(t,e))return L.getPath(t,e);t=t.owner}}resolveCallback(e,t=this,n=!0){var i;if(null!==(i=e)&&void 0!==i&&i.substring){if(e.endsWith("?")&&(n=!1,e=e.substring(0,e.length-1)),e.startsWith("up.")){for(e=e.substring(3),t=this.owner;t&&!t[e];t=t.owner);if(!t)return}else e.startsWith("this.")&&(e=e.substring(5),t=this);if(!(t&&t instanceof Object))return;e=t[e]}if("function"==typeof e)return{handler:e,thisObj:t};if(n)throw new Error(`No method named ${e} on ${t.$$name||"thisObj object"}`)}bindCallback(e,t=this){if(e){const{handler:n,thisObj:i}=this.resolveCallback(e,t);if(n)return n.bind(i)}}delay(e,t,n=e.name||e){e=this.setTimeout?e:e.bind(this);return(this.setTimeout?this:globalThis)["number"==typeof t?"setTimeout":"requestAnimationFrame"](e,t,n)}doDestroy(){const e=this,{nullify:t}=e.$meta;if(t)for(let n=0;n<t.length;++n)null!=e[t[n].field]&&(e[t[n].name]=null)}destroyProperties(...e){const t=this;let n,i;for(n of e){var r;if(n in t&&(!t[te]||!t[te][n]))i=t[n],null!==(r=i)&&void 0!==r&&r.destroy&&i.destroy(),delete t[n]}}configure(e={}){const t=this,n=t.$meta,{beforeConfigure:i}=e,r=n.configs,s=t.getDefaultConfiguration();let o,l,a;for(l in t.initialConfig=e,t.isConfiguring=!0,Object.assign(t,t.getProperties()),e)a=e[l],o=r[l],s[l]=o?o.merge(a,s[l],null,n):a;i&&(delete s.beforeConfigure,i(t,s)),t.setConfig(t[ee]=s,!0),t.isConfiguring=!1}getConfig(e){return this[e]}setConfig(e,t){const n=this,i=n[te],r=i?n.configDone:n.configDone={},s=n.$meta.configs;let o,l;for(l in n[ne]={},n[te]=i?Object.setPrototypeOf(Object.assign({},e),i):e,e)null!=e[l]||X(e,l)?(o=s[l]||U.get(l),o.defineInitter(n,e[l]),t||(r[l]=!1)):r[l]=!0;for(l in t&&n.startConfigure(e),e){var a;r[l]||null!==(a=s[l])&&void 0!==a&&a.lazy||(n[l]=e[l])}return i?n[te]=i:delete n[te],t&&n.finishConfigure(e),n}hasConfig(e){var t;const n=this,i=n[te];return Boolean(null!=n["_"+e]||null!=(null===(t=n[ie])||void 0===t?void 0:t.get(e))||!n.configDone[e]&&i&&(null!=i[e]||X(i,e)))}peekConfig(e){const t=this,n=t[ie],i=t[te];return null!=n&&n.has(e)?n.get(e):t.configDone[e]?t[e]:null!=(null==i?void 0:i[e])||X(i,e)?i[e]:void 0}triggerConfig(e){const t=this,{configDone:n}=t,i=t[ie],r=t[te],s=null!=i&&i.has(e)||r&&(null!=r[e]||X(r,e))?!n[e]:null;return s&&t.getConfig(e),s}triggerConfigs(e){const t=this,n=t.$meta.configs,i=t[ie],r=i?[...i.keys()].filter((t=>n[t].lazy===e)):ce;for(const e of r)t.triggerConfig(e);return r.length?r:null}onConfigChange(){}get config(){const e={},t=this[ee];for(const n in t)e[n]=t[n];return e}static processConfigValue(e,t){if(e===globalThis)return globalThis;if(Array.isArray(e))return e.map((e=>de.processConfigValue(e,t)));if(e instanceof de){if(t.visited.has(e))return;return e.getCurrentConfig(t)}if(e instanceof HTMLElement||e instanceof DocumentFragment)return null;if(L.isObject(e)){const n={};for(const i in e)n[i]=de.processConfigValue(e[i],t);return n}return e}getConfigValue(e,t){var n;const i=this,r=i[ie];return null!==(n=i.$meta.configs[e])&&void 0!==n&&n.lazy?null!=r&&r.has(e)?de.processConfigValue(r.get(e),t):void 0:de.processConfigValue(i[e],t)}preProcessCurrentConfigs(){}getCurrentConfig(e={}){const n=this,i="all"===e.configs?n.config:L.clone(n.initialConfig),r=e.visited||(e.visited=new Set),s=e.depth||(e.depth=0),o={};if(!r.has(n)){r.add(n),this.preProcessCurrentConfigs(i);for(const r in i){const i=n.getConfigValue(r,t(t({},e),{},{depth:s+1}));void 0!==i&&(o[r]=i)}return o}}getConfigString(e={}){return S.toJavaScriptString(this.getCurrentConfig(e))}getTestCase(e={}){const t=this.isGantt?"Gantt":this.isSchedulerPro?"SchedulerPro":this.isCalendar?"Calendar":this.isScheduler?"Scheduler":this.isGrid?"Grid":this.isTaskBoard?"TaskBoard":null;if(t){const n=t.toLowerCase(),i=`../../build/${n}.module.js`;let r,s;"static"===e.import?(r=`import * as module from "${i}";Object.assign(window, module);`,s=""):(r=`import("${i}").then(module => { Object.assign(window, module);\n`,s="});");const o=A.getVersion(n);return o&&(r+=`\nconsole.log('${t} ${o}');\n`),`${r}      \nconst ${n} = new ${t}(${this.getConfigString(e)});\n${s}`}}downloadTestCase(e={}){e.output="return";const t=this.getTestCase(e);r.download("app.js","data:application/javascript;charset=utf-8,"+escape(t))}static initClass(){return this.$meta.class}static get $meta(){const e=this;let t=e[Z];return X(e,Z)||(e[Z]=t=oe(),t.class=e,e.setupClass(t)),t}static onClassMixedIn(){}static mergeConfigs(e,...t){const n=this.$meta.configs,i=L.clone(e)||{};let r,s,o,l;for(s=0;s<t.length;++s)if(r=t[s],r)for(o in r)l=r[o],n[o]?l=n[o].merge(l,i[o]):i[o]&&l&&(l=U.merge(l,i[o])),i[o]=l;return i}static mixin(...e){let t,n=this;for(t=0;t<e.length;++t){const i=e[t],r=i[Q]||(i[Q]=Symbol("mixinTag"));n[r]||(n=i(n),n[r]=!0,X(n,"onClassMixedIn")&&n.onClassMixedIn())}return n}static setupClass(e){var t;const n=e.class,i=G(n).$meta,r=n.$$name,s=i.names,o=n.prototype;if(J(o,"$meta",{value:e}),Object.assign(e,{super:i,config:Object.create(i.config),configs:Object.create(i.configs),declarables:i.declarables,forkConfigs:i.forkConfigs,hierarchy:Object.freeze([...i.hierarchy,n]),names:s.includes(r)?s:Object.freeze([...s,r]),properties:i.properties,nullify:null===(t=i.nullify)||void 0===t?void 0:t.slice()}),s!==e.names){const e=`is${r}`,t=t=>{X(t,e)||J(t,e,{get:()=>(X("object"==typeof t?t.constructor:t,"$name")||console.warn(`$name static property or getter required for class ${r} to provide class name for minified sources.`+(A.isTestEnv?"":"\nhttps://bryntum.com/products/grid/docs/api/Core/widget/Widget#property-$name-static")),!0)})};t(o),t(n)}for(let t,i,r=0;r<e.declarables.length;++r)t=e.declarables[r],X(n,t)&&(i=le[t]||(le[t]=`setup${S.capitalize(t)}`),n[i](n,e))}static setupConfigs(e,t,n){const i=e.config,r=e.configs,s=e.class,o=e.super;let l,a,c,d,u,h,{nullify:g}=e;for(const m in t)u=t[m],n?(l=r[m])?u=l.merge(u,i[m],e,o):l=U.get(m,re):(a=c=d=void 0,u&&"object"==typeof u&&"$config"in u&&(c=u.$config,c&&!L.isObject(c)&&(c=L.createTruthyKeys(c)),d="default"in u,a=d?u.default:a,u=u.value),(l=r[m])?(h=l.nullify,c&&(l=l.extend(c)),u=l.merge(u,i[m],e,o)):(l=U.get(m,c),l.define(s.prototype),d=!(l.field in s.prototype),h=!1),d&&l.setDefault(s,a),l.nullify&&!h&&(g||(g=e.nullify||(e.nullify=[]))).push(l)),u&&(L.isObject(u)||Array.isArray(u))&&!Object.isFrozen(u)&&(e.forkConfigs=!0),r[m]=l,i[m]=u}static setupConfigurable(e,t){e.setupConfigs(t,e.configurable,!1)}static setupDefaultConfig(e,t){e.setupConfigs(t,e.defaultConfig,!0)}static setupDeclarable(e,t){const n=e.declarable;let i,r,s=t.declarables;for(r=0;r<n.length;++r)s.includes(n[r])||(i||(t.declarables=i=s=s.slice()),s.push(n[r]))}static setupProperties(e,t){t.properties=t.super.properties.slice(),t.properties.push(e),Object.freeze(t.properties)}static setupPrototypeProperties(e){Object.assign(e.prototype,e.prototypeProperties)}getDefaultConfiguration(){return this.constructor.getDefaultConfiguration()}static getDefaultConfiguration(){const e=this.$meta,t=e.forkConfigs?de.fork(e.config):Object.create(e.config);if(A.isTestEnv&&r.isBrowserEnv&&t.testConfig&&globalThis.__applyTestConfigs)for(const e in t.testConfig)t[e]=t.testConfig[e];return t}static fork(e){let t,n,i=e;if(e&&L.isObject(e)&&!Object.isFrozen(e))for(t in i=Object.create(e),e)n=e[t],n&&(L.isObject(n)?i[t]=de.fork(n):Array.isArray(n)&&(i[t]=n.slice()));return i}getProperties(){const e=this.$meta.properties,t={};for(let n=0;n<e.length;n++)Object.assign(t,e[n].properties);return t}static get superclass(){return G(this)}classHierarchy(e){const t=this.$meta.hierarchy,n=e?t.indexOf(e):0;return n>0?t.slice(n):t}static isOfTypeName(e){return this.$meta.names.includes(e)}detachListeners(e){var t;let n=this.$detachers;if(n=null===(t=n)||void 0===t?void 0:t[e],n)for(;n.length;)n.pop()()}trackDetacher(e,t){const n=this.$detachers||(this.$detachers={});(n[e]||(n[e]=[])).push(t)}untrackDetachers(e){const t=this.$detachers;if(t)for(const n in t){const i=t[n];for(let t=i.length;t-- >0;)i[t].eventer===e&&i.splice(t,1)}}}const ue=de.prototype;ue.onConfigChange.$nullFn=se.$nullFn=!0,de[Z]=ue.$meta=oe({class:de,config:Object.freeze({}),configs:Object.create(null),declarables:de.declarable,forkConfigs:!1,hierarchy:Object.freeze([de]),names:Object.freeze(["Base"]),nullify:null,properties:Object.freeze([]),super:null}),Object.assign(ue,{$detachers:null,configObserver:null,isConstructing:!0,isDestroyed:!1,isDestroying:!1}),de.emptyFn=se,A.setVersion("core","5.3.0"),de._$name="Base";class he{static clean(e){return e.reduce(((e,t)=>(null==t||Array.isArray(t)&&0===t.length||""===t||e.push(t),e)),[])}static from(e,t,n){const i=[];if(e)for(const r of e)t&&!t(r)||i.push(n?n(r):r);return i}static remove(e,...t){let n,i,r=!1;for(let s=0;s<t.length;s++)i=t[s],-1!==(n=e.indexOf(i))&&(e.splice(n,1),r=!0);return r}static findInsertionIndex(e,t,n=this.lexicalCompare,i){const r=t.length;let s,o;return i<r&&(s=i>0?n(t[i-1],e):0,o=i<r-1?n(e,t[i]):0,s<1&&o<1)?i:this.binarySearch(t,e,n)}static findLast(e,t,n){for(let{length:i}=e,r=i-1;r>=0;r--)if(t.call(n,e[r],r,e))return e[r]}static binarySearch(e,t,n=0,i=e.length,r=this.lexicalCompare){const s=e.length;let o,l;for(n instanceof Function?(r=n,n=0):i instanceof Function&&(r=i,i=s),--i;n<=i;)o=n+i>>1,l=r(t,e[o]),l>=0?n=o+1:l<0&&(i=o-1);return n}magnitudeCompare(e,t){return e<t?-1:e>t?1:0}lexicalCompare(e,t){return(e=String(e))<(t=String(t))?-1:e>t?1:0}static fill(e,t={},n=null){const i=[],r=Array.isArray(t)?t:[t];for(let t=0;t<e;t++)for(const e of r){const r=Object.assign({},e);n&&n(r,t),i.push(r)}return i}static populate(e,t,n=!1){const i=[];for(let r=0;r<e;r++)i.push(t(r+(n?1:0)));return i}static include(e,...t){for(const n of t)e.includes(n)||e.push(n)}static unique(e){return[...new Set(e)]}static allowNegative(e){return new Proxy(e,{get(e,t,n){if("string"!=typeof t)return Reflect.get(e,t,n);const i=Number(t);return Number.isNaN(i)?Reflect.get(e,t,n):e[i<0?e.length+i:i]},set(e,t,n,i){if("string"!=typeof t)return Reflect.set(e,t,n,i);const r=Number(t);return Number.isNaN(r)?Reflect.set(e,t,n,i):(e[r<0?e.length+r:r]=n,!0)}})}static delta(e,t,n=!1){if(!t)return n?{toAdd:e,toRemove:[],toKeep:[]}:{onlyInA:e,onlyInB:[],inBoth:[]};const i=[],r=[],s=new Set,o=new Set(t);for(let t=0;t<e.length;t++){const n=e[t];o.has(n)?s.add(n):i.push(n)}for(let e=0;e<t.length;e++){const n=t[e];s.has(n)||r.push(n)}return n?{toAdd:i,toRemove:r,toKeep:s}:{onlyInA:i,onlyInB:r,inBoth:[...s]}}static asArray(e){return null==e?e:e instanceof Set?Array.from(e):Array.isArray(e)?e:[e]}static identity(e){return e}static keyBy(e,t,n=he.identity){const i="string"==typeof t?e=>null==e?void 0:e[t]:t,r="string"==typeof n?e=>null==e?void 0:e[n]:n;return e.reduce(((e,t)=>(e[i(t)]=r(t),e)),{})}}he._$name="ArrayHelper";const ge=/,\s*/,me=Symbol("decompiled"),pe=/^\s*(async\s+)?([a-z_]\w*)\s*=>([\s\S]+)$/i,fe=/^\s*(async\s*)?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)\s+=>([\s\S]+)$/i,ve=/^(\s*async)?(?:\s*function)?(?:\s*([a-z_]\w*))?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)([\s\S]+)$/i,{hasOwnProperty:ye}=Object.prototype;class be{static after(e,t,n,i,r){const s="string"==typeof n,o=!1!==(null==r?void 0:r.return),l=(...t)=>{const r=l.$nextHook.call(e,...t),a=null!=i&&i.isDestroyed?void 0:o?s?i[n](r,...t):n.call(i,r,...t):s?i[n](...t):n.call(i,...t);return void 0===a?r:a};return be.hookMethod(e,t,l)}static before(e,t,n,i){const r="string"==typeof n,s=(...t)=>{const o=null!=i&&i.isDestroyed?0:r?i[n](...t):n.call(i,...t);return!1===o?o:s.$nextHook.call(e,...t)};return be.hookMethod(e,t,s)}static curry(e){return function t(...n){return n.length>=e.length?e.apply(this,n):function(...e){return t.apply(this,n.concat(e))}}}static bindAll(e){for(const t in e)"function"==typeof e[t]&&(e[t]=e[t].bind(e))}static createInterceptor(e,t,n){return function(...i){const r=n||this;return!1!==t.call(r,...i)&&e.call(r,...i)}}static createSequence(e,t,n){return(...i)=>{const r=e.call(n,...i),s=t.call(n,...i);return void 0===s?r:s}}static createThrottled(e,t,n,i,r){let s,o,l=-Number.MAX_VALUE;const a=()=>{o=0,l=performance.now(),s.push.apply(s,i),e.apply(n,s)},c=function(...e){const c=performance.now()-l;s=e,c>=t?(clearTimeout(o),a()):(o||(o=setTimeout(a,t-c)),r&&(s.push.apply(s,i),r.apply(n,s)))};return c.cancel=()=>clearTimeout(o),c}static createBuffered(e,t,n,i){let r,s;const o=()=>{s=0,l.isPending=!1,r.push.apply(r,i),e.apply(n,r)},l=function(...e){r=e,s&&clearTimeout(s),l.isPending=!0,s=setTimeout(o,t)};return l.cancel=()=>{l.isPending=!1,clearTimeout(s)},l}static decompile(e){if(!(me in e)){var t,n;const i=e.toString();let r,s,o,l,a,c=pe.exec(i);c?(r=[c[2]],s=c[3]):(c=fe.exec(i))?(a=c[2].trim(),r=a?a.split(ge):[],s=c[3]):(c=ve.exec(i))&&(o=c[2],a=c[3].trim(),r=a?a.split(ge):[],s=c[4]),s=null===(t=s)||void 0===t?void 0:t.trim(),e[me]=l=c&&{args:r,async:Boolean(c[1]),body:null!==(n=s)&&void 0!==n&&n.startsWith("{")?s.substring(1,s.length-1).trim():s},o&&(l.name=o)}return e[me]}static hookMethod(e,t,n){return n.$nextHook=e[t],e[t]=n,()=>{if(ye.call(e,t)){let s,o=e[t];var i;if(o===n)(null===(i=Object.getPrototypeOf(e))||void 0===i?void 0:i[t])===n.$nextHook?delete e[t]:e[t]=n.$nextHook;else for(;s=null===(r=o)||void 0===r?void 0:r.$nextHook;o=s){var r;if(s===n){o.$nextHook=n.$nextHook;break}}}}}static noThrow(e,t,n){const i=e[t];e[t]=(...t)=>{try{return i.apply(e,t)}catch(e){return null==n?void 0:n(e)}}}static returnTrue(){return!0}static animate(e,t,n,i="linear"){let r=!1;const s=new Promise((s=>{const o=performance.now(),l=()=>{const a=Math.min((performance.now()-o)/e,1),c=n&&n.setTimeout?n:globalThis;r||!1===t.call(n,this.easingFunctions[i](a))&&s(),r||1===a?c.requestAnimationFrame((()=>s())):c.requestAnimationFrame(l)};l()}));return s.cancel=()=>(r=!0,!1),s}}const Ce=1.70158,we=7.5625,Ee=1.525,Se=2/2.75,Te=2.25/2.75,xe=1/2.75,De=1.5/2.75,Oe=2.5/2.75,Me=2.625/2.75,Ie=.984375;be.easingFunctions={linear:e=>e,easeInQuad:e=>Math.pow(e,2),easeOutQuad:e=>-(Math.pow(e-1,2)-1),easeInOutQuad:e=>(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2),easeInCubic:e=>Math.pow(e,3),easeOutCubic:e=>Math.pow(e-1,3)+1,easeInOutCubic:e=>(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2),easeInQuart:e=>Math.pow(e,4),easeOutQuart:e=>-(Math.pow(e-1,4)-1),easeInOutQuart:e=>(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2),easeInQuint:e=>Math.pow(e,5),easeOutQuint:e=>Math.pow(e-1,5)+1,easeInOutQuint:e=>(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2),easeInSine:e=>1-Math.cos(e*(Math.PI/2)),easeOutSine:e=>Math.sin(e*(Math.PI/2)),easeInOutSine:e=>-.5*(Math.cos(Math.PI*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e)),easeInCirc:e=>-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeOutBounce:e=>e<xe?we*e*e:e<Se?we*(e-=De)*e+.75:e<Oe?we*(e-=Te)*e+.9375:we*(e-=Me)*e+Ie,easeInBack:e=>e*e*((Ce+1)*e-Ce),easeOutBack:e=>(e-=1)*e*((Ce+1)*e+Ce)+1,easeInOutBack:e=>{let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=Ee))*e-t)*.5:.5*((e-=2)*e*((1+(t*=Ee))*e+t)+2)},elastic:e=>-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1,swingFromTo:e=>{let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=Ee))*e-t)*.5:.5*((e-=2)*e*((1+(t*=Ee))*e+t)+2)},swingFrom:e=>e*e*((Ce+1)*e-Ce),swingTo:e=>(e-=1)*e*((Ce+1)*e+Ce)+1,bounce:e=>e<xe?we*e*e:e<Se?we*(e-=De)*e+.75:e<Oe?we*(e-=Te)*e+.9375:we*(e-=Me)*e+Ie,bouncePast:e=>e<xe?we*e*e:e<Se?2-(we*(e-=De)*e+.75):e<Oe?2-(we*(e-=Te)*e+.9375):2-(we*(e-=Me)*e+Ie),easeFromTo:e=>(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2),easeFrom:e=>Math.pow(e,4),easeTo:e=>Math.pow(e,.25)},be._$name="FunctionHelper";const{isArray:Fe}=Array,{hasOwnProperty:ke}=Object.prototype,Le={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,buffer:1,throttle:1,name:1,$internal:1},Ae=(e,t)=>t.prio-e.prio;var $e=e=>class t extends(e||de){constructor(...e){super(...e),n(this,"eventsSuspended",null)}static get $name(){return"Events"}static get declarable(){return["deprecatedEvents"]}static setupDeprecatedEvents(e,t){const n=t.getInherited("deprecatedEvents"),i=e.deprecatedEvents;for(const e in i)n[e.toLowerCase()]=n[e]=i[e]}static get configurable(){return{listeners:{value:null,$config:{merge(e,t){if(null!==e){if(!e)return t;t&&(e=e?[e]:[]).push[Fe(t)?"apply":"call"](e,t)}return e}}},internalListeners:null,bubbleEvents:null}}destroy(){this.trigger("beforeDestroy"),super.destroy()}construct(e,...t){var n;(this.configuredListeners=null===(n=e)||void 0===n?void 0:n.listeners)&&delete(e=L.assign({},e)).listeners,super.construct(e,...t),this.processConfiguredListeners()}processConfiguredListeners(){if(this.configuredListeners){const e=this,{isConfiguring:t}=e;e.isConfiguring=!1,e.listeners=e.configuredListeners,e.configuredListeners=null,e.isConfiguring=t}}doDestroy(){this.trigger("destroy"),this.removeAllListeners(!1),super.doDestroy()}static setupClass(e){super.setupClass(e),t.prototype.onListen.$nullFn=!0,t.prototype.onUnlisten.$nullFn=!0}addListener(e,t,n){if(Fe(e)){for(let n=0,{length:i}=e;n<i;n++)this.addListener(e[n],t);return}const i=this,r=i.$meta.getInherited("deprecatedEvents");if("string"==typeof e)return i.addListener({[e]:t,detachable:!1!==t.detachable,thisObj:n});{t=e.thisObj=void 0!==e.thisObj?e.thisObj:t;for(const n in e)if(!Le[n]&&null!=e[n]){const s=n.toLowerCase(),o=null==r?void 0:r[s],l=i.eventListeners||(i.eventListeners={}),a=e[n],c=a.expires||e.expires,d={fn:"object"==typeof a?a.fn:a,thisObj:void 0!==a.thisObj?a.thisObj:t,args:a.args||e.args,prio:void 0!==a.prio?a.prio:void 0!==e.prio?e.prio:0,once:void 0!==a.once?a.once:void 0!==e.once&&e.once,buffer:a.buffer||e.buffer,throttle:a.throttle||e.throttle,$internal:e.$internal,catchAll:"catchAll"===n};if(o){const{product:e,invalidAsOfVersion:t,message:n}=o;A.deprecate(e,t,n)}if(c){const{alt:r}=c,o=r?c.delay:c,l=e.name||n,a=()=>{i.un(s,d),r&&!d.called&&i.callback(r,t)};i.isDelayable?i.setTimeout({fn:a,name:l,cancelOutstanding:!0,delay:o}):globalThis.setTimeout(a,o)}let u=l[s]||(l[s]=[]);u.$firing&&(l[s]=u=u.slice()),u.splice(he.findInsertionIndex(d,u,Ae,u.length),0,d),!i.onListen.$nullFn&&u.length<2&&i.onListen(s)}e.relayAll&&i.relayAll(e.relayAll),t&&t!==i&&i.attachAutoDetacher(e,t);const n=!1!==e.detachable,o=e.name,l=e.expires||n||o?()=>{i.isDestroyed||i.removeListener(e,t)}:null;var s;if(l)if(l.eventer=i,l.listenerName=o,o&&null!==(s=t)&&void 0!==s&&s.trackDetacher&&t.trackDetacher(o,l),e.expires&&i.delay(l,isNaN(e.expires)?e.expires.delay:e.expires,o),n)return l}}on(e,t,n){return this.addListener(e,t,n)}ion(e){return e.$internal=!0,this.on(e)}un(...e){this.removeListener(...e)}updateInternalListeners(e,t){null==t||t.detach(),e&&(e.detach=this.ion(e))}get listeners(){return this.eventListeners}changeListeners(e){if(!this.isConfiguring){if(Array.isArray(e))for(let t=0,n=e[0],{length:i}=e;t<i;n=e[++t])"thisObj"in n||(e[t]=L.assign({thisObj:this},n));else e&&!("thisObj"in e)&&(e=L.assign({thisObj:this},e));return e}this.getConfig("internalListeners"),e&&this.on(e,this)}updateListeners(e,t){t&&this.un(t),e&&this.on(e)}removeListener(e,t=e.thisObj,n){const i=this;if("string"==typeof e)return i.removeListener({[e]:t},n);Object.entries(e).forEach((([e,n])=>{if(!Le[e]&&null!=n){e=e.toLowerCase();const r=i.eventListeners,s=i.findListener(e,n,t);if(s>=0){let t=r[e];t.length>1?(t.$firing&&(r[e]=t=t.slice()),t.splice(s,1)):(delete r[e],i.onUnlisten.$nullFn||i.onUnlisten(e))}}})),e.thisObj&&!e.thisObj.isDestroyed&&i.detachAutoDetacher(e)}findListener(e,t,n){var i;const r=null===(i=this.eventListeners)||void 0===i?void 0:i[e],s=t.fn||t,o=t.thisObj||n;if(r)for(let e,t=0,{length:n}=r;t<n;t++)if(e=r[t],e.fn===s&&e.thisObj===o)return t;return-1}hasListener(e){var t;return Boolean(null===(t=this.eventListeners)||void 0===t?void 0:t[null==e?void 0:e.toLowerCase()])}relayAll(e,t,n=!0){this.relayAllTargets||(this.relayAllTargets=[]);const i=this.relayAllTargets;e.on({beforeDestroy:({source:t})=>{if(t===e){i.filter((t=>t.through===e)).forEach((e=>he.remove(i,e)))}}}),i.push({through:e,prefix:t,transformCase:n})}removeAllListeners(e=!0){const t=this.eventListeners;let n,i;for(const l in t){const a=t[l];for(n=a.length;n-- >0;){const t=a[n];var r,s,o;if(!t.$internal||!e)this.removeListener(l,t),i=t.thisObj,null===(r=i)||void 0===r||null===(s=(o=r).untrackDetachers)||void 0===s||s.call(o,this)}}}relayEvents(e,t,n=""){const i={detachable:!0,thisObj:this};return t.forEach((e=>{i[e]=(t,...i)=>this.trigger(n+e,t,...i)})),e.on(i)}onListen(){}onUnlisten(){}destructorInterceptor(){const{autoDetachers:e,target:t,oldDestructor:n}=this;for(let n=0;n<e.length;n++){const{dispatcher:i,config:r}=e[n];i.isDestroyed||i.removeListener(r,t)}n.call(t)}attachAutoDetacher(e,t){const n=e.thisObj||t,i="doDestroy"in n?"doDestroy":"destroy";if(i in n){let{$autoDetachers:t}=n;t||(n.$autoDetachers=t=[]),n.$oldDestructor||(n.$oldDestructor=n[i],n[i]=this.destructorInterceptor.bind({autoDetachers:t,oldDestructor:n.$oldDestructor,target:n})),t.push({config:e,dispatcher:this})}else n[i]=()=>{this.removeListener(e)}}detachAutoDetacher(e){const t=e.thisObj;t.$oldDestructor&&!t.isDestroying&&(he.remove(t.$autoDetachers,t.$autoDetachers.find((t=>t.config===e&&t.dispatcher===this))),t.$autoDetachers.length||(t["doDestroy"in t?"doDestroy":"destroy"]=t.$oldDestructor,t.$oldDestructor=null))}await(e,t={checkLog:!0,resetLog:!0,args:null}){const n=this;!1===t&&(t={checkLog:!1});const{args:i}=t;return new Promise((r=>{var s;if(t.checkLog&&null!==(s=n._triggered)&&void 0!==s&&s[e]&&(r(),t.resetLog&&n.clearLog(e)),i){const s=n.on({[e]:(...o)=>{Object.keys(i).every((e=>e in o[0]&&o[0][e]===i[e]))&&(r(...o),t.resetLog&&n.clearLog(e),s())},prio:-1e4})}else n.on({[e]:(...i)=>{r(...i),t.resetLog&&n.clearLog(e)},prio:-1e4,once:!0})}))}clearLog(e){this._triggered&&(e?delete this._triggered[e]:this._triggered={})}trigger(e,t){var n,i,r,s,o;const l=this,a=e.toLowerCase(),{eventsSuspended:c,relayAllTargets:d,callOnFunctions:u}=l;let h,g,m=null===(n=l.eventListeners)||void 0===n?void 0:n[a];if(l._triggered||(l._triggered={}),l._triggered[e]=!0,c)return c.shouldQueue&&c.queue.push(arguments),!0;if(null!==(i=l.eventListeners)&&void 0!==i&&i.catchall&&((m=m?m.slice():[]).push(...l.eventListeners.catchall),m.sort(Ae)),!m&&!d&&!u)return!0;if(t?"source"in t||(Object.isExtensible(t)?t.source=l:t=Object.setPrototypeOf({source:l},t)):t={source:l},t.type!==a&&(t.constructor!==Object?Reflect.defineProperty(t,"type",{get:()=>a}):t.type=a),!("bubbles"in t)&&null!==(r=l.bubbleEvents)&&void 0!==r&&r[e]&&(t.bubbles=l.bubbleEvents[e]),u){const n="on"+S.capitalize(e);if(n in l){var p;const e=!l[n]||l.callback(l[n],l,[t]);let i;if(L.isPromise(e)?(h||(h=[])).push(e):i=!1===e||i,!l.isDestroyed&&ke.call(l,n)&&(null===(p=l.pluginFunctionChain)||void 0===p||!p[n])){const e=Object.getPrototypeOf(l);if(n in e){const r=e[n].call(l,t);if(L.isPromise(r)?(h||(h=[])).push(r):i=!1===r||i,l.isDestroyed)return}}if(i)return!1}}if(m){let e=0,n=!1;for(m.$firing=!0;e<m.length&&!l.isDestroyed&&!n;e++){const i=m[e];if(!1===g&&!i.$internal)continue;let r,s=i.thisObj;if(!s||!s.isDestroyed){if(i.called=!0,i.once&&l.removeListener(a,i),"string"==typeof i.fn){if(s&&(r=s[i.fn]),!r){const e=l.resolveCallback(i.fn);r=e.handler,s=e.thisObj}}else r=i.fn;if(i.buffer){if(!i.bufferFn){const e=Number(i.buffer);if("number"!=typeof e||isNaN(e))throw new Error(`Incorrect type for buffer, got "${e}" (expected a Number)`);i.bufferFn=be.createBuffered(r,e,s,i.args)}r=i.bufferFn}if(i.throttle){const e=Number(i.throttle);if("number"!=typeof e||isNaN(e))throw new Error(`Incorrect type for throttle, got "${e}" (expected a Number)`);i.throttledFn||(i.throttledFn=be.createThrottled(r,e,s,i.args)),r=i.throttledFn}const e=r.call(s||l,...i.args||[],t);!1!==g&&(g=e),i.$internal&&!1===e&&(n=!0),L.isPromise(e)&&(e.$internal=i.$internal,(h||(h=[])).push(e))}}if(m.$firing=!1,n)return!1}return null==d||d.forEach((n=>{let i=e;if(n.transformCase&&(i=S.capitalize(i)),n.prefix&&(i=n.prefix+i),!1===n.through.trigger(i,t))return!1})),t.bubbles&&l.owner&&!l.owner.isDestroyed?l.owner.trigger(e,t):(h=null===(s=h)||void 0===s?void 0:s.filter((e=>!1!==g||e.$internal)),null!==(o=h)&&void 0!==o&&o.length?new Promise((e=>{Promise.all(h).then((t=>{const n=!t.some((e=>!1===e));e(n)}))})):!1!==g)}suspendEvents(e=!1){(this.eventsSuspended||(this.eventsSuspended={shouldQueue:e,queue:[],count:0})).count++}resumeEvents(){const e=this.eventsSuspended;if(e&&0==--e.count&&(this.eventsSuspended=null,e.shouldQueue))for(const t of e.queue)this.trigger(...t);return!Boolean(this.eventsSuspended)}};class Re{static animationFrame(){return new Promise((e=>{requestAnimationFrame(e)}))}static sleep(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}static yield(){return Promise.resolve()}}Re._$name="AsyncHelper";const Pe=/^(\w+)=(.*)$/;class _e{static get(e,t){return this.fetch(e,t)}static post(e,t,n={}){return t instanceof FormData||"string"==typeof t||(t=JSON.stringify(t),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},n))}static fetch(e,t){let n;if(t=L.merge({},_e.DEFAULT_FETCH_OPTIONS,t),"undefined"!=typeof AbortController&&(n=t.abortController=new AbortController,t.signal=n.signal),"credentials"in t||(t.credentials="include"),t.queryParams){const n=Object.entries(t.queryParams);if(n.length){let i=!1;if(t.headers&&!0===t.addQueryParamsToBody){let e;switch(new Headers(t.headers).get("Content-Type")){case"application/x-www-form-urlencoded":e=URLSearchParams;break;case"multipart/form-data":e=FormData}if(e){const r=t.body||(t.body=new e);r instanceof e&&(n.forEach((([e,t])=>r.set(e,t))),i=!0)}}i||(e+=(e.includes("?")?"&":"?")+n.map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&"))}}const i=new Promise(((n,r)=>{fetch(e,t).then((e=>{t.parseJson?e.json().then((t=>{e.parsedJson=t,n(e)})).catch((t=>{e.parsedJson=null,e.error=t,r(e)})):n(e)})).catch((e=>{e.stack=i.stack,r(e)}))}));return i.stack=(new Error).stack,i.abort=function(){var e;null===(e=n)||void 0===e||e.abort()},i}static mockUrl(e,t){const n=this;(n.mockAjaxMap||(n.mockAjaxMap={}))[e]=t,_e.originalFetch||(_e.originalFetch=_e.fetch,_e.fetch=n.mockAjaxFetch.bind(n))}static async mockAjaxFetch(e,t){const n=e.split("?");let i=this.mockAjaxMap[n[0]],r=null;if(i){"function"==typeof i&&(i=await i(n[0],n[1]&&function(e){const t={},n=e.split("&");for(const e of n){const[n,i,r]=Pe.exec(e),s=decodeURIComponent(i),o=decodeURIComponent(r);if(n){let e=t[s];e?(Array.isArray(e)||(e=t[s]=[e]),e.push(o)):t[s]=o}}return t}(n[1]),t));try{r=t.parseJson&&JSON.parse(i.responseText)}catch(e){r=null,i.error=e}return i=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:e,parsedJson:r,text:()=>new Promise((e=>{e(i.responseText)})),json:()=>new Promise((e=>{e(r)}))},i),new Promise((function(e,t){i.synchronous?e(i):setTimeout((function(){e(i)}),"delay"in i?i.delay:100)}))}return _e.originalFetch(e,t)}}n(_e,"DEFAULT_FETCH_OPTIONS",{}),_e._$name="AjaxHelper";class Ne{static mergeLocales(...e){const n={};return e.forEach((e=>{Object.keys(e).forEach((i=>{"object"==typeof e[i]?n[i]=t(t({},n[i]),e[i]):n[i]=e[i]}))})),n}static trimLocale(e,t){const n=(t,n)=>{e[t]&&(n?e[t][n]&&delete e[t][n]:delete e[t])};Object.keys(t).forEach((e=>{Object.keys(t[e]).length>0?Object.keys(t[e]).forEach((t=>n(e,t))):n(e)}))}static normalizeLocale(e,t){if(!e)throw new Error('"nameOrConfig" parameter can not be empty');if("string"==typeof e){if(!t)throw new Error('"config" parameter can not be empty');t.locale?t.name=e||t.name:t.localeName=e}else t=e;let n={};if(t.name||t.locale)n=Object.assign({localeName:t.name},t.locale),t.desc&&(n.localeDesc=t.desc),t.code&&(n.localeCode=t.code),t.path&&(n.localePath=t.path);else{if(!t.localeName)throw new Error('"config" parameter doesn\'t have "localeName" property');n=Object.assign({},t)}for(const e of["name","desc","code","path"])n[e]&&delete n[e];if(!n.localeName)throw new Error("Locale name can not be empty");return n}static get locales(){return globalThis.bryntum.locales||{}}static set locales(e){globalThis.bryntum.locales=e}static get localeName(){return globalThis.bryntum.locale||"En"}static set localeName(e){globalThis.bryntum.locale=e||Ne.localeName}static get locale(){return Ne.localeName&&this.locales[Ne.localeName]||this.locales.En||Object.values(this.locales)[0]||{localeName:"",localeDesc:"",localeCoode:""}}static publishLocale(e,t){const{locales:n}=globalThis.bryntum,i=Ne.normalizeLocale(e,t),{localeName:r}=i;return n[r]&&!0!==t?n[r]=this.mergeLocales(n[r]||{},i||{}):n[r]=i,n[r]}}n(Ne,"skipLocaleIntegrityCheck",!1),globalThis.bryntum=globalThis.bryntum||{},globalThis.bryntum.locales=globalThis.bryntum.locales||{},Ne._$name="LocaleHelper";class je extends($e(de)){static get defaultConfig(){return{throwOnMissingLocale:A.isTestEnv}}construct(...e){const t=this;if(super.construct(...e),r.isBrowserEnv){var n;const e=document.querySelector("script[data-default-locale]");e?t.applyLocale(e.dataset.defaultLocale):null!==(n=t.locale)&&void 0!==n&&n.localeName&&t.applyLocale(t.locale.localeName)}}get locales(){return Ne.locales}set locales(e){Ne.locales=e}set locale(e){this.applyLocale(e)}get locale(){return Ne.locale}registerLocale(e,t){A.deprecate("Core","6.0.0","LocaleManager.registerLocale deprecated, use LocaleHelper.publishLocale instead"),Ne.publishLocale(e,t)}extendLocale(e,t){A.deprecate("Core","6.0.0","LocaleManager.extendLocale deprecated, use LocaleManager.applyLocale instead");const n=Ne.publishLocale(e,t);return this.applyLocale(n,!0)}applyLocale(e,t,n=!1){const i=this;let s;if("string"==typeof e)if("object"!=typeof t){if(s=i.locales[e],!s){if(n)return!0;throw new Error(`Locale "${e}" is not published. Publish with LocaleHelper.publishLocale() before applying.`)}}else s=Ne.publishLocale(e,t);else s=Ne.publishLocale(e);if(i.locale.localeName&&i.locale.localeName===s.localeName&&!0!==t)return i.locale;Ne.localeName=s.localeName;const o=()=>{i.trigger("locale",s)};return s.localePath?new Promise(((e,t)=>{i.loadLocale(s.localePath).then((t=>{t.text().then((t=>{new Function(t)(),r.isBrowserEnv&&(s=i.locales[s.localeName],s&&delete s.localePath),o(),e(s)}))})).catch((e=>t(e)))})):(o(),s)}loadLocale(e){return _e.get(e)}set throwOnMissingLocale(e){this._throwOnMissingLocale=e}get throwOnMissingLocale(){return this._throwOnMissingLocale}}const Ve=new je,ze=Object.getPrototypeOf(Object),Be=/L{.*?}/g,We=/L{(.*?)}/g,He=/((.*?)\.)?(.+)/g,Ue=e=>e.replace(/\[\[(\d+)]]/gm,"{$1}"),qe=Object.freeze(Object.create(null));var Ye=e=>class t extends(e||de){static get $name(){return"Localizable"}static get configurable(){return{localeClass:null,localizable:null,localizableProperties:{value:[],$config:{merge:"distinct"}}}}static clsName(e){var t,n;return"string"==typeof e?e:e===ze?"Object":e.$$name||e.name||(null===(t=e.prototype)||void 0===t?void 0:t.$$name)||(null===(n=e.prototype)||void 0===n?void 0:n.name)}static parseLocaleString(e){var t;const n=[];let i;if(null!==(t=e)&&void 0!==t&&t.includes("L{"))for(e=e.replace(/{(\d+)}/gm,"[[$1]]"),We.lastIndex=0;null!=(i=We.exec(e));){He.lastIndex=0;const e=He.exec(i[1]);n.push({match:Ue(i[0]),localeKey:Ue(e[3]),localeClass:e[2]})}return n.length>0?n:[{match:e,localeKey:e,localeClass:void 0}]}construct(e={},...t){super.construct(e,...t),Ve.ion({locale:"updateLocalization",thisObj:this}),this.updateLocalization()}get localeClass(){return this._localeClass||null}localizeProperty(e){var n,i,r;const s=this,o=L.getPath(s,e),l=(null===(n=s.$meta.configs[e])||void 0===n?void 0:n.localeKey)||(null===(i=s.fieldMap)||void 0===i||null===(r=i[e])||void 0===r?void 0:r.defaultValue);let a;return l?(a=t.localize(l,s,s.localeClass||s),a&&!(e in(s.initialConfig||qe))&&L.setPath(s.isColumn?s.data:s,e,a)):"string"==typeof o&&(s.originalLocales=s.originalLocales||{},a=L.getPath(s.originalLocales,e),void 0===a&&(L.setPath(s.originalLocales,e,o),a=o),a&&L.setPath(s,e,a=s.optionalL(a,s))),a||o}updateLocalization(){var e,t;!1!==this.localizable&&(null===(e=this.localizableProperties)||void 0===e||e.forEach(this.localizeProperty,this),null===(t=this.trigger)||void 0===t||t.call(this,"localized"))}static getTranslation(e,n,i){const r=Ve.locale;let s,o,l=null;if(r)for(const{match:a,localeKey:c,localeClass:d}of this.parseLocaleString(e)){const u=t=>{var s;const o=null===(s=r[t])||void 0===s?void 0:s[c];return o&&(l="function"==typeof o?null!=n?o(n):o:"object"==typeof o||e===a?o:(l||e).replace(a,o),"string"==typeof o&&o.includes("L{")&&(l=this.getTranslation(o,n,i))),o};let h=!1;for(o=i;o&&(s=t.clsName(o))&&!(h=u(s))&&"string"!=typeof o;o=Object.getPrototypeOf(o));!h&&d&&u(d)}return l}static localize(e,n,...i){var r;0===(null===(r=i)||void 0===r?void 0:r.length)&&(i=[this]);let s=null;return i.some((i=>(s=t.getTranslation(e,n,i),null!=s))),s}static L(e,n,...i){var r;0===(null===(r=i)||void 0===r?void 0:r.length)&&(i=[this]);const s=this.localize(e,n,...i);if(null==s&&Ve.throwOnMissingLocale&&e.includes("L{"))throw new Error(`Localization is not found for '${e}' in '${i.map((e=>t.clsName(e))).join(", ")}'. ${Ve.locale.localeName?`Locale : ${Ve.locale.localeName}`:""}`);return null!=s?s:e}L(e,n){const{localeClass:i,constructor:r}=this;return i&&t.clsName(i)!==t.clsName(r)?t.L(e,n,i,r):t.L(e,n,r)}static optionalL(e,n,...i){var r;const s=Ve.throwOnMissingLocale;Ve.throwOnMissingLocale=s&&Be.test(e),0===(null===(r=i)||void 0===r?void 0:r.length)&&(i=[this]);const o=t.L(e,n,...i);return Ve.throwOnMissingLocale=s,o}optionalL(e,t=this,n=!1){const i=Ve.throwOnMissingLocale;Ve.throwOnMissingLocale=i&&Be.test(e)&&!n;const r=this.L(e,t);return Ve.throwOnMissingLocale=i,r}get localeManager(){return Ve}get localeHelper(){return Ne}};Ne.publishLocale({localeName:"En",localeDesc:"English (US)",localeCode:"en-US",Object:{Yes:"Yes",No:"No",Cancel:"Cancel",Ok:"OK",Week:"Week"},Combo:{noResults:"No results",recordNotCommitted:"Record could not be added",addNewValue:e=>`Add ${e}`},FilePicker:{file:"File"},Field:{badInput:"Invalid field value",patternMismatch:"Value should match a specific pattern",rangeOverflow:e=>`Value must be less than or equal to ${e.max}`,rangeUnderflow:e=>`Value must be greater than or equal to ${e.min}`,stepMismatch:"Value should fit the step",tooLong:"Value should be shorter",tooShort:"Value should be longer",typeMismatch:"Value is required to be in a special format",valueMissing:"This field is required",invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},DatePicker:{gotoPrevYear:"Go to previous year",gotoPrevMonth:"Go to previous month",gotoNextMonth:"Go to next month",gotoNextYear:"Go to next year"},NumberFormat:{locale:"en-US",currency:"USD"},DurationField:{invalidUnit:"Invalid unit"},TimeField:{invalidTime:"Invalid time input"},TimePicker:{hour:"Hour",minute:"Minute",second:"Second"},List:{loading:"Loading..."},GridBase:{loadMask:"Loading...",syncMask:"Saving changes, please wait..."},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:e=>`of ${e.lastPage}`,summaryTemplate:e=>`Displaying records ${e.start} - ${e.end} of ${e.allCount}`},PanelCollapser:{Collapse:"Collapse",Expand:"Expand"},Popup:{close:"Close"},UndoRedo:{Undo:"Undo",Redo:"Redo",UndoLastAction:"Undo last action",RedoLastAction:"Redo last undone action",NoActions:"No items in the undo queue"},FieldFilterPicker:{equals:"equals",doesNotEqual:"does not equal",isEmpty:"is empty",isNotEmpty:"is not empty",contains:"contains",doesNotContain:"does not contain",startsWith:"starts with",endsWith:"ends with",isOneOf:"is one of",isNotOneOf:"is not one of",isGreaterThan:"is greater than",isLessThan:"is less than",isGreaterThanOrEqualTo:"is greater than or equal to",isLessThanOrEqualTo:"is less than or equal to",isBetween:"is between",isNotBetween:"is not between",isBefore:"is before",isAfter:"is after",isToday:"is today",isTomorrow:"is tomorrow",isYesterday:"is yesterday",isThisWeek:"is this week",isNextWeek:"is next week",isLastWeek:"is last week",isThisMonth:"is this month",isNextMonth:"is next month",isLastMonth:"is last month",isThisYear:"is this year",isNextYear:"is next year",isLastYear:"is last year",isYearToDate:"is year to date",isTrue:"is true",isFalse:"is false",selectAProperty:"Select a property",selectAnOperator:"Select an operator",caseSensitive:"Case-sensitive",and:"and",dateFormat:"D/M/YY",selectOneOrMoreValues:"Select one or more values",enterAValue:"Enter a value",enterANumber:"Enter a number",selectADate:"Select a date"},FieldFilterPickerGroup:{addFilter:"Add filter"},DateHelper:{locale:"en-US",weekStartDay:0,nonWorkingDays:{0:!0,6:!0},weekends:{0:!0,6:!0},unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"},{single:"decade",plural:"decades",abbrev:"dec"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A"},ordinalSuffix:e=>{let t="th";if(!["11","12","13"].find((t=>e.endsWith(t)))){t={1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th"}return e+t}}});const{toString:Ke}=Object.prototype,Ge=Ke.call(new Date),Xe=new Date,Je=(e,t)=>isNaN(e)||null==e?t:e,Ze=/([ES]){([^}]+)}/g,Qe=e=>{let t="th";if(!["11","12","13"].find((t=>e.endsWith(t)))){t={1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th"}return e+t},et=(e,t,n)=>(ct[e]||(ct[e]=new Intl.DateTimeFormat(st,t))).format(n),tt=(e,t,n,i=!1)=>{let r=et(e,t,n);return/am|pm/i.test(r)&&(r=r.replace(/^0/,""),i&&(r=r.replace(/:00/,""))),r},nt=e=>e>=0?e:e+7,it=/([^\w])(S+)/gm,rt=(e,t,n)=>t+"SSS";let st="en-US",ot=Qe,lt={},at={},ct={},dt={};const ut=e=>{const t=ht[e];if(!t)throw new Error("Only international formats should be used here");if(void 0!==at[e])return at[e];const n=new Intl.DateTimeFormat(st,t).formatToParts(new Date(2001,1,2,3,4,5,6)).map((e=>{const n=e.type,i=t[n];return"literal"===n?e.value.replace(/,/g,""):"day"===n?"numeric"===i?"D":"DD":"month"===n?"short"===i?"MMM":"long"===i?"MMMM":"numeric"===i?"M":"MM":"year"===n?"numeric"===i?"YYYY":"YY":void 0})).join("");return at[e]=n},ht={l:{year:"numeric",month:"numeric",day:"numeric"},ll:{year:"numeric",month:"short",day:"numeric"}},gt={M:e=>e.getMonth()+1,Mo:e=>ot(gt.M(e).toString()),MM:e=>(e.getMonth()+1).toString().padStart(2,"0"),MMM:e=>et("MMM",{month:"short"},e),MMMM:e=>et("MMMM",{month:"long"},e),Q:e=>Math.ceil((e.getMonth()+1)/3),Qo:e=>ot(gt.Q(e).toString()),D:e=>e.getDate(),Do:e=>ot(gt.D(e).toString()),DD:e=>e.getDate().toString().padStart(2,"0"),DDD:e=>Math.ceil((new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0)-new Date(e.getFullYear(),0,0,12,0,0))/wt.day.millisecond),DDDo:e=>ot(gt.DDD(e).toString()),DDDD:e=>gt.DDD(e).toString().padStart(3,"0"),d:e=>e.getDay(),do:e=>ot(e.getDay().toString()),d1:e=>et("d1",{weekday:"narrow"},e).substr(0,1),dd:e=>gt.ddd(e).substring(0,2),ddd:e=>et("ddd",{weekday:"short"},e),dddd:e=>et("dddd",{weekday:"long"},e),u:e=>{const t=(ct.u||(ct.u=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}))).formatToParts(e);return`${t[4].value}${t[2].value}${t[0].value}Z`},uu:e=>{const t=(ct.uu||(ct.uu=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))).formatToParts(e);return`${t[4].value}${t[2].value}${t[0].value}T${t[6].value}${t[8].value}${t[10].value}Z`},e:e=>e.getDay(),E:e=>e.getDay()+1,W:e=>$t.getWeekNumber(e)[1],Wo:e=>ot(gt.W(e).toString()),WW:e=>gt.W(e).toString().padStart(2,"0"),Wp:e=>`${$t.localize("L{Week}")} ${gt.W(e)}`,WWp:e=>`${$t.localize("L{Week}")} ${gt.WW(e)}`,Wp0:e=>`${$t.localize("L{Week}")[0]}${gt.W(e)}`,WWp0:e=>`${$t.localize("L{Week}")[0]}${gt.WW(e)}`,Y:e=>e.getFullYear(),YY:e=>e.getFullYear()%100,YYYY:e=>e.getFullYear(),A:e=>e.getHours()<12?"AM":"PM",a:e=>e.getHours()<12?"am":"pm",H:e=>e.getHours(),HH:e=>e.getHours().toString().padStart(2,"0"),h:e=>e.getHours()%12||12,hh:e=>gt.h(e).toString().padStart(2,"0"),k:e=>e.getHours()||24,kk:e=>gt.k(e).toString().padStart(2,"0"),K:e=>tt("K",{hour:"numeric"},e),KK:e=>tt("KK",{hour:"2-digit"},e),m:e=>e.getMinutes(),mm:e=>gt.m(e).toString().padStart(2,"0"),s:e=>e.getSeconds(),ss:e=>gt.s(e).toString().padStart(2,"0"),S:e=>Math.floor(e.getMilliseconds()/100).toString(),SS:e=>Math.floor(e.getMilliseconds()/10).toString().padStart(2,"0"),SSS:e=>e.getMilliseconds().toString().padStart(3,"0"),z:e=>et("z",{timeZoneName:"short"},e),zz:e=>et("zz",{timeZoneName:"long"},e),Z:e=>Rt.getGMTOffset(e),LT:e=>tt("LT",{hour:"2-digit",minute:"2-digit"},e),LST:e=>tt("LST",{hour:"numeric",minute:"2-digit"},e,!0),LTS:e=>tt("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},e),L:e=>et("L",{year:"numeric",month:"2-digit",day:"2-digit"},e),l:e=>et("l",ht.l,e),LL:e=>et("LL",{year:"numeric",month:"long",day:"numeric"},e),ll:e=>et("ll",ht.ll,e),LLL:e=>et("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},e),lll:e=>et("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},e),LLLL:e=>et("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},e),llll:e=>et("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},e)},mt=`^(?:${Object.keys(gt).sort(((e,t)=>t.length-e.length)).join("|")})`,pt=()=>({}),ft=e=>(e=>It.test(e))(e)&&{milliseconds:parseInt(e.padEnd(3,"0").substring(0,3))},vt={YYYY:e=>{const t=parseInt(e);return{year:t>=1e3&&t<=9999?t:NaN}},Y:e=>({year:parseInt(e)}),YY:e=>{const t=parseInt(e);return{year:t+(t>1968?1900:2e3)}},M:e=>({month:parseInt(e)-1}),MM:e=>({month:parseInt(e)-1}),Mo:e=>({month:parseInt(e)-1}),MMM:e=>{const t=(e||"").toLowerCase();for(const[e,n]of Object.entries($t._monthShortNamesIndex))if(t.startsWith(e))return{month:n.value}},MMMM:pt,DD:e=>({date:parseInt(e)}),D:e=>({date:parseInt(e)}),Do:e=>({date:parseInt(e)}),DDD:pt,DDDo:pt,DDDD:pt,d:pt,do:pt,d1:pt,dd:pt,ddd:pt,dddd:pt,Q:pt,Qo:pt,W:pt,Wo:pt,WW:pt,e:pt,E:pt,HH:e=>({hours:parseInt(e)}),hh:e=>({hours:parseInt(e)}),mm:e=>({minutes:parseInt(e)}),H:e=>({hours:parseInt(e)}),m:e=>({minutes:parseInt(e)}),ss:e=>({seconds:parseInt(e)}),s:e=>({seconds:parseInt(e)}),S:ft,SS:ft,SSS:ft,A:e=>({amPm:e.toLowerCase()}),a:e=>({amPm:e.toLowerCase()}),L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A",l:{type:"dynamic",parser:()=>ut("l")},ll:{type:"dynamic",parser:()=>ut("ll")},Z:e=>{if(!e||!Ft.test(e)&&"Z"!==e)return null;let t=0;if("Z"!==e){const n=Ft.exec(e);if(n){t=("+"===n[1]?1:-1)*(60*(parseInt(n[2])||0)+(parseInt(n[3])||0))}else t=-1*(new Date).getTimezoneOffset()}return{timeZone:t}}},yt=Object.keys(vt).sort(((e,t)=>t.length-e.length)),bt=new RegExp(`(${yt.join("|")})`),Ct=new RegExp("^(LL|LLL|lll|LLLL|llll)$"),wt={decade:{decade:1,year:10,quarter:40,month:120,week:520,day:3652,hour:87648,minute:5258880,second:315532800,millisecond:3155328e5},year:{decade:.1,year:1,quarter:4,month:12,week:52,day:365,hour:8760,minute:525600,second:31536e3,millisecond:31536e6},quarter:{decade:1/40,year:1/4,quarter:1,month:3,week:4,day:91,hour:2184,minute:131040,second:7862400,millisecond:78624e5},month:{decade:1/120,year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-720,minute:-43200,second:-2592e3,millisecond:-2592e6},week:{decade:-1/520,year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{decade:-1/3652,year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{decade:-1/87648,year:-1/8760,quarter:-1/2184,month:-1/720,week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{decade:-1/5258880,year:-1/525600,quarter:-1/131040,month:-1/43200,week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{decade:-1/315532800,year:-1/31536e3,quarter:-1/7862400,month:-1/2592e3,week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{decade:-1/3155328e5,year:-1/31536e6,quarter:-1/78624e5,month:-1/2592e6,week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:.001}},Et={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",mi:"minute",min:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",mo:"month",mon:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year",dec:"decade",decades:"decade"},St=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,Tt=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,xt=["millisecond","second","minute","hour","day","week","month","quarter","year","decade"],Dt=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],Ot=["decade","year","month","week","day","hour","minute","second","millisecond"],Mt=["milliseconds","seconds","minutes","hours","date","month","year"],It=/^[0-9]+$/,Ft=/([+-])(\d\d):*(\d\d)*$/,kt={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8,decade:9},Lt={round:(e,t=1)=>Math.round(e/t)*t,floor:(e,t=1)=>Math.floor(e/t)*t,ceil:(e,t=1)=>Math.ceil(e/t)*t},At={};class $t extends(Ye()){static get $name(){return"DateHelper"}static set defaultFormat(e){Rt._defaultFormat=e}static get defaultFormat(){return Rt._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}static set defaultParseFormat(e){this._defaultParseFormat=e}static get defaultParseFormat(){return this._defaultParseFormat||this._defaultFormat||"YYYY-MM-DDTHH:mm:ss.SSSZ"}static buildParser(e){const t=e.split(bt),n=[];return 1===t.length||Ct.test(e)?[]:(t.reduce(((t,i,r,s)=>{if(0!==r||""!==i)if(bt.test(i)){const o=(this.localize("L{parsers}")||{})[i]||vt[i];if("Z"===i&&r<s.length-2)throw new Error(`Invalid format ${e} TimeZone (Z) must be last token`);const l="function"==typeof o||"string"==typeof o?o:o.parser();if("string"==typeof l){const e=Rt.buildParser(l),i=e.pop();delete i.last,n.push(...e),t=i}else t.pattern=i,t.fn=l}else t.splitter=i,n.push(t),t={};else Object.prototype.hasOwnProperty.call(t,"pattern")&&n.push(t);return t}),{}),n[n.length-1].last=!0,n)}static makeKey(e){if(10===e.length)return e;e.getTime&&(e=e.getTime());const t=At[Math.trunc(e/36e5)];if(t)return t;Xe.setTime(e);const n=Xe.getMonth()+1,i=Xe.getDate();return At[Math.trunc(e/36e5)]=`${Xe.getFullYear()}-${n<10?"0"+n:n}-${i<10?"0"+i:i}`}static parseKey(e){return Rt.parse(e,"YYYY-MM-DD")}static parse(e,t=Rt.defaultParseFormat,n=!1){if(e instanceof Date)return e;if("string"!=typeof e||!e)return null;const i={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null};t=t.replace(it,rt);let r,s=dt[t];s||(s=dt[t]=Rt.buildParser(t)),e.includes(" ")&&(e=e.replace(/\s/g," ")),s.reduce(((e,t)=>{if(!t.last){let n,r,s;if(n="T"===t.splitter&&-1===e.indexOf("T")?e.indexOf(" "):""!==t.splitter?e.indexOf(t.splitter):t.pattern&&t.pattern.length||-1,-1===n||"SSS"===t.pattern&&e.match(/^\d+Z$/)){const t=e.split(/([Z\-+])/);1===t.length?(r=e,s=""):(r=t[0],s=`${t[1]}${t[2]}`)}else r=e.substring(0,n)||e,s=e.substring(n+t.splitter.length);if(t.fn){const e=t.fn(r);e?Object.assign(i,e):s=r+s}return s}Object.assign(i,t.fn(e))}),e),i.year&&!i.date&&(i.date=1);const o=Rt.create(i,n);return o?r=o:n||(r=new Date(e)),r}static create(e,n=!1){const i=t({},e);let r=isNaN(i.year),s=!1;if(!r){let e=!0;Mt.forEach((t=>{t in i&&!isNaN(i[t])||(i[t]=0),e=e&&null===i[t]})),r=e}if("am"===i.amPm?i.hours=i.hours%12:"pm"===i.amPm&&(i.hours=i.hours%12+12),"timeZone"in i&&(s=!0,i.minutes-=i.timeZone),r)return null;if(n&&(null==i.year||null==i.month||null==i.date))return null;const o=[Je(i.year,2020),Je(i.month,0),Je(i.date,1),i.hours,i.minutes,i.seconds,i.milliseconds];return s?new Date(Date.UTC(...o)):new Date(...o)}static toUTC(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))}static format(e,t=Rt.defaultFormat){if(!e||isNaN(e))return null;let n=lt[t],i="";if(!n){n=lt[t]=[];for(let e=0;e<t.length;e++){const i=t.slice(e).match(mt),r=null==i?void 0:i[0];if(r){const t=(this.localize("L{formats}")||{})[r]||gt[r];n.push(t),e+=r.length-1}else if("{"===t[e]){const i=t.indexOf("}",e+1);-1===i?(n.push(t.substr(e+1)),e=t.length):(n.push(t.substring(e+1,i)),e=i)}else n.push(t[e])}}return n.forEach((t=>{i+="string"==typeof t?t:t(e)})),i}static formatRange(e,t){return t.replace(Ze,((t,n,i)=>$t.format(e["S"===n?0:1],i)))}static asMilliseconds(e,t=null){return"string"==typeof e&&(t=e,e=1),Rt.as("millisecond",e,t)}static asMonths(e){const t=Rt.as("ms",Rt.daysInMonth(e),"day"),n=(e.valueOf()-Rt.startOf(e,"month").valueOf())/t;return 12*e.getYear()+e.getMonth()+n}static monthsToDate(e){const t=Math.floor(e),n=e-t,i=new Date(0,t),r=Rt.as("ms",Rt.daysInMonth(i),"days");return i.setTime(i.getTime()+n*r),i}static formatDelta(e,t){let n,i;"boolean"==typeof t?n=t:t&&(n=t.abbrev);const r=this.getDelta(e,t),s=[],o=(null==t?void 0:t.separator)||(n?"":" ");for(i in r)s.push(`${r[i]}${o}${i}`);return!1===(null==t?void 0:t.asString)?s:s.join(", ")}static getDelta(e,t){let n,i,r,s,o,l,a;"boolean"==typeof t?n=t:t&&(n=t.abbrev,s=Rt.normalizeUnit(t.precision),l=t.maxUnit,a=!n&&t.ignoreLocale);const c={},d=n?Rt.getShortNameOfUnit:Rt.getLocalizedNameOfUnit,u=l?Ot.slice(Ot.indexOf(l)):Ot;for(o of u)if(i=Rt.as(o,e),r=s===o,i=Math[r?"round":"floor"](i),(i||r&&!c.length)&&(c[a?o:d.call(Rt,o,1!==i)]=i,e-=Rt.as("ms",i,o)),r||!e)break;return c}static as(e,t,n="ms"){return"string"==typeof t&&(t=Rt.parseDuration(t)),"object"==typeof t&&(n=t.unit,t=t.magnitude),e===n||(e=Rt.normalizeUnit(e))===(n=Rt.normalizeUnit(n))?t:kt[n]>kt[e]?t*Math.abs(wt[n][e]):t/Math.abs(wt[e][n])}static formatContainsHourInfo(e){return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(/(\\.)/g,""))}static is24HourFormat(e){return Rt.format(Rt.getTime(13,0,0),e).includes("13")}static add(e,t,n="ms",i=!0){let r;if(r="string"==typeof e?Rt.parse(e):i?new Date(e.getTime()):e,"string"==typeof t){const e=$t.parseDuration(t);t=e.magnitude,n=e.unit}else t&&"object"==typeof t&&(n=t.unit,t=t.magnitude);if(!n||0===t)return r;switch(n=Rt.normalizeUnit(n)){case"millisecond":r.setTime(r.getTime()+t);break;case"second":r.setTime(r.getTime()+1e3*t);break;case"minute":r.setTime(r.getTime()+6e4*t);break;case"hour":r.setTime(r.getTime()+36e5*t);break;case"day":t%1==0?(r.setDate(r.getDate()+t),23===r.getHours()&&0===e.getHours()&&r.setHours(r.getHours()+1)):r.setTime(r.getTime()+864e5*t);break;case"week":r.setDate(r.getDate()+7*t);break;case"month":{let e=r.getDate();e>28&&(e=Math.min(e,Rt.getLastDateOfMonth(Rt.add(Rt.getFirstDateOfMonth(r),t,"month")).getDate())),r.setDate(e),r.setMonth(r.getMonth()+t);break}case"quarter":Rt.add(r,3*t,"month",!1);break;case"year":r.setFullYear(r.getFullYear()+t);break;case"decade":r.setFullYear(r.getFullYear()+10*t)}return r}static diff(e,t,n="ms",i=!0){if(n=Rt.normalizeUnit(n),!e||!t)return 0;let r;switch(n){case"year":r=Rt.diff(e,t,"month")/12;break;case"quarter":r=Rt.diff(e,t,"month")/3;break;case"month":r=12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth());break;case"week":r=Rt.diff(e,t,"day")/7;break;case"day":{const n=e.getTimezoneOffset()-t.getTimezoneOffset();r=(t-e+60*n*1e3)/864e5;break}case"hour":r=(t-e)/36e5;break;case"minute":r=(t-e)/6e4;break;case"second":r=(t-e)/1e3;break;case"millisecond":r=t-e}return i?r:Math.round(r)}static startOf(e,t="day",n=!0,i=Rt.weekStartDay){if(!e)return null;switch(t=Rt.normalizeUnit(t),n&&(e=Rt.clone(e)),t){case"year":return e.setMonth(0,1),e.setHours(0,0,0,0),e;case"quarter":return e.setMonth(3*(Rt.get(e,"quarter")-1),1),e.setHours(0,0,0,0),e;case"month":return e.setDate(1),e.setHours(0,0,0,0),e;case"week":{const t=e.getDay()-i;return e.setDate(e.getDate()-t),e.setHours(0,0,0,0),e}case"day":return e.setHours(0,0,0,0),e;case"hour":e.getMinutes()>0&&e.setMinutes(0);case"minute":e.getSeconds()>0&&e.setSeconds(0);case"second":e.getMilliseconds()>0&&e.setMilliseconds(0);case"millisecond":return e}}static endOf(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}static clone(e){return new Date(e.getTime())}static clearTime(e,t=!0){return e?(t&&(e=new Date(e.getTime())),e.setHours(0,0,0,0),e):null}static midnight(e,t){let n=Rt.clearTime(e);return t&&n<e&&(n=Rt.add(n,1,"d")),n}static getTimeOfDay(e,t="ms"){const n=e.getHours()*wt.hour.millisecond+e.getMinutes()*wt.minute.millisecond+e.getSeconds()*wt.second.millisecond+e.getMilliseconds();return"ms"===t?n:Rt.as(t,n,"ms")}static set(e,t,n){if(!t)return e;if("string"==typeof t)switch(Rt.normalizeUnit(t)){case"millisecond":(0!==n||e.getMilliseconds()>0)&&e.setMilliseconds(n);break;case"second":(0!==n||e.getSeconds()>0)&&e.setSeconds(n);break;case"minute":(0!==n||e.getMinutes()>0)&&e.setMinutes(n);break;case"hour":e.setHours(n);break;case"day":case"date":e.setDate(n);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(n);break;case"quarter":e.setDate(1),e.setMonth(3*(n-1));break;case"year":e.setFullYear(n)}else Object.entries(t).sort(((e,t)=>kt[e[0]]-kt[t[0]])).forEach((([t,n])=>{Rt.set(e,t,n)}));return e}static setDateToMidday(e,t=!0){return Rt.set(Rt.clearTime(e,t),"hour",12)}static constrain(e,t,n){return null!=t&&(e=Rt.max(e,t)),null==n?e:Rt.min(e,n)}static getTime(e,t=0,n=0,i=0){return e instanceof Date&&(i=e.getMilliseconds(),n=e.getSeconds(),t=e.getMinutes(),e=e.getHours()),new Date(2020,0,1,e,t,n,i)}static copyTimeValues(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}static get isDSTEnabled(){const e=(new Date).getFullYear(),t=new Date(e,0,1),n=new Date(e,6,1);return t.getTimezoneOffset()!==n.getTimezoneOffset()}static isDST(e){const t=e.getFullYear(),n=new Date(t,0,1),i=new Date(t,6,1);return e.getTimezoneOffset()<Math.max(n.getTimezoneOffset(),i.getTimezoneOffset())}static isBefore(e,t){return e<t}static isAfter(e,t){return e>t}static isEqual(e,t,n=null){return null===n?e&&t&&e.getTime()===t.getTime():Rt.startOf(e,n)-Rt.startOf(t,n)==0}static compare(e,t,n=null){return n&&(e=Rt.startOf(e,n),t=Rt.startOf(t,n)),e<t?-1:e>t?1:0}static clamp(e,t,n){if(!isNaN(e))return null!=t&&(e=Math.max(e,t)),null!=n&&(e=Math.min(e,n)),new Date(e)}static isSameDate(e,t){return 0===Rt.compare(e,t,"d")}static isSameTime(e,t){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds()&&e.getMilliseconds()===t.getMilliseconds()}static isStartOf(e,t){return Rt.isEqual(e,Rt.startOf(e,t))}static betweenLesser(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<n.getTime()}static betweenLesserEqual(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<=n.getTime()}static intersectSpans(e,t,n,i){return Rt.betweenLesser(e,n,i)||Rt.betweenLesser(n,e,t)}static compareUnits(e,t){return Math.sign(kt[Rt.normalizeUnit(e)]-kt[Rt.normalizeUnit(t)])}static timeSpanContains(e,t,n,i){return n-e>=0&&t-i>=0}static get weekStartDay(){return null==Rt._weekStartDay&&(Rt._weekStartDay=this.localize("L{weekStartDay}")||0),Rt._weekStartDay}static get nonWorkingDays(){return t({},this.localize("L{nonWorkingDays}"))}static get nonWorkingDaysAsArray(){return Object.keys(this.nonWorkingDays).map(Number)}static get weekends(){return t({},this.localize("L{weekends}"))}static get(e,t){switch(Rt.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return gt.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}static daysInYear(e){const t=e.getFullYear(),n=new Date(t+1,0,1)-new Date(t,0,1);return this.as("day",n)}static daysInMonth(e){return 32-new Date(e.getFullYear(),e.getMonth(),32).getDate()}static hoursInDay(e){const t=e.getFullYear(),n=e.getMonth(),i=e.getDate(),r=new Date(t,n,i+1)-new Date(t,n,i);return this.as("hour",r)}static getNormalizedUnitDuration(e,t){let n;switch(t){case"month":n=Rt.asMilliseconds(Rt.daysInMonth(e),"day");break;case"year":n=Rt.asMilliseconds(Rt.daysInYear(e),"day");break;case"day":n=Rt.asMilliseconds(Rt.hoursInDay(e),"hour");break;default:n=Rt.asMilliseconds(t)}return n}static getFirstDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth(),1)}static getLastDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}static min(e,t){return e.getTime()<t.getTime()?e:t}static max(e,t){return e.getTime()>t.getTime()?e:t}static getNext(e,t,n=1,i=Rt.weekStartDay){if("week"===t){const t=Rt.clone(e),r=t.getDay();return Rt.startOf(t,"day",!1),Rt.add(t,i-r+7*(n-(i<=r?0:1)),"day",!1),t.getDay()!==i&&Rt.add(t,1,"hour"),t}return Rt.startOf(Rt.add(e,n,t),t,!1)}static isValidDate(e){return Rt.isDate(e)&&!isNaN(e)}static isDate(e){return e&&Ke.call(e)===Ge}static getStartOfNextDay(e,t=!1,n=!1){let i=Rt.add(n?e:Rt.clearTime(e,t),1,"day");if(i.getDate()===e.getDate()){const n=Rt.add(Rt.clearTime(e,t),2,"day").getTimezoneOffset(),r=e.getTimezoneOffset();i=Rt.add(i,r-n,"minute")}return i}static getEndOfPreviousDay(e,t=!1){const n=t?e:Rt.clearTime(e,!0);return n-e?n:Rt.add(n,-1,"day")}static getWeekDescription(e,t=e){const n=e.getMonth()===t.getMonth()?$t.format(e,"MMMM"):`${$t.format(e,"MMM")} - ${$t.format(t,"MMM")}`,i=$t.getWeekNumber(e);return`${i[1]}, ${n} ${i[0]}`}static getWeekNumber(e,t=$t.weekStartDay){const n=new Date(e.getFullYear(),0,1),i=new Date(e.getFullYear(),11,31),r=nt(n.getDay()-t),s=nt(i.getDay()-t),o=(l=e,a=n,Math.floor((l.getTime()-a.getTime()-(l.getTimezoneOffset()-a.getTimezoneOffset())*wt.minute.millisecond)/wt.day.millisecond)+1);var l,a;let c;if(c=r<4?Math.floor((o+r-1)/7)+1:Math.floor((o+r-1)/7),c){let t=e.getFullYear();return 53===c&&s<3&&(t++,c=1),[t,c]}const d=$t.getWeekNumber(new Date(e.getFullYear()-1,11,31))[1];return[e.getFullYear()-1,d]}static formatCount(e,t){return t=Rt.normalizeUnit(t),1!==e&&(t+="s"),e+" "+t}static getUnitToBaseUnitRatio(e,t,n=!1){return(e=Rt.normalizeUnit(e))===(t=Rt.normalizeUnit(t))?1:wt[e]&&wt[e][t]&&(n||wt[e][t]>0)?1/Rt.as(t,1,e):wt[t]&&wt[t][e]&&(n||wt[t][e]>0)?Rt.as(e,1,t):-1}static getShortNameOfUnit(e){return e=Rt.parseTimeUnit(e),Rt.unitLookup[e].abbrev}static getLocalizedNameOfUnit(e,t=!1){const n=e.charAt(0)===e.charAt(0).toUpperCase();return e=Rt.normalizeUnit(e),e=Rt.parseTimeUnit(e),e=Rt.unitLookup[e][t?"plural":"single"],n&&(e=S.capitalize(e)),e}static normalizeUnit(e){if(!e)return null;const t=e.toLowerCase();return"date"===t||xt.includes(t)?t:Et[e]||Et[t]}static getUnitByName(e){return Rt.normalizeUnit(e)||Rt.normalizeUnit(Rt.parseTimeUnit(e))}static getDurationInUnit(e,t,n,i){return Rt.diff(e,t,n,i)}static doesUnitsAlign(e,t){return!(e!==t&&"week"===t)}static getSmallerUnit(e){return xt[kt[Rt.normalizeUnit(e)]-1]||null}static getLargerUnit(e){return xt[kt[Rt.normalizeUnit(e)]+1]||null}static round(e,t,n,i){return Rt.snap("round",e,t,n,i)}static floor(e,t,n,i){return Rt.snap("floor",e,t,n,i)}static ceil(e,t,n,i){return Rt.snap("ceil",e,t,n,i)}static snap(e,t,n,i,r=Rt.weekStartDay){const s=Lt[e];if("string"==typeof n&&(n=Rt.parseDuration(n)),L.isObject(n)){const o=n.magnitude||n.increment;switch(n.unit){case"week":{const n=t.getDay();return i=Rt.add(Rt.clearTime(t),n>=r?r-n:-(n-r+7),"day"),Rt[e](t,7*o+" days",i)}case"month":{let e;return t=Rt.asMonths(t),e=i?t+s(t-(i=Rt.asMonths(i)),o):s(t,o),Rt.monthsToDate(e)}case"quarter":return Rt[e](t,3*o+" months",i);case"year":return Rt[e](t,12*o+" months",i);case"decade":return Rt[e](t,10*o+" years",i)}n=Rt.as("ms",o,n.unit)}if(i){const e=Rt.as("ms",i.getTimezoneOffset()-t.getTimezoneOffset(),"ms");return new Date(i.valueOf()+s(Rt.diff(i,t,"ms")+e,n))}{const e=60*t.getTimezoneOffset()*1e3;return new Date(s(t.valueOf()-e,n)+e)}}static parseDuration(e,t=!0,n){var i;const r=(t?St:Tt).exec(e);if(null==e||!r)return null;const s=(e=>{const t=parseFloat(e);return isNaN(t)?null:t})(null===(i=r[1])||void 0===i?void 0:i.replace(",",".")),o=Rt.parseTimeUnit(r[2])||n;return o?{magnitude:s,unit:o}:null}static parseTimeUnit(e){const t=null==e?null:Rt.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(let e=0;e<xt.length;e++)if(t[e+1])return xt[e]}static getGMTOffset(e=new Date){if(!e)return;const t=e.getTimezoneOffset();return t?(t>0?"-":"+")+Math.abs(Math.trunc(t/60)).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0"):"Z"}static fillDayNames(){const e=new Date("2000-01-01T12:00:00"),t=Rt._dayNames||[],n=Rt._dayShortNames||[];t.length=0,n.length=0;for(let i=2;i<9;i++)e.setDate(i),t.push(Rt.format(e,"dddd")),n.push(Rt.format(e,"ddd"));Rt._dayNames=t,Rt._dayShortNames=n}static getDayNames(){return Rt._dayNames}static getDayName(e){return Rt._dayNames[e]}static getDayShortNames(){return Rt._dayShortNames}static getDayShortName(e){return Rt._dayShortNames[e]}static fillMonthNames(){const e=new Date("2000-01-15T12:00:00"),t=Rt._monthNames||[],n=Rt._monthShortNames||[],i={},r={};t.length=0,n.length=0;for(let s=0;s<12;s++){e.setMonth(s);const o=Rt.format(e,"MMMM");t.push(o);const l=Rt.format(e,"MMM");n.push(l),i[o.toLowerCase()]={name:o,value:s},r[l.toLowerCase()]={name:l,value:s}}Rt._monthNames=t,Rt._monthShortNames=n,Rt._monthNamesIndex=i,Rt._monthShortNamesIndex=r}static getMonthShortNames(){return Rt._monthShortNames}static getMonthShortName(e){return Rt._monthShortNames[e]}static getMonthNames(){return Rt._monthNames}static getMonthName(e){return Rt._monthNames[e]}static set locale(e){st=e,ct={},lt={},at={}}static get locale(){return st}static setupDurationRegEx(e=[],t=[]){const n=this,i={};let r="";for(let s=0;s<t.length;s++){const o=t[s],l=e[s];l.canonicalUnitName=xt[s],i[l.single]=i[l.single.toUpperCase()]=i[l.canonicalUnitName]=i[l.canonicalUnitName.toUpperCase()]=l,r+=(s?"|":"")+"(";for(let e=0;e<o.length;e++)r+=`${o[e]}|`;if(st=n.localize("L{locale}")||"en-US","en-US"!==st){const e=Dt[s];for(let t=0;t<e.length;t++)r+=`${e[t]}|`}r+=`${l.single}|${l.plural}|${l.canonicalUnitName}|${l.canonicalUnitName}s)`}n.unitLookup=i,n.durationRegEx=new RegExp(`^(?:${r})$`)}static applyLocale(){const e=this,t=e.localize("L{unitAbbreviations}")||[],n=e.unitNames=e.localize("L{unitNames}");"unitNames"!==n&&(st=e.localize("L{locale}")||"en-US",ot="en-US"===st?Qe:e.localize("L{ordinalSuffix}")||ot,lt={},at={},dt={},ct={},Rt._weekStartDay=null,Rt.setupDurationRegEx(n,t),Rt.fillDayNames(),Rt.fillMonthNames())}}n($t,"MS_PER_DAY",864e5);const Rt=$t;Rt.useIntlFormat=et,Ve.ion({locale:"applyLocale",prio:1e3,thisObj:Rt}),Ve.locale&&Rt.applyLocale(),$t._$name="DateHelper";const{hasOwn:Pt}=L,_t="1.01"===1.005.toFixed(2)?null:function(e,t){const n=e.toString().split("."),i=+(n[1]?n.join(".")+"1":n[0]);return e.toFixed.call(i,t)};class Nt extends L{static transformArrayToNamedObject(e,t="ref"){const n={};return e.forEach(((e,i)=>{const r=null!=e[t]&&e[t].toString().length?e[t]:i;n[r]=e})),n}static transformNamedObjectToArray(e,t="ref"){return Object.keys(e).filter((t=>e[t])).map((n=>{const i=e[n];return i[t]=n,i}))}static isEqual(e,t,n=!1){if(null===e&&null!==t||void 0===e&&void 0!==t||null===t&&null!==e||void 0===t&&void 0!==e)return!1;if(null==e&&null==t)return!0;if(e===t)return!0;const i=typeof e;if(i===typeof t){switch(i){case"number":case"string":case"boolean":return e===t}switch(!0){case e instanceof Date&&t instanceof Date:return e.getTime()===t.getTime();case Array.isArray(e)&&Array.isArray(t):return e.length===t.length&&e.every(((e,i)=>jt.isEqual(e,t[i],n)));case"object"===i&&e.constructor.prototype===t.constructor.prototype:return n?jt.isDeeplyEqual(e,t,n):JSON.stringify(e)===JSON.stringify(t)}}return String(e)===String(t)}static isDeeplyEqual(e,t,n={}){if(e===t)return!0;if(!e||!t)return!1;const i=jt.keys(e,n.ignore),r=jt.keys(t,n.ignore);if(i.length!==r.length)return!1;for(let s=0;s<i.length;s++){const o=i[s],l=r[s];if(o!==l)return!1;const a=e[o],c=t[l];if(!n.shouldEvaluate||!1!==n.shouldEvaluate(o,{value:a,object:e},{value:c,object:t})){if(n.evaluate){const i=n.evaluate(o,{value:a,object:e},{value:c,object:t});if(!1===i)return!1;if(!0===i)continue}if(!jt.isEqual(a,c,n))return!1}}return!0}static isPartial(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),-1!==e.indexOf(t)}static isLessThan(e,t){return e instanceof Date&&t instanceof Date?$t.isBefore(e,t):e<t}static isMoreThan(e,t){return e instanceof Date&&t instanceof Date?$t.isAfter(e,t):e>t}static fork(e){let t,n,i;if(e&&e.constructor===Object)for(n in t=Object.setPrototypeOf({},e),e)i=e[n],i&&(i.constructor===Object?t[n]=jt.fork(i):i instanceof Array&&(t[n]=i.slice()));else t=e;return t}static copyProperties(e,t,n){let i,r;for(r=0;r<n.length;r++)i=n[r],i in t&&(e[i]=t[i]);return e}static copyPropertiesIf(e,t,n){if(t)for(const i of n)i in e||(e[i]=t[i]);return e}static entries(e,t){const n=[],i="function"==typeof t;if(e)for(const r in e)(i?t(r,e[r]):null!=t&&t[r])||n.push([r,e[r]]);return n}static fromEntries(e,t){if(t=t||{},e)for(let n=0;n<e.length;++n)t[e[n][0]]=e[n][1];return t}static keys(e,t,n){const i=[],r="function"==typeof t;if(e){let s=0;for(const o in e)(r?t(o,e[o]):null!=t&&t[o])||(i.push(n?n(o,s):o),++s)}return i}static values(e,t,n){const i=[],r="function"==typeof t;if(e){let s=0;for(const o in e)(r?t(o,e[o]):null!=t&&t[o])||(i.push(n?n(e[o],s):e[o]),++s)}return i}static pathExists(e,t){return t.split(".").every((t=>!(!e||!(t in e))&&(e=e[t],!0)))}static pathifyKeys(e){const t={};for(const n in e)if(Pt(e,n))if(Array.isArray(e[n]))t[n]=e[n].slice();else if(e[n]instanceof Object){const i=this.pathifyKeys(e[n]);for(const e in i)t[`${n}.${e}`]=i[e]}else t[n]=e[n];return t}static deletePath(e,t){t.split(".").reduce(((e,t,n,i)=>{if(null==e)return null;if(Pt(e,t)){if(n!==i.length-1)return e[t];delete e[t]}}),e)}static coerce(e,t){const n=L.typeOf(e),i=L.typeOf(t),r="string"==typeof e;if(n!==i)switch(i){case"string":return String(e);case"number":return Number(e);case"boolean":return!(r&&(!e||"false"===e||"0"===e))&&Boolean(e);case"null":return!(!r||e&&"null"!==e)&&null;case"undefined":return!(!r||e&&"undefined"!==e)&&void 0;case"date":return r&&isNaN(e)?$t.parse(e):Date(Number(e))}return e}static wrapProperty(e,t,n,i,r=!0){const s={};let o=Object.getPrototypeOf(e),l=Object.getOwnPropertyDescriptor(o,t);for(;!l&&o&&r;)o=Object.getPrototypeOf(o),o&&(l=Object.getOwnPropertyDescriptor(o,t));l?(l.set?s.set=t=>{l.set.call(e,t),i&&i.call(e,l.get.call(e))}:s.set=i,l.get?s.get=()=>{let t=l.get.call(e);return n&&(t=n.call(e,t)),t}:s.get=n):(s.set=n=>{e[`_${t}`]=n,i&&i.call(e,n)},s.get=()=>{let i=e[`_${t}`];return n&&(i=n.call(e,i)),i}),Object.defineProperty(e,t,s)}static hookProperty(e,t,n){const i=Nt.getPropertyDescriptor(n.prototype,"value"),r=Nt.getPropertyDescriptor(e,t),s=`_${t}`,o=class{get value(){return r?r.get.call(this):this[s]}set value(e){r?r.set.call(this,e):this[s]=e}},l=Nt.getPropertyDescriptor(o.prototype,"value");return Object.setPrototypeOf(n.prototype,o.prototype),Object.defineProperty(e,t,{configurable:!0,get:i.get||l.get,set:i.set||l.set}),()=>delete e[t]}static getPropertyDescriptor(e,t){let n=null;for(let i=e;i&&!n&&!Pt(i,"isBase");i=Object.getPrototypeOf(i))n=Object.getOwnPropertyDescriptor(i,t);return n}static cleanupProperties(e,t=!1){return Object.entries(e).forEach((([n,i])=>{t?void 0===i&&delete e[n]:null==i&&delete e[n]})),e}static removeAllProperties(e){return Object.keys(e).forEach((t=>delete e[t])),e}static assertType(e,t,n){const i=L.typeOf(e);if(null!=e&&i!==t)throw new Error(`Incorrect type "${i}" for ${n}, expected "${t}"`)}static assertObject(e,t){jt.assertType(e,"object",t)}static assertInstance(e,t){jt.assertType(e,"instance",t)}static assertClass(e,t){jt.assertType(e,"class",t)}static assertFunction(e,t){if("function"!=typeof e||e.isBase||e.$$name)throw new Error(`Incorrect type for ${t}, got "${e}" (expected a function)`)}static assertNumber(e,t){const n=Number(e);if("number"!=typeof e||isNaN(n))throw new Error(`Incorrect type for ${t}, got "${e}" (expected a Number)`)}static assertBoolean(e,t){jt.assertType(e,"boolean",t)}static assertString(e,t){jt.assertType(e,"string",t)}static assertArray(e,t){jt.assertType(e,"array",t)}static toFixed(e,t){return _t?_t(e,t):e.toFixed(t)}static roundTo(e,t=1){return Math.round(e/t)*t}static round(e,t){if(null==t)return e;const n=10**t;return Math.round(e*n)/n}static getMapPath(e,t,n){const i=Array.isArray(t)?t:"string"==typeof t?t.split("."):[t],r=1===i.length,s=i[0],o=e.has(s)?e.get(s):e.set(s,r?n:{}).get(s);return r?o:jt.getPathDefault(o,i.slice(1),n)}}const jt=Nt;Nt._$name="ObjectHelper";const Vt=["border-top-width","border-right-width","border-bottom-width","border-left-width"],zt=["margin-top","margin-right","margin-bottom","margin-left"],Bt=["padding-top","padding-right","padding-bottom","padding-left"],Wt="border-top-width",Ht="border-right-width",Ut="border-bottom-width",qt="border-left-width",Yt="padding-top",Kt="padding-right",Gt="padding-bottom",Xt="padding-left",Jt=Object.freeze({x:0,y:0}),Zt=/^([trblc])(\d*)-([trblc])(\d*)$/i,Qt=/^([trblc])(\d*)$/i,en=["top","right","bottom","left"],tn={t:0,r:1,b:2,l:3},nn=["b-t","l-r","t-b","r-l"],rn={bt:1,tb:1,lr:2,rl:2},sn=Object.freeze([0,0]),on=["width","height"],ln=(e,t=e,n=e,i=t)=>Array.isArray(e)?ln.apply(null,e):[e,t,n,i];function an(e,t){const n=Zt.exec(e),i=n[1],r=n[3],s=parseInt(n[2]||50),o=parseInt(n[4]||50),l=!t||1&tn[i]?s:100-s,a=!t||1&tn[r]?o:100-o;return{myAlignmentPoint:i+l,myEdge:i,myOffset:l,targetAlignmentPoint:r+a,targetEdge:r,targetOffset:a,startZone:tn[r],edgeAligned:rn[i+r]}}function cn(e){return`${en[(tn[e.myEdge]+2)%4][0]}${e.myOffset}-${en[(tn[e.targetEdge]+2)%4][0]}${e.targetOffset}`}class dn{get isRectangle(){return!0}static from(e,t,n){var i,s;if("string"==typeof e?e=document.querySelector(e):(null===(i=e)||void 0===i?void 0:i.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host||e.ownerDocument),"string"==typeof t&&(t=document.querySelector(t)),null==e||e.isRectangle)return e;if(e=e.element||e,void 0===n&&"boolean"==typeof t&&(n=t,t=null),null===(s=t)||void 0===s||!s.isRectangle)if(t){let{scrollLeft:e,scrollTop:n}=t;r.isSafari&&t===document.body&&(e=n=0),t=dn.from(t).translate(-e,-n)}else t=Jt;const o=e===document||e===globalThis,l=e===document.body&&0===document.body.offsetHeight,a=l&&e.getBoundingClientRect(),c=l?new dn(a.left,a.top,a.width,document.body.parentElement.scrollHeight):o?new dn(0,0,globalThis.innerWidth,globalThis.innerHeight):e.getBoundingClientRect(),d=n||o?[0,0]:[globalThis.pageXOffset,globalThis.pageYOffset];return new dn(c.left+d[0]-t.x,c.top+d[1]-t.y,c.width,c.height)}static fromScreen(e,t){return dn.from(e,t,!0)}static inner(e,t,n=!1){const i=this.from(e,t,n);if(document.body.contains(e)){const t=gi.getStyleValue(e,Vt);i.x+=parseFloat(t[qt]),i.y+=parseFloat(t[Wt]),i.right-=parseFloat(t[Ht]),i.bottom-=parseFloat(t[Ut])}return i}static content(e,t,n=!1){const i=this.from(e,t,n);if(document.body.contains(e)){const t=gi.getStyleValue(e,Vt),n=gi.getStyleValue(e,Bt);i.x+=parseFloat(t[qt])+parseFloat(n[Xt]),i.y+=parseFloat(t[Wt])+parseFloat(n[Yt]),i.right-=parseFloat(t[Ht])+parseFloat(n[Kt]),i.bottom-=parseFloat(t[Ut])+parseFloat(n[Gt])}return i}static client(e,t,n=!1){const i=this.content(e,t,n),r=gi.scrollBarWidth;let s;return r&&(e.scrollHeight>e.clientHeight&&"hidden"!==gi.getStyleValue(e,"overflow-y")&&(s=parseFloat(gi.getStyleValue(e,"padding-right")),i.right+=s-Math.max(s,r)),e.scrollWidth>e.clientWidth&&"hidden"!==gi.getStyleValue(e,"overflow-x")&&(s=parseFloat(gi.getStyleValue(e,"padding-bottom")),i.bottom+=s-Math.max(s,r))),i}static outer(e,t,n=!1){const i=this.from(e,t,n);if(document.body.contains(e)){const t=gi.getStyleValue(e,zt);i.x-=parseFloat(t["margin-left"]),i.y-=parseFloat(t["margin-top"]),i.right+=parseFloat(t["margin-right"]),i.bottom+=parseFloat(t["margin-bottom"])}return i}static union(...e){let t,{x:n,y:i,right:r,bottom:s}=e[0];if(e.length>1)for(let o=1;o<e.length;o++)t=e[o],t.x<n&&(n=t.x),t.y<i&&(i=t.y),t.right>r&&(r=t.right),t.bottom>s&&(s=t.bottom);return new dn(n,i,r-n,s-i)}roundPx(e=globalThis.devicePixelRatio||1){const t=this;return t._x=gi.roundPx(t._x,e),t._y=gi.roundPx(t._y,e),t._width=gi.roundPx(t._width,e),t._height=gi.roundPx(t._height,e),t}static get $$name(){return hasOwnProperty.call(this,"$name")&&this.$name||hasOwnProperty.call(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}constructor(e,t,n,i){Nt.assertNumber(e,"Rectangle.x"),Nt.assertNumber(t,"Rectangle.y"),Nt.assertNumber(n,"Rectangle.width"),Nt.assertNumber(i,"Rectangle.height");const r=this;n<0&&(e+=n,n=-n),i<0&&(t+=i,i=-i),r._x=e,r._y=t,r._width=n,r._height=i}clone(){const e=this,t=new dn(e.x,e.y,e.width,e.height);return t.isAlignRectangle=e.isAlignRectangle,t.minHeight=e.minHeight,t.minWidth=e.minWidth,t}contains(e){const t=this;return!!e.isRectangle&&(e._x>=t._x&&e._y>=t._y&&e.right<=t.right&&e.bottom<=t.bottom)}intersect(e,t=!1,n=!1){const i=this,r=Math.max(i.y,e.y),s=Math.min(i.right,e.right),o=Math.min(i.bottom,e.bottom),l=Math.max(i.x,e.x);return!!(n?o>=r&&s>=l:o>r&&s>l)&&(!!t||new dn(l,r,s-l,o-r))}equals(e,t=!1){const n=t?e=>Math.round(e):e=>e;return e.isRectangle&&n(e.x)===n(this.x)&&n(e.y)===n(this.y)&&n(e.width)===n(this.width)&&n(e.height)===n(this.height)}translate(e,t){return this._x+=e||0,this._y+=t||0,this}moveTo(e,t){return null!=e&&(this._x=e),null!=t&&(this._y=t),this}getDelta(e){return[e.x-this.x,e.y-this.y]}get center(){return new dn.Point(this.x+this.width/2,this.y+this.height/2)}set x(e){const t=e-this._x;this._x=e,this._width-=t}get x(){return this._x}get start(){return this.left}set left(e){this.x=e}get left(){return this.x}set top(e){this.y=e}get top(){return this.y}set y(e){const t=e-this._y;this._y=e,this._height-=t}get y(){return this._y}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set right(e){this._width=e-this._x}get right(){return this._x+this._width}get end(){return this.right}set bottom(e){this._height=e-this._y}get bottom(){return this._y+this._height}getStart(e,t=!0){return t?e?this.right:this.left:this.top}getEnd(e,t=!0){return t?e?this.left:this.right:this.bottom}get area(){return this.width*this.height}set minWidth(e){const t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.isAlignRectangle||(t.width=Math.max(t.width,t._minWidth)))}get minWidth(){return this._minWidth}set minHeight(e){const t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.isAlignRectangle||(t.height=Math.max(t.height,t._minHeight)))}get minHeight(){return this._minHeight}adjust(e,t,n,i){const r=this;return r.x+=e,r.y+=t,r.width+=n,r.height+=i,r}inflate(e,t=e,n=e,i=t){return Array.isArray(e)&&([e,t,n,i]=ln(e)),this.adjust(-i,-e,t,n)}deflate(e,t=e,n=e,i=t){return Array.isArray(e)&&([e,t,n,i]=ln(e)),this.adjust(i,e,-t,-n)}constrainTo(e,t){const n=this,i=n.height,r=n.y,s=n.minWidth||n.width,o=n.minHeight||n.height;if(n.height>=e.height){if(t&&o>e.height)return!1;n._y=e.y,n.height=e.height}if(n.width>=e.width){if(t&&s>e.width)return n.y=r,n.height=i,!1;n._x=e.x,n.width=e.width}let l=n.bottom-e.bottom;return l>0&&n.translate(0,-l),l=n.right-e.right,l>0&&n.translate(-l),l=e.y-n.y,l>0&&n.translate(0,l),l=e.x-n.x,l>0&&n.translate(l),n}alignTo(e){let t,n,i,r,s=this.clone(),{target:o,constrainTo:l,constrainPadding:a}=e;if(o&&!o.isRectangle&&(o=dn.from(o.element?o.element:o)),l){if(!l.isRectangle){r=l===globalThis||l===document;const t="ignorePageScroll"in e?e.ignorePageScroll:!r;l=dn.from(l.element?l.element:l,null,t)}a&&(a=ln(a),a[0]=Math.min(a[0],o.top),a[1]=Math.min(a[1],l.right-o.right),a[2]=Math.min(a[0],l.bottom-o.bottom),a[3]=Math.min(a[0],o.left),l=l.deflate.apply(l.clone(),a))}const c=this,d=null==(T=e.offset)?sn:"number"==typeof T?[T,T]:T,{align:u,axisLock:h,anchorSize:g,anchorPosition:m,matchSize:p,position:f,rtl:v}=e,y=an(u,v),b=l&&l.clone(),C=[],w=[{zone:n=y.startZone,align:u}],E=p&&on[1&y.startZone],S=c[E];var T;if(E&&h?s[E]=o[E]:!y.edgeAligned&&p&&(s.width=o.width,s.height=o.height),l&&s.constrainTo(l),l&&null!=y.startZone)if(h)w.push({zone:n=(n+2)%4,align:cn(y)}),"flexible"===h&&(w.push({zone:n=(y.startZone+1)%4,align:nn[n]}),w.push({zone:n=(n+2)%4,align:nn[n]}));else for(let e=1;e<4;e++)w.push({zone:n=(n+1)%4,align:nn[n]});if(m){const e=1&y.startZone?"y":"x";t={[e]:m[e],edge:en[(y.startZone+2)%4]}}if(b&&o&&(b.adjust(-o.width,-o.height,o.width,o.height),o.constrainTo(b)),s.minWidth=c.minWidth,s.minHeight=c.minHeight,f)s.moveTo(f.x,f.y),l&&s.constrainTo(l);else{const e="c"===y.myEdge||"c"===y.targetEdge,n=g&&!e?[g[1]+d[0],g[1]+d[1]]:d,a=o.getAlignmentPoint(y.targetAlignmentPoint,n),u=s.getAlignmentPoint(y.myAlignmentPoint);s.translate(a[0]-u[0],a[1]-u[1]);let m=s.intersect(o,!0);if(m)l&&s.constrainTo(l),i=y.startZone,s.translate(...n);else if(l&&!l.contains(s)){const e=s.clone(),a=[];let d,u;t=null,C[0]=d=l.clone(),d.bottom=o.y-n[1],C[1]=d=l.clone(),d.x=o.right+n[0],C[2]=d=l.clone(),d.y=o.bottom+n[1],C[3]=d=l.clone(),d.right=o.x-n[0];for(let e=0;e<w.length;e++){if(E&&2==e&&(s[E]=S),d=C[i=w[e].zone],s=s.alignTo({target:o,offsets:n,align:w[e].align}),s.constrainTo(d,!0)&&(a.push({result:s,zone:i}),!u||s.width<c.width||s.height<c.height)){s.align=w[e].align;break}if(!u||d.area>u.area){const e=s.clone();switch(i){case 0:e.moveTo(null,d.bottom-e.height);break;case 1:e.moveTo(d.left);break;case 2:e.moveTo(null,d.top);break;case 3:e.moveTo(d.right-e.width)}u={area:d.area,result:e,zone:i}}}a.length?(a.length>1&&!h&&a.sort(((t,n)=>Math.sqrt((e.x-t.result.x)**2+(e.y-t.result.y)**2)-Math.sqrt((e.x-n.result.x)**2+(e.y-n.result.y)**2))),s=a[0].result,i=a[0].zone):(s=u.result,i=u.zone,r&&s.constrainTo(l))}else i=y.startZone;if(s.zone=i,s.overlap=m=s.intersect(o,!0),g&&!m){if(!t){const e=1&i,n=e?"y":"x",r=e?"bottom":"right",l=Math.max(o[n],s[n]);let a=l+(Math.min(o[r],s[r])-l)/2-g[0]/2;const c=a+g[0];c>s[r]&&(a-=c-s[r]),a<s[n]&&(a+=s[n]-a),t={[n]:a-s[n],edge:en[(i+2)%4]}}s.anchor=t}}return s}getAlignmentPoint(e,t=sn){const n=this,i=Qt.exec(e),r=i[1].toLowerCase(),s=Math.min(Math.max(parseInt(i[2]||50),0),100)/100;switch(r){case"t":return[n.x+n.width*s,n.y-t[1]];case"r":return[n.right+t[0],n.y+n.height*s];case"b":return[n.x+n.width*s,n.bottom+t[1]];case"l":return[n.x-t[0],n.y+n.height*s];case"c":return[n.x+n.width/2,n.y+n.height/2]}}highlight(){const e=this,t=gi.createElement({parent:document.body,style:`position:absolute;z-index:9999999;pointer-events:none;\n                            left:${e.x}px;top:${e.y}px;width:${e.width}px;height:${e.height}px`});return gi.highlight(t).then((()=>t.remove()))}visualize(e,n){const i=this,r=Nt.merge({style:t({left:`${i.x}px`,top:`${i.y}px`,width:`${i.width}px`,height:`${i.height}px`,pointerEvents:"none"},e.class?{}:{position:"absolute","z-index":9999999})},e);return n?r:gi.createElement(r)}toString(e=","){return[`${this.top}px`,`${this.right}px`,`${this.bottom}px`,`${this.left}px`].join(e)}}dn._$name="Rectangle";const un=Symbol("value"),hn=Symbol("length");class gn{static change(e,t,n,i="string"){n=gn.normalize(n,"object");const r=gn.normalize(e,"array").filter((e=>!n[e]));if(t){t=gn.normalize(t,"array");for(let e=0;e<t.length;++e)r.includes(t[e])||r.push(t[e])}return gn.normalize(r,i)}static from(e,t){if(e){var n,i;if(e.isDomClassList)t=null===(n=t)||void 0===n||n;else t=null!==(i=t)&&void 0!==i?i:L.isObject(e)&&!L.isEmpty(e),e=new gn(e);e.value||t||(e=null)}return e||(t?new gn:null)}static normalize(e,t="string"){const n=typeof(e=e||""),i="array"===t,r=!i&&!("object"===t);let s,o,l,a="string"===n;var c;"object"===n&&(e.nodeType===Element.ELEMENT_NODE&&"function"==typeof e.getAttribute?(e=e.getAttribute("class")||"",a=!0):null!==(c=e)&&void 0!==c&&c.isDomClassList?e=e.values:e instanceof DOMTokenList?e=Array.from(e):e instanceof Map?e=Array.from(e.keys()).filter((t=>e.get(t))):e instanceof Set?e=Array.from(e):Array.isArray(e)||(e=L.getTruthyKeys(e)));for(a&&(e=[...new Set(S.split(e))]),o=e.length;o-- >0;)s=e[o],s.length?s.includes(" ")&&e.splice(o,1,...S.split(s)):e.splice(o,1);if(i)l=e;else if(r)l=e.join(" ");else for(l=Object.create(null),o=0;o<e.length;++o)l[e[o]]=!0;return l}constructor(...e){this.process(1,e)}clear(){for(const e in this)this[e]=!1;return this}set(...e){return this.clear().process(1,e)}get isDomClassList(){return!0}clone(){return new gn(this)}contains(e){return!("string"!=typeof e||!e)&&Boolean(this[e])}toString(){return this.length?`${this.value} `:""}toJSON(){return this.toString()}trim(){return this.value}isEqual(e){const t=gn.normalize(e,"array"),n=t.length;if(this.length===n){for(let e=0;e<n;e++)if(!this[t[e]])return!1;return!0}return!1}get value(){let e,t=this[un];return null==t&&(e=L.getTruthyKeys(this),this[hn]=e.length,this[un]=t=e.join(" ")),t}set value(e){const t=this,n=Object.keys(t),i=n.length;for(let e=0;e<i;e++)delete t[n[e]];e?t.process(1,[e]):delete t[un]}get values(){return L.getTruthyKeys(this)}get length(){return this.value?this[hn]:0}process(e,t){for(let n,i,r=0;r<t.length;r++)if(t[r])if(n=t[r],n.isDomClassList||L.isObject(n))for(i in n)this[i]=e?n[i]:!n[i];else for(n=gn.normalize(t[r],"array"),i=0;i<n.length;++i)this[n[i]]=e;return delete this[un],this}assign(e){for(const t in e)!this[t]!=!e[t]&&(this[t]=e[t],delete this[un]);return this}assignTo(e){const t=e.nodeType===Element.ELEMENT_NODE?e.classList:e,n=gn.from(t);n.add(this),t.value=n.value}add(...e){return this.process(1,e)}remove(...e){return this.process(0,e)}toggle(e,t=Boolean(!this[e])){if(t=Boolean(t),Boolean(this[e])!==t)return this[e]=t,delete this[un],!0}split(){return L.getTruthyKeys(this)}forEach(e){return L.getTruthyKeys(this).forEach(e)}}gn.prototype[un]=null,gn._$name="DomClassList";class mn extends dn{static from(e){const t=e.changedTouches;return new mn(t?t[0].screenX:e.screenX,t?t[0].screenY:e.pageY)}constructor(e,t){super(e,t,0,0)}constrain(e){return this.x=Math.min(Math.max(this.x,e.x),e.right-1),this.y=Math.min(Math.max(this.y,e.y),e.bottom-1),this}toArray(){return[this.x,this.y]}}Object.getPrototypeOf(mn).Point=mn,mn._$name="Point";const pn=["clientX","clientY","pageX","pageY","screenX","screenY"],fn={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1,block:1},vn={configurable:true,value:!0},yn={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},bn={Meta:1,Control:1,Alt:1},Cn={Control:"ctrl",Alt:"alt",Shift:"shift"},wn=/^(ctrl|shift|alt|meta)$/;class En{static normalizeEvent(e){return Nt.copyPropertiesIf(e,e.changedTouches[0]||e.touches[0],pn)}static getXY(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}static getDistanceBetween(e,t){const n=Sn.getXY(e),i=Sn.getXY(t);return Math.sqrt(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2))}static getPagePoint(e){return new dn.Point(e.pageX,e.pageY)}static getClientPoint(e){return new dn.Point(e.clientX,e.clientY)}static addListener(e,t,n,i){return i=e.nodeType?"string"==typeof t?Object.assign({element:e,[t]:n},i):Object.assign({element:e},t):e,Sn.on(i)}static on(e){const t=e.element,n=e.thisObj,i=[];for(const s in e)if(!fn[s]){let o=e[s];"object"!=typeof o&&(o={handler:o});const l=o.element||t;r.isTouchDevice&&!r.isAndroid&&"contextmenu"===s&&i.push(Sn.addElementListener(l,"touchstart",{handler:Sn.createContextMenuWrapper(o.handler,o.thisObj||n)},e)),i.push(Sn.addElementListener(l,s,o,e))}const s=()=>{for(let e,t=0;t<i.length;t++)e=i[t],Sn.removeEventListener(e[0],e[1],e[2]);i.length=0};return n&&!1!==e.autoDetach&&(n.doDestroy=be.createInterceptor(n.doDestroy,s,n)),s}static addElementListener(e,t,n,i){const r=Sn.createHandler(e,t,n,i),{spec:s}=r,o=n.expires||i.expires,l=null!=s.capture||null!=s.passive?{capture:s.capture,passive:s.passive}:void 0;if(e.addEventListener(t,r,l),o){const s=n.thisObj||i.thisObj,l=null!=s&&s.isDelayable?s:globalThis,{alt:a}=o,c=a?o.delay:o,{spec:d}=r;d.expires=o,d.timerId=l["number"==typeof c?"setTimeout":"requestAnimationFrame"]((()=>{d.timerId=null,Sn.removeEventListener(e,t,r),a&&!r.called&&("string"==typeof a?s[a]:a).call(s)}),c,`listener-timer-${performance.now()}`)}return[e,t,r,l]}static getComposedPathTarget(e){return e.composedPath()[0]||e.path[0]}static fixEvent(e){var t,n;if(e.fixed)return e;const{type:i,target:s}=e;if((null!=s&&s.shadowRoot||null!=s&&null!==(t=s.getRootNode)&&void 0!==t&&t.call(s).host)&&e.composedPath){const t=this.getComposedPathTarget(e),n=s;Object.defineProperty(e,"target",{value:t,configurable:true}),Object.defineProperty(e,"originalTarget",{value:n,configurable:true})}if(Object.defineProperty(e,"fixed",vn),i.startsWith("key")){const t=yn[e.key];t&&Object.defineProperty(e,"key",{value:t,configurable:true})," "!==e.key||e.code||Object.defineProperty(e,"code",{value:"Space",configurable:true})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",vn),s&&"offsetX"in e&&(Object.getOwnPropertyDescriptor(e,"borderOffsetX")||Object.defineProperty(e,"borderOffsetX",{get:()=>e.offsetX+(r.isSafari?0:parseInt(s.ownerDocument.defaultView.getComputedStyle(s).getPropertyValue("border-left-width")))}),Object.getOwnPropertyDescriptor(e,"borderOffsetY")||Object.defineProperty(e,"borderOffsetY",{get:()=>e.offsetY+(r.isSafari?0:parseInt(s.ownerDocument.defaultView.getComputedStyle(s).getPropertyValue("border-top-width")))})),(null==s?void 0:s.nodeType)===Element.DOCUMENT_NODE&&"clientX"in e){const t=gi.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{value:t,configurable:true})}if((null==s?void 0:s.nodeType)===Element.TEXT_NODE){const t=e.target.parentElement;Object.defineProperty(e,"target",{value:t,configurable:true})}if((null===(n=e.relatedTarget)||void 0===n?void 0:n.nodeType)===Element.TEXT_NODE){const t=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{value:t,configurable:true})}return i.startsWith("touch")&&e.touches.length&&this.normalizeEvent(e),e}static createHandler(e,t,n,i){const r=n.delay||i.delay,s=n.throttled||i.throttled,o=n.block||i.block,l="once"in n?n.once:i.once,a="capture"in n?n.capture:i.capture,c="passive"in n?n.passive:i.passive,d="delegate"in n?n.delegate:i.delegate,u=n.handler,h=n.expires,g=n.thisObj||i.thisObj,{rtlSource:m=g}=g||{};let p=(e,...t)=>{Sn.playingDemo&&e.isTrusted||null!=g&&g.isDestroyed||(e=Sn.fixEvent(e,null==m?void 0:m.rtl),p.called=!0,("string"==typeof u?g[u]:u).call(g,e,...t),delete e.target,delete e.relatedTarget,delete e.originalarget,delete e.key,delete e.code,delete e.ctrlKey,delete e.fixed)};if(o){const e=p;let t,n;p=(i,...r)=>{const s=performance.now();(!t||i.target!==n||s-t>o)&&(n=i.target,t=s,e(i,...r))}}if(null!=r){const e=p,t=null!=g&&g.setTimeout?g:globalThis;p=(...n)=>{t.setTimeout((()=>{e(...n)}),r)}}if(null!=s){let e,t=s;s.buffer&&(e=e=>s.alt.call(Sn,Sn.fixEvent(e,null==m?void 0:m.rtl)),t=s.buffer),p=null!=g&&g.isDelayable?g.throttle(p,{delay:t,throttled:e}):be.createThrottled(p,t,g,null,e)}if(l){const n=p;p=(...i)=>{Sn.removeEventListener(e,t,p),n(...i)}}if(d){const e=p;p=(t,...n)=>{var i;const r=(null===(i=(t=Sn.fixEvent(t,null==m?void 0:m.rtl)).target.closest)||void 0===i?void 0:i.call)&&t.target.closest(d);r&&(Object.defineProperty(t,"currentTarget",{get:()=>r,configurable:!0}),e(t,...n))}}return n.thisObj&&!1!==n.autoDetach&&(g.doDestroy=be.createInterceptor(g.doDestroy,(()=>Sn.removeEventListener(e,t,p)),g)),p.spec={delay:r,throttled:s,block:o,once:l,thisObj:g,capture:a,expires:h,passive:c,delegate:d},p}static removeEventListener(e,t,n){const{expires:i,timerId:r,thisObj:s,capture:o}=n.spec;if(null!=i&&i.alt&&r){(null!=s&&s.isDelayable?s:globalThis)["number"==typeof i.delay?"clearTimeout":"cancelAnimationFrame"](r)}e.removeEventListener(t,n,o)}static onTransitionEnd({element:e,animationName:t,property:n,handler:i,mode:r=(t?"animation":"transition"),duration:s=gi[`get${"transition"===r?"Property":""}${S.capitalize(r)}Duration`](e,n),thisObj:o=globalThis,args:l=[],timerSource:a,runOnDestroy:c}){let d;a=a||(o.isDelayable?o:globalThis);const u=[e,n,...l],h=()=>{g(),o.isDestroyed||(o.callback?o.callback(i,o,u):i.apply(o,u))},g=Sn.on({element:e,[`${r}end`]({animationName:i,propertyName:r,target:s}){s===e&&(r===n||null!=i&&i.match(t))&&(d&&(a.clearTimeout(d),d=null),h())}});return null!=s&&(d=a.setTimeout(h,s+50,"onTransitionEnd",c)),g}static async waitForTransitionEnd(e){return new Promise((t=>{e.handler=t,En.onTransitionEnd(e)}))}static createContextMenuWrapper(e,t){return n=>{if(1===n.touches.length){if(n.target.closest("[data-feature]"))return;const i=n.touches[0],r=setTimeout((()=>{o();const r=new MouseEvent("contextmenu",i);Object.defineProperty(r,"target",{get:()=>i.target}),"string"==typeof e&&(e=t[e]),r.browserEvent=n,e.call(t,r),Sn.contextMenuTouchId=i.identifier}),Sn.longPressTime),s=({clientX:e,clientY:t,type:n})=>{let s="touchend"===n||"pointerup"===n;if(!s){const n=Math.abs(e-i.clientX),r=Math.abs(t-i.clientY);s=n>=5||r>=5}s&&(Sn.contextMenuTouchId=null,o(),clearTimeout(r))},o=Sn.on({element:document,touchmove:s,touchend:s,pointermove:s,pointerup:s,capture:!0})}}}static createDblClickWrapper(e,t,n){let i,r,s;return()=>{r||(r=Sn.on({element:e,touchstart:e=>{i=e.changedTouches[0].identifier,e.preventDefault()},touchend:e=>{if(e.changedTouches[0].identifier===i){e.preventDefault(),clearTimeout(s),i=r=null;const o=dn.from(e.changedTouches[0].target,null,!0),l=e.changedTouches[0].pageX-o.x,a=e.changedTouches[0].pageY-o.y,c=Object.assign({browserEvent:e},e),d=new MouseEvent("dblclick",c);Object.defineProperties(d,{target:{value:e.target},offsetX:{value:l},offsetY:{value:a}}),"string"==typeof t&&(t=n[t]),t.call(n,d)}},once:!0}),s=setTimeout((()=>{r(),i=r=null}),Sn.dblClickTime))}}static toSpecialKey(e,t="ctrlKey"){let n=!1;return!0===e?n=t:"string"==typeof e&&(e=e.toLowerCase()).match(wn)&&(n=`${e}Key`),n}static specialKeyFromEventKey(e){return Cn[e]||""}}n(En,"eventNameMap",{mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseover:"MouseOver",mouseout:"MouseOut",keyup:"KeyUp",keydown:"KeyDown",keypress:"KeyPress"});const Sn=En;Sn.longPressTime=500,Sn.dblClickTime=300,Sn.globalListenerDetacher=Sn.on({element:document,capture:!0,passive:!0,pointerdown({target:e}){var t;const n=gi.getRootElement(e);gi.usingKeyboard=!1,null===(t=n.classList)||void 0===t||t.remove("b-using-keyboard"),gi.removeClsGlobally(n,"b-using-keyboard")},keydown({target:e,key:t}){if(!bn[t]){gi.usingKeyboard=!0;const t=gi.getRootElement(e);t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Array.from(t.children).forEach((e=>{e.matches(".b-outer")&&e.classList.add("b-using-keyboard")})):t.classList.add("b-using-keyboard")}}}),r.isTouchDevice&&Sn.on({element:document,touchmove:e=>{e.target.closest(".b-dragging")&&e.preventDefault()},passive:!1,capture:!0}),En._$name="EventHelper";const Tn={align:"t0-t0"},xn=Node.ELEMENT_NODE,Dn=Node.TEXT_NODE,{isObject:On}=Nt,Mn=/[+-]?\d*\.?\d+[eE]?-?\d*/g,In=Mn.source,Fn=new RegExp(`matrix\\((?:${In}),\\s?(?:${In}),\\s?(?:${In}),\\s?(?:${In}),\\s?(${In}),\\s?(${In})`),kn=new RegExp("matrix3d\\((?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(-?\\d*),\\s?(-?\\d*)"),Ln=new RegExp(`(?:${Fn.source})|(?:${kn.source})`),An=new RegExp(`translate(3d|X)?\\((${In})px(?:,\\s?(${In})px)?`),$n=new RegExp(`translate(3d|Y)?\\((${In})px(?:,\\s?(${In})px)?`),Rn=/\s+/,Pn=/\s*;\s*/,_n=/\s*:\s*/,Nn=/^-?((\d+(\.\d*)?)|(\.?\d+))$/,jn={elementData:"",for:"htmlFor",retainElement:""},Vn={tag:1,html:1,text:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,class:1,className:1,unmatched:1,onlyChildren:1,listeners:1,compareHtml:1,syncOptions:1,keepChildren:1},zn={length:1,parentRule:1,style:1},Bn={INPUT:1,TEXTAREA:1},Wn={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,BODY:1},Hn=globalThis,Un=document,qn=Object.freeze({}),Yn=Array.prototype.slice,Kn=Promise.resolve(),Gn=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],Xn=e=>e._hidden,Jn=(e,t,n)=>"children"===n.key?Nt.mergeItems(e,t,n):Nt.blend(e,t,n),Zn=e=>{const t=e.ownerDocument.defaultView.getComputedStyle(e);return"none"!==t.getPropertyValue("display")&&"hidden"!==t.getPropertyValue("visibility")},Qn=Un.documentElement.getRootNode?e=>e.getRootNode():e=>{for(;e.parentNode;)e=e.parentNode;return e},ei=e=>e&&(e===Un.body||Boolean(e.offsetParent)||(e.ownerDocument.defaultView&&"offsetParent"in e&&"fixed"!==gi.getStyleValue(e,"position")?e.offsetParent:ei(e.parentNode))),ti=e=>e&&(Un.body.contains(e)||(oi=Qn(e))&&(e=>e.host&&e.host instanceof Element)(oi)&&ti(oi.host)),ni=e=>e instanceof Node?e:"string"==typeof e?mi.createElementFromTemplate(e):mi.createElement(e),ii=Object.create(null),ri=(e,t)=>{const n=ii[e]||[S.hyphenate(e),t];return ii[e]||(ii[n[0]]=ii[e]=n),n},si=/b-slide-in-from-\w+/;["top","right","bottom","left","width","height","maxWidth","maxHeight","minWidth","minHeight","borderSpacing","borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","letterSpacing","lineHeight","outlineWidth","textIndent","wordSpacing"].forEach((e=>ri(e,!0)));let oi,li,ai,ci,di=null,ui=0,hi=null;class gi{static async slideIn(e,t=1){const n="b-slide-in-"+(t>0?"next":"previous"),{classList:i}=e,{style:r}=e.parentNode,{overflow:s,overflowX:o,overflowY:l}=r;r.overflow="hidden",i.add(n),await En.waitForTransitionEnd({element:e,animationName:si}),r.overflow=s,r.overflowX=o,r.overflowY=l,i.remove(n)}static isFocusable(e,t=!1){if(!t&&(!mi.isVisible(e)||mi.Widget.fromElement(e,Xn)))return!1;const n=e.nodeName;return Wn[n]||("A"===n||"LINK"===n)&&!!e.href||null!=e.getAttribute("tabIndex")||"true"===e.contentEditable}static isEditable(e){return e.isContentEditable||Bn[e.nodeName]}static isInView(e,t=!1,n){if(!ei(e))return!1;const i=(null==n?void 0:n.positioned)&&"fixed"!==gi.getStyleValue(n.element,"position"),r=dn.from(globalThis),s=t?"contains":"intersect",o=i&&n.element.offsetParent,l=i&&dn.from(o);if(r.height=Un.scrollingElement.scrollHeight,e===Un.body)return r;const a=this.getViewportIntersection(e,r,s);return a&&i&&a.translate(Un.scrollingElement.scrollLeft,Un.scrollingElement.scrollTop),i&&a?a.translate(-l.x+o.scrollLeft,-l.y+o.scrollTop):a}static getViewportIntersection(e,t,n){const{parentNode:i}=e,{parentElement:r}=i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.getRootNode().host:e,s=r.ownerDocument.defaultView.getComputedStyle(r),o="visible"!==s.overflowX||"visible"!==s.overflowY,l=(a=e).ownerSVGElement?a.ownerSVGElement.parentNode:a.offsetParent;var a;let c=dn.from(e,null,!0);for(let i=o?e.parentNode:l;c&&i!==Un.documentElement;i=i.parentNode){i.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&i.host&&(i=i.host.parentNode);const e=i===Un.body,r=i.ownerDocument.defaultView.getComputedStyle(i),s=e?t:dn.inner(i,null,!0);(e||"visible"!==r.overflow)&&(c=s[n](c,!1,!0))}return c}static isVisible(e){const t=e.ownerDocument;for(;e;e=(n=e).parentNode||n.host){if(e===t)return!0;if(e.nodeType===e.ELEMENT_NODE&&!Zn(e))return!1}var n;return!1}static isDOMEvent(e){return e instanceof Event}static merge(e,...t){return Nt.blend(e,t,{merge:Jn})}static normalizeChildren(e,t,n){var i;let r,s,o,l,a,c=null==e?void 0:e.children;if(null!=e&&null!==(i=e.syncOptions)&&void 0!==i&&i.ignoreRefs&&(n=!0),c&&!(e instanceof Node))if(Array.isArray(c))for(s=0;s<c.length;++s)mi.normalizeChildren(c[s],t,n);else for(o in l=c,e.children=c=[],l){var d;r=l[o],null!==(d=r)&&void 0!==d&&d.isWidget&&(r=r.element),a=!o.startsWith("$")&&!mi.isElement(r),a&&(null==t||t(o,!n)),r&&(r instanceof Node||(!1===r.reference?delete r.reference:a&&"string"!=typeof r&&(r.reference=o),mi.normalizeChildren(r,t,n)),c.push(r))}return e}static roundPx(e,t=globalThis.devicePixelRatio||1){const n=1/t;return Math.round(e/n)*n}static floorPx(e,t=globalThis.devicePixelRatio||1){const n=1/t;return Math.floor(e*n)/n}static isCustomElement(e){return Boolean(null==e?void 0:e.shadowRoot)}static elementFromPoint(e,t){let n=document.elementFromPoint(e,t);return mi.isCustomElement(n)&&(n=n.shadowRoot.elementFromPoint(e,t)||n),n}static childFromPoint(e,t,n,i=e){const r=null==n?t:new dn(t,n,0,0);let s=null;return Array.from(e.children).some((e=>{if(dn.from(e,i).contains(r))return s=e.children.length&&mi.childFromPoint(e,r,null,i)||e,!0})),s}static unitize(e,t,n="px"){const[i,r]=ri(e);return null!=t&&(t=String(t),t=r&&Nn.test(t)?t+n:t),[i,t]}static get activeElement(){let e=document.activeElement;for(;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}static getActiveElement(e){var t,n;null!==(t=e)&&void 0!==t&&t.isWidget&&(e=e.element);let i=((null===(n=e)||void 0===n?void 0:n.getRootNode())||document).activeElement;for(;null!==(r=i)&&void 0!==r&&r.shadowRoot;){var r;i=i.shadowRoot.activeElement}return i}static getRootElement(e){var t;const n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e),{nodeType:i}=n;return i===Node.DOCUMENT_NODE?n.body:i===Node.DOCUMENT_FRAGMENT_NODE?n:e.ownerDocument.contains(e)?e.ownerDocument.body:null}static getOutermostElement(e){var t,n;const i=null===(t=(n=e).getRootNode)||void 0===t?void 0:t.call(n);if(null!=i&&i.body)return null==i?void 0:i.body;for(;e.parentNode!==i&&e.parentNode;)e=e.parentNode;return e}static isValidFloatRootParent(e){return e===document.body||"ShadowRoot"===e.constructor.name}static getId(e){return e.id||(e.id="b-element-"+ ++ui)}static getCommonAncestor(e,t){if(e===t)return e;for(;e&&!(null!==(n=(i=e)[e.isWidget?"owns":"contains"])&&void 0!==n&&n.call(i,t)||e===t);){var n,i;e=e.owner||e.parentNode}return e}static getElement(e){return e instanceof Element?e:Un.querySelector(e)}static setAttributes(e,t){const n=mi.getElement(e);if(n&&t)for(const e in t)null==t[e]?n.removeAttribute(e):n.setAttribute(e,t[e])}static setLength(e,t,n){var i,r;1===arguments.length?n="number"==typeof e?`${e}px`:null!==(i=e)&&void 0!==i?i:"":n=(e=mi.getElement(e)).style[t]="number"==typeof n?`${n}px`:null!==(r=n)&&void 0!==r?r:"";return n}static percentify(e,t=2){const n=Math.pow(10,t);return null==e||""===e||isNaN(e)?"":Math.round(e*n)/n+"%"}static getChild(e,t){return e.querySelector(":scope>"+t)}static hasChild(e,t){return null!=mi.getChild(e,t)}static children(e,t){return(">"===t[0]||t.startsWith("# "))&&("#"===t[0]&&(t=t.substr(2)),t=":scope "+t),Array.from(e.querySelectorAll(t))}static getChildElementCount(e){return e.childElementCount}static down(e,t){return e?e.matches&&e.matches(t)?e:(t=":scope "+t,e.querySelector(t)):null}static isDescendant(e,t){const n=mi.getRootElement(e),i=mi.getRootElement(t);return i&&n!==i&&i.host?mi.isDescendant(n,i.host):e.contains(t)}static getEventElement(e,t="target"){return!e||mi.isElement(e)?e:e[t]}static isElement(e){return(null==e?void 0:e.nodeType)===document.ELEMENT_NODE&&mi.isNode(e)}static isReactElement(e){return(null==e?void 0:e.$$typeof)===Symbol.for("react.element")}static isNode(e){return Boolean(e)&&"number"==typeof e.nodeType&&!On(e)}static forEachSelector(e,t,n){if("string"==typeof e)throw new Error("DomHelper.forEachSelector must provide a root element context (for shadow root scenario)");mi.children(e,t).forEach(n)}static forEachChild(e,t){Array.from(e.children).forEach(t)}static removeEachSelector(e,t){mi.forEachSelector(e,t,(e=>e.remove()))}static removeClsGlobally(e,...t){t.forEach((t=>mi.forEachSelector(e,"."+t,(e=>e.classList.remove(t)))))}static isOrphaned(e){return!ti(e)}static up(e,t){return A.deprecate("Core","6.0.0","DomHelper.up() deprecated, use native `element.closest()` instead"),e.closest(t)}static getAncestor(e,t,n=null){let i,r=!1,s=e;for(t=he.asArray(t);s=s.parentElement;){if(t.includes(s)){r=!0;break}if(n&&s===n)break;i=s}return r?i||e:null}static getParents(e){const t=[];for(;e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}static makeValidId(e,t=""){return S.makeValidDomId(e,t)}static createElement(e={},n){var i,r,s;let o,l,a,c,d,u,h,g,m,p,f,v=n;if("boolean"==typeof v)throw new Error("Clean up");n&&(d=n.ignoreRefs,m=n.refOwner,p=n.refs,v=n.returnAll,f=n.syncIdField,d&&(a=!0,d="children"!==d)),"string"==typeof e.parent&&(e.parent=document.getElementById(e.parent));const y=e.parent||e.nextSibling&&e.nextSibling.parentNode,{dataset:b,html:C,reference:w,syncOptions:E,text:S}=e;if(E&&(f=E.syncIdField||f,c=E.ignoreRefs,c&&(a=!0,d="children"!==c,n=t(t({},n),{},{ignoreRefs:!0}))),d&&(m=null),o=e.ns?Un.createElementNS(e.ns,e.tag||"svg"):Un.createElement(e.tag||"div"),null!=S?mi.setInnerText(o,S):null!=C&&(C instanceof DocumentFragment?o.appendChild(C):o.innerHTML=C),e.tooltip&&mi.Widget.attachTooltip(o,e.tooltip),e.style&&mi.applyStyle(o,e.style),b)for(h in b)g=b[h],null!=g&&(o.dataset[h]=g);y&&this.addChild(y,o,e.nextSibling),m&&(o.$refOwnerId=m.id),w&&!d&&(m?(o.$reference=w,m.attachRef(w,o,e)):(p||((n=Object.assign({},n)).refs=p={}),p[w]=o,o.setAttribute("data-reference",w)));const T=e.className||e.class,x=Object.keys(e);for(T&&o.setAttribute("class",gn.normalize(T)),l=0;l<x.length;++l)h=x[l],g=e[h],null!=(u=jn[h])?o[u||h]=g:!Vn[h]&&h&&null!=g&&o.setAttribute(h,g);return e["aria-hidden"]||e.role||e.tabIndex||gi.isFocusable(o,!0)||o.htmlFor||o.setAttribute("role","presentation"),null===(i=n)||void 0===i||null===(r=i.callback)||void 0===r||r.call(i,{action:"newElement",domConfig:e,targetElement:o,syncId:m?w:n.syncIdField&&(null===(s=e.dataset)||void 0===s?void 0:s[n.syncIdField])}),!0===v?n.returnAll=v=[o]:Array.isArray(v)&&v.push(o),e.children&&(f&&(o.syncIdMap={}),e.children.forEach((i=>{if(i)if("string"==typeof i){const e=document.createTextNode(i);m&&(e.$refOwnerId=m.id),o.appendChild(e)}else if(isNaN(i.nodeType)){var r,s,l;i.parent=o,!i.ns&&e.ns&&(i.ns=e.ns);const c=mi.createElement(i,t(t({},n),{},{ignoreRefs:null!==(r=null===(s=e.syncOptions)||void 0===s?void 0:s.ignoreRef)&&void 0!==r?r:a})),d=null===(l=i.dataset)||void 0===l?void 0:l[f];null!=d&&(o.syncIdMap[d]=c),delete i.parent}else o.appendChild(i)}))),o.lastDomConfig=e,p||v||o}static createElementFromTemplate(e,t=qn){const{array:n,raw:i,fragment:r}=t;let s;if(mi.supportsTemplate){if((li||(li=Un.createElement("template"))).innerHTML=e,s=li.content,r)return s.cloneNode(!0)}else if(s=(ai||(ai=new DOMParser)).parseFromString(e,"text/html").body,r){const e=s.childNodes;for(s=document.createDocumentFragment();e.length;)s.appendChild(e[0]);return s}return s=i?s.childNodes:s.children,1!==s.length||n?Yn.call(s):s[0]}static triggerMouseEvent(e,t="contextmenu"){const n=(this.isInView(e)||dn.from(e)).center,i=new MouseEvent(t,{clientX:n.x,clientY:n.y,bubbles:!0});e.dispatchEvent(i)}static insertFirst(e,t){return t&&t.nodeType!==xn&&t.tag&&(t=mi.createElement(t)),e.insertBefore(t,e.firstElementChild)}static insertBefore(e,t,n){return t&&t.nodeType!==xn&&t.tag&&(t=mi.createElement(t)),n?e.insertBefore(t,n):mi.insertFirst(e,t)}static insertAt(e,t,n){const i=Array.from(e.children);if(n>=i.length)return mi.append(e,t);const r=i[n];return mi.insertBefore(e,t,r)}static append(e,t){if(t.forEach){if(Array.isArray(t)&&(t=t.map((e=>ni(e)))),e.append)e.append(...t);else{const n=document.createDocumentFragment();t.forEach((function(e){n.appendChild(e)})),e.appendChild(n)}return t}return e.appendChild(ni(t))}static getTranslateX(e){const t=e.style.transform;let n=An.exec(t);return n?parseFloat(n[2]):(n=Ln.exec(t)||Ln.exec(mi.getStyleValue(e,"transform")),n?parseFloat(n[1]||n[3]):0)}static getTranslateY(e){const t=e.style.transform;let n=$n.exec(t);if(n){const e=parseFloat(n["Y"===n[1]?2:3]);return isNaN(e)?0:e}return n=Ln.exec(t)||Ln.exec(mi.getStyleValue(e,"transform")),n?parseFloat(n[2]||n[4]):0}static getTranslateXY(e){return[mi.getTranslateX(e),mi.getTranslateY(e)]}static getOffsetX(e,t=null){return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}static getOffsetY(e,t=null){return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}static getOffsetXY(e,t=null){return[mi.getOffsetX(e,t),mi.getOffsetY(e,t)]}static focusWithoutScrolling(e){if(!r.isSafari)e.focus({preventScroll:!0});else{const t=mi.getParents(e).map((e=>({element:e,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop})));e.focus(),setTimeout((()=>function(e){e.forEach((({element:e,scrollLeft:t,scrollTop:n})=>{e.scrollLeft!==t&&(e.scrollLeft=t),e.scrollTop!==n&&(e.scrollTop=n)}))}(t)),0)}}static getPageX(e){return e.getBoundingClientRect().left+Hn.pageXOffset}static getPageY(e){return e.getBoundingClientRect().top+Hn.pageYOffset}static getExtremalSizePX(e,t){const n=S.hyphenate(t),i=n.split("-")[1];let r=mi.getStyleValue(e,n);return r=/%/.test(r)?e.parentElement?parseInt(mi.getStyleValue(e.parentElement,i),10):NaN:parseInt(r,10),r}static setScale(e,t,n=t){const i=mi.getStyleValue(e,"transform").split(/,\s*/);i.length>1?(i[0].startsWith("matrix3d")?(i[0]=`matrix3d(${t}`,i[5]=n):(i[0]=`matrix(${t}`,i[3]=n),e.style.transform=i.join(",")):e.style.transform=`scale(${t}, ${n})`}static setTranslateX(e,t){const n=mi.getStyleValue(e,"transform").split(/,\s*/);t=mi.roundPx(t),n.length>1?(n[n[0].startsWith("matrix3d")?12:4]=t,e.style.transform=n.join(",")):e.style.transform=`translateX(${t}px)`}static setTranslateY(e,t){const n=mi.getStyleValue(e,"transform").split(/,\s*/);t=mi.roundPx(t),n.length>1?(n[n[0].startsWith("matrix3d")?13:5]=t,e.style.transform=n.join(",")+")"):e.style.transform=`translateY(${t}px)`}static setTop(e,t){mi.setLength(e,"top",t)}static setLeft(e,t){mi.setLength(e,"left",t)}static setTopLeft(e,t,n){mi.setLength(e,"top",t),mi.setLength(e,"left",n)}static setRect(e,{x:t,y:n,width:i,height:r}){mi.setTopLeft(e,n,t),mi.setLength(e,"width",i),mi.setLength(e,"height",r)}static setTranslateXY(e,t,n){if(null==t)return mi.setTranslateY(e,n);if(null==n)return mi.setTranslateX(e,t);t=mi.roundPx(t),n=mi.roundPx(n);const i=mi.getStyleValue(e,"transform").split(/,\s*/),r=i[0].startsWith("matrix3d");i.length>1?(i[r?12:4]=t,i[r?13:5]=n,e.style.transform=i.join(",")+")"):e.style.transform=`translate(${t}px, ${n}px)`}static addTranslateX(e,t){mi.setTranslateX(e,mi.getTranslateX(e)+t)}static addTranslateY(e,t){mi.setTranslateY(e,mi.getTranslateY(e)+t)}static addLeft(e,t){mi.setLeft(e,mi.getOffsetX(e)+t)}static addTop(e,t){mi.setTop(e,mi.getOffsetY(e)+t)}static alignTo(e,t,n=Tn,i){t=t instanceof dn?t:dn.from(t,!0);const r=mi.getTranslateXY(e),s=dn.from(e,!0);i&&(s.roundPx(),t.roundPx());const o=s.alignTo(Object.assign(n,{target:t}));mi.setTranslateXY(e,r[0]+o.x-s.x,r[1]+o.y-s.y)}static getStyleValue(e,t,n,i){const r=n?e.style:e.ownerDocument.defaultView.getComputedStyle(e,i);if(Array.isArray(t)){const e={};for(const n of t)e[n]=r.getPropertyValue(S.hyphenate(n));return e}return r.getPropertyValue(S.hyphenate(t))}static getEdgeSize(e,t,n){const i="border"===t?"-width":"",r={raw:{}};for(const s of["top","right","bottom","left"])n&&!n.includes(s[0])||(r[s]=parseFloat(r.raw[s]=mi.getStyleValue(e,`${t}-${s}${i}`)));return r.width=(r.left||0)+(r.right||0),r.height=(r.top||0)+(r.bottom||0),r}static parseStyle(e){if("string"==typeof e){const t=e.split(Pn);e={};for(let n=0,{length:i}=t;n<i;n++){const i=t[n].split(_n);e[i[0]]=i[1]}}return e||{}}static applyStyle(e,t,n=!1){if("string"==typeof t)n?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else if(t){let i,r;for(i in n&&(e.style.cssText=""),t.style&&"string"!=typeof t.style&&(t=Nt.assign({},t,t.style)),t)zn[i]||([i,r]=mi.unitize(i,t[i]),null==r?e.style.removeProperty(i):e.style.setProperty(i,r));"string"==typeof t.style&&(e.style.cssText+=t.style)}}static getCSSText(e){if("string"==typeof e)return e;let t="";for(const n in e)zn[n]||(t+=`${S.hyphenate(n)}:${e[n]};`);return t}static addClasses(e,t){A.deprecate("Core","6.0.0","DomHelper.addClasses should be replaced by native classList.add"),e.classList.add(...t)}static removeClasses(e,t){A.deprecate("Core","6.0.0","DomHelper.removeClasses should be replaced by native classList.remove"),e.classList.remove(...t)}static toggleClasses(e,t,n=null){t=he.asArray(t),!0===n?e.classList.add(...t):!1===n?e.classList.remove(...t):t.forEach((t=>e.classList.toggle(t)))}static addTemporaryClass(e,t,n,i=globalThis){n>0&&(e.classList.add(t),i.setTimeout({fn:t=>e.classList.remove(t),delay:n,name:t,args:[t],cancelOutstanding:!0}))}static getPropertyTransitionDuration(e,t){const n=globalThis.getComputedStyle(e),i=n.transitionProperty.split(", "),r=n.transitionDuration.split(", "),s=i.indexOf(S.hyphenate(t));let o;return-1!==s&&(o=1e3*parseFloat(r[s])),o}static getAnimationDuration(e){return 1e3*parseFloat(mi.getStyleValue(e,"animation-duration"))}static highlight(e,t=globalThis){return e instanceof dn?e.highlight():new Promise((n=>{t.setTimeout((()=>{e.classList.add("b-fx-highlight"),t.setTimeout((()=>{e.classList.remove("b-fx-highlight"),n()}),1e3)}),0)}))}static get scrollBarWidth(){if(null===di&&Un.body){const e=ci||(ci=mi.createElement({parent:Un.body,style:"position:absolute;top:-9999em;height:100px;overflow-y:scroll"}));e.parentNode!==Un.body&&Un.body.appendChild(e),di=e.offsetWidth}return di}static get scrollBarPadElement(){return{className:"b-yscroll-pad",children:[{className:"b-yscroll-pad-sizer"}]}}static resetScrollBarWidth(){di=null}static measureText(e,t,n=!1,i){const r=mi.getMeasureElement(t,i);r[n?"innerHTML":"innerText"]=e;const s=r.clientWidth;return r.className="",s}static measureSize(e,t,n=!0){if(!e)return 0;if("number"==typeof e)return e;if(!e.length)return 0;if(/^\d+(px)?$/.test(e))return parseInt(e);if(t){const i=mi.getMeasureElement(t);i.innerHTML="",i.style.width=mi.setLength(e);const r=n?i.offsetWidth:i.getBoundingClientRect().width;return i.style.width=i.className="",r}return/^\d+em$/.test(e)?14*parseInt(e):isNaN(e)?0:parseInt(e)}static getMeasureElement(e,t=Un.body){const n=Hn.getComputedStyle(e),i=t.offScreenDiv=t.offScreenDiv||mi.createElement({parent:t,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},{returnAll:!0})[1];return Gn.forEach((e=>{i.style[e]!==n[e]&&(i.style[e]=n[e])})),i.className=e.className,i.parentElement.parentElement!==t&&t.appendChild(i.parentElement),i}static stripTags(e){return(mi.$domParser||(mi.$domParser=new DOMParser)).parseFromString(e,"text/html").body.textContent}static sync(e,t){if("string"==typeof e){if(""===e)return void(t.innerHTML="");e=mi.createElementFromTemplate(e)}return mi.performSync(e,t),t}static performSync(e,t){return e.outerHTML!==t.outerHTML&&(mi.syncAttributes(e,t),mi.syncContent(e,t),mi.syncChildren(e,t),!0)}static getSyncAttributes(e){const t={},n=[];for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i];if(r.specified){const e=r.name.toLowerCase();t[e]=r.value,n.push(e)}}return{attributes:t,names:n}}static syncAttributes(e,t){const{attributes:n,names:i}=mi.getSyncAttributes(e),{attributes:r,names:s}=mi.getSyncAttributes(t),o=i.includes("dataset"),l=i.filter((e=>!s.includes(e))),a=s.filter((e=>!(i.includes(e)||o&&e.startsWith("data-")))),c=i.filter((e=>s.includes(e)));if(l.length>0)for(let e=0;e<l.length;e++){const i=l[e];"style"===i?mi.applyStyle(t,n.style,!0):"dataset"===i?Object.assign(t.dataset,n.dataset):t.setAttribute(i,n[i])}if(a.length>0)for(let e=0;e<a.length;e++)t.removeAttribute(a[e]);if(c.length>0)for(let e=0;e<c.length;e++){const i=c[e];if("style"===i)mi.applyStyle(t,n.style,!0);else if("dataset"===i)Object.assign(t.dataset,n.dataset);else if("class"!==i||!n.class.isDomClassList&&"object"!=typeof n.class)r[i]!==n[i]&&t.setAttribute(i,n[i]);else{let e;e=n.class.isDomClassList?n.class:new gn(n.class),e.isEqual(r.class)||t.setAttribute("class",e)}}}static syncContent(e,t){0===mi.getChildElementCount(e)&&(t.innerText=e.innerText)}static setInnerText(e,t){const{firstChild:n}=e;(null==n?void 0:n.nodeType)===Element.TEXT_NODE?n.data=t:e.textContent=t}static syncChildren(e,t){const n=this,i=Yn.call(e.childNodes),r=Yn.call(t.childNodes);for(;i.length;){const e=i.shift(),s=r.shift();if(e&&e.nodeType!==Dn&&e.nodeType!==xn)throw new Error(`Source node type ${e.nodeType} not supported by DomHelper.sync()`);if(s&&s.nodeType!==Dn&&s.nodeType!==xn)throw new Error(`Target node type ${s.nodeType} not supported by DomHelper.sync()`);if(s)if(e.nodeType===s.nodeType)e.nodeType===Dn?s.data=e.data:e.tagName===s.tagName?n.performSync(e,s):(t.insertBefore(e,s),s.remove());else{if(e.nodeType!==Dn||s.nodeType!==xn){const t=e.parentElement||e;throw new Error(`Currently no support for transforming nodeType.\n${t.outerHTML}`)}t.innerText=e.data.trim()}else t.appendChild(e)}r.forEach((e=>{e.remove()}))}static syncClassList(e,t){const{classList:n}=e,i="string"==typeof t,r=i?t.split(Rn):gn.normalize(t,"array"),s=r.length;let o,l=n.length!==s;for(o=0;!l&&o<s;o++)l=!n.contains(r[o]);return l&&(e.className=i?t:r.join(" ")),l}static updateClassList(e,t){const{classList:n}=e;let i,r,s=!1;for(i in t)r=Boolean(t[i]),n.contains(i)!==r&&(n[r?"add":"remove"](i),s=!0);return s}static setTheme(e,t){e=e.toLowerCase();const{head:n}=document,i=mi.getThemeInfo(t).name.toLowerCase();let r=n.querySelectorAll("[data-bryntum-theme]:not([data-loading])"),s=0;if(i===e)return Kn;mi.removeEachSelector(n,"#bryntum-theme[data-loading],link[data-bryntum-theme][data-loading]");const o={theme:e,prev:i};function l(t,n,l){const a=gi.createElement({tag:"link",rel:"stylesheet",dataset:{loading:!0,bryntumTheme:!0},href:t.href.replace(i,e),nextSibling:t});a.addEventListener("load",(()=>{delete a.dataset.loading,hi=null,++s===r.length&&(r.forEach((e=>e.remove())),Mi.trigger("theme",o),n(o))})),a.addEventListener("error",(e=>{delete a.dataset.loading,l(e)}))}if(r.length)return new Promise(((e,t)=>{r.forEach(((n,i)=>{l(n,e,t,r.length)}))}));{const e=n.querySelector("#bryntum-theme:not([data-loading])")||n.querySelector(`[href*="${i}.css"]:not([data-loading])`);if(null==e||!e.href.includes(`${i}.css`))throw new Error(`Theme link for ${i} not found`);return r=[e],new Promise(((t,n)=>l(e,t,n)))}}static get themeInfo(){return gi.getThemeInfo()}static getThemeInfo(e){if(!hi){const t=mi.createElement({parent:document.body,className:"b-theme-info"}),n=mi.getStyleValue(t,"content",!1,":before");if(n)try{hi=JSON.parse(n.replace(/^["']|["']$|\\/g,""))}catch(e){hi=null}hi=hi||(e?{name:e}:null),t.remove()}return hi}static async transition({element:e,selector:t="[data-dom-transition]",duration:n,action:i,thisObj:r=this,addTransition:s={},removeTransition:o={}}){const l=new Set,a=Array.from(e.querySelectorAll(t)),c=new Map(a.map((t=>{let n=0,i=t.parentElement;for(;i&&i!==e;)n++,i=i.parentElement;t.$depth=n,t.scrollHeight>t.offsetHeight&&"auto"===getComputedStyle(t).overflow&&(t.$scrollTop=t.scrollTop,l.add(t));const{parentElement:r}=t,s=dn.from(t,e),o=dn.from(t,r),a=getComputedStyle(r),c=parseFloat(a.borderLeftWidth);return c&&(s.left-=c,o.left-=c),[t.id,{element:t,globalBounds:s,localBounds:o,depth:n,parentElement:r}]})));i.call(r);const d=Array.from(e.querySelectorAll(t)),u=new Map(d.map((t=>{const n=dn.from(t,e),i=dn.from(t,t.parentElement),r=globalThis.getComputedStyle(t.parentElement),s=parseFloat(r.borderLeftWidth);return s&&(n.left-=s,i.left-=s),[t.id,{element:t,globalBounds:n,localBounds:i}]}))),h=["position","top","left","width","height","padding","margin","zIndex","minWidth","minHeight","opacity","overflow"];for(const[t,n]of c){const i=u.get(t);if(i){const{element:t}=i,{style:r,parentElement:s}=t,o=parseInt(mi.getStyleValue(t,"zIndex")),{globalBounds:a,localBounds:c,depth:d,parentElement:u}=n,g=u!==s;let m;Nt.copyProperties(t.$initial={parentElement:s},r,h),g?(i.bounds=i.globalBounds,m=a,e.appendChild(t)):(i.bounds=i.localBounds,m=c,u.appendChild(t));let p="hidden";l.has(t)&&(t.$scrollPlaceholder=mi.createElement({parent:t,style:{height:t.scrollHeight}}),p="auto"),Object.assign(r,{position:"absolute",top:`${m.top}px`,left:`${m.left}px`,width:`${m.width}px`,height:`${m.height}px`,minWidth:0,minHeight:0,padding:0,margin:0,zIndex:d+(o||0),overflow:p}),i.processed=!0}else{const{element:e,localBounds:i,depth:r,parentElement:s}=n;e.$initial={removed:!0},Object.assign(e.style,{position:"absolute",top:`${i.top}px`,left:`${i.left}px`,width:`${i.width}px`,height:`${i.height}px`,minWidth:0,minHeight:0,padding:0,margin:0,zIndex:r,overflow:"hidden"}),s.appendChild(e),u.set(t,{element:e,bounds:i,removed:!0,processed:!0}),d.push(e)}}for(const[,e]of u)if(!e.processed){const{element:t}=e,{style:n,parentElement:i}=t,r=e.bounds=e.localBounds;t.classList.add("b-dom-transition-adding"),Nt.copyProperties(t.$initial={parentElement:i},n,h),Object.assign(n,{position:"absolute",top:s.top?0:`${r.top}px`,left:s.left?0:`${r.left}px`,width:s.width?0:`${r.width}px`,height:s.height?0:`${r.height}px`,opacity:s.opacity?0:null,zIndex:i.$depth+1,overflow:"hidden"})}for(const e of l)e.scrollTop=e.$scrollTop;e.classList.add("b-dom-transition"),e.firstElementChild.offsetWidth;for(const[,{element:e,bounds:t,removed:n}]of u)n?Object.assign(e.style,{top:o.top?0:`${t.top}px`,left:o.left?0:`${t.left}px`,width:o.width?0:`${t.width}px`,height:o.height?0:`${t.height}px`,opacity:o.opacity?0:e.$initial.opacity}):Object.assign(e.style,{top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`,opacity:e.$initial.opacity});await Re.sleep(n),e.classList.remove("b-dom-transition");for(const e of d)e.$initial&&(e.$initial.removed?e.remove():(Nt.copyProperties(e.style,e.$initial,h),e.$scrollPlaceholder&&(e.$scrollPlaceholder.remove(),delete e.$scrollPlaceholder),e.classList.remove("b-dom-transition-adding"),e.$initial.parentElement.appendChild(e)));for(const e of l)e.scrollTop=e.$scrollTop,delete e.$scrollTop}static async loadScript(e){return new Promise(((t,n)=>{const i=document.createElement("script");i.src=e,i.onload=t,i.onerror=n,document.head.appendChild(i)}))}static isNamedColor(e){return e&&!/^(#|hsl|rgb|hwb)/.test(e)}static get NodeFilter(){return NodeFilter}static addChild(e,t,n){e.insertBefore(t,n)}}const mi=gi;let pi;const fi=()=>mi.isTouchEvent=!1,vi=()=>{mi.isTouchEvent=!0,clearTimeout(pi),pi=setTimeout(fi,400)};if(Un.addEventListener("touchstart",vi,!0),Un.addEventListener("touchend",vi,!0),mi.canonicalStyles=ii,mi.supportsTemplate="content"in Un.createElement("template"),mi.elementPropKey="$bryntum",mi.numberRe=Mn,!("children"in Node.prototype)){const e=e=>e.nodeType===e.ELEMENT_NODE;Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,e)}})}Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){const t=(this.document||this.ownerDocument).querySelectorAll(e);let n=t.length;for(;--n>=0&&t.item(n)!==this;);return n>-1}),Hn.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(e){let t=this;if(!Un.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&t.nodeType===t.ELEMENT_NODE);return null}:Node.prototype.closest=function(e){var t;return null===(t=this.parentNode)||void 0===t?void 0:t.closest(e)},[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),globalThis.addEventListener("resize",(()=>di=null)),gi._$name="DomHelper";const yi=e=>e.floating,bi=new class extends(de.mixin($e)){suspendFocusEvents(){Di=!0}resumeFocusEvents(){Di=!1}setupFocusListenersOnce(e,t){e&&!bi.observedElements.has(e)&&(bi.setupFocusListeners(e,t),bi.observedElements.add(e))}setupFocusListeners(e=document,t,n=!1){var i;const r={element:e,touchstart(e){wi=wi||1!==e.changedTouches.length?null:e.changedTouches[0]},touchend:{handler:e=>{wi&&(wi.identifier===t.contextMenuTouchId?(e.stopImmediatePropagation(),e.preventDefault()):1===e.changedTouches.length&&e.changedTouches[0].identifier===wi.identifier&&bi.trigger("globaltap",{event:e}),wi=null)},passive:!1},mousedown:{handler:e=>{Ei="mouse",wi||bi.trigger("globaltap",{event:e}),Ti=e;const t=e.ctrlKey||e.altKey||e.shiftKey||e.metaKey;!Si&&t?Si=new KeyboardEvent("keydown",{key:e.ctrlKey?"Control":e.shiftKey?"Shift":e.altKey?"Alt":"Meta",ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey}):Si&&!t&&(Si=null)},passive:!1},mouseup(){Ti=null},keydown(e){Ei="key",Si=e},keypress(){Ei="key"},keyup(){Si=null},focusin(e){const{Widget:t}=bi;if(t.resetFloatRootScroll(),Di)return;const n=e.relatedTarget?e.relatedTarget instanceof HTMLElement?e.relatedTarget:document.body:null,i=e.target||document.body,r=t.fromElement(n),s=t.fromElement(i),o=gi.getCommonAncestor(r,s),l=!!(n&&4&i.compareDocumentPosition(n)),a=t.query(Ci);let c=null;if(c=i&&i!==document.body?gi.getActiveElement(i):gi.getActiveElement(document),a&&!a._isRevertingFocus&&(!s||!a.owns(s)&&!(4&a.element.compareDocumentPosition(s.element)&&s.up(yi))))return a.focus();let d=Oi("focusout",n,e.target,r,s,l);for(let t,n=r;n&&n!==o;n=t)if(t=n.owner,!n.isDestroying&&n.onFocusOut&&(n.onFocusOut(d),e.target&&c!==gi.getActiveElement(e.target)))return;if(o&&e.target===o.element)!o.isDestroying&&gi.getActiveElement(o)===i&&o.focusElement&&o.focusElement!==o.element&&(o.element.contains(c)&&!o.focusDescendant||o.setTimeout((()=>{var e;return null===(e=o.focus)||void 0===e?void 0:e.call(o)}),0));else{d=Oi("focusin",i,n,r,s,l);for(let e=s;e&&e!==o;e=e.owner){var u,h;if(!e.isDestroying)null===(u=(h=e).onFocusIn)||void 0===u||u.call(h,d)}}const g=gi.getCommonAncestor((null==n?void 0:n.nodeType)===Element.ELEMENT_NODE?n:null,i)||i.parentNode;g&&(d=Oi("focusmove",i,n,r,s,l,{bubbles:!0}),g.dispatchEvent(d))},focusout(e){if(!(Di||e.relatedTarget&&bi.Widget.fromElement(e.relatedTarget))){const t=e.relatedTarget&&e.relatedTarget instanceof HTMLElement?e.relatedTarget:null;r.focusin({target:t,relatedTarget:e.target}),Si=Ti=null}},blur:{element:window,handler(e){e.target===window&&(Si=null,Ti=null)}},capture:!0,passive:!0};n&&(null===(i=xi)||void 0===i||i()),xi=this.detachEvents=t.on(r)}get lastInteractionType(){return Ei}get shiftKeyDown(){var e;return null===(e=Si)||void 0===e?void 0:e.shiftKey}get ctrlKeyDown(){var e,t;return(null===(e=Si)||void 0===e?void 0:e.ctrlKey)||(null===(t=Si)||void 0===t?void 0:t.metaKey)}get altKeyDown(){var e;return null===(e=Si)||void 0===e?void 0:e.altKey}isKeyDown(e){var t;return e?(null===(t=Si)||void 0===t?void 0:t.key)===e||!0===Si[(null==e?void 0:e.toLowerCase())+"Key"]:Boolean(Si)}isMouseDown(e=0){var t;return(null===(t=Ti)||void 0===t?void 0:t.button)===e}get currentMouseDown(){return Ti}get currentKeyDown(){return Si}},Ci=e=>e.isVisible&&e.isTopModal;bi.observedElements=new Set;let wi,Ei,Si,Ti,xi,Di=!1;function Oi(e,t,n,i,r,s,o){const l=new CustomEvent(e,o);return Object.defineProperty(l,"_target",{get:()=>t}),Object.defineProperty(l,"relatedTarget",{get:()=>n}),l.fromWidget=i,l.toWidget=r,l.backwards=s,l}var Mi=bi;class Ii extends(de.mixin($e,Ye)){static get configurable(){return{clientListeners:null,disabled:!1,client:null,keyMap:null}}updateClient(e){this.owner||(this.owner=e)}updateKeyMap(e){const{client:t}=this;t.keyMap=t.mergeKeyMaps(t.keyMap,e,S.uncapitalize(this.constructor.$name))}static initPlugins(e,...t){const n=e.plugins||(e.plugins={});for(const i of t)n[i.$$name]=new i(e)}get enabled(){return!this.disabled}getFocusRevertTarget(){var e;return null===(e=this.client)||void 0===e?void 0:e.getFocusRevertTarget()}construct(...e){const t=this;let n,[i,r]=e;1===e.length?Nt.isObject(i)&&(r=i,i=r.client):(r=Nt.assign({},r),delete r.client),t.client=i,super.construct(r),t.applyPluginConfig(i),n=t.clientListeners,n&&(n=Nt.assign({},n),n.thisObj=t,i.ion(n))}applyPluginConfig(e){const t=this,n=t.pluginConfig||t.constructor.pluginConfig;if(n){const{assign:i,chain:r,after:s,before:o,override:l}=n;i&&t.applyAssign(e,i),(r||s)&&t.applyChain(e,r||s),o&&t.applyChain(e,o,!1),l&&t.applyOverride(e,l)}}applyAssign(e,t){t.forEach((t=>this.assign(e,t)))}applyChain(e,t,n=!0){if(Array.isArray(t))for(const i of t)this.chain(e,i,i,n);else for(const i in t)this.chain(e,i,t[i],n)}applyOverride(e,t){const n=this;n.overridden||(n.overridden={}),t.forEach((t=>{if(!n[t])throw new Error(`Trying to chain fn ${e.$$name}#${t}, but plugin fn ${n.$$name}#${t} does not exist`);"function"==typeof e[t]&&(n.overridden[t]=e[t].bind(e)),e[t]=n[t].bind(n)}))}assign(e,t){const n=this,i=function(e,t){const n=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),t);return n&&(n.get||n.set)?n:null}(n,t);i?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:i.get&&i.get.bind(n),set:i.set&&i.set.bind(n)}):e[t]=n[t].bind(n)}chain(e,t,n,i=!0){let r=0;"object"==typeof t&&(t=t.fn),"object"==typeof n&&(r=n.prio||0,n=n.fn);const s=this,o=e.pluginFunctionChain||(e.pluginFunctionChain={}),l=s[n]&&s[n].bind(s),a=s.functionChainRunner;if(!l)throw new Error(`Trying to chain fn ${e.$$name}#${n}, but plugin fn ${s.$$name}#${n} does not exist`);if(!o[t]){let n=e[t];n&&(n=n.bind(e),n.$this=e,n.$prio=0),o[t]=n?[n]:[],e[t]=(...e)=>a(o[t],e)}l.$this=s,l.$prio=r,o[t][i?"push":"unshift"](l),o[t].$sorted=!1}functionChainRunner(e,t){let n,i,r;for(e.$sorted||(e.sort(((e,t)=>t.$prio-e.$prio)),e.$sorted=!0),i=0;i<e.length&&(n=e[i],n.$this.isDestroyed||(r=n(...t),!1!==r));i++);return r}doDisable(e){const t=this,{constructor:n}=t,i="featureClass"in n?n.featureClass:`b-${n.$$name.toLowerCase()}`;var r,s;i&&(null===(r=t.client)||void 0===r||null===(s=r.element)||void 0===s||s.classList[e?"remove":"add"](i));t.isConfiguring||(e?t.trigger("disable"):t.trigger("enable"))}updateDisabled(e){this.doDisable(e)}throwOverrideIsMissing(e){throw new Error(`Trying to override fn ${e.plugIntoName}#${e.fnName}, but plugin fn ${e.pluginName}#${e.fnName} does not exist`)}get rootElement(){return this.client.rootElement}}n(Ii,"$name","InstancePlugin"),Ii._$name="InstancePlugin";var Fi=e=>class extends(e||de){static get $name(){return"Pluggable"}get plugins(){return this._plugins||(this._plugins={}),this._plugins}set plugins(e){e&&(Array.isArray(e)||(e=[e]),Ii.initPlugins(this,...e)),this.initPlugins()}initPlugins(){}addPlugins(...e){Ii.initPlugins(this,...e)}hasPlugin(e){return null!=this.getPlugin(e)}getPlugin(e){var t;return"function"==typeof e&&(e=e.$$name),null===(t=this.plugins)||void 0===t?void 0:t[e]}get widgetClass(){}};const{defineProperty:ki}=Reflect;let Li;Li=r.isBrowserEnv?globalThis.performance:{now:()=>(new Date).getTime()};let Ai=null;if(A.isTestEnv){const e=globalThis.bryntum||(globalThis.bryntum={});Ai=e.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,idleCallbacks:new Map,isEmpty:(e=!1)=>Ai.timeouts.size+Ai.animationFrames.size+Ai.idleCallbacks.size+(e?Ai.intervals.size:0)===0,getFiltered({ignoreTimeouts:e=[],maxDelay:t=5e3,includeIntervals:n=!1}){const i=[],r=["timeouts","animationFrames","idleCallbacks"];n&&r.push("intervals");for(const n of r){const r=Ai[n];for(const[,n]of r.entries())e.includes(n.name)||Number.isInteger(n.delay)&&!(n.delay<t)||i.push(n)}return i}}}const $i=(e,t,n,i)=>{const r="string"==typeof t,s=(null==i?void 0:i.appendArgs)||[],o=()=>{n.timerId=null,n.lastCallTime=Li.now();const i=n.args;n.args=null,r?e[t](...i,...s):t.call(e,...i,...s),n.called=!0,++n.calls};return i&&(e=i.thisObj||e),n.lastCallTime=-9e9,n.calls=0,n.invoker=o,o.wrapFn=n,o},Ri=(e,t,n="clearTimeout")=>(t.cancel=()=>{t.isPending&&(e[n](t.timerId),t.args=t.timerId=null)},t.flush=()=>{t.isPending&&(e[n](t.timerId),t.timerId=null,t.invoker())},t.now=(...e)=>{t.cancel(),t.args=e,t.invoker()},t.resume=e=>{const n=t.suspended;t.suspended=e||n<1?0:n-1},t.suspend=()=>{++t.suspended},t.immediate=!1,t.suspended=0,t.timerId=null,ki(t,"isPending",{get:()=>null!==t.timerId}),t);var Pi=e=>class extends(e||de){static get $name(){return"Delayable"}static get declarable(){return["delayable"]}doDestroy(){const e=this;super.doDestroy(),e.timeoutIds&&(e.timeoutIds.forEach(((e,t)=>{var n;"function"==typeof e&&e(),clearTimeout(t),null===(n=Ai)||void 0===n||n.timeouts.delete(t)})),e.timeoutIds=null),e.timeoutMap&&(e.timeoutMap.forEach(((e,t)=>clearTimeout(t))),e.timeoutMap=null),e.intervalIds&&(e.intervalIds.forEach((e=>{var t;clearInterval(e),null===(t=Ai)||void 0===t||t.intervals.delete(e)})),e.intervalIds=null),e.animationFrameIds&&(e.animationFrameIds.forEach((e=>{var t;cancelAnimationFrame(e),null===(t=Ai)||void 0===t||t.animationFrames.delete(e)})),e.animationFrameIds=null),e.idleCallbackIds&&(e.idleCallbackIds.forEach((e=>{var t;cancelIdleCallback(e),null===(t=Ai)||void 0===t||t.idleCallbacks.delete(e)})),e.idleCallbackIds=null)}hasTimeout(e){var t;return Boolean(null===(t=this.timeoutMap)||void 0===t?void 0:t.has(e))}setTimeout({fn:e,delay:t,name:n,runOnDestroy:i,cancelOutstanding:r,args:s}){var o;(arguments.length>1||"function"==typeof arguments[0])&&([e,t,n,i]=arguments),"string"==typeof e?n=e:n||(n=e.name||e),r&&this.clearTimeout(n);const l=this,a=l.timeoutIds||(l.timeoutIds=new Map),c=l.timeoutMap||(l.timeoutMap=new Map),d=setTimeout((()=>{var t;"string"==typeof e&&(e=l[n]),null==a||a.delete(d),null==c||c.delete(n),null===(t=Ai)||void 0===t||t.timeouts.delete(d),e.apply(l,s)}),t);return a.set(d,!i||e),null===(o=Ai)||void 0===o||o.timeouts.set(d,{fn:e,delay:t,name:n}),n&&c.set(n,d),d}clearTimeout(e){var t,n;let i=e;if("string"==typeof i){if(!this.timeoutMap)return;i=this.timeoutMap.get(e),this.timeoutMap.delete(e)}clearTimeout(i),null===(t=this.timeoutIds)||void 0===t||t.delete(i),null===(n=Ai)||void 0===n||n.timeouts.delete(i)}clearInterval(e){var t,n;clearInterval(e),null===(t=this.intervalIds)||void 0===t||t.delete(e),null===(n=Ai)||void 0===n||n.intervals.delete(e)}setInterval(e,t,n){var i;const r=setInterval(e,t);return(this.intervalIds||(this.intervalIds=new Set)).add(r),null===(i=Ai)||void 0===i||i.intervals.set(r,{fn:e,delay:t,name:n}),r}requestAnimationFrame(e,t=[],n=this){var i;const r=this.animationFrameIds||(this.animationFrameIds=new Set),s=requestAnimationFrame((()=>{var i;null===(i=Ai)||void 0===i||i.animationFrames.delete(s),r.delete(s)&&e.apply(n,t)}));return r.add(s),null===(i=Ai)||void 0===i||i.animationFrames.set(s,{fn:e,extraArgs:t,thisObj:n}),s}requestIdleCallback(e,t=[],n=this){var i;const r=this.idleCallbackIds||(this.idleCallbackIds=new Set),s=requestIdleCallback((()=>{var i;null===(i=Ai)||void 0===i||i.idleCallbacks.delete(s),r.delete(s)&&e.apply(n,t)}));return r.add(s),null===(i=Ai)||void 0===i||i.idleCallbacks.set(s,{fn:e,extraArgs:t,thisObj:n}),s}createOnFrame(e,t=[],n=this,i){let r;const s=(...s)=>{null!=r&&i&&(this.cancelAnimationFrame(r),r=null),null==r&&(r=this.requestAnimationFrame((()=>{"string"==typeof e&&(e=n[e]),r=null,s.push(...t),e.apply(n,s)})))};return s.cancel=()=>this.cancelAnimationFrame(r),s}cancelAnimationFrame(e){var t,n;cancelAnimationFrame(e),null===(t=this.animationFrameIds)||void 0===t||t.delete(e),null===(n=Ai)||void 0===n||n.animationFrames.delete(e)}cancelIdleCallback(e){var t,n;cancelIdleCallback(e),null===(t=this.idleCallbackIds)||void 0===t||t.delete(e),null===(n=Ai)||void 0===n||n.idleCallbacks.delete(e)}async nextAnimationFrame(){return new Promise((e=>this.requestAnimationFrame(e)))}buffer(e,t){let n=t;t&&"number"!=typeof t?n=t.delay:t=null;const i=(...e)=>{if(i.suspended)return;const{delay:t}=i;i.cancel(),i.called=!1,i.args=e,i.immediate||!t?r():i.timerId=this.setTimeout(r,t)},r=$i(this,e,i,t);return i.delay=n,Ri(this,i)}raf(e,t){let n=t;t&&"boolean"!=typeof t?n=t.cancelOutstanding:t=null;const i=(...e)=>{i.suspended||(i.cancelOutstanding&&i.cancel(),i.called=!1,i.args=e,i.immediate?r():i.isPending||(i.timerId=this.requestAnimationFrame(r)))},r=$i(this,e,i,t);return i.cancelOutstanding=n,Ri(this,i,"cancelAnimationFrame")}idle(e,t){let n=t;t&&"boolean"!=typeof t?n=t.cancelOutstanding:t=null;const i=(...e)=>{i.suspended||(i.cancelOutstanding&&i.cancel(),i.called=!1,i.args=e,i.immediate?r():i.isPending||(i.timerId=this.requestIdleCallback(r)))},r=$i(this,e,i,t);return i.cancelOutstanding=n,this.setTimeout((()=>this.idleCallbackIds.delete(i.timerId)&&i.now()),100),Ri(this,i,"cancelIdleCallback")}throttle(e,t){let n,i=t;t&&"number"!=typeof t?(i=t.delay,n=t.throttled):t=null;const r=this,s=(...e)=>{if(s.suspended)return;const{delay:t}=s,i=Li.now()-s.lastCallTime;s.args=e,s.immediate||i>=t?(r.clearTimeout(s.timerId),o()):(s.isPending||(s.timerId=r.setTimeout(o,t-i),s.called=!1),n&&(n.wrapFn.args=e,n()))},o=$i(r,e,s,t);return s.delay=i,n&&(n=$i(r,n,(()=>{}),t)),Ri(r,s)}static setupDelayable(e){e.setupDelayableMethods(e.delayable)}static setupDelayableMethods(e,t=null){const n=e.static,i=t||this.prototype;n&&delete e.static;for(const t in e){let n=e[t];const r=t+"Now",s=typeof n;i[r]||(i[r]=i[t]),"number"===s?n={type:"buffer",delay:n}:"string"===s&&(n={type:n}),ki(i,t,{get(){const e=this[n.type](((...e)=>{this[r](...e)}),n);return ki(this,t,{value:e}),e}})}}get widgetClass(){}};class _i{get data(){return Object.create(null)}get keys(){return[]}clear(){}getItem(e){return null}removeItem(e){}setItem(e,t){}}_i._$name="StateStorage";const Ni=()=>Object.create(null),ji=(e,t=0)=>{const n=[],i=localStorage.length;for(let r,s=0;s<i;++s)r=localStorage.key(s),r.startsWith(e)&&n.push(r.slice(t));return n},Vi=new _i,zi={local:class extends _i{constructor(e){super(),this.prefix=e.prefix||""}get isLocal(){return!0}get data(){const e=Ni(),t=this.keys;for(const n of t)e[n]=this.getItem(n);return e}get keys(){return ji(this.prefix,this.prefix.length)}clear(){const e=ji(this.prefix);for(const t of e)localStorage.removeItem(t)}getItem(e){const t=localStorage.getItem(this.prefix+e);return null===t?t:JSON.parse(t)}removeItem(e){return localStorage.removeItem(this.prefix+e)}setItem(e,t){return localStorage.setItem(this.prefix+e,JSON.stringify(t))}},memory:class extends _i{constructor(){super(),this.clear()}get isMemory(){return!0}get data(){return Nt.clone(this._data)}get keys(){return Object.keys(this._data)}clear(){this._data=Ni()}getItem(e){return e in this._data?this._data[e]:null}removeItem(e){delete this._data[e]}setItem(e,t){this._data[e]=t}}};class Bi extends(de.mixin(Pi,$e)){static get $name(){return"StateProvider"}static get configurable(){return{prefix:"bryntum-state:",storage:"local"}}static get delayable(){return{writeStatefuls:50}}static get instance(){return this._instance}static set instance(e){null==e?e=Wi:(("string"==typeof e||Nt.isClass(e)||e instanceof _i)&&(e={storage:e}),Nt.isObject(e)&&(e=new Bi(e))),this._instance=e}static setup(e){return this.instance=e,this.instance}doDestroy(){self.writeStatefuls.flush(),super.doDestroy()}get data(){return this.storage.data}set data(e){if(e)for(const t in e)this.setValue(t,e[t]);else this.clear()}clear(){return this.storage.clear(),this}changeStorage(e){if(null==e)e=Vi;else{if("string"==typeof e){if(!zi[e])throw new Error(`Invalid storage type "${e}" (expected one of: "${Object.keys(zi).join('", "')}")`);e=zi[e]}Nt.isClass(e)&&(e=new e(this))}return e}saveStateful(e,t){(this.pendingSaves||(this.pendingSaves=[])).push([e,t]),this.writeStatefuls()}writeStatefuls(){const e=this,{pendingSaves:n}=e,i=null==n?void 0:n.length,r=[],s=[];if(e.pendingSaves=null,i){for(let e,o,l,a=0;a<i;++a)[o,e]=n[a],!o.isDestroying&&o.isSaveStatePending&&(l=o.saveState(t(t({},e),{},{immediate:!0})),l&&(r.push(l),s.push(o)));r.length&&e.trigger("save",{stateIds:r,saved:s})}}getValue(e){return this.writeStatefuls.flush(),this.storage.getItem(e)}setValue(e,t){const n=this,{storage:i}=n,r=n.getValue(e);return null!=t?(i.setItem(e,t),n.trigger("set",{key:e,value:t,was:r})):null!==r&&(i.removeItem(e),n.trigger("remove",{key:e,was:r})),n}}const Wi=new Bi({storage:Vi});Bi._instance=Wi,Bi._$name="StateProvider";const Hi=/boolean|number|string/;var Ui=e=>{var t;return n(t=class extends(e||de){afterConstruct(){super.afterConstruct(),this.loadState()}finalizeInit(){this.loadState(),super.finalizeInit()}get isStateful(){return!0}get isStatefulActive(){return!this.statefulSuspended&&!this.isResponsivePending&&!this.isResponsiveUpdating}get state(){return this._state=this.getState()}set state(e){this._state=e,e&&this.applyState(e)}updateStatefulEvents(e){const t=this,n={name:"statefulEvents",thisObj:t};if(t.detachListeners(n.name),e&&("string"==typeof e?e=S.split(e):Array.isArray(e)||(e=Nt.getTruthyKeys(e)),e.length)){var i;for(const t of e)n[t]="onStatefulEvent";null===(i=t.ion)||void 0===i||i.call(t,n)}}get statefulId(){const e=this,{responsiveState:t}=e;let n=e.stateId;return null==n&&!1===e.hasGeneratedId&&!1!==e.stateful&&(n=e.id),n&&t&&(n=`${n}[${t}]`),n}get statefulness(){const{stateful:e}=this;return Array.isArray(e)?Nt.createTruthyKeys(e):e}get stateProvider(){return this._stateProvider||Bi.instance}applyState(e){(e=this.pruneState(e))&&this.setConfig(e)}getState(){const e=this,{statefulness:t}=e;let n,i,r=null;if(t)for(n in r={},t)if(t[n]){var s,o;if(i=e[n],null!==(s=i)&&void 0!==s&&s.isStateful)i=i.state;else if(i===(null===(o=e.initialConfig)||void 0===o?void 0:o[n])||!Hi.test(typeof i))continue;r[n]=i}return r}loadState(e,t){"boolean"==typeof e&&(t=e,e=null);const n=this,{statefulLoaded:i}=n;if(n.isStatefulActive&&(t||!i)){const t=n.loadStatefulData(e||(e=n.statefulId));!i&&e&&(n.defaultState=n.state,n.statefulLoaded=!0),t&&(n.state=t)}}loadStatefulData(e){var t;return(e=this.isStatefulActive?e||this.statefulId:null)&&(null===(t=this.stateProvider)||void 0===t?void 0:t.getValue(e))}resetDefaultState(){this.defaultState&&(this.state=this.defaultState)}resumeStateful(e=!1){this.statefulSuspended=e?0:Math.max(this.statefulSuspended-1,0)}saveState(e){e="string"==typeof e?{id:e}:e||{};const t=this,{stateProvider:n}=t,i=e.id||t.isStatefulActive&&t.statefulId;if(i&&n)return e.immediate?(t.isSaveStatePending=!1,n.setValue(i,t.state)):t.isSaveStatePending||(t.isSaveStatePending=!0,n.saveStateful(t,e)),i}suspendStateful(){++this.statefulSuspended}onConfigChange({name:e,value:t,was:n,config:i}){if(super.onConfigChange({name:e,value:t,was:n,config:i}),!this.isConstructing&&this.isStatefulActive&&this.statefulId){const{stateful:t}=this;(Array.isArray(t)?t.includes(e):null==t?void 0:t[e])&&this.saveState()}}onStatefulEvent(){this.isConstructing||this.saveState()}pruneState(e){const{statefulness:t}=this;if(t){const n={};for(const i in e)t[i]&&(n[i]=e[i]);e=n}return e}get widgetClass(){}},"$name","State"),n(t,"configurable",{stateful:null,statefulEvents:{$config:{merge:"classList"},value:["stateChange"]},stateId:null,stateProvider:null}),n(t,"prototypeProperties",{statefulLoaded:!1,statefulSuspended:0}),t};const qi=Nt.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null)),Yi={string:1,number:1};var Ki=e=>class extends(e||de){static get $name(){return"Identifiable"}static get declarable(){return["identifiable"]}static get configurable(){return{id:""}}static setupIdentifiable(e,t){const{identifiable:n}=e;n.idMap=Object.create(null),Reflect.defineProperty(e,"identifiable",{get:()=>n})}doDestroy(){this.constructor.unregisterInstance(this),super.doDestroy()}changeId(e){return(this.hasGeneratedId=!e)?this.generateAutoId():e}updateId(e,t){const n=this,i=n.constructor;t&&i.unregisterInstance(n,t),n.hasGeneratedId&&!1===i.identifiable.registerGeneratedId||i.registerInstance(n,e)}generateAutoId(){return this.constructor.generateId(`b-${this.$$name.toLowerCase()}-`)}static get all(){return Object.values(this.identifiable.idMap)}static generateId(e="generatedId"){return e+(qi[e]=(qi[e]||0)+1)}static registerInstance(e,t=e.id){const{idMap:n}=this.identifiable;if(t in n&&!this.disableThrow)throw new Error("Id "+t+" already in use");n[t]=e}static unregisterInstance(e,t=e.id){const{idMap:n}=this.identifiable;Yi[typeof e]?delete n[e]:n[t]===e&&delete n[t]}static getById(e){const t=this.identifiable.idMap;if(t)return t[e]}static get registeredInstances(){const e=this.identifiable.idMap;return e?Object.values(e):[]}};const Gi=Symbol("STM_PROP"),Xi={parentIndex:1};var Ji=e=>class extends(e||de){static get $name(){return"ModelStm"}static get defaultConfig(){return{stm:null}}joinStore(e){this.stm||(this.stm=e.stm)}unjoinStore(e){var t;this.stm===e.stm&&(this.stm=null),null===(t=super.unjoinStore)||void 0===t||t.call(this,e)}get stm(){return this[Gi]}set stm(e){this[Gi]=e}beforeChronoFieldSet(e,t){const n=this,{stm:i}=n,r=[];if(!n.inSetting&&null!=i&&i.enabled&&!Xi[e]&&!n.constructor.nonPersistableFields[e]&&n.getFieldDefinition(e)){const i={[e]:t},s={[e]:n[e]};r.push([i,s])}return r}beforeSet(e,t,n,i){const{stm:r}=this;if(null!=r&&r.enabled&&!Xi[e]&&!this.constructor.nonPersistableFields[e]){var s;const r=(null===(s=super.beforeSet)||void 0===s?void 0:s.call(this,e,t,n,i))||[];let o,l;return"object"==typeof e?[o,l]=Object.keys(e).reduce(((t,n)=>(t[0][n]=e[n],t[1][n]=this.get(n),t)),[{},{}]):(o={[e]:t},l={[e]:this.get(e)}),r.push([o,l]),r}return[]}afterChronoFieldSet(e,t,n){null!=n&&n[0]&&this.afterSet(e,t,!1,!1,n,n[0][0],!0)}shouldRecordFieldChange(e,t,n){const i=this.firstStore;return!(this.constructor.nonPersistableFields[e]||null==t&&null==n||t===n||t instanceof Date&&n instanceof Date&&t.getTime()===n.getTime()||"id"===e||"parentId"===e&&i&&i.oldIdMap[t]===i.getById(n))}afterSet(e,t,n,i,r,s,o){const{stm:l}=this,a=this.constructor.nonPersistableFields;if(null!=l&&l.isBase&&l.enabled&&!Xi[e]&&!a[e]){const e=r.pop();if(s){let t;const[n,i]=e,[r,a]=Object.keys(s).reduce(((e,r)=>{const s=n[r],o=i[r];return this.shouldRecordFieldChange(r,o,s)&&(t=!0,e[0][r]=s,e[1][r]=o),e}),[{},{}]);t&&l.onModelUpdate(this,r,a,o)}}}beforeInsertChild(e){var t;const n=(null===(t=super.beforeInsertChild)||void 0===t?void 0:t.call(this,e))||[],{stm:i}=this;return null!=i&&i.enabled&&n.push(e.reduce(((e,t)=>(t.root===this.root&&e.set(t,{parent:t.parent,index:t.parent?t.parentIndex:void 0}),e)),new Map)),n}afterInsertChild(e,t,n,i){var r;const{stm:s}=this;if(null!=s&&s.enabled){const t=n.pop();i&&s.onModelInsertChild(this,e,i,t)}null===(r=super.afterInsertChild)||void 0===r||r.call(this,e,t,n,i)}beforeRemoveChild(e,t){const n=super.beforeRemoveChild?super.beforeRemoveChild(e,t):[],{stm:i}=this;return null!=i&&i.enabled&&!t&&n.push(e.reduce(((e,t)=>(e.set(t,t.parentIndex),e)),new Map)),n}afterRemoveChild(e,t,n){var i;const{stm:r}=this;if(null!=r&&r.enabled&&!n){const n=t.pop();e&&e.length&&r.onModelRemoveChild(this,e,n)}null===(i=super.afterRemoveChild)||void 0===i||i.call(this,e,t,n)}};const Zi={includeFilteredOutRecords:!1},Qi=e=>("boolean"==typeof(e=e||!1)&&(e={includeFilteredOutRecords:e}),e||Zi);var er=e=>class extends(e||de){static get $name(){return"TreeNode"}static set convertEmptyParentToLeaf(e){!0===e?e={onLoad:!0,onRemove:!0}:!1===e&&(e={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=e}static get convertEmptyParentToLeaf(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}ingestChildren(e,t=this.stores){const{inProcessChildren:n,constructor:i}=this,r=t[0];if(!0===e)return!!n||[];if(e){const t=(e=he.asArray(e)).length,n=[];for(let s,o=0;o<t;o++)s=e[o],s=s.isModel?s:r?r.createRecord(s,!1,!0):new i(s,null,null,!0),s=r?r.processRecord(s):s,n.push(s);if(!0===this.children&&r){const e=r.createSorterFn(r.sorters);n.sort(e)}return n}}processChildren(e=this.stores){const t=this,{meta:n}=t;t.inProcessChildren=!0;const i=t.ingestChildren(t.data[t.constructor.childrenField],e);if(i){const{convertEmptyParentToLeaf:e}=t.constructor;if(!0===e||e.onLoad?i.length:Array.isArray(i)){if(n.isLeaf=!1,!0===t.children)t.children=[];else if(0===i.length)return void(t.children=i);t.appendChild(i)}else!0===i?(n.isLeaf=!1,t.children=!0):t.isRoot||(n.isLeaf=t.constructor.convertEmptyParentToLeaf.onLoad)}t.inProcessChildren=!1}ancestorsExpanded(e=this.firstStore){const{parent:t}=this;return!t||t.isExpanded(e)&&t.ancestorsExpanded(e)}isExpanded(e=this.firstStore){const t=this.instanceMeta(e.id);return Object.prototype.hasOwnProperty.call(t,"collapsed")||(t.collapsed=!this.expanded),!t.collapsed}get expanded(){return this.data.expanded}get childLevel(){let e=this,t=-1;for(;e&&!e.isRoot;)++t,e=e.parent;return t}get isLeaf(){return!1!==this.meta.isLeaf&&!this.isRoot}get isParent(){return!this.isLeaf}get isLoaded(){return this.isParent&&Array.isArray(this.children)}get descendantCount(){return this.getDescendantCount()}get visibleDescendantCount(){return this.getDescendantCount(!0)}getDescendantCount(e=!1,t=this.firstStore){const n=this.children;return!n||!Array.isArray(n)||e&&!this.isExpanded(t)?0:n.reduce(((t,n)=>t+n.getDescendantCount(e)),n.length)}get allChildren(){const e=this.children;return e?e.reduce(((e,t)=>(e.push(t),e.push.apply(e,t.allChildren),e)),[]):[]}get firstChild(){const e=this.children;return(null==e?void 0:e.length)&&e[0]||null}get lastChild(){const e=this.children;return(null==e?void 0:e.length)&&e[e.length-1]||null}get previousSiblingsTotalCount(){let e=this.previousSibling,t=this.parentIndex;for(;e;)t+=e.descendantCount,e=e.previousSibling;return t}get previousOrderedSibling(){var e;return null===(e=this.parent)||void 0===e?void 0:e.orderedChildren[this.orderedParentIndex-1]}get nextOrderedSibling(){var e;return null===(e=this.parent)||void 0===e?void 0:e.orderedChildren[this.orderedParentIndex+1]}get root(){var e;return(null===(e=this.parent)||void 0===e?void 0:e.root)||this}get parentId(){return this.parent&&!this.parent.isAutoRoot?this.parent.id:null}set parentId(e){const t=this,{parent:n}=t,i=null===e?t.firstStore.rootNode:t.firstStore.getById(e);i!==n&&(n||i)&&(t.isBatchUpdating?t.meta.batchChanges.parentId=e:i?i.appendChild(t):t.parent.removeChild(t))}static set parentIdField(e){this._parentIdField=e,Object.defineProperty(this.prototype,e,{set:function(e){this.parentId=e},get:function(){return this.parentId}})}static get parentIdField(){return this._parentIdField||"parentId"}getChildren(e){let t;return t=e.includeFilteredOutRecords?this.unfilteredChildren||this.children:e.useOrderedTree?this.orderedChildren:this.children,t}traverse(e,t,n){n=Qi(n);const i=this,r=i.getChildren(n);t||e.call(i,i);for(let t=0,i=null==r?void 0:r.length;t<i;t++)r[t].traverse(e,!1,n)}traverseBefore(e,t,n){n=Qi(n);const i=this,r=i.getChildren(n);for(let t=0,i=null==r?void 0:r.length;t<i;t++)r[t].traverse(e,!1,n);t||e.call(i,i)}traverseWhile(e,t,n){n=Qi(n);const i=this;let r=t||!1!==e.call(i,i);if(r){const t=i.getChildren(n);null!=t&&t.length&&(r=t.every((t=>t.traverseWhile(e,!1,n))))}return r}bubble(e,t=!1){let n=this;for(t||e.call(n,n);n.parent;)n=n.parent,e.call(n,n)}bubbleWhile(e,t=!1){let n=this,i=!0;for(t||(i=e.call(n,n));i&&n.parent;)n=n.parent,i=e.call(n,n);return i}contains(e,t=!1){return e&&"object"==typeof e&&(e=e.id),!this.traverseWhile((t=>t.id!=e),t)}getTopParent(e){let t;return e?(t=[],this.bubbleWhile((e=>(t.push(e),e.parent&&!e.parent.isRoot)))):(t=null,this.bubbleWhile((e=>(e.parent||(t=e),e.parent&&!e.parent.isRoot)))),t}appendChild(e,t=!1){return this.insertChild(e,null,t)}insertChild(e,t=null,n=!1,i={}){var r,s,o,l,a,c;const d=this,u=Array.isArray(e);var h,g;(e=he.asArray(e),"number"==typeof t)&&(t=null!==(h=null===(g=d.children)||void 0===g?void 0:g[t])&&void 0!==h?h:null);if(!n&&!d.stores.every((t=>!1!==t.trigger("beforeAdd",{records:e,parent:d}))))return null;e=d.ingestChildren(e);const m=null!==(r=null!==(s=null===(o=t)||void 0===o?void 0:o.parentIndex)&&void 0!==s?s:null===(l=d.children)||void 0===l?void 0:l.length)&&void 0!==r?r:0,p=null===(a=d.beforeInsertChild)||void 0===a?void 0:a.call(d,e),f=d.internalAppendInsert(e,t,n,i);return f.length&&d.convertToParent(n),null===(c=d.afterInsertChild)||void 0===c||c.call(d,m,e,p,f),u||!f?f:f[0]}convertToParent(e=!1){const t=this,n=t.isLeaf;t.meta.isLeaf=!1,t.children||(t.children=[]),!n||t.root.isLoading||e||t.signalNodeChanged({isLeaf:{value:!1,oldValue:!0}})}signalNodeChanged(e){this.stores.forEach((t=>{t.trigger("update",{record:this,records:[this],changes:e}),t.trigger("change",{action:"update",record:this,records:[this],changes:e})}))}tryInsertChild(){return this.insertChild(...arguments)}internalAppendInsert(e,n,i,r){const s=this,{stores:o,root:l}=s,{firstStore:a}=l,{parentIdField:c}=s.constructor,d=s.isAutoRoot?null:s.id,u=[],h={};let g,m,p,f;if(!l.isLoading)for(p=0;p<e.length;p++){const t=e[p];h[t.id]=t.root===l,u[p]=t.parentIndex}if(n&&n.parent!==s&&(n=null),s.children){const t=s.children,i=n?n.parentIndex:t.length;if(t[m=i]===e[0]||t[m=i-1]===e[0])for(g=!0,p=0;g&&p<e.length;p++)e[p]!==t[m+p]&&(g=!1)}if(g)return e;for(p=0;p<e.length;p++){const n=e[p],o=n.parent;a&&!l.isLoading&&n.traverse((e=>{e.root===l&&(h[e.id]=!0)})),!1===(null==o?void 0:o.removeChild(n,h[n.id],i,t({isInserting:!0},r)))?(f||(e=e.slice(),f=!0),e.splice(p--,1)):(n.parent=s,n.data[c]=d,o&&(n.meta.oldParentId=o.id))}if(e.length){Array.isArray(s.children)||(s.children=[]),Array.isArray(s.orderedChildren)||(s.orderedChildren=[]);const t=s.addToChildren(n,e,r);o.forEach((n=>{n.isChained||(e.forEach((e=>{e.joinStore(n)})),n.onNodeAddChild(s,e,t,h,i),e.forEach(((e,t)=>{if(null!=e.meta.oldParentId&&!s.inProcessChildren&&!s.isLoading){const n={[c]:d,[s.getDataSource("parentIndex")]:e.parentIndex},i={},{modified:r,oldParentId:o}=e.meta,l=u[t];delete e.meta.oldParentId,s.id!==o&&(i[c]={value:d,oldValue:o}),e.parentIndex!==l&&(i.parentIndex={value:e.parentIndex,oldValue:l}),r[c]===s.id?Reflect.deleteProperty(r,c):c in r||(r[c]=o),e.afterChange(n,i)}})))}))}return e}removeChild(e,t=!1,n=!1,i={}){var r,s;const o=this,l=[],a=o.isLeaf,{children:c,stores:d}=o;if(e=(e=he.asArray(e)).filter((e=>e.parent===o)),!n)for(const n of d)if(!n.isChained&&!1===n.trigger("beforeRemove",{parent:o,records:e,isMove:t}))return!1;const u=null===(r=o.beforeRemoveChild)||void 0===r?void 0:r.call(o,e,t);for(const r of e){const{parentIdField:e}=r.constructor,{modified:s}=r.meta,a=r.parent?r.parent.id:null;e in s||r.isLinked||(s[e]=a);const c=o.removeFromChildren(r,i);d.forEach((e=>{if(!e.isChained){const{isRemoving:i}=e;e.isRemoving=!0,l.push(...e.onNodeRemoveChild(o,[r],c,{isMove:t,silent:n})),e.isRemoving=i}})),t||(r.parent=r.parentIndex=r.unfilteredIndex=r.nextSibling=r.previousSibling=null,r.data[e]=null)}return 0===(o.unfilteredChildren||c).length&&o.constructor.convertEmptyParentToLeaf.onRemove&&!o.isRoot&&(o.meta.isLeaf=!0),o.isLeaf===a||n||o.stores.forEach((e=>{const t={isLeaf:{value:!0,oldValue:!1}};e.trigger("update",{record:o,changes:t}),e.trigger("change",{action:"update",record:o,changes:t})})),null===(s=o.afterRemoveChild)||void 0===s||s.call(o,e,u,t),l}clearParentId(){const e=this;Reflect.deleteProperty(e.data,e.parentIdField),Reflect.deleteProperty(e.originalData,e.parentIdField),e.meta.modified&&Reflect.deleteProperty(e.meta.modified,e.parentIdField)}replaceChildren(e){return this.clearChildren(),this.data[this.constructor.childrenField]=e,this.processChildren(),this.children}clearChildren(e=!1){const t=this,{stores:n}=t,i=t.unfilteredChildren||t.children;t.children=[],t.orderedChildren=[],i&&!0!==i&&(n.forEach((n=>{n.isChained||n.onNodeRemoveChild(t,i,0,{unfiltered:!0,silent:e})})),t.unfilteredChildren&&(t.unfilteredChildren=[]))}clear(){var e;const t=this,{stores:n}=t,i=null===(e=t.children)||void 0===e?void 0:e.slice();if(t.isRoot&&i){for(const e of n)if(!e.isChained&&!1===e.trigger("beforeRemove",{parent:t,records:i,isMove:!1,removingAll:!0}))return!1;t.children.length=0,t.unfilteredChildren&&(t.unfilteredChildren.length=0),n.forEach((e=>{i.forEach((t=>{t.stores.includes(e)&&t.unjoinStore(e),t.parent=t.parentIndex=t.nextSibling=t.previousSibling=null})),e.storage.suspendEvents(),e.storage.clear(),e.storage.resumeEvents(),e.added.clear(),e.modified.clear(),e.trigger("removeAll"),e.trigger("change",{action:"removeall"})}))}}updateChildrenIndices(e,t,n=!1){let i=null;for(let r=0;r<e.length;r++){const s=e[r],o=s[t];"parentIndex"===t||"orderedParentIndex"===t?void 0===o||n?s.setData(t,r):o!==r&&s.set(t,r,!0):s[t]=r,"parentIndex"===t&&(s.previousSibling=i,i&&(i.nextSibling=s),r===e.length-1&&(s.nextSibling=null),i=s)}}addToChildren(e,t,n={}){var i;const r=this,s=[[r.children,"parentIndex",e],[r.unfilteredChildren,"unfilteredIndex",e],[r.orderedChildren,"orderedParentIndex",null!==(i=null==n?void 0:n.orderedBeforeNode)&&void 0!==i?i:e]];for(const e of s){const[i,s,l]=e;if(i){var o;const a=l?l[s]:i.length;e.push(a),i.splice(a,0,...t),null!=n&&null!==(o=n[s])&&void 0!==o&&o.skip||r.updateChildrenIndices(i,s)}}return s[0][3]}removeFromChildren(e,t){const n=[[this.children,"parentIndex"],[this.unfilteredChildren,"unfilteredIndex"],[this.orderedChildren,"orderedParentIndex"]];for(const r of n){const[n,s]=r;if(n){const o=n.indexOf(e);var i;if(r.push(o),o>-1)n.splice(o,1),null!=t&&null!==(i=t[s])&&void 0!==i&&i.skip||this.updateChildrenIndices(n,s)}}return n[0][2]}sortOrderedChildren(e=!0,t=!1){const n=[];return this.isLeaf||(this.orderedChildren.sort(((e,i)=>{if(t){var r,s;const t=(null!==(r=e.meta.modified.orderedParentIndex)&&void 0!==r?r:e.orderedParentIndex)-(null!==(s=i.meta.modified.orderedParentIndex)&&void 0!==s?s:i.orderedParentIndex);return 0!==t&&(n.push(e),n.push(i)),t}return e.orderedParentIndex-i.orderedParentIndex})),e&&this.orderedChildren.forEach((i=>{n.push(...i.sortOrderedChildren(e,t))})),this.updateChildrenIndices(this.orderedChildren,"orderedParentIndex",!0)),new Set(n)}};const tr={id:1,stores:1,parentIndex:1,parent:1,previousSibling:1,nextSibling:1,unfilteredIndex:1},nr={get(e,t){return"proxyMeta"===t?this.proxyMeta:"constructor"===t?e.constructor:"setData"===t?this.setDataOverride:"set"===t?this.setOverride:tr[t]?this.proxyMeta.data[t]:Reflect.get(e,t,this.proxyRecord)},set(e,t,n){return tr[t]?this.proxyMeta.data[t]=n:e[t]=n,!0},setDataOverride(e,t){"parentIndex"===e?this.proxyMeta.data.parentIndex=t:this.proxyMeta.originalRecord.setData(e,t)},setOverride(e,t,...n){"parentIndex"===e?this.proxyMeta.data.parentIndex=t:this.proxyMeta.originalRecord.set(e,t,...n)}};var ir=e=>{var i;return n(i=class extends(e||de){link(){if(this.isLinked)return this.$original.link();const e=this,n=t(t({},nr),{},{proxyMeta:{originalRecord:e,data:{id:`${e.id}_link_${S.generateUUID()}`,stores:[]}}}),i=new Proxy(e,n);return n.proxyRecord=i,(e.meta.linkedRecords||(e.meta.linkedRecords=[])).push(i),i}get isLinked(){var e;return Boolean(null===(e=this.proxyMeta)||void 0===e?void 0:e.originalRecord)}get hasLinks(){return Boolean(!this.proxyMeta&&this.$links.length)}removeLink(e,t=null,n=!1){if(e.hasLinks)for(const i of e.$links.slice())t?he.include(t,i):i.remove(n);else e.isLinked&&he.remove(e.$original.$links,e)}beforeRemove(e){this.removeLink(this,e)}removeChild(e,t,n,i){if(null==i||!i.isInserting){e=he.asArray(e);for(const t of e)this.removeLink(t,null,n)}return super.removeChild(e,t,n,i)}get $originalId(){return this.$original.id}get $links(){var e;return null!==(e=this.meta.linkedRecords)&&void 0!==e?e:[]}},"$name","ModelLink"),i};const{defineProperty:rr}=Reflect,sr=Symbol("owner"),or=/[\s,]+/;var lr=e=>class extends(e||de){static get $name(){return"Factoryable"}static get declarable(){return["factoryable","alias","type"]}static register(e,t,n=globalThis.__BRYNTUM_EXAMPLE){const{factoryable:i}=this.initClass(),{caseless:r,registry:s}=i,o=S.split(e,or);for(let e,l,a=0;a<o.length;++a){if(l=o[a],e=r?l.toLowerCase():l,!n&&e in s)throw new Error(`Type "${l}" already registered with ${i.class.name} factory`);s[l]=s[e]=t.initClass()}}static isA(e,t){return this.isType(e,t,!0)}static isType(e,t,n){const{factoryable:i}=this,{caseless:r,registry:s}=i,o=s[r?t.toLowerCase():t];return!!o&&(n?e instanceof o:e.constructor===o)}static setupAlias(e){e.register(e.alias,e)}static setupFactoryable(e,n){const i=n.super.class;let{factoryable:r}=e;r=t({caseless:!0,defaultType:null,extends:i.factoryable?[i]:null,typeKey:"type"},r),r.class=e,r.registry=Object.create(null),r.extends&&!Array.isArray(r.extends)&&(r.extends=[r.extends]),rr(e,"factoryable",{get:()=>r})}static setupType(e,t){const{type:n}=e;e.register(n,e,t.replaceType),rr(e.prototype,"type",{value:n})}static create(e,t){return this.reconfigure(null,e,t)}static reconfigure(e,t,n){const i=this,{factoryable:r}=i,{typeKey:s}=r;let o,l,a,c,d,u,h,g,m,p=n;if(n&&!Nt.isClass(n)&&(p=null,h=typeof n,"function"===h?u=n:"string"===h?p=n:Nt.isObject(n)?(o=n.cleanup,l=n.defaults,c=n.owner,u=n.setup,p=n.type,g=n.transform):c=n),g&&(t="string"==typeof g?c[g](t):g(t)),m=t,"string"==typeof m)t={};else if(t){if(!0===t&&(t={}),!Nt.isObject(t)){var f;if(c&&t!==e&&(null==e?void 0:e[sr])===c)"string"==typeof o?c[o](e):null===(f=o)||void 0===f||f(e),e.destroy();return t}m=t[s]}if(m=m&&i.resolveType(m),e){if(t&&(!m||e.constructor===m))return s in t&&delete(t=Nt.assign({},t))[s],e.setConfig(t),e;var v;if(c&&e[sr]===c)"string"==typeof o?c[o](e):null===(v=o)||void 0===v||v(e),e.destroy()}if(t){if(l){if(!(a=m)){if(!(a=l[s]||p||r.defaultType))throw new Error(`No default mergeType defined for ${r.class.name} factory`);a=i.resolveType(a)}a&&(t=a.mergeConfigs(l,t))}if(u){if(d="string"==typeof u?c[u](t,m,l):u(t,m,l),null===d)return d;t=d||t}if(!m){if(!(m=t[s]||p||r.defaultType))throw new Error(`No default type defined for ${r.class.name} factory`);m=i.resolveType(m)}l&&!a&&(t=m.mergeConfigs(l,t)),s in t&&delete(t=Nt.assign({},t))[s],t=new m(t),c&&(t[sr]=c)}return t||null}static resolveType(e,t){if("string"!=typeof e)return e;const{factoryable:n}=this,i=n.extends;let r,s=n.registry[n.caseless?e.toLowerCase():e];for(r=0;!s&&i&&r<i.length;++r)s=i[r].resolveType(e,!0);if(!s&&!t)throw new Error(`Invalid type name "${e}" passed to ${n.class.name} factory`);return s}};const{getOwnPropertyDescriptor:ar}=Reflect;class cr extends(de.mixin(lr)){static get $name(){return"DataField"}static get type(){return"auto"}static get factoryable(){return{defaultType:"auto"}}static get prototypeProperties(){return{compare:null,compareItems:null,dataSource:null,alwaysWrite:!1,nullable:!0,nullText:null,nullValue:void 0,persist:!0,readOnly:!1,internal:!1}}construct(e){const t=this;e&&(t.name=e.name,Object.assign(t,e)),t.compare&&(t.compareItems=(e,n)=>t.compare(null==e?void 0:e[t.name],null==n?void 0:n[t.name]))}defineAccessor(e,t){const{name:n,dataSource:i}=this;!t&&n in e&&e.$meta.hierarchy.some((e=>{var t;return!1===(null===(t=ar(e.prototype,n))||void 0===t?void 0:t.enumerable)}))||Reflect.defineProperty(e,n,{configurable:!0,enumerable:!0,get:this.complexMapping?function(){return this.complexGet(n,i)}:function(){return this.batching&&n in this.meta.batchChanges?this.meta.batchChanges[n]:i in this.data?this.data[i]:this.data[n]},set(e){const t=this.$meta.fields.map[n];t&&t.readOnly||this.set(n,e)}})}isEqual(e,t){return Nt.isEqual(e,t)}print(e){return null==e?this.nullText:this.printValue(e)}printValue(e){return String(e)}}cr._$name="DataField";class dr extends cr{static get $name(){return"ArrayDataField"}static get type(){return"array"}isEqual(e,t){return e===t}}dr.initClass(),dr._$name="ArrayDataField";class ur extends cr{static get $name(){return"BooleanDataField"}static get type(){return"boolean"}static get alias(){return"bool"}static get prototypeProperties(){return{nullValue:!1}}isEqual(e,t){return null==e&&null==t||super.isEqual(e,t)}convert(e){var t;return null==e?this.nullable?e:this.nullValue:"false"!==(null===(t=e.toLowerCase)||void 0===t?void 0:t.call(e))&&Boolean(e)}}ur.initClass(),ur._$name="BooleanDataField";class hr extends cr{static get $name(){return"DateDataField"}static get type(){return"date"}static get prototypeProperties(){return{format:null}}convert(e){return null==e?this.nullable||(e=this.nullValue):"now"===e?e=new Date:e instanceof Date||(e=$t.parse(e,this.format||$t.defaultParseFormat))&&!isNaN(e)||(e=void 0),e}serialize(e){return e instanceof Date&&(e=$t.format(e,this.format||$t.defaultFormat)),e}printValue(e){return $t.format(e,this.format||$t.defaultFormat)}}hr.initClass(),hr._$name="DateDataField";class gr extends cr{static get $name(){return"StringDataField"}static get type(){return"string"}static get prototypeProperties(){return{nullValue:""}}convert(e){return null==e?this.nullable?e:this.nullValue:String(e)}}gr.initClass(),gr._$name="StringDataField";class mr extends gr{static get $name(){return"DurationUnitDataField"}static get type(){return"durationunit"}isEqual(e,t){return 0===$t.compareUnits(e,t)}}mr.initClass(),mr._$name="DurationUnitDataField";class pr extends cr{static get $name(){return"IntegerDataField"}static get type(){return"integer"}static get alias(){return"int"}static get prototypeProperties(){return{nullValue:0,rounding:"round"}}convert(e){return null==e?this.nullable?e:this.nullValue:Math[this.rounding](Number(e))}}pr.initClass(),pr._$name="IntegerDataField";class fr extends cr{static get $name(){return"ModelDataField"}static get type(){return"model"}static get prototypeProperties(){return{complexMapping:!0}}isEqual(e,t){return e&&t&&t instanceof e.constructor&&t.id==e.id}}fr.initClass(),fr._$name="ModelDataField";class vr extends cr{static get $name(){return"NumberDataField"}static get type(){return"number"}static get alias(){return"float"}static get prototypeProperties(){return{nullValue:0,precision:null}}isEqual(e,t){return isNaN(Number(e))&&isNaN(Number(t))||super.isEqual(e,t)}convert(e){if(null==e)return this.nullable?e:this.nullValue;if(e=Number(e),isNaN(e))return;let t=this.precision;return t?(t=10**t,e=Math.round(e*t)/t):0===t&&(e=Math.round(e)),e}}vr.initClass(),vr._$name="NumberDataField";class yr extends cr{static get $name(){return"ObjectDataField"}static get type(){return"object"}static get prototypeProperties(){return{complexMapping:!0}}}yr.initClass(),yr._$name="ObjectDataField";class br extends cr{init(e,t){var n;const i=this,r=`${i.name}Store`,s={skipStack:!0};if(i.modelClass&&(s.modelClass=i.modelClass),null===(n=t[`init${S.capitalize(r)}`])||void 0===n||n.call(t,s),!s.storeClass&&!i.storeClass)throw new Error(`Field '${i.name}' with type 'store' must have a storeClass configured`);const o=t.meta[r]=new(s.storeClass||i.storeClass)(s);i.complexMapping?Nt.setPath(e,i.dataSource,o):e[i.dataSource]=o,o.verifyNoGeneratedIds=!1,o.usesId=!o.count||!o.every((e=>e.hasGeneratedId)),o.$currentValue=i.getValue(o),o.ion({change:({action:e})=>{const n=i.getValue(o);if(!o.$isSettingStoreFieldData){const r=o.$preserveCurrentDataset;o.$preserveCurrentDataset=i.subStore&&("update"===e||"remove"===e||"add"===e),t.set(i.name,n),o.$preserveCurrentDataset=r}o.$currentValue=n}})}set(e,t,n){var i,r;const s=this,o=`${s.name}Store`,{[o]:l}=n.meta;if(!l)return n.meta.initableValues.set(s,e),!1;l.$isSettingStoreFieldData||(l.$isSettingStoreFieldData=!0,e=null!==(i=null===(r=n[`process${S.capitalize(o)}Data`])||void 0===r?void 0:r.call(n,e,n))&&void 0!==i?i:e,l.$preserveCurrentDataset||(l.data=e),l.$isSettingStoreFieldData=!1,l.usesId=!l.count||!l.every((e=>e.hasGeneratedId)))}serialize(e,t){return t.meta[`${this.name}Store`].$currentValue}getValue(e){return e.allRecords.map((t=>{const n=t.persistableData;return e.usesId||delete n.id,n}))}isEqual(e,t){var n,i;return null!==(n=e)&&void 0!==n&&n.isStore&&(e=e.$currentValue),null!==(i=t)&&void 0!==i&&i.isStore&&(t=t.$currentValue),Nt.isDeeplyEqual(e,t)}}n(br,"$name","StoreDataField"),n(br,"type","store"),br.initClass(),br._$name="StoreDataField";const{defineProperty:Cr}=Reflect,{hasOwn:wr}=Nt,Er={children:1,data:1,meta:1},Sr=["name","title","text","label","description"],Tr={boolean:1,number:1,date:1,object:1};class xr extends(de.mixin(Ji,er,ir)){static get $name(){return"Model"}static get declarable(){return["fields"]}static get fields(){return[{name:"parentIndex",type:"number",persist:!1,internal:!0},{name:"orderedParentIndex",type:"number",persist:!1,internal:!0},{name:"readOnly",type:"boolean"}]}static set idField(e){this._assignedIdField=!0,this._idField=e}static get idField(){return this._idField}static set childrenField(e){this._childrenField=e}static get childrenField(){if(!this._childrenField){const e=this.fieldMap.children;this._childrenField=(null==e?void 0:e.dataSource)||"children"}return this._childrenField}get indexPath(){const e=[];let t=this,n=t.childLevel;for(t=this;t&&!t.isRoot;t=t.parent)e[n--]=t.parentIndex+1;return e}construct(e={},n=null,i=null,r=!1,s=!1,o=!1){var l,a;const c=this,d=null!==(l=he.asArray(n))&&void 0!==l?l:[],{constructor:u,fieldMap:h}=c;let g=null;if(n=d[0],c.meta=t(t({modified:{}},u.metaConfig),i),u.applyConfigs)for(const n in c.getDefaultConfiguration())g||(g={},c.useRawData&&c.useRawData.enabled||(e=t({},e))),n in e&&(void 0!==e[n]&&(g[n]=e[n]),delete e[n]);if(super.construct(g),r||u.exposeProperties(e,o),!wr(u,"idFieldProcessed")){let e=c.meta.idField;e||(u._assignedIdField?e=u.idField:n&&(e=n.idField)),e&&e!==h.id.dataSource&&u.addField({name:"id",dataSource:e,internal:!0}),u._idField=h.id.dataSource,u.idFieldProcessed=!0}c._internalId=xr._internalIdCounter++,c.stores=[],c.unjoinedStores=[],c.originalData||(c.originalData=e),c.data=u.processData(e,!1,n,c,s),(null===(a=c.meta.initableValues)||void 0===a?void 0:a.size)&&c.assignInitables(),null==c.id&&c.setData("id",c.generateId(n)),c.data[u.childrenField]&&c.processChildren(d),c.generation=0}set isCreating(e){const t=this;Boolean(t.meta.isCreating)!==e&&(t.meta.isCreating=e,t.stores.forEach((n=>{n.onIsCreatingToggle(t,e)})))}get isCreating(){return Boolean(this.meta.isCreating)}equals(e){if(e instanceof this.constructor){for(let t=this.$meta.fields.defs,n=0,{length:i}=t;n<i;n++){const i=t[n],{name:r}=i;if("id"!==r&&!i.isEqual(this[r],e[r]))return!1}return!0}return!1}get subclass(){return new this.constructor(Object.setPrototypeOf({id:undefined},this.data),this.stores[0],null,!0)}static processData(e,t=!1,n,i,r){const{fieldMap:s,defaultValues:o}=this,{useRawData:l={enabled:!1}}=n||{},a=r||l.enabled?e:Nt.clone(e);let c;if(!(t=t||l.disableDefaultValue||r))for(c in o)if(undefined===a[c]){let e=o[c];Array.isArray(e)&&(e=e.slice()),a[c]=e}if(!l.disableTypeConversion&&!r)for(c in s){const n=s[c],{name:r,dataSource:o}=n,d=o!==r,u=n.complexMapping,h=d&&(u?Nt.pathExists(e,o):o in e),g=r in e&&(!d||!h),m=!l.disableTypeConversion&&n.convert;if((g||m)&&(!t||g||h)){const e=g?a[r]:u?Nt.getPath(a,o):a[o],t=m?n.convert(e,i):e;u?Nt.setPath(a,o,t):a[o]=t,d&&delete a[r]}}return this.$meta.fields.initable.length&&this.initInitables(i,a),a}static setupClass(e){super.setupClass(e),e.fields||this.setupFields(this,e)}static setupFields(e,n){var i,r,s,o,l;const a=wr(e,"fields")&&e.fields,c=n.super.fields,d=n.fields={defs:null!==(i=null==c?void 0:c.defs.slice())&&void 0!==i?i:[],exposedData:!1,defaults:c?t({},c.defaults):{},exposed:Object.create(null!==(r=null==c?void 0:c.exposed)&&void 0!==r?r:null),ordinals:Object.create(null!==(s=null==c?void 0:c.ordinals)&&void 0!==s?s:null),map:Object.create(null!==(o=null==c?void 0:c.map)&&void 0!==o?o:null),sources:Object.create(null!==(l=null==c?void 0:c.sources)&&void 0!==l?l:null)};wr(e,"defaults")&&Object.assign(d.defaults,e.defaults),wr(e,"idField")&&(e.addField({name:"id",dataSource:e.idField,internal:!0}),d.exposed[e.idField]=!0),null!=a&&a.length&&a.map(e.addField,e),d.initable=d.defs.filter((e=>e.init)),e.exposeRelations()}static get defaultValues(){return this.$meta.fields.defaults}static get allFields(){return this.$meta.fields.defs}get allFields(){return this.$meta.fields.defs}static get fieldMap(){return this.$meta.fields.map}get fieldMap(){return this.$meta.fields.map}static get fieldDataSourceMap(){return this.$meta.fields.sources}static exposeProperties(e,t=!0){const n=this,i=n.$meta.fields,r=t?"exposed":"map";if(e&&n.autoExposeFields&&!i.exposedData){let t,s,o;for(t in e)i[r][t]||t===n.childrenField||(o=Nt.typeOf(e[t]),s={name:t,dataSource:t,fromData:!0},Tr[o]&&(s.type=o),n.addField(s));i.exposedData=!0}n.exposeRelations()}static addField(e){if(null==e)return;"string"==typeof e&&(e={name:e});const t=this.initClass(),n=t.$meta.fields,{ordinals:i}=n,r=n.exposed,{name:s}=e,o=n.map[s],l=e.dataSource||(e.dataSource=s);let a,c;if(!o||e.type&&e.type!==o.type)a=cr.create(e),a.definedBy=o?o.definedBy:t,a.ordinal=o?o.ordinal:i[s]=n.defs.length;else for(c in a=Object.create(o),e)"type"!==c&&(a[c]=e[c]);return a.owner=t,n.defs[a.ordinal]=a,n.map[s]=a,n.sources[l]||(n.sources[l]=a),l.includes(".")&&(a.complexMapping=!0),a.complexMapping?r[l.split(".")[0]]=!0:r[l]=!0,"defaultValue"in a&&(n.defaults[l]=a.defaultValue),Er[s]||a.defineAccessor(t.prototype),t._nonPersistableFields=null,t._alwaysWriteFields=null,a}static removeField(e){const t=this.initClass(),n=t.$meta.fields,i=n.map[e],{ordinals:r}=n,s=r[e];if(i){n.defs.splice(s,1),delete r[e],delete n.defaults[e],delete n.exposed[e],delete n.map[e],delete n.sources[i.dataSource];for(const e in r)r[e]>s&&--r[e];delete t.prototype[e]}}static exposeRelations(){const e=this;if(!wr(e,"exposedRelations")&&e.relations){e.exposedRelations=[];for(const t in e.relations){const n=e.relations[t];n.relationName=t,e.exposedRelations.push(n),Reflect.ownKeys(e.prototype).includes(t)||Cr(e.prototype,t,{enumerable:!0,get:function(){return this.getForeign(t)},set:function(e){this.setForeign(t,e,n)}})}}}static initInitables(e,t){const n=e.meta.initableValues=new Map;for(const i of this.$meta.fields.initable){const r=Nt.getPath(t,i.dataSource);void 0!==r&&n.set(i,r),!i.lazy&&i.init(t,e)}}assignInitables(){const{initableValues:e}=this.meta;for(const[t,n]of e)!1!==t.set(n,this.data,this)&&e.delete(t)}static get autoExposeFields(){return!0}get fields(){return this.$meta.fields.defs}getFieldDefinition(e){return this.$meta.fields.map[e]}getFieldDefinitionFromDataSource(e){return this.$meta.fields.sources[e]}get fieldNames(){return Object.keys(this.data)}static getFieldDefinition(e){return this.$meta.fields.map[e]}static getFieldDataSource(e){return this.getFieldDefinition(e).dataSource}getDataSource(e){const t=this.constructor.getFieldDefinition(e);return(null==t?void 0:t.dataSource)||(null==t?void 0:t.name)}static processField(e,t,n){const i=this.fieldMap[e];return null!=i&&i.convert?i.convert(t,n):t}initRelations(){const e=this;e.constructor.exposedRelations&&e.stores.forEach((t=>{var n;t.modelRelations||t.initRelations();const i=[];null===(n=t.modelRelations)||void 0===n||n.forEach((t=>{i.push({related:e.initRelation(t),config:t})})),t.updateRecordRelationCache(e,i)}))}initRelation(e){const t=this,n=t.get(e.foreignKey),i=undefined!==n&&"string"!=typeof e.foreignStore&&e.foreignStore.getById(n);return(t.meta.relationCache||(t.meta.relationCache={}))[e.relationName]=i||(null!=n?{id:n,placeHolder:!0}:null),i}removeRelation(e){const{relationName:t,foreignKey:n,nullFieldOnRemove:i}=e;this.meta.relationCache[t]&&(delete this.meta.relationCache[t],i&&this.setData(n,null))}getForeign(e){var t;return null===(t=this.meta.relationCache)||void 0===t?void 0:t[e]}setForeign(e,t,n){const i=xr.asId(t);return this.set(n.foreignKey,i)}getRelationConfig(e){var t,n;return null===(t=this.firstStore)||void 0===t||null===(n=t.modelRelations)||void 0===n?void 0:n.find((t=>t.foreignKey===e))}flatGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:t in this.data?this.data[t]:this.data[e]}complexGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:Nt.getPath(this.data,t)}get(e){if(!e)return;const t=this.fieldMap[e];return!t&&e.includes(".")?this.complexGet(e,e):null!=t&&t.complexMapping?this.complexGet(e,t.dataSource):this.flatGet(e,(null==t?void 0:t.dataSource)||e)}setData(e,t){const{data:n,fieldMap:i}=this;if("string"==typeof e){var r;const s=i[e],o=null!==(r=null==s?void 0:s.dataSource)&&void 0!==r?r:e;null!=s&&s.set?s.set(t,this.data,this):null!=s&&s.complexMapping?Nt.setPath(n,o,t):n[o]=t}else{const r=Object.keys(e);for(let o=0;o<r.length;o++){var s;const l=r[o],a=i[l],c=null!==(s=null==a?void 0:a.dataSource)&&void 0!==s?s:l;null!=a&&a.set?a.set(t,this.data,this):c&&(null!=a&&a.complexMapping?Nt.setPath(n,c,e[l]):n[c]=e[l])}}}getData(e){var t;const n=this.fieldMap[e],i=null!==(t=null==n?void 0:n.dataSource)&&void 0!==t?t:e;if(i)return null!=n&&n.complexMapping?Nt.getPath(this.data,i):this.data[i]}syncId(e){const t=this.id;if(t!==e){this.setData("id",e);const n={id:{value:e,oldValue:t}};this.afterChange(n,n)}}set(e,t,n=!1,i=!1,r=!1,s=!1){const o=this;if(o.isBatchUpdating)return o.inBatchSet(e,t,n||o.$silenceBatch),null;{var l,a;const c=null===(l=o.beforeSet)||void 0===l?void 0:l.call(o,e,t,n,i),d=o.inSet(e,t,n,i,r,s);return null===(a=o.afterSet)||void 0===a||a.call(o,e,t,n,i,c,d),d}}fieldToKeys(e,t){return"string"!=typeof e?Nt.assign({},e):{[e]:t}}inBatchSet(e,n,i){const r=this,{meta:s,constructor:o,fieldMap:l}=r,a={};let c,d=!1;if("string"!=typeof e?Object.keys(r.fieldToKeys(e,n)).forEach((t=>{c=l[t]||Nt,n=o.processField(t,e[t],r),c.isEqual(s.batchChanges[t],n)||(a[t]={value:n,oldValue:r.get(t)},s.batchChanges[t]=n,d=!0)})):(c=l[e]||Nt,c.isEqual(s.batchChanges[e],n)||(a[e]={value:n,oldValue:r.get(e)},s.batchChanges[e]=n,d=!0)),d&&(r.generation++,!i)){const e={action:"update",record:r,records:[r],changes:a};r.stores.forEach((n=>{n.trigger("batchedUpdate",t({},e))})),r.forEachLinked(((n,i)=>n.trigger("batchedUpdate",t(t({},e),{},{record:i,records:[i]}))))}}inSet(e,t,n,i,r=!1,s=!1){const o=this,{data:l,meta:a,fieldMap:c,constructor:d}=o,{prototype:u,childrenField:h}=d,g={},m=o.fieldToKeys(e,t),p=Object.keys(m);let f=!1;if(!n&&!o.triggerBeforeUpdate(m))return null;o.inSetting=!0;for(let e=0;e<p.length;e++){var v;const t=p[e];if(t===h)continue;const n=c[t],y=n||Nt,b=null==n?void 0:n.readOnly,C=null!==(v=null==n?void 0:n.dataSource)&&void 0!==v?v:t,w=!r&&!n&&t in u,E=w?o[C]:null!=n&&n.complexMapping?Nt.getPath(l,C):l[C],S=d.processField(t,m[t],o),T=m[t]={value:S},x=o.getRelationConfig(t);b||y.isEqual(E,S)||s&&void 0===S||(o.generation++,T.oldValue=E,f=!0,y.isEqual(o.meta.modified[t],S)?Reflect.deleteProperty(a.modified,t):o.ignoreBag||(t in a.modified||o.storeFieldChange(t,E),undefined===T.oldValue&&Reflect.deleteProperty(T,"oldValue")),g[t]=T,o.applyValue(w,C,S,r,n),x&&!i&&(o.initRelation(x),o.stores.forEach((e=>e.cacheRelatedRecord(o,S,x.relationName,T.oldValue)))))}return f&&o.afterChange(m,g,n,i,r),o.inSetting=!1,f?g:null}applyValue(e,t,n,i,r){var s,o;const l=this;let a=null===(s=r)||void 0===s?void 0:s.complexMapping;var c;if(t!==l.constructor.parentIdField)if(e)l[(null===(c=r)||void 0===c?void 0:c.name)||t]=n;else if(null!==(o=r)&&void 0!==o&&o.set)r.set(n,l.data,l);else{if(!r&&t.includes(".")){var d,u;const e=t.split(".")[0];a=(null===(d=r=l.constructor.fieldMap[e])||void 0===d?void 0:d.complexMapping)||"object"===(null===(u=r)||void 0===u?void 0:u.type)}a?Nt.setPath(l.data,t,n):l.data[t]=n}else(l.firstStore.getById(n)||l.firstStore.rootNode).insertChild(l,null,!1,{orderedParentIndex:{skip:!0}})}afterChange(e,t,n,i,r){for(const s of this.stores)s.onModelChange(this,e,t,n,i,r);this.forEachLinked(((s,o)=>s.onModelChange(o,e,t,n,i,r)))}forEachLinked(e){for(const t of this.$links)for(const n of t.stores)e(n,t)}get isPersistable(){return!this.isBatchUpdating&&!this.isCreating}get isModified(){return Boolean(this.meta.modified&&Object.keys(this.meta.modified).length>0)}get hasPersistableChanges(){return this.isPersistable&&!Nt.isEmpty(this.rawModificationData)}isFieldModified(e){return this.isModified&&e in this.meta.modified}getFieldPersistentValue(e){const t="string"==typeof e?this.getFieldDefinition(e):e,n=(null==t?void 0:t.name)||e;let i;return t&&!t.persist||(i=this[n],null!=t&&t.serialize&&(i=t.serialize(i,this))),i}get modifications(){const e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}get rawModifications(){const e=this,t={};if(!e.isModified)return null;let n=!1;return Object.keys(e.meta.modified).forEach((i=>{const r=e.getFieldPersistentValue(i);undefined!==r&&(t[i]=r,n=!0)})),n?t:null}get modificationData(){const e=this.rawModificationData;return e&&Object.keys(e).length&&Nt.setPath(e,this.constructor.idField,this.id),e}get rawModificationData(){const e=this,{fieldMap:t}=e.constructor,n={};if(!e.isModified)return null;let i=!1;return Object.keys(e.meta.modified).forEach((r=>{const s=t[r];if(null!=s&&s.persist){const t=e.getFieldPersistentValue(r);undefined!==t&&(Nt.setPath(n,s.dataSource,t),i=!0)}})),i?n:null}get modificationDataToWrite(){const e=this.constructor.alwaysWriteFields,t=this.modificationData;return e.forEach((e=>{t[this.getFieldDefinition(e).dataSource]=this.getFieldPersistentValue(e)})),t}get persistableData(){const e=this,t={};return e.fields.forEach((n=>{const i=e.getFieldPersistentValue(n);undefined!==i&&(null!=n&&n.complexMapping?Nt.setPath(t,n.dataSource,i):t[n.dataSource]=i)})),t}get isCommitting(){return Boolean(this.meta.committing)}clearChanges(e=!0,t=!0,n=null){const i=this,{meta:r}=i;if(n)for(const e in n)delete r.modified[e];else r.modified={};const s=Nt.isEmpty(r.modified);r.committing=!1,t&&i.stores.forEach((t=>{if(s&&t.modified.remove(i),t.added.remove(i),e){const e=t.collectDescendants(i).all;t.added.remove(e),s&&t.modified.remove(e)}}))}storeFieldChange(e,t){this.meta.modified[e]=t}revertChanges(e=!1){this.set(this.meta.modified,undefined,e)}applyChangeset(e,t="$PhantomId",n=!0){const i=this,r=i.constructor,{idField:s,fieldDataSourceMap:o}=r,l=Nt.pathifyKeys(e),a=Nt.pathifyKeys(i.modificationData),c={},d=t in e;for(const e in l){var u;const t=o[e],i=null!==(u=null==t?void 0:t.name)&&void 0!==u?u:e;(n||((null==t?void 0:t.name)===s?d:l[e]===a[e]))&&(c[i]=l[e])}const h=i.set(c);return i.clearChanges(!1,!0,n?null:c),h?Object.entries(h).reduce(((e,[t,n])=>(e[t]=n.value,e)),{}):{}}get internalId(){return this._internalId}get isPhantom(){return""===this.id||null==this.id||this.hasGeneratedId}get isModel(){return!0}get hasGeneratedId(){return"string"==typeof this.id&&this.id.startsWith("_generated")}static generateId(e=this.$$name){return`_generated${e}_${S.generateUUID()}`}generateId(){return this.constructor.generateId()}static asId(e){return null!=e&&e.isModel?e.id:Nt.isObject(e)?e[this.fieldMap.id.dataSource]:e}get json(){return S.safeJsonStringify(this)}toJSON(){const{children:e,unfilteredChildren:t}=this,n=this.persistableData;return(t||e)&&(n[this.constructor.childrenField]=(t||e).map((e=>e.toJSON()))),n}toString(){const e=this,t=Sr.find((t=>t in e.constructor.fieldMap)),n=t?{[e.constructor.idField]:e.id,[t]:e[t]}:e.data;return S.safeJsonStringify(n)}get isBatchUpdating(){return Boolean(this.batching)}hasBatchedChange(e){var t,n;return null===(t=this.meta)||void 0===t||null===(n=t.batchChanges)||void 0===n?void 0:n[e]}beginBatch(e=!1){const t=this;t.batching||(t.batching=0,t.meta.batchChanges={}),e&&(t.$silenceBatch=(t.$silenceBatch||0)+1),t.batching++}endBatch(e=!1,n=!1){const i=this,{parentIdField:r}=i.constructor;if(i.batching&&(i.batching--,i.$silenceBatch&&i.$silenceBatch--,!(i.batching>0||Nt.isEmpty(i.meta.batchChanges)))){const s=t({},i.meta.batchChanges);i.meta.batchChanges=null,s[r]&&(i.parentId=s[r],delete s[r]),i.set(s,undefined,e,!1,n)}}cancelBatch(){if(this.batching){const e=this,{batchChanges:n}=e.meta,i={};if(e.batching=null,e.meta.batchChanges=null,e.generation++,!e.$silenceBatch){Object.entries(n).forEach((([t,n])=>{i[t]={oldValue:n,value:e[t]}}));const r={action:"update",record:e,records:[e],changes:i};e.stores.forEach((e=>{e.trigger("batchedUpdate",t({},r))})),e.forEachLinked(((e,n)=>{e.trigger("batchedUpdate",t(t({},r),{},{record:n,records:[n]}))}))}e.$silenceBatch&&e.$silenceBatch--}}triggerBeforeUpdate(e){var t;return!(null!==(t=this.stores)&&void 0!==t&&t.some((t=>!1===t.trigger("beforeUpdate",{record:this,changes:e}))))}copy(e=null,t){const n=this,i=Nt.clone(n.data),r=n.constructor.idField,s=Nt.isObject(t)?t.deep:t;let o;if(e&&"object"==typeof e?(o=e[r],Object.assign(i,e)):o=e,s&&n.children?i.children=n.children.map((e=>e.copy(void 0,t))):(delete i.children,delete i.expanded),n.$meta.fields.initable.length>0){const e=n.toJSON();for(const t of n.$meta.fields.initable)i[t.name]=e[t.name]}!1!==e&&(i[r]=o||n.generateId(n.firstStore));const l=new n.constructor(i,null,null,!1,!0);return l.originalInternalId=n.internalId,l}copyData(e){const t={};e.allFields.forEach((({name:n})=>{n!==e.constructor.idField&&(t[n]=e[n])})),this.set(t)}remove(e=!1){const t=this,{parent:n}=this;n?n.removeChild(t):t.stores.length&&!t.isSpecialRow&&t.stores.forEach((n=>n.remove(t,e,!1,!0)))}beforeRemove(e,t){return super.beforeRemove(e,t)}get isValid(){return!0}get firstStore(){return this.stores.length>0&&this.stores[0]}joinStore(e){const t=this,{stores:n}=t;if(!n.includes(e)){const{unjoinedStores:i}=t;super.joinStore(e),e.register(t),n.push(e),i.includes(e)&&i.splice(i.indexOf(e),1),t.isLoaded&&t.children.forEach((t=>t.joinStore(e))),t.initRelations(),e.tree&&!t.isRoot&&(t.instanceMeta(e.id).collapsed=!t.expanded)}}unjoinStore(e,t=!1){const n=this,{stores:i,unjoinedStores:r}=n;var s,o,l;i.includes(e)&&(e.isDestroying||(e.unregister(n),r.push(e)),null===(s=n.unfilteredChildren||n.children)||void 0===s||null===(o=s.forEach)||void 0===o||o.call(s,(n=>n.unjoinStore(e,t))),i.splice(i.indexOf(e),1),null===(l=super.unjoinStore)||void 0===l||l.call(this,e,t),e.uncacheRelatedRecord(n))}isPartOfStore(e){return e?e.includes(this):this.stores.length>0}get isRemoved(){return!this.isPartOfStore()}instanceMeta(e){const{meta:t}=this,n=e.id||e;return t.map||(t.map={}),t.map[n]||(t.map[n]={})}get isGroupHeader(){return"groupRowFor"in this.meta}get isGroupFooter(){return"groupFooterFor"in this.meta}get isSpecialRow(){var e;return Boolean(null===(e=this.meta)||void 0===e?void 0:e.specialRow)}get $original(){return this.isLinked?this.proxyMeta.originalRecord:this}static get nonPersistableFields(){const e=this;return e._nonPersistableFields||(e._nonPersistableFields={},e.allFields.forEach((t=>{t.persist&&!t.calculated||(e._nonPersistableFields[t.name]=1)}))),e._nonPersistableFields}static get alwaysWriteFields(){const e=this;return e._alwaysWriteFields||(e._alwaysWriteFields=[],e.allFields.forEach((t=>{t.alwaysWrite&&e._alwaysWriteFields.push(t.name)}))),e._alwaysWriteFields}get domId(){return"string"==typeof this.id?this.id.replace(/[ .]/g,"-"):this.id}static toJavaScriptValue(e){const{names:t}=this.$meta;return`class ${t[t.length-2]} extends ${t[t.length-3]} { static fields = ${S.toJavaScriptValue(this.fields,e)}; }`}getCurrentConfig(e){const{data:t,children:n}=this,{defaultValues:i,applyConfigs:r}=this.constructor,s=r?super.getCurrentConfig(e):{};if(s){for(const n of this.fields)if(n.persist){const r=Nt.getPath(t,n.dataSource);n.isEqual(r,i[n.name])||Nt.setPath(s,n.dataSource,de.processConfigValue(r,e))}if(n)if(Array.isArray(n)){s.children=[];for(const t of n)s.children.push(t.getCurrentConfig(e))}else s.children=n;this.hasGeneratedId&&delete s.id,delete s.parentId,delete s.parentIndex}return s}}n(xr,"relations",null),xr._idField="id",xr._internalIdCounter=1,xr._assignedIdField=!1,xr.exposeProperties(),xr._$name="Model";class Dr{constructor(e,t){"number"==typeof e||null===e?(this._magnitude=e,this._unit=t):("string"==typeof e&&Object.assign(this,$t.parseDuration(e)),"object"==typeof e&&Object.assign(this,e))}get magnitude(){return this._magnitude}set magnitude(e){this._magnitude="number"==typeof e&&e}get unit(){return this._unit}set unit(e){this._unit=$t.parseTimeUnit(e)}get isValid(){return null!=this._magnitude&&Boolean($t.normalizeUnit(this._unit))}get milliseconds(){return this.isValid?Math.round($t.asMilliseconds(this._magnitude,this._unit)):0}isEqual(e){return Boolean(e)&&null!=this._magnitude&&null!=e._magnitude&&this.milliseconds===e.milliseconds}toString(e){const t=this,n=e?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?`${t._magnitude} ${$t[n](t._unit,1!==t._magnitude)}`:""}toJSON(){return this.toString()}valueOf(){return this.milliseconds}}Dr._$name="Duration";const Or=(e,t)=>null==e?void 0:e[t],Mr=/^is(this|next|last)(week|month|year)$/i,Ir=["isToday","isTomorrow","isYesterday","isThisWeek","isNextWeek","isLastWeek","isThisMonth","isNextMonth","isLastMonth","isThisYear","isNextYear","isLastYear","isYearToDate"];class Fr extends(de.mixin(Ki)){static get defaultConfig(){return{value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null,type:null,internal:null,disabled:!1}}static get configurable(){return{property:null}}construct(e){"function"==typeof e&&(e={filterBy:e}),e.type?"date"!==e.type||null==e.value||Array.isArray(e.value)?"duration"!==e.type||null==e.value||Array.isArray(e.value)||(e.value=new Dr(e.value)):e.value=new Date(e.value):$t.isDate(e.value)||Array.isArray(e.value)&&e.value.every($t.isDate)?e.type="date":e.value instanceof Dr&&(e.type="duration"),super.construct(e)}get id(){return this._id||(this.internal?this._id=Fr.generateId(`b-internal-${this.property}-filter-`):this._id=this.property||Fr.generateId("b-filter-")),this._id}set id(e){this._id=e}onChange(e){var t;const n=this;n.isConfiguring||null===(t=n.owner)||void 0===t||!t.onFilterChanged||n.owner.isConfiguring||n.owner.onFilterChanged(n,e)}get filterBy(){return this._filterBy||this.defaultFilterBy}set filterBy(e){this._filterBy=e}defaultFilterBy(e){const t=this;let n;return n=t._propertyItems.length>1?t._propertyItems.reduce(Or,e):e[t.property],t[t.operator](t.convert(n))}updateProperty(e){this._propertyItems=e.split("."),this.onChange("property")}set value(e){const t=this;t._value=e,Array.isArray(e)&&({date:1,duration:1}[t.type]||e.length>0&&"string"==typeof e[0])?t._filterValue=e.map((e=>t.convert(e))):!t.caseSensitive&&Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?t._filterValue=e.map((e=>null==e?void 0:e.toLowerCase())):t.caseSensitive||"string"!=typeof e?t._filterValue=t.convert(e):t._filterValue=e.toLowerCase(),t.onChange("value")}get value(){return this._value}get filterValue(){return this._filterValue}set operator(e){this._operator=e,this.onChange("operator")}get operator(){const e=this;return e._operator?e._operator:Array.isArray(e.filterValue)?"isIncludedIn":"string"==typeof e.filterValue?"*":"="}convert(e){var t,n;"sameTime"===this.operator||"string"==typeof this.filterValue&&e instanceof Date||("sameDay"===this.operator&&(e=$t.clearTime(e)),e=null!==(t=null===(n=e)||void 0===n?void 0:n.valueOf())&&void 0!==t?t:e);return e=this.caseSensitive||"string"!=typeof e?e:e.toLowerCase()}filter(e){return this.filterBy(e)}startsWith(e){return String(e).startsWith(this.filterValue)}endsWith(e){return String(e).endsWith(this.filterValue)}isIncludedIn(e){return 0===this.filterValue.length||this.filterValue.includes(e)}isNotIncludedIn(e){return!this.isIncludedIn(e)}includes(e){return 0===this.filterValue.length||String(e).includes(this.filterValue)}doesNotInclude(e){return!this.includes(e)}sameTime(e){return $t.isSameTime(e,this.filterValue)}sameDay(e){return e===this.filterValue}"="(e){return Nt.isEqual(e,this.filterValue)}"!="(e){return!Nt.isEqual(e,this.filterValue)}">"(e){return Nt.isMoreThan(e,this.filterValue)}">="(e){return Nt.isMoreThan(e,this.filterValue)||Nt.isEqual(e,this.filterValue)}"<"(e){return Nt.isLessThan(e,this.filterValue)}"<="(e){return Nt.isLessThan(e,this.filterValue)||Nt.isEqual(e,this.filterValue)}"*"(e){return Nt.isPartial(e,this.filterValue)}between(e){const[t,n]=this._filterValue;return(Nt.isMoreThan(e,t)||Nt.isEqual(e,t))&&(Nt.isLessThan(e,n)||Nt.isEqual(e,n))}notBetween(e){return!this.between(e)}empty(e){return null==e||0===String(e).length}notEmpty(e){return!this.empty(e)}isToday(e){return this.between(e)}isTomorrow(e){return this.between(e)}isYesterday(e){return this.between(e)}isThisWeek(e){return this.between(e)}isNextWeek(e){return this.between(e)}isLastWeek(e){return this.between(e)}isThisMonth(e){return this.between(e)}isNextMonth(e){return this.between(e)}isLastMonth(e){return this.between(e)}isThisYear(e){return this.between(e)}isNextYear(e){return this.between(e)}isLastYear(e){return this.between(e)}isYearToDate(e){return this.between(e)}isTrue(e){return!0===e}isFalse(e){return!1===e}setRelativeDateValues(){this._filterValue=Fr.getRelativeDateRange(this._operator).map((e=>e.valueOf()))}static getRelativeDateRange(e,t=new Date){let n,i,r,s,o,l,a;switch(e){case"isYearToDate":return[$t.floor(t,"1 year"),t];case"isToday":return n=$t.floor(t,"1 day"),[n,$t.add(n,1,"day")];case"isYesterday":return n=$t.floor(t,"1 day"),[$t.add(n,-1,"day"),n];case"isTomorrow":return i=$t.getStartOfNextDay(t),[i,$t.add(i,1,"day")];case"isThisWeek":case"isNextWeek":case"isLastWeek":case"isThisMonth":case"isNextMonth":case"isLastMonth":case"isThisYear":case"isNextYear":case"isLastYear":if(r=e.toLowerCase().match(Mr),!r)throw new Error(`Unrecognized relative date expression: ${e}`);return[,l,a]=r,s=`1 ${a}`,o=$t.floor(t,s),"next"===l?o=$t.add(o,1,a):"last"===l&&(o=$t.add(o,-1,a)),[o,$t.add(o,1,a)]}}static generateFiltersFunction(e){if(!e||!e.length&&!e.count)return be.returnTrue;for(const t of e)"date"===t.type&&Ir.includes(t._operator)&&t.setRelativeDateValues();return function(t){let n=!0;for(const i of e)if(i.disabled||(n=i.filter(t)),!n)break;return n}}}n(Fr,"$name","CollectionFilter"),Fr._$name="CollectionFilter";const kr=Nt.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null));class Lr{static generateId(e="generatedId"){return e+(kr[e]=(kr[e]||0)+1)}}Lr._$name="IdHelper";class Ar extends de{static get defaultConfig(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}construct(e){"function"==typeof e&&(e={sortFn:e}),super.construct(e)}get id(){return this._id||(this._id=this.property||Lr.generateId("b-sorter"))}set id(e){this._id=e}set sortFn(e){this._sortFn=e}get sortFn(){return this._sortFn?this._sortFn:this.defaultSortFn}defaultSortFn(e,t){const{convert:n,property:i,useLocaleSort:r}=this,s="desc"===this.direction.toLowerCase()?-1:1;if(e=e[i],t=t[i],n&&(e=n(e),t=n(t)),r&&null!=e&&null!=t&&"string"==typeof e){if(!0===r)return String(e).localeCompare(t);if("string"==typeof r)return String(e).localeCompare(t,r);if("object"==typeof r)return String(e).localeCompare(t,r.locale,r)}return(e>t?1:e<t?-1:0)*s}static generateSortFunction(e,t){const n=e.isCollection?e.values:e,i=n.length;return(e,r)=>{let s,o;for(o=0;o<i;++o)if(s=n[o].sortFn(e,r),s)return s;return t?t(e,r):0}}}let $r;Ar._$name="CollectionSorter";const Rr=()=>0,Pr=(e,t)=>t-e,_r=Symbol("filteredIndicesProperty"),Nr=Object.freeze([]),jr=Object.freeze({action:"sort",added:Nr,removed:Nr,replaced:Nr}),Vr=Object.freeze({action:"filter",added:Nr,removed:Nr,replaced:Nr}),zr={string:1,number:1};function Br(e,t,n){if(!1!==t.unique)t.set(n,e);else{let i=t.get(n);i||(i=new Set,t.set(n,i)),i.add(e)}}function Wr(e,t,n,i){for(let r=0;r<e.length;r++){const s=e[r];for(let e=0;e<i;e++){const i=n[e],r=s[i];Br(s,t[i],r)}}}$r=Symbol.iterator;class Hr extends(de.mixin($e)){constructor(...e){super(...e),n(this,"_sortFunction",null),n(this,"_addedValues",null)}static get configurable(){return{idProperty:"id",extraKeys:null,autoFilter:!0,autoSort:!0,sorters:{$config:["lazy"],value:[]}}}get isCollection(){return!0}construct(e){this.generation=0,this._values=[],super.construct(e)}doDestroy(){var e;super.doDestroy();const t=this;t._values.length=0,t.isFiltered&&(t._filteredValues.length=0,t.filters.destroy()),null===(e=t._sorters)||void 0===e||e.destroy()}clear(){const e=this,t=e._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}equals(e,t){if(e.isCollection&&(e=e.values),e.length===this.count){let{values:n}=this;return t&&(e=e.map(t),n=n.map(t)),he.delta(e,n).inBoth.length===this.count}return!1}replaceValues({values:e,filteredValues:t,silent:n=!1,isNewDataset:i=!1}){const r=this;let s,o;if(r.isFiltered&&!i){Boolean(t)?e&&(s=r._values,r._values=e.slice()):(t=e.slice(),e=null),o=r._filteredValues,r._filteredValues=t.slice()}else s=r._values,r._values=e.slice(),t=null,r.isFiltered&&i&&r.autoFilter?(r._filterFunction=null,r._filteredValues=r._values.filter(r.filterFunction)):r._filteredValues&&(r._filteredValues.length=0);r._indicesInvalid=!0,r._addedValues=void 0,r.generation++,n||r.trigger("change",{action:"replaceValues",replacedValues:s,replacedFilteredValues:o,values:e,filteredValues:t})}set values(e){this.invalidateIndices(),this.splice(0,this._values.length,e)}get values(){return this.isFiltered?this._filteredValues:this._values}get filteredValues(){return this._filteredValues}[$r](){return this.values[Symbol.iterator]()}forEach(e,t=!1){(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}map(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}find(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}get first(){return this.values[0]}get last(){return this.values[this.count-1]}get allValues(){return this._values}get addedValues(){return this._addedValues}match(e,t=!0){const n=this,{_values:i}=n,r=[];return n.forEach((s=>{const o=e.get(s.id,!0);if(o){const e=n.indexOf(s,!0),t=i[e];i[e]=o,n.removeFromIndices(t),n.addToIndices(o)}else t&&r.push(s)})),r.length&&n.remove(r),n.isFiltered&&(n._filteredValues=n._values.filter(n.filterFunction)),r}add(...e){1===e.length?this.splice(this._values.length,null,...e):this.splice(this._values.length,null,e)}remove(...e){1===e.length?this.splice(0,...e):this.splice(0,e)}move(e,t){for(e=he.asArray(e);e.length&&e[0]===t;)e.shift();if(!e.length)return;const n=this,{_values:i}=n,r=n.indexOf(e[0],!0);if(1===e.length&&i[r+1]===t)return;n.suspendEvents(),n.remove(e),n.resumeEvents();const s=t?n.indexOf(t,!0):i.length;if(-1===s)throw new Error("Collection move beforeItem parameter must be present in Collection");return i.splice(s,0,...e),n._indicesInvalid=1,n.trigger("change",{action:"move",items:e,from:r,to:s}),s}splice(e=0,t,...n){const i=this,r=i.idProperty,s=i._values,o={},l=[],a=[],c=i.totalCount;let d,u;if(!1!==i.trigger("beforeSplice",{index:e,toRemove:t,toAdd:n})){if(n)if(1===n.length&&Array.isArray(n[0])&&(n=n[0]),c&&n.length){const e=i.indices[r];d=[];for(let t=0;t<n.length;t++){const i=n[t],l=i[r],c=e.get(l),u=c?s.indexOf(c):-1;o[l]=!0,-1!==u?s[u]!==i&&(a.push([s[u],i]),s[u]=i):d.push(i)}}else d=n;if(t){if("number"==typeof t){t=Math.min(t,s.length-e);for(let n=e;t;--t){o[s[n][r]]?(e++,n++):(l.push(s[n]),s.splice(n,1),u=!0)}}else{let e,n=0===d.length;const a=(t=he.asArray(t)).reduce(((t,r)=>{const s="number"==typeof r,o=s?r:i.indexOf(r,!0);return n&&(null!=e&&o!==e+1||s)&&(n=!1),o>=0&&o<c&&t.push(o),e=o,t}),[]).sort(Pr);if(n)a.length&&(l.push.apply(l,t),s.splice(a[a.length-1],a.length),u=!0);else for(let e=0;e<a.length;e++){const t=a[e];if(-1!==t){o[s[t][r]]||(l.unshift(s[t]),s.splice(t,1),u=!0)}}}l.length&&!i._indicesInvalid&&l.forEach(i.removeFromIndices,i)}if(d.length){s.splice(Math.min(e,s.length),0,...d),u=!0,i._indicesInvalid||d.forEach(i.addToIndices,i),i._addedValues||(i._addedValues=new Set);for(const e of d)i._addedValues.add(e)}if(l.length&&i._addedValues)for(const e of l)i._addedValues.delete(e);a.length&&!i._indicesInvalid&&a.forEach((e=>{i.removeFromIndices(e[0]),i.addToIndices(e[1])})),u||a.length?(i.isSorted?i.onSortersChanged():i.isFiltered&&(i.autoFilter?i.onFiltersChanged({action:"splice",oldCount:1}):i._filteredValues.splice(Math.min(e,i._filteredValues.length),0,...d)),i.generation++,i.trigger("change",{action:"splice",removed:l,added:d,replaced:a,oldCount:c})):i.trigger("noChange",{index:e,toRemove:t,toAdd:n})}}changeId(e,t){const n=this,{idProperty:i}=n,r=zr[typeof e]?e:e[i],s=n.get(r);if(s){const o=n.get(t);if(o&&s!==o)throw new Error(`Attempt to set item ${r} to already existing member's id ${t}`);n.removeIndexEntry(e,i,r),n.addIndexEntry(e,i,t),s[i]=t}}get(e,t=!1){return this.getBy(this.idProperty,e,t)}getAt(e,t=!1){return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}getBy(e,t,n=!1){return this.findItem(e,t,this.isFiltered&&n)}get count(){return this.values.length}get totalCount(){return this._values.length}updateIdProperty(e){this.addIndex({property:e,unique:!0})}changeSorters(e){return new Hr({values:he.asArray(e),internalListeners:{change:"onSortersChanged",thisObj:this}})}addSorter(e){const t=e instanceof Ar?e:new Ar(e);return this.sorters.add(t),t}get isSorted(){var e;return Boolean(null===(e=this._sorters)||void 0===e?void 0:e.count)}onSortersChanged(){const e=this;e._sortFunction=null,e._addedValues=null,e._values.sort(e.sortFunction),e.trigger("change",jr)}get sortFunction(){return this._sortFunction||(this.isSorted?this._sortFunction=Ar.generateSortFunction(this.sorters.values):this._sortFunction=Rr),this._sortFunction}get filters(){return this._filters||(this._filters=new Hr({internalListeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}addFilter(e){const t=e instanceof Fr?e:new Fr(e);return this.filters.add(t),t}removeFilter(e){const{filters:t}=this;e.isCollectionFilter||(e=t.get(e)),t.remove(e)}clearFilters(){this.filters.clear()}get isFiltered(){return Boolean(this._filters&&this._filters.count)}onFiltersChanged({action:e,removed:n,oldCount:i}){const r=this,s=i||"clear"===e&&n.length?r._filteredValues:r._values;r._filterFunction=null,r._filteredValues=r._values.filter(r.filterFunction),r._indicesInvalid=!0;const{toAdd:o,toRemove:l}=he.delta(r._filteredValues,s,!0);r.trigger("change",t(t({},Vr),{},{added:o,removed:l}))}get filterFunction(){return this._filterFunction||(this.isFiltered?this._filterFunction=Fr.generateFiltersFunction(this.filters.values):this._filterFunction=be.returnTrue),this._filterFunction}changeExtraKeys(e){return he.asArray(e).map((e=>"string"==typeof e?{property:e,unique:!0}:e))}updateExtraKeys(e){for(let t=0;t<e.length;t++)this.addIndex(e[t])}addIndex(e){const t=this;e&&((t._indices||(t._indices={}))[e.property]=new Map,Object.assign(t._indices[e.property],e),t.invalidateIndices(),e.dependentOn&&(t.hasCompositeIndex=!0))}findIndex(e,t,n=!1){const i=this.findItem(e,t,n);if(!i)return-1;return(this.isFiltered&&!n?this._filteredValues:this._values).indexOf(i)}findItem(e,t,n=!1){const i=this,{isFiltered:r}=i,s=r&&!n?i.indices[_r][e]:i.indices[e];if(s){var o;const e=null!==(o=s.get(t))&&void 0!==o?o:"string"==typeof t&&t.length&&!isNaN(t)&&s.get(Number(t))||null;if(null!=e)return e}else{const s=r&&!n?i._filteredValues:i._values,o=s.length;for(let n=0;n<o;n++){const i=s[n];if(i[e]==t)return i}}return null}removeIndex(e){delete this._indices[e],this.hasCompositeIndex=Object.values(this.indices).some((e=>e.dependentOn))}indexOf(e,t=!1){return this.findIndex(this.idProperty,zr[typeof e]?e:e[this.idProperty],t)}includes(e,t=!1){return Array.isArray(e)?e.some((e=>this.includes(e))):Boolean(this.findItem(this.idProperty,zr[typeof e]?e:e[this.idProperty],t))}get indices(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}invalidateIndices(){this._indicesInvalid=!0}rebuildIndices(){const e=this,t=e.isFiltered,n=e._indices||(e._indices={}),i=Object.keys(n),r=i.length,s=e._values;let o;t&&(o=n[_r]={});for(let e=0;e<r;e++){const r=n[i[e]];if(r.clear(),t){let t=o[i[e]];t?t.clear():(t=o[i[e]]=new Map,t.unique=r.unique)}}Wr(s,n,i,r),t&&Wr(e._filteredValues,o,i,r),e._indicesInvalid=!1}getIndices(e){const t=[this.indices[e]];return this.isFiltered&&t.push(this.indices[_r][e]),t}addToIndices(e){Object.keys(this.indices).forEach((t=>{this.addIndexEntry(e,t,e[t])}))}removeFromIndices(e){Object.keys(this.indices).forEach((t=>{this.removeIndexEntry(e,t,e[t])}))}removeIndexEntry(e,t,n){this.getIndices(t).forEach((t=>function(e,t,n){!1!==t.unique?t.delete(n):t.has(n)&&(t.get(n).delete(e),t.get(n).size||t.delete(n))}(e,t,n)))}addIndexEntry(e,t,n){this.getIndices(t).forEach((t=>Br(e,t,n)))}onItemMutation(e,t){const n=this;!n._indicesInvalid&&Object.keys(n.indices).length>1&&Object.keys(t).forEach((i=>{if(n.indices[i]){const{value:r,oldValue:s}=t[i];n.removeIndexEntry(e,i,s),n.addIndexEntry(e,i,r)}else if(n.hasCompositeIndex){const s=Object.values(n.indices).find((e=>{var t;return null===(t=e.dependentOn)||void 0===t?void 0:t[i]}));if(s){const i={};for(const n in s.dependentOn){var r;i[n]=(null===(r=t[n])||void 0===r?void 0:r.oldValue)||e[n]}const o=e.buildIndexKey(i);n.removeIndexEntry(e,s.property,o),n.addIndexEntry(e,s.property,e[s.property])}}}))}}Hr._$name="Collection";const Ur=new WeakMap,qr=e=>{if(e&&"object"==typeof e){let t=Ur.get(e);void 0===t&&(t=Symbol("bscik"),Ur.set(e,t)),e=t}return e};class Yr{constructor(e){const t=this;t.generation=0,t.items=new Set,t.idMap={},t.idProperty="id",e&&(e.idProperty&&(t.idProperty=e.idProperty),e.values&&(t.values=e.values))}get(e){return this.idMap[qr(e)]}get count(){return this.items.size}add(...e){1===e.length&&Array.isArray(e[0])&&(e=e[0]);const t=this,{items:n,idMap:i,idProperty:r}=t,s=e.length;for(let o=0;o<s;o++){const s=e[o],l=zr[typeof s]?s:qr(s[r]),a=i[l];null==a?(i[l]=s,n.add(s),t.generation++):a!==s&&(i[l]=s,n.delete(a),n.add(s))}}at(e){let t,n;for(t of(e<0&&(e+=this.count),this.items))if(!e--){n=t;break}return n}remove(e){e=he.asArray(e);const{items:t,idMap:n,idProperty:i}=this,r=e.length;for(let s=0;s<r;s++){const r=e[s],o=zr[typeof r]?r:qr(r[i]),l=n[o];null!=l&&(t.delete(l),delete n[o],this.generation++)}}clear(){this.items.clear(),this.idMap={},this.generation++}countOf(e){let t,n=0;for(t of this.items)e(t)&&++n;return n}changeId(e,t){const n=this,{idMap:i,idProperty:r}=n,s=zr[typeof e]?e:qr(e[r]),o=n.get(s);if(o){const e=n.get(t);if(e&&o!==e)throw new Error(`Attempt to set item ${s} to already existing member's id ${t}`);o[r]=t,delete i[s],i[t]=o}}filter(e,t){const{items:n}=this,i=[];let r=0;return n.forEach((s=>{e.call(t,s,r++,n)&&i.push(s)})),i}includes(e){const t=zr[typeof e]?e:qr(e[this.idProperty]);return Boolean(this.idMap[t])}map(e,t){const{items:n}=this,i=new Array(n.size);let r=0;return n.forEach((s=>{i[r]=e.call(t,s,r++,n)})),i}forEach(e,t){return this.items.forEach(e,t)}find(e,t=0){let n,i;for(n of(t<0&&(t+=this.countOf(e)),this.items))if(e(n)&&!t--){i=n;break}return i}[Symbol.iterator](){return this.items[Symbol.iterator]()}indexOf(e,t){let n,i=-1;for(n of this.items)if((!t||t(n))&&(++i,n===e))return i;return-1}get values(){return[...this.items]}set values(e){e=he.asArray(e),this.clear(),this.add.apply(this,e),this.generation++}sort(e){this.values=this.values.sort(e)}some(e,t){return this.values.some(e,t)}}Yr._$name="Bag";class Kr extends Yr{add(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),super.add(...e.filter((e=>e.isPersistable)))}}Kr._$name="StoreBag";var Gr=e=>class extends(e||de){static get $name(){return"StoreCRUD"}static get defaultConfig(){return{autoCommit:!1}}static get properties(){return{isRemoving:!1,suspendCount:0}}remove(e,t=!1){const n=this,{storage:i}=n;if(0===(e=he.asArray(e).reduce(((e,t)=>((t=n.getById(t))&&e.push(t),e)),[])).length)return e;if(n.isRemoving=!0,n.isGrouped){const t=i.count,r=[],s=new Set;for(const t of e){const{groupParent:e}=t.instanceMeta(n);e.meta.collapsed&&r.push(t),he.remove(e.groupChildren,t),e.meta.childCount--,s.add(e)}for(const e of s)e.groupChildren.length>0&&n.onModelChange(e,{},{});r.length&&i.trigger("change",{action:"splice",removed:r,added:[],replaced:[],oldCount:t})}else if(n.tree){const r=[],s=e.length>1,o=e[0],l=s?void 0:i.indexOf(o),a=e.reduce(((e,t)=>{const{parent:n}=t;return n&&(e[n.id]||(e[n.id]=[n,[]]),e[n.id][1].push(t)),e}),{});if(!t&&!1===n.trigger("beforeRemove",{records:e,isMove:!1,parent:s?void 0:o.parent}))return n.isRemoving=!1,[];for(const e of Object.values(a)){const t=e[0],n=e[1];r.push(...t.removeChild(n,!1,!0))}return t||(n.trigger("remove",{parent:s?void 0:o.parent,index:l,isChild:!0,allRecords:r,isMove:!1,records:e}),n.trigger("change",{action:"remove",records:e}),n.isRemoving=!1),e}for(const t of e)t.beforeRemove(e);return 0===e.length?e:t||!1!==n.trigger("beforeRemove",{records:e})?(t&&n.suspendEvents(),i.remove(e),t&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),n.isRemoving=!1,e):(n.isRemoving=!1,[])}clear(e=!1){var t,n;const i=this,{storage:r}=i;if(i.storage.totalCount||null!==(t=i.rootNode)&&void 0!==t&&null!==(n=t.unfilteredChildren)&&void 0!==n&&n.length){if(!e&&!1===i.trigger("beforeRemove",{records:r.allValues,removingAll:!0}))return null;if(i.rootNode)i.isChained||i.rootNode.clearChildren(e);else if(e){const e=i.registeredRecords;for(let t,n=e.length-1;n>=0;n--)t=e[n],t&&!t.isDestroyed&&t.unjoinStore(i)}e&&(i.removed.clear(),r.suspendEvents()),r.clear(),e&&r.resumeEvents(),i.added.clear(),i.modified.clear()}}removeAll(e=!1){const t=this,n=t.storage;let i;if(t.isRemoving=!0,e){n.suspendEvents();const e=t.registeredRecords;for(let n,i=e.length-1;i>=0;i--)n=e[i],!n||n.isDestroyed||n.isRoot||n.unjoinStore(t)}return i=t.tree?!1!==t.rootNode.clear():null!==t.clear(),e&&n.resumeEvents(),t.isRemoving=!1,i}add(e,t=!1,n={}){var i;const r=this,{storage:s}=r;if(null===(i=e=he.asArray(e))||void 0===i||!i.length)return;if(r.tree=r.tree||Boolean(r.autoTree&&e[0].children),r.tree){const i=new Map,s=r.modelClass.getFieldDataSource("parentIndex"),{parentIdField:o}=r.modelClass,l=[];return e.forEach((e=>{const t=e[o];i.has(t)||i.set(t,{append:[],insert:[]});const n=i.get(t);!e.isModel&&s in e?n.insert.push(e):n.append.push(e)})),i.forEach((({append:e,insert:i},o)=>{const a=null==o?r.rootNode:r.getById(o);if(!a)throw new Error(`Parent node with id ${o} not found, cannot add children.`);if(e.length&&l.push(...a.appendChild(e,t)),i.length)for(const e of i)l.push(a.insertChild(e,e[s],t,n))})),r.reapplySortersOnAdd&&r.sort(),l}if(!t&&!1===r.trigger("beforeAdd",{records:e}))return null;if(r.tree=r.tree||Boolean(r.autoTree&&e[0].children),r.tree)return r.rootNode.appendChild(e);const o=r.processRecords(e);return t&&r.suspendEvents(),s.add(o),t&&r.resumeEvents(),r.autoCommit&&r.doAutoCommit(),o}processRecords(e,t){return e.map((e=>{const n=this.processRecord(e.isModel?e:this.createRecord(e));return null==t||t.call(this,n),n}))}insert(e,t,n=!1){const i=this,r=i.storage,s=i.getAt(e),o=r.values,l=[];if(t=he.asArray(t),!n&&!1===i.trigger("beforeAdd",{records:t}))return null;let a,c,d;if(o[c=e]===t[0]||o[c=e-1]===t[0])for(a=!0,d=0;a&&d<t.length;d++)t[d]!==o[c+d]&&(a=!1);if(a)return null;const u=i.processRecords(t,(t=>{const n=r.indexOf(t);t.children&&t.children.length&&i.autoTree&&(i.tree=!0),n>-1&&(n<e&&s&&e--,l.push(n)),t.meta.previousIndex=n}));if(i.tree){var h;const r=i.rootNode;return r.insertChild(t,null===(h=r.children)||void 0===h?void 0:h[e],n)}return i.suspendEvents(),i.storage.remove(l),i.resumeEvents(),n&&i.suspendEvents(),r.splice(e,0,...u),n&&i.resumeEvents(),i.autoCommit&&i.doAutoCommit(),u}move(e,t){this.isTree?t.parent.insertChild(e,t):this.storage.move(e,t)}setMultiple(e,t,n){const i=this,r=[],s=[];i.forEach((i=>{e(i)&&(s.push(i.set(t,n,!0)),r.push(i))})),i.trigger("updateMultiple",{records:r,all:i.records.length===r.length}),i.trigger("change",{action:"updatemultiple",records:r,all:i.records.length===r.length}),i.reapplyFilterOnUpdate&&i.isFiltered&&i.filter()}setAll(e,t){const n=this,i=[];n.forEach((n=>{i.push(n.set(e,t,!0))})),n.trigger("updateMultiple",{records:n.records,all:!0}),n.trigger("change",{action:"updatemultiple",records:n.records,all:!0}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}acceptChanges(){const e=this;e.added.forEach((e=>e.clearChanges(!0,!1))),e.modified.forEach((e=>e.clearChanges(!0,!1))),e.added.clear(),e.modified.clear(),e.removed.clear()}commit(e=!1){const{changes:t}=this;return!(!e&&!1===this.trigger("beforeCommit",{changes:t}))&&(this.acceptChanges(),e||this.trigger("commit",{changes:t}),t)}revertChanges(){const e=this,{changes:t}=e;if(t){const n={action:"clearchanges",changes:t};e.add(e.removed.values,!0),e.remove(e.added.values,!0),e.modified.forEach((e=>e.revertChanges(!0))),e.added.clear(),e.modified.clear(),e.removed.clear(),e.trigger("change",n),e.trigger("refresh",n)}}get changes(){const e=this,t=e.modified.values.filter((e=>e.rawModifications));return e.added.count||t.length||e.removed.count?{added:e.added.values.slice(),modified:t,removed:e.removed.values.slice()}:null}get autoCommit(){return this._autoCommit}set autoCommit(e){this._autoCommit=e,e&&this.changes&&this.commit()}suspendAutoCommit(){this.suspendCount++}resumeAutoCommit(e=!0){this.suspendCount--,this.autoCommit&&e&&this.doAutoCommit()}doAutoCommit(){this.suspendCount<=0&&this.commit()}},Xr=e=>class extends(e||de){static get $name(){return"StoreChanges"}static get configurable(){return{applyChangesetFilterSortTarget:"changes"}}applyChangesFromStore(e){const t=this,{changes:n}=e;n&&(n.added&&t.add(n.added),n.removed&&t.remove(n.removed.map((e=>e.id))),n.modified&&n.modified.forEach((e=>{t.getById(e.id).set(e.modifications)})))}applyChangeset(e,t=null,n="$PhantomId",i=!0,r=!1){var s,o;const l=this,{added:a,updated:c,modified:d,removed:u}=null!==(s=null==t?void 0:t(e,l))&&void 0!==s?s:e,h=null!==(o=null!=c?c:d)&&void 0!==o?o:[],g=l.modelClass.getFieldDataSource("id"),m=r?new Map:null,p=[],f=[];let v=!1,y=[];if((null==a?void 0:a.length)>0){var b;const e=[],t=[];for(const i of a){var C;l.getById(null!==(C=i[n])&&void 0!==C?C:Nt.getPath(i,g))?e.push(i):t.push(i)}h.unshift.apply(h,e);const i=null!==(b=l.add(t,!1,{orderedParentIndex:{skip:!0}}))&&void 0!==b?b:[];if(p.push(...i),l.tree)for(const e of i){const{parent:t}=e;if(t.isRoot){v=!0,y=[t];break}!t.isRoot&&y.every((e=>!e.contains(t)))&&y.push(t)}for(const e of i)null==m||m.set(e.id,e.data),e.clearChanges()}if((null==h?void 0:h.length)>0)for(const e of h){const t=e[n],r=Nt.getPath(e,g),s=l.getById(null!=t?t:r);if(s){const t=s.applyChangeset(e,n,i);l.tree&&!v&&y.every((e=>!e.contains(s)))&&(s.parent.isRoot?(v=!0,y=[s.parent]):y.push(s.parent)),null==m||m.set(r,t),f.push(s)}}return(null==u?void 0:u.length)>0&&l.applyRemovals(u),l.afterChangesetApplied(y),"changes"===l.applyChangesetFilterSortTarget&&l.filterChangeset(p,f,l.isSorted?l.createSorterFn(l.sorters):void 0),m}afterChangesetApplied(e){e.forEach((e=>{e.traverse((e=>{e.sortOrderedChildren(!1,!1),e.children&&e.updateChildrenIndices(e.children,"parentIndex",!0),e.unfilteredChildren&&e.updateChildrenIndices(e.unfilteredChildren,"unfilteredIndex",!0)}))}))}applyRemovals(e){const t=this,{removed:n}=t,i=t.modelClass.idField,r=[];for(const t of e){const e=Nt.getPath(t,i);n.includes(e)?n.remove(e):r.push(e)}t.remove(r);for(const e of r)n.remove(e)}filterChangeset(e,t,n){const i=this,{isFiltered:r,isGrouped:s,tree:o}=i,{allValues:l,addedValues:a,isSorted:c,filterFunction:d}=i.storage,u=null!=n||c?null!=n?n:i.storage.sortFunction:null;if(o||!r)return!1;let h,g=!1,m=!1;s&&(h=i.groupers,i.clearGroupers(!0));const{filteredValues:p}=i.storage;if(u){const e=a?p.findLastIndex((e=>!a.has(e)))+1:p.length,n=p.slice(0,e),i=new Set(t.filter(d));for(const e of p)i.has(e)&&i.delete(e);for(const e of i)n.push(e);n.sort(u),p.splice(0,e,...n),m=!0}else{const e=new Set(t.filter((e=>d(e)&&!i.storage.includes(e))));let n=0,r=0,s=0===e.size;for(;r<l.length&&!s;){const t=p[n];let i=l[r];for(;t!==i;)e.has(i)&&(p.splice(n,0,i),m=g=!0,n++,e.delete(i),s=0===e.size),i=l[++r];n<p.length&&n++}}const f=new Set(e.filter((e=>!d(e))));for(let e=p.length-1;e>=0;e--){const t=p[e];f.has(t)&&(p.splice(e,1),m=g=!0,f.delete(t))}return h&&(i.group(h[0],null,!1,!0,!0),m=!0),m&&(i._idMap=null,i.trigger("refresh")),g}},Jr=e=>class extends(e||de){static get $name(){return"StoreFilter"}static get defaultConfig(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}set reapplyFilterOnAdd(e){this.storage.autoFilter=e}get reapplyFilterOnAdd(){return this.storage.autoFilter}set filters(e){const t=this,n=t.filters;if(n.clear(),t._filtersFunction=null,e){if("Object"===e.constructor.name)for(const t of Object.entries(e))"filterBy"===t[0]&&"function"==typeof t[1]?n.add(new Fr({filterBy:t[1]})):n.add(new Fr("Object"===t[1].constructor.name?Object.assign({property:t[0]},t[1]):{property:t[0],value:t[1]}));else Array.isArray(e)?n.add(...e.map((e=>e instanceof Fr?e:new Fr(e)))):e.isCollection?n.add(...e.values):n.add(new Fr({filterBy:e}));n.forEach((e=>e.owner=t))}}get filters(){return this._filters||(this._filters=new Hr({extraKeys:["property"]}))}set filtersFunction(e){this._filtersFunction=e}get filtersFunction(){const e=this,{filters:t,isGrouped:n}=e;if(!e._filtersFunction)if(t.count){const i=Fr.generateFiltersFunction(t);e._filtersFunction=e=>n&&e.isSpecialRow?e.groupChildren.some(i):i(e)}else e._filtersFunction=be.returnTrue;return e._filtersFunction}get isFiltered(){return this.filters.values.some((e=>!e.disabled))}traverseFilter(e){const t=this,n=!e.isRoot&&t.filtersFunction(e),i=e.unfilteredChildren||e.children;return i&&i.length?(e.unfilteredChildren||(e.unfilteredChildren=e.children.slice()),e.children=e.unfilteredChildren.filter((e=>t.traverseFilter(e))),e.updateChildrenIndices(e.unfilteredChildren,"unfilteredIndex",!0),e.updateChildrenIndices(e.children,"parentIndex",!0),n||Boolean(e.children.length)):n}traverseClearFilter(e){const t=this;e.unfilteredChildren&&(e.children=e.unfilteredChildren.slice(),e.unfilteredChildren=null),e.children&&(e.children.forEach((e=>t.traverseClearFilter(e))),e.updateChildrenIndices(e.children,"parentIndex",!0))}get latestFilterField(){return this.filters.last?this.filters.last.property:null}addFilter(e,t=!1){const n=this;if((e=e instanceof Fr?e:new Fr(e)).owner=n,n.filters.add(e),!t){if(n.remoteFilter)return n.filter().then((()=>e));n.filter()}return e}filter(e){const t=this;let n,i=!1;if(e){let r=typeof e;if("object"===r&&("silent"in e||"replace"in e||e.filters)&&(i=e.silent,e.replace&&t.clearFilters(0===e.filters.length),n=e.internal,r=typeof(e=e.filters)),e){const i=t.isFiltered;if(t.isConfiguring=!0,Array.isArray(e))e.forEach((e=>t.addFilter(e,!0)),t);else if("function"===r){const i=new Fr(e);i.internal=n,t.addFilter(i,!0)}else"string"===r?t.addFilter({property:e,value:arguments[1]},!0):t.addFilter(e,!0);if(t.isConfiguring=!1,!t.isFiltered&&!i)return null}}return t.filtersFunction=null,t.performFilter(i)}performFilter(e){const t=this,{storage:n,filters:i,rootNode:r}=t,s=t.count;let o,l;if(t.trigger("beforeFilter",{filters:i}),t.tree){const e=n.values;t.isFiltered?t.traverseFilter(r):t.traverseClearFilter(r);const i=t.collectDescendants(r).visible;n.replaceValues({values:i,silent:!0});const s=he.delta(i,e,!0);o=s.toAdd,l=s.toRemove}else n.ion({change({removed:e,added:t}){l=e,o=t},once:!0}),t.isFiltered?(t.isGrouped&&t.includeCollapsed(),n.addFilter({id:"primary-filter",filterBy:t.filtersFunction}),t.isGrouped&&t.excludeCollapsed()):n.filters.clear();t.afterPerformFilter(e||t.isRemoteDataLoading?null:{action:"filter",filters:i,oldCount:s,added:o,removed:l,records:t.storage.values})}afterPerformFilter(e){this.resetRelationCache(),e&&this.triggerFilterEvent(e)}get filtered(){return this.storage.isFiltered}triggerFilterEvent(e){this.trigger("filter",e),this.remoteFilter||(this.trigger("refresh",e),this.trigger("change",e))}filterBy(e){return this.filter(e)}removeFilter(e,t=!1){const n=this,i=e instanceof Fr?e:n.filters.get(e);if(i){if(n.filters.remove(i),n._filtersFunction=null,!t){if(n.remoteFilter)return n.filter().then((()=>i));n.filter()}return i}}clearFilters(e=!0){if(this.filters.remove(this.filters.values.filter((e=>!e.internal))),e)return this.filter()}convertFilterToString(e){const t=this.filters.getBy("property",e);return t&&!t.filterBy?String(t):""}doDestroy(){var e;null===(e=this._filters)||void 0===e||e.destroy(),super.doDestroy()}};const Zr={add:1,replace:1};var Qr=e=>class extends(e||de){static get $name(){return"StoreGroup"}static get defaultConfig(){return{groupers:null,useGroupFooters:!1}}static get properties(){return{collapsedGroups:new Set}}construct(e){super.construct(e),this.ion({change:"onDataChanged",thisObj:this})}get groupers(){return this._groupers}set groupers(e){this.setGroupers(e)}setGroupers(e,t){const n=this,{storage:i}=n;let r;return null!=e&&e.length?n._groupers=e:n.groupers&&(delete n._groupers,n.includeCollapsed(),i.replaceValues({values:n.removeHeadersAndFooters(i._values),filteredValues:i.isFiltered?n.removeHeadersAndFooters(i._filteredValues):null,silent:!0}),r=n.group(null,null,null,!1,null==t?void 0:t.silent)),n._idMap=null,r}get groupRecords(){const e=[];if(this.isGrouped)for(const t of this)t.isSpecialRow&&e.push(t);return e}includeCollapsed(){for(const e of this.collapsedGroups)this.expand(this.getById(e),!1)}excludeCollapsed(){for(const e of this.collapsedGroups)this.collapse(this.getById(e))}onDataChange({source:e,action:t,removed:n}){var i;const r=this,{groupers:s}=r;s&&(s.length?("splice"===t&&null!=n&&n.length||"move"===t)&&e.replaceValues({values:r.prepareGroupRecords(),silent:!0}):e.replaceValues({values:r.removeHeadersAndFooters(e.values),silent:!0})),null===(i=super.onDataChange)||void 0===i||i.call(this,...arguments)}move(e,t){const n=this;if(n.isGrouped){var i;if(null!==(i=t)&&void 0!==i&&i.isSpecialRow&&!(t=n.getPrev(t,!1,!1)))return;const r=n.groupers[0].field;let s;s=t?t.isGroupHeader?t.meta.groupRowFor:t[r]:n.groupRecords[n.groupRecords.length-1].meta.groupRowFor,n.beginBatch(),e.forEach((e=>e[r]=s)),n.endBatch()}super.move(...arguments)}collapse(e){return!(!e||e.meta.collapsed)&&(this.excludeGroupRecords(e),e.meta.collapsed=!0,this.collapsedGroups.add(e.id),!0)}expand(e,t=!0){return!(null==e||!e.meta.collapsed)&&(this.includeGroupRecords(e),e.meta.collapsed=!1,t&&this.collapsedGroups.delete(e.id),!0)}removeHeadersAndFooters(e){return e.filter((e=>!e.isSpecialRow||(this.unregister(e),!1)))}prepareGroupRecords(e){var t;const n=this,i=n.collapsedGroups,r=[];let s=null!==(t=n.storage.filteredValues)&&void 0!==t?t:n.storage.values;for(const e of s)e.isGroupHeader&&(e.meta.collapsed||i.has(e.id))&&(i.add(e.id),r.push(e));for(const e of r)n.includeGroupRecords(e);if(s=n.removeHeadersAndFooters(n.storage.values),e&&(s=s.sort(e)),!n.isGrouped)return s;const o=[],l=n.groupers[0].field;let a=null,c=null,d=0;function u(){const e=c.meta.groupRowFor,t=`group-footer-${"number"==typeof e?e:S.createId(e)}`,i=n.getById(t)||new n.modelClass({id:t},n,{specialRow:!0,groupFooterFor:e,groupRecord:c});return i.stores=[n],n.register(i),i.groupChildren=c.groupChildren,c.meta.collapsed||o.push(i),n.allRecords.push(i),c.groupChildren.push(i),d++,i}return s.forEach((e=>{var t;const r=null==e[l]?"__novalue__":e[l],s=`group-header-${"number"==typeof r?r:S.createId(r)}`;0!==(null===(t=e.groupChildren)||void 0===t?void 0:t.length)?(Nt.isEqual(r,a)||(c&&(n.useGroupFooters&&u(),c.meta.childCount=d),c=n.getById(s)||new n.modelClass({id:s},n,{specialRow:!0,groupRowFor:r,groupField:l}),c.meta.collapsed=i.has(s),c.stores=[n],n.register(c),c.groupChildren=[],o.push(c),n.allRecords.push(c),a=r,d=0),e.instanceMeta(n.id).groupParent=c,i.has(s)||o.push(e),c.groupChildren.push(e),d++):n.unregister(e)})),c&&(n.useGroupFooters&&u(),c.meta.childCount=d),n._idMap=null,o}get isGrouped(){var e;return Boolean(null===(e=this.groupers)||void 0===e?void 0:e.length)}group(e,t,n=!1,i=!0,r=!1){const s=this;let o,l;if(e&&"object"==typeof e&&(t=e.ascending,l=e.fn,e=e.field),n)s.groupers.push(o={field:e,ascending:t,complexMapping:e.includes(".")});else if(e){var a,c;if(null==t)t=(null===(a=s.groupInfo)||void 0===a?void 0:a.field)!==e||(null===(c=s.groupInfo)||void 0===c?void 0:c.fn)!==l||!s.groupInfo.ascending;s.groupInfo=o={field:e,ascending:t,fn:l,complexMapping:e.includes(".")},s.groupers=[s.groupInfo]}if(o){const{prototype:t}=s.modelClass;o.complexMapping&&!Object.prototype.hasOwnProperty.call(t,e)&&Object.defineProperty(t,e,{get(){return Nt.getPath(this,e)}})}if(!1!==i){if(s.remoteSort&&!s.isRemoteDataLoading)return s.sort(null,null,!1,!0).then((()=>s.onAfterGrouping(r)));s.sort(null,null,!1,!0)}s.onAfterGrouping(r)}onAfterGrouping(e){if(e)return;const t=this;t.trigger("group",{isGrouped:t.isGrouped,groupers:t.groupers,records:t.storage.values}),t.trigger("refresh",{action:"group",isGrouped:t.isGrouped,groupers:t.groupers,records:t.storage.values})}addGrouper(e,t=!0){return this.group(e,t,!0)}removeGrouper(e){const t=this,{groupers:n}=t,i=n.findIndex((t=>t.field===e));if(i>-1)return n.splice(i,1),n.length?t.group():t.clearGroupers()}clearGroupers(e=!1){return this.setGroupers(null,{silent:e})}isRecordInGroup(e,t){var n;if(!this.isGrouped)return null;return e[null===(n=this.groupers[0])||void 0===n?void 0:n.field]===t&&!e.isSpecialRow}isInCollapsedGroup(e){const t=e.instanceMeta(this).groupParent;return null==t?void 0:t.meta.collapsed}getGroupRecords(e){return this.isGrouped?this.storage.values.filter((t=>this.isRecordInGroup(t,e))):null}getGroupTitles(){return this.isGrouped?this.getDistinctValues(this.groupers[0].field):null}onDataChanged({changes:e,action:t}){this.isGrouped&&(!e&&Zr[t]||e&&this.groupers.some((t=>t.field in e)))&&this.sort()}internalIncludeExcludeGroupRecords(e,t){const n=this,i=n.indexOf(e),{id:r,storage:s}=n,{meta:o,groupChildren:l}=e;if(!(-1===i||o.collapsed&&!t||!o.collapsed&&t)){if(l.forEach((e=>e.instanceMeta(r).hiddenByCollapse=!t)),t){const e=l.filter((e=>!n.isAvailable(e)));s.values.splice(i+1,0,...e)}else s.values.splice(i+1,l.length);s._indicesInvalid=!0,n._idMap=null}}excludeGroupRecords(e){this.internalIncludeExcludeGroupRecords(e,!1)}includeGroupRecords(e){this.internalIncludeExcludeGroupRecords(e,!0)}collectGroupRecords(e,t=!0){return(e?this.storage.allValues:this.storage.values).reduce(((e,n)=>(n.isSpecialRow&&(t&&!n.isGroupFooter&&e.push(n),n.isGroupHeader&&e.push.apply(e,n.groupChildren)),e)),[])}},es=e=>class extends(e||de){static get configurable(){return{objectify:null}}initProxy(){if(!globalThis.Proxy)throw new Error("Proxy not supported");return new Proxy(this,{get(e,t){if(t in e)return e[t];if("$store"===t)return e;let n=e.getById(t);return n||isNaN(parseInt(t))||(n=e.getAt(parseInt(t))),n},set:(e,n,i)=>(n in e||e.isDestroying?e[n]=i:e.add(t({[e.modelClass.idField]:n},i)),!0),deleteProperty:(e,t)=>e.isDestroying?(delete e[t],!0):Boolean(e.remove(t).length),has(e,t){if(t in e)return!0;if(t.startsWith("{")&&t.endsWith("}")){const e=S.safeJsonParse(t);t=null==e?void 0:e.id}return e.includes(t)}})}},ts=e=>{var i;return n(i=class extends(e||de){initRelations(e){const n=this,i=n.modelClass.exposedRelations;e&&n.modelRelations&&n.modelRelations.forEach((e=>{var t;return null===(t=e.storeDetacher)||void 0===t?void 0:t.call(e)})),n.modelRelations&&0!==n.modelRelations.length&&!e||!i||(n.modelRelations=[],null==i||i.forEach((i=>{const r=t({},i),{foreignStore:s,relationName:o,relatedCollectionName:l}=r,a="string"==typeof s?n[s]:s;if(r.dependentStore=n,n.modelRelations.push(r),a){r.foreignStoreProperty=r.foreignStore,r.foreignStore=a;const t=a.dependentStoreConfigs;if(t.has(n)){const i=t.get(n);if(e){const e=i.find((e=>e.relationName===o));e&&he.remove(i,e)}i.push(r)}else t.set(n,[r]);l&&a.initRelationCollection(r,n),a.count>0&&a.updateDependentStores("dataset",a.records)}})))}initRelationCollection(e,t){const n=this,i=e.relatedCollectionName;(n.collectionStores||(n.collectionStores={}))[i]={store:t,config:e},n[i+"Store"]||(n[i+"Store"]=t),n.count>0&&n.initModelRelationCollection(i,n.records)}initModelRelationCollection(e,t){const n=this;t.forEach((t=>{t.traverse((t=>{const i=e in t?`$related${S.capitalize(e)}`:e;Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:function(){return n.getCollection(this,e)},set:function(t){return n.setCollection(this,e,t)}})}))}))}resetRelationCache(){this.relationCache={},this.forEach((e=>e.initRelations()))}updateRecordRelationCache(e,t){null==t||t.forEach((t=>{const{config:n}=t,i=t.related?t.related.id:e.get(n.foreignKey);void 0!==i&&this.cacheRelatedRecord(e,i,n.relationName,i)}))}getRelationCollection(e,t){const n=xr.asId(t);return this.relationCache[e]&&this.relationCache[e][n]||[]}getCollection(e,t){const{config:n,store:i}=this.collectionStores[t];return i.relationCache[n.relationName]&&i.relationCache[n.relationName][e.id]||[]}setCollection(e,t,n){const{config:i,store:r}=this.collectionStores[t],s=((r.relationCache[i.relationName]||(r.relationCache[i.relationName]={}))[e.id]||[]).slice(),o=[],l=[];r.suspendEvents(),s.forEach((e=>{n.includes(e)||(e[i.foreignKey]=null,r.remove(e),l.push(e))})),n.forEach((t=>{t.isModel instanceof xr?t.stores.includes(r)||(r.add(t),o.push(t)):([t]=r.add(t),o.push(t)),t[i.foreignKey]=e.id})),r.resumeEvents(),l.length&&(r.trigger("remove",{records:l}),r.trigger("change",{action:"remove",records:l})),o.length&&(r.trigger("add",{records:o}),r.trigger("change",{action:"add",records:o}))}cacheRelatedRecord(e,t,n,i=null){const r=this,s=r.relationCache[n]||(r.relationCache[n]={});null!==i&&r.uncacheRelatedRecord(e,n,i),null!=t&&he.include(s[t]||(s[t]=[]),e)}uncacheRelatedRecord(e,t=null,n=null){const i=this;function r(t,n){const r=i.relationCache[t],s=null==r?void 0:r[n];if(s){const t=s.indexOf(e);t>=0&&s.splice(t,1),0===s.length&&delete r[n]}}null!=n?r(t,n):e.meta.relationCache&&Object.entries(e.meta.relationCache).forEach((([e,t])=>r(e,null==t?void 0:t.id)))}updateDependentStores(e,t){this.dependentStoreConfigs.forEach((n=>{n.forEach((n=>{const{dependentStore:i,relatedCollectionName:r,relationName:s,foreignKey:o}=n,l=i.relationCache[s];return"dataset"===e?(r&&this.initModelRelationCollection(r,t),void i.forEach((e=>{const t=e.initRelation(n);t&&i.cacheRelatedRecord(e,t.id,s,t.id)}))):"removeall"===e?(i.forEach((e=>e.removeRelation(n))),void delete i.relationCache[s]):("add"===e&&r&&this.initModelRelationCollection(r,t),void("add"!==e&&"remove"!==e||t.forEach((t=>{const r=null==l?void 0:l[t.id];switch(e){case"remove":r&&r.forEach((e=>e.removeRelation(n)));break;case"add":i.forEach((e=>{e.get(o)==t.id&&(e.initRelation(n),i.cacheRelatedRecord(e,t.id,s))}))}}))))}))}))}updateDependentRecordIds(e,t){var n;null===(n=this.dependentStoreConfigs)||void 0===n||n.forEach((n=>{n.forEach((n=>{var i;const{dependentStore:r,relationName:s,foreignKey:o}=n,l=r.relationCache[s],a=null==l||null===(i=l[e])||void 0===i?void 0:i.slice();null==a||a.forEach((n=>{r.cacheRelatedRecord(n,t,s,e),n.set(o,t,!1,!0)}))}))}))}},"$name","StoreRelation"),i},ns=e=>class extends(e||de){static get $name(){return"StoreSum"}sum(e,t=this.storage.values){return t?t.reduce(((t,n)=>{if(n.isSpecialRow)return t;const i=Number(n[e]);return isNaN(i)?t:t+i}),0):0}min(e,t=this.storage.values){return t&&t.length?t.reduce(((t,n)=>{var i;return"number"===typeof(null===(i=n[e])||void 0===i?void 0:i.valueOf())&&n[e]<t&&(t=n[e]),t}),t[0][e]):0}max(e,t=this.storage.values){return t&&t.length?t.reduce(((t,n)=>{var i;return"number"===typeof(null===(i=n[e])||void 0===i?void 0:i.valueOf())&&n[e]>t&&(t=n[e]),t}),t[0][e]):0}average(e,t=this.storage.values){if(!t||!t.length)return 0;let n=0;const i=t.reduce(((t,i)=>{if(i.isSpecialRow)return t;const r=parseFloat(i[e]);return isNaN(r)?t:(n++,t+r)}),0);return n>0?i/n:0}groupSum(e,t){return this.sum(t,this.getGroupRecords(e))}};const is=(e,t)=>String(e).toLowerCase().includes(t),rs={string:is,number:is,boolean:is,date:(e,t)=>e instanceof Date&&t instanceof Date?e-t==0:String(e.getMonth()+1).includes(t)||String(e.getDate()).includes(t)||String(e.getFullYear()).includes(t),object:(e,t)=>e===t,undefined:(e,t)=>e===t};var ss=e=>class extends(e||de){static get $name(){return"StoreSearch"}search(e,t=null,n,i){const r=this.isTree&&!i?this.rootNode.allChildren:this.getAllDataRecords(i),s=r.length,o=[];if(null==e)return[];let l,a,c,d,u,h;for("string"==typeof e&&(e=e.toLowerCase()),l=0;l<s;l++){c=r[l],a=0;for(const i of t||c.fieldNames){var g;d=c[i],u=d instanceof Date?"date":typeof d;const t=null==n?void 0:n[a];t&&(d=t(d),u="string"),h=rs[u],d&&null!==(g=h)&&void 0!==g&&g(d,e)&&o.push({index:l,data:c,field:i,id:c.id}),a++}}return o}findByField(e,t,n=!1,i=!1){const r=this.getAllDataRecords(i),s=r.length,o=new Set,l=[];let a,c,d;for(null!=t&&(t=String(t).toLowerCase()),a=0;a<s;a++)if(c=r[a],d=c[e],!n||!o.has(d)){const e=d instanceof Date?"date":typeof d,i=rs[e];(null==t&&d===t||t&&i(d,t))&&(l.push({id:c.id,index:a,data:c}),n&&o.add(d))}return l}find(e,t=!1){return this.getAllDataRecords(t).find(e)}findRecord(e,t,n=!1){const i=n=>Nt.isEqual(n[e],t);return this.isTree?this.query(i,n)[0]:this.getAllDataRecords(n).find(i)}query(e,t=!1){if(this.isTree){const n=[];return this.traverse((t=>{e(t)&&n.push(t)}),void 0,void 0,t),n}return this.getAllDataRecords(t).filter(e)}some(e,t=!1){return this.getAllDataRecords(t).some(e)}};const os=/\./;var ls=e=>class extends(e||de){static get $name(){return"StoreSort"}static get defaultConfig(){return{useLocaleSort:null}}static get configurable(){return{sorters:[],reapplySortersOnAdd:!1}}get isSorted(){return Boolean(this.sorters.length)||this.isGrouped}changeSorters(e){return e.map((e=>this.normalizeSorterConfig(e,!0)))}updateReapplySortersOnAdd(e){this.storage.autoSort=e}sort(e,t,n=!1,i=!1){const r=this,s=r.allRecords,o=r.sorters?r.sorters.slice():[];let l,a=null;if(e)if(Array.isArray(e))r.sorters=e.map((e=>r.normalizeSorterConfig(e,"string"==typeof e||t)));else{const i=r.normalizeSorterConfig(e,t);n?(l=r.getCurrentSorterByField(i.field),l?(a=l.ascending,l.ascending=i.ascending):r.sorters.push(i)):r.sorters=[i]}return i||!1!==r.trigger("beforeSort",{sorters:r.sorters,records:s,currentSorters:o})?r.performSort(i):(r.sorters=o,null!==a&&(l.ascending=a),null)}normalizeSorterConfig(e,t){const n=this,i={ascending:t};var r;"object"==typeof e?(Nt.assign(i,e),e.fn&&(delete i.fn,i.sortFn=e.fn),i.ascending=null!==(r=e.ascending)&&void 0!==r?r:t):"function"==typeof e?i.sortFn=e:i.field=e;if(null==i.ascending){const e=n.getCurrentSorterByField(i.field);i.ascending=!e||!e.ascending}if(null==i.sortFn){var s,o;const e=null===(s=n.modelClass)||void 0===s||null===(o=s.$meta.fields.map[i.field])||void 0===o?void 0:o.compareItems;e&&(i.sortFn=e)}return i}getCurrentSorterByField(e){return"string"==typeof e&&this.sorters.find((t=>t.field===e))||null}addSorter(e,t=!0){return this.sort(e,t,!0)}removeSorter(e){const t=this.sorters.findIndex((t=>t.field===e||t.sortFn===e));if(t>-1)return this.sorters.splice(t,1),this.sort()}clearSorters(e=!1){if(this.sorters.length)return this.sorters.length=0,this.sort(void 0,void 0,void 0,e)}createSorterFn(e){const t=this.useLocaleSort;return(n,i)=>{for(let r=0;r<e.length;r++){const s=e[r],{field:o,ascending:l=!0,useLocaleSort:a=t}=s,c=s.fn||s.sortFn,d=l?1:-1;if(c){const e=c.call(s,n,i);if(null!==e)return e*d}const u=os.test(o),h=u?n.get(o):n[o],g=u?i.get(o):i[o];if(h!==g){if(null==h)return-d;if(null==g)return d;if(a&&"string"==typeof h){if(!0===a)return String(h).localeCompare(g)*d;if("string"==typeof a)return String(h).localeCompare(g,a)*d;if("object"==typeof a)return String(h).localeCompare(g,a.locale,a)*d}if(h>g)return d;if(h<g)return-d}}return 0}}get sorterFn(){const e=this,{sorters:t}=e;return e.createSorterFn(e.remoteSort?[{field:"_remoteSortIndex"}]:e.isGrouped?e.groupers.concat(t):t)}performSort(e){const t=this,{rootNode:n,storage:i,sorterFn:r}=t;t.tree?(!t.isChained&&n.traverse((e=>{e.isLoaded&&e.isParent&&(e.children.sort(r),e.updateChildrenIndices(e.children,"parentIndex",!0))})),i.replaceValues({values:t.collectDescendants(n).visible,silent:!0})):t.isGrouped?i.replaceValues({values:t.prepareGroupRecords(r),silent:!0}):i.replaceValues({values:i.values.sort(r),silent:!0}),t.afterPerformSort(e||t.isRemoteDataLoading)}afterPerformSort(e){if(e)return;const t=this;t._idMap=null;const n={action:"sort",sorters:t.sorters,records:t.allRecords};t.trigger("sort",n),t.trigger("refresh",n)}};const as=e=>!0;var cs=e=>class extends(e||de){static get $name(){return"StoreChained"}static get defaultConfig(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],keepUncommittedChanges:!1,excludeCollapsedRecords:!0}}static get properties(){return{chainedStores:null}}construct(e){super.construct(e);const t=this,{masterStore:n}=t,i=t.syncOrder?"sort":"";n&&(t.methodNamesToRelay.forEach((e=>t[e]=(...n)=>t.relayToMaster(e,n))),t.removeAll=(...e)=>{n.remove(t.getRange(),...e)},n.ion({changePreCommit:t.onMasterDataChangedPreCommit,change:t.onMasterDataChanged,[i]:t.onMasterDataChanged,prio:1,thisObj:t}),n.chainedStores||(n.chainedStores=[]),n.chainedStores.push(t),t.fillFromMaster())}get $master(){return this.masterStore||this}get isChained(){return Boolean(this.masterStore)}set chainedFilterFn(e){this._chainedFilterFn=this.thisObj?e.bind(this.thisObj):e}get chainedFilterFn(){return this._chainedFilterFn||as}get methodNamesToRelay(){const e=Array.isArray(this.doRelayToMaster),t=Array.isArray(this.dontRelayToMaster);return e&&this.doRelayToMaster.filter((e=>!t||!this.dontRelayToMaster.includes(e)))||[]}updateChainedStores(){this.chainedStores&&this.chainedStores.forEach((e=>e.fillFromMaster()))}fillFromMaster(){const e=this,{masterStore:t,isTree:n}=e,i=e.chainedFilterFn.length>0||e.chainedFilterFn.toString().length<=10;let r;if(!e.isChained)throw new Error("fillFromMaster only allowed on chained store");if(e.keepUncommittedChanges){if(n)throw new Error("Cannot use keepUncommittedChanges on a chained tree store");r=i?t.allRecords.filter((t=>!e.removed.includes(t)&&!e.added.includes(t)&&e.chainedFilterFn(t))):e.chainedFilterFn().filter((t=>!e.removed.includes(t)&&!e.added.includes(t))),r=e.added.values.filter((t=>!e.removed.includes(t))).concat(r)}else if(r=i?t.allRecords.filter(e.chainedFilterFn):e.chainedFilterFn(),n&&(e.idRegister={},e.internalIdRegister={},r.forEach((t=>{t.stores.includes(e)?e.register(t):t.joinStore(e)})),e.excludeCollapsedRecords)){const t=e.getChildren(e.rootNode);r=e.doIncludeExclude(t,!0)}e.data=r}commitToMaster(){const e=this,t=e.masterStore;if(!e.isChained)throw new Error("commitToMaster only allowed on chained store");return t.beginBatch(),t.remove(e.removed.values),t.add(e.added.values),t.endBatch(),e.commit()}relayToMaster(e,t){return this.masterStore[e](...t)}onMasterDataChangedPreCommit(e){this.onMasterDataChanged(e),this.$masterEventhandled=!0}onMasterDataChanged({action:e,changes:t,$handled:n,isMove:i}){var r;this.$masterEventhandled?this.$masterEventhandled=!1:i&&"remove"===e||("update"!==e||null!==(r=this.chainedFields)&&void 0!==r&&r.some((e=>e in t)))&&this.fillFromMaster()}makeChained(e=as,n,i){return new((null==i?void 0:i.storeClass)||this.constructor)(t(t({},i||{}),{},{tree:!1,autoTree:!1,masterStore:this.$master,modelClass:this.modelClass,syncDataOnLoad:!1,chainedFilterFn:e,chainedFields:n}))}chain(){return this.makeChained(...arguments)}doDestroy(){var e;null===(e=this.chainedStores)||void 0===e||e.forEach((e=>e.destroy())),super.doDestroy()}},ds=e=>class extends(e||de){static get $name(){return"StoreState"}getState(){const{sorters:e,groupers:t,filters:n}=this,i={};return null!=e&&e.length&&(i.sorters=e.map((e=>{const t=Nt.cleanupProperties(Nt.clone(e));return delete t.fn,delete t.sortFn,t}))),null!=t&&t.length&&(i.groupers=t.map((e=>{const t=Nt.cleanupProperties(Nt.clone(e));return delete t.fn,t}))),null!=n&&n.values.length&&(i.filters=n.values.map((e=>{const t=Nt.cleanupProperties(Nt.clone(e.config));return t.value=e.value,t.caseSensitive&&delete t.caseSensitive,t}))),i}applyState(e){const t=this,{sorters:n=[],groupers:i=[],filters:r=[]}=e,{sortParamName:s,filterParamName:o}=t;t.sorters=n.filter((e=>e.field||e.sortFn&&!s)),t.groupers=i.slice(),t.sort(),t.filters=r.filter((e=>e.property||e.filterBy&&!o)),t.filter()}};const us=e=>String(e).padStart(6,"0");class hs{constructor(e){this.value=e,this._padded=null}set value(e){this._value=String(null!=e?e:"")}get value(){return this._value}static from(e){return null==e||e instanceof hs?e:new hs(e)}static pad(e){return e instanceof hs?e.valueOf():hs.split(e).map(us).join(".")}static split(e){let t,n;if(e||0===e)switch(typeof e){case"object":e=String(e);case"string":for(n=e.split("."),t=n.length;t-- >0;)n[t]=parseInt(n[t],10);break;case"number":n=[e]}return n||[]}static compare(e,t){return e===t?0:e&&t?(e=hs.pad(e))<(t=hs.pad(t))?-1:t<e?1:0:e?1:t?-1:0}append(e){const t=this.value;return hs.from(t?`${t}.${e}`:e)}isEqual(e){return!hs.compare(this,e)}match(e){let t=!1;if(e){const n=this.value,i="*"===e[0],r=e.endsWith("*"),s=e.length;t=i===r?n.indexOf(i?e.substr(1,s-2):e)>-1:i?n.endsWith(e.substr(1)):n.startsWith(e.substr(0,s-1))}return t}toString(){return this.value}toJSON(){return this.toString()}valueOf(){var e;return null!==(e=this._padded)&&void 0!==e?e:this._padded=hs.pad(this.value)}}hs._$name="Wbs";const gs=Object.freeze([]);var ms=e=>{var t;return n(t=class extends(e||de){get isTree(){return this.tree||this.masterStore&&this.masterStore.tree}get leaves(){const e=this,t=[];return e.isTree?(e.traverse((e=>{e.isLeaf&&t.push(e)})),t):(e.allRecords.forEach((e=>{e.isLeaf&&t.push(e),e.traverse((e=>{e.isLeaf&&t.push(e)}),!0)})),t)}async loadChildren(e){}onNodeAddChild(e,t,n,i,r=!1){const s=this,o=e===s.rootNode&&e.isLoading,{storage:l}=s,a=[],c=[],{previousSibling:d}=t[0];let u;if(s.collectDescendants(t,a,c,{inCollapsedBranch:!(e.isExpanded(s)&&e.ancestorsExpanded(s))}),!o&&c.length)for(const e of c)s.modified.includes(e)||i[e.id]||(s.removed.includes(e)?s.removed.remove(e):e.isLinked||s.added.add(e));var h;if(o&&s.rootVisible&&(a.unshift(e),c.unshift(e)),a.length&&(u=0!==n&&d?l.indexOf(d)+d.getDescendantCount(!0,s):l.indexOf(e),l.suspendEvents(),s.storage.splice(++u,0,a),l.resumeEvents(),s._idMap=null),s.updateDependentStores("add",t),o&&a.length){if(s.sorters.length&&s.sort(null,null,!1,!0),null===(h=s.afterLoadData)||void 0===h||h.call(s),!r){const e={action:"dataset",data:s._data,records:a};s.trigger("refresh",e),s.trigger("change",e)}}else if(!r){const n={action:"add",parent:e,isChild:!0,isMove:i,records:t,allRecords:c,index:u};if(s.trigger("add",n),s.trigger("change",n),Object.values(i).some((e=>e))){const n={newParent:e,records:t.filter((e=>i[e.id])),oldParents:t.map((e=>{const t=s.getById(e.meta.oldParentId);return null!=t&&t.isRoot?null:t}))};s.trigger("move",n)}}}onNodeRemoveChild(e,t,n,i={isMove:!1,silent:!1,unfiltered:!1}){const r=this,{storage:s}=r,o=[],l=[],{isMove:a,silent:c,unfiltered:d}=i,u=d&&r.isFiltered,h=u&&e.unfilteredChildren?e.unfilteredChildren:t;if(r.collectDescendants(h,o,l,{inCollapsedBranch:!(e.isExpanded(r)&&e.ancestorsExpanded(r)),unfiltered:u}),!a){for(const e of t)e.unjoinStore(r);for(const e of l)e.stores.includes(r)&&e.unjoinStore(r),r.added.includes(e)?r.added.remove(e):e.isLinked||r.removed.add(e);r.modified.remove(l)}if(o.length?(n=s.indexOf(o[0]))>-1&&(s.suspendEvents(),s.splice(n,o.length),s.resumeEvents(),r._idMap=null):n=-1,!c&&(r.fireRemoveEventForMoveAction||!a)){const i={action:"remove",parent:e,isChild:!0,isMove:a,records:t,allRecords:l,index:n};r.trigger("remove",i),r.trigger("change",i)}return l}collectDescendants(e,t=[],n=[],i){const r=this,{inCollapsedBranch:s=!1,unfiltered:o=!1}=i||0,l=Array.isArray(e)?e:r.getChildren(e,o);if(l)for(let e,i=0,a=l.length;i<a;i++)e=l[i],s||t.push(e),n.push(e),r.collectDescendants(e,t,n,{inCollapsedBranch:s||!e.isExpanded(r),unfiltered:o});return{visible:t,all:n}}getChildren(e,t=!1){const n=this,i=(t||n.isChained)&&e.unfilteredChildren||e.children;return null!=i&&i.length?n.isChained?i.filter(n.chainedFilterFn).sort(n.sorterFn):i:gs}internalToggleTreeSubRecords(e,t){const n=this,{storage:i}=n,r=i.indexOf(e),s=n.doIncludeExclude(n.getChildren(e),t);if(n.isFiltered&&t&&e.unfilteredChildren&&n.updateChildrenHiddenState(e),s.length&&!1!==r){if(i.suspendEvents(),t){i.splice(r+1,0,...s);const e={action:"add",isExpand:!0,records:s,index:r+1};n.trigger("add",e),n.trigger("change",e)}else{i.splice(r+1,s.length);const e={action:"remove",isCollapse:!0,records:s,index:r+1};n.trigger("remove",e),n.trigger("change",e)}i.resumeEvents(),n._idMap=null}}updateChildrenHiddenState(e){var t;null===(t=e.unfilteredChildren)||void 0===t||t.forEach((e=>{e.instanceMeta(this.id).hidden=!1,e.isLeaf||this.updateChildrenHiddenState(e)}))}doIncludeExclude(e,t,n=[]){const i=this,r=(null==e?void 0:e.length)||0;for(let s=0;s<r;s++){const r=e[s];if(!i.isChained||i.chainedFilterFn(r)){const e=r.instanceMeta(i.id);!t&&e.hidden||n.push(r),e.hidden=!t,r.isExpanded(i)&&i.doIncludeExclude(i.getChildren(r),t,n)}}return n}async toggleCollapse(e,t){const n=this,i=n.getById(e),r=i.instanceMeta(n);if(void 0===t&&(t=!r.collapsed),!r.isLoadingChildren&&!i.isLeaf&&i.isExpanded(n)===t){if(n.trigger("beforeToggleNode",{record:i,collapse:t}),r.collapsed=t,r.collapsed)return n.onNodeCollapse(i),!0;{n.onNodeExpand(i);let e=!0;if(!i.isLoaded){r.isLoadingChildren=!0;try{await n.loadChildren(i)}catch(t){r.collapsed=!0,e=!1,n.trigger("loadChildrenException",{record:i,exception:t})}finally{r.isLoadingChildren=!1}}return e}}}onNodeCollapse(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!1)}onNodeExpand(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!0)}transformToTree(e){const{parentIdField:t,idField:n,childrenField:i}=this.modelClass,r=new Map,s=[];for(const l of e){const a=l[t];if(null!=a){let t=r.get(a);var o;if(void 0===t)t=null!==(o=e.find((e=>e[n]===a)))&&void 0!==o?o:null,r.set(a,t);t&&(t[i]||(t[i]=[]),t[i].push(l))}else s.push(l)}return s}treeify(e,t,n=!1){const{length:i}=e,r=[],s={};let o,l;for(o=0;o<i;o++){if(!e[o].call){const t=e[o];e[o]=e=>e[t]}r[o]=new Map}this.rootNode.traverse((t=>{if(l=null,t.isLeaf){for(o=0;o<i;o++){var n;const i=(null===(n=l)||void 0===n?void 0:n.path)||"",s=r[o],a=e[o](t),c=`${i+a}/`,d=S.makeValidDomId(`generated_${c}`,"_"),u=s.get(d)||s.set(d,{id:d,key:a,path:c,expanded:!0,readOnly:!0,children:[],generatedParent:!0}).get(d);l&&!l.children.includes(u)&&l.children.push(u),l=u}l.children.push(t)}}),!0),r.forEach((e=>e.forEach(((e,i,r)=>{null==t||t(e),n&&(e=this.createRecord(e),r.set(i,e))})))),s.children=[...r[0].values()];const a=t=>{t.children&&(t.children.sort(((t,n)=>{if(t.isLeaf){let r;for(let s=0;!r&&s<i;s++){const i=e[s](t),o=e[s](n);r=i<o?-1:o>i?1:0}return r}return"string"==typeof t.key||"string"==typeof n.key?t.key.localeCompare(n.key,void 0,{numeric:!0}):t.key<n.key?-1:t.key>n.key?1:0})),t.children.forEach(a))};return a(s),s}treeifyFlatData(e){const{childrenField:t,parentIdField:n}=this.modelClass;let i=!1,r=!0;for(const s of e){if(s.isModel||Array.isArray(s[t])){r=!1;break}null!=s[n]&&(i=!0)}return r&&i&&(e=this.transformToTree(e)),e}async indent(e){const t=this;if((e=(e=Array.isArray(e)?e:[e]).filter((t=>{let n=Boolean(t.previousSibling);for(;n&&!t.isRoot;)n=!e.includes(t.parent),t=t.parent;return n}))).length&&!1!==t.trigger("beforeIndent",{records:e})){e.sort(((e,t)=>hs.compare(e.wbsCode,t.wbsCode))),t.beginBatch();for(const n of e){const e=n.previousSibling;e.appendChild(n),t.toggleCollapse(e,!1)}t.endBatch(),t.trigger("indent",{records:e}),t.trigger("change",{action:"indent",records:e})}}async outdent(e){const t=this;if((e=(e=Array.isArray(e)?e:[e]).filter((t=>{const{parent:n}=t;let i=n&&!n.isRoot;for(;i&&!t.isRoot;)i=!e.includes(n),t=t.parent;return i}))).length&&!1!==t.trigger("beforeOutdent",{records:e})){e.sort(((e,t)=>hs.compare(e.wbsCode,t.wbsCode))),t.beginBatch();for(const n of e){const{parent:e}=n,i=e.children.slice(e.children.indexOf(n)+1);e.parent.insertChild(n,e.nextSibling),n.appendChild(i),t.toggleCollapse(n,!1)}t.endBatch(),t.trigger("outdent",{records:e}),t.trigger("change",{action:"outdent",records:e})}}},"$name","StoreTree"),n(t,"configurable",{transformFlatData:null,fireRemoveEventForMoveAction:A.checkVersion("core","6.0","<")}),t};class ps{static preWalk(e,t,n){const i=[e];let r,s;for(;i.length;)r=i.pop(),n(r),s=t(r),s&&i.push.apply(i,s.slice().reverse())}static preWalkWithParent(e,t,n){const i=[{node:e,parent:null}];for(;i.length;){const{parent:e,node:r}=i.pop();n(e,r);const s=t(r);Array.isArray(s)&&i.push(...s.slice().reverse().map((e=>({node:e,parent:r}))))}}static preWalkUnordered(e,t,n){const i=[e];let r,s;for(;i.length;)r=i[i.length-1],n(r),s=t(r),s?i.splice(i.length-1,1,...s):i.length=i.length-1}static postWalk(e,t,n){const i=new Map,r=[e];let s,o;for(;r.length;)s=r[r.length-1],i.has(s)?(n(s),r.pop()):(o=t(s),o&&r.push(...o.slice().reverse()),i.set(s,s))}static prePostWalk(e,t,n,i){const r=new Map,s=[e];let o,l;for(;s.length;)o=s[s.length-1],r.has(o)?(i(o),s.pop()):(n(o),l=t(o),l&&s.push(...l.slice().reverse()),r.set(o,o))}}ps._$name="WalkHelper";var fs=e=>class extends(e||de){static get $name(){return"StoreSync"}static get configurable(){return{syncDataOnLoad:null}}syncDataset(e){const t=this,{storage:n}=t;t.isSyncingDataOnLoad=!0;const{toAdd:i,toRemove:r,toMove:s,updated:o,ids:l}=t.tree?t.syncTreeDataset(e):t.syncFlatDataset(e);let{threshold:a}=t.syncDataOnLoad,c=!1;if(a&&("string"==typeof a&&(a=parseInt(a,10)/100*t.count),c=i.length+r.length+s.length+o.length>a),t.tree){if(i.length){t.add(i,c).forEach((e=>e.clearParentId()))}if(s.length)for(const{parent:e,node:n,index:i}of s){t.getById(e.id).insertChild(n,i)}t.remove(r,c)}else c&&t.suspendEvents(),t.remove(r),t.add(i),c&&t.resumeEvents();a&&!c&&o.forEach((({record:e,toSet:n,wasSet:i})=>t.onModelChange(e,n,i))),t.acceptChanges();const d={added:i,removed:r,updated:o,thresholdSurpassed:c};if(t.isFiltered&&!t.remoteFilter&&t.filter({silent:t.isRemoteDataLoading}),t.isGrouped)t.group(null,null,!1,!0,t.isRemoteDataLoading);else if(t.isSorted)t.remoteSort?n.replaceValues({values:n.values.sort(t.createSorterFn(t.sorters)),silent:!0}):t.sort();else if(t.tree){let e=!1,n=0;ps.preWalk(t.rootNode,(t=>Array.isArray(t.children)&&!e?t.children:null),(t=>{t.id!==l[n++]&&(e=!0)})),e&&(t.sort(((e,t)=>l.indexOf(e.id)-l.indexOf(t.id)),void 0,void 0,!0),t.clearSorters(!0),!c&&t.afterPerformSort())}else n.values.some(((e,t)=>e.id!==l[t]))&&(n.replaceValues({values:n.values.sort(((e,t)=>l.indexOf(e.id)-l.indexOf(t.id))),silent:!0}),!c&&t.afterPerformSort());c&&t.trigger("refresh",{action:"batch",data:e,records:n.values,syncInfo:d}),t.isSyncingDataOnLoad=!1,t.trigger("loadSync",d)}syncFlatDataset(e){if(!e)return{toRemove:this.records};const t=this,{idField:n,allFields:i}=t.modelClass,r=[],s=[],o=[],l={},a=[],{threshold:c,keepMissingValues:d}=t.syncDataOnLoad;let u=0;return e.forEach((e=>{const r=(e=e.isModel?e.data:e)[n],h=t.getById(r);if(h){if(!1===d)for(const t of i)!(t.dataSource in e)&&t.dataSource in h.data&&(e[t.dataSource]=t.defaultValue);const t=h.set(e,null,Boolean(c));t&&o.push({record:h,wasSet:t,toSet:e}),u++}else s.push(t.processRecord(t.createRecord(e)));l[r]=1,a.push(r)})),u<t.allCount&&t.forEach((e=>{l[e.id]||r.push(e)})),{toAdd:s,toRemove:r,toMove:[],updated:o,ids:a}}syncTreeDataset(e){if(!e)return{toRemove:this.records};const n=this,{idField:i,parentIdField:r,childrenField:s,allFields:o}=n.modelClass,{keepMissingValues:l}=n.syncDataOnLoad,a=[],c=[],d=[],u=[],h={},g=[];n.transformFlatData&&(e=n.treeifyFlatData(e));const{threshold:m}=n.syncDataOnLoad;return ps.preWalkWithParent({isRoot:!0,id:n.rootNode.id,children:e},(e=>e.children),((e,a)=>{if(e){const p=a[i],f=n.getById(p);if(f){let t;const r=f.children;if(!0!==r&&!0===a[s]&&(f.clearChildren(),f.data[s]=f.children=!0,delete a[s],n.toggleCollapse(f,!0),t=!0),f.parent.id!==e[i]&&d.push({node:f,parent:e,index:e[s].indexOf(a)}),!1===l)for(const e of o)"parentId"!==e.name&&!(e.dataSource in a)&&e.dataSource in f.data&&(a[e.dataSource]=e.defaultValue);const c=f.set(a,null,Boolean(m));c?u.push({record:f,wasSet:c,toSet:a}):t&&f.signalNodeChanged({[s]:{value:!0,oldValue:r}})}else a[r]=e[i],c.push(t(t({},a),Array.isArray(a[s])?{children:[]}:void 0));h[p]=1,g.push(p)}})),n.traverse((e=>{h[e.id]||a.push(e)})),{toAdd:c,toRemove:a,toMove:d,updated:u,ids:g}}};const vs=Symbol("STM_PROP");var ys=e=>class extends(e||de){static get $name(){return"StoreStm"}static get defaultConfig(){return{stm:null,ignoreRemoteChangesInSTM:!1}}get stm(){return this[vs]}set stm(e){const t=this;var n;t.stm!==e&&(null!==(n=t.stm)&&void 0!==n&&n.hasStore(t)&&t.stm.removeStore(t),t[vs]=e,t.stm&&!t.stm.hasStore(t)&&t.stm.addStore(t))}add(e,t=!1,n={}){let i;const{stm:r}=this;var s;!this.tree&&null!=r&&r.enabled?(i=super.add(e,t),null!==(s=i)&&void 0!==s&&s.length&&r.onStoreModelAdd(this,i,t)):i=super.add(e,t,n);return i}insert(e,t,n=!1){let i;const{stm:r}=this;if(!this.tree&&null!=r&&r.enabled){var s;const o=(Array.isArray(t)?t:[t]).reduce(((e,t)=>{const n=t instanceof xr?this.indexOf(t):void 0;return void 0!==n&&-1!==n&&e.set(t,n),e}),new Map);i=super.insert(e,t),null!==(s=i)&&void 0!==s&&s.length&&(e=this.indexOf(i[0]),r.onStoreModelInsert(this,e,i,o,n))}else i=super.insert(e,t,n);return i}remove(e,t=!1,n){let i;const{stm:r}=this;if(!this.tree&&null!=r&&r.enabled){var s;const o=(Array.isArray(e)?e:[e]).map((e=>this.getById(e))).filter((e=>!!e)).reduce(((e,t)=>{const n=this.indexOf(t);return void 0!==n&&-1!==n&&e.set(t,n),e}),new Map);i=super.remove(e,t,n),null!==(s=i)&&void 0!==s&&s.length&&r.onStoreModelRemove(this,i,o,t)}else i=super.remove(e,t,n);return i}removeAll(e){const{stm:t}=this;let n;if(null!=t&&t.enabled){const{tree:i,rootNode:r,allRecords:s}=this,o=s.length,l=i?r.children.slice():s.slice();n=super.removeAll(e),o&&0===this.count&&t.onStoreRemoveAll(this,l,e)}else n=super.removeAll(e);return n}beforeApplyChangeset(){const{stm:e,crudManager:t}=this;let n=!1;return null!=t&&t.applyingChangeset||null==e||!e.enabled||(n=!0,e.isRecording&&e.stash(),this.ignoreRemoteChangesInSTM?e.disable():e.startTransaction()),n}applyChangeset(e,t,n,i,r){const s=this.beforeApplyChangeset(),o=super.applyChangeset(e,t,n,i,r);return this.afterApplyChangeset(s),o}afterApplyChangeset(e){if(e){const{stm:e}=this;this.ignoreRemoteChangesInSTM?e.enable():e.stopTransaction(),e.applyStash()}}};const bs={splice:1,clear:1},Cs={includeFilteredOutRecords:!1,includeCollapsedGroupRecords:!1},ws=(e,t)=>("boolean"==typeof(t=t||!1)&&(t={includeFilteredOutRecords:t,includeCollapsedGroupRecords:!1}),t||Cs);class Es extends(de.mixin(Pi,Ki,$e,Fi,Ui,Jr,Xr,Gr,ts,ns,ss,ls,Qr,cs,ds,ms,ys,fs,es)){static get $name(){return"Store"}static get properties(){return{relationCache:{},dependentStoreConfigs:new Map}}static get configurable(){return{id:!0,modelClass:xr,verifyNoGeneratedIds:!0}}static get defaultConfig(){return{fields:null,autoTree:!0,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null}}static get identifiable(){return{registerGeneratedId:!1}}constructor(...e){if(super(...e),this.objectify)return this.initProxy()}construct(e={}){Object.assign(this,{added:new Kr,removed:new Kr,modified:new Kr,idRegister:{},internalIdRegister:{},oldIdMap:{}}),e.storeId&&(e=Nt.assign({id:e.storeId},e)),super.construct(e),this.initRelations()}static from(e,t={},n=null){return e&&!e.isStore&&("string"==typeof e?e=Es.getStore(e):(Array.isArray(e)&&(n&&(e=e.map((e=>e.isModel?e:n(e)))),e=Nt.assign({},t,{data:e})),e=new Es(e))),e}doDestroy(){var e,t,n;const i=this,r=i.registeredRecords;for(let e,t=r.length-1;t>=0;t--){var s;e=r[t],null!==(s=e)&&void 0!==s&&s.isDestroyed||e.unjoinStore(i)}var o;(null===(e=i._storage)||void 0===e||e.destroy(),null===(t=i.stm)||void 0===t||null===(n=t.removeStore)||void 0===n||n.call(t,i),i.isChained)||(null===(o=i.rootNode)||void 0===o||o.destroy());super.doDestroy()}beginBatch(){this.suspendEvents()}endBatch(){this.resumeEvents()&&this.trigger("refresh",{action:"batch",data:this.storage.values,records:this.storage.values})}set storage(e){const t=this;null!=e&&e.isCollection?t._storage=e:t._storage=new Hr(e),t._storage.autoFilter=t.reapplyFilterOnAdd,t._storage.autoSort=t.reapplySortersOnAdd;for(const e of t._storage)e.joinStore(t);t._storage.ion({change:"onDataChange",thisObj:t})}get storage(){return this._storage||(this.storage={}),this._storage}get allRecords(){const e=this;if(e.isTree){const t=e.collectDescendants(e.rootNode,void 0,void 0,{unfiltered:!0}).all;return e.rootVisible&&t.unshift(e.rootNode),t}return e.isGrouped?e.collectGroupRecords():e.storage.allValues}getAllDataRecords(e){return this.isGrouped?this.collectGroupRecords(e,!1):e?this.storage.allValues:this.storage.values}onIsCreatingToggle(e,t){const n=this,i=e.isPersistable&&!t;n.added[i?"add":"remove"](e),i&&(n.trigger("addConfirmed",{record:e}),n.autoCommit&&n.doAutoCommit())}joinRecordsToStore(e){const{allCount:t}=this;for(let n=0;n<e.length;n++){const i=e[n];i.setData("parentIndex",t+n-e.length),i.joinStore(this)}}onDataChange({source:e,action:t,added:n,removed:i,replaced:r,oldCount:s,items:o,from:l,to:a}){const c=this,d=bs[t],u=d&&(null==n?void 0:n.length),h=d&&(null==i?void 0:i.length);let g,m;if(c._idMap=null,u&&c.joinRecordsToStore(n),null==r||r.forEach((([e,t])=>{e.unjoinStore(c,!0),t.joinStore(c)})),super.onDataChange(...arguments),!c.isTree){if(u){for(const e of n)c.removed.includes(e)?c.removed.remove(e):e.isLinked||c.added.add(e);g=!c.remoteFilter&&c.filtered&&c.reapplyFilterOnAdd,g&&c.filter({silent:!0}),m=!c.remoteSort&&c.isSorted&&c.reapplySortersOnAdd,m&&c.sort(null,null,!1,!0)}if(h){for(const e of i)e.cancelBatch(),e.unjoinStore(c),c.added.includes(e)?c.added.remove(e):e._undoingInsertion||e.isCreating||e.isLinked||c.removed.add(e);c.modified.remove(i),g=!c.remoteFilter&&c.filtered,g&&c.filter({silent:!0})}}switch(t){case"clear":c.relationCache={},c.updateDependentStores("removeall"),c.trigger("removeAll"),c.trigger("change",{action:"removeall"});break;case"splice":if(u){c.updateDependentStores("add",n);const t=n.reduce(((e,t)=>{const{previousIndex:n}=t.meta;return n>-1&&n<e&&(e=n),e}),n[0].meta.previousIndex),i={records:n,index:e.indexOf(n[0],!e.autoFilter)};t>-1&&(i.oldIndex=t),c.trigger("add",i),c.trigger("change",Object.assign({action:"add"},i)),g&&c.triggerFilterEvent({action:"filter",filters:c.filters,oldCount:s,records:c.storage.allValues}),m&&c.trigger("sort",{action:"sort",sorters:c.sorters,records:c.storage.allValues})}i.length&&(c.updateDependentStores("remove",i),c.trigger("remove",{records:i}),c.trigger("change",{action:"remove",records:i})),r.length&&(c.trigger("replace",{records:r,all:c.records.length===r.length}),c.trigger("change",{action:"replace",replaced:r,all:c.records.length===r.length}));break;case"filter":(c.isGrouped||c.isSorted)&&c.performSort(!0);break;case"move":{const e=Math.min(l,a),n=Math.min(c.storage.allValues.length-1,Math.max(l,a));for(let t=c.storage.allValues,i=e;i<=n;i++)t[i].setData("parentIndex",i);c.trigger("move",{record:o[0],records:o,from:l,to:a}),c.isFiltered&&c.performFilter(),c.trigger("change",{action:t,record:o[0],records:o,from:l,to:a});break}}}onDataReplaced(e,t){var n;const i=this,{storage:r}=i,s=r.allValues,o=Boolean(i.sorters.length>0);for(let e=0;e<s.length;e++)s[e].joinStore(i);const l=i.prepareGroupRecords();if(!i.remoteFilter&&i.isFiltered&&i.filter({silent:!0}),i.remoteSort?i.isGrouped&&r.replaceValues({values:l,silent:!0}):(i.isGrouped&&i.group(null,null,!1,!o,!0),o&&i.sort(null,null,!1,!0)),!i.useRawData.disableDuplicateIdCheck){const{idMap:e}=i;if(Object.keys(e).length<r.values.length){const t=[];throw r.values.forEach((n=>e[n.id]?delete e[n.id]:t.push(n))),new Error(`Id collision on ${t.map((e=>e.id))}`)}}const a={action:e,data:t,records:r.values};i.updateDependentStores(e,a.records),null===(n=i.afterLoadData)||void 0===n||n.call(i),i.isRemoteDataLoading||i.trigger("refresh",a),i.trigger("change",a)}onModelChange(e,t,n,i,r){const s=this,o={record:e,records:[e],changes:n,batch:null!=e.batching,fromRelationUpdate:r},l=!e.ignoreBag&&!e.isLinked&&s.updateModifiedBagForRecord(e);if(s.storage.onItemMutation(e,n),"id"in n){const{oldValue:n,value:i}=t.id;s.updateDependentRecordIds(n,i),s.onRecordIdChange({record:e,oldValue:n,value:i})}if(!i){if("id"in n){const{oldValue:n,value:i}=t.id;s.trigger("idChange",{store:s,record:e,oldValue:n,value:i})}s.onUpdateRecord(e,n),s.trigger("update",o),s.trigger("change",Object.assign({action:"update"},o))}s.autoCommit&&l&&s.doAutoCommit()}updateModifiedBagForRecord(e){const t=this;let n=!1;return e.isModified?t.modified.includes(e)||t.added.includes(e)||!e.isPartOfStore(t)||e.isAutoRoot||(e.isPhantom?t.added.add(e):t.modified.add(e),n=!0):t.modified.remove(e),n}get idMap(){const e=this,t=!e._idMap,n=e._idMap||(e._idMap={});if(t){const t=e.storage.values;for(let e,i=0,r=0;i<t.length;i++)e=t[i],n[e.id]={index:i,visibleIndex:r,record:e},e.isSpecialRow||r++}return n}changeModelClass(e){const{fields:t}=this;this.originalModelClass=e;let n=e;return null!=t&&t.length?n=class extends e{static get fields(){return t}}:this.preventSubClassingModel||(n=class extends e{}),n.initClass(),n}set storeId(e){this.id=e}get storeId(){return this.id}changeId(e,t){return super.changeId(!0!==e&&e,t)}updateId(e,t){const n=Es.getById(e);n&&Es.unregisterInstance(n),super.updateId(e,t)}generateAutoId(){return Es.generateId("store-")}get tree(){return this._tree}set tree(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode(),this.rootNode.isAutoRoot=!0)}buildRootNode(){return{}}static getStore(e,t){if(e instanceof Es)return e;if(this.getById(e))return this.getById(e);if(Array.isArray(e)){let n;const i=e.map((e=>(e instanceof xr?n=e.constructor:"string"==typeof e&&(e={text:e}),e)));e={autoCreated:!0,data:i,modelClass:n||class extends xr{},allowNoId:!0},t||(t=Es)}return t?new t(e):void 0}static get stores(){return Es.registeredInstances}get rootNode(){return this.masterStore?this.masterStore.rootNode:this._rootNode}set rootNode(e){var t;const n=this,i=n._rootNode;e!==i&&(i&&n.clear(!0),e instanceof xr?(e.instanceMeta(n).collapsed=!1,n._rootNode=e):n._rootNode=e=new n.modelClass(Object.assign({expanded:!0,[n.modelClass.idField]:`${n.id}-rootNode`},e),n,null,!0),n._tree=!0,e.isRoot=!0,e.joinStore(n),(null!==(t=e.children)&&void 0!==t&&t.length||n.rootVisible)&&(e.isLoading=!0,n.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),n.trigger("rootChange",{oldRoot:i,rootNode:e}))}set data(e){this.setStoreData(e)}setStoreData(e){var t,n;const i=this,{idField:r,childrenField:s}=i.modelClass;if(i.transformFlatData&&(null===(t=e)||void 0===t?void 0:t.length)>0&&!Object.isExtensible(e[0])&&(i.useRawData=i.useRawData||{disableDuplicateIdCheck:!1,disableDefaultValue:!1,disableTypeConversion:!1},e=Nt.clone(e)),i.getConfig("plugins"),i.processConfiguredListeners(),e&&!Array.isArray(e)&&(e=Nt.transformNamedObjectToArray(e,r)),i.tree=!i.isChained&&(i.tree||Boolean(i.autoTree&&(null===(n=e)||void 0===n?void 0:n.some((e=>e[s]))))),e&&(i.remoteSort||i.remoteFilter))for(let t=0;t<e.length;t++)e[t]._remoteSortIndex=t;if(i.syncDataOnLoad&&i._data)i.syncDataset(e);else{if(i._data=e,i.tree){i.transformFlatData&&(e=i.treeifyFlatData(e));const t=i.rootNode;if(t.isLoading=!0,i._data.forEach((e=>delete e.parentId)),i.clear(!0),t.appendChild(e),i.updateDependentStores("dataset",[t]),t.isLoading=!1,0===e.length){const e={action:"dataset",data:[],records:[]};i.trigger("refresh",e),i.trigger("change",e)}else i.isFiltered&&i.filter()}else i.loadData(e);i.added.clear(),i.removed.clear(),i.modified.clear()}}loadData(e,t="dataset"){const n=this,{storage:i,allowNoId:r}=n,s=n.modelClass.fieldMap.id.dataSource,o=n.find((e=>e.isCreating));o&&i.values.splice(n.records.indexOf(o),1);let l=n.verifyNoGeneratedIds;if(n.removeHeadersAndFooters(n.storage.values),n._idMap=null,n.oldIdMap={},e){if(!(e[0]instanceof xr)){n.modelClass.exposeProperties(e[0]);const t=e.length,o=new Array(t);for(let i=0;i<t;i++){var a,c,d;const t=e[i];if(!r&&null==t[s])throw new Error(`Id required but not found on row ${i}`);l&&null!==(a=t[s])&&void 0!==a&&null!==(c=(d=a).startsWith)&&void 0!==c&&c.call(d,"_generated")&&(console.warn(`Generated id found in data: ${t[s]}. Generated ids are temporary and should be replaced with real ids by the backend`),l=!1),o[i]=n.processRecord(n.createRecord(t,!0),!0),o[i].setData("parentIndex",i)}n.clear(!0),i.replaceValues({values:o,isNewDataset:!0,silent:!0})}else n.clear(!0),i.replaceValues({values:e.slice(),isNewDataset:!0,silent:!0});o&&i.values.push(o),n._data=e,n.onDataReplaced(t,e)}else n.clear(!0),n._data=null;n.isSyncingDataOnLoad=!1}get data(){return this._data}getRange(e,t,n=!0){return(n?this.storage.allValues:this.storage.values).slice(e,t)}createRecord(e,t=!1,n=!1){return new this.modelClass(e,this,null,t,!1,n)}processRecord(e,t=!1){return e}refreshData(){this.filter(),this.sort()}onRecordIdChange({record:e,oldValue:t,value:n}){const i=this,r=i._idMap,{idRegister:s,oldIdMap:o}=i;if(i.storage._indicesInvalid=!0,o[t]=e,r&&!r[n]){const e=r[t];delete r[t],r[n]=e}i.added.changeId(t,n),i.removed.changeId(t,n),i.modified.changeId(t,n),delete s[t],s[n]=e,e.index=i.storage.indexOf(e)}onUpdateRecord(e,t){const n=this,{internalId:i}=t,{internalIdRegister:r}=n;i&&(this.storage._indicesInvalid=!0,delete r[i.oldValue],r[i.value]=e),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}get useRawData(){return this._useRawData}set useRawData(e){this._useRawData=!0===e?{enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:e?Object.assign(e,{enabled:!0}):{enabled:!1}}getCount(e=!0){return e?this.count:this.originalCount}get originalCount(){var e;return this.storage.totalCount-((null===(e=this.groupRecords)||void 0===e?void 0:e.length)||0)}get count(){return this.storage.count}get allCount(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}get records(){return this.storage.values}get first(){return this.storage.values[0]}get last(){return this.storage.values[this.storage.values.length-1]}getAt(e,t=!1){return this.storage.getAt(e,t)}register(e){const t=this;if(!t.useRawData.disableDuplicateIdCheck){const n=t.isTree&&t.idRegister[e.id];if(n&&n!==e)throw new Error(`Id collision on ${e.id}`)}t.idRegister[e.id]=e,t.internalIdRegister[e.internalId]=e}unregister(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}get registeredRecords(){return Object.values(this.idRegister)}getById(e){if(null!=e&&e.isModel){const t=e;return t.hasLinks&&!this.storage.allValues.includes(t)?t.$links.find((e=>this.storage.allValues.includes(e))):t}return this.idRegister[e]}isAvailable(e){const t=this.getById(e);return t&&this.storage.includes(t)||!1}getByInternalId(e){return this.internalIdRegister[e]}includes(e){return this.isTree?null!=this.idRegister[xr.asId(e)]:this.indexOf(e)>-1}indexOf(e,t=!1,n=!1){if(null!=e&&e.isModel&&!e.stores.includes(this.$store||this)){const n=e.$links.find((e=>this.storage.allValues.includes(e)));return n?this.indexOf(n,t):-1}if(this.isTree)return(n?this.rootNode.allChildren:this.storage.values).indexOf(this.getById(e));const i=xr.asId(e);if(null==i)return-1;const r=this.idMap[i];return r?r[t?"visibleIndex":"index"]:-1}allIndexOf(e){if(this.isTree){const t=this.getById(e);let n=-1;return t&&t.bubble((e=>{e.parent?n+=e.parentIndex+1:e===this.rootNode&&this.rootVisible&&(n+=1)})),n}return this.storage.indexOf(e,!0)}getDistinctValues(e,t=!1){const n=[],i={};let r;return this.forEach((t=>{if(!t.isSpecialRow&&!t.isRoot){r=t.get(e);const s=r instanceof Date?r.getTime():r;i[s]||(n.push(r),i[s]=1)}}),this,t),n}getValueCount(e,t){let n=0;return this.forEach((i=>{Nt.isEqual(i.get(e),t)&&n++})),n}set json(e){"string"==typeof e&&(e=S.safeJsonParse(e)),this.data=e}get json(){return S.safeJsonStringify(this)}get formattedJSON(){return S.safeJsonStringify(this,null,4)}toJSON(){return(this.isTree?this.rootNode.unfilteredChildren||this.rootNode.children||[]:this.allRecords).map((e=>e.toJSON()))}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.project}getInlineData(e){const t=[];var n;this.tree?null===(n=this.rootNode.children)||void 0===n||n.forEach((n=>t.push(n.getCurrentConfig(e)))):this.forEach((n=>t.push(n.getCurrentConfig(e))));return t}getCurrentConfig(e){const t=super.getCurrentConfig(e),{state:n}=this;var i;t&&(t.data&&(t.data=this.getInlineData(e)),delete t.project,delete t.stm,delete t.asyncEvents,(null===(i=t.modelClass)||void 0===i?void 0:i.$meta.hierarchy[t.modelClass.$meta.hierarchy.length-2])===this.constructor.defaultConfig.modelClass&&delete t.modelClass,this.tree||delete t.tree,n&&Object.assign(t,n));return t}forEach(e,n=this,i){const r=this,s=(t,i)=>{if(!t.isRoot&&!t.isSpecialRow)return e.call(n,t,i)};if(i=ws(0,i),r.isTree)r.isChained&&(i=t(t({},i),{},{sorterFn:r.sorterFn})),r.rootNode.traverseWhile(s,!1,i);else{const e=i.includeFilteredOutRecords?r.storage.allValues:r.storage.values;if(r.isGrouped&&i.includeCollapsedGroupRecords)for(let t=0;t<e.length;t++){const n=e[t];if(n.groupChildren&&!0===n.meta.collapsed)for(let e=0;e<n.groupChildren.length;e++){if(!1===s(n.groupChildren[e],e))return}else if(!1===s(n,t))return}else for(let t=0;t<e.length;t++)if(!1===s(e[t],t))return}}map(e,t=this){return this.storage.values.map(e,t)}every(e,t=this,n){return this.storage[n?"allValues":"values"].every(e,t)}reduce(e,t=[],n=this){return n!==this&&(e=e.bind(n)),this.storage.values.reduce(e,t,n)}[Symbol.iterator](){return this.storage.values[Symbol.iterator]()}traverse(e,t=this.rootNode,n=t===this.rootNode,i){const r=this;if(i=ws(0,i),r.isTree){if("boolean"==typeof t&&(n=t,t=r.rootNode),r.isChained){const t=e;e=e=>{r.chainedFilterFn(e)&&t(e)}}t.traverse(e,n,i)}else r.forEach((t=>t.traverse(e,!1,i)),r,i)}traverseWhile(e,t=this.rootNode,n=t===this.rootNode,i){const r=this;if(i=ws(0,i),r.isTree){if("boolean"==typeof t&&(n=t,t=r.rootNode),r.isChained){const t=e;e=e=>{r.chainedFilterFn(e)&&t(e)}}t.traverseWhile(e,n,i)}else for(const t of r.storage)if(!1===t.traverse(e,!1,i))break}getNext(e,t=!1,n=!1){const i=this,r=i.storage.values;let s=i.indexOf(e);if(s>=r.length-1){if(!t)return null;s=-1}const o=r[s+1];return n&&o&&o.isSpecialRow?i.getNext(r[s+1],t,!0):o}getPrev(e,t=!1,n=!1){const i=this,r=i.storage.values;let s=i.indexOf(e);if(0===s){if(!t)return null;s=r.length}const o=r[s-1];return n&&o&&o.isSpecialRow&&s>0?i.getPrev(r[s-1],t,!0):o}getAdjacent(e,t=!0,n=!1,i=!1){return t?this.getNext(e,n,i):this.getPrev(e,n,i)}getNextLeaf(e,t=!1){const n=this.leaves,i=this.getById(e);let r=n.indexOf(i);if(r>=n.length-1){if(!t)return null;r=-1}return n[r+1]}getPrevLeaf(e,t=!1){const n=this.leaves,i=this.getById(e);let r=n.indexOf(i);if(0===r){if(!t)return null;r=n.length}return n[r-1]}getAdjacentLeaf(e,t=!0,n=!1){return t?this.getNextLeaf(e,n):this.getPrevLeaf(e,n)}}Es.initClass(),Es._$name="Store";const Ss=(e,t)=>(Array.isArray(t[1])?t[1].forEach((n=>e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(n)))):e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(t[1])),e),Ts=Promise.resolve(),xs=e=>String(e).padStart(2,"0");class Ds extends Es{static get defaultConfig(){return{headers:null,fetchOptions:null,sendAsFormData:null,writeAllFields:null,parentIdParamName:"id",responseSuccessProperty:"success",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,restfulFilter:!1,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",pageSize:50,useRestfulMethods:null,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}static get configurable(){return{params:null}}afterConstruct(e){super.afterConstruct(e),this.autoLoad&&this.load().catch((()=>{}))}get isLoading(){return this._isLoading?2:!!this.loadTriggerPromise&&1}get isCommitting(){return Boolean(this.commitPromise)}set pageParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=e}get pageParamName(){return this._pageParamName}set pageStartParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=e}get pageStartParamName(){return this._pageStartParamName}get isPaged(){return this.pageParamName||this.pageStartParamName}get allCount(){return"remoteTotal"in this?this.remoteTotal:super.allCount}get lastPage(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}buildQueryString(e,...t){const n=e.includes("?"),i=Object.entries(Object.assign({},...t)).reduce(Ss,[]).join("&");return i?(n?"&":"?")+i:""}async performSort(e){const t=this;if(t.remoteSort&&!t.isRemoteDataLoading){t.isRemoteDataLoading=!0;const n=await t.internalLoad({},"",(n=>{t.data=n.data,t.afterPerformSort(e)}));return t.isRemoteDataLoading=!1,n}super.performSort(e)}async performFilter(e){const t=this;if(t.remoteFilter){var n;null===(n=t.loadingPromise)||void 0===n||n.abort(),t.isRemoteDataLoading=!0;const i=t.count,{filters:r}=t;t.currentPage=1;const s=await t.internalLoad({},"",(n=>{t.data=n.data,n=e?null:{action:"filter",filters:r,oldCount:i,records:t.storage.values},t.afterPerformFilter(n),t.trigger("refresh",n)}));return t.isRemoteDataLoading=!1,s}super.performFilter(e)}encodeFilterParams(e){const t=[];for(const{property:n,operator:i,value:r,caseSensitive:s}of e)t.push({field:n,operator:i,value:r,caseSensitive:s});return JSON.stringify(t,(function(e,t){return""===e?t:this[e]instanceof Date?`${(n=this[e]).getFullYear()}-${xs(n.getMonth()+1)}-${xs(n.getDate())}T${xs(n.getHours())}:${xs(n.getMinutes())}:${xs(n.getSeconds())}.${n.getMilliseconds()}`:t;var n}))}encodeSorterParams(e){return JSON.stringify(e.filter((e=>!e.sortFn)).map((e=>e)))}buildReadUrl(){const{readUrl:e}=this;if(this.restfulFilter&&this.filters.count){return(e.endsWith("/")?e:e+"/")+this.filters.first.value}return e}internalLoad(e,t,n,i=0){e=Nt.assign({},this.params,e);const r=this,s=r.buildReadUrl(),o={action:"read"+t,params:e,url:s};if(!s)throw new Error("No load url specified");if(!1===r.trigger("beforeLoad"+t,o))throw!1;return r.loadArgs=[s,o,e,t,n],!1===i?new Promise(((e,t)=>r.sendLoadRequest(e,t))):r.loadTriggerPromise||(r.loadTriggerPromise=new Promise(((e,t)=>{r.setTimeout({delay:i,fn:"sendLoadRequest",args:[e,t],cancelOutstanding:!0})})))}async sendLoadRequest(e,t){const n=this,[i,r,s,o,l]=n.loadArgs;if(n.loadTriggerPromise=null,i){if(n._isLoading=!0,n.trigger(`load${o}Start`,r),n.trigger("beforeRequest",r),n.filterParamName&&n.isFiltered&&(s[n.filterParamName]=n.encodeFilterParams(n.filters.values)),n.remoteSort&&n.isSorted&&(s[n.sortParamName]=n.encodeSorterParams(n.groupers?n.groupers.concat(n.sorters):n.sorters)),n.isPaged){if(!(n.pageParamName in s)&&!(n.pageStartParamName in s)){const e=Math.min(n.currentPage||1,n.allCount?n.lastPage:1/0);n.pageParamName?s[n.pageParamName]=e:s[n.pageStartParamName]=(e-1)*n.pageSize}s[n.pageSizeParamName]=n.pageSize}const i={headers:n.headers,parseJson:!0};n.useRestfulMethods&&(i.method=n.httpMethods.read,r.body&&(i.body=JSON.stringify(r.body)));try{const a=n.loadingPromise=_e.get(r.url+n.buildQueryString(r.url,s),Nt.assign(i,n.fetchOptions)),c=await a,d=c.parsedJson,u=Array.isArray(d),h=u||d&&!1!==Nt.getPath(d,n.responseSuccessProperty),g=u?null:Nt.getPath(d,n.responseTotalProperty);if(n.isDestroyed)return;if(n.loadingPromise=null,n._isLoading=!1,r.response=c,r.json=d,h){if(null!=g&&(n.remoteTotal=parseInt(g,10)),n.isPaged){if(!(n.remoteTotal>=0))throw new Error("A paged store must receive its responseTotalProperty in each data packet");{const e=n.pageParamName?s[n.pageParamName]:s[n.pageStartParamName]/n.pageSize+1;n.currentPage=Math.min(e,n.lastPage)}}r.data=u?d:Nt.getPath(d,n.responseDataProperty),await l(r),!n.isDestroyed&&n.trigger("load"+o,r),e(r)}else Object.assign(r,{exception:!0,exceptionType:"server",error:null==d?void 0:d.error}),!n.isDestroyed&&n.trigger("exception",r),t(r);!n.isDestroyed&&n.trigger("afterRequest",r)}catch(e){n._isLoading=!1,r.exception=!0,e instanceof Response?(r.exceptionType=e.ok?"server":"network",r.response=e,r.error=e.error):(r.exceptionType="server",r.error=e),!n.isDestroyed&&n.trigger("exception",r),t(r),!n.isDestroyed&&n.trigger("afterRequest",r)}}}async load(e){const t=this;return t.isPaged?t.loadPage(t.currentPage||1,e):t.internalLoad(e,"",(e=>{t.data=e.data}))}async loadChildren(e){return this.readUrl?this.internalLoad({[this.parentIdParamName]:e.id},"Children",(t=>{t.parentRecord=e,e.children.length&&e.clearChildren(!0),e.data[e.constructor.childrenField]=t.data,e.processChildren(e.stores)}),!1):this.immediatePromise}async loadPage(e,t){this.allCount&&(e=Math.min(e,this.lastPage));const n=this,i=n.pageParamName?{[n.pageParamName]:e}:{[n.pageStartParamName]:(e-1)*n.pageSize};return i[n.pageSizeParamName]=n.pageSize,n.internalLoad(Nt.assign(i,t),"Page",(e=>{n.loadData(e.data,"pageLoad")}))}async nextPage(e){const t=this;return t.isPaged&&t.currentPage!==t.lastPage?t.loadPage(t.currentPage+1,e):Ts}async previousPage(e){return this.isPaged&&1!==this.currentPage?this.loadPage(this.currentPage-1,e):Ts}async commit(){const e=this,{changes:t}=e,n=[];if(e.commitPromise)return!1;if(!t)return e.modified.count&&(e.modified.forEach((e=>e.clearChanges(!0,!1))),e.modified.clear()),Ts;if(!1!==e.trigger("beforeCommit",{changes:t})){[...t.added,...t.modified,...t.removed].forEach((e=>e.meta.committing=!0)),e.trigger("commitStart",{changes:t});const i={action:"commit",exception:!1,changes:t};let r=e.commitRemoved(i);return r&&n.push(r),r=e.commitAdded(i),r&&n.push(r),r=e.commitModified(i),r&&n.push(r),n.length?(r=1===n.length?n[0]:Promise.all(n),e.commitPromise=new Promise(((n,s)=>{r.then((()=>{e.commitPromise=null,i.exception?(e.trigger("exception",i),s(i)):(e.trigger("commit",{changes:t}),n(i))})).catch((()=>{e.commitPromise=null,s(i)}))}))):(e.modified.forEach((e=>e.clearChanges(!0,!1))),e.modified.clear(),e.added.forEach((e=>e.clearChanges(!0,!1))),e.added.clear(),e.removed.clear(),e.trigger("commit",{changes:t}),Ts)}}doAutoCommit(){this.suspendCount<=0&&this.commit().catch((e=>{const{response:t}=e;if(!t||!(t.ok&&t.parsedJson||[500,404].includes(t.status)))throw e}))}commitAdded(e){const t=this,n=t.added,i={action:"create",params:t.params};return n.count&&t.createUrl?new Promise((r=>{const s=n.values.map((e=>e.persistableData));e.create=i,i.body={data:s},t.trigger("beforeRequest",i);let o=i.body;if(t.sendAsFormData){const e=new FormData;e.append("data",JSON.stringify(s)),o=e}const l={headers:t.headers,parseJson:!0},a=t.createUrl+t.buildQueryString(t.createUrl,t.params);t.useRestfulMethods&&(l.method=t.httpMethods.create),_e.post(a,o,Nt.assign(l,t.fetchOptions)).then((s=>{const o=s.parsedJson,l=Array.isArray(o),a=l||o&&!1!==o.success;e.response=s,i.json=o,i.response=s,a?(t.processReturnedData(n.values,l?o:Nt.getPath(o,t.responseDataProperty)),n.clear(),t.trigger("commitAdded"),t.trigger("refresh",i),r(e)):(n.forEach((e=>e.meta.committing=!1)),e.exception=i.exception=!0,e.exceptionType=i.exceptionType="server",t.trigger("exception",i),r(e)),t.trigger("afterRequest",i)})).catch((s=>{n.forEach((e=>e.meta.committing=!1)),e.exception=i.exception=!0,s instanceof Response?(e.response=s,i.exceptionType=s.ok?"server":"network",i.response=s,i.error=s.error):(i.exceptionType="server",i.error=s),t.trigger("exception",i),r(e),t.trigger("afterRequest",i)}))})):null}commitModified(e){const t=this,{modified:n}=t.changes,i={action:"update",params:t.params},r=n.length&&t.updateUrl?new Promise((r=>{const s=n.map((e=>t.writeAllFields?e.persistableData:e.modificationDataToWrite)).filter((e=>!Nt.isEmpty(e)));if(0===s.length)return t.modified.clear(),n.forEach((e=>e.meta.committing=!1)),void r();e.update=i,i.body={data:s},t.trigger("beforeRequest",i);let o=i.body;if(t.sendAsFormData){const e=new FormData;e.append("data",JSON.stringify(s)),o=e}const l={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(l.method=t.httpMethods.update),_e.post(t.updateUrl+t.buildQueryString(t.updateUrl,t.params),o,Nt.assign(l,t.fetchOptions)).then((s=>{const o=s.parsedJson,l=Array.isArray(o),a=l||o&&!1!==o.success;e.response=s,i.json=o,i.response=s,a?(t.processReturnedData(n,l?o:Nt.getPath(o,t.responseDataProperty),!0),t.modified.clear(),t.trigger("commitModified"),t.trigger("refresh",i),r(e)):(n.forEach((e=>e.meta.committing=!1)),e.exception=i.exception=!0,i.exceptionType="server",t.trigger("exception",i),r(e)),t.trigger("afterRequest",i)})).catch((s=>{n.forEach((e=>e.meta.committing=!1)),e.exception=i.exception=!0,s instanceof Response?(e.response=s,i.exceptionType=s.ok?"server":"network",i.response=s,i.error=s.error):(i.exceptionType="server",i.error=s),t.trigger("exception",i),r(e),t.trigger("afterRequest",i)}))})):null;return!n.length&&t.modified.count&&t.modified.clear(),r}processReturnedData(e,t,n=!1){const i=this,r=i.modelClass,s=r.fieldMap.id.dataSource;t.forEach(((t,o)=>{const l=e[o];l.clearChanges(!0,!1),l.syncId(t[s]),Object.assign(e[o].data,r.processData(t,n,i,l))}))}commitRemoved(e){const t=this,n=t.removed,i={action:"delete",params:t.params};return n.count&&t.deleteUrl?new Promise((r=>{e.delete=i,i.body={ids:n.map((e=>e.id))},t.trigger("beforeRequest",i);let s=i.body;if(t.sendAsFormData){const e=new FormData;e.append("id",JSON.stringify(s.ids)),s=e}const o={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(o.method=t.httpMethods.delete),_e.post(t.deleteUrl+t.buildQueryString(t.deleteUrl,t.params),s,Nt.assign(o,t.fetchOptions)).then((s=>{const o=s.parsedJson,l=Array.isArray(o)||o&&!1!==o.success;e.response=s,i.json=o,i.response=s,l?(n.forEach((e=>e.meta.committing=!1)),n.clear(),t.trigger("commitRemoved"),t.trigger("refresh",i),r(e)):(n.forEach((e=>e.meta.committing=!1)),e.exception=i.exception=!0,i.exceptionType="server",t.trigger("exception",i),r(e)),t.trigger("afterRequest",i)})).catch((s=>{n.forEach((e=>e.meta.committing=!1)),e.exception=i.exception=!0,s instanceof Response?(e.response=s,i.exceptionType=s.ok?"server":"network",i.response=s,i.error=s.error):(i.exceptionType="server",i.error=s),t.trigger("exception",i),r(e),t.trigger("afterRequest",i)}))})):null}get remoteFilter(){return Boolean(this.filterParamName||this.restfulFilter)}get remoteSort(){return Boolean(this.sortParamName)}}n(Ds,"$name","AjaxStore"),Ds._$name="AjaxStore";class Os{static get(e,t){const n=e._domData||(e._domData={});return null!=t?n[t]:n}static remove(e,t){const{_domData:n}=e,i=null==n?void 0:n[t];return null==n||delete n[t],i}static set(e,t,n){3===arguments.length?(e._domData||(e._domData={}))[t]=n:e._domData=t}static assign(e,t){Object.assign(e._domData||(e._domData={}),t)}}Os._$name="DomDataStore";const Ms=Array.prototype.slice,Is=Object.freeze([]),Fs=Object.freeze({}),ks=/[&<]/,{getPrototypeOf:Ls}=Object,{toString:As}=Object.prototype,{isEqual:$s,isObject:Rs}=Nt,Ps={parent:1,elementData:1,ns:1,syncOptions:1},_s=()=>({ignore:Ps,refsFound:new Set}),Ns={class:1,className:1,classname:1},js={bigint:1,boolean:1,function:1,number:1,string:1,symbol:1},Vs={tag:1,html:1,text:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,listeners:1,isReleased:1,null:1,"":1,keepChildren:1};class zs{static checkEquality(e,t,n,i){if(e===t)return!0;if(null==e)return null==t;if(!e||!t)return!1;const r=typeof e;if(r!==typeof t||js[r])return!1;let s,o,l,a,c,d,u,h=n.equalityCache||(n.equalityCache=new Map),g=Boolean(i);if(h=h.get(e)||h.set(e,new Map).get(e),s=h.get(t),void 0===s){if(s=!0,Ls(e)!==Ls(t)||e instanceof Node)s=!1;else if(Array.isArray(e)){if(o=e.length,o!==t.length)s=!1;else for(;o-- >0;)if(!zs.checkEquality(e[o],t[o],n,g)){s=!1;break}}else{var m;for(c in d=e.syncOptions,a=null===(m=d)||void 0===m?void 0:m.ignoreRefs,a&&(g=!0,i="children"!==a),l=n.ignore||Fs,t)if(!(l[c]||c in e||i&&"reference"===c)){s=!1;break}if(s)if("[object Date]"===As.call(t))s=e.getTime()===t.getTime();else for(c in e)if(!(l[c]||i&&"reference"===c)){if(!(c in t)){s=!1;break}if(u=e[c],!zs.checkEquality(u,t[c],n,g)){s=!1;break}}}var p;if(!i&&Rs(e)&&e.reference)null===(p=n.refsFound)||void 0===p||p.add(e.reference);h.set(t,s)}return s}static sync(e){const n=e,{refOwner:i}=e,r=null==i?void 0:i.byRef,s=_s();let o,l,a,c,d=e.affected;if("string"==typeof d&&(d=[d]),e=t(t({},e),{},{checkEqualityOptions:s}),i){if(i.byRef={},d)for(l in r)d.includes(l)||(i.byRef[l]=r[l]);e.refsWas=r}if(n.changed=zs.performSync(e,e.targetElement),i)for(d||(d=Object.keys(r)),o=0;o<d.length;++o)l=d[o],a=r[l],s.refsFound.has(l)||a.retainElement?i.byRef[l]=a:(c=a.lastDomConfig,a.remove(),i.detachRef(l,a,c));return e.targetElement}static performSync(e,n){const{domConfig:i,callback:r}=e,{lastDomConfig:s}=n;return(e.configEquality||zs.checkEquality)(i,s,e.checkEqualityOptions,e.ignoreRefs)?(null==r||r({action:"none",domConfig:i,targetElement:n}),!1):(i?(i.onlyChildren||(zs.syncAttributes(i,n,e),zs.syncContent(i,n)),i.keepChildren||zs.syncChildren(e,n)):(n.innerHTML=null,n.syncIdMap=null),n.lastDomConfig=null!=i&&i.onlyChildren&&s?t(t({},s),{},{children:i.children}):i,!0)}static syncDataset(e,t){const{lastDomConfig:n}=t,i=e===n,r=Object.keys(e.dataset),s=n&&n.dataset&&Object.keys(n.dataset),o=he.delta(r,s);let l,a,c,d;for(a=0;a<o.onlyInA.length;a++)l=o.onlyInA[a],d=e.dataset[l],null!=d&&t.setAttribute(`data-${S.hyphenate(l)}`,d);for(a=0;a<o.inBoth.length;a++)l=o.inBoth[a],d=e.dataset[l],(i||d!=n.dataset[l])&&(c=`data-${S.hyphenate(l)}`,null==d?t.removeAttribute(c):t.setAttribute(c,d));for(a=0;a<o.onlyInB.length;a++)t.removeAttribute(`data-${S.hyphenate(o.onlyInB[a])}`)}static addCls(e,t){const{lastDomConfig:n}=t;(e=gn.normalize(e,"array")).forEach((e=>{t.classList.add(e),((e,t)=>{const n="className"in t?"className":"class",i=t[n];if(i)if("string"==typeof i){const r=i.split(" ");r.includes(e)||(r.push(e),t[n]=r.join(" "))}else Array.isArray(i)?i.includes(e)||i.push(e):i.isDomClassList?i.add(e):Nt.isObject(i)&&(i[e]=1)})(e,n)}))}static removeCls(e,t){const{lastDomConfig:n}=t;(e=gn.normalize(e,"array")).forEach((e=>{t.classList.remove(e),((e,t)=>{const n="className"in t?"className":"class",i=t[n];if(i)if("string"==typeof i){const r=i.split(" ");r.includes(e)&&(r.splice(r.indexOf(e),1),t[n]=r.join(" "))}else Array.isArray(i)?i.includes(e)&&i.splice(i.indexOf(e),1):i.isDomClassList?i.remove(e):Nt.isObject(i)&&delete i[e]})(e,n)}))}static syncClassList(e,t,n){let i,r,s,o,l,a,c=e.className||e.class,d=!1;if(n){for(r=gn.normalize(t,"array"),c=gn.normalize(c,"object"),a=gn.normalize(n.className||n.class,"object"),l=[],s=0,o=r.length;s<o;++s)i=r[s],c[i]||!(i in a)?(a[i]=1,l.push(i)):d=!0;for(i in c)a[i]||(l.push(i),d=!0);if(!d)return;c=l.join(" ")}else c=gn.normalize(c);t.setAttribute("class",c)}static getSyncAttributes(e){const t={},n=[];return e&&Object.keys(e).forEach((i=>{if(!Vs[i]){const r=i.toLowerCase();t[r]=e[i],n.push(r)}})),{attributes:t,names:n}}static syncAttributes(e,t,n){const{lastDomConfig:i}=t,r=e===i,s=zs.getSyncAttributes(e),{attributes:o,names:l}=s,{attributes:a,names:c}=r?s:zs.getSyncAttributes(i),{onlyInA:d,onlyInB:u,inBoth:h}=r?{onlyInA:Is,onlyInB:Is,inBoth:l}:he.delta(l,c);let g,m;for(m=0;m<d.length;m++){g=d[m];const n=o[g];"style"===g&&null!=n?gi.applyStyle(t,n,!0):"dataset"===g?zs.syncDataset(e,t):Ns[g]?zs.syncClassList(e,t):null!=n&&t.setAttribute(g,n)}for(m=0;m<u.length;m++)t.removeAttribute(u[m]);for(m=0;m<h.length;m++){g=h[m];const i=o[g],s=a[g];null==i?t.removeAttribute(g):"style"===g?n.strict?r?zs.syncStyles(t,i):$s(i,s,!0)||zs.syncStyles(t,i,s):!r&&$s(i,s,!0)||gi.applyStyle(t,i,!0):"dataset"===g?zs.syncDataset(e,t):Ns[g]?zs.syncClassList(e,t,n.strict&&t.lastDomConfig):(r||i!==s)&&t.setAttribute(g,i)}}static syncStyles(e,t,n){let i,r,s;if(n){if(i={},t=gi.parseStyle(t),n=gi.parseStyle(n),t)for(r in t)s=t[r],n[r]!==s&&(i[r]=s);for(r in n)r in t||(i[r]="")}else i=t;gi.applyStyle(e,i)}static syncContent(e,t){const{html:n,text:i}=e,r=null!=i?i:n;if(t.didSetTextContent=!1,e.elementData&&(t.elementData=e.elementData),r instanceof DocumentFragment)1===t.childNodes.length&&0===gi.getChildElementCount(t)&&1===r.childNodes.length&&0===gi.getChildElementCount(r)?gi.setInnerText(t,r.firstChild.data):(t.innerHTML="",t.appendChild(r));else if(null!=n&&ks.test(n))t.innerHTML=String(n);else if(null!=r){var s;const{lastDomConfig:e}=t;null!=e&&null!==(s=e.children)&&void 0!==s&&s.length||null!=e&&e.html&&ks.test(t.lastDomConfig.html)?t.innerHTML=r:(gi.setInnerText(t,String(r)),t.didSetTextContent=!0)}}static insertTextNode(e,t,n,i,r=null){const s=document.createTextNode(e);t.insertBefore(s,r),i&&(s.$refOwnerId=i.id),null==n||n({action:"newNode",domConfig:e,targetElement:s})}static insertElement(e,t,n,i,r,s,o){var l;const a=o.ns?document.createElementNS(o.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(a,n),zs.performSync(o,a),null!=s&&(r[s]=a),e.role||e.tabIndex||e["aria-hidden"]||gi.isFocusable(a,!0)||a.htmlFor||a.setAttribute("role","presentation"),i&&(a.$refOwnerId=i.id,s&&(a.$reference=s,i.attachRef(s,a,e))),null===(l=o.callback)||void 0===l||l.call(o,{action:"newElement",domConfig:e,targetElement:a,syncId:s})}static syncChildren(e,t){var n,i;let r,s,o,{domConfig:l,syncIdField:a,callback:c,releaseThreshold:d,configEquality:u,ns:h,refOwner:g,refsWas:m,strict:p,checkEqualityOptions:f,ignoreRefs:v}=e,y=l.syncOptions||{},b=null;if(null!==(n=l.html)&&void 0!==n?n:l.text)return;v=Boolean(null!==(i=y.ignoreRefs)&&void 0!==i?i:v),v&&(g=m=null),"strict"in y&&(p=y.strict);const C=g?g.byRef:{},w=Ms.call(l.children||[]),E=Ms.call(t.childNodes),S=m||t.syncIdMap||{},T=t.releasedIdMap||{},x=e=>{for(;E.length&&E[0].parentNode!==t;)E.shift();return(e?E.shift():E[0])||null};a=y.syncIdField||a,p=y.strict||p,c=y.callback||c,u=y.configEquality||u,d="releaseThreshold"in y?y.releaseThreshold:d,a&&(t.syncIdMap=C);const D={checkEqualityOptions:f||_s(),ignoreRefs:v,refOwner:g,refsWas:m,strict:p,syncIdField:a,releaseThreshold:d,callback:c,configEquality:u};for(;w.length;){const e=w.shift();if(o=null,!e)continue;if(gi.isReactElement(e)){c({jsx:e,targetElement:t});continue}if(e instanceof Node){s=x(),e!==s&&t.insertBefore(e,s),r=E.indexOf(e),r>-1&&E.splice(r,1);continue}const n="string"==typeof e;if(D.domConfig=e,D.ns=e.ns||h,!n){if(g?o=e.reference:a&&e.dataset&&(o=e.dataset[a]),null!=o&&!e.unmatched){const n=S[o]||T[o];if(n){const{lastDomConfig:i}=n;if(n.retainElement);else if(zs.performSync(D,n)){var O;null===(O=c)||void 0===O||O({action:"reuseOwnElement",domConfig:e,targetElement:n,lastDomConfig:i,syncId:o})}e.retainElement&&(n.retainElement=!0),C[o]=n,he.remove(E,n),delete T[o],n.isReleased=!1,s=x(),(n.parentNode!==t||p&&n.nextSibling!==s)&&t.insertBefore(n,s)}else p?zs.insertElement(e,t,x(),g,C,o,D):(w.push(e),e.unmatched=!0);continue}e.unmatched&&delete e.unmatched}let i,l=null,d=null;for(;!d&&(i=x(!0));){if(g){if(i.$refOwnerId!==g.id)continue;if(i.$reference){if(!p)continue;l=i;break}d=i}else i.retainElement||(d=i);d||(b||(b=[])).push(i)}if(l||!d)n?zs.insertTextNode(e,t,c,g,l):zs.insertElement(e,t,l,g,C,o,D);else if(n||d.nodeType!==Node.ELEMENT_NODE||(e.tag||"div").toLowerCase()!==d.tagName.toLowerCase())n&&d.nodeType===Node.TEXT_NODE?d.data=e:(n?zs.insertTextNode(e,t,c,g,d):zs.insertElement(e,t,d,g,C,o,D),d.remove());else{var M,I;const{lastDomConfig:t}=d,n=zs.performSync(D,d);if(a&&null!=(null==t||null===(M=t.dataset)||void 0===M?void 0:M[a])){const e=t.dataset[a];delete T[e],delete S[e]}null!=o&&(C[o]=d),d.isReleased=!1,n&&(null===(I=c)||void 0===I||I({action:"reuseElement",domConfig:e,targetElement:d,lastDomConfig:t,syncId:o}))}}if(!t.didSetTextContent||1!==E.length||E[0].nodeType!==Node.TEXT_NODE){for(;s=x(!0);)g&&(s.$refOwnerId!==g.id||s.$reference)||(b||(b=[])).push(s);b&&zs.syncChildrenCleanup(t,b,C,c,g,d,a)}}static syncChildrenCleanup(e,t,n,i,r,s,o){let l,a=0;for(const c of t){const{lastDomConfig:t}=c;c.nodeType!==Element.TEXT_NODE?c.retainElement?o&&t&&(n[c.dataset[o]]=c):!r&&o&&(null==s||a<s)?(c.isReleased||(c.className="b-released",c.isReleased=!0,null!=t&&t.dataset&&(e.releasedIdMap||(e.releasedIdMap={}),e.releasedIdMap[t.dataset[o]]=c),null==i||i({action:"releaseElement",domConfig:t,lastDomConfig:t,targetElement:c}),t&&(t.isReleased=!0,t.className&&(t.className="b-released"),t.class&&(t.class="b-released"),t.style&&(t.style=null))),a++):(c.remove(),r&&(l=c.$reference,l&&r.detachRef(l,c,t)),e.releasedIdMap&&o&&null!=t&&t.dataset&&delete e.releasedIdMap[t.dataset[o]],null==i||i({action:"removeElement",domConfig:c.lastDomConfig,lastDomConfig:c.lastDomConfig,targetElement:c})):c.remove()}}static removeChild(e,t){if(e.contains(t)){const n=e.syncIdMap;if(n){const e=Object.values(n).indexOf(t);e>-1&&delete n[Object.keys(n)[e]]}e.removeChild(t)}}static addChild(e,t,n){e.appendChild(t),e.syncIdMap||(e.syncIdMap={}),e.syncIdMap[n]=t}static getChild(e,t){const n=String(t).split(".");for(const t of n){var i,r;if(!(e=null===(i=e)||void 0===i||null===(r=i.syncIdMap)||void 0===r?void 0:r[t]))return null}return e}}zs._$name="DomSync";class Bs{static init(){const e=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],t=t=>e.map((e=>{let n=t+S.capitalize(e);return"moz"===t&&(n=n.replace("screen","Screen"),"mozCancelFullScreen"in document&&"exitFullscreen"===e&&(n="mozCancelFullScreen")),n}));this.functions="fullscreenEnabled"in document&&e||"webkitFullscreenEnabled"in document&&t("webkit")||"mozFullScreenEnabled"in document&&t("moz")||"msFullscreenEnabled"in document&&t("ms")||[];const n=["fullscreenchange","fullscreenerror"],i=e=>n.map((t=>e+S.capitalize(t)));this.events="fullscreenEnabled"in document&&n||"webkitFullscreenEnabled"in document&&i("webkit")||"mozFullscreenEnabled"in document&&i("moz")||"msFullscreenEnabled"in document&&["MSFullscreenChange","MSFullscreenError"]||[]}static get enabled(){return Boolean(this.functions[0]&&document[this.functions[0]])}static async request(e){return this.functions[1]&&(null==e?void 0:e[this.functions[1]]())}static async exit(){return this.functions[2]&&document[this.functions[2]]()}static get isFullscreen(){return!!this.element}static get element(){return this.functions[3]&&document[this.functions[3]]}static onFullscreenChange(e){this.events[0]&&document.addEventListener(this.events[0],e)}static unFullscreenChange(e){this.events[0]&&document.removeEventListener(this.events[0],e)}}Bs.init(),Bs._$name="Fullscreen";let Ws=null;const Hs=[],Us=e=>{var t;return e.nodeType===e.ELEMENT_NODE&&"absolute"===(null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).getPropertyValue("position"))};class qs{static addResizeListener(e,t){const n=this;if(e!==document&&e!==globalThis||(e=document.body),e.nodeType===e.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)n.hasWindowResizeListener||(globalThis.addEventListener("resize",n.onWindowResize),n.hasWindowResizeListener=!0);else if(globalThis.ResizeObserver)n.resizeObserver||(n.resizeObserver=new ResizeObserver(n.onElementResize)),n.resizeObserver.observe(e);else{e.classList.add("b-no-resizeobserver");const[i,r,s]=gi.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},{returnAll:!0});r.scrollLeft=r.scrollTop=s.scrollLeft=s.scrollTop=1e6,r.addEventListener("scroll",n.onSizeMonitorScroll,!0),s.addEventListener("scroll",n.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver((e=>{const t=[],n=[];for(const i of e)"childList"===i.type&&(t.push.apply(t,i.addedNodes),n.push.apply(n,i.removedNodes));const i=[...t.filter((e=>!n.includes(e))),...n.filter((e=>!t.includes(e)))];0!==i.length&&(i.length>0&&i.every(Us)||r.dispatchEvent(new CustomEvent("scroll",{bubbles:!1})))}))).observe(e,{childList:!0,subtree:!0}),t.monitorElement=i}e._bResizemonitor.handlers.push(t)}static removeResizeListener(e,t){if(e){e!==document&&e!==globalThis||(e=document.body);const n=e._bResizemonitor;let i=0;n&&n.handlers&&(he.remove(n.handlers,t),i=n.handlers.length),i||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}static onElementResize(e){for(const t of e){const e=t.target,n=e._bResizemonitor,i=t.contentRect||e.getBoundingClientRect();if(ei(e)&&(!n.rectangle||i.width!==n.rectangle.width||i.height!==n.rectangle.height)){const t=n.rectangle;n.rectangle=i;for(const r of n.handlers)r(e,t,i)}}}static onSizeMonitorScroll(e){var t;if(null!==(t=document.body)&&void 0!==t&&t.contains(e.target)){e.stopImmediatePropagation();const t=e.target.parentNode,n=t.parentNode,i=n._bResizemonitor,r=n.getBoundingClientRect();i.rectangle&&r.width===i.rectangle.width&&r.height===i.rectangle.height||(Hs.push([n,i.rectangle,r]),i.rectangle=r,Ws||(Ws=requestAnimationFrame(qs.fireResizeEvents))),t.firstChild.scrollLeft=t.firstChild.scrollTop=t.childNodes[1].scrollTop=t.childNodes[1].scrollLeft=1e6}}static onWindowResize(e){const t=document.body,n=t._bResizemonitor,i=n.rectangle;n.rectangle=document.documentElement.getBoundingClientRect();for(const e of n.handlers)e(t,i,n.rectangle)}static fireResizeEvents(){for(const e of Hs)for(const t of e[0]._bResizemonitor.handlers)e[0].offsetParent&&t.apply(this,e);Ws=null,Hs.length=0}static removeGlobalListeners(){globalThis.removeEventListener("resize",this.onWindowResize)}}qs._$name="ResizeMonitor";const Ys={auto:"auto",true:"auto",false:"hidden","hidden-scroll":"auto",clip:r.supportsOverflowClip?"clip":"hidden"},Ks={block:"nearest"},Gs=Promise.resolve(),Xs=e=>new Promise((t=>En.on({element:e===document.documentElement?window:e,scroll:t,once:!0}))),Js={x:1},Zs={auto:1,scroll:1},Qs={true:1,auto:1},eo={overflowX:"auto",overflowY:"auto"};class to extends(Pi($e(de))){static get configurable(){return{widget:null,element:{$config:{nullify:!0},value:null},contentElement:{$config:{nullify:!0},value:null},overflowX:null,overflowY:null,translate:null,x:0,y:0,rtlSource:null}}static get delayable(){return{onScrollEnd:{type:"buffer",delay:100}}}get isRTL(){var e;return Boolean(null===(e=this.rtlSource)||void 0===e?void 0:e.rtl)}syncOverflowState(){const e=this,{element:t}=e,n=new gn(t.classList),i=e.hasOverflowX=t.scrollWidth>t.clientWidth,r=e.hasOverflowY=t.scrollHeight>t.clientHeight;n.value=t.classList;(n.toggle("b-horizontal-overflow",i)||n.toggle("b-vertical-overflow",r))&&(gi.syncClassList(t,n),e.isConfiguring||e.trigger("overflowChange",{x:i,y:r}))}hasOverflow(e="y"){const t=this[`overflow${e.toUpperCase()}`],n=this["overflow"+("y"===e?"x":"y")];if(gi.scrollBarWidth&&Qs[t]&&"hidden-scroll"!==n&&!r.isFirefox)return this[`hasOverflow${e.toUpperCase()}`];{const t="y"===e?"Height":"Width";return this[`scroll${t}`]>this[`client${t}`]}}hasScrollbar(e="y"){const{element:t}=this;if(t&&gi.scrollBarWidth){const n="y"===e,i=n?"Width":"Height",r=t[`client${i}`],s=parseInt(gi.getStyleValue(t,`border${n?"Left":"Top"}Width`))+parseInt(gi.getStyleValue(t,`border${n?"Right":"Bottom"}Width`)),o=t[`offset${i}`]-s-r;return Math.abs(o-gi.scrollBarWidth)<2}}addPartner(e,t=Js){const n=this;"string"==typeof t&&(t={[t]:1}),n.partners||(n.partners={}),n.partners[e.id]={scroller:e,axes:t},t.x&&(e.x=n.x),t.y&&(e.y=n.y),e.isPartneredWith(n)||e.addPartner(n,t)}eachPartner(e){const{partners:t}=this;t&&Object.values(t).forEach(e)}removePartner(e){this.isPartneredWith(e)&&(delete this.partners[e.id],e.removePartner(this))}isPartneredWith(e){var t;return Boolean(null===(t=this.partners)||void 0===t?void 0:t[e.id])}clearPartners(){this.partners&&Object.values(this.partners).forEach((e=>e.scroller.removePartner(this)))}async scrollIntoView(e,t=Ks){const n=this,{isRectangle:i}=e,r=i?e:dn.from(e),{xDelta:s,yDelta:o}=n.getDeltaTo(e,t),l=n.scrollBy(s,o,t);return(t.highlight||t.focus)&&l.then((()=>{i&&(e=r.translate(-s,-o)),t.highlight&&(isNaN(t.highlight)?(n.widget||n).callback(t.highlight,null,[e]):gi.highlight(e,n)),t.focus&&gi.focusWithoutScrolling(e)})),l}static async scrollIntoView(e,t=Ks,n=!1){const i=dn.from(e),r="object"==typeof t?t.animate:t,s=to._globalScroller||(to._globalScroller=new to),o=[];s.rtlSource={rtl:n};let l,a=0,c=0;for(let n=e.parentNode;n.nodeType===Node.ELEMENT_NODE;n=n.parentNode){if(n===document.body&&n!==document.scrollingElement)continue;const e=n===document.scrollingElement?eo:n.ownerDocument.defaultView.getComputedStyle(n);if(!1!==t.y&&Zs[e.overflowY]&&n.scrollHeight>n.clientHeight||!1!==t.x&&Zs[e.overflowX]&&n.scrollWidth>n.clientWidth){s.element=n,s.positionDirty=!0;const{xDelta:e,yDelta:r}=s.getDeltaTo(i,t);(e||r)&&(o.push({element:n,x:n.scrollLeft,y:n.scrollTop,xDelta:e,yDelta:r}),i.translate(-e,-r),a+=e,c+=r)}}if(o.length){const e=Math.abs(a),t=Math.abs(c);let i=r&&("number"==typeof r?r:"number"==typeof r.duration?r.duration:300);if(i&&(e>10||t>10))Math.max(e,t)<50&&(i=Math.min(i,500)),l=s.scrollAnimation=be.animate(i,(e=>{const t=1===e;for(const{element:i,x:r,y:l,xDelta:a,yDelta:c}of o)s.element=i,a&&(s.x=Math[n?"min":"max"](r+(t?a:Math.round(a*e)),0)),c&&(s.y=Math.max(l+(t?c:Math.round(c*e)),0))}),null,r.easing),l.then((()=>{s.scrollAnimation=null}));else{for(const{element:e,xDelta:t,yDelta:n}of o)e.scrollTop+=n,e.scrollLeft+=t;l=Xs(o[o.length-1].element)}}else l=Gs;return(t.highlight||t.focus)&&l.then((()=>{t.highlight&&(isNaN(t.highlight)?s.callback(t.highlight,null,[e]):gi.highlight(e,s)),t.focus&&e.focus()})),l}async scrollBy(e=0,t=0,n=Ks){const i=this,r="object"==typeof n?n.animate:n,s=Math.abs(e),o=Math.abs(t);i.scrollAnimation&&(i.scrollAnimation.cancel(),i.scrollAnimation=null),(e||t)&&(i.silent=n.silent);let l=r&&("number"==typeof r?r:"number"==typeof r.duration?r.duration:300);if(l&&(s>10||o>10)){const{x:a,y:c}=i;let d=a,u=c;return Math.max(s,o)<50&&(l=Math.min(l,500)),i.scrollAnimation=be.animate(l,(r=>{const s=1===r;if(e){var o;if(i.x!==d&&!n.force)return null===(o=i.scrollAnimation)||void 0===o?void 0:o.cancel();i.x=Math.max(a+(s?e:Math.round(e*r)),0)}if(t){var l;if(i.y!==u&&!n.force)return null===(l=i.scrollAnimation)||void 0===l?void 0:l.cancel();i.y=Math.max(c+(s?t:Math.round(t*r)),0)}d=i.x,u=i.y}),i,r.easing),i.element.classList.add("b-scrolling"),i.scrollAnimation.then((()=>{i.isDestroyed||(i.element.classList.remove("b-scrolling"),i.scrollAnimation=null)})),i.scrollAnimation}if(e|t){const n=i.x,r=i.y;if(i.x+=e,i.y+=t,i.x!==n||i.y!==r)return Xs(i.element)}return Gs}async scrollTo(e,t,n){const{x:i,y:r}=this,s=null==e?0:e-i,o=null==t?0:t-r;return this.scrollBy(s,o,n)}doDestroy(){var e;const t=this;var n;t._element&&(t._element.removeEventListener("scroll",t.scrollHandler),null===(n=t.wheelListenerRemover)||void 0===n||n.call(t));null===(e=t.scrollAnimation)||void 0===e||e.cancel(),Object.values(t.partners||{}).forEach((({scroller:e})=>e.removePartner(t))),super.doDestroy()}onElMutation(e){const t=this,[n,i]=gi.getTranslateXY(t.element);if(t._x!==-n||t.y!==-i){const e=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(e,"target",{get:()=>t.element}),t.onScroll(e)}}onElResize(){const e=this,{widget:t}=e;null!=t&&t.isAnimating?-1===t.findListener("animationend","onElResize",e)&&t.ion({animationEnd:"onElResize",thisObj:e,once:!0}):e.syncOverflowState()}onScroll(e){const t=this,{_x:n,_y:i,element:r}=t;let s=0;"clip"===t.overflowX&&r.scrollLeft!==n&&(r.scrollLeft=n,++s),"clip"===t.overflowY&&r.scrollTop!==i&&(r.scrollTop=i,++s),2!==s&&(t.widget&&t.widget.isDestroyed||(t.positionDirty=!0,r.classList.contains("b-scrolling")||r.classList.add("b-scrolling"),e.widget=t.widget,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.onScrollEnd(e)))}syncPartners(e,t){const n=this;n.partners&&Object.values(n.partners).forEach((({axes:i,scroller:r})=>{(r!==n.controllingPartner||e)&&r.sync(n,i)&&t&&r.syncPartners(e,t)}))}onScrollEnd(e){const t=this;t.silent&&(t.silent=!1),t.trigger("scrollEnd",e),t.controllingPartner=null,t.element.classList.remove("b-scrolling")}getDeltaTo(e,t){const n=this;if(!n.viewport)return{xDelta:0,yDelta:0};const{x:i,y:r,scrollWidth:s,scrollHeight:o,isRTL:l}=n,a=e instanceof dn?e:dn.from(e),c=t.block||"nearest",d=n.viewport,u=(e=>{let t,n,i,r;if(e)if("number"==typeof e)t=n=i=r=e;else{var s,o,l,a;t=null!==(s=e.top)&&void 0!==s?s:0,n=null!==(o=e.bottom)&&void 0!==o?o:0,i=null!==(l=e.start)&&void 0!==l?l:0,r=null!==(a=e.end)&&void 0!==a?a:0}else t=n=i=r=0;return{top:t,bottom:n,start:i,end:r}})(t.edgeOffset),h=d.width>=a.width+(u.start+u.end)?u:{start:0,end:0},g=d.height>=a.height+(u.top+u.bottom)?u:{top:0,bottom:0},m=new dn(l?d.right- -i-s:d.x-i,d.y-r,s,o),p=a.clone().adjust(-h.start,-g.top,h.end,g.bottom).constrainTo(m),f=p.clone(),v=n.isRTL?-1:1;let y=0,b=0;if("start"===c)f.moveTo(d.x+(n.isRTL?d.width:0),d.y),y=p.x-f.x,b=p.y-f.y;else if("end"===c)n.isRTL?f.moveTo(d.left+(n.isRTL?f.width:0),d.y):f.translate(d.right-f.right,d.bottom-f.bottom),y=p.x-f.x,b=p.y-f.y;else if("center"===c){const e=d.center;f.moveTo(e.x-f.width/2,e.y-f.height/2),y=y||p.x-f.x,b=b||p.y-f.y}else f.width>d.width?y=f.x-d.x:f.right>d.right?y=f.right-d.right:f.x<d.x&&(y=f.x-d.x),f.height>d.height?b=f.y-d.y:f.bottom>d.bottom?b=f.bottom-d.bottom:f.y<d.y&&(b=f.y-d.y);return y=v*Math.round(y),b=Math.round(b),{xDelta:!1===t.x?0:Math.max(Math.min(y,n.maxX-i),-i),yDelta:!1===t.y?0:Math.max(Math.min(b,n.maxY-r),-r)}}get viewport(){return dn.client(this.element)}updateWidget(e){this.rtlSource=this.owner=e}updateElement(e,t){const n=this;if(n===to._globalScroller)return n._element=e,void(n.positionDirty=!0);const i=n.scrollHandler||(n.scrollHandler=n.onScroll.bind(n)),r=n.resizeHandler||(n.resizeHandler=n.onElResize.bind(n));if(t){var s;if(n.translate)null===(s=n.mutationObserver)||void 0===s||s.disconnect(t);else t.removeEventListener("scroll",i),t.classList.remove("b-widget-scroller"),t.style.overflowX=t.style.overflowY="";qs.removeResizeListener(t,r)}if(e){if(n.translate){if(n.mutationObserver||(n.mutationObserver=new MutationObserver(n.mutationHandler||(n.mutationHandler=n.onElMutation.bind(n)))),n._x=n._y=0,document.contains(e)){const[t,i]=gi.getTranslateXY(e);n._x=-t,n._y=-i}n.mutationObserver.observe(e,{attributes:!0})}else e.addEventListener("scroll",i),e.classList.add("b-widget-scroller");qs.addResizeListener(e,r),n.widget||(n.rtlSource={get rtl(){return"rtl"===gi.getStyleValue(e,"direction")}}),n.isRTL&&e.classList.add("b-rtl"),n.positionDirty&&(n.updateOverflowX(n.overflowX),n.updateOverflowY(n.overflowY)),n.syncOverflowState(),n.isConfiguring&&(n._x&&n.updateX(n._x),n._y&&n.updateY(n._y))}n.positionDirty=!0}get x(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[n,i]=gi.getTranslateXY(t);e._x=-n,e._y=-i}else e._x=Math.abs(t.scrollLeft),e._y=t.scrollTop;e.positionDirty=!1}return e._x}get scrollLeft(){return this.element.scrollLeft}changeX(e){if(e=Math.max(e,0),!this.isConfiguring||e)return e;this._x=e}updateContentElement(e){e&&(e="string"==typeof e?this.element.querySelector(e):e,qs.addResizeListener(e,this.resizeHandler))}updateX(e){var t;const{element:n}=this;!n||null!==(t=this.widget)&&void 0!==t&&t.isConfiguring||(e=Math.round(e),this.trigger("scrollStart",{x:e}),this.translate?gi.setTranslateX(n,-e):n.scrollLeft=this.isRTL?-e:e),this.positionDirty=!0}sync(e,t){const n=this,{x:i,y:r}=t;let s=!1;return null!=i&&n.x!==e.x&&(n.controllingPartner=e,n.x=e.x,s=!0),null!=r&&n.y!==e.y&&(n.controllingPartner=e,n.y=e.y,s=!0),s}get y(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[n,i]=gi.getTranslateXY(t);e._x=-n,e._y=-i}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y}changeY(e){if(!this.isConfiguring||e)return e;this._y=e}updateY(e){const{element:t,widget:n}=this;!t||null!=n&&n.isConfiguring||(this.trigger("scrollStart",{y:e}),this.translate?gi.setTranslateY(t,-e):t.scrollTop=e),this.positionDirty=!0}get maxX(){return this.scrollWidth-this.clientWidth}get maxY(){return this.scrollHeight-this.clientHeight}get lastScrollLeft(){return(this.scrollWidth-this.clientWidth)*(this.isRTL?-1:1)}updateOverflowX(e,t){const n=this,{element:i,translate:r}=n,{style:s,classList:o}=i;if("hidden-scroll"===t&&o.remove("b-hide-scroll"),"hidden-scroll"===e&&!r){Zs[s.overflowY]?(e="hidden",n.enableWheel()):o.add("b-hide-scroll")}r||(s.overflowX=Ys[e]||e),n.isConfiguring||(n.positionDirty=!0,n.syncOverflowState())}updateOverflowY(e,t){const n=this,{element:i,translate:r}=n,{style:s,classList:o}=i;if("hidden-scroll"===t&&o.remove("b-hide-scroll"),"hidden-scroll"===e&&!r){Zs[s.overflowX]?(e="hidden",n.enableWheel()):o.add("b-hide-scroll")}r||(s.overflowY=Ys[e]||e),n.isConfiguring||(n.positionDirty=!0,n.syncOverflowState())}enableWheel(){this.wheelListenerRemover||(this.wheelListenerRemover=En.on({element:this.element,wheel:"onWheel",thisObj:this}))}onWheel(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&"hidden-scroll"===this.overflowX?this.x+=e.deltaX:"hidden-scroll"===this.overflowY&&(this.y+=e.deltaY)}get scrollWidth(){var e,t;return null!==(e=null===(t=this.element)||void 0===t?void 0:t.scrollWidth)&&void 0!==e?e:0}set scrollWidth(e){const t=this,{element:n,isRTL:i}=t;let r=t.widthStretcher;r&&null==e?(r.remove(),t.widthStretcher=null):e&&(e=Math.abs(e),r||(r=t.widthStretcher=gi.createElement({className:"b-scroller-stretcher b-horizontal-stretcher",retainElement:!0})),r.style.transform=`translateX(${(e-1)*(i?-1:1)}px)`,n&&!n.contains(r)&&n.insertBefore(r,n.firstElementChild)),!1!==t.propagate&&t.eachPartner((({scroller:t})=>{t.propagate=!1,t.scrollWidth=e,delete t.propagate})),t.positionDirty=!0,t.syncOverflowState()}get scrollHeight(){var e,t;return null!==(e=null===(t=this.element)||void 0===t?void 0:t.scrollHeight)&&void 0!==e?e:0}set scrollHeight(e){const t=this,n=t.stretcher||(t.stretcher=gi.createElement({className:"b-scroller-stretcher"}));n.style.transform=`translateY(${e-1}px)`,t.element&&t.element.lastChild!==n&&t.element.appendChild(n),t.positionDirty=!0,t.syncOverflowState()}get clientWidth(){var e;return(null===(e=this.element)||void 0===e?void 0:e.clientWidth)||0}get clientHeight(){var e;return(null===(e=this.element)||void 0===e?void 0:e.clientHeight)||0}get id(){return this._id||(this.widget?this._id=`${this.widget.id}-scroller`:this._id=Lr.generateId("scroller-")),this._id}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(),delete e.widget,delete e.element}}to._$name="Scroller";class no{constructor(e){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),e&&e(this)}}no._$name="Promissory";const{defineProperty:io}=Reflect;class ro extends(de.mixin(Ye,$e,Pi,Ki)){static get configurable(){return{element:null}}static get delayable(){return{refreshDom:"raf"}}static get identifiable(){return{}}static get renderConfigs(){const e=this,t=e.$meta;let n,i,r=t.renderConfigs;if(void 0===r){for(i in r=null,n=t.configs,n)n[i].render&&(r||(r=new Set)).add(i);t.renderConfigs=e.prototype.$renderConfigs=r}return r}construct(...e){this.$iid=++ro.$idSeed,this.byRef={},super.construct(...e),this.onDraw!==ro.prototype.onDraw&&this.initDrawable()}startConfigure(e){this.element=this.renderContext.renderDom(),super.startConfigure(e)}get element(){return this.refreshDom.flush(),this._element}changeElement(e,t){const n=this;return t&&t.remove(),e&&(e.id=n.id,e=gi.createElement(e,{refOwner:n})),e}updateId(e,t){const n=this;if(t){const i=n.element;i.id=e,n.fixRefOwnerId(i,e,t)}}get classes(){return this.element.classList}fixRefOwnerId(e,t,n){if(e.$refOwnerId===n){e.$refOwnerId=t;const i=e.$reference;i&&(e.id=`${t}-${i}`);for(const i of e.childNodes)this.fixRefOwnerId(i,t,n)}}onConfigChange({name:e}){!this.isConfiguring&&this.$renderConfigs.has(e)&&this.refreshDom()}attachRef(e,t,n){const i=this,r="_"+e,{listeners:s}=n;r in i||io(i,e,{get:()=>(i.refreshDom.flush(),i[r]),set(e){i[r]=e}}),t.id=`${i.id}-${e}`,i.byRef[e]=t,i[e]=t,s&&(n.listeners={on:s,un:En.on(Object.assign({element:t,thisObj:i},s))})}detachRef(e,t,n){n.listeners&&(n.listeners.un(),n.listeners=null),this[e]=null,delete this.byRef[e]}renderDom(){return{}}get renderContext(){const e=this,t=e.$meta,n=e.constructor;let i=t.renderConfigs||n.renderConfigs,r=e;if(!i){r=Object.create(e),i=new Set;for(const n in t.configs)io(r,n,{get:()=>(i.add(n),e[n])});r.renderDom=()=>e.renderDom.call(r),e.$renderConfigs=i}return io(e,"renderContext",{value:r}),r}refreshDom(){zs.sync({targetElement:this.element,domConfig:this.renderContext.renderDom(),refOwner:this,strict:!0})}onListen(e){"draw"===e&&this.initDrawable()}initDrawable(){const e=this;if(!e.intersector){let t=Object.values(e.byRef).find((e=>e.classList.contains("b-drawable")));t||(t=e.element,t.classList.add("b-drawable")),e.intersector=new IntersectionObserver((t=>{e.isDestroyed||t.forEach((t=>{t.isIntersecting&&e.onDraw({count:++e.drawCounter})}))})),e.intersector.observe(t)}}onDraw(e){this.trigger("draw",e)}}ro.$idSeed=0,Object.assign(ro.prototype,{drawCounter:0,hasGeneratedId:!1,intersector:null}),ro._$name="Renderable";class so extends ro{construct(e){if(e){let t,n=e.element;n&&(A.deprecate("Core","4.0.0",'Mask "element" config has been renamed to "target"'),e=t=Object.assign({},e),delete t.element,t.target=n),n=e.target,"string"==typeof n&&(e=t=t||Object.assign({},e),t.target=e.owner[n])}super.construct(e);const t=this,{type:n}=t;t.target||(t.target=document.body),t.maskName=`mask${"string"==typeof n?n.trim():""}-${so.counter++}`,t.show()}doDestroy(){const e=this,{element:t}=e;if("trial"===e.type)return!1;t&&(e.element=null,e.mode.endsWith("blur")&&gi.forEachChild(t,(t=>{t.classList.remove(`b-masked-${e.mode}`)})),e.target.classList.remove("b-masked"),e.target[e.maskName]=null,he.remove(so.masks,e)),super.doDestroy()}get maskElement(){return this.element}set error(e){this.setConfig(this.errorDefaults),this.text=e}renderDom(){const e=this,{maxProgress:t}=e;return{class:{"b-mask":1,"b-delayed-show":e.showDelay,"b-widget":1,[`b-mask-${e.mode}`]:1,"b-progress":t,"b-prevent-transitions":!e.useTransition},children:[{reference:"maskContent",class:"b-mask-content b-drawable",children:[t?{reference:"progressElement",class:"b-mask-progress-bar",style:{width:`${Math.max(0,Math.min(100,Math.round(e.progress/t*100)))}%`}}:null,{reference:"maskText",class:"b-mask-text",html:(e.icon?`<i class="b-mask-icon ${e.icon}"></i>`:"")+e.text}]}]}}static mergeConfigs(...e){const t={};for(const n of e)"string"==typeof n?t.text=n:Nt.assign(t,n);return t}static mask(e,n=document.body){return so.new({target:n},"string"!=typeof e?t({},e):{text:e})}static unmask(e=document.body){const t=this.getElementMasks(e);return t.length>0?t[t.length-1].close():null}static unmaskAll(e=document.body){return this.getElementMasks(e).forEach((e=>e.close()))}static getElementMasks(e){return this.masks.filter((t=>t.target===e))}updateAutoClose(e){this.deferredClose.cancel(),e&&(this.deferredClose.delay=e,this.deferredClose())}updateCover(){this.syncCover()}syncCover(){var e,t;null===(e=this.owner)||void 0===e||null===(t=e.syncMaskCover)||void 0===t||t.call(e,this)}onOwnerResize(){this.syncCover()}updateOwner(e){this.detachListeners("cover"),null==e||e.ion({name:"cover",recompose:"onOwnerResize",resize:"onOwnerResize",thisObj:this})}updateShowDelay(e){const{delayedShow:t}=this;t.delay=e,e||t.flush()}deferredClose(){var e;const{owner:t}=this;this.close().then((()=>{var e;null==t||null===(e=t.onMaskAutoClose)||void 0===e||e.call(t,this)})),null==t||null===(e=t.onMaskAutoClosing)||void 0===e||e.call(t,this)}delayedShow(){this.classes.remove("b-delayed-show")}show(){const e=this,{element:t,target:n,hiding:i,maskName:r}=e;i&&(i.resolve(),e.hiding=null,e.clearTimeout("hide")),e.showDelay&&(t.classList.add("b-delayed-show"),e.delayedShow()),t.classList.add("b-visible"),t.classList.remove("b-hidden"),n.classList.add("b-masked"),n[r]||(n[r]=e,n.appendChild(t)),he.include(so.masks,e),e.shown=!0,e.trigger("show"),e.mode.endsWith("blur")&&gi.forEachChild(n,(n=>{n!==t&&n.classList.add(`b-masked-${e.mode}`)}))}hide(){const e=this,{target:t,element:n}=e;let{hiding:i}=e;if(!i){if(!e.shown)return Promise.resolve();e.hiding=i=new no,e.shown=!1,n.classList.remove("b-visible"),n.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&gi.forEachChild(t,(t=>{t!==n&&t.classList.remove(`b-masked-${e.mode}`)})),i.promise=i.promise.then((()=>{e.hiding===i&&(e.hiding=null)})),e.setTimeout((()=>i.resolve()),500,"hide")}return i.promise}async close(){await this.hide(),this.destroy()}}n(so,"$name","Mask"),n(so,"type","mask"),n(so,"configurable",{autoClose:null,cover:null,icon:"b-icon b-icon-spinner",errorDefaults:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maxProgress:null,mode:"dark",progress:null,owner:{$config:"nullify",value:null},target:null,text:null,type:null,showDelay:null,useTransition:!1}),n(so,"delayable",{deferredClose:0,delayedShow:0,syncCover:{type:"throttle",delay:100}}),n(so,"counter",0),n(so,"masks",[]),so._$name="Mask";var oo=e=>{var t;return n(t=class extends(e||de){get widgetClass(){}get keyMapElement(){return this.element}get keyMapSubComponents(){return this.features}performKeyMapAction(e){const{keyMap:t}=this;let n=!1;if(t&&!e.handled&&void 0!==e.key){const r=Nt.keys(t).find((t=>{const n=t.split("+"),i=n.includes("Alt"),r=n.includes("Shift"),s=n.includes("Ctrl");let o=n[n.length-1].toLowerCase();return"space"===o&&(o=" "),o===e.key.toLowerCase()&&(!e.altKey&&!i||e.altKey&&i)&&(!e.ctrlKey&&!s||e.ctrlKey&&s)&&(!e.shiftKey&&!r||e.shiftKey&&r)}));if(t[r]){const s=he.asArray(t[r]);let o;e.fromKeyMap=!0;for(let t of s){if(o=!0,Nt.isObject(t)){if(!t.handler)continue;!1===t.preventDefault&&(o=!1),t=t.handler}if("string"==typeof t){var i;const{thisObj:s,handler:o}=this.resolveKeyMapAction(t);if(!1!==(null===(i=s.isActionAvailable)||void 0===i?void 0:i.call(s,r,t,e))&&!1!==o.call(s,e)){n=!0;break}}else if(!1!==t.call(this)){n=!0;break}}delete e.fromKeyMap,n&&(o&&e.preventDefault(),e.handled=!0)}}return n}resolveKeyMapAction(e){const{keyMapSubComponents:t}=this;if(t&&e.includes(".")){const[n,i]=e.split(".");if(n&&i)return{thisObj:t[n],handler:t[n][i]}}return{thisObj:this,handler:this[e]}}updateKeyMap(e){var t;null===(t=this.keyMapDetacher)||void 0===t||t.call(this),Nt.isEmpty(e)||(this.keyMapDetacher=En.on({element:this.keyMapElement,keydown:"keyMapOnKeyDown",thisObj:this}))}keyMapOnKeyDown(e){this.performKeyMapAction(e)}mergeKeyMaps(e,t,n=null){const i={};e&&Nt.assign(i,e);for(const r in t){if(!t[r])continue;const s=he.asArray(null==e?void 0:e[r]),o=[];null!=s&&s.length&&o.push(...s);for(const e of he.asArray(t[r]))Nt.isObject(e)&&e.handler?o.push(Nt.assignIf({handler:(n?n+".":"")+e.handler},e)):o.push((n?n+".":"")+e);o.sort(((e,t)=>{const n=(e.weight||0)-(t.weight||0);return 0===n&&null!=s&&s.length?s.indexOf(e)-s.indexOf(t):n})),i[r]=o}return i}},"$name","KeyMap"),n(t,"configurable",{keyMap:{value:null,$config:{merge:"objects",nullify:!0}}}),t},lo=e=>{var t;return n(t=class extends(e||de){get widgetClass(){}updateRtl(e){const{element:t}=this;t&&(t.classList.toggle("b-rtl",!0===e),t.classList.toggle("b-ltr",!1===e))}startConfigure(e){var t;if(null===(t=super.startConfigure)||void 0===t||t.call(this,arguments),!e.floating&&null==e.rtl){var n;const t=this,i=e.rootElement||e.forElement||(null===(n=t.parent)||void 0===n?void 0:n.contentElement)||(t.floating?t.floatRoot:t.changeElementRef(t.getRenderContext(e)[0]||e.adopt||document.body)),r=e.owner||e.parent||t.constructor.fromElement(i);e.rtl=r?r[r.isConfiguring?"peekConfig":"getConfig"]("rtl"):1===(null==i?void 0:i.nodeType)&&"rtl"===getComputedStyle(i).getPropertyValue("direction"),e.rtl&&(t.configDone.rtl=!1)}}render(...e){var t,n;(super.render&&super.render(...e),(r.isChrome&&r.chromeVersion<87||r.isFirefox&&r.firefoxVersion<66||r.isSafari&&r.safariVersion<14.1)&&this.element.classList.add("b-legacy-inset"),"rtl"===getComputedStyle(this.element).direction||null!==(t=this.owner)&&void 0!==t&&t.rtl)&&(this.rtl=!0,null===(n=this.childItems)||void 0===n||n.forEach((e=>e.rtl=!0)))}},"$name","RTL"),n(t,"configurable",{rtl:null}),t};const ao=Object.freeze({highlight:!1,onlyName:!1}),co=[],uo=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,ho={INPUT:1,TEXTAREA:1},go=(e,t,n,i)=>{var r;let s=(null==n?void 0:n.listeners)||(null==n?void 0:n.internalListeners);if(s=(null===(r=s)||void 0===r?void 0:r.ion)||s,s){const r=En.on(Nt.assign({element:t,thisObj:e},s));i?(e._refListeners||(e._refListeners=Object.create(null)))[i]=r:n.listeners={on:s,un:r}}},mo=(e,t)=>e&&t&&t[Nt.keys(e)[0]]?U.merge(e,t):e,po=e=>{e.isVisible&&e.triggerPaint()},fo=/^:not\((.+)\)$/,vo=/absolute|fixed/i,yo=e=>null!=e.scale,{hasOwnProperty:bo}=Object.prototype,{defineProperty:Co}=Reflect,wo=e=>parseFloat(e)*(e.endsWith("ms")?1:1e3),Eo=["b-aligned-above","b-aligned-right","b-aligned-below","b-aligned-left"],So={configurable:!0,get:()=>!1},To=/(?:L\{([^}.]+)\})/,xo=(e,t)=>"L{Tooltip."+t+"}",Do=/^([trblc])(\d*)-([trblc])(\d*)$/i,Oo=(e,t)=>(Do.test(e)&&(e={align:e}),Do.test(t)&&(t={align:t}),U.merge(e,t)),Mo=/^[\w.]+$/;class Io extends(de.mixin(Ye,$e,Pi,Ki,lr,oo,lo)){static mergeCls(e,t){return t&&e?e=new gn(t).assign("string"==typeof e?new gn(e):e):e&&!e.isDomClassList&&(e=new gn(e)),e}static get $name(){return"Widget"}static get type(){return"widget"}static get configurable(){return{element:!0,callOnFunctions:!0,id:"",html:null,content:null,cls:{$config:{merge:"classList"},value:null},ui:{$config:{merge:"classList"},value:null},collapsify:null,contentElementCls:{$config:{merge:"classList"},value:null},defaultCls:{$config:{merge:"classList"},value:null},dock:null,forwardTwinEvents:{$config:{merge:"classList"},value:null},parent:null,tab:null,elementAttributes:null,htmlCls:{$config:{merge:"classList"},value:{"b-html":1}},style:null,disabled:null,readOnly:{value:null,default:!1,$config:null},ignoreParentReadOnly:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:{$config:["lazy","nullify"],value:null},showTooltipWhenDisabled:!0,preventTooltipOnTouch:null,monitorResize:{$config:["lazy","nullify"],value:null},masked:{$config:"nullify",value:null},maskDefaults:{target:"element"},cache:{},floating:null,positioned:null,draggable:null,align:{$config:{merge:Oo},value:"t-b"},centered:null,constrainTo:void 0,anchor:null,owner:null,scrollAction:null,hideAnimation:{$config:{merge:mo},value:null},showAnimation:{$config:{merge:mo},value:null},x:null,y:null,scrollable:{$config:["lazy","nullify"],value:null},scrollerClass:to,defaultBindProperty:"html",defaultAction:null,overflowable:{value:null,default:!0,$config:null},width:null,height:null,maxHeight:null,maxWidth:null,minWidth:null,minHeight:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,weight:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title","ariaLabel","ariaDescription"],requireSize:!1,ref:null,hidden:null,textAlign:null,ignoreScrollDuration:500,tag:"div",recomposeAsync:null,rootElement:null,htmlMutationObserver:{$config:["lazy","nullify"],value:{childList:!0,subtree:!0}},role:{$config:"lazy",value:"presentation"},ariaLabel:{$config:"lazy",value:null},ariaDescription:{$config:"lazy",value:null},ariaElement:"element",ariaHasPopup:null,realignTimeout:300,testConfig:{ignoreScrollDuration:100,realignTimeout:50}}}static get prototypeProperties(){return{hasGeneratedId:!1,innerItem:!0}}static get declarable(){return["renderConfigs"]}static get delayable(){return{recompose:"raf",doHideOrRealign:"raf",onAlignConstraintChange:"raf"}}static get factoryable(){return{defaultType:"widget"}}static get identifiable(){return{}}static get all(){return super.all}static get recomposeAsync(){return Io._recomposeAsync}static set recomposeAsync(e){if(Io._recomposeAsync=e,null!=e){const{all:t}=Io;for(let n=0;n<t.length;++n)t[n].isComposable&&(t[n].recomposeAsync=e)}}isType(e,t){return Io.isType(this,e,t)}static setupRenderConfigs(e,t){let n,{renderConfigs:i}=e;if(i){const e=t.getInherited("renderConfigs",!1)||Object.create(null);if(Array.isArray(i)){for(n=0;n<i.length;++n)e[i[n]]=!0;i=e}else i=Object.assign(e,i)}t.renderConfigs=i}construct(e={},...t){const n=this,{domSyncCallback:i}=n;n.configureAriaDescription=e.ariaDescription,n._isAnimatingCounter=0,n.alignConstrained=0,n.byRef=Object.create(null),n.onTargetResize=n.onTargetResize.bind(n),n.onFullscreenChange=n.onFullscreenChange.bind(n),n.domSyncCallback=i.$nullFn?null:i.bind(n),n._isUserAction=!1,super.construct(e,...t);const{recomposeAsync:r}=Io;null!=r&&null==n.recomposeAsync&&(n.recomposeAsync=r),n.finalizeInit()}startConfigure(e){super.startConfigure(e);const t=this,{adopt:n,element:i}=t;n&&(t.adoptElement(i,n,e.id),t.updateElement(t._element,i))}finalizeInit(){const e=this;(e.insertBefore||e.appendTo||e.insertFirst||e.adopt)&&e.render()}doDestroy(){const e=this,{preExistingElements:t,element:n,_refListeners:i}=e;if(i&&(Object.values(i,(e=>e())),e._refListeners=null),n){var r,s,o;const i=!e._tooltip&&e._rootElement&&(null===(r=Io.Tooltip)||void 0===r?void 0:r.getSharedTooltip(e._rootElement,!0));if((null==i?void 0:i.owner)===e&&(i.owner=null,i.hide()),e.onExitFullscreen(),e.clearTimeout(e.scrollListenerTimeout),e.clearTimeout(e.resizeListenerTimeout),e.removeTransientListeners(),e.floating||e.positioned?e.hide(!1):e.revertFocus(),qs.removeResizeListener(n.parentElement,e.onParentElementResize),qs.removeResizeListener(n,e.onElementResize),e.adopt){for(let i=Array.from(n.childNodes),r=0,{length:s}=i;r<s;r++){const n=i[r];t.includes(n)||n===e.floatRoot||n.remove()}n.className=e.adoptedElementClassName,n.style.cssText=e.adoptedElementCssText}else n.remove();null===(s=e.dragEventDetacher)||void 0===s||s.call(e),null===(o=e.dragOverEventDetacher)||void 0===o||o.call(e),e.dragGhost.remove()}super.doDestroy()}get assignValueDefaults(){return ao}get valueName(){return this.name||this.ref||this.id}getValueName(e){return(e=e&&"object"==typeof e?e.onlyName:e)?this.name:this.valueName}assignFieldValue(e,t,n){const i=this,r=i.defaultBindProperty;r in i&&(i[r]=n)}assignValue(e,t){t=t||ao;const n=this,i=n.highlightExternalChange,r=n.getValueName(t);!r||e&&!(r in e)||(!1===t.highlight&&(n.highlightExternalChange=!1),n.assignFieldValue(e,r,e?e[r]:null),n.highlightExternalChange=i)}gatherValue(e){const t=this,n=t.defaultBindProperty;t.constructor!==Io&&n in t&&(e[t.name||t.ref||t.id]=t[n])}gatherValues(e){this.eachWidget((t=>t.gatherValue(e)),!1)}get forwardTwinEvents(){const e=this._forwardTwinEvents;return e&&Nt.getTruthyKeys(e)}configureOverflowTwin(e){var t;const n=this;let i=Nt.clone(n.initialConfig);return delete i.id,i.hidden=!1,i.type=n.type,i._overflowTwinOrigin=n,i.disabled=n.disabled,"value"in n&&(i.value=n.value),null===(t=n.forwardTwinEvents)||void 0===t||t.forEach((e=>{delete i[`on${S.capitalize(e)}`]})),e&&(i="function"==typeof e?e(i)||i:Nt.assign(i,e)),i}createOverflowTwin(e){var t;const n=this,i=n.configureOverflowTwin(e),r=Io.create(i);return null===(t=n.forwardTwinEvents)||void 0===t||t.forEach((e=>{r.ion({[e]:e=>{n.overflowTwin===e.source&&(delete(e=Nt.assign({},e)).source,n.trigger(e.type,e))}})})),r}ensureOverflowTwin(e,t){let{overflowTwin:n}=this;return n||(this.overflowTwin=n=this.createOverflowTwin(e),null==t||t(n)),n}get isComposable(){return!this.compose.$nullFn}adoptElement(e,t,n){const i=this,r="string"==typeof t?document.getElementById(t):t,s=Io.fromElement(r);if(s&&s.adopt&&s!==i){("string"==typeof s.adopt?document.getElementById(s.adopt):s.adopt)===r&&s.destroy()}i.preExistingElements=Array.from(r.childNodes),i.adoptedElementClassName=r.className,i.adoptedElementCssText=r.style.cssText,r.id&&!n&&(i.id=e.id=r.id),gi.syncAttributes(e,r);for(let t=0,{length:n}=e.childNodes;t<n;t++)r.appendChild(e.childNodes[0]);delete i._contentRange,i._element=r;const o=e.lastDomConfig,l=null==o?void 0:o.listeners;var a;l&&i.isComposable&&(null===(a=l.un)||void 0===a||a.call(l),go(i,r,o));r.lastDomConfig=o||r.lastDomConfig,r.$refOwnerId=i.id,i.scaleToFitWidth||i.getConfig("monitorResize")}addRefAccessor(e,t){const{prototype:n}=this.constructor;Co(n,t,{writable:!0,value:null}),Co(n,e,{get(){return this.recompose.flush(),this[t]},set(e){this[t]=e}})}attachRef(e,t,n){const i=this,r="_"+e;t.dataset&&(t.dataset.ownerCmp=i.id),i.isComposable&&(r in i||i.addRefAccessor(e,r),go(i,t,n,e)),i.byRef[e]=t,i[e]=t}detachRef(e,t,n){const i=this,r=i._refListeners;null!=r&&r[e]&&(r[e](),delete r[e]),i[e]=null,delete i.byRef[e]}afterRecompose(){}compose(){return{class:gn.normalize(this.widgetClassList,"object")}}doCompose(){const e=this,{$meta:t}=e,n=t.hierarchy;let i,r,s,o,l,a,{composers:c}=t,d=null;if(e.recompose.suspend(),!c){for(s=!0,t.composers=c=[],o=n.indexOf(Io);o<n.length;++o)l=n[o].prototype,bo.call(l,"compose")&&c.push(l);(a=t.getInherited("renderConfigs",!1))||(a=Object.create(null),e.configObserver={get(e){a[e]=!0}}),t.$renderConfigs=a}for(o=0;o<c.length;++o)i=c[o].compose.call(e,d),d=d?gi.merge(d,i):i;return bo.call(e,"compose")&&(i=e.compose)&&(i=i.call(e,d),gi.merge(d,i)),s&&delete e.configObserver,gi.normalizeChildren(d,((t,n)=>{n&&(r="_"+t,r in e||e.addRefAccessor(t,r))}))}get element(){return this.isComposable&&!this.isDestroying&&this.recompose.flush(),this._element}domSyncCallback(e){}changeElement(e){const t=this,n=t.isComposable;return n&&(e=t.doCompose()),"string"==typeof e?e=gi.createElementFromTemplate(e):Nt.isObject(e)?(e=gi.createElement(e,{refOwner:t,callback:t.domSyncCallback}),t.recompose.resume(),n&&go(t,e,e.lastDomConfig)):gi.isReactElement(t.peekConfig("html"))?e=document.createElement("div"):1!==e.nodeType&&(e=gi.createElementFromTemplate(t.template(t))),e.id=t.id,t.elementAttributes&&gi.setAttributes(e,t.elementAttributes),e}updateElement(e){const t=this,{className:n}=e,{contentElement:i,contentElementCls:r,isComposable:s}=t,o=i!==e,l=!s&&e.querySelectorAll("[data-reference]"),a=s?[]:t.widgetClassList;let c=(o||!s)&&t.uiClasses;if(n&&a.unshift(n),t._hidden&&a.push("b-hidden"),t._readOnly&&a.push("b-readonly"),be.noThrow(e,"remove"),c?(null!=r&&r.value&&(c=c.slice(),c.push(r.value)),c=c.join(" ")):c=null==r?void 0:r.value,c&&(o?i.className+=" "+c:a.push(c)),!t.parent){const{defaultCls:e}=t,{outerCls:n}=Io;a.push(...e?n.filter((t=>!(t in e)||e[t])):n)}if(e.className=a.join(" "),l)for(let e,n=0;n<l.length;++n)e=l[n],t.attachRef(e.getAttribute("data-reference"),e),e.removeAttribute("data-reference");t.adopt||t.scaleToFitWidth||t.getConfig("monitorResize"),t.getConfig("role"),t.getConfig("ariaLabel"),t.getConfig("ariaDescription"),t._html&&t.getConfig("htmlMutationObserver"),t.trigger("elementCreated",{element:e})}updateAriaDescription(e){const{ariaElement:t}=this,n=`${this.id}-aria-desc-el`;if(e){const i=this._ariaDescEl||(this._ariaDescEl=gi.createElement({className:"b-aria-desc-element",id:n,parent:t}));i.innerText=e.match(To)?this.L(e,this):e,t.setAttribute("aria-describedBy",i.id)}else t.getAttribute("aria-describedby")===n&&t.removeAttribute("aria-describedBy")}updateAriaLabel(e){gi.setAttributes(this.ariaElement,{"aria-label":null!=e&&e.match(To)?this.L(e,this):e})}updateAriaHasPopup(e){gi.setAttributes(this.ariaElement,{"aria-haspopup":e})}updateRole(e){var t,n;e?null===(t=this.ariaElement)||void 0===t||t.setAttribute("role",e):null===(n=this.ariaElement)||void 0===n||n.removeAttribute("role")}get ariaElement(){this.getConfig("element");const{_ariaElement:e}=this;return e.nodeType===Node.ELEMENT_NODE?e:Nt.getPath(this,e)}isCollapsified(e,t){const{collapsify:n}=this;let i=!t;return null==n?i=t?e:!e:"overlay"===n&&(i=t),Boolean(i)}async recompose(){const e=this,t={targetElement:e.element,domConfig:e.doCompose(),refOwner:e,callback:e.domSyncCallback,strict:!0};if(e.transitionRecompose){if(e.isTransitioningDom=!0,await gi.transition(Nt.assign({element:e.element,action(){zs.sync(t)}},e.transitionRecompose)),e.isDestroyed)return;e.isTransitioningDom=!1,e.trigger("transitionedRecompose")}else zs.sync(t);t.changed&&(e.afterRecompose(),e.trigger("recompose")),e.recompose.resume()}changeElementRef(e){if("string"==typeof e){const t=e;if(!(e=document.getElementById(t)))throw new Error(`No element found with id '${t}'`)}return e}changeAppendTo(e){return this.changeElementRef(e)}updateAppendTo(e){!this.isConfiguring&&e&&this.render()}changeInsertBefore(e){return this.changeElementRef(e)}updateInsertBefore(e){!this.isConfiguring&&e&&this.render()}changeInsertFirst(e){return this.changeElementRef(e)}updateInsertFirst(e){!this.isConfiguring&&e&&this.render()}getRenderContext(e=this,t){let n=t||e.appendTo,{insertFirst:i,insertBefore:r}=e;return i&&(n=i,r=n.firstChild),r&&(n||(n=r.parentElement)),[n,r||void 0]}render(e,t=!0){const n=this,{element:i}=n,[r,s]=n.getRenderContext(n,e);n.emptyCache(),n.syncElement&&n.currentElement?gi.sync(i,n.currentElement):(null==r||r.insertBefore(i,s),n.currentElement=i),Io.fromElement(i.parentElement)&&i.classList.remove(...Io.outerCls),super.render(r,t),n.rendered=!0,n.getConfig("role"),t&&(n.getConfig("contentRange"),n.triggerPaint()),n.setupFocusListeners()}template({tag:e,html:t,htmlCls:n,name:i}){var r;const s=this;"string"==typeof t&&Mo.test(t)&&s.resolveCallback(t,s,!1)&&(t=s.callback(t,s,[s]));const o=null!==(r=t)&&void 0!==r&&r.call?t.call(s,s):t;return`<${e} class="${o?n:""}" ${i?`data-name="${i}"`:""}>${o||""}</${e}>`}updateRecomposeAsync(e){this.recompose.immediate=!e}onConfigChange({name:e}){var t;this._element&&!this.isDestroying&&null!==(t=this.$meta.$renderConfigs)&&void 0!==t&&t[e]&&this.recompose()}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.parent}getConfigValue(e,t){return"style"===e?this._style:super.getConfigValue(e,t)}getCurrentConfig(e){const t=super.getCurrentConfig(e);return(null==e?void 0:e.depth)>0&&(t.type=this.type),t}get dataset(){return this.element.dataset}changeDataset(e){Object.assign(this.dataset,e)}get dragGhost(){return this.constructor._dragGhost||(this.constructor._dragGhost=gi.createElement({html:" ",style:"position:absolute;top:-10000em;left:-10000em"}))}updateParent(e){const{_element:t}=this;t&&t.classList[e?"remove":"add"](...Io.outerCls)}get constrainTo(){var e;let t=this._constrainTo;if(t=void 0===t?globalThis:(null===(e=t)||void 0===e?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE?t.host||t.ownerDocument:t,this.positioned){const{offsetParent:e}=this.element;if(e&&"hidden"===gi.getStyleValue(e,"overflow"))t=dn.from(e).moveTo(0,0);else if(t&&!t.isRectangle){const n=t===document||t===globalThis;t=dn.from(t,e),n&&t.translate(globalThis.pageXOffset,globalThis.pageYOffset)}}return t}updateCentered(e){const{element:t,_anchorElement:n}=this;if(e&&!this.floating&&!this.positioned)throw new Error("`centered` is only relevant when a Widget is `floating` or `positioned`");e?(t.classList.add("b-centered"),t.style.transform=t.style.left=t.style.top="",null==n||n.classList.add("b-hide-display"),t.classList.remove("b-anchored")):t.classList.remove("b-centered")}get contentElement(){return this.element}get contentRange(){const e=this,{contentElement:t}=e,n=e._contentRange||(e._contentRange=new Range);return n.collapsed&&(n.setStart(t,e.contentRangeStartOffset||0),n.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),n}fixRefOwnerId(e,t,n){if(e.$refOwnerId===n){e.$refOwnerId=t;for(let{childNodes:i}=e,r=i.length;r-- >0;)this.fixRefOwnerId(i[r],t,n)}}get placement(){const{element:e}=this;let t,n,i;if(null!=e&&e.offsetParent&&!vo.test(gi.getStyleValue(e,"position"))){const s=e.nextElementSibling,o=e.previousElementSibling,l=!s&&o;var r;if(n=gi.getStyleValue(e.parentElement,"flex-direction"),n)n=n.startsWith("row")?"h":"v";else t=null===(r=s||o)||void 0===r?void 0:r.getBoundingClientRect(),i=t&&e.getBoundingClientRect(),n=t&&Math.abs(t.top-i.top)<Math.abs(t.left-i.left)?"h":"v";n+="h"===n?l?"r":"l":l?"b":"t"}return n}updateId(e,t){if(super.updateId(e,t),t){const{byRef:n,element:i}=this;for(const t in n)n[t].dataset&&(n[t].dataset.ownerCmp=e);i.id=e,this.fixRefOwnerId(i,e,t)}}get style(){const{element:e}=this;return(null==e?void 0:e.ownerDocument.defaultView.getComputedStyle(e))||this._style}updateStyle(e){this.element&&gi.applyStyle(this.element,e)}updateTitle(e){this.titleElement&&(this.titleElement.innerHTML=e)}beforeAlignTo(e){}alignTo(e){var t;const n=this,{lastAlignSpec:i,element:s}=n,{offsetParent:o,style:l,classList:a}=s;if(i&&(i.monitorIntersection&&n.intersectionObserver.unobserve(i.target),isFinite(i.zone)&&s.classList.remove(Eo[i.zone])),!e)return n.removeTransientListeners(),void(n.anchor=n.lastAlignSpec=null);n.beforeAlignTo(e),(e.nodeType===Element.ELEMENT_NODE||e.isWidget||"Point"===e.$$name)&&(e={target:e}),n.releaseSizeConstraints();const{scrollable:c,constrainTo:d}=n,u=n.positioned&&"fixed"!==gi.getStyleValue(s,"position"),h=n.scale||1,g=e.target,m=g&&(g.isRectangle?g:g.element||g),p=dn.from(s,u?o:null,!0),{width:f,height:v}=p,y=m&&m.nodeType===Element.ELEMENT_NODE,b=(e=e.realignTarget?e:Nt.assign({aligningToElement:y,constrainTo:d,align:"b-t",axisLock:n.axisLock,anchor:n.anchor},n.align,e)).minWidth||n.minWidth,C=e.minHeight||n.minHeight;if(p.isAlignRectangle=!0,b&&(p.minWidth=b*h),C&&(p.minHeight=C*h),n.lastAlignSpec=e,y&&(n.lastAlignSpec.target=m),y&&ei(m instanceof SVGElement?m.closest("svg"):m)){if((e=Object.setPrototypeOf({},e)).target=n.lastAlignSpec.targetRect=e.realignTarget||(e.allowTargetOut?dn.from(m,u?o:null,!u):gi.isInView(m,!1,n)),!e.target){const e=n.hide();return n.isDestroyed||(n.lastAlignSpec.targetOutOfView=!0),e}e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1),n.lastAlignSpec.anchoredTo=m}e.anchor&&(e.anchorSize=n.anchorSize,s.contains(n.anchorPathElement)||s.appendChild(n.anchorElement)),n.isAligning=!0,n.trigger("beforeAlign",e),n.isAligning=!1,e.rtl=n.rtl,(e.align.includes("s")||e.align.includes("e"))&&(n.rtl?e.align=e.align.replace(/s/g,"r").replace(/e/g,"l"):e.align=e.align.replace(/s/g,"l").replace(/e/g,"r"));const w=p.alignTo(e);let{align:E,anchor:S,x:T,y:x,width:D,height:O,overlap:M}=w;if(n.lastAlignSpec.zone=w.zone,O!=v&&("configuredHeight"in n||(n.configuredHeight=l.height),n.height=O/h,n.alignConstrained=1|n.alignConstrained,c&&(c.overflowY=!0)),D!=f&&("configuredWidth"in n||(n.configuredWidth=l.width),n.width=D/h,n.alignConstrained=2|n.alignConstrained,c&&(c.overflowX=c.clientWidth>c.scrollWidth)),E&&n.alignConstrained){e.align=E;const t=dn.from(s,u?o:null,!0).alignTo(e);S=t.anchor,T=t.x,x=t.y,D=t.width,O=t.height}if(n.centered||n.setXY(T,x),!w.overlap&&isFinite(w.zone)&&a.add(Eo[w.zone]),null!==(t=S)&&void 0!==t&&t.edge){var I;const{edge:e}=S,{anchorElement:t}=n,i=dn.from(s),r=[];"top"===e||"bottom"===e?(r[0]=S.x,r[1]="top"===e?1:i.height-1):(r[0]="left"===e?1:i.width-1,r[1]=S.y);let o=gi.childFromPoint(s,...r);if(null!==(I=o)&&void 0!==I&&I.matches(":hover,:focus")&&s.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(o=o.parentNode),o&&o!==document){let e=gi.getStyleValue(o,"background-color");for(;e.match(uo)&&"absolute"!==gi.getStyleValue(o,"position")&&(o=o.parentNode,o!==document);)e=gi.getStyleValue(o,"background-color");e.match(uo)?n.anchorPathElement.setAttribute("fill",n.defaultAnchorBackgroundColor):n.anchorPathElement.setAttribute("fill",e)}t.classList.remove("b-hide-display"),t.style.transform="",t.className=`b-anchor b-anchor-${e}`,S.x&&(S.x/=h),S.y&&(S.y/=h),gi.setTranslateXY(t,S.x,S.y),a.add("b-anchored")}else n._anchorElement&&(n.anchorElement.classList.add("b-hide-display"),a.remove("b-anchored"));if(!y){l.pointerEvents="none";const e=gi.elementFromPoint(T,x);n.owns(e)||(n.lastAlignSpec.anchoredTo=e),l.pointerEvents=""}if(("realign"===n.scrollAction&&y||"hide"===n.scrollAction)&&!n.documentScrollListener){if(n.clearTimeout(n.scrollListenerTimeout),e.monitorTargetMutation&&!n.targetObserver){(n.targetObserver||(n.targetObserver=new MutationObserver(n.onTargetParentMutation.bind(n)))).observe(gi.getRootElement(m),{childList:!0,attributes:!0,subtree:!0})}n.scrollListenerTimeout=n.setTimeout((()=>{var e;const t=null===(e=m.getRootNode)||void 0===e?void 0:e.call(m);n.documentScrollListener=En.addListener(document,"scroll","doHideOrRealign",{capture:!0,thisObj:n}),null!=t&&t.mode&&(n.targetRootScrollListener=En.addListener(t,"scroll","doHideOrRealign",{capture:!0,thisObj:n}))}),"hide"===n.scrollAction?n.ignoreScrollDuration:0)}if(y&&(e.monitorResize&&!n.targetResizeListener&&(qs.addResizeListener(m,n.onTargetResize),n.targetResizeListener=!0),e.monitorIntersection&&!(M||m.contains(s)||m.ownerSVGElement)&&n.intersectionObserver.observe(m)),!r.isAndroid&&!n.constrainListeners){const e=null!=d&&d.isRectangle?globalThis:d;n.clearTimeout(n.resizeListenerTimeout),n.resizeListenerTimeout=n.setTimeout((()=>{n.constrainListeners=!0,qs.addResizeListener(e||globalThis,n.onAlignConstraintChange)}),n.ignoreScrollDuration)}}onTargetParentMutation(e){const{element:t,lastAlignSpec:n}=this;null!=n&&n.aligningToElement&&(ti(n.target)?e.some((({target:e})=>e.contains(n.target)&&!t.contains(e)))&&this.realign():this.hide())}get intersectionObserver(){return this._intersectionObserver||(this._intersectionObserver=new IntersectionObserver(this.onTargetIntersectionchange.bind(this),{root:r.isSafari?this.rootElement:this.rootElement.ownerDocument}))}onTargetIntersectionchange(e){if(!this.isDestroyed){const t=e[e.length-1];t.isIntersecting||this.onAlignTargetOutOfView(t.target)}}onTargetResize(){const{lastAlignSpec:e}=this;if(e){const{width:t,height:n}=e.targetRect,{width:i,height:r}=e.target.getBoundingClientRect();i===t&&r===n||this.onAlignConstraintChange(...arguments)}}onAlignTargetOutOfView(e){this.hide(),this.lastAlignSpec&&(this.lastAlignSpec.targetOutOfView=!0)}onAlignConstraintChange(e,t,{height:n}){const{style:i}=this.contentElement,{overflowY:r}=i;this.setTimeout(this.realign,50),t&&n>t.height&&(i.overflowY="hidden",this.requestAnimationFrame((()=>i.overflowY=r)))}realign(){const e=this,{lastAlignSpec:t}=e;if((e.floating||e.positioned)&&t&&e.isVisible){if(t.aligningToElement){const n=t.target.contains(this.element),i=gi.isInView(t.target,!1,e);if(!(t.allowTargetOut||ei(t.target)&&i))return e.hide(),void(e.isDestroyed||(e.lastAlignSpec.targetOutOfView=!0));t.realignTarget=n?null:i}gi.addTemporaryClass(e.element,"b-realigning",e.realignTimout,e),e.alignTo(t)}}rectangle(e,t,n){return this.rectangleOf("element",e,t,n)}rectangleOf(e,t,n,i){var r;return"string"!=typeof t?(i=n,n=t,t=""):"border"===t&&(t=""),"boolean"==typeof n&&(i=n,n=void 0),"element"!==e&&void 0===n&&(n=this.element),n=null!==(r=n)&&void 0!==r&&r.isWidget?n.element:n,dn[t||"from"](this[e],n,i)}releaseSizeConstraints(){const e=this,t=e.scrollable;1&e.alignConstrained&&(e.height=e.configuredHeight,t&&(t.overflowY=t.config.overflowY)),2&e.alignConstrained&&(e.width=e.configuredWidth,t&&(t.overflowX=t.config.overflowX)),e.alignConstrained=0}toFront(){const{element:e}=this,t=this.floating?this.floatRoot:this.positioned?null==e?void 0:e.parentNode:null;if(null!=e&&e.nextSibling){const n=this._toFrontRange||(this._toFrontRange=document.createRange());n.setStartBefore(e.nextSibling),n.setEndAfter(t.lastElementChild),t.insertBefore(n.extractContents(),e)}}updateRef(e){this.element.dataset.ref=e}get overflowElement(){return this.contentElement}get maxHeightElement(){return this.element}changeAlign(e){return"string"==typeof e?{align:e}:e}changeScrollable(e,t){return"boolean"==typeof e&&(e={overflowX:e,overflowY:e}),e?(e.element=this.overflowElement,e.widget=this,e.isScroller||(e=t?t.setConfig(e):new this.scrollerClass(e)),e.syncOverflowState()):null==t||t.destroy(),e}handleReactElement(e){const t=this.closest((e=>e.reactComponent));null!=t&&t.reactComponent&&t.reactComponent.processWidgetContent({reactElement:e,widget:this,reactComponent:t.reactComponent})}get html(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML}updateHtml(e){const n=this,i=null==e,{element:r,contentElement:s,htmlCls:o}=n;if(r||!gi.isReactElement(e)){if(r){n.updatingHtml=!0;const l=s===r&&n._anchorElement;o&&o.values.forEach((e=>r.classList[i?"remove":"add"](e))),l&&r.removeChild(l),e&&"object"==typeof e?gi.isReactElement(e)?n.handleReactElement(e):zs.sync({domConfig:t(t({},e),{},{onlyChildren:!0}),targetElement:n.contentElement}):n.contentElement.innerHTML=i?"":e,n.getConfig("htmlMutationObserver"),l&&r.appendChild(l),n.isComposable?n.recompose():(n.floating||n.positioned)&&(n.isAligning||n.realign())}}else n.whenVisible((()=>n.handleReactElement(e)))}changeHtmlMutationObserver(e,t){const n=this,{contentElement:i}=n;if(null==t||t.disconnect(i),e){const t=new MutationObserver((()=>{n.updatingHtml?n.updatingHtml=!1:n._html=i.innerHTML}));return t.observe(i,e),t}}updateContent(e){const t=this,n=null==e,{element:i,htmlCls:r}=t;if(i){const{contentRange:s}=t;r&&r.values.forEach((e=>i.classList[n?"remove":"add"](e))),ti(i)?(s.deleteContents(),n||s.insertNode(gi.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=s.startOffset,t.contentRangeEndOffset=s.endOffset,!t.floating&&!t.positioned||t.isAligning||t.realign()}}onThemeChange(){var e;null!==(e=this.anchorElement)&&void 0!==e&&e.offsetParent&&(this._anchorSize=null,this.realign())}get anchorSize(){const e=this;let t=this._anchorSize;if(!t){const n=parseFloat(gi.getStyleValue(e.element,"border-top-width")),i=gi.getStyleValue(e.element,"border-top-color"),r=e.anchorElement,{className:s}=r,o=r.firstElementChild,l=e.anchorPathElement=o.lastElementChild,a=e._hidden;r.className="b-anchor b-anchor-top";let c=gi.getStyleValue(e.contentElement,"background-color");c.match(uo)&&(c=gi.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=c,t=r.getBoundingClientRect();const[d,u]=t=e._anchorSize=[t.width,t.height];r.className=s,o.setAttribute("height",u+n),o.setAttribute("width",d),l.setAttribute("d",`M0,${u}L${d/2},0.5L${d},${u}`),n&&(l.setAttribute("stroke-width",n),l.setAttribute("stroke",i)),t[1]-=n,a&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=Mi.ion({theme:"onThemeChange",thisObj:e})),e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}return t}get anchorElement(){const e=this;if(!e._anchorElement){const t=e.floating,n=`${e.id}-shadow-filter`;e._anchorElement=gi.createElement({parent:e.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[t?{tag:"defs",children:[{tag:"filter",id:n,children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:1,"flood-opacity":.2}]}]}:null,{tag:"path",[t?"filter":""]:`url(#${n})`}]}]})}return e._anchorElement}updateAnchor(e){this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")}updateDraggable(e){const t=this,{element:n}=t;var i,r,s;e?(t.dragEventDetacher=En.addListener({element:n,dragstart:"onWidgetDragStart",dragend:"onWidgetDragEnd",thisObj:t}),t.dragDetacher=En.on({element:n,mousedown(e){const{target:t}=e,i=Io.fromElement(t);(!e.target.closest(".b-field-inner")&&i===this||this.strips&&Object.values(this.strips).includes(i))&&n.setAttribute("draggable","true")},thisObj:t})):(null===(i=t.dragEventDetacher)||void 0===i||i.call(t),null===(r=t.dragOverEventDetacher)||void 0===r||r.call(t),null===(s=t.dragDetacher)||void 0===s||s.call(t))}onWidgetDragStart(e){var t;const n=this;if(!n.validateDragStartEvent(e))return;const{element:i,align:s,constrainTo:o}=n,l=n.positioned&&"fixed"!==gi.getStyleValue(i,"position"),a=l?i.parentElement:n.rootElement,c=dn.from(i,l?a:null),d=e.clientX,u=e.clientY,h=document.scrollingElement||document.body,[g,m]=l?gi.getOffsetXY(i,a):n.getXY(),p=null===(t=l?dn.content(a).moveTo(0,0):o&&(null!=o&&o.isRectangle?o:dn.from(o)))||void 0===t?void 0:t.deflate(s.constrainPadding||0),f={element:a,dragover:e=>{i.classList.remove("b-centered"),c.moveTo(g+e.clientX-d-(l?0:h.scrollLeft),m+e.clientY-u-(l?0:h.scrollTop)),p&&c.constrainTo(p),gi.setTranslateXY(i,c.x,c.y)}};r.isTouchDevice&&(f.touchmove=e=>e.preventDefault()),n.floatRoot.appendChild(n.dragGhost),n.setDragImage(e),e.dataTransfer.effectAllowed="none",n.dragOverEventDetacher=En.addListener(f),n.alignTo()}validateDragStartEvent(e){const{element:t}=this,n=gi.elementFromPoint(e.clientX,e.clientY),{handleSelector:i}=this.draggable;if(i){var r;const s=null===(r=fo.exec(i))||void 0===r?void 0:r[1];if(s){if(n.closest(`#${t.id} ${s}`))return e.preventDefault(),!1}else if(!n.closest(`#${t.id} ${i}`))return e.preventDefault(),!1}return!0}setDragImage(e){e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(this.dragGhost,-9999,-9999))}setStyle(e,t){return gi.applyStyle(this.element,Nt.isObject(e)?e:{[e]:t}),this}onWidgetDragEnd(){this.dragGhost.remove(),this.dragOverEventDetacher(),this.element.removeAttribute("draggable")}changeFloating(e){return Boolean(e)}changePositioned(e){return Boolean(e)}updatePositioned(e){this.element.classList[e?"add":"remove"]("b-positioned")}getXY(){return[gi.getPageX(this.element),gi.getPageY(this.element)]}setXY(e,t){const n=this,{element:i}=n;if(n.floating||n.positioned){if(null!=e&&(n._x=e),null!=t&&(n._y=t),"fixed"===gi.getStyleValue(i,"position")){const n=i.getBoundingClientRect(),[r,s]=gi.getTranslateXY(i),o=e-n.x,l=t-n.y;gi.setTranslateXY(i,r+o,s+l)}else gi.setTranslateXY(i,n._x||0,n._y||0);n.isConstructing?n.centered=!1:i.classList.remove("b-centered")}}get x(){return this.getXY()[0]}changeX(e){this.setXY(e)}get y(){return this.getXY()[1]}changeY(e){this.setXY(null,e)}get width(){const e=this,t=e.element;return e.monitorResize?(null==e._width&&(e._width=t.offsetWidth),e._width):t.offsetWidth}changeWidth(e){const t=this;gi.setLength(t.element,"width",e),t._lastWidth=e,t._width=null,t._flex=null,t.element.style.flex=""}clearWidthCache(){this._width=null}get maxWidth(){return gi.measureSize(this.element.style.maxWidth,this.element)}updateMaxWidth(e){gi.setLength(this.element,"maxWidth",e)}get minWidth(){return gi.measureSize(this.element.style.minWidth,this.element)}updateMinWidth(e){gi.setLength(this.element,"minWidth",e)}updateFlex(e){this.getConfig("width"),"number"!=typeof e&&isNaN(e)||(e=`${e} ${e}`),this.element.style.flex=e,this.element.style.width=""}updateAlignSelf(e){this.element.style.alignSelf=e}updateMargin(e){this.element.style.margin=this.parseTRBL(e).join(" ")}updateTextAlign(e,t){t&&this.element.classList.remove(`b-text-align-${t}`),this.element.classList.add(`b-text-align-${e}`)}updatePlaceholder(e){this.input&&(null==e?this.input.removeAttribute("placeholder"):this.input.placeholder=e)}get height(){const e=this,t=e.element;return e.monitorResize?(null==e._height&&(e._height=t.offsetHeight),e._height):t.offsetHeight}changeHeight(e){gi.setLength(this.element,"height",e),this._lastHeight=e,this._height=null}get maxHeight(){return gi.measureSize(this.maxHeightElement.style.maxHeight,this.element)}updateMaxHeight(e){gi.setLength(this.maxHeightElement,"maxHeight",e)}get minHeight(){return gi.measureSize(this.element.style.minHeight,this.element)}updateMinHeight(e){gi.setLength(this.element,"minHeight",e)}updateDisabled(e=!1){const{element:t,focusElement:n,ariaElement:i}=this;this.trigger("beforeUpdateDisabled",{disabled:e}),e&&(this.revertFocus(),this._disabled!==e)||(t&&(t.classList[e?"add":"remove"]("b-disabled"),n&&(n.disabled=e),i&&i.setAttribute("aria-disabled",e)),this.onDisabled(e))}onDisabled(e){}disable(){this.disabled=!0}enable(){this.disabled=!1}requestFullscreen(){const e=this,t=Bs.request(e.floating?e.floatRoot:e.element);return Bs.onFullscreenChange(e.onFullscreenChange),e.floating||(e.floatRoot._oldParent=e.floatRoot.parentElement,e.element.appendChild(e.floatRoot)),e.element.classList.add("b-fullscreen"),t}exitFullscreen(){return Bs.exit()}onFullscreenChange(){Bs.isFullscreen||this.onExitFullscreen()}onExitFullscreen(){var e;const t=this,n=null===(e=t._rootElement)||void 0===e?void 0:e.floatRoot;Bs.unFullscreenChange(t.onFullscreenChange),t.element.classList.remove("b-fullscreen"),t.element.contains(n)&&null!=n&&n._oldParent&&(n._oldParent.appendChild(n),n._oldParent=null)}get tooltip(){if(this._tooltip)return this._tooltip;{var e;const t=null===(e=Io.Tooltip)||void 0===e?void 0:e.getSharedTooltip(this.rootElement);if(t&&t.activeTarget===this._element&&t.isVisible)return t}}changeTooltip(e,t){const n=this,{element:i}=n;if(e){if(!n.preventTooltipOnTouch||!r.isTouchDevice){var s;if(e.isTooltip||"Object"===e.constructor.name||(e={html:"string"==typeof e?e:n.placeholder,textContent:!0}),!n.configureAriaDescription)n.ariaDescription=null!==(s=e.html)&&void 0!==s&&s.match(To)?e.html.replace(To,xo):e.html;if(!(null!=t&&t.isTooltip||e.newInstance))return i.dataset.btip=!0,void(n.tipConfig=e);e.type="tooltip",e.forElement||(e.forElement=i),"showOnHover"in e||e.forSelector||(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),e=Io.reconfigure(t,e,n),n.detachListeners("tooltipValueListener"),n.configureAriaDescription||e.ion({name:"tooltipValueListener",innerHtmlUpdate:"onTooltipValueChange",thisObj:n})}}else if(t){if(null!=e||!t.isTooltip)return void(t.html=null);t.destroy()}else delete i.dataset.btip;return e}onTooltipValueChange({value:e,source:t}){this.ariaDescription="string"==typeof e?e:t.contentElement.innerText}get tooltipText(){const e=this._tooltip;return e?e.isTooltip?e.contentElement.innerText:"string"==typeof e?e:e.html:this.tipConfig?this.tipConfig.html:void 0}get isVisible(){const e=this,{element:t}=e;let n;return Boolean(t&&!e._hidden&&!e.isDestroying&&ti(t)&&(!e.requireSize||ei(t))&&(!(n=e.containingWidget)||n.isVisible))}whenVisible(e,t=this,n,i=e){const r=this;r.isVisible&&r.isPainted?r.callback(e,t,n):(r.toCallWhenVisible||(r.toCallWhenVisible=new Map)).set(i,{callback:e,thisObj:t,args:n})}focus(){this.isFocusable&&gi.focusWithoutScrolling(this.focusElement)}get focusElement(){}get isFocusable(){const e=!this.isDestroying&&this.isVisible&&!this.disabled&&this.focusElement;return e&&(e===document.body||e.offsetParent)}async show({align:e,animate:t=!0}={}){const n=this,{element:i,floating:r}=n,{style:s}=i,o=t&&n.showAnimation;let l,a,c=!n.isVisible;return c&&(c=n.trigger("beforeShow"),Nt.isPromise(c)&&(c=await c)),!1===c||n.internalBeforeShow&&!1===n.internalBeforeShow()?Promise.resolve():new Promise((t=>{if(n.cancelHideShowAnimation(),n.updateCentered(n._centered),r){const e=n.floatRoot;e.contains(i)||(n.rendered?e.appendChild(n.element):n.render(e,!1)),s.transform.includes("scale")&&(n.scale=null,s.transform=s.transformOrigin="");const t=n.closest(yo);if(t){const{scale:e}=t;n.scale=e,s.transform=`scale(${e})`,s.transformOrigin="0 0"}}if(n._hidden=!1,i.classList.remove("b-hidden"),r&&!Zn(i)&&(n.hide(!1),t()),n.onConfigChange({name:"hidden",value:!1,was:!0,config:n.$meta.configs.hidden}),o){l=Object.keys(o)[0],a=o[l];const e=n.currentAnimation={showing:!0,styleProp:l,resolve:t};n.isAnimating=!0,n.currentAnimation.detacher=En.onTransitionEnd({element:i,property:l,duration:wo(a.duration)+20,handler:()=>n.afterHideShowAnimate(e),thisObj:n}),s[l]=a.from,gi.getStyleValue(i,l),s.transition=`${l} ${a.duration} ease ${a.delay}`,s[l]=a.to}n.afterShow(e,o?null:t)}))}async showBy(e,t,n){const i=this,r=Array.isArray(e);if(r||"number"==typeof e){const i=r?e:[e,t];e=Object.assign({target:new mn(i[0]+1,i[1]+1),matchSize:!1,align:"t0-b0"},r?t:n)}if(i.requireSize=!0,!i.isVisible)return i.show({align:e});gi.addTemporaryClass(i.element,"b-realigning",300,i),i.alignTo(e)}async showByPoint(){return A.deprecate("Core","6.0.0","Widget.showByPoint() replaced by Widget.showBy() with the same signature"),this.showBy(...arguments)}afterShow(e,t){var n,i;const r=this;r.trigger("show"),r._configuredAnchorState=r.anchor,null===(n=r.owner)||void 0===n||null===(i=n.onChildShow)||void 0===i||i.call(n,r),r.triggerPaint(),(r.floating||r.positioned)&&(e?r.alignTo(e):r.centered?r.alignTo({target:r.constrainTo,align:"c-c"}):r.forElement&&r.alignTo(r.forElement)),null==t||t()}onChildHide(e){e.floating&&this.ariaElement.removeAttribute("aria-owns")}onChildShow(e){e.floating&&(this.ariaHasPopup=e.role,this.ariaElement.setAttribute("aria-owns",e.id))}triggerPaint(){const e=this,{element:t,toCallWhenVisible:n}=e,i=!e.isPainted;if(e.isVisible){if(i&&(e.getConfig("scrollable"),e.scaleToFitWidth&&!e.monitorResize&&(e.onParentElementResize=e.onParentElementResize.bind(e),qs.addResizeListener(t.parentElement,e.onParentElementResize),e.updateScale()),!e.hideBryntumDomMessage&&(e.isTaskBoardBase||e.isGridBase||e.isCalendar)&&t.insertBefore(new Comment("POWERED BY BRYNTUM (https://bryntum.com)"),t.firstChild)),e.eachWidget(po,!1),i&&(e.rootElement=gi.getRootElement(t),e.getConfig("tooltip"),!Io.Ripple&&Io.RippleClass&&(Io.Ripple=new Io.RippleClass({rootElement:e.rootElement}))),e.isPainted=!0,i&&e.triggerConfigs("paint"),e.trigger("paint",{firstPaint:i}),null!=n&&n.size){for(const{callback:t,thisObj:i,args:r}of n.values())e.callback(t,i,r);n.clear()}i&&e.monitorResize&&!e.scaleToFitWidth&&qs.onElementResize([{target:t}])}}cancelHideShowAnimation(){const e=this,{currentAnimation:t,element:n}=e;t&&(e.isAnimating=!1,n.classList.contains("b-hiding")&&(n.classList.remove("b-hiding"),e._hidden=!1),t.detacher(),t.resolve(),n.style.transition=n.style[t.styleProp]="",e.currentAnimation=null,e.trigger((t.showing?"show":"hide")+"AnimationEnd"))}afterHideShowAnimate(e){const t=this;e===t.currentAnimation&&(t.element.classList.remove("b-hiding"),t.cancelHideShowAnimation(),t._hidden&&t.afterHideAnimation())}suspendVisibility(){this._visibilitySuspended=(this._visibilitySuspended||0)+1,Object.defineProperty(this,"isVisible",So)}resumeVisibility(e=!0){--this._visibilitySuspended||(delete this.isVisible,e&&this.triggerPaint())}hide(e=!0){return new Promise((t=>{const n=this,{element:i,lastAlignSpec:r}=n,{style:s}=i,o=e&&n.hideAnimation;if(n.clearTimeout(n.scrollListenerTimeout),n.clearTimeout(n.resizeListenerTimeout),!n._hidden&&!1!==n.trigger("beforeHide",{animate:e})){if(n._hidden=!0,r&&(r.targetOutOfView=null,r.monitorIntersection&&(n.intersectionObserver.takeRecords(),n.intersectionObserver.unobserve(r.target))),n.onConfigChange({name:"hidden",value:!0,was:!1,config:n.$meta.configs.hidden}),!i)return void t();if(i.contains(gi.getActiveElement(i))&&n.revertFocus(!0),n.isDestroyed)return void t();if(n.cancelHideShowAnimation(),o){const e=Object.keys(o)[0],r=o[e];if(Number(getComputedStyle(n.element)[e])!==r.to){const o=n.currentAnimation={hiding:!0,styleProp:e,resolve:t};i.classList.add("b-hiding"),n.isAnimating=!0,n.currentAnimation.detacher=En.onTransitionEnd({element:i,property:e,duration:wo(r.duration)+20,handler:()=>n.afterHideShowAnimate(o),thisObj:n}),s[e]=r.from,gi.getStyleValue(i,e),s.transition=`${e} ${r.duration} ease ${r.delay}`,s[e]=r.to}else i.classList.add("b-hidden")}else i.classList.add("b-hidden");n.afterHide(!o&&t,o)}}))}doHideOrRealign({target:e,isTrusted:t}){const n=this,{lastAlignSpec:i,element:r}=n,s=null==i?void 0:i.anchoredTo,o=null==i?void 0:i.target,l=null==i?void 0:i.position,a=gi.getActiveElement(n);if(!t||!ei(r)||e&&(r.contains(e)||e.nodeType===Element.DOCUMENT_NODE&&r.contains(a)&&ho[a]&&globalThis.innerHeight<document.body.offsetHeight))return;if(i.aligningToElement){const e=gi.isInView(o,!1,n);if(e&&e.equals(i.targetRect))return}const c="hide"===n.scrollAction&&n.getXY();if(n.realign(),!n.isDestroyed&&Zn(r)&&"hide"===n.scrollAction){const[t,i]=n.getXY();(t!==c[0]||i!==c[1]||"Point"===(null==o?void 0:o.$$name)||l)&&(!s||!ei(s)||e&&gi.isDescendant(e,s))&&n.hide()}}afterHide(e=null,t=this.hideAnimation){var n,i;const r=this;r._anchor=r._configuredAnchorState,r.removeTransientListeners(),t||r.afterHideAnimation(),r.trigger("hide"),null===(n=r.owner)||void 0===n||null===(i=n.onChildHide)||void 0===i||i.call(n,r),e&&e()}removeTransientListeners(){var e,t;const n=this,{targetObserver:i,lastAlignSpec:r}=n;if(n.clearTimeout(n.resizeListenerTimeout),n.clearTimeout(n.scrollListenerTimeout),i&&(i.disconnect(),delete n.targetObserver),n.documentScrollListener=null===(e=n.documentScrollListener)||void 0===e?void 0:e.call(n),n.targetRootScrollListener=null===(t=n.targetRootScrollListener)||void 0===t?void 0:t.call(n),n.targetResizeListener&&(qs.removeResizeListener(r.target,n.onTargetResize),n.targetResizeListener=!1),n.constrainListeners){var s;const e=null!==(s=r.constrainTo)&&void 0!==s&&s.isRectangle?globalThis:r.constrainTo;qs.removeResizeListener(e||globalThis,n.onAlignConstraintChange),n.constrainListeners=!1}}afterHideAnimation(){const e=this,{element:t}=e;e.floating&&e.floatRoot.contains(t)?t.remove():t.classList.add("b-hidden"),e.defaultAnchorBackgroundColor&&e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}changeHidden(e){const t=this;let n;return t.isConfiguring?(n=Boolean(e),t.element.classList[e?"add":"remove"]("b-hidden")):(t.trigger("beforeChangeHidden",{hidden:e}),e?t.hide():t.show()),n}get assignedId(){return this.hasGeneratedId?null:this.id}get owner(){return this.parent||this._owner||this.containingWidget}get containingWidget(){let e=this.parent;if(!e){var t,n;const i=(null===(t=this.forElement)||void 0===t?void 0:t.nodeType)===Element.ELEMENT_NODE?this.forElement:null===(n=this.element)||void 0===n?void 0:n.parentNode;e=(null==i?void 0:i.closest(".b-widget"))&&Io.fromElement(i)}return e}get previousSibling(){return this.getSibling(-1)}get nextSibling(){return this.getSibling(1)}getSibling(e){const t=this,{parent:n}=t,i=n?n.childItems:Array.from(t.element.parentElement.querySelectorAll(".b-widget"));return n?i[i.indexOf(t)+e]:Io.fromElement(i[i.indexOf(t.element)+e])}up(e,t,n){var i;const{owner:r}=this;return e?null==r||null===(i=r.closest)||void 0===i?void 0:i.call(r,e,t,n):r}closest(e,t,n){const i=typeof n,r="number"===i,s="string"===i;for(let i=this,o=1;i;i=i.owner,o++){if(Io.widgetMatches(i,e,t))return i;if(r&&o>=n)return;if(s&&Io.widgetMatches(i,n,t))return;if(i===n)return}}owns(e){if(e){if("eventPhase"in e&&(e=e.target),e.nodeType===Element.ELEMENT_NODE){if(this.element.contains(e))return!0;e=Io.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}eachAncestor(e){let t=this.owner;for(;t;){if(!1===e(t))return!1;t=t.owner}return!0}changeMonitorResize(e,t){const n=!this.scaleToFitWidth&&Boolean(e);if(n!==Boolean(t))return n}updateMonitorResize(e){const t=this;bo.call(t,"onElementResize")||(t.onElementResize=t.onElementResize.bind(t)),qs[e?"addResizeListener":"removeResizeListener"](t.element,t.onElementResize)}changeReadOnly(e){if(e=Boolean(e),Boolean(this._readOnly)!==e)return e}updateReadOnly(e){var t;null===(t=this.element)||void 0===t||t.classList[e?"add":"remove"]("b-readonly"),this.isConfiguring||(this.eachWidget((t=>{t.ignoreParentReadOnly||("_originalReadOnly"in t||(t._originalReadOnly=t.config.readOnly||!1),t.readOnly=e||t._originalReadOnly)}),!1),this.trigger("readOnly",{readOnly:e}))}eachWidget(e,t=!0){const n=this.childItems,i=(null==n?void 0:n.length)||0,r={};for(let s=0;s<i;s++){const i=n[s];if(r.down=t,!1===e(i,r))return!1;if(r.down&&i.eachWidget&&!1===i.eachWidget(e,t))return!1}return!0}queryAll(e){const t=[];return this.eachWidget((n=>{e(n)&&t.push(n)})),t}query(e){let t=null;return this.eachWidget((n=>{if(e(n))return t=n,!1})),t}getWidgetByRef(e){var t,n;return e instanceof Io?e:(null==this||null===(t=this.widgetMap)||void 0===t?void 0:t[e])||(null==this||null===(n=this.owner)||void 0===n?void 0:n.getWidgetByRef(e))}onFocusIn(e){const t=this,{element:n}=t;t.containsFocus=!0,t.focusInEvent=e,n.classList.add("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),n.contains(e._target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=En.on({element:n,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}onFocusOut(e){const t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!t.isVisible),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),t.trigger("focusout",e))}captureFocus(){const e=this,t=gi.getActiveElement(e),n=e.contains(t)&&e.captureFocusItem(t);return(i,r)=>{if(n&&!e.isDestroying){(gi.getActiveElement(e)!==t||r)&&n(i)}}}captureFocusItem(e){return(t=!0)=>{this.contains(e)&&(t?e.focus():gi.focusWithoutScrolling(e))}}contains(e,t){const{element:n}=this;if(e&&n)return e.isWidget&&(e=e.element),n.contains(e)&&(!t||n!==e)}revertFocus(e){var t,n;const i=this,r=gi.getActiveElement(i);let s=null===(t=i.focusInEvent)||void 0===t?void 0:t.relatedTarget;(e||i.containsFocus&&(null===(n=s)||void 0===n?void 0:n.nodeType)===Element.ELEMENT_NODE&&i.element.contains(r))&&(s&&gi.isFocusable(s)||(s=i.getFocusRevertTarget()),i._isRevertingFocus=!0,s&&gi.isFocusable(s)?(s._isRevertingFocus=!0,gi.focusWithoutScrolling(s),s._isRevertingFocus=!1):null==r||r.blur(),i._isRevertingFocus=!1)}getFocusRevertTarget(){const e=this,{owner:t,focusInEvent:n}=e,i=n&&n.backwards?1:-1;let r=n&&n.relatedTarget;const s=r&&Io.fromElement(r);if(t&&!t.isDestroyed&&(!r||!gi.isFocusable(r)||s&&!s.isFocusable)){var o;if(r=null,t.eachWidget){const n=[];if(t.eachWidget((t=>{(t===e||t.isFocusable)&&n.push(t)}),!1),n.length>1){const t=n.indexOf(e);r=n[t+i]||n[t-i]}}!r&&t.isFocusable&&(r=t),r=r?r.focusElement:null===(o=t.getFocusRevertTarget)||void 0===o?void 0:o.call(t)}return r}getStaticWidgetClasses(e,t){const n=new gn,i=this.$meta.hierarchy;let r,s,o,l,a;for(s=i.indexOf(e);s<i.length;++s){var c;r=i[s],a=Reflect.getOwnPropertyDescriptor(r.prototype,"widgetClass"),null!==(c=a)&&void 0!==c&&c.get?l=a.get.call(this):(o=bo.call(r,"$$name")||bo.call(r,"$name")||bo.call(r,"_$name")?r.$$name:r.name,(o.length<3||o.includes("$"))&&console.warn(`Class "${o}" extending "${r.$name}" should have "$name" static getter with no less than 3 chars.`),l=`b-${o.toLowerCase()}`),l&&n.add(t?l+t:l)}return n}get rootUiClass(){return Io}get staticClassList(){const{$meta:e}=this;let t=e.staticClassList;return t||(e.staticClassList=t=this.getStaticWidgetClasses(Io),r.isTouchDevice&&t.add("b-touch")),t}get uiClasses(){return this.getConfig("ui"),this._uiClasses}get uiClassList(){return this.getConfig("ui"),this._uiClassList}get widgetClassList(){const e=this,{cls:t,defaultCls:n,uiClasses:i}=e;let{staticClassList:r}=e;(n||t)&&(r=r.clone(),n&&r.assign(n),t&&r.assign(t));const s=r.values;return i&&s.push(...i),e.floating&&s.push("b-floating"),"hide"===e.collapsify&&s.push("b-collapsify-hide"),s}changeCls(e){return gn.from(e)}changeContentElementCls(e){return gn.from(e)}changeHtmlCls(e){return gn.from(e)}changeDefaultCls(e){return gn.from(e,!0)}changeUi(e){return gn.from(e)}updateUi(e){var t;let n,i,r=null;if(e){const t=this.getStaticWidgetClasses(this.rootUiClass);for(i in e)if(e[i])for(n in t)t[n]&&((r||(r=new gn))[`${n}-ui-${i}`]=1)}this._uiClasses=null===(t=r)||void 0===t?void 0:t.values,this._uiClassList=r}fromCache(e,t=!1,n=this.element){if(!n)return null;const i=this;return i.cache[e]||(i.cache[e]=t?gi.children(n,e):gi.down(n,e)),i.cache[e]}emptyCache(){this.cache={}}changeMasked(e,t){var n;if("trial"!==(null===(n=this.masked)||void 0===n?void 0:n.type)){if(!0!==e&&""!==e||(e=" "),t&&!t.isDestroyed)"string"==typeof e?(t.text=e,e=t):e?(t.setConfig(e),e=t):t.destroy();else if(e){const t=Io.resolveType("mask");(e=t.mergeConfigs(this.maskDefaults,e)).owner=this,e=t.mask(e)}return e||null}}onMaskAutoClose(e){e.isDestroyed&&e===this.masked&&(this.masked=null)}mask(e){return this.masked=e,this.masked}unmask(){this.masked=null}onInternalResize(e,t,n,i,r){this._width=e.offsetWidth,this._height=e.offsetHeight}onElementResize(e,t){const n=this,{element:i}=n,r=n._width,s=n._height,o=i.offsetWidth,l=i.offsetHeight;n.floating&&t&&n.onFloatingWidgetResize(...arguments),n.suspendResizeMonitor||r===o&&s===l||(n.onInternalResize(i,o,l,r,s),n.trigger("resize",{width:o,height:l,oldWidth:r,oldHeight:s}))}onFloatingWidgetResize(e,t,n){const i=this,{lastAlignSpec:r,constrainTo:s}=i;if(i.isVisible&&r&&r.target){const e=!t||n.height!==t.height,o=!t||n.width!==t.width,l=s&&!dn.from(s).contains(dn.from(i.element,null,!0));(e&&2!==r.zone||o&&1!==r.zone||l)&&i.requestAnimationFrame((()=>i.realign()))}}updateScale(){const e=this,t=e.element,n=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),t.style.display="none";const i=dn.client(n).width/e.configuredWidth,r=e.scale=e.allowGrowWidth?Math.min(i,1):i;t.style.transform=`scale(${r})`,t.style.transformOrigin="top left",t.style.display="",e.allowGrowWidth&&i>1&&(e.width=e.configuredWidth*i)}onParentElementResize(e){this.updateScale()}parseTRBL(e,t="px"){if("number"==typeof(e=e||0))return[`${e}${t}`,`${e}${t}`,`${e}${t}`,`${e}${t}`];const n=e.split(" "),i=n.length;return 1===i?n[1]=n[2]=n[3]=n[0]:2===i?(n[2]=n[0],n[3]=n[1]):3===i&&(n[3]=n[1]),[isFinite(n[0])?`${n[0]}${t}`:n[0],isFinite(n[1])?`${n[1]}${t}`:n[2],isFinite(n[2])?`${n[2]}${t}`:n[3],isFinite(n[3])?`${n[3]}${t}`:n[4]]}get documentRoot(){var e;return(null===(e=this.owner)||void 0===e?void 0:e.documentRoot)||this.element.getRootNode()}get rootElement(){const e=this;if(!e._rootElement){var t;let n=(null===(t=e.owner)||void 0===t?void 0:t.rootElement)||gi.getRootElement(e.forElement||(ti(e.element)?e.element:e.getRenderContext()[0]||e.element));n||(n=document.body),e._rootElement=n}return e._rootElement}get floatRoot(){var e;const t=this.rootElement||(null===(e=this.owner)||void 0===e?void 0:e.rootElement);let{floatRoot:n}=t;if(n)t.contains(n)||t.appendChild(n);else{var i;const{outerCls:e}=Io,s=null===(i=gi.getThemeInfo(null,t))||void 0===i?void 0:i.name;if(!gi.isValidFloatRootParent(t))throw new Error("Attaching float root to wrong root");s&&e.push(`b-theme-${s.toLowerCase()}`),n=t.floatRoot=gi.createElement({className:`b-float-root ${e.join(" ")}`,parent:t}),co.push(n),r.isAndroid&&(n.style.height=`${screen.height}px`,En.on({element:globalThis,orientationchange:()=>n.style.height=`${screen.height}px`,thisObj:this})),!r.isHoverableDevice&&globalThis.visualViewport&&En.on({element:globalThis.visualViewport,resize:({target:e})=>n.style.height=`${e.height}px`,thisObj:this}),Mi.ion({theme:({theme:e,prev:t})=>{n.classList.add(`b-theme-${e.toLowerCase()}`),n.classList.remove(`b-theme-${t.toLowerCase()}`)}})}return n}get floatRootMaxZIndex(){let e=1;return Array.from(this.floatRoot.children).forEach((t=>{const n=parseInt(getComputedStyle(t).zIndex||0,10);n>e&&(e=n)})),e}static resetFloatRootScroll(){co.forEach((e=>e.scrollTop=e.scrollLeft=0))}static get floatRoots(){return co}static removeFloatRoot(e){co.splice(co.indexOf(e),1)}static get outerCls(){const e=["b-outer"],{platform:t}=r;return t&&e.push(`b-${t}`),r.isTouchDevice&&e.push("b-touch-events"),gi.scrollBarWidth?e.push("b-visible-scrollbar"):e.push("b-overlay-scrollbar"),r.isChrome?e.push("b-chrome"):r.isSafari?e.push("b-safari"):r.isFirefox&&e.push("b-firefox"),globalThis.ResizeObserver||e.push("b-no-resizeobserver"),e}get isAnimating(){return this._isAnimatingCounter>0}set isAnimating(e){const t=this,{_isAnimatingCounter:n}=t;t._isAnimatingCounter=Math.max(0,n+(e?1:-1)),0===n&&e?(t.element.classList.add("b-animating"),t.trigger("animationStart")):1!==n||e||(t.element.classList.remove("b-animating"),t.trigger("animationEnd"))}async waitForAnimations(){this.isAnimating&&await this.await("animationend",{checkLog:!1})}static query(e,t=!1){const{idMap:n}=Io.identifiable;for(const i in n)if(Io.widgetMatches(n[i],e,t))return n[i];return null}static queryAll(e,t=!1){const{idMap:n}=Io.identifiable,i=[];for(const r in n)Io.widgetMatches(n[r],e,t)&&i.push(n[r]);return i}static fromElement(e,t,n){const i=typeof t;e&&!e.nodeType&&(e=e.target),("number"===i||t&&t.nodeType===Element.ELEMENT_NODE)&&(n=t,t=null);let r,s,o,l=e,a=0;for("number"!=typeof n&&(r=n,n=Number.MAX_VALUE),"string"===i&&(t=t.toLowerCase());l&&l.nodeType===Element.ELEMENT_NODE&&a<n&&l!==r;){if(s=l.dataset&&l.dataset.ownerCmp||l.id,s){if(o=Io.getById(s),o){if(!t)return o;if("function"===i){if(t(o))return o}else if(Io.widgetMatches(o,t,!0))return o}a++}l=l.parentNode}return null}triggerFieldChange(e,t=!0){t&&this.trigger("change",e),this.eachAncestor((t=>{var n,i;if(null===(n=t.onFieldChange)||void 0===n||n.call(t,e),null!==(i=t.isolateFieldChange)&&void 0!==i&&i.call(t,this))return!1}))}isolateFieldChange(e){return this.isolateFields}setupFocusListeners(){Mi.setupFocusListenersOnce(this._rootElement,En)}static widgetMatches(e,t,n){return"*"===t||("function"==typeof t?t(e):Io.isType(e,t,n))}static attachTooltip(e,t){return"string"==typeof t&&(t={html:t}),Io.create(Object.assign({forElement:e},t),"tooltip"),e}changeDock(e){return"start"===e?"left":"end"===e?"right":e}updateRtl(e){super.updateRtl(e),this.eachWidget((t=>{"rtl"in t.initialConfig||(t.rtl=e)}))}}const Fo=Io.prototype;["compose","domSyncCallback"].forEach((e=>Fo[e].$nullFn=!0)),Io.initClass(),Io.register("mask",so),gi.Widget=Io,Mi.Widget=Io,so.identifiable.idMap=Io.identifiable.idMap,Object.assign(globalThis.bryntum||(globalThis.bryntum={}),{get:Io.getById.bind(Io),query:Io.query,queryAll:Io.queryAll,fromElement:Io.fromElement}),Io._$name="Widget";class ko extends(de.mixin($e,lr)){get contentElement(){var e;return null===(e=this.owner)||void 0===e?void 0:e.contentElement}onChildAdd(e){}onChildRemove(e){}renderChildren(){const e=this,{owner:t,itemCls:n}=e,{contentElement:i,items:r}=t,s=t.itemCls,o=null==r?void 0:r.length;if(o){t.textContent=!1;for(let e=0;e<o;e++){const o=r[e],{element:l}=o,{classList:a}=l;l.dataset.itemIndex=e,a.contains("b-outer")&&a.remove(...Io.outerCls),n&&a.add(n),s&&a.add(s),o.render(i,Boolean(t.isPainted))}}e.syncPendingConfigs(),e.syncChildCount()}removeChild(e){const t=this,{element:n}=e,{owner:i,itemCls:r}=t,{contentElement:s}=i,o=i.itemCls;s.contains(n)&&n.remove(),delete n.dataset.itemIndex,r&&n.classList.remove(r),o&&n.classList.remove(o),t.fixChildIndices(),t.syncChildCount()}appendChild(e){const{element:t}=e,{owner:n,itemCls:i}=this,{contentElement:r}=n,s=n.itemCls;t.dataset.itemIndex=n.indexOfChild(e),n.textContent=!1,i&&t.classList.add(i),s&&t.classList.add(s),e.render(r,Boolean(n.isPainted)),this.syncChildCount()}insertChild(e,t){const n=this,{element:i}=e,{owner:r,itemCls:s}=n,{contentElement:o}=r,l=gi.getChild(o,`[data-item-index="${t}"]`),a=r.itemCls;r.textContent=!1,s&&i.classList.add(s),a&&i.classList.add(a),o.insertBefore(i,l),e.render(null,Boolean(r.isPainted)),n.fixChildIndices(),n.syncChildCount()}fixChildIndices(){this.owner.items.forEach(((e,t)=>{e.element.dataset.itemIndex=t}))}syncChildCount(){var e;const{owner:t}=this,{length:n}=t.items;null===(e=t.contentElement)||void 0===e||e.classList[1===n?"add":"remove"]("b-single-child")}syncConfigLater(e){const t=this.pendingConfigs||(this.pendingConfigs=[]);t.includes(e)||t.push(e)}syncConfigStyle({name:e,style:t,classes:n,map:i}){const r=this,s=`b-box-${e}-`,{contentElement:o}=r,l=r[e];let a=(null==i?void 0:i[l])||l;if(o){if(n){const{classList:e}=o;n.forEach((t=>{t!==a&&e.remove(s+t)})),n.includes(a)&&(e.add(s+a),a="")}o.style[t]=a}else r.syncConfigLater(e)}syncPendingConfigs(){const e=this,{pendingConfigs:t}=e;let n;if(t)for(e.pendingConfigs=null;n=t.pop();)e[e.$meta.configs[n].updater](e[n])}}n(ko,"type","default"),n(ko,"configurable",{owner:null,containerCls:"b-auto-container",itemCls:null}),n(ko,"factoryable",{defaultType:"default"}),ko.initClass(),ko._$name="Layout";let Lo=0;const Ao=e=>e.ripple;class $o extends Io{static get defaultConfig(){return{old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}static get $name(){return"Ripple"}afterConstruct(){super.afterConstruct(),En.on({element:this.rootElement,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}onRippleControllingEvent(e){var t;const n=this;n.show();const i=gi.getStyleValue(n.circleElement,"animationName");n.hide(),null===(t=n.listenerDetacher)||void 0===t||t.call(n),i&&"none"!==i&&(n.listenerDetacher=En.on({mousedown:{element:n.rootElement,capture:!0,handler:"onMousedown"},touchstart:{element:n.rootElement,capture:!0,handler:"onTouchStart"},animationend:{element:n.circleElement,handler:"onAnimationEnd"},thisObj:n}),"mousedown"===e.type&&(n.onMousedown(e),Mi.ion({theme:"onRippleControllingEvent",thisObj:this})))}onTouchStart(e){Lo=performance.now(),this.handleTriggerEvent(e)}onMousedown(e){performance.now()-Lo>200&&this.handleTriggerEvent(e)}handleTriggerEvent(e){const t=Io.fromElement(e.target,Ao);if(t){const n=t.ripple,i=n.delegate?e.target.closest(n.delegate):t.focusElement||t.element;if(i){const r=Nt.assign({event:e,target:i,radius:this.radius},n);if("string"==typeof r.clip&&(r.clip=t[r.clip]||e.target.closest(r.clip),!r.clip))return;this.ripple(r)}}}ripple({event:e,point:t=En.getClientPoint(e),target:n=e.target,clip:i=n,radius:r=this.radius,color:s=this.color}){this.clip=i;const o=this,l=(i=dn.from(i,null,!0)).getDelta(t),a=o.rippleElement.style,c=o.circleElement,d=gi.getStyleValue(n,"border-radius");o.hide(),a.transform=`translateX(${l[0]}px) translateY(${l[1]}px)`,a.height=a.width=`${r}px`,o.element.style.borderRadius=d,c.setAttribute("r",r),c.setAttribute("fill",s),o.showBy({target:i,align:"c-c",matchSize:!0})}onAnimationEnd(e){"b-ripple-expand"===e.animationName&&this.hide()}}Io.RippleClass=$o,$o._$name="Ripple";const Ro=Object.freeze({}),{isArray:Po}=Array,_o=e=>e.weight,No=({weight:e},{weight:t})=>"string"==typeof e||"string"==typeof t?String(e).localeCompare(String(t)):(null!=e?e:Number.MAX_SAFE_INTEGER)-(null!=t?t:Number.MAX_SAFE_INTEGER),jo=e=>e&&!e.hidden,Vo=["display","flex-direction"],zo={default:1,box:1};class Bo extends Io{static get $name(){return"Container"}static get type(){return"container"}static get configurable(){return{items:null,lazyItems:{$config:["lazy"],value:null},defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:{type:"default"},namedItems:null,overflowable:{value:null,default:!1,$config:null},textContent:!0,record:null,autoUpdateRecord:null,autoUpdateFields:null,hideWhenEmpty:null,contentElMutationObserver:{$config:["lazy","nullify"],value:!0},isolateFields:!1,focusDescendant:!1,defaultBindProperty:null,defaultFocus:null}}static get prototypeProperties(){return{flexRowCls:"b-flex-row",flexColCls:"b-flex-column",initialItems:!0}}startConfigure(e){const t=e.items||e.lazyItems;(this.hasItems=Boolean(t&&(Po(t)?t:Object.keys(t)).length))||(this.initialItems=!1),super.startConfigure(e)}get firstItem(){return this.getAt(0)}get lastItem(){return this.getAt(-1)}getAt(e){return this.ensureItems().at(e)}remove(...e){let t=!0;1===e.length&&(Po(e[0])?e=e[0]:t=!1);const n=this,{_items:i}=n,r=[];for(let t=0;t<e.length;t++){const s=e[t];i.includes(s)&&(i.remove(s),n.layout.removeChild(s),r.push(s),n.onChildRemove(s))}return t?r:r[0]}removeAll(){return this.remove(this.items)}add(...e){const t=this,n=t.ensureItems(),i=[];let r,s,o,l=!0;for(1===e.length&&(Po(e[0])?e=e[0]:l=!1),s=0;s<e.length;s++){var a;r=e[s],r.isWidget?r.parent=t:r=t.createWidget(r),null!=(null===(a=r)||void 0===a?void 0:a.weight)?(o=he.findInsertionIndex(r,n.values,No),i.push(t.insert(r,o))):r&&(n.includes(r)||(n.add(r),t.onChildAdd(r),t.layout.appendChild(r),i.push(r)))}return l?i:i[0]}ensureItems(){const e=this;return e.getConfig("items"),e.getConfig("lazyItems"),e._items||(e.items=[]),e._items}insert(e,t){const n=this,i=n.ensureItems();e instanceof Io?e.parent=n:e=n.createWidget(e),i.includes(t)&&(t=n.indexOfChild(t)),t=Math.min(t,i.count);const r=i.values;return r.splice(t,0,e),i.values=r,n.onChildAdd(e),n.layout.insertChild(e,t),e}indexOfChild(e){return this.items.indexOf(e)}changeLazyItems(e){this.items=e,this.layout.renderChildren()}changeItems(e,t){const n=this,i=[],r=new Yr;return Po(e)?n.processItemsArray(e,i):e&&n.processItemsObject(e,n.namedItems,i),i.some(_o)&&i.sort(No),r.add(i),t&&t.forEach((e=>{n.remove(e),r.includes(e)||e._createdBy!==n||e.destroy()})),r}afterConstruct(){const{rtl:e}=this,{classList:t}=this.contentElement;t.toggle("b-rtl",!0===e),t.toggle("b-ltr",!1===e)}updateRtl(e){super.updateRtl(e);const{contentElement:t}=this;t&&(t.classList.toggle("b-rtl",!0===e),t.classList.toggle("b-ltr",!1===e))}updateItems(e,t){let n=0;e.forEach((e=>{this.onChildAdd(e),t&&!t.temporary&&this.layout.insertChild(e,n),++n})),this.initialItems=!1}updateHideWhenEmpty(){this.syncChildCount(this.rendered)}get items(){const e=this;if(e.getConfig("lazyItems"),!e._items){if(e.initializingItems)return[];e._items=new Yr,e._items.temporary=!0}return e._items.values}processItemsArray(e,t){const n=e.length;let i,r;for(i=0;i<n;i++)r=e[i],r instanceof Io?(r.parent=this,r.element.classList.remove(...Io.outerCls)):r=this.createWidget(r),r&&((r.ref||r.id)&&this.addDescendant(r),t.push(r))}processItemsObject(e,t,n){let i,r;for(r in e)i=e[r],i&&(t&&r in t&&(i="object"==typeof i?Nt.merge(Nt.clone(t[r]),i):t[r]),i&&(i instanceof Io?i.parent=this:(i instanceof Object&&(i.ref=r),i=this.createWidget(i)),i&&(i.ref=r,this.addDescendant(i),n.push(i))))}onChildAdd(e){if(e.innerItem&&this.readOnly&&!e.ignoreParentReadOnly&&(e.readOnly=!0),this.onChildAddLayout(e),e.ref||e.id)for(let t=this;t;t=t.parent)t.addDescendant(e);this.syncChildCount(!0)}onChildAddLayout(e){e.innerItem&&this.layout.onChildAdd(e)}onChildHide(e){var t;super.onChildHide(e),null!==(t=this._items)&&void 0!==t&&t.includes(e)&&this.syncChildCount(!0)}onChildShow(e){var t;super.onChildShow(e),null!==(t=this._items)&&void 0!==t&&t.includes(e)&&this.syncChildCount(!0)}syncChildCount(e){if(!this.isConfiguring){const t=this,{items:n,hasItems:i}=t,r=n.filter(jo),{length:s}=r;if(t.visibleChildCount=s,t.hideWhenEmpty&&e){const e=Boolean(!s);Boolean(t._hidden)!==e&&(t.hidden=e)}n.forEach((e=>e.element.classList.remove("b-last-visible-child","b-first-visible-child"))),s&&(r[0].element.classList.add("b-first-visible-child"),r[s-1].element.classList.add("b-last-visible-child")),t.hasItems=Boolean(t.childItems.length),t.contentElement.classList[s?"remove":"add"]("b-no-visible-children"),t.isComposable?i!==t.hasItems&&t.recompose():t.updateTextContent(t._textContent)}}syncFlexDirection(){const{contentElement:e,flexColCls:t,flexRowCls:n}=this,i=new gn(e.className),r=gi.getStyleValue(e,Vo);i[n]=i[t]=0,"flex"===r.display&&(i["row"===r["flex-direction"]?n:t]=1),gi.syncClassList(e,i)}addDescendant(e){const t=e.ref||e.id,n=this._widgetMap||(this._widgetMap={});n[t]||(n[t]=e)}onChildRemove(e){const t=this,n=e.ref||e.id;if(n)for(let i=t;i;i=i.parent)i.widgetMap[n]===e&&delete i.widgetMap[n];t.layout.onChildRemove(e),t.syncChildCount(!0)}get widgetMap(){return this._widgetMap||(this._widgetMap={}),this.initializingItems||this.getConfig("items"),this._widgetMap}changeRecord(e){return this._record=null==e?Ro:null,e}updateRecord(e){var t;const n=this;null===(t=n.recordUpdateDetacher)||void 0===t||t.call(n),n.trigger("beforeSetRecord",{record:e}),n.setValues(e,{onlyName:!0,highlight:Boolean(n.$highlight)}),n.autoUpdateFields&&null!=e&&e.firstStore&&(n.recordUpdateDetacher=e.firstStore.ion({update:n.onRecordUpdated,thisObj:n}))}setRecord(e,t){this.$highlight=t,this.record=e,this.$highlight=!1}onRecordUpdated({record:e}){e===this.record&&this.setValues(this.record,!0,!0)}onFieldChange({source:e,userAction:t}){if(this.autoUpdateRecord&&t){const{record:t}=this,{name:n,isValid:i=!0,value:r}=e;t&&n&&i&&(t[n]=r)}}getValues(e){const t={};return this.eachWidget(((n,i)=>{n.isolateFields?i.down=!1:!("name"in n)||e&&!e(n)||(t[n.name]=n.value)}),!0),t}get hasNoChildren(){const e=this,{items:t,lazyItems:n}=e.initialConfig,i=t&&(Po(t)?t:Nt.values(t)),r=n&&(Po(n)?n:Nt.values(n)),s=e.isConfiguring?r||i:e.items;return!(null!=s&&s.filter(jo).length)}afterRecompose(){super.afterRecompose(),this.realign()}updateTextContent(e){const t=this;if(!t.isComposable){const n=Boolean(e&&t.hasNoChildren),{classList:i}=t.contentElement;n!==i.contains("b-text-content")&&(i[n?"add":"remove"]("b-text-content"),t.rendered&&t.realign())}}updateLayoutStyle(e){gi.applyStyle(this.contentElement,e)}updateElement(e){if(super.updateElement(...arguments),e){const{classList:e}=this.contentElement,{containerCls:t}=this.layout;e.add("b-content-element"),t&&e.add(t)}}onPaint(){var e;null===(e=super.onPaint)||void 0===e||e.call(this,...arguments),this.getConfig("contentElMutationObserver")}changeContentElMutationObserver(e,t){if(t&&(t.takeRecords(),t.disconnect()),e){const t=this,{element:n,contentElement:i}=t;(e=new MutationObserver((e=>t.onContentElMutation(e)))).observe(i,{attributes:!0}),i!==n&&e.observe(n,{attributes:!0}),t.syncFlexDirection()}return e}onContentElMutation(){zo[this.layout.type]&&this.isVisible&&this.syncFlexDirection()}changeLayout(e,t){return ko.reconfigure(t,e,{owner:this,defaults:{owner:this}})}get childItems(){return this.items}getWidgetById(e){return this.widgetMap[e]}processWidgetConfig(e){}setupWidgetConfig(e,t){const n=this;"string"==typeof e?e={html:e}:e.nodeType===Element.ELEMENT_NODE&&(e={element:e,id:e.id}),("string"==typeof t||!t&&(t=e.type))&&(t=Io.resolveType(t,!0));for(let i=(e=(t||Io).mergeConfigs(n.defaults,e,{parent:n})).parent;i;i=i.parent)if(!1===i.processWidgetConfig(e))return null;return!1===n.trigger("beforeWidgetCreate",{widgetConfig:e})?null:e}createWidget(e){const t=Io.create(this.setupWidgetConfig(e),this.defaultType);return t&&(t._createdBy=this),t}updateDefaults(e,t){if(!this.isConfiguring&&e){const n=Object.entries(e);this.eachWidget((e=>{n.forEach((([n,i])=>{t&&e[n]!==t[n]||(e[n]=i)}))}),!1)}}render(){this.getConfig("lazyItems"),this.layout.renderChildren(),this.syncChildCount(),super.render(...arguments)}get focusElement(){const e=this.query(this.defaultFocus||(e=>{var t;return e.isFocusable&&"close"!==e.ref&&!(null!==(t=e.ref)&&void 0!==t&&t.endsWith("collapse"))}));return e?e.focusElement:super.focusElement}doDestroy(){var e;null===(e=this._items)||void 0===e||e.forEach((e=>{var t;return null===(t=e.destroy)||void 0===t?void 0:t.call(e)})),this.layout.destroy(),super.doDestroy()}get isValid(){let e=!0;return this.eachWidget((t=>{t.isVisible&&"isValid"in t&&!t.isValid&&(e=!1)}),!0),e}get values(){const e={};return this.gatherValue(e),e}set values(e){this.assignValue(e)}get isSettingValues(){return Boolean(this.assigningValues)}get assigningValues(){var e;return this._assigningValues||(null===(e=this.parent)||void 0===e?void 0:e.assigningValues)}set assigningValues(e){this._assigningValues=e}assignValue(e,t){super.assignValue(e,t),this.isolateFields||this.setValues(e,t)}gatherValue(e){super.gatherValue(e),this.isolateFields||this.gatherValues(e)}setValues(e,t){t=t||this.assignValueDefaults,this.assigningValues=t,this.eachWidget((n=>n.assignValue(e,t)),!1),this.assigningValues=!1}}Bo.initClass(),Bo._$name="Container";const{assign:Wo}=Nt,Ho=()=>performance.now(),Uo={start:!1},qo=/^[.\d]+([^\d].*)?$/,Yo=e=>{const t=e.$bryntum||(e.$bryntum={});return t.transitions||(t.transitions=Object.create(null))},Ko=(e,t)=>{var n;"string"==typeof e&&(t=null===(n=qo.exec(e))||void 0===n?void 0:n[1],e=parseFloat(e));return e&&e*("s"===t||!t&&e<10?1e3:1)},Go=e=>{const t=Nt.values(Yo(e)).filter((e=>null==e.completed)).map((e=>e.toString()));e.style.transition=t.join(", ")},Xo=e=>class extends e{static get prototypeProperties(){return{_delay:null,_duration:null,_retain:null,_timing:null,_unit:null,owner:null,reverting:null}}constructor(...e){super(...e),this.id=++Jo}start(){this.startTime=Ho()}get delay(){var e,t,n;return Ko(null!==(e=null!==(t=this._delay)&&void 0!==t?t:null===(n=this.owner)||void 0===n?void 0:n.delay)&&void 0!==e?e:0,this.unit)}set delay(e){this._delay=e}get duration(){var e;const{owner:t,unit:n}=this;return Ko(null!==(e=this._duration)&&void 0!==e?e:t?t.duration:Qo.defaultDuration,n)}set duration(e){this._duration=e}get elapsed(){return Ho()-this.startTime}get remaining(){return this.duration-this.elapsed}get retain(){var e,t;return null!==(e=this._retain)&&void 0!==e?e:null===(t=this.owner)||void 0===t?void 0:t.retain}set retain(e){this._retain=e}get timing(){var e,t;return null!==(e=this._timing)&&void 0!==e?e:null===(t=this.owner)||void 0===t?void 0:t.timing}set timing(e){this._timing=e}get unit(){var e,t;return null!==(e=this._unit)&&void 0!==e?e:null===(t=this.owner)||void 0===t?void 0:t.unit}set unit(e){this._unit=e}};let Jo=0;class Zo extends(de.mixin(Xo)){static get $name(){return"AnimatorTransition"}static get prototypeProperties(){return{element:null,property:null,from:null,to:null,completed:null,promissory:null,reverting:null}}afterConstruct(){super.afterConstruct();const e=this,{element:t,transitions:n}=e;let{property:i}=e;[i,e.to]=gi.unitize(i,e.to),e.from=gi.unitize(i,e.from)[1],e.promissory=new no,e.property=i;const r=n[i];n[i]=e;let{from:s}=e;r&&(e.from=r.to,s=null,r.destroy()),null===s&&(s=e.getCurrentStyleValue(),r||(e.from=s)),t.style[i]=s,e.getCurrentStyleValue()}doDestroy(){const e=this;e.finish(!1),e.completed&&!e.retain&&e.clearStyle(),super.doDestroy()}get promise(){var e;return null===(e=this.promissory)||void 0===e?void 0:e.promise}get transitions(){return Yo(this.element)}clearStyle(){this.setStyle("")}finish(e){const t=this,{transitions:n,promissory:i,property:r}=t;i&&(t.completed=e,t.promissory=null,i.resolve(e),n[r]===t?(delete n[r],e||(Go(t.element),t.clearStyle())):t.completed=!1)}getCurrentStyleValue(){return gi.getStyleValue(this.element,this.property)}revert(){const{duration:e,elapsed:t,element:n,from:i,property:r,_retain:s,_timing:o}=this;return new Zo({element:n,property:r,retain:s,timing:o,duration:Math.round(Math.min(e,t)),reverting:this,to:i,unit:"ms"})}setStyle(e){this.element.style[this.property]=e}start(){const e=this,{delay:t,duration:n,element:i,property:r}=e;En.onTransitionEnd({element:i,property:r,duration:t+n+20,thisObj:e.owner,handler:()=>{var t;return null===(t=e.finish)||void 0===t?void 0:t.call(e,!0)}}),super.start(),e.setStyle(e.to)}toString(){const{delay:e,duration:t,property:n,timing:i}=this;return`${n} ${t}ms ${i||"ease-in-out"}${e?` ${e}ms`:""}`}}Zo.initClass();class Qo extends(de.mixin(Xo)){static get $name(){return"Animator"}static get prototypeProperties(){return{element:null,finalize:null,prefinalize:null,completed:null,items:null}}static register(e,t){Nt.isObject(e)?Nt.entries(e).forEach((e=>Qo.register(...e))):(Qo.fx[e]=t,Qo[e]=t=>(gi.isElement(t)?t={element:t,[e]:{}}:delete(t={element:t.element,[e]:t})[e].element,Qo.run(t)))}static run(e){return new Qo(e).start()}constructor(e){var t;super(null);const n=this,i=[],r={};let s,o,l,a;if(Array.isArray(e))n.items=e;else for(l in e)(Qo.specialPropsRe.test(l)?n:r)[l]=e[l];Nt.keys(r).forEach((e=>{a=r[e],null!=a&&!1!==a&&a==a&&((o=Qo.fx[e])?(a=Wo(n.defaults,o(a,n,e)),a.owner=n,s=new Qo(a)):(a=Wo(n.defaults,"object"==typeof a?a:{to:a}),a.owner=n,a.property=e,s=new Zo(a)),i.push(s))})),null===(t=n.items)||void 0===t||t.forEach((e=>{Nt.isInstantiated(e)?e.owner=n:((e=Wo(n.defaults,e)).owner=n,e=new Qo(e)),i.push(e)})),n.items=i,n.promise=(1===i.length?i[0].promise:Promise.all(i.map((e=>e.promise)))).then((e=>{var t;return null===(t=n.finish)||void 0===t||t.call(n,e),n.completed||!1}))}doDestroy(){this.items.forEach((e=>e.destroy())),super.doDestroy()}get defaults(){return{element:this.element}}get retain(){const{_retain:e,finalize:t,owner:n}=this;return null!=e?e:!t&&(!n||n.retain)}set retain(e){super.retain=e}done(){return this.promise}finish(e){var t,n;const i=this,{items:r}=i;for(Go(i.element),i.completed="boolean"==typeof e?e:!e.some((e=>!e)),null===(t=i.prefinalize)||void 0===t||t.call(i,i.completed,i);r.length;)r.pop().destroy();null===(n=i.finalize)||void 0===n||n.call(i,i.completed,i)}revert(e){var t;const n=this,{reverting:i}=n,r=!e||null===(t=e.start)||void 0===t||t;let s=n.defaults;return i&&(i.finalize&&(s.finalize=i.finalize),i.prefinalize&&(s.prefinalize=i.prefinalize),s.retain=i._retain),s=Wo(s,e,{items:n.items.map((e=>e.revert(Uo))),reverting:n}),s=new Qo(s),r&&s.start(),s}start(){const{element:e,items:t}=this;return super.start(),t.length&&(Go(e),t.forEach((e=>e.start()))),this}}Qo.initClass().Transition=Zo,Qo.specialPropsRe=new RegExp(`^(?:${Object.keys(Qo.prototypeProperties).concat(Object.keys(Qo.superclass.prototypeProperties)).map((e=>"_"===e[0]?e.substr(1):e)).join("|")})$`),Qo.defaultDuration=200,Qo.fx={},Qo.register({puff:e=>(!0===e?e={}:"object"!=typeof e?e={transform:`scale(${e})`}:e.scale&&((e=Nt.clone(e)).transform=`scale(${e.scale})`,delete e.scale),Wo({opacity:0,transform:"scale(8)"},e))}),Qo._$name="Animator";class el extends(de.mixin(Pi)){static get configurable(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3,pressedCls:"b-pressed"}}doDestroy(){var e;null===(e=this.mousedownRemover)||void 0===e||e.call(this),this.cancel(),super.doDestroy()}cancel(){var e,t,n;const i=this;null===(e=i.activeElement)||void 0===e||e.classList.remove(i.pressedCls),i.activeElement=null,null===(t=i.acceleration)||void 0===t||t.cancel(),i.activeListenerRemover=null===(n=i.activeListenerRemover)||void 0===n?void 0:n.call(i),i.clearTimeout(i.autoRepeatTimer),i.clearTimeout(i.repeatTimer)}updateElement(e){var t;null===(t=this.mousedownRemover)||void 0===t||t.call(this),this.mousedownRemover=En.on({element:e,mousedown:"onMouseDown",thisObj:this})}onMouseDown(e){const t=this,n=t.delegate?e.target.closest(t.delegate):t.element;t.cancel(),n&&(t.activeElement=n,t.triggerEvent=e,n.classList.add(t.pressedCls),t.activeListenerRemover=En.on({mouseup:{element:document,capture:!0,handler:"onMouseUp"},mousemove:{element:n,handler:"onTargetMouseMove"},mouseleave:{element:n,handler:"onTargetMouseLeave"},mouseenter:{element:n,handler:"onTargetMouseEnter"},thisObj:t}),t.autoRepeatTimer=t.setTimeout("startAutoRepeat",t.delay))}onMouseUp(){this.cancel()}onTargetMouseLeave(){this.activeElement.classList.remove(this.pressedCls),this.clearTimeout(this.repeatTimer)}onTargetMouseEnter(e){const t=this;e.buttons?(t.activeElement.classList.add(t.pressedCls),t.triggerEvent=e,t.fireClick()):t.cancel()}onTargetMouseMove(e){this.triggerEvent=e}startAutoRepeat(){const e=this;e.interval=e.startInterval=1e3/e.startRate,e.accelerationDelta=e.startInterval-1e3/e.endRate,e.fireClick(),e.acceleration=be.animate(e.accelerateDuration,e.nextTick,e,"easeOutQuad")}nextTick(e){this.interval=this.startInterval-this.accelerationDelta*e}fireClick(){const e=this,t=new MouseEvent("click",e.triggerEvent);e.triggerEvent.target.dispatchEvent(t),e.repeatTimer=e.setTimeout(e.fireClick,e.interval)}}el._$name="ClickRepeater";const tl=/^(?:undefined|null|LEFT|RIGHT)$/,nl={TOP:"BOTTOM",RIGHT:"LEFT",BOTTOM:"TOP",LEFT:"RIGHT"},il=e=>{const t=null==e?void 0:e.toUpperCase();return[t,"LEFT"===t||"RIGHT"===t]};var rl=e=>class extends(e||de){static get $name(){return"Rotatable"}static get configurable(){return{rotate:null,invertRotate:null}}compose(){const{rotate:e}=this;return{class:{[`b-rotate-${(e||"").toLowerCase()}`]:e,"b-rotate-vertical":e}}}syncRotationToDock(e){if(tl.test(String(this.rotate))){const[t,n]=il(e);this.rotate=n?this.invertRotate?nl[t]:t:null}}get widgetClass(){return null}};class sl extends(Io.mixin(rl)){compose(){const{align:e,href:t}=this;return{tag:null!=t?"a":"button",class:{[`b-align-${e||"end"}`]:1,"b-icon":1},listeners:{click:"onInternalClick"}}}get focusElement(){return this.element}get panel(){var e,t;if(null!==(e=this.parent)&&void 0!==e&&e.isPanel&&null!==(t=this.element)&&void 0!==t&&t.parentNode.matches(".b-panel-header"))return this.parent}changeAlign(e){return e}onInternalClick(e){const t=this,{handler:n,panel:i}=t,r={domEvent:e,tool:t};t.disabled||(t.trigger("click",r),t.isDestroyed||(t.trigger("action",r),t.isDestroyed||!1===(null==i?void 0:i.trigger("toolClick",r))||n&&t.callback(n,i,[e,i,t])))}onInternalKeyDown(e){"Enter"===(e.key.trim()||e.code)&&(e.cancelBubble=!0,e.stopPropagation())}updateDisabled(e,t){var n;super.updateDisabled(e,t),e&&(null===(n=this.repeat)||void 0===n||n.cancel())}changeRepeat(e,t){return null==t||t.destroy(),e&&el.new({element:this.element},e)}}n(sl,"$name","Tool"),n(sl,"type","tool"),n(sl,"configurable",{align:{value:null,$config:{merge:"replace"}},href:null,repeat:null,defaultBindProperty:null}),sl.initClass(),sl._$name="Tool";const ol=/right/i,ll=e=>(e.collapsed||e.collapsing)&&"top"===e.owner.expandedHeaderDock&&e.owner.collapsible.direction.match(ol)?"start":"end";class al extends sl{static get $name(){return"CollapseTool"}static get type(){return"collapsetool"}static get configurable(){return{autoAlign:!0,collapsed:null,collapsing:null,collapsify:!1,direction:"up",defaultBindProperty:null}}compose(){const{collapsed:e,direction:t}=this;return{class:{[`b-icon-collapse-${t}`]:1,"b-collapsed":e}}}changeAutoAlign(e){return!0===e?ll:e}syncAutoAlign(){const{autoAlign:e}=this;e&&(this.align=e(this))}updateAutoAlign(){this.syncAutoAlign()}updateCollapsed(){this.syncAutoAlign()}updateCollapsing(){this.syncAutoAlign()}updateDirection(){this.syncAutoAlign()}}al.initClass(),al._$name="CollapseTool";const cl=/^(?:UP|DOWN|LEFT|RIGHT)$/,dl=/^(left|top)$/i,ul=[],hl=[ul,ul],gl=/^b-dock-(top|left|right|bottom)$/,ml="b-panel-collapse-revealer",pl=/^(?:left|right)$/i,fl="b-collapse-unflex",{round:vl}=Math,yl=["up","down","left","right"].reduce(((e,t)=>(e[t.toUpperCase()]=e[t]=t,e)),{}),bl={top:["top","bottom"],right:["right","left"],bottom:["bottom","top"],left:["left","right"]},Cl={hl:"LEFT",hr:"RIGHT",vb:"DOWN",vt:"UP"},wl={h:"w",w:"h"},El={up:"top",right:"right",down:"bottom",left:"left"},Sl={top:!1,right:!0,bottom:!1,left:!0},Tl={top:"UP",right:"RIGHT",bottom:"DOWN",left:"LEFT"},xl={top:e=>`translate(0, -${vl(e.height||0)}px)`,bottom:e=>`translate(0, ${vl(e.height||0)}px)`,right:e=>`translate(${vl(e.width||0)}px, 0)`,left:e=>`translate(-${vl(e.width||0)}px, 0)`};let Dl=0;class Ol extends(de.mixin(lr)){static get $name(){return"PanelCollapser"}static get type(){return"inline"}static get configurable(){return{animation:{duration:200},collapsed:{value:null,$config:null,default:!1},direction:null,collapseTooltip:"L{Collapse}",expandTooltip:"L{Expand}",panel:{value:null,$config:"nullify"},supportAxis:null,tool:{type:"collapsetool",handler(e){var t;null===(t=this.collapsible)||void 0===t||t.onCollapseClick(e)}}}}static get factoryable(){return{defaultType:"inline"}}get collapsing(){return"collapsing"===this.collapsingExpanding}get collapsingExpanding(){var e;const t=null===(e=this.currentOperation)||void 0===e?void 0:e.collapsing;return null==t?null:t?"collapsing":"expanding"}get currentDock(){var e,t,n,i;return null!==(e=null===(t=this.panel)||void 0===t||null===(n=t.header)||void 0===n||null===(i=n.dock)||void 0===i?void 0:i.toLowerCase())&&void 0!==e?e:"top"}get expanding(){return"expanding"===this.collapsingExpanding}get collapseTool(){var e,t;return null===(e=this.panel)||void 0===e||null===(t=e.tools)||void 0===t?void 0:t.collapse}get collapseDim(){return pl.test(this.collapseDir)?"width":"height"}getCollapseDir(e){let{direction:t,panel:n}=this;if(!t||cl.test(t)){const e=null==n?void 0:n.placement;var i;if(e)t=Cl[e];else t=Tl[(null==n||null===(i=n.header)||void 0===i?void 0:i.dock)||"top"]}return e?yl[t]:t}get collapseDir(){return this.getCollapseDir(!0)}get collapseDock(){return this.collapseInfo[0]}get collapseInfo(){const{panel:e}=this,t=e.hasHeader&&e.expandedHeaderDock;let n=El[this.collapseDir],i=!1;return t&&((i=Sl[n]!==Sl[t])||(n=t)),[n,i]}get toolsConfig(){const{direction:e,tool:t}=this;return t&&{collapse:Nt.assign({direction:e.toLowerCase()},t)}}beforeCollapse(e){const{panel:t}=this,{element:n}=t;n.contains(gi.getActiveElement(n))&&t.revertFocus(!0)}changeTool(e){const t=this,{panel:n}=t;if(t.isConfiguring||t.isDestroying||!n||n.isDestroying)return e;n.tools={collapse:e}}collapse(e){var t,n,i,r,s;const o=this,{panel:l}=o,a={id:++Dl,completed:!1,panel:l};let{currentOperation:c}=o;return e=null===(t=e)||void 0===t||t,Nt.isObject(e)&&(a.collapsed=!0,Nt.assign(a,e),e=a.collapsed,delete a.collapsed),a.collapsing=e,a.previous=null!==(n=c)&&void 0!==n?n:null,e!==o.collapsed?c?c.collapsing!==e&&(a.animation=c.animation.revert({finalize(){var e;null===(e=o.collapseFinalize)||void 0===e||e.call(o,a,!0)}}),a.collapsing=e,c=a):(a.animation=Nt.clone(("animation"in a?a:o).animation),!1!==o.beforeCollapse(a)&&(a.animation&&(a.animation.finalize=e=>{var t;return null===(t=o.collapseFinalize)||void 0===t?void 0:t.call(o,a,e)}),l.changingCollapse=!0,o[e?"collapseBegin":"expandBegin"](a),a.animation?c=a:(a.completed=!0,o[e?"collapseEnd":"expandEnd"](a)),l.changingCollapse=!1,a.animation||o.onComplete(e?"collapse":"expand"))):c&&c.collapsing!==e&&(o[e?"expandRevert":"collapseRevert"](a),a.animation=c.animation.revert({finalize(){var e;null===(e=o.collapseFinalize)||void 0===e||e.call(o,a,!1)}}),c=a),o.currentOperation=c,null!==(i=null===(r=c)||void 0===r||null===(s=r.animation)||void 0===s?void 0:s.done())&&void 0!==i?i:Promise.resolve(e===o.collapsed)}collapseFinalize(e,t){const n=this,{currentOperation:i,panel:r}=n,s=r.collapsed?"expand":"collapse";i===e&&(n.currentOperation=null,e.completed=t,r.changingCollapse=!0,n[s+"End"](e),r.changingCollapse=!1,t&&n.onComplete(s))}applyHeaderDock(e,t=!0){const{currentDock:n,panel:i}=this,r=e?this.collapseDock:i.expandedHeaderDock;r!==n&&i.hasHeader&&(i.header={dock:r},t&&i.recompose.flush())}composeHeader(e){const{panel:t}=this,{class:n}=e,i=t.expandedHeaderDock||Object.keys(n).filter((e=>n[e]&&gl.test(e))).map((e=>gl.exec(e)[1][0]));return n[ml]=1,n[`b-collapsible-${i[0]}${this.collapseDir[0]}`]=1,e}composeTitle(e){return e.class[ml]=1,e}collapseBegin(e){var t;const n=this,{animation:i}=e,{collapseDim:r,collapseTool:s,panel:o}=n,{element:l,placement:a}=o,[c,d]=n.collapseInfo,u=null==s?void 0:s.element.classList,h=!a||"h"===a[0]&&"width"===r||"v"===a[0]&&"height"===r;n.configuredWidth=o._lastWidth,n.configuredHeight=o._lastHeight,n.transverseCollapse=d,n.applyHeaderDock(!0);const g=o.rectangle(),m=n.lockInnerSize().moveTo(0,0),p=m.clone(),f=bl[c],v=null===(t=o.headerElement)||void 0===t?void 0:t.getBoundingClientRect(),y=vl((null==v?void 0:v[r])||0);l.classList.toggle(fl,h),i?(p[f[0]]=p[f[1]],l.classList.add("b-collapsing"),null==u||u.add("b-collapsed","b-collapsing"),s&&(s.collapsing=!0),u&&(u.remove("b-collapsed"),o.rectangle(),u.remove("b-collapsing"),u.add("b-collapsed")),i.element=l,i.retain=!0,i[r]={from:vl(g[r]),to:y},i.items=[{element:n.innerElement,retain:!1,clip:{from:`rect(${m})`,to:`rect(${p})`}}],d&&i.items.push({element:o.headerElement,duration:i.duration,retain:!1,transform:{from:xl[c](v),to:"translate(0, 0)"}}),e.animation=Qo.run(i)):(l.style[r]=`${y}px`,s&&(u.add("b-collapsing","b-collapsed"),s.rectangle(),u.remove("b-collapsing")))}collapseEnd(e){const t=this,{collapseTool:n}=t;t.panel.element.classList.remove("b-collapsing"),n&&(n.collapsing=!1),e.completed?t.collapsed=!0:(t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}collapseRevert(e){var t;null===(t=this.collapseTool)||void 0===t||t.element.classList.remove("b-collapsed")}expandBegin(e){const t=this,{animation:n}=e,{collapseDim:i,collapseTool:r,panel:s}=t,[o,l]=t.collapseInfo,{element:a}=s,c=a.classList,d=c.contains(fl),u=s.rectangle();c.remove("b-collapsed","b-collapsing"),s.element.style[i]="",t.restoreConfiguredSize(),t.lockInnerSize(!1);const h=s.rectangle(),g=t.lockInnerSize().moveTo(0,0),m=g.clone(),p=bl[t.collapseDock];null==r||r.element.classList.remove("b-collapsed"),n&&(m[p[0]]=m[p[1]],c.add("b-collapsed","b-expanding"),d&&c.add(fl),n.element=a,n[i]={from:vl(u[i]),to:vl(h[i])},n.items=[{element:t.innerElement,retain:!1,clip:{from:`rect(${m})`,to:`rect(${g})`}}],l&&n.items.push({element:s.headerElement,duration:n.duration,retain:!1,transform:{from:"translate(0, 0)",to:xl[o](u)}}),e.animation=Qo.run(n))}expandEnd(e){const t=this;t.panel.element.classList.remove("b-expanding"),e.completed&&(t.collapsed=!1,t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}expandRevert(e){var t;null===(t=this.collapseTool)||void 0===t||t.element.classList.add("b-collapsed")}get innerElement(){return this.panel.collapseWrapElement||this.panel.bodyWrapElement}get innerSizeElement(){return this.transverseCollapse?this.panel.element:this.innerElement}get supportAxis(){let{_supportAxis:e}=this;const t=!0===e;return(t||null==e)&&(e=this.collapseDim[0],(t||"absolute"===gi.getStyleValue(this.panel.element,"position"))&&(e+=wl[e])),e||""}lockInnerSize(e=!0){const t=this,{innerElement:n,panel:i}=t,r=e?t.supportAxis:"",s=i.element,o=i.headerElement,l=e&&o&&dn.from(o,s),a=e&&dn.from(t.innerSizeElement,s),c=n.style;return o&&(o.style.minWidth=r.includes("w")?`${l.width}px`:"",o.style.minHeight=r.includes("h")?`${l.height}px`:""),c.width=e?`${a.width}px`:"",c.height=e?`${a.height}px`:"",n.classList[e?"add":"remove"]("b-panel-collapse-size-locker"),a}onCollapseClick(e){let t=!this.collapsing&&(!!this.expanding||!this.collapsed);e.altKey&&(t={animation:null,collapsed:t}),this.collapse(t)}onComplete(e){var t;null===(t=this.panel)||void 0===t||t.trigger(e)}onHeaderClick({event:e}){0===e.button&&this.panel.collapsed&&e.target.classList.contains(ml)&&this.onRevealerClick()}onPanelConfigChange({name:e,value:t}){const n=this,{panel:i}=n;"collapsed"===e?i.isPainted&&(n.collapsed=t):"header"!==e||i.changingCollapse||n.syncDirection()}onPanelPaint(){this.syncDirection(),this.panel.collapsed&&!this.collapsed&&this.collapse({animation:null,collapsed:!0})}onRevealerClick(){this.panel._collapse({collapsed:!1})}restoreConfiguredSize(e){var t;const{configuredHeight:n,configuredWidth:i,panel:r}=this;e=null!==(t=e)&&void 0!==t?t:"wh",r.element.classList.remove(fl),null!=i&&e.includes("w")&&(r.width=i),null!=n&&e.includes("h")&&(r.height=n)}splitHeaderItems(){return hl}syncDirection(){const e=this,{direction:t}=e;t&&!cl.test(t)||(e.direction=e.getCollapseDir())}updateCollapsed(e){const{collapseTool:t,panel:n}=this;n&&(n.collapsed=e,n.element.classList[e?"add":"remove"]("b-collapsed")),t&&(t.collapsed=e)}updateDirection(e){const{collapseTool:t,panel:n}=this;t&&(t.direction=yl[e]),null!=n&&n.rendered&&n.recompose()}updatePanel(e){var t;const n=this;n.syncDirection(),null===(t=n.panelChangeDetacher)||void 0===t||t.call(n),n.panelChangeDetacher=e&&be.after(e,"onConfigChange","onPanelConfigChange",n,{return:!1})}wrapCollapser(e,n){var i;const r=this,[s,o]=r.collapseInfo;if(!o)return[e,n];const{collapseDir:l,panel:a}=r,{expandedHeaderDock:c,header:d,uiClassList:u}=a,h=null===(i=a.tools)||void 0===i?void 0:i.recollapse,[g,m]=r.splitHeaderItems({dock:s,as:"element"}),p=a.hasHeader?a.title||(null==d?void 0:d.title)||" ":null,f=p&&{tag:"header",class:new gn(t(t({},u),{},{[`b-dock-${c}`]:1,"b-panel-header":1,"b-panel-collapser-header":1}),null==d?void 0:d.cls),children:[...g,{reference:"collapserTitleElement",html:p,class:t(t({},u),{},{[`b-align-${(null==d?void 0:d.titleAlign)||"start"}`]:1,"b-header-title":1})},...m]};return h&&(h.direction=l),["collapseWrapElement",{class:t(t({},u),{},{[`b-panel-collapser-header-${c}`]:1,[`b-panel-collapser-${l}`]:1,[`b-${Sl[c]?"h":"v"}box`]:1,"b-panel-collapser":1,"b-box-center":1}),children:dl.test(c)?{collapserHeaderElement:f,[e]:n}:{[e]:n,collapserHeaderElement:f}}]}}Ol.maps={clipByDock:bl,dockByDirection:El,dockIsHorz:Sl},Ol.initClass(),Ol._$name="PanelCollapser";const Ml=Symbol("pendingCreate");class Il extends de{static get prototypeProperties(){return{cleanup:null,configName:null,created:null,factory:null,inferType:"name",owner:null,ownerName:null,proxyable:"undefined"!=typeof Proxy,setup:null,transform:null}}static get properties(){return{defaults:{},instances:{},object:Object.create({})}}get proxy(){const e=this;let t=null;return e.proxyable&&(t=new Proxy(e.instances,{get:(t,n)=>e.get(n),set:(t,n,i)=>(e.set(n,i),!0),deleteProperty:(t,n)=>(e.set(n,null),!0)})),Reflect.defineProperty(e,"proxy",{configurable:!0,value:t}),t}get target(){return this.proxy||this.object}define(e,t){const n=this,{transform:i}=n,r=i?i(t,e):t,s=Nt.isInstantiated(r);n.instances[e]=Ml,s||n.setDefaults(e,r),n.defineProp(e,!0),s&&n.set(e,r)}defineProp(e,t){const n=this,{object:i}=n;n.proxy||Reflect.defineProperty(t?Object.getPrototypeOf(i):i,e,{configurable:!t,enumerable:!0,get:()=>n.get(e),set:t=>n.set(e,t)})}flush(){const e=this;try{var t;e.updating=!0;for(const t in e.defaults)e.get(t);e.afterConfigureOwner=null===(t=e.afterConfigureOwner)||void 0===t?void 0:t.call(e)}finally{e.updating=!1}}get(e){const{defaults:t,instances:n}=this;return n[e]===Ml&&this.set(e,Ml),n[e]||t[e]&&null}set(e,n){const i=this,{cleanup:r,configName:s,defaults:o,factory:l,instances:a,owner:c,setup:d,transform:u,updating:h}=i,g=c&&s&&!h,m=a[e]===Ml?null:a[e],p=l.reconfigure(m,n===Ml?{}:n||null,{cleanup:r&&(t=>r(t,e)),defaults:o[e]||i.setDefaults(e,{}),owner:i.owner,setup:d&&((t,n,i)=>d(t,e,n,i)),transform:u&&(t=>u(t,e))});if(p!==m){const n=g&&t({},a);var f;if(a[e]=p,p)i.defineProp(e),null===(f=i.created)||void 0===f||f.call(i,p,e);else delete i.object[e],delete a[e];g&&c.onConfigChange({name:s,config:c.$meta.configs[s],value:i.target,was:n})}}setDefaults(e,t){const{defaults:n,factory:i,inferType:r,instances:s,owner:o,ownerName:l}=this,{typeKey:a}=i.factoryable;return t=!0===t?{}:Nt.assign({},t),("name"===r||!0===r&&!t[a])&&(t[a]=e),l&&(t[l]=o),t.beforeConfigure=t=>{s[e]=t},n[e]=t}update(e){const t=this,{owner:n}=t;let i,r;try{if(t.updating=!0,e)for(i in e)r=e[i],t.defaults[i]?t.set(i,r):r&&t.define(i,r);else for(i in t.instances)t.set(i,null)}finally{t.updating=!1}n&&(n.isConfiguring?t.afterConfigureOwner||(t.afterConfigureOwner=be.before(n,"afterConfigure","flush",t)):t.flush())}}Il.initClass(),Il._$name="DynamicObject";const Fl=[],kl={},Ll={align:1,weight:1};var Al=e=>class extends(e||Io){static get $name(){return"Toolable"}static get configurable(){return{tools:{value:null,$config:{nullify:!0}},toolDefaults:{"*":{type:"tool",align:"end"}}}}byWeightSortFn(e,t){return(e.weight||0)-(t.weight||0)}byWeightReverseSortFn(e,t){return(t.weight||0)-(e.weight||0)}gatherTools({align:e,overlay:t,refs:n}=kl){const{collapsed:i,tools:r}=this;let s,o,l,a,c,d=[];for(o in r){var u,h,g,m,p;c=r[o],s=null!==(u=null!==(h=null===(g=c)||void 0===g||null===(m=g.align)||void 0===m?void 0:m.align)&&void 0!==h?h:null===(p=c)||void 0===p?void 0:p.align)&&void 0!==u?u:"end",s===e&&c.isCollapsified(i,t)&&d.push(c)}if(d.sort(this["end"===e?"byWeightReverseSortFn":"byWeightSortFn"]),n){const e="widget"===n,t={};for(l=0;l<d.length;++l)a=d[l],t[a.ref]=e?a:a.element;d=t}return d}getEndTools({overlay:e,refs:t}=kl){return this.gatherTools({align:"end",overlay:e,refs:t})}getStartTools({overlay:e,refs:t}=kl){return this.gatherTools({align:"start",overlay:e,refs:t})}get childItems(){return[...this.getStartTools(),...this._items||Fl,...this.getEndTools()]}changeTools(e,t){const n=this,i=n.$tools||(n.$tools=new Il({configName:"tools",factory:Io,inferType:!1,owner:n,created(e){var t,r;e.innerItem=!1,null===(t=e.syncRotationToDock)||void 0===t||t.call(e,null===(r=n.header)||void 0===r?void 0:r.dock),be.after(e,"onConfigChange",((e,{name:t})=>{Ll[t]&&n.onConfigChange({name:"tools",value:i.target})})),n.onChildAdd(e)},setup:(e,t)=>((e=Nt.merge({},n.toolDefaults["*"],n.toolDefaults[t],e)).parent=n,e.ref=t,e)}));if(i.update(e),!t)return i.target}get widgetClass(){}};const $l=["b-hbox","b-vbox"],Rl={name:"align",style:"alignItems"},Pl={name:"contentAlign",style:"alignContent"},_l={name:"direction",style:"flexDirection"},Nl={name:"justify",style:"justifyContent",classes:["stretch"]},jl={name:"wrap",style:"flexWrap",map:{false:"nowrap",true:"wrap",reverse:"wrap-reverse"}};class Vl extends ko{get vertical(){return!1===this.horizontal}set vertical(e){return this.horizontal=!e}updateAlign(){this.syncConfigStyle(Rl)}updateContentAlign(){this.syncConfigStyle(Pl)}updateDirection(){this.syncConfigStyle(_l)}updateHorizontal(){var e;const t=this,n=null===(e=t.contentElement)||void 0===e?void 0:e.classList,i=Number(t.vertical);n?(n.remove($l[1-i]),n.add($l[i])):t.syncConfigLater("horizontal"),t.syncDirection()}updateJustify(){this.syncConfigStyle(Nl)}updateReverse(){this.syncDirection()}updateWrap(){this.syncConfigStyle(jl)}syncDirection(){const e=this,{reverse:t}=e;e.direction=t?`${e.vertical?"column":"row"}${t?"-reverse":""}`:null}}n(Vl,"$name","Box"),n(Vl,"type","box"),n(Vl,"alias","hbox"),n(Vl,"configurable",{itemCls:"b-box-item",align:null,contentAlign:null,direction:null,horizontal:!0,justify:null,reverse:null,wrap:null}),Vl.initClass(),Vl._$name="Box";class zl extends Vl{}n(zl,"$name","VBox"),n(zl,"type","vbox"),n(zl,"configurable",{horizontal:!1}),zl.initClass(),zl._$name="VBox";var Bl=e=>class extends(e||de){static get $name(){return"Badge"}static get configurable(){return{badge:null}}compose(){const{badge:e}=this;return{dataset:{badge:e},class:{"b-badge":null!=e&&""!==e}}}};const Wl=/(?:^|\s)b-icon-/,Hl=/(?:^|\s)b-fa-/,Ul=Symbol("defaultToggleable"),ql=["items","type","widgets","html","listeners"],Yl=Symbol("defaultListener");class Kl extends(Io.mixin(Bl,rl)){static get $name(){return"Button"}static get type(){return"button"}static get configurable(){return{icon:null,menuIcon:"b-icon-picker",pressedIcon:null,iconAlign:"start",text:{value:null,$config:null,default:""},color:null,toggleable:Ul,pressed:!1,toggleGroup:null,ripple:{radius:75},forwardTwinEvents:["action","toggle"],localizableProperties:["text"],menu:{$config:["lazy","nullify"],value:null},menuDefaults:{type:"menu",autoShow:!1,autoClose:!0,floating:!0,scrollAction:"realign",align:"t0-b0"},href:null,target:null,defaultBindProperty:null}}updateElement(e,t){var n,i,r;const s=this,{constructor:o}=s,l=super.updateElement(e,t),a=s.peekConfig("menu"),c=!!a&&(a.isWidget?a.role:(null===(n=o.resolveType(a.type))||void 0===n||null===(i=n.configurable)||void 0===i?void 0:i.role)||(null===(r=o.configurable.menuDefaults)||void 0===r?void 0:r.type)||"menu");return s.ariaHasPopup=c,l}compose(){const{color:e,href:n,icon:i,iconAlign:r,pressed:s,pressedIcon:o,target:l,text:a,toggleable:c,toggleGroup:d,menuIcon:u}=this,h=this.hasConfig("menu"),g=s&&o?o:i;return{tag:n?"a":"button",href:n,target:l,class:{[`b-icon-align-${r}`]:i,[e]:Boolean(e),"b-pressed":s&&c,"b-text":Boolean(a),"b-has-menu":h},"aria-pressed":s,dataset:{group:d},listeners:{click:"onInternalClick",mousedown:"onInternalMousedown"},children:{iconElement:(i||o)&&{"aria-hidden":!0,tag:"i",class:t(t({},gn.normalize(g,"object")),{},{"b-icon":Wl.test(g),"b-fa":Hl.test(g)})},label:a&&{tag:"label",text:a},menuIconElement:h&&u&&{tag:"i",class:{"b-icon":Wl.test(u),"b-fa":Hl.test(u),"b-button-menu-icon":1,[u]:1}}}}}configureOverflowTwin(e){const t=this,n=super.configureOverflowTwin(e);return n.text||(n.text=t.tooltipText),n}onHide(){var e;null===(e=this._menu)||void 0===e||e.hide()}get childItems(){return this._menu&&[this.menu]}onFocusOut(e){var t;super.onFocusOut(e),null===(t=this.menu)||void 0===t||t.hide()}get focusElement(){return this.element}changeText(e){return null==e?"":e}changeToggleable(e){return e===Ul?this.toggleGroup||this.config.menu:e}changeMenu(e,t){const n=this,{element:i}=n;return e?(e.isWidget?(e.forElement=i,e.owner=n,e.constrainTo=n.rootElement):("object"!=typeof e||ql.some((t=>t in e))||(e={lazyItems:e}),e=Io.reconfigure(t,e?Nt.merge({owner:n,constrainTo:n.rootElement,forElement:i},n.menuDefaults,e):null,n)),e.align.constrainPadding=10,n.detachListeners(Yl),e.ion({name:Yl,beforeShow:"onMenuBeforeShow",hide:"onMenuHide",show:"onMenuShow",thisObj:this})):null==t||t.destroy(),e}onMenuBeforeShow({source:e}){return this.trigger("beforeShowMenu",{menu:e})}onMenuShow(){this.ariaElement.setAttribute("aria-expanded",!0)}onMenuHide(){this.ariaElement.setAttribute("aria-expanded",!1),this.toggle(!1)}updateMenu(e){this.toggleable=Boolean(e)}updatePressed(e){const t=this;if(!t.toggleable||t.isConfiguring)return;const{menu:n}=t;var i,r;(e&&gi.forEachSelector(t.rootElement,`button[data-group=${t.toggleGroup}]`,(e=>{e!==t.element&&(Io.getById(e.id).pressed=!1)})),n)&&(n.initialConfig.minWidth||(n.minWidth=t.width),n.align.minHeight=null!==(i=n._minHeight)&&void 0!==i?i:100,n.align.minWidth=null!==(r=n._minWidth)&&void 0!==r?r:100,n[e?"show":"hide"]());t.trigger("toggle",{pressed:e})}onInternalMousedown(e){var t;null!==(t=this._menu)&&void 0!==t&&t.containsFocus&&this.pressed&&e.preventDefault()}onInternalClick(e){const t=this,n={event:e};if(!t.disabled){if(t.toggleable){if(t.toggleGroup&&t.pressed)return;if(t.toggle(!t.pressed),t.isDestroyed)return}t.trigger("click",n),t.isDestroyed||t.trigger("action",n),t.href||(e.preventDefault(),e.stopPropagation())}}toggle(e=!this.pressed){!1!==this.trigger("beforeToggle",{pressed:e})&&(this.pressed=e)}}Kl.initClass(),Kl._$name="Button";const Gl={refs:"element"},Xl=e=>e.element.style.margin="",Jl=e=>e.isToolbar,Zl=e=>e[0]+(e[1].minifiable?0:9e9),Ql={hidden:!1,width:""},ea=t(t({},Ql),{},{flex:""}),ta=[{box:"hbox",clientSizeProp:"clientWidth",edgeProp:"right",flexDir:"row",horizontal:!0,max:"maxX",overflow:"overflowX",pos:"x",scrollSize:"scrollWidth",sizeProp:"width"},{box:"vbox",clientSizeProp:"clientHeight",edgeProp:"bottom",flexDir:"column",horizontal:!1,max:"maxY",overflow:"overflowY",pos:"y",scrollSize:"scrollHeight",sizeProp:"height"}],na={delay:0,startRate:40,endRate:200,accelerateDuration:500},ia={menu:1,pressed:1};class ra extends(Bo.mixin(Al)){static get $name(){return"Toolbar"}static get type(){return"toolbar"}static get delayable(){return{syncOverflowVisibility:{type:"raf",cancelOutstanding:!0}}}static get configurable(){return{defaultType:"button",dock:"top",layout:{type:"box"},overflow:{$config:["lazy","nullify"],value:{type:"menu"}},toolDefaults:{overflowMenuButton:{type:"button",hidden:!0,icon:"b-icon-menu",menuIcon:null,defaultCls:{"b-overflow-button":1}},overflowScrollEnd:{handler:"up.onEndScrollClick",hidden:!0,defaultCls:{"b-icon-angle-right":1,"b-overflow-button":1,"b-icon":1}},overflowScrollStart:{align:"start",handler:"up.onStartScrollClick",hidden:!0,defaultCls:{"b-icon-angle-left":1,"b-overflow-button":1,"b-icon":1}}},widgetCls:null,ignoreParentReadOnly:!0}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}static getEvictionList(e){const t=e.filter((e=>"none"!==e.overflowable));return t.forEach(((e,n)=>t[n]=[n,e])),t.sort(((e,t)=>Zl(t)-Zl(e))),t}compose(){const e=this,{axisProps:n,dock:i}=e,r=e.getEndTools(Gl),s=e.getStartTools(Gl);return{class:{[`b-dock-${i}`]:1,[`b-${i}-toolbar`]:1,[`b-${n.box}`]:1},children:t(t({},s),{},{toolbarContent:{class:{"b-box-center":1,"b-toolbar-content":1}}},r)}}get axisProps(){return ta[this.layout.horizontal?0:1]}get contentElement(){return this.toolbarContent}get overflowMenuButton(){var e;return null===(e=this.tools)||void 0===e?void 0:e.overflowMenuButton}get overflowType(){const{overflow:e}=this;return"string"==typeof e?e:null==e?void 0:e.type}onChildAdd(e){var t;super.onChildAdd(e),this.processAddedLeafItem(e),null===(t=e.syncRotationToDock)||void 0===t||t.call(e,this.dock)}onChildRemove(e){super.onChildRemove(e),this.syncOverflowVisibility()}processAddedLeafItem(e){be.after(e,"onConfigChange",this.onLeafItemConfigChange,e),e.isContainer&&e.eachWidget((e=>this.processAddedLeafItem(e)))}onPaint({firstPaint:e}){var t;null===(t=super.onPaint)||void 0===t||t.call(this,...arguments),e&&this.getConfig("overflow")}updateDock(e){const t=this,{layout:n}=t,{vertical:i}=n;if(n.vertical=il(e)[1],!t.initialItems){i!==n.vertical&&t.updateOverflow(t.overflow);for(const n of t.childItems){var r;null===(r=n.syncRotationToDock)||void 0===r||r.call(n,e)}}}updateOverflow(e,t){var n;const i=this,{axisProps:r,contentElement:s,overflowType:o}=i,{flexDir:l}=r,a=null===(n=i.overflowMenuButton)||void 0===n?void 0:n._menu,c={};var d;if(a&&(e?null==a||a.removeAll():a.eachWidget((e=>{e._overflowTwinOrigin.overflowTwin=null}))),"menu"===t?c.overflowMenuButton=null:"scroll"===t&&(c.overflowScrollStart=c.overflowScrollEnd=null),"menu"===o)null===(d=i.scrollable)||void 0===d||d.destroy(),s.style.overflow=s.style.overflowX=s.style.overflowY="",c.overflowMenuButton={cls:{[`b-${l}-menu`]:1}};else if("scroll"===o){const t="object"==typeof e&&(null==e?void 0:e.repeat)||na;i.scrollable={[r.overflow]:"hidden-scroll",element:s,internalListeners:{scroll:"onContentScroll",thisObj:i}},c.overflowScrollStart={repeat:t,invertRotate:!0,cls:{[`b-${l}-start-scroller`]:1}},c.overflowScrollEnd={repeat:t,invertRotate:!0,cls:{[`b-${l}-end-scroller`]:1}}}i.tools=c,o?(s.classList.add("b-overflow"),i.monitorResize=!0,i.syncOverflowVisibility()):(s.classList.remove("b-overflow"),i.monitorResize=!1)}onContentScroll(){this.syncScrollerState()}onStartScrollClick(){this.scrollable[this.axisProps.pos]-=2}onEndScrollClick(){this.scrollable[this.axisProps.pos]+=2}onInternalResize(){super.onInternalResize(...arguments),this.isPainted&&this.syncOverflowVisibility()}syncOverflowVisibility(){const e=this,{overflowType:t,contentElement:n,isVisible:i}=e,{clientSizeProp:r,edgeProp:s,sizeProp:o}=e.axisProps,{overflowMenuButton:l,overflowScrollStart:a,overflowScrollEnd:c}=e.tools,d=e.rtl&&e.layout.horizontal,u="menu"===t,h=()=>Math.ceil(n[r]+(!a||a.hidden?0:a.rectangle("outer")[o])+(!c||c.hidden?0:c.rectangle("outer")[o])),g=()=>{if(0===x.length)return 0;const e=x[x.length-1].rectangle(n);return Math.floor(d?n[r]-e.left:e[s])};let m,p,f,v,y,b,C,w,E,S,T,x;if(i&&t&&0!==e.items.length){if(e.inSyncOverflowVisibility=!0,null==l||l.hide(),e.eachWidget(((e,t)=>{C=e.minifiable,S=e.overflowable,S=C?S||C:S,e.floating?t.down=!1:(t.down=!S,e.innerItem&&(e._toolbarOverflow&&(e.hidden=e._toolbarOverflow=!1),e._toolbarMinified&&(e.minified=e._toolbarMinified=!1),e.isVisible&&(C&&(w||(w=[])).push(e),S&&(x||(x=[])).push(e))))})),x&&(m=h(),p=g()),x&&p>m)if(u){for(;p>m&&(y=null===(D=w)||void 0===D?void 0:D.pop());){var D;b=p,y._toolbarMinified=!0,y.minified=!0,p=g(),b-=p,(E||(E=[])).push([y,b])}if(p>m){for(f of(l.show(),m=h(),v=ra.getEvictionList(x),v))p>m&&(y=f[1],y._toolbarOverflowWidth=y.width,y._toolbarOverflow=!0,y.hidden=!0,x.splice(x.indexOf(y),1),(T||(T=[])).push(f),p=g());if(T){for(T.sort(((e,t)=>e[0]-t[0])).forEach(((e,t)=>T[t]=e[1]));null!==(O=E)&&void 0!==O&&O.length;){var O;[y,b]=E.pop(),p+b<=m&&!y._toolbarOverflow&&(p+=b,y.minified=y._toolbarMinified=!1)}e.syncOverflowMenuButton(T)}else l.hide()}}else c.show(),a.show(),e.syncScrollerState();else u||(null==c||c.hide(),null==a||a.hide());e.inSyncOverflowVisibility=!1}}syncOverflowMenuButton(e){var t;const n=this,{axisProps:i,overflowMenuButton:r}=n,s={cls:"b-toolbar-overflow-menu",minWidth:280,items:[],align:{align:i.horizontal?"t100-b100":"r100-l100",axisLock:"flexible"}};if(n.addToMenu(s,e.filter((e=>n.overflowItemFilter(e)))),null!==(t=r._menu)&&void 0!==t&&t.isMenu){const e=r.menu,{toAdd:t,toRemove:n}=he.delta(s.items,e.items,1);if(e.remove(n),e.items.length)for(let n=t.length-1;n>=0;n--)e.insert(t[n],0);else e.add(t)}else r.menu=s}syncScrollerState(){const{axisProps:e,scrollable:t}=this,{overflowScrollStart:n,overflowScrollEnd:i}=this.tools,r=t[e.pos],s=t[e.max];n.disabled=!r,i.disabled=Math.abs(Math.ceil(r))>=Math.abs(s)}overflowItemFilter(e){const{filter:t}=this.overflow;return Boolean(t?t.call(this,e):gi.getChildElementCount(e.element))}addToMenu(e,t){const n=this.horizontal?ea:Ql;for(const i of t){const t=i.ensureOverflowTwin(n,Xl);e.items.push(t)}}onLeafItemConfigChange(e,{name:t,value:n}){const i=this,r=i.up(Jl),s=r.hasConfig("overflow"),{overflowTwin:o}=i;!s||null!=r&&r.inSyncOverflowVisibility||"hidden"===t&&n===i._toolbarOverflow||(o&&!ia[t]&&(o[t]=n),null!=r&&r.isPainted&&"overflowMenuButton"!==i.ref&&(i.isTextField&&"value"===t&&(i.containsFocus||null!=o&&o.containsFocus)||r.syncOverflowVisibility()))}createWidget(e){"->"===e?e={type:"widget",cls:"b-toolbar-fill"}:"|"===e?e={type:"widget",cls:"b-toolbar-separator"}:"string"==typeof e&&(e={type:"widget",cls:"b-toolbar-text",html:e});const t=super.createWidget(e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}}ra.initClass(),ra._$name="Toolbar";const sa=e=>!e.classList.contains("b-focus-trap")&&gi.isFocusable(e)?gi.NodeFilter.FILTER_ACCEPT:gi.NodeFilter.FILTER_SKIP,oa=[],la={},aa=[oa,oa],ca=(e,n,i)=>{const{vertical:r}=e;return delete e.vertical,t(t({},e),{},{class:t(t({},n),{},{[`b-${r?"v":"h"}box`]:1,"b-box-center":1,"b-panel-bar-wrap":!i})})},da=(e,t,n=!1)=>{const i={vertical:n,children:e?[e]:[]};return t&&(i.tag=t),i},ua={dock:1,hidden:1,weight:1},ha={top:[!0,!0],bottom:[!0,!1],left:[!1,!0],right:[!1,!1]},ga={header:1,"pre-header":1};class ma extends(Bo.mixin(Ui,Al)){static get $name(){return"Panel"}static get type(){return"panel"}static get configurable(){return{localizableProperties:["title"],collapsed:{value:null,$config:null,default:!1},collapsible:{value:null,$config:"nullify"},bodyCls:{$config:{merge:"classList"},value:null},bodyTag:null,bodyWrapTag:null,trapFocus:null,title:null,header:null,stateful:["collapsed"],stripDefaults:{"*":{type:"toolbar",dock:"top"},bbar:{dock:"bottom",weight:-1e3},tbar:{weight:-1e3}},strips:{value:null,$config:"nullify"},toolDefaults:{close:{weight:-1e3},collapse:{weight:-990}},footer:null,revealed:null,tbar:null,bbar:null,role:"region"}}updateElement(e,t){const n=super.updateElement(e,t);return this.titleElement&&gi.setAttributes(this.ariaElement,{"aria-describedby":this.titleElement.id}),n}compose(){const e=this,{collapsible:t,focusable:n,hasItems:i,revealed:r,tools:s}=e,o=e.composeHeader(),l=(null==o?void 0:o.class["b-dock-left"])||(null==o?void 0:o.class["b-dock-right"]);let a=e.composeBody(),c="bodyWrapElement";return t&&([c,a]=t.wrapCollapser(c,a)),{tabIndex:i&&!1!==n||n?0:null,class:{[`b-panel-collapsible-${null==t?void 0:t.type}`]:t,[`b-panel-collapse-${null==t?void 0:t.collapseDir}`]:t,[`b-${l?"h":"v"}box`]:1,"b-panel-collapsible":t,"b-panel-has-header":o,"b-panel-has-tools":s?1:0,"b-panel-overlay-revealed":r},children:{topFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1}},headerElement:o,[c]:a,bottomFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1,"b-end-focus-trap":1}}}}}composeBody(){const e=this,{bodyCls:n,bodyConfig:i,bodyWrapTag:r,footer:s,uiClassList:o}=e,l=Nt.values(e.strips,((e,t)=>!ha[null==t?void 0:t.dock])).sort(e.byWeightSortFn);let a,c,d,u,h,g,m;for(s&&(d=s.dock||"bottom",l.unshift({dock:d,element:{tag:"footer",reference:"footerElement",html:"string"==typeof s?s:s.html,class:t(t({},o),{},{[`b-dock-${d}`]:1,[`${s.cls||""}`]:1})}})),n&&(i[h="className"]||(h="class"),i[h]=new gn(i[h]).assign(n)),u=l.length;u-- >0;)a=l[u],[g,c]=ha[a.dock],m?m.vertical!==g&&(m=da(ca(m,o),"",g)):m=da(i,r,g),m.children[c?"unshift":"push"](a.element);const p=ca(m||da(i,r),o,!0);return p.class["b-panel-body-wrap"]=1,p.class[`b-${e.$$name.toLowerCase()}-body-wrap`]=1,p}get hasHeader(){if(!1===this.header)return!1;const{header:e,title:t,tools:n,parent:i}=this,r=this.maximizable||Object.values(n||{}).some((e=>!e.hidden));return e||!(null!=i&&i.suppressChildHeaders)&&(t||r)}get rootUiClass(){return ma}composeHeader(e){var n;const i=this;if(!i.hasHeader&&!e)return;const r=i.header||{},s=r.dock||"top",[o,l]=i.splitHeaderItems({dock:s,as:"element"}),a=i.$meta.hierarchy,c=i.composeTitle(r),d=new gn(t({[`b-dock-${s}`]:1},i.uiClassList),r.cls);let u,h;for(u=a.indexOf(ma);u<a.length;++u)h=a[u].$$name,"Grid"!==h&&(d[`b-${h.toLowerCase()}-header`]=1);const g={tag:"header",class:d,children:[...o,c,...l]};return(null===(n=i.collapsible)||void 0===n?void 0:n.composeHeader(g))||g}composeTitle(e){var n;const i="string"==typeof e?e:this.title||e.title,r={reference:"titleElement",id:`${this.id}-panel-title`,html:null!=i?i:" ",class:t({[`b-align-${e.titleAlign||"start"}`]:1,"b-header-title":1},this.uiClassList)};return Nt.isObject(i)&&(delete r.html,Nt.merge(r,i)),(null===(n=this.collapsible)||void 0===n?void 0:n.composeTitle(r))||r}updateTitle(){}afterRecompose(){var e;super.afterRecompose();const t=this,{headerElement:n}=t;null===(e=t._headerClickDetacher)||void 0===e||e.call(t),t._headerClickDetacher=n&&En.on({element:n,click:e=>{var n;return null===(n=t.trigger)||void 0===n?void 0:n.call(t,"headerClick",{event:e})}})}onHeaderClick(e){var t;null===(t=this.collapsible)||void 0===t||t.onHeaderClick(e)}onPaint(){var e;super.onPaint(...arguments),null===(e=this.collapsible)||void 0===e||e.onPanelPaint(this)}splitHeaderItems({as:e,overlay:t,dock:n}=la){const i=this,r="element"===e,{collapsed:s}=i,o=i.getEndTools({overlay:t}),l=i.getStartTools({overlay:t}),a=Nt.values(i.strips,((e,n)=>!ga[null==n?void 0:n.dock]&&n.isCollapsified(s,t)));let c,d,u,h=aa;if(a.length+o.length+l.length){for(h=[d=[...l,...a.filter((e=>"pre-header"===e.dock)).sort(i.byWeightSortFn)],c=[...a.filter((e=>"header"===e.dock)).sort(i.byWeightReverseSortFn),...o]],u=0;u<d.length;++u){var g,m;n&&(null===(g=(m=d[u]).syncRotationToDock)||void 0===g||g.call(m,n)),r&&(d[u]=d[u].element)}for(u=0;u<c.length;++u){var p,f;n&&(null===(p=(f=c[u]).syncRotationToDock)||void 0===p||p.call(f,n)),r&&(c[u]=c[u].element)}}return h}set bodyConfig(e){this._bodyConfig=e}get bodyConfig(){const e=this,{bodyTag:n}=e,i=Nt.merge({reference:"bodyElement",className:t(t({},e.getStaticWidgetClasses(ma,"-content")),{},{"b-box-center":1,"b-text-content":e.textContent&&e.hasNoChildren})},e._bodyConfig);return n&&(i.tag=n),!e.initializingElement&&e._element||(i.html=e.content||e._html),i}changeBodyCls(e){return gn.from(e)}changeTbar(e){return this.getConfig("strips"),this.strips={tbar:e},this.strips.tbar}changeBbar(e){return this.getConfig("strips"),this.strips={bbar:e},this.strips.bbar}get childItems(){var e;const t=this,n=Nt.values(t.strips,((e,t)=>!ha[null==t?void 0:t.dock])).sort(t.byWeightSortFn),[i,r]=t.splitHeaderItems(),[s,o]=(null===(e=t.collapsible)||void 0===e?void 0:e.splitHeaderItems())||aa;return[...i,...s,...r,...o,...n.filter((e=>ha[e.dock][1])),...t._items||oa,...n.filter((e=>!ha[e.dock][1])).reverse()]}changeStrips(e,t){const n=this,i=n.$strips||(n.$strips=new Il({configName:"strips",factory:Io,inferType:!1,owner:n,created(e){var t;const{dock:r}=e;if(!ga[r]&&!ha[r])throw new Error(`Invalid dock value "${r}"; must be: top, left, right, bottom, header, or pre-header`);be.after(e,"onConfigChange",((e,{name:t})=>{ua[t]&&n.onConfigChange({name:"strips",value:i.target})})),e.innerItem=!1,n.onChildAdd(e),e.parent=n,null===(t=e.layout)||void 0===t||t.renderChildren(),e.hasItems&&(n.hasItems=!0)},setup:(e,t)=>((e=Nt.merge(Nt.clone(n.stripDefaults["*"]),n.stripDefaults[t],e)).parent=n,e.ref=t,e),transform:e=>(Array.isArray(e)&&(e={items:e}),e||null)}));if(i.update(e),!t)return i.target}get collapsing(){var e;return null===(e=this.collapsible)||void 0===e?void 0:e.collapsing}get collapsingExpanding(){var e;return null===(e=this.collapsible)||void 0===e?void 0:e.collapsingExpanding}get expanding(){var e;return null===(e=this.collapsible)||void 0===e?void 0:e.expanding}changeCollapsed(e){const t=this,{collapsible:n}=t;if(t.recompose.flush(),e=Boolean(e),!n||t.changingCollapse||!t.isPainted)return e;null==n||n.collapse({animation:null,collapsed:e})}changeCollapsible(e,t){const n=this;return n.getConfig("tools"),e&&(!0===e?e={}:"string"==typeof e&&(e={[ha[e]?"direction":"type"]:e})),Ol.reconfigure(t,e,{owner:n,defaults:{panel:n},cleanup(){n.collapsed&&(t.collapse({animation:null,collapsed:!1}),n._collapsed=1)}})}updateCollapsible(e){const t=this,n=null==e?void 0:e.toolsConfig;t.tools={collapse:(null==n?void 0:n.collapse)||null,recollapse:(null==n?void 0:n.recollapse)||null},e&&t.isPainted&&t.collapsed&&(t._collapsed=1),1===t.collapsed&&(t.collapsed=!0)}_collapse(e,t){var n;return!0!==t&&void 0!==t&&(!1===t?e.collapsed=!e.collapsed:"number"==typeof t?e.animation={duration:t}:null===t?e.animation=t:!0===t||("animation"in t?Nt.merge(e,t):e.animation=t)),null===(n=this.collapsible)||void 0===n?void 0:n.collapse(e)}collapse(e){return this._collapse({collapsed:!0},e)}expand(e){return this._collapse({collapsed:!1},e)}toggleCollapsed(e){return this.collapsed?this.expand(e):this.collapse(e)}get expandedHeaderDock(){var e,t,n;return null!==(e=null!==(t=this._expandedHeaderDock)&&void 0!==t?t:null===(n=this.initialConfig.header)||void 0===n?void 0:n.dock)&&void 0!==e?e:"top"}set expandedHeaderDock(e){this._expandedHeaderDock=null==e?void 0:e.toLowerCase()}updateHeader(e){this.changingCollapse||(this.expandedHeaderDock=null==e?void 0:e.dock)}updateTrapFocus(e){var t;const n=this;n.element.classList[e?"add":"remove"]("b-focus-trapped"),n.focusTrapListener=null===(t=n.focusTrapListener)||void 0===t?void 0:t.call(n),e&&(n.focusTrapListener=En.on({element:n.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:n}),n.treeWalker||(n.treeWalker=this.setupTreeWalker(n.element,gi.NodeFilter.SHOW_ELEMENT,sa)))}setupTreeWalker(e,t,n){return document.createTreeWalker(e,t,n)}onFocusTrapped(e){const t=this,n=t.treeWalker;if(e.target===t.bottomFocusTrap)n.currentNode=t.topFocusTrap,n.nextNode();else{if(e.target!==t.topFocusTrap)return;n.currentNode=t.bottomFocusTrap,n.previousNode()}t.requestAnimationFrame((()=>n.currentNode.focus()))}get focusElement(){return this.hasItems&&(super.focusElement||this.element)}get contentElement(){return this.element&&this.bodyElement}get widgetClassList(){const e=this,t=super.widgetClassList;var n;e.hasHeader&&t.push("b-panel-has-header",`b-header-dock-${(null===(n=e.header)||void 0===n?void 0:n.dock)||"top"}`);return e.tbar&&t.push("b-panel-has-top-toolbar"),e.bbar&&t.push("b-panel-has-bottom-toolbar"),t}}ma.initClass(),ma._$name="Panel";class pa extends ma{static get $name(){return"Popup"}static get type(){return"popup"}static get configurable(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},stripDefaults:{bbar:{layout:{justify:"flex-end"}}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,maximizable:null,modal:null,maximized:null,tools:{close:{cls:"b-popup-close",handler:"close",weight:-1e3,ariaLabel:"L{Popup.close}",hidden:!0},maximize:{cls:"b-popup-expand",handler:"toggleMaximized",weight:-999,hidden:!0}},highlightReturnedFocus:!0,role:"dialog"}}finalizeInit(){const e=this,{forElement:t}=e;e.anchoredTo=t,e.initialAnchor=e.anchor,t&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),En.on({element:t,click:"onElementUserAction",thisObj:e})),super.finalizeInit(),!e.autoShow||t&&!gi.isVisible(t)||(!0===e.autoShow?e.show():e.setTimeout((()=>e.show()),e.autoShow))}onPaint({firstPaint:e}){var t;null===(t=super.onPaint)||void 0===t||t.call(this,...arguments);const n=this;e&&n.headerElement&&En.on({element:n.headerElement,dblclick:n.onHeaderDblClick,thisObj:n})}doDestroy(){this.syncModalMask(),super.doDestroy()}compose(){const{hasNoChildren:e,textContent:t}=this;return{class:{"b-text-popup":Boolean(t&&e)}}}close(){const e=this;if(!e._hidden&&!1!==e.trigger("beforeClose")||e._hidden&&"destroy"===e.closeAction)return e.modal&&"destroy"===e.closeAction&&e.revertFocus(),e.unmask(),e.containsFocus&&e.highlightReturnedFocus&&e.setTimeout((()=>e.element.classList.add("b-using-keyboard")),0),e[e.closeAction]()}toggleMaximized(){this.maximized=!this.maximized}updateMaximized(e){gi.toggleClasses(this.element,["b-maximized"],e)}onInternalKeyDown(e){const t=this;"Escape"===e.key&&(e.stopImmediatePropagation(),t.floating||t.positioned?t.close(!0):t.collapsible&&(t.revealed?t.collapsible.toggleReveal():t.collapse()))}onDocumentMouseDown({event:e}){const t=this,{owner:n}=t,{target:i}=e;if("touchend"!==e.type&&null!=n&&n.isButton&&n._menu===t&&n.element.contains(i))return e.preventDefault(),!1;t.modal&&i===pa.modalMask?(e.preventDefault(),t.modal.closeOnMaskTap?t.close():t.containsFocus||t.focus()):t.owns(i)||!t.autoClose||t.containsFocus||t.close()}get isTopModal(){return gi.isVisible(pa.modalMask)&&this.element.previousElementSibling===pa.modalMask}onFocusIn(e){const t=gi.getActiveElement(this);super.onFocusIn(e),gi.getActiveElement(this)===t&&e.target===this.element&&this.focus()}onFocusOut(e){globalThis.visualViewport&&globalThis.visualViewport.height<document.documentElement.clientHeight-1||this.modal||!this.autoClose||this.close(),super.onFocusOut(e)}onShow(){var e;const t=this;t.autoClose&&t.addDocumentMouseDownListener(),t.focusOnToFront&&t.focus(),null===(e=super.onShow)||void 0===e||e.call(this),t.syncModalMask()}addDocumentMouseDownListener(){this.mouseDownRemover||(this.mouseDownRemover=Mi.ion({globaltap:"onDocumentMouseDown",thisObj:this}))}updateModal(e){e&&(this.floating=!0)}syncModalMask(){const e=this,{modal:t,element:n}=e;if(n.setAttribute("aria-modal",Boolean(t)),t&&e.isVisible)"number"!=typeof e._x&&"number"!=typeof e._y&&(e.centered=!0,e.anchor=!1),e.modalMask.classList.remove("b-hide-display"),n.classList.add("b-modal");else if(e.isPainted){n.classList.remove("b-modal");const t=e.floatRoot.querySelectorAll(".b-modal"),i=t.length?pa.fromElement(t[t.length-1],"popup"):null;i?i.syncModalMask():pa.modalMask.classList.add("b-hide-display")}}onHide(){var e,t;const n=this;null===(e=n.mouseDownRemover)||void 0===e||e.call(n),n.mouseDownRemover=null,null===(t=super.onHide)||void 0===t||t.call(this),n.syncModalMask()}onElementUserAction(){this.show()}onHeaderDblClick(){this.maximizable&&this.toggleMaximized()}updateClosable(e){this.tools.close.hidden=!e}updateMaximizable(e){this.tools.maximize.hidden=!e}get modalMask(){const{modalMask:e}=pa;return e.nextElementSibling!==this.element&&this.floatRoot.insertBefore(e,this.element),e}static get modalMask(){return this._modalMask||(this._modalMask=gi.createElement({className:"b-modal-mask b-hide-display"}),En.on({element:this._modalMask,wheel:e=>e.preventDefault()})),this._modalMask}}pa.initClass(),pa._$name="Popup";const fa=/^b-icon-/,va=/^b-fa-/;class ya extends Io{static get $name(){return"MenuItem"}static get type(){return"menuitem"}static get configurable(){return{checked:null,separator:null,toggleGroup:null,menu:{value:null,$config:["lazy","nullify"]},icon:null,closeParent:null,href:null,target:null,localizableProperties:["text"],role:"menuitem",closeMenuDelay:200}}updateElement(e,t){const n=super.updateElement(e,t);return"boolean"==typeof this.checked&&(this.role="menuitemcheckbox"),this.ariaHasPopup=!!this.hasMenu&&"menu",n}compose(){var e;const n=this,{checked:i,href:r,hasMenu:s,separator:o,target:l,text:a,toggleGroup:c}=n,d="boolean"==typeof i,u=n.icon||(d?"b-fw-icon":""),h="b-icon-"+(c?"radio-":""),g="object"==typeof a;return{tag:r?"a":"div",tabIndex:-1,href:r,target:l,class:{"b-has-submenu":s,"b-checked":i,"b-separator":o||(null===(e=n.cls)||void 0===e?void 0:e["b-separator"])},dataset:{group:n.toggleGroup},[d?"aria-checked":""]:i,[s?"aria-expanded":""]:!1,children:{iconElement:u&&{"aria-hidden":!0,tag:"i",class:t({"b-fa":va.test(u),"b-icon":fa.test(u),"b-menuitem-icon":1,[`${h}checked`]:!0===i,[`${h}unchecked`]:!1===i},gn.normalize(u,"object"))},textElement:{tag:"span",html:g?null:a,class:{"b-menu-text":1,"b-menu-custom-content":g},children:g?[a]:null},subMenuIcon:s&&{"aria-hidden":!0,tag:"i",class:{"b-fw-icon":1,"b-icon-sub-menu":1}}}}}doAction(e){const t=this,n=this.parent,i={menu:n,item:t,element:t.element,bubbles:!0};if("boolean"==typeof t.checked){const e=!t.checked;t.toggleGroup&&!e||(t.checked=!t.checked)}t.trigger("beforeItem",i),t.trigger("item",i),t.closeParent&&n&&(n.rootMenu.close(),e&&!t.href&&e.preventDefault())}get focusElement(){return this.element}get contentElement(){return this.textElement}get isFocusable(){const{focusElement:e}=this;return e&&this.isVisible&&(e===document.body||e.offsetParent)}get hasMenu(){return this.hasConfig("menu")}get childItems(){const{_menu:e}=this;return e?[e]:[]}get text(){return this.html}set text(e){this.html=e}onFocusIn(e){super.onFocusIn(e),!this.disabled&&this.menu&&this.delay("openMenu",200)}onFocusOut(e){this.clearTimeout("openMenu"),super.onFocusOut(e),this._menu&&(this.menu.closeTimer=this.menu.setTimeout((()=>this.closeMenu()),this.closeMenuDelay))}openMenu(e){const{menu:t}=this;!this.disabled&&t&&(t.focusOnToFront=e,t.show())}onChildShow(e){super.onChildShow(e),this.ariaElement.setAttribute("aria-expanded",!0)}closeMenu(){this._menu instanceof Io&&this.menu.close()}onChildHide(e){super.onChildHide(e),this.ariaElement.setAttribute("aria-expanded",!1)}changeToggleGroup(e){return e&&"boolean"!=typeof this.checked&&(this.checked=!1),e}changeChecked(e,t){if(this.isConfiguring||"boolean"==typeof t)return Boolean(e)}updateChecked(e){const t=this;t.isConfiguring||(t.toggleGroup&&t.uncheckToggleGroupMembers(),t.element.setAttribute("aria-checked",e),t.trigger("toggle",{menu:t.owner,item:t,element:t.element,bubbles:!0,checked:e}))}getToggleGroupMembers(){const e=this,{checked:t,toggleGroup:n,element:i}=e,r=[];return t&&n&&gi.forEachSelector(e.rootElement,`[data-group=${n}]`,(e=>{if(e!==i){const t=Io.fromElement(e);t&&r.push(t)}})),r}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((e=>e.checked=!1))}get closeParent(){return("boolean"==typeof this.checked?this._closeParent:!1!==this._closeParent)&&!this.hasMenu}changeMenu(e,t){const n=this,{constrainTo:i,scrollAction:r}=n.owner;return!e||"object"!=typeof e||"items"in e||"widgets"in e||"html"in e||(e={lazyItems:e}),Ca.reconfigure(t,e,{owner:n,defaults:{type:"menu",align:"s0-e0",anchor:!0,autoClose:!0,autoShow:!1,cls:"b-sub-menu",forElement:n.element,owner:n,ariaLabel:n.text,constrainTo:i,scrollAction:r}})}}ya.initClass(),ya._$name="MenuItem";const ba={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1};class Ca extends pa{static get $name(){return"Menu"}static get type(){return"menu"}static get configurable(){return{focusable:!0,align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem",tools:{close:!1},role:"menu",ariaElement:"bodyElement"}}construct(e){Array.isArray(e)&&(e={lazyItems:e}),super.construct(e),En.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",thisObj:this})}afterShow(e){const{items:t,element:n}=this;t.some((e=>Boolean(e._menu)))&&n.classList.add("b-menu-with-submenu");t.some((e=>e.icon))&&n.classList.add("b-menu-with-icon"),super.afterShow(e)}createWidget(e){return"string"==typeof e&&(e={text:e}),super.createWidget(e)}get focusElement(){var e;const t=this,n=null===(e=t.parentMenu)||void 0===e?void 0:e.element.contains(gi.getActiveElement(t.parentMenu)),i=t.items[0];return!n&&!gi.usingKeyboard&&i instanceof ya?t.element:super.focusElement}onDocumentMouseDown({event:e}){if(!this.parentMenu||!this.parentMenu.owns(e.target))return super.onDocumentMouseDown(...arguments)}hide(e){const t=this;var n,i;(super.hide(e),t.isVisible)||(null===(n=t.currentSubMenu)||void 0===n||null===(i=n.hide)||void 0===i||i.call(n,e),t.parentMenu&&(t.parentMenu.currentSubMenu=null))}show(){super.show(...arguments);const{parentMenu:e}=this;this.isVisible&&e&&(e.currentSubMenu=this)}onMouseClick(e){const t=e.target.closest(".b-menuitem");t&&this.triggerElement(t,e)}onMouseOver(e){if(!1!==this.focusOnHover){var t;const n=null===(t=e.relatedTarget)||void 0===t?void 0:t.closest(".b-widget"),i=e.target.closest(".b-widget"),r=Io.fromElement(i);!gi.isTouchEvent&&i&&i!==n&&r.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[r],cancelOutstanding:!0})}}handleMouseOver(e){e.focus()}onMouseEnter(){this.clearTimeout(this.closeTimer)}onMouseLeave(e){const t=this,{relatedTarget:n}=e,i=n&&t.owns(n);let r=n instanceof HTMLElement&&Io.fromElement(n),s=!i;if(r){for(;r.ownerCmp;)r=r.ownerCmp;s&=!gi.getAncestor(r.element,[e.target])}!i&&s&&(t.currentSubMenu&&!t.currentSubMenu.closeTimer&&t.currentSubMenu.hide(),t.element.contains(gi.getActiveElement(t))&&gi.getActiveElement(t).matches(".b-menuitem")&&t.focusElement.focus())}onInternalKeyDown(e){const t=Io.fromElement(e),n=t&&t!==this&&!(t instanceof ya);if("Escape"===e.key)return void(n?this:this.rootMenu).close();if(super.onInternalKeyDown(e),n)return;ba[e.key]&&e.preventDefault();const i=this.element,r=gi.getActiveElement(i);this.navigateFrom(r!==i&&i.contains(r)?r:null,e.key,e)}navigateFrom(e,t,n){const i=this,{treeWalker:r}=i,s=e&&i.getItem(e),o=i.rtl?"ArrowLeft":"ArrowRight",l=i.rtl?"ArrowRight":"ArrowLeft";let a;switch(t){case"ArrowUp":r.currentNode=e||(e=i.bottomFocusTrap),r.previousNode(),a=r.currentNode;break;case"ArrowDown":r.currentNode=e||(e=i.topFocusTrap),r.nextNode(),a=r.currentNode;break;case" ":e&&!e.classList.contains("b-disabled")&&(null!=s&&s.menu?i.openSubMenu(e,s):i.triggerElement(e,n));break;case o:if(e&&null!=s&&s.menu&&!e.classList.contains("b-disabled")){const t=i.openSubMenu(e,s);null==t||t.focus()}else r.currentNode=e||(e=i.topFocusTrap),r.nextNode(),a=r.currentNode;break;case l:i.isSubMenu?i.hide():e||(r.currentNode=e||(e=i.topFocusTrap),r.nextNode(),a=r.currentNode);break;case"Enter":e&&!e.classList.contains("b-disabled")&&i.triggerElement(e,n)}a&&(a===i.element?i.navigateFrom(i.bottomFocusTrap,"ArrowUp",n):a===e?i.navigateFrom(i.topFocusTrap,"ArrowDown",n):a.focus())}getItem(e){if(null!=e)return"number"==typeof e?this.items[e]:e.nodeType===Element.ELEMENT_NODE?Io.fromElement(e,"menuitem",this.contentElement):this.items.find((t=>t.id==e))}triggerElement(e,t){const n=this.getItem(e);n&&!n.disabled&&n.doAction(t)}get isSubMenu(){var e;return this===(null===(e=this.owner)||void 0===e?void 0:e.menu)}openSubMenu(e,t){const n=this,i=t.menu;if(i){if(!i.isVisible){var r;const s={item:t,element:e};if(!1===n.trigger("beforeSubMenu",s))return;if(!1===(null===(r=t.onBeforeSubMenu)||void 0===r?void 0:r.call(t,s)))return;i.show()}return n.currentSubMenu=i}}set selectedElement(e){const t=this,n=t._selectedElement;if(n){const e=t.getItem(n),i=null==e?void 0:e.menu;null==i||i.hide(),n.classList.remove("b-active")}if(t._selectedElement=e,e){const n=gi.isFocusable(e);e.classList.add("b-active"),t.scrollable.scrollIntoView(e,{animate:!n,focus:n})}}get selectedElement(){return this._selectedElement}selectFirst(){const e=this.treeWalker;e.currentNode=this.topFocusTrap,e.nextNode(),this.requestAnimationFrame((()=>e.currentNode.focus()))}get parentMenu(){var e;const t=this.owner;return t&&(t.isMenu?t:null===(e=t.up)||void 0===e?void 0:e.call(t,"menu"))}get rootMenu(){let e=this;for(;e.parentMenu instanceof this.constructor;)e=e.parentMenu;return e}}let wa;Ca.initClass(),Ca._$name="Menu";class Ea extends Ii{static get $name(){return"ContextMenuBase"}static get configurable(){return{type:null,menu:{$config:["lazy","nullify"],value:{type:"menu",autoShow:!1,closeAction:"hide",scrollAction:"hide",constrainTo:globalThis}},items:{},triggerEvent:!1,keyMap:{" ":{handler:"showContextMenuByKey",weight:100},"Ctrl+Space":"showContextMenuByKey"}}}static get pluginConfig(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick"]}}construct(...e){var t;if(super.construct(...e),null===(t=this.type)||void 0===t||!t.length)throw new Error("Config 'type' is required to be specified for context menu")}onElementContextMenu(e){this.onElementEvent(e)}onElementClick(e){this.onElementEvent(e)}onElementDblClick(e){this.onElementEvent(e)}onElementEvent(e){if(!0!==e.ctrlKey){if(!e.handled&&this.triggerEvent===e.type){const t=e;if(wa){const{target:n}=wa;e=En.fixEvent(new MouseEvent(e.type,e)),Object.defineProperty(e,"target",{get:()=>n,configurable:!0}),e.preventDefault=function(){t.preventDefault(),t.handled=!0}}this.internalShowContextMenu(e)}}else e.preventDefault()}showContextMenuByKey(e){if(!gi.isEditable(e.target)){const t=this.getKeyboardContextMenuTarget(e.target);if(t)return wa=e,gi.triggerMouseEvent(t,this.triggerEvent),e.handled=!0,e.preventDefault(),e.stopImmediatePropagation(),wa=null,!0}return!1}getKeyboardContextMenuTarget(e){const t=gi.isInView(e);return e.children.length?gi.childFromPoint(e,t.width/2,t.height/2):e}internalShowContextMenu(e){const t=this;if(t.disabled)return;const n=t.getDataFromEvent(e);!e.handled&&n&&t.shouldShowMenu(n)&&("contextmenu"===e.type&&r.isSafari&&e.ctrlKey&&!e.metaKey&&En.on({element:e.target,capture:!0,once:!0,thisObj:this,click(e){e.preventDefault(),e.stopImmediatePropagation()}}),n.domEvent=e,t.showContextMenu(n))}getDataFromEvent(e){return{event:e,targetElement:this.getTargetElementFromEvent(e)}}getTargetElementFromEvent(e){return e.target}showContextMenu(e,t){var n;const i=this,r=gi.isDOMEvent(e),s=r?i.getDataFromEvent(e):e,o=r?e:s.domEvent;if(null===(n=i._menu)||void 0===n||n.hide(),i.disabled)return;i.menuContext=s;const{type:l,client:a,processItems:c}=i,d=gi.isInView(s.targetElement).center;if(L.assign(s,{feature:i,point:null!=o&&o.clientX?[o.clientX+1,o.clientY+1]:[d.x,d.y],menu:i,items:{},selection:a.selectedRecords}),i.callChainablePopulateMenuMethod(s),L.merge(s.items,i.baseItems),i.preventDefaultEvent(s),(!c||!1!==i.callback(c,a,[s]))&&i.hasActiveMenuItems(s)&&(i.populateItemsWithData(s),!1!==i.beforeContextMenuShow(s))){const{menu:e}=i;var u;if(!1!==a.trigger(`${l}MenuBeforeShow`,s))e.items=s.items,e.showBy(t||s.point),null===(u=i.touchMoveDetacher)||void 0===u||u.call(i),i.touchMoveDetacher=En.on({element:a.element,touchmove:()=>e.hide(),thisObj:e,once:!0}),o&&(o.preventDefault(),o.handled=!0)}}get baseItems(){if(!this._baseItems){const e=this,{namedItems:t}=e,n=e._baseItems=L.assign({},e.items);for(const e in n){const i=n[e];i&&(t&&e in t?n[e]="object"==typeof i?L.merge(L.clone(t[e]),i):t[e]:!0===i&&delete n[e])}}return this._baseItems}hideContextMenu(e){var t;null===(t=this.menu)||void 0===t||t.hide(e)}callChainablePopulateMenuMethod(e){var t,n;null===(t=(n=this.client)[`populate${S.capitalize(this.type)}Menu`])||void 0===t||t.call(n,e)}hasActiveMenuItems(e){return Object.values(e.items).some((e=>e&&!e.hidden))}shouldShowMenu(){return!0}beforeContextMenuShow(e){}populateItemsWithData(e){}preventDefaultEvent(e){var t;null===(t=e.event)||void 0===t||t.preventDefault()}changeTriggerEvent(e){return e||this.client.contextMenuTriggerEvent}changeMenu(e,t){const n=this,{client:i,type:r}=n;if(e)return Ca.reconfigure(t,e?Ca.mergeConfigs({owner:i,rootElement:i.rootElement,onItem(e){i.trigger(`${r}MenuItem`,e)},onToggle(e){i.trigger(`${r}MenuToggleItem`,e)},onDestroy(){n.menu=null},onBeforeItem(e){Object.assign(e,n.menuContext)},onShow({source:e}){n.menuContext.menu=e,i.trigger(`${r}MenuShow`,n.menuContext)}},e):null,n);null!=t&&t.isWidget&&t.destroy()}}Ea._$name="ContextMenuBase";const Sa=/>[ \t\r\n]+</g,Ta=/\s\s+/g;class xa{static tpl(e,...t){let n=0,i=t.map(((t,i)=>{let r=e[i];return Array.isArray(t)?r+=t.reduce(((e,t)=>e+(("string"==typeof t?t.trim():t)+"\n")),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),n++,r})).join("");return n<=e.length&&(i+=e[e.length-1]),i.replace(Sa,"><").replace(Ta," ").trim()}static docsTpl(e,...t){let n=0,i=t.map(((t,i)=>{let r=e[i];return Array.isArray(t)?r+=t.reduce(((e,t)=>e+(("string"==typeof t?t.trim():t)+"\n")),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),n++,r})).join("");return n<=e.length&&(i+=e[e.length-1]),i.replace(Sa,"><").trim()}static repeat(e){return function(...t){return xa.tpl(...t).repeat(e)}}static loop(e){}}xa._$name="TemplateHelper";class Da extends Array{constructor(e,t){super(),this.timeZone=e,this.year=t}}class Oa{constructor(e,t){this.asString=e,this.timeZone=t,this.asArray=Fa(e)}get asLocalDate(){return this._asLocalDate||(this._asLocalDate=new Date(...this.asArray)),this._asLocalDate}get asTicksUtc(){return this._asTicksUtc||(this._asTicksUtc=new Date(Date.UTC(...this.asArray)).getTime()),this._asTicksUtc}}const Ma=(e,t)=>{const n=e.toLocaleString("sv-SE",{timeZone:t});return new Oa(n,t)},Ia=(e,t)=>{const{asTicksUtc:n,asString:i}=Ma(new Date(e),t);return{offset:(e-n)/6e4,tzTicksUtc:n,tzString:i}},Fa=e=>{const t=e.split(/[\s-:]/).map((e=>1*e));return t[1]-=1,t},ka=2592e6,La={_cache:{},get(e,t){var n;return null===(n=this._cache[e])||void 0===n?void 0:n[t]},set(e){const{timeZone:t}=e,{_cache:n}=this;n[t]||(n[t]={}),n[t][e.year]=e}};class Aa{static get $name(){return"TimeZoneHelper"}static toTimeZone(e,t){if("number"==typeof t)return this.toUtcOffset(e,t);const n=Ma(e,t);return n.asArray[3]!==n.asLocalDate.getHours()&&console.error("Incorrect transformation due to local dst"),n.asLocalDate}static fromTimeZone(e,t){if("number"==typeof t)return this.fromUtcOffset(e,t);const n=this.dateAsArray(e),i=((e,t)=>{const n=La.get(e,t);if(n)return n;const i=new Da(e,t),r=new Date(Date.UTC(t,0,1)).getTime();let s,o,l,a,c=r,d=ka,u=0,h=[],g=null;for(;!a;)({offset:l,tzTicksUtc:s,tzString:o}=Ia(c,e)),null==g?(g=l,i.push({offset:l})):d>0&&l!==g?d=d===ka?-864e5:-6e4:d<0&&l===g&&(-864e5===d?d=36e5:(1===i.length?(i.push(h),g=h.offset):(i[0].startTicks=h.startTicks,i[0].startDateString=h.startDateString,a=!0),d=ka)),h={offset:l,startDateString:o,startTicks:s},d===ka&&(c=r,c+=u*ka,u+=1),c+=d,u>11&&(a=!0);return La.set(i),i})(t,e.getUTCFullYear());let r=i[0].offset;if(2===i.length){const e=Date.UTC(...n);e>=i[1].startTicks&&e<i[0].startTicks&&(r=i[1].offset)}return n[4]+=r,new Date(Date.UTC(...n))}static toUtcOffset(e,t){const n=e.getTimezoneOffset()+t;return new Date(e.getTime()+60*n*1e3)}static fromUtcOffset(e,t){const n=-e.getTimezoneOffset()-t;return new Date(e.getTime()+60*n*1e3)}static dateAsArray(e){return[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]}}Aa._$name="TimeZoneHelper";class $a extends Io{static get $name(){return"Toast"}static get type(){return"toast"}static get configurable(){return{testConfig:{destroyTimeout:1,timeout:100},floating:!0,timeout:2500,autoDestroy:null,destroyTimeout:200,showProgress:!0,color:null,bottomMargin:20}}compose(){const{appendTo:e,color:n,html:i,showProgress:r,style:s,timeout:o}=this;return{parent:e||this.floatRoot,class:t(t({},gn.normalize(n,"object")),{},{"b-toast-hide":1}),html:i,style:s,children:{progressElement:r&&{style:`animation-duration:${o/1e3}s;`,class:{"b-toast-progress":1}}},listeners:{click:"hide"}}}doDestroy(){this.untoast(),super.doDestroy()}get nextBottom(){const{bottomMargin:e,element:t}=this;return parseInt(t.style.bottom,10)+t.offsetHeight+e}async show(){await super.show(...arguments);const e=this,{element:t}=e,{toasts:n}=$a;var i,r;n.includes(e)||(t.style.bottom=(null!==(i=null===(r=n[0])||void 0===r?void 0:r.nextBottom)&&void 0!==i?i:e.bottomMargin)+"px",n.unshift(e),t.getBoundingClientRect(),t.classList.remove("b-toast-hide"),e.timeout>0&&(e.hideTimeout=e.setTimeout("hide",e.timeout)))}async hide(){const e=this;e.untoast(),e.element.classList.add("b-toast-hide"),e.autoDestroy&&!e.destroyTimer&&(e.destroyTimer=e.setTimeout("destroy",e.destroyTimeout))}untoast(){const{toasts:e}=$a;e.includes(this)&&e.splice(e.indexOf(this),1)}static hideAll(){$a.toasts.slice().reverse().forEach((e=>e.hide()))}static show(e){const t=$a.new({autoDestroy:!0,rootElement:document.body},"string"==typeof e?{html:e}:e);return t.show(),t}}$a.toasts=[],$a.initClass(),$a._$name="Toast";class Ra extends(de.mixin($e,lr)){static get $name(){return"Navigator"}static get type(){return"navigator"}static get configurable(){return{ownerCmp:null,itemsTabbable:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,activeItem:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,disabled:null,datasetIdProperty:"id",testConfig:{scrollDuration:1}}}static get factoryable(){return{defaultType:"navigator"}}get activeItem(){const{_activeItem:e}=this;if(this.target.contains(e))return e;this._activeItem=null}updateOwnerCmp(e){this.itemSelector||(this.itemSelector=`.${this.ownerCmp.itemCls}`),gi.setAttributes(this.keyEventTarget,{"aria-activedescendant":`${this.owner.id}-active-descendant`})}set navigationEvent(e){const{owner:t}=this;this._navigationEvent=t.navigationEvent=e,e&&Promise.resolve(1).then((()=>this.navigationEvent=null))}get navigationEvent(){return this._navigationEvent}static getComposedKeyName(e){const t=(e.key||"").trim()||e.code;return`${e.ctrlKey?"CTRL+":""}${e.shiftKey?"SHIFT+":""}${e.altKey?"ALT+":""}${t}`}onKeyDown(e){const t=this,{ownerCmp:n,itemSelector:i,activeItem:r,itemsTabbable:s}=t,{target:o}=e,l=t.target.querySelector(i),a=(e.key||"").trim()||e.code,c=t.constructor.getComposedKeyName(e),d=o.matches(i)||o===t.keyEventTarget;if(!t.disabled&&t.processEvent&&(e=t.processEvent.call(n,e)),e&&!t.disabled&&l&&t.target.offsetParent&&d){if(!s){if(null==t.inlineFlow){const e=l.parentNode,n=gi.getStyleValue(l,"position"),i=gi.getStyleValue(l,"display"),r=gi.getStyleValue(l,"float");t.inlineFlow="absolute"===n||"inline"===i||"inline-block"===i||"left"===r||"right"===r||"flex"===gi.getStyleValue(e,"display")&&"row"===gi.getStyleValue(e,"flex-direction")}t.prevKey||(t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown"))}if(t.navigationEvent=e,r)switch(a){case t.prevKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigatePrevious(e);break;case t.nextKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigateNext(e);break;default:{var u;const i=null===(u=t.keys)||void 0===u?void 0:u[c];if(i&&!t.disabled){if(!1===t.callback(i,t.thisObj||n,[e]))return}else n.onInternalKeyDown&&n.onInternalKeyDown(e);if(gi.getActiveElement(o)!==o&&e.preventDefault(),s)return}}else{if(s)return;a!==t.nextKey&&a!==t.prevKey||(t.activeItem=t.getDefaultNavigationItem(e))}t.activeItem!==r&&t.triggerNavigate(e)}}getDefaultNavigationItem(e){const{target:t,itemSelector:n,prevKey:i,nextKey:r}=this;return 4&t.compareDocumentPosition(e.target)&&e.key===i?t.querySelector(`${n}:last-of-type`):2&t.compareDocumentPosition(e.target)&&e.key===r?t.querySelector(`${n}`):void 0}navigatePrevious(e){const t=this,n=t.previous;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((()=>{t.activeItem=n,t.triggerNavigate(e)}))}navigateNext(e){const t=this,n=t.next;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((()=>{t.activeItem=n,t.triggerNavigate(e)}))}get owner(){return this.ownerCmp}get previous(){return this.getAdjacent(-1)}get next(){return this.getAdjacent(1)}getAdjacent(e=1,t=this.activeItem){const n=this.treeWalker;if(n.currentNode=t,n[e<0?"previousNode":"nextNode"](),n.currentNode!==this.activeItem)return n.currentNode}onTargetFocusIn(e){const t=this,{target:n,relatedTarget:i}=e,{owner:r,itemsTabbable:s,skipScrollIntoView:o,previousActiveItem:l}=t;if(!n.matches(".b-focus-trap"))if(n.matches(t.itemSelector))t.skipScrollIntoView=!0,t.activeItem=n,t.skipScrollIntoView=o,t.activeItem&&s&&t.triggerNavigate(e);else if(n===t.target){var a;if((i?n.compareDocumentPosition(i):0)&Node.DOCUMENT_POSITION_CONTAINED_BY)null===(a=r.previousSibling)||void 0===a||a.focus();else t.activeItem=l&&t.target.contains(l)?l:0}}onTargetFocusOut(e){const t=this,{relatedTarget:n}=e;null!=n&&n.matches(".b-focus-trap")||n&&t.target.contains(n)&&n.matches(t.itemSelector)||t.activeItem&&(t.activeItem=null,t.itemsTabbable&&t.triggerNavigate(e))}onTargetMouseDown(e){const t=this,n=e.target.closest(t.itemSelector);t.navigationEvent=e,t.itemsTabbable?n===t.activeItem&&t.triggerNavigate(e):!1===t.ownerCmp.itemsFocusable?t.onFocusGesture(e):n&&(e.preventDefault(),gi.focusWithoutScrolling(n))}onTargetClick(e){var t;const n=this,{skipScrollIntoView:i}=n;n.skipNextClick||null!==(t=n.navigationEvent)&&void 0!==t&&t.ignoreNavigation?n.skipNextClick=!1:n.disabled||(n.skipScrollIntoView=!0,n.processEvent&&(e=n.processEvent.call(n.ownerCmp,e)),e&&(n.activeItem=e.target.closest(n.itemSelector),n.triggerNavigate(e)),n.skipScrollIntoView=i)}onFocusGesture(e){(e.target===this.ownerCmp.contentElement||e.target.closest(this.itemSelector)&&!1===this.ownerCmp.itemsFocusable)&&e.preventDefault()}acceptNode(e){return e.offsetParent&&e.matches&&e.matches(this.itemSelector)?gi.NodeFilter.FILTER_ACCEPT:gi.NodeFilter.FILTER_SKIP}changeActiveItem(e){return null!=e&&this.ownerCmp.getItem&&(e=this.ownerCmp.getItem(e)),e}updateActiveItem(e,t){const n=this,{ownerCmp:i}=n,r=t&&n.target.contains(t),s=e&&gi.isFocusable(e)&&e!==gi.getActiveElement(e);if(r&&(n.previousActiveItem=t),t&&(t.classList.remove(n.focusCls),t.removeAttribute("id")),null!=e){var o;if(n.skipScrollIntoView)s&&gi.focusWithoutScrolling(e);else null===(o=i.scrollable)||void 0===o||o.scrollIntoView(e,{block:"nearest",focus:s,silent:n.scrollSilently});if(e===t&&r)return;e.classList.add(n.focusCls),e.id=`${n.owner.id}-active-descendant`,n._activeItem=e}else n._activeItem=null,t===gi.getActiveElement(t)&&i.revertFocus()}updateTarget(e,t){const n=this,i={element:e,thisObj:n,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut",mousedown:{handler:"onTargetMouseDown",delegate:n.itemSelector}};n.itemsTabbable||n.itemsFocusable||(i.click="onTargetClick"),Object.prototype.hasOwnProperty.call(n,"acceptNode")||(n.acceptNode=n.acceptNode.bind(n),n.acceptNode.acceptNode=n.acceptNode),En.on(i),n.treeWalker=n.setupTreeWalker(e,gi.NodeFilter.SHOW_ELEMENT,n.acceptNode),n.keyEventTarget||(n.keyEventTarget=e),(n.targetMutationMonitor=new MutationObserver(n.onTargetChildListChange.bind(n))).observe(e,{childList:!0,subtree:!0})}setupTreeWalker(e,t,n){return document.createTreeWalker(e,t,n)}onTargetChildListChange(){const e=this,{activeItem:t,datasetIdProperty:n}=e;var i;t&&(e.target.contains(t)?t.classList.contains(e.focusCls)||t.classList.add(e.focusCls):e.activeItem=e.target.querySelector(`${e.itemSelector}.${e.focusCls}[data-${S.hyphenate(n)}="${t.dataset[n]}"]`)||(null===(i=e.target.querySelector(`${e.itemSelector}.${e.focusCls}`))||void 0===i?void 0:i[t.dataset.index])||null)}changeKeyEventTarget(e){this._keyEventTarget=e,En.on({element:e,keydown:"onKeyDown",thisObj:this})}triggerNavigate(e,t=this.activeItem){var n;const i={event:e,item:t,oldItem:this.previousActiveItem};this.trigger("navigate",i),null===(n=this.ownerCmp)||void 0===n||n.trigger("navigate",i)}}Ra._$name="Navigator";var Pa=e=>class extends e{static get $name(){return"LoadMaskable"}static get configurable(){return{loadMaskDefaults:{useTransition:!0,showDelay:1e3},loadMaskError:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},loadMask:{text:"L{GridBase.loadMask}"},syncMask:{text:"L{GridBase.syncMask}"},localizableProperties:["loadMask.text","syncMask.text"],testConfig:{loadMaskError:{icon:"b-icon b-icon-warning",autoClose:500,showDelay:0}}}}applyLoadMask(){const e=this,{loadMask:t}=e;return t&&(e.masked=so.mergeConfigs(e.loadMaskDefaults,t)),e.masked}applyMaskError(e){const{loadMaskError:t,masked:n}=this;return!1===t?n.hide():n&&(Nt.assign(n.errorDefaults,t),n.error=e),n}get widgetClass(){}};const _a=/(\d+)?:?(\d*)/;class Na{static format(e){const t=Math.floor(e/36e5),n=Math.floor(e/6e4)%60;return`${t}:${n<10?"0":""}${n}`}static parse(e){const t=typeof e;if("string"===t){const t=_a.exec(e);e=36e5*Number(t[1]||0)+6e4*Number(t[2]||0)}else"number"!==t?e=$t.getTimeOfDay(e):e<=24&&(e*=36e5);return Math.min(Math.max(Math.floor(e),0),864e5)}constructor(e){let t,n,i=0;null!=e&&e.isDayView?(i=e.dayStartShift,t=e.dayStartTime,n=e.dayEndTime):"number"==typeof e?i=t=n=e:e&&(i=e.startShift,t=e.timeStart,n=e.timeEnd),this.startShift=i=Na.parse(i||0),this.timeEnd=(null==n?(i+864e5)%864e5:Na.parse(n))||864e5,this.timeStart=null==t?i:Na.parse(t)}get startHour(){return Math.floor(this.timeStart/36e5)}get endHour(){return Math.floor(this.timeEnd/36e5)}get startTimeOffsetMs(){const{startShift:e,timeStart:t}=this;return t<e?864e5-e+t:t-e}get today(){return this.startOfDay(new Date)}ceil(e){const t=this.startOfDay(e);return t<e&&t.setDate(t.getDate()+1),t}contains(e){return!this.outside(e)}dateKey(e){return e=this.shiftDate(e,-1),$t.makeKey(e)}dayOfDate(e){return this.shiftDate($t.clearTime(e))}dayOfWeek(e){return(e=this.shiftDate(e,-1)).getDay()}delta(e,t="ms"){const{timeStart:n}=this,i=Na.parse(e),r=(this.startShift&&i<n?i+864e5:i)-n;return"ms"===t?r:$t.as(t,r,"ms")}duration(e="ms"){const{timeStart:t,timeEnd:n}=this,i=t<n?n-t:864e5-t+n;return"ms"===e?i:$t.as(e,i,"ms")}equals(e){return this.startShift===(null==e?void 0:e.startShift)&&this.timeStart===e.timeStart&&this.timeEnd===e.timeEnd}intersects(e,t){const n=this,{timeStart:i,timeEnd:r}=n,[s,o]=n._dateRangeArgs(e,t),[l,a]=n.timeRange(s,o);return i<r?l<a?l<r&&i<=a:l<r||i<=a:!(l<a)||l<r||i<=a}isIntraDay(e,t){const[n,i]=this._dateRangeArgs(e,t),r=this.startOfDay(n),s=864e5-$t.diff(r,i,"ms");return!(s<0)&&(s>0||r<n)}isInterDay(e){return e.allDay||!this.isIntraDay(...arguments)}outside(e){const{startShift:t,timeStart:n,timeEnd:i}=this,r=Na.parse(e);return n<i?r<n?r<t?1:-1:r<i?0:r<t?-1:1:r<i||r>=n?0:r<t?1:-1}parseKey(e){return this.dayOfDate($t.parseKey(e))}shiftDate(e,t=1){const{startShift:n}=this,i=typeof e;return e="number"===i?new Date(e):"string"===i?$t.parse(e):new Date(e.getTime()),t&&n&&e.setMilliseconds(t>0?n:-n),e}sortEvents(e,t){const n=this.startOfDay(e);return null==t?void 0:t.sort(((e,t)=>{e=e.eventRecord||e,t=t.eventRecord||t;let{startDate:i}=e,{startDate:r}=t;return i?r?(i=i<n?n:i,r=r<n?n:r,i-r||t.endDate-r-(e.endDate-i)):1:-1}))}startOfDay(e){return e=this.shiftDate(e,-1),e=$t.clearTime(e),e=this.shiftDate(e)}timeRange(e,t){const[n,i]=this._dateRangeArgs(e,t);return[$t.getTimeOfDay(n),$t.getTimeOfDay(i)]}toString(){const{startShift:e,timeEnd:t,timeStart:n}=this,i=e?`@${Na.format(e)}`:"",r=Na.format(n);return n===t?e?i:r:`${r}-${Na.format(t)}${i}`}_dateRangeArgs(e,t){return e.isModel?[e.startDate,e.endingDate]:[e,t]}}Na.MIDNIGHT=new Na({startShift:0,timeStart:0,timeEnd:24}),Na.MILLIS_PER_MINUTE=6e4,Na.MILLIS_PER_HOUR=36e5,Na.MILLIS_PER_DAY=864e5,Na._$name="DayTime";class ja extends(Pi(de)){static get configurable(){return{element:null,zoneWidth:50,scrollSpeed:5,direction:"both",startScrollDelay:500,stopScrollWhenPointerOut:!1,testConfig:{scrollSpeed:2,startScrollDelay:100},activeScroll:{$config:["lazy"],value:{}},monitoring:{$config:["lazy","nullify"],value:!0},owner:null}}changeMonitoring(e,t){return null==t||t.clear(),new Map}doDestroy(){this.stopMonitoring(),super.doDestroy()}get isScrolling(){return 0!==Object.keys(this.activeScroll).length}get rtl(){var e;return null===(e=this.owner)||void 0===e?void 0:e.rtl}startMonitoring(e={}){const t=this,{element:n,direction:i}=t,{scrollables:r=[],direction:s=i,callback:o}=e,l=[];return r.length||r.push({element:n}),r.forEach((e=>{const i=e.element;"string"==typeof i?gi.forEachSelector(n,i,(n=>{t.createMonitor(n,e.direction||s,e.callback||o),l.push(n)})):(t.createMonitor(i,e.direction||s,e.callback||o),l.push(i))})),function(){var e;null===(e=t.stopMonitoring)||void 0===e||e.call(t,l)}}createMonitor(e,t,n){const{monitoring:i}=this;i.has(e)||i.set(e,new Va({scrollManager:this,element:e,direction:t,callback:n}))}stopMonitoring(e){const t=this,{monitoring:n}=t;if(e=he.asArray(e),n){if(!e)return void n.forEach((e=>t.stopMonitoring(e.element)));e.forEach((e=>{const t=n.get(e);e.classList.remove("b-scrolling"),t&&(t.destroy(),n.delete(e))}))}}requestScroll(e,t){const{activeScroll:n}=this;return(!(e in n)||n[e]===t)&&(n[e]=t,!0)}releaseScroll(e){const{activeScroll:t={}}=this;Object.keys(t).forEach((n=>{t[n]===e&&delete t[n]}))}getRelativeScroll(e,t="left"){let n=0;return this.monitoring.forEach(((i,r)=>{gi.isDescendant(r,e)&&(n+="left"===t?i.scrollRelativeLeft:i.scrollRelativeTop)})),n}}class Va extends de{construct(e){const{element:t}=e,n=t.scrollLeft,i=t.scrollTop;Object.assign(e,{startScrollLeft:n,startScrollTop:i}),super.construct(e),En.on({element:t,scroll:"onElementScroll",mousemove:"onMouseMove",touchmove:"onMouseMove",capture:!0,thisObj:this}),En.on({element:t,pointerleave:"onPointerLeave",thisObj:this})}doDestroy(){this.stopScroll(),super.doDestroy()}startScroll(){this.scrolling=!0,this.performScroll()}stopScroll(){const e=this;e.scrolling=!1,e.scrollRequested&&(e.scrollManager.cancelAnimationFrame(e.frameId),e.scrollRequested=!1),e.scrollManager.clearTimeout(e.scrollTimeout),e.scrollManager.releaseScroll(e),e.scrollTimeout=null}onPointerLeave(){this.scrollManager.stopScrollWhenPointerOut&&this.stopScroll()}onMouseMove(e){const t=this,{scrollManager:n}=t,i=t.element.getBoundingClientRect(),r=n.zoneWidth,s=n.scrollSpeed;if(t.scrollDeltaX=t.scrollDeltaY=0,"vertical"!==t.direction){const{scrollLeft:o,scrollWidth:l,clientWidth:a}=t.element;n.rtl?e.clientX<i.left+r&&l+o-a>=1?t.scrollDeltaX=-Math.round((r+(i.left-e.clientX))/s)-1:e.clientX>i.right-r&&o<0&&(t.scrollDeltaX=Math.round((r-(i.right-e.clientX))/s)+1):e.clientX>i.right-r&&l-o-a>=1?t.scrollDeltaX=Math.round((r-(i.right-e.clientX))/s)+1:e.clientX<i.left+r&&o>0&&(t.scrollDeltaX=-Math.round((r+(i.left-e.clientX))/s)-1)}if("horizontal"!==t.direction){const{scrollTop:n,scrollHeight:o,clientHeight:l}=t.element;e.clientY>i.bottom-r&&o-n-l>=1?t.scrollDeltaY=Math.round((r-(i.bottom-e.clientY))/s)+1:e.clientY<i.top+r&&n>0&&(t.scrollDeltaY=-Math.round((r+(i.top-e.clientY))/s)-1)}0===t.scrollDeltaX||n.requestScroll("horizontal",t)||(t.scrollDeltaX=0),0===t.scrollDeltaY||n.requestScroll("vertical",t)||(t.scrollDeltaY=0),0===t.scrollDeltaX&&0===t.scrollDeltaY?t.stopScroll():t.scrollTimeout||(t.scrollTimeout=n.setTimeout((()=>t.startScroll()),n.startScrollDelay))}performScroll(){const e=this,{element:t}=e;if(e.scrolling&&!e.scrollRequested){if(0!==e.scrollDeltaX){const n=t.scrollLeft,i=Math.min(n+e.scrollDeltaX,t.scrollWidth-t.clientWidth);i!==n&&(t.scrollLeft=i)}if(0!==e.scrollDeltaY){const n=t.scrollTop,i=Math.min(n+e.scrollDeltaY,t.scrollHeight-t.clientHeight);i!==n&&(t.scrollTop=i)}e.scrollRequested=!0,e.frameId=e.scrollManager.requestAnimationFrame((()=>{e.scrollRequested=!1,e.performScroll(e)}))}}onElementScroll(){var e,t;null===(e=this.config)||void 0===e||null===(t=e.callback)||void 0===t||t.call(this.thisObj||this.scrollManager,this)}get scrollLeft(){return this.element.scrollLeft}get scrollTop(){return this.verticalElement?this.verticalElement.scrollTop:this.element.scrollTop}get scrollRelativeLeft(){return this.scrollLeft-this.startScrollLeft}get scrollRelativeTop(){return this.scrollTop-this.startScrollTop}getRelativeLeftScroll(e){return this.scrollManager.getRelativeScroll(e,"left")}getRelativeTopScroll(e){return this.scrollManager.getRelativeScroll(e,"top")}}ja._$name="ScrollManager";const za={left:!0,right:!0,top:!0,bottom:!0,transform:!0},Ba={true:1,false:1},Wa=Promise.resolve();class Ha extends pa{static get $name(){return"Tooltip"}static get type(){return"tooltip"}static get configurable(){return{mouseOffsetX:15,mouseOffsetY:15,html:{$config:{equals:()=>!1}},getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:!1,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:null,anchor:!0,align:{align:"b-t",minHeight:300},axisLock:!0,activeTarget:null,testConfig:{hideDelay:100,hoverDelay:100,showAnimation:null,hideAnimation:null}}}afterConfigure(){const e=this,{forSelector:t}=e;t&&(e.showOnHover=!0,e.forElement||(e.anchorToTarget||(e.trackMouse=!0),e.forElement=e.rootElement.host||e.rootElement)),super.afterConfigure(),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=En.on({element:e.forElement,pointerover:"internalOnPointerOver",pointerout:"internalOnPointerOut",thisObj:e}))}doDestroy(){var e;null===(e=this.pointerOverOutDetacher)||void 0===e||e.call(this),super.doDestroy()}set focusOnToFront(e){super.focusOnToFront=e}get focusOnToFront(){return super.focusOnToFront&&gi.usingKeyboard}get focusElement(){const e=super.focusElement;if(e!==this.element)return e}get anchorToTarget(){return this._anchorToTarget&&!this.trackMouse}get anchor(){return super.anchor&&!this.trackMouse}set anchor(e){super.anchor=e}onDocumentMouseDown({event:e}){const t=this,{triggeredByEvent:n}=t;n&&gi.isTouchEvent&&e.pageX===n.pageX&&e.pageY===n.pageY&&t.activeTarget.contains(e.target)&&performance.now()-n.timeStamp<500||(t.abortDelayedShow(),super.onDocumentMouseDown({event:e}))}internalOnPointerOver(e){const t=this,{target:n,relatedTarget:i}=e,{forElement:r,forSelector:s,activeTarget:o}=t;let l;if(!(t.disabled||t.owner&&!t.owner.showTooltipWhenDisabled&&t.owner.disabled||t.allowOver&&t.element.contains(n))){if(s){if(l=n.closest(s),null!=o&&o.contains(n)&&o.contains(i)&&l===o)return;if(l&&(null==i?void 0:i.closest(s))===l)return}else{if(r.contains(i))return;l=r}l?t.handleForElementOver(e,l):o&&t.handleForElementOut()}}onTransitionEnd(e){const t=this,{currentOverElement:n}=Ha;if(za[e.propertyName]){var i;if(t.allowOver&&t.element.contains(n))return;null!==(i=t.activeTarget)&&void 0!==i&&i.contains(n)&&!t.trackMouse&&t.realign()}}async handleForElementOver(e,t){const n=this,{activeTarget:i,hideOnDelegateChange:r,anchorToTarget:s}=n,o=t!==i,l=o&&r;if(!1===n.trigger("pointerOver",{event:e,target:t}))n.internalOnPointerOut(e);else{if(n.triggeredByEvent=e,n.hasTimeout("hide")&&(n.abortDelayedHide(),!o))return;if(!r&&n.element.classList.contains("b-hiding")&&n.cancelHideShowAnimation(),!n._hidden&&l&&n.hide(!1),n.activeTarget=t,n.isVisible){const e=n.updateContent();if(L.isPromise(e)&&!n.loadingMsg&&await e,!1===n.trigger("beforeShow"))return n.hide();n.alignTo({[s?"target":"position"]:s?t:"mouse",overlap:!(s&&n.anchor)}),n.trigger("show"),n.afterShowByTarget()}else n.delayShow(t)}}async delayShow(e){var t;const n=this;if(null!==(t=n.currentAnimation)&&void 0!==t&&t.showing&&n.cancelHideShowAnimation(),n.isVisible||n.hasTimeout("show"))n.isVisible&&n.showByTarget(e);else if(!n.hoverDelay||n.forSelector&&Date.now()-n.lastHidden<n.quickShowInterval){const t=n.updateContent();L.isPromise(t)&&!n.loadingMsg&&await t,n.showByTarget(e)}else n.addDocumentMouseDownListener(),n.listeningForMouseMove||n.anchorToTarget||(n.mouseMoveRemover=En.on({element:n.rootElement,mousemove:"onMouseMove",thisObj:n})),n.setTimeout((async()=>{if(!gi.isOrphaned(e)){const t=n.updateContent();L.isPromise(t)&&!n.loadingMsg&&await t,n.showByTarget(e)}}),n.triggeredByEvent&&"pointerover"!==n.triggeredByEvent.type?0:n.hoverDelay,"show")}changeAllowOver(e){return this.inAfterShow||(this.configuredAllowOver=e),e}updateAllowOver(e){const t=this,{element:n}=t;var i;(n.classList.toggle("b-allow-over",Boolean(e)),e)?t.allowOverlisteners=En.on({element:n,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:t}):null===(i=t.allowOverlisteners)||void 0===i||i.call(t)}updateContent(){const e=this;if(e.getHtml){const t=e.callback(e.getHtml,e,[{tip:e,element:e.element,activeTarget:e.activeTarget,event:e.triggeredByEvent}]);return e.html=t,t}}get hasContent(){return Boolean(gi.isReactElement(this._html)||""!==this._html&&"string"==typeof this.html&&this.html.length||this.items.length)}internalBeforeShow(){return(this.updateContentOnMouseMove||this.hasContent)&&!this.disabled}showAsyncMessage(e=this.optionalL(this.loadingMsg)){e&&(this.html=`\n                <div class="b-tooltip-loading">\n                    <i class="b-icon b-icon-spinner"></i>\n                    ${e}\n                </div>\n            `)}beforeAlignTo(e){super.beforeAlignTo(e);const t=this;t.anchorToTarget||"mouse"!==e.position||(e.position=new mn(t.triggeredByEvent.pageX-globalThis.pageXOffset+t.mouseOffsetX*(t.rtl?-1:1),t.triggeredByEvent.pageY-globalThis.pageYOffset+t.mouseOffsetY))}showByTarget(e){var t;const n=this,{anchorToTarget:i}=n;n.mouseMoveRemover=null===(t=n.mouseMoveRemover)||void 0===t?void 0:t.call(n),n.showBy({[i?"target":"position"]:i?e:"mouse",overlap:!(i&&n.anchor)})}afterShowByTarget(){const e=this,{dismissDelay:t}=e;e.abortDelayedShow(),t&&e.setTimeout("hide",t),e.toFront(),e.mouseMoveRemover||!e.trackMouse&&!e.updateContentOnMouseMove||(e.mouseMoveRemover=En.on({element:e.rootElement,pointermove:"onMouseMove",thisObj:e})),e.inAfterShow=!0,e.allowOver=e.allowOver||0!=e.configuredAllowOver&&e.childItems.some((e=>e.isVisible&&!e.disabled&&e.focusElement)),e.inAfterShow=!1}updateActiveTarget(e,t){e&&!this.isConfiguring&&this.trigger("overTarget",{newTarget:e,lastTarget:t})}internalOnPointerOut(e){var t;const n=this,i=e.relatedTarget;n.allowOver&&n.element.contains(i)||n.element.contains(e.target)&&null!==(t=n.activeTarget)&&void 0!==t&&t.contains(i)||n.activeTarget&&!n.activeTarget.contains(i)&&n.handleForElementOut()}handleForElementOut(){const e=this,{hideDelay:t}=e;!1!==e.trigger("pointerOut")?(e.abortDelayedShow(),e.isVisible&&!1!==t&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())):e.activeTarget=null}show(e){const t=this;!e&&t.forElement&&t.anchorToTarget&&!t.forSelector?t.showByTarget(t.forElement):super.show(...arguments),t.afterShowByTarget(),!t.forElement||t.transitionEndDetacher||t._hidden||(t.transitionEndDetacher=En.on({element:t.forElement,transitionend:"onTransitionEnd",thisObj:t}))}hide(){const e=this;if(e.abortDelayedShow(),e._hidden)return Wa;{var t,n;e.abortDelayedHide();const i=super.hide(...arguments);return e.lastHidden=Date.now(),e.activeTarget=null,null===(t=e.mouseMoveRemover)||void 0===t||t.call(e),e.mouseMoveRemover=null,null===(n=e.transitionEndDetacher)||void 0===n||n.call(e),e.transitionEndDetacher=null,i}}abortDelayedShow(){const e=this;var t,n,i;e.hasTimeout("show")&&(null===(t=e.mouseDownRemover)||void 0===t||t.call(e),e.mouseDownRemover=null,e.clearTimeout("show"),null===(n=e.mouseMoveRemover)||void 0===n||n.call(e),e.mouseMoveRemover=null,null===(i=e.transitionEndDetacher)||void 0===i||i.call(e),e.transitionEndDetacher=null)}abortDelayedHide(){this.clearTimeout("hide")}realign(){const e=this,t=e.lastAlignSpec;e.isConfiguring||e.isVisible||null==t||!t.targetOutOfView||(t.allowTargetOut||gi.isInView(t.target,!1,e))&&(e.show(),t.targetOutOfView=!1),super.realign()}alignTo(e){const t=this;t.isVisible&&(!e||t.triggeredByEvent&&t.element.contains(t.triggeredByEvent.target)||e.nodeType===Node.ELEMENT_NODE&&(e={target:e}),super.alignTo(e))}changeHtml(e){const t=this;return L.isPromise(e)?(t.showAsyncMessage(),e.target=t.activeTarget,void e.then((n=>{e.target===t.activeTarget&&(t.html=n)}))):("object"!=typeof e&&(e=null!=e?t.optionalL(String(e)):""),e)}updateHtml(e,t){const n=this;let i=""===e;i||(super.updateHtml(e,t),n.hasContent?(n.isVisible&&n.realign(),L.isPromise(e)||n.trigger("innerHtmlUpdate",{value:e})):i=!0),i&&n.hide()}onMouseMove(e){const t=this,{forElement:n,activeTarget:i}=t,r=t.hasTimeout("hide"),s=e.target;if(t.triggeredByEvent=e,!t._hidden){let o;const l=!(null==i?void 0:i.contains(s))&&t.forSelector&&i&&!r&&s.nodeType===Node.ELEMENT_NODE&&!s.matches(t.forSelector)&&!(t.allowOver&&t.element.contains(s)),a=null!=n&&n.document?n.document.documentElement:n,c=a&&(a.contains?a.contains(s):16&a.compareDocumentPosition(s));if(l&&(o=t.handleForElementOut()),o||!r||c){if(t.dismissDelay&&!r&&t.setTimeout("hide",t.dismissDelay),t.updateContentOnMouseMove&&t.getHtml&&(t.html=t.callback(t.getHtml,t,[{tip:t,element:t.element,forElement:i,event:e}]),!t.html))return void t.hide();t.trackMouse&&t.alignTo({position:"mouse",ignorePageScroll:!0})}}}onOwnElementMouseEnter(e){this.abortDelayedHide()}static getSharedTooltip(e,t){var n,i;let r=null===(n=e.bryntum)||void 0===n||null===(i=n.tooltip)||void 0===i?void 0:i.get(Ha);if(!r&&!t){var s;null!==(s=e.bryntum)&&void 0!==s&&s.tooltip||Nt.setPath(e,"bryntum.tooltip",new Map);const t=e.bryntum.tooltip;t.set(Ha,!0),r=new Ha({forElement:e,rootElement:e,forSelector:"[data-btip]",resetCfg:{},isShared:!0,cls:"b-tooltip-shared",internalListeners:{pointerOver({source:e,target:t}){for(const t in e.resetCfg)"listeners"===t?e.un(e.resetCfg[t].set):"html"!==t&&(e[t]=e.resetCfg[t].was);e.resetCfg={};const n=Io.getById(t.id),i=(null==n?void 0:n.tipConfig)||e.gatherDataConfigs(t.dataset);if(n&&n.element!==t||!n&&t.matches(".b-widget")||null!=n&&n.disabled&&!n.showTooltipWhenDisabled)return!1;e.owner=n;for(const t in i)e.resetCfg[t]={set:i[t],was:e[t]},"listeners"===t?e.ion(i[t]):e[t]=i[t]},hide({source:e}){e.owner=null}},gatherDataConfigs(e){const t=this,n={};for(const i in e)if(i.startsWith("btip"))if(i.length>4){const r=S.uncapitalize(i.substr(4));if(r in t.getDefaultConfiguration()){const t=e[i];n[r]=Ba[t]?"true"===t:isNaN(t)?t:parseInt(t,10)}}else n.html=e[i];return n}}),En.on({element:e,mouseenter:e=>Ha.currentOverElement=e.target,keydown:e=>Ha.currentOverElement=e.target,capture:!0,thisObj:r}),t.set(Ha,r)}return r}static encodeConfig(e){const t={};if("string"==typeof e)t.btip=e;else for(const n in e)t[`btip${"html"===n?"":S.capitalize(n)}`]=e[n];return t}}Ha.initClass(),Object.defineProperty(Io,"tooltip",{get:()=>Ha.getSharedTooltip(document.body)}),Io.Tooltip=Ha,Ha._$name="Tooltip";var Ua=e=>class extends(e||de){static get $name(){return"Labelable"}static get configurable(){return{label:null,labelPosition:"before",labelCls:null,labelWidth:{value:null,$config:{localeKey:"L{labelWidth}"}}}}get hasLabel(){return Boolean(this.label)}compose(){const{hasLabel:e,labelPosition:t}=this;return{class:{[`b-label-${t}`]:e,"b-has-label":e}}}changeLabel(e){return e||""}setupLabel(e){return Nt.assign({tag:"label",for:`${this.id}-input`,class:`b-label b-align-${e.align||"start"}`},e)}updateLabelWidth(e){this.labelElement&&(this.labelElement.style.flex=`0 0 ${gi.setLength(e)}`,this.inputWrap.style.flexBasis=null==e?"":"auto")}get widgetClass(){}};class qa extends Bo{static get $name(){return"FieldContainer"}static get type(){return"fieldcontainer"}static get configurable(){return{animation:{duration:300},collapsed:null,collapser:{value:null,$config:"nullify"},syncableConfigs:null,syncConfigTriggers:{$config:{merge:"classList"},value:null},testConfig:{animation:{duration:10}}}}static get delayable(){return{syncChildConfigs:"raf"}}get inline(){var e;return null!==(e=this.owner.inline)&&void 0!==e?e:1===this.ensureItems().count}changeCollapsed(e){if(this.togglingCollapse)return this.togglingCollapse=!1,e;this.toggleCollapse(Boolean(e))}updateCollapsed(e){var t;this.collapser=null===(t=this.collapser)||void 0===t?void 0:t.destroy(),this.setCollapsedCls(e)}updateCollapser(e,t){t&&null==t.completed&&(t.reverting&&e||t.destroy()),this.setOwnerCls("b-collapsing",e)}get collapsing(){const{collapser:e}=this;return null!=e&&e.collapsed}get collapsingExpanding(){return null!=this.collapser}get expanding(){const{collapser:e}=this;return null!=e&&!e.collapsed}collapse(e){this.toggleCollapse(!0,e)}expand(e){this.toggleCollapse(!1,e)}setCollapsedCls(e){this.setOwnerCls("b-collapsed",e)}setOwnerCls(e,t){var n,i;null===(n=this.owner)||void 0===n||null===(i=n.element)||void 0===i||i.classList[t?"add":"remove"](e)}syncChildConfigs(){const e=this,{owner:t,syncableConfigs:n}=e;if(n){let i,r;for(i in n)r=n[i](t),e.eachWidget((e=>{e[i]=r}),!1)}t.afterSyncChildConfigs(e)}syncContainer(){const{inline:e,layout:t}=this;this.autoLayout&&(t.horizontal=e,t.justify=e?"center":"stretch")}toggleCollapse(e,t){const n=this,{animation:i,collapser:r,inline:s}=n,{containerWrapElement:o}=n.owner,l=t=>{t&&(n.element.style.height="",n.togglingCollapse=!0,n.collapsed=e,n.collapser=null)};if(null==e&&(e=!n.collapsed),!1!==t&&null!==t&&(o&&n.isVisible?(!0===t?t={}:"number"==typeof t&&(t={duration:t}),t=i||t?Nt.merge({},i,t):null):t=null),t){if(r&&e!==r.collapsed)n.collapser=r.revert({finalize:l}),n.collapser.collapsed=e;else if(!r&&e!==n.collapsed){!e&&n.setCollapsedCls(!1);const{element:i}=n,{height:r}=i.getBoundingClientRect(),a=s?1:r;!e&&n.setCollapsedCls(!0),i.style.height=`${r}px`,n.collapser=Qo.run(Nt.merge({finalize:l,element:o,[s?"opacity":"height"]:{from:e?a:0,to:e?0:a}},t)),n.collapser.collapsed=e}}else n.togglingCollapse=!0,n.collapsed=e}}qa.initClass(),qa._$name="FieldContainer";const Ya=(e,t)=>(e.weight||0)-(t.weight||0),Ka=(e,t)=>(t.weight||0)-(e.weight||0),Ga=[],Xa={align:!0,weight:!0};class Ja extends(Io.mixin(Bl,Ua)){static get $name(){return"Field"}static get type(){return"field"}static get configurable(){return{defaultBindProperty:"value",placeholder:null,value:"",name:null,labels:null,required:null,clearable:null,revertOnEscape:null,hint:null,hintHtml:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder","labelWidth"],autoSelect:!1,autoComplete:"off",spellCheck:null,validateOnInput:!0,inputAttributes:null,inputType:"text",inputAlign:null,attributes:{value:["placeholder","autoComplete","spellCheck","minLength","maxLength","pattern","tabIndex","min","max"],$config:{merge:"distinct"}},nullValue:{$config:null,value:null,default:null},updatedClsDuration:500,inputReadOnly:!1,ariaElement:"input",container:{$config:"nullify",value:null},containerDefaults:{type:"fieldcontainer",syncableConfigs:{disabled:e=>e.disabled},syncConfigTriggers:{disabled:1}},containValues:null,inline:null,testConfig:{updatedClsDuration:10},keyMap:{}}}static get delayable(){return{highlightChanged:"raf"}}doDestroy(){var e,t,n;const i=this,{triggers:r}=i,s=i.isPainted&&Ja.getSharedErrorTooltip(i.rootElement,!0);if(null===(e=i.inputListenerRemover)||void 0===e||e.call(i),null===(t=i.keyListenerRemover)||void 0===t||t.call(i),null===(n=i.container)||void 0===n||n.destroy(),super.doDestroy(),r)for(const e of Object.values(r))e.destroy();(null==s?void 0:s.field)===i&&s.hide()}get childItems(){const{container:e,triggers:t}=this,n=t?Object.values(t):[];return e?[...n,...e.childItems]:n}get invalidValueError(){return"L{invalidValue}"}get errorTip(){return this.constructor.getSharedErrorTooltip(this.rootElement)}static getSharedErrorTooltip(e,t){var n;let i=null===(n=e.bryntum)||void 0===n?void 0:n.errorTooltip;return i||t||(e.bryntum=e.bryntum||{},i=new Ha({cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:{align:"l-r",monitorTargetMutation:!0},scrollAction:"realign",trapFocus:!1,rootElement:e,onBeforeShow(){const e=this,t=Io.fromElement(e.activeTarget);if(t){const n=t.getErrors();if(n)return e.html=n.join("<br>"),e.field=t,!0}return!1}}),e.bryntum.errorTooltip=i),i}static get errorTip(){return this.getSharedErrorTooltip(document.body)}construct(e){super.construct(e);const t=this;t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}changeKeyMap(e){const t=this;let n={};e&&(t._fieldKeyMap?Nt.assign(n,t._fieldKeyMap):(t._fieldKeyMap=e,Nt.assign(n,e)));for(const e in t.triggers){var i;null!==(i=t.triggers[e])&&void 0!==i&&i.keyMap&&(n=t.mergeKeyMaps(n,t.triggers[e].keyMap,e))}return n}get keyMapSubComponents(){return this.triggers}onFocusIn(e){const t=this;t.valueOnFocus=Nt.clone(t.value),t.validOnFocus=!(t.errors&&Object.keys(t.errors).length),super.onFocusIn(e),t.focusing=!0,t.syncInvalid(),t.focusing=!1}onFocusOut(e){super.onFocusOut(e),this.syncRequired(),this.onEditComplete()}onEditComplete(){}get rootUiClass(){return Ja}compose(){this.getConfig("clearable");const e=this,{container:t,innerElements:n,label:i,labels:r,labelCls:s,readOnly:o,triggers:l}=e,a=Nt.values(l,((e,t)=>!t)),c=a.filter((e=>"start"===e.align)).sort(Ya),d=a.filter((e=>"start"!==e.align)).sort(Ka),u=e.setupLabel.bind(e),h=[...c.map((e=>e.element)),...n,...d.map((e=>e.element))];return{class:{"b-has-start-trigger":c.length,"b-no-input":!n.length,"b-readonly":o,"b-field-container":Boolean(t),"b-field-container-inline":null==t?void 0:t.inline},children:[...(r||Ga).filter((e=>e&&"end"!==e.align)).map(u),i?u({reference:"labelElement",class:`b-label b-align-start ${s||""}`,html:i}):null,h.length?{class:"b-field-inner",reference:"inputWrap",children:h}:null,...(r||Ga).filter((e=>"end"===(null==e?void 0:e.align))).map(u),...t?[{reference:"containerWrapElement",children:[t.element],class:{"b-field-container-wrap":1}}]:Ga]}}updateElement(e,t){var n;const i=this,r=i.initialConfig.value,{input:s}=i;super.updateElement(e,t),null!=r&&(i.value=r),i.syncEmpty(),i.updateInputReadOnly(i.inputReadOnly),i.syncInvalid();const o=s||i.focusElement;null===(n=i.keyListenerRemover)||void 0===n||n.call(i),i.keyListenerRemover=o&&En.on({element:o,thisObj:i,keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}get innerElements(){return[this.inputElement]}get inputElement(){const{attributes:e,inputAttributes:t,id:n,inputCls:i,inputType:r,name:s}=this,o=Nt.assign({reference:"input",tag:"input",type:r,name:s||n,id:`${n}-input`,retainElement:!0},t);i&&(o.class=i);for(let t,n,i=e.length;i-- >0;)t=e[i],n=this[t],null!=n&&(o[t]=n);return o}get caretPos(){return this.textSelection[0]}set caretPos(e){this.textSelection=e}get focusElement(){return this.input}get textSelection(){const e=this.input;let t;try{t=[e.selectionStart,e.selectionEnd,e.selectionDirection]}catch(i){var n;t=(null===(n=e.value)||void 0===n?void 0:n.length)||0,t=[t,t]}return t}set textSelection(e){"number"==typeof e?this.select(e,e):this.select(...e)}get hasTextSelection(){const[e,t]=this.textSelection;return e&&t-e>0}getAfterValue(e){const[t,n]=this.textSelection,i=this.input.value;return`${i.substr(0,t)}${e}${i.substr(n||t)}`}select(e,t){const n=this.focusElement;if(n.value.length){if(0===arguments.length)return void this.selectAll();if(!this.supportsTextSelection)return;n.setSelectionRange(e,t)}}moveCaretToEnd(){const e=this.input;if(e.createTextRange){const t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}selectAll(){this.focusElement.select()}syncEmpty(){var e;const{isEmptyInput:t,isEmpty:n,element:i}=this,r=null===(e=this.triggers)||void 0===e?void 0:e.clear,s=t&&n;i&&(r&&r[s?"hide":"show"](),i.classList.toggle("b-empty",s))}updateHint(){this.syncHint()}updateHintHtml(){this.syncHint()}syncHint(){const e=this,{input:t,hint:n,hintHtml:i}=e,r=null==t?void 0:t.parentElement;if(t){let s=i||n;const o=e.hintElement||s&&(e.hintElement=gi.createElement({parent:r,className:"b-field-hint",nextSibling:t.nextSibling,children:[{className:"b-field-hint-content"}]}));o&&("function"==typeof s&&(s=s({source:e,value:e.value})),o.firstChild[i?"innerHTML":"textContent"]=s||""),e.element.classList[s?"remove":"add"]("b-field-no-hint")}}syncInvalid(){const e=this,{isPainted:t}=e;if(e.updatingInvalid=!0,t){const{isValid:t,element:n,inputWrap:i}=e;if(n.classList[t?"remove":"add"]("b-invalid"),t){const t=e.constructor.getSharedErrorTooltip(e.rootElement,!0);null!=t&&t.isVisible&&t.field===e&&t.hide()}else{const t=e.errorTip;t&&(e.containsFocus||e.isVisible&&i.contains(Ha.currentOverElement))&&(t.activeTarget===i&&t.isVisible?t.onBeforeShow():(t.activeTarget=i,t.showBy(i)))}}e.updatingInvalid=!1}updateEditable(){this.syncInputReadOnly()}syncInputReadOnly(){this.getConfig("readOnly"),this.inputReadOnly=this._readOnly||!1===this.editable}updateInputReadOnly(e){const t=this,{input:n,inputListenerRemover:i}=t;n&&(n.readOnly=e?"readOnly":null,e?t.inputListenerRemover=null==i?void 0:i():i||(t.inputListenerRemover=En.on({element:n,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"})))}changeReadOnly(e){return Boolean(e)}updateReadOnly(e){this.syncInputReadOnly()}updateClearable(e){const t=this;t.getConfig("triggers"),t.triggers={clear:e&&Nt.assign({cls:"b-icon-remove",weight:1e3,key:"Shift+backspace",handler(){t._isUserAction=!0,t.clear(...arguments),t._isUserAction=!1}},e)||null}}changeTriggers(e,t){const n=this,i=n.$triggers||(n.$triggers=new Il({configName:"triggers",factory:Ja.Trigger,inferType:!1,owner:n,created(e){be.after(e,"onConfigChange",((e,{name:t})=>{Xa[t]&&n.onConfigChange({name:"triggers",value:i.target})}))},setup(e,t){e.reference=e.ref=t,e.parent=n}}));if(!1===n.stepTriggers&&(e.back||e.forward)&&(delete(e=Nt.assign({},e)).back,delete e.forward),i.update(e),n.element&&(n.keyMap=n.keyMap),!t)return i.target}updateInputWidth(e){this.input.style.width=gi.setLength(e),this.element.classList.add("b-has-width")}updateInputAlign(e){this.input.style.textAlign=e}get isValid(){const e=this;if(!e.disabled){if(e.syncRequired(),e.errors&&Object.keys(e.errors).length)return!1;const t=e.validity;if(t)return t.valid}return!0}get isEmpty(){return null==this.value||""===this.value}get isEmptyInput(){return!this.input||null==this.input.value||""===this.input.value}get validity(){const e=this.input;return null==e?void 0:e.validity}changeValue(e,t){return null==e&&(e=this.nullValue),this.hasChanged(t,e)?e:(""===e&&this.syncRequired(),t)}updateValue(e,t){const n=this;n.isConfiguring||(n.syncRequired(),n.inputting||n.triggerChange()),n.inputting||(n._lastValue=e),n.syncInputFieldValue(),n.overflowTwin&&!n._overflowTwinSync&&(n._overflowTwinSync=!0,n.overflowTwin.value=e,n._overflowTwinSync=!1)}hasChanged(e,t){return t!==e}syncInputFieldValue(e=!1){const t=this,{input:n,parent:i,inputValueAttr:r,inputValue:s}=t;if(n&&!t.inputting&&n[r]!==s&&(n[r]=s,!t.isConfiguring&&!t.containsFocus&&t.highlightExternalChange)){if(n.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),i){const{assigningValues:t}=i;!0!==t&&!1!==(null==t?void 0:t.highlight)||(e=!0)}e||t.highlightChanged()}t.syncEmpty(),t.syncInvalid()}highlightChanged(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}removeUpdatedCls(){this.input.classList.remove("b-field-updated")}get inputValue(){return null==this.value?"":this.value}get inputValueAttr(){return"value"}get supportsTextSelection(){const e=this.focusElement;return e&&("textarea"===e.tagName.toLowerCase()||e.type&&/text|search|password|tel|url/.test(e.type))}internalOnInputFocus(){this.autoSelect&&this.selectAll()}internalOnChange(e){const t=this;t.hasChanged(t._lastValue,t.value)&&t.isValid&&(t.triggerChange(e,!0),t._lastValue=t.value)}triggerChange(e,t=Boolean(this._isUserAction)){const n=this,{value:i,_lastValue:r,isValid:s}=n;n.syncHint(),n.triggerFieldChange({value:i,oldValue:r,event:e,userAction:t,valid:s}),"change"===n.defaultAction&&n.trigger("action",{value:i,oldValue:r,event:e,userAction:t,valid:s})}fetchInputValue(){this.value=this.input[this.inputValueAttr]}internalOnInput(e){var t;const n=this;n.validateOnInput||n.errorTip.hide(),n.inputting=!0,n.fetchInputValue(),n.inputting=!1,n.trigger("input",{value:n.value,event:e}),null===(t=n.changeOnKeyStroke)||void 0===t||t.call(n,e)}get needsInputSync(){var e;return this.input[this.inputValueAttr]!==String(null!==(e=this.inputValue)&&void 0!==e?e:"")}internalOnKeyEvent(e){const t=this,{value:n}=t;let i=!1;if("keydown"===e.type&&"Escape"===e.key&&!t.readOnly&&!t.disabled){const e=t.isValid,r="initialValue"in t?t.initialValue:t.valueOnFocus,s=t.hasChanged(r,n),{needsInputSync:o}=t;t.revertOnEscape&&(!e||s||o)&&(s&&(t.value=r),o&&t.syncInputFieldValue(!0),t.clearError(),i=(s||o)&&t.isValid||e!==t.validOnFocus)}t.isDestroyed||(i&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}clear(e){const t=this,{value:n}=t;(n!==t.nullValue||t.input.value.length>0)&&(t.value=t.nullValue,t.clearError(),t.syncInvalid(),t.trigger("clear",{event:e}))}onDisabled(){this.syncInvalid()}syncRequired(){var e;const t=this;t.isConfiguring||t.focusing||!t.required||!t.isEmpty||null!==(e=t.parent)&&void 0!==e&&e.isSettingValues?t.clearError("L{fieldRequired}",t.updatingInvalid):t.setError("L{fieldRequired}",t.updatingInvalid)}setError(e,t,n){const i=this;if((i.errors||(i.errors={}))[i.optionalL(e)]=1,t||i.syncInvalid(),n){const t=()=>{i.clearError(e),n()},n=i.ion({keydown:t,focusOut:t})}}clearError(e,t){const n=this;n.errors&&(e?delete this.errors[this.optionalL(e)]:n.errors={}),t||n.syncInvalid()}getErrors(){const e=this;if(!e.isValid){var t;const n=e.validity,i=Nt.keys(n).find((e=>"valid"!==e&&"customError"!==e&&n[e])),r=e.errors&&Object.keys(e.errors);let s;if(s=null!=r&&r.length?r:n.customError?[e.input.validationMessage]:i?[e.L(i,{min:e.min,max:e.max})]:[e.L(e.invalidValueError)],(null===(t=s)||void 0===t?void 0:t.length)>0)return s}}createOverflowTwin(e){const t=this,n=super.createOverflowTwin(e);return n.ion({change({value:e}){t._overflowTwinSync=!0,t.value=e,t._overflowTwinSync=!1}}),n}get containerCollapsed(){var e;return null===(e=this.container)||void 0===e?void 0:e.collapsed}set containerCollapsed(e){const{container:t}=this;t&&(t.collapsed=e)}afterSyncChildConfigs(e){}changeContainer(e,t){e&&(Array.isArray(e)||!("type"in e)&&!("items"in e))&&(e={items:e});const n=this,i=e&&Nt.merge({owner:n,layout:"box"},n.containerDefaults),r=Io.reconfigure(t,e,{owner:n,defaults:i});if(!r||(r.autoLayout="box"===(null==i?void 0:i.layout),r!==t))return r;r.syncContainer()}onConfigChange(e){var t,n;super.onConfigChange(e),null!==(t=this.container)&&void 0!==t&&null!==(n=t.syncConfigTriggers)&&void 0!==n&&n[e.name]&&this.container.syncChildConfigs()}assignValue(e,t){const{container:n,containValues:i}=this,r=this.getValueName(t);n&&!1!==i?e&&"nested"===i?e&&r in e&&(e=Nt.clone(e[r]),super.assignValue({[r]:e&&!("value"in e)||e.value},t),e&&delete e.value,n.assignValue(e,t)):(super.assignValue(e,t),n.assignValue(e,t)):super.assignValue(e,t)}gatherValue(e){super.gatherValue(e),this.gatherValues(e)}gatherValues(e,n){var i;const r=this,{container:s,containValues:o,valueName:l}=r,a=typeof o;n=null!==(i=n)&&void 0!==i?i:l in e,s&&!1!==o&&("nested"===o?n&&(e[l]=t({value:e[l]},s.values)):(!0===o||null==o&&n||"string"===a&&r[o]||"function"===a&&o(r))&&s.gatherValues(e))}updateContainer(e,t){t&&this.detachListeners(t.id),e&&(e.rendered||e.render(),e.syncContainer(),e.syncChildConfigs())}}Ja.Trigger=class extends Io{static get $name(){return"FieldTrigger"}static get factoryable(){return{defaultType:Ja.Trigger,extends:null}}static get type(){return"trigger"}static get configurable(){return{align:null,weight:null,role:void 0}}get field(){return this.parent}construct(){super.construct(...arguments),this.key&&(this.keyMap={[this.key]:"onClick"})}compose(){return{"aria-hidden":!0,class:{[`b-align-${this.align||"end"}`]:1,"b-icon":1},listeners:{click:"onClick",mousedown:"onMousedown"}}}changeAlign(e){return e}onClick(e){const t=this,{field:n}=t;n.disabled||n.readOnly||(e.key&&e.preventDefault(),!1!==n.trigger("trigger",{trigger:t})&&t.handler&&n.callback(t.handler,n,[e,t]))}onMousedown(e){const t=this.field;!("key"in e)&&gi.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout((()=>t.editable=!0),500)),e.preventDefault(),gi.getActiveElement(t.input)!==t.input&&t.focus()}},Ja.SpinTrigger=class extends Ja.Trigger{static get $name(){return"SpinTrigger"}static get type(){return"spintrigger"}static get configurable(){return{repeat:{$config:["nullify"],value:!0}}}compose(){return{children:{upButton:{class:{"b-icon":1,"b-spin-up":1}},downButton:{class:{"b-icon":1,"b-spin-down":1}}}}}updateRepeat(e){var t;null===(t=this.clickRepeater)||void 0===t||t.destroy(),this.clickRepeater=e?el.new({element:this.element},e):null}onClick(e){const t=this,{field:n}=t;n.disabled||n.readOnly||(e.target===t.upButton?n.doSpinUp(e.shiftKey):e.target===t.downButton&&n.doSpinDown(e.shiftKey))}},Ja.Trigger.initClass(),Ja.SpinTrigger.initClass(),Io.register(Ja.Trigger,"trigger"),Io.register(Ja.SpinTrigger,"spintrigger"),Ja._$name="Field";class Za extends Ja{static get type(){return"textfield"}static get alias(){return"text"}static get configurable(){return{nullValue:""}}static get $name(){return"TextField"}construct(e){"hidden"===(null==e?void 0:e.inputType)&&(e.hidden=!0),super.construct(...arguments)}}Za.initClass(),Za._$name="TextField";class Qa extends Za{static get $name(){return"PickerField"}static get type(){return"pickerfield"}static get configurable(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:{value:{floating:!0},$config:["lazy","nullify"]},inputType:"text",monitorResize:!0,nullValue:null}}doDestroy(){var e;null===(e=this.globalTapListener)||void 0===e||e.call(this),super.doDestroy()}updateEditable(e){const t=this,{element:n,ariaElement:i}=t;var r;(super.updateEditable(...arguments),!1===e)?(i.removeAttribute("aria-autocomplete"),null===(r=t.globalTapListener)||void 0===r||r.call(t),n.classList.add("b-not-editable"),En.on({element:t.nonEditableClickTarget,click:e=>{const n=document.elementFromPoint(e.clientX,e.clientY);e.target===t.nonEditableClickTarget&&n===t.nonEditableClickTarget&&t.onTriggerClick(e)},thisObj:t})):(i.setAttribute("aria-autocomplete","list"),t.globalTapListener=Mi.ion({globaltap:"showKeyboard",thisObj:t}))}get nonEditableClickTarget(){return this.input}updateElement(e,t){var n;const i=super.updateElement(e,t),r=this.peekConfig("picker"),s=!!r&&(r.isWidget?r.role:null===(n=this.constructor.resolveType(r.type))||void 0===n?void 0:n.$meta.config.role);return this.ariaHasPopup=s,i}changePicker(e,t){throw new Error("changePicker(oldPicker, newPicker) must be implemented in PickerField subclass implementations")}get childItems(){const e=super.childItems;return this._picker&&e.push(this.picker),e}onEditComplete(){super.onEditComplete(),this.autoClosePicker()}onElementResize(e){const t=this;t.pickerVisible&&t.picker.requestAnimationFrame(t.picker.realign,null,t.picker),super.onElementResize(e)}internalOnKeyEvent(e){const t=this;let n=!0;if("keydown"===e.type&&!t.disabled&&!e.shiftKey&&!e.ctrlKey)if(t.pickerVisible){const{picker:i}=t;"Escape"===e.key?(e.preventDefault(),e.stopImmediatePropagation(),t.hidePicker(),n=!1):i.onInternalKeyDown?i.onInternalKeyDown(e):"ArrowDown"===e.key&&i.focusable&&i.focus()}else"ArrowDown"===e.key&&(e.stopImmediatePropagation(),e.preventDefault(),t.onTriggerClick(e));n&&super.internalOnKeyEvent(e)}onFocusIn(e){const t=this;super.onFocusIn(e),t.autoExpand&&(t.minChars=0,t.onTriggerClick(e),t.ignoreTriggerClick=!0,t.setTimeout((()=>t.ignoreTriggerClick=!1),100))}onTriggerClick(e){this.disabled||this.togglePicker("key"in e)}showKeyboard({event:e}){const t=this.input;gi.isTouchEvent&&gi.getActiveElement(t)===t&&e.target===t&&(Mi.suspendFocusEvents(),t.blur(),t.focus(),Mi.resumeFocusEvents())}togglePicker(e){this.pickerVisible?this.hidePicker():this.showPicker(e)}showPicker(e){const t=this,{picker:n}=t;t.pickerHideShowListenersAdded||(n.ion({show:"onPickerShow",hide:"onPickerHide",thisObj:t}),t.pickerHideShowListenersAdded=!0),gi.setAttributes(t.ariaElement,{"aria-controls":n.id,"aria-expanded":!0}),n.autoClose=t.autoClose,n.show(),n.isVisible&&e&&t.focusPicker()}onPickerShow(){const e=this;e.pickerVisible=!0,e.element.classList.add("b-open"),e.trigger("togglePicker",{show:!0}),e.pickerTapOutRemover=Mi.ion({globaltap:"onPickerTapOut",thisObj:e}),e.pickerKeyDownRemover=En.on({element:e.picker.element,keydown:"onPickerKeyDown",thisObj:e})}onPickerHide(){var e,t;const n=this;n.ariaElement.setAttribute("aria-expanded",!1),n.pickerVisible=!1,n.element.classList.remove("b-open"),n.trigger("togglePicker",{show:!1}),null===(e=n.pickerTapOutRemover)||void 0===e||e.call(n),null===(t=n.pickerKeyDownRemover)||void 0===t||t.call(n)}onPickerTapOut({event:e}){this.containsFocus||this.owns(e.target)||this.autoClosePicker()}onPickerKeyDown(e){if("Tab"===e.key&&!this.picker.trapFocus){const t=gi.getActiveElement(this.input),n=new KeyboardEvent("keydown",e);this.input.dispatchEvent(n),n.defaultPrevented&&e.preventDefault(),gi.getActiveElement(this.input)===t?this.input.focus():e.preventDefault(),this.isDestroyed||this.hidePicker()}}autoClosePicker(){this.autoClose&&this.hidePicker()}hidePicker(){this.pickerVisible&&this.picker.hide()}focusPicker(){}focus(){const e=this.input;gi.isTouchEvent&&this.editable&&(e.readOnly=!0,this.setTimeout((()=>e.readOnly=!1),500)),super.focus()}}Qa._$name="PickerField";const ec=document.createRange();class tc extends Io{static get $name(){return"List"}static get type(){return"list"}static get configurable(){return{itemCls:"b-list-item",selectedCls:"b-selected",selectIconCls:"b-icon-check",tag:"ul",items:null,displayField:"text",store:null,navigator:!0,scrollable:{overflowX:!1,overflowY:!0},itemsFocusable:!0,multiSelect:!1,toggleAllIfCtrlPressed:!1,selectAllItem:!1,itemTpl(e){let t=S.encodeHtml(e[this.displayField]);return null!=t&&""!==t||(t="&nbsp;"),t},getItemStyle:null,getItemCls:null,groupHeaderTpl:(e,t)=>{let n=S.encodeHtml(t);return null!=n&&""!==n||(n="&nbsp;"),n},allowGroupSelect:!0,selected:{$config:"nullify",value:{}},activateOnMouseover:null,role:"listbox",keyMap:{"Ctrl+a":"selectAll"}}}construct(e,...t){var n;const i=this;Array.isArray(e)&&(e={items:e}),super.construct(e,...t);const{element:r}=i,{classList:s}=r;i.multiSelect&&s.add("b-multiselect"),null!==(n=i.store)&&void 0!==n&&n.count?i.refresh():s.add("b-empty"),En.on({element:r,delegate:i.itemSelector,mouseover:"onMouseOver",click:"onClick",thisObj:i})}doDestroy(){var e;this.detachListeners("store"),null===(e=this.navigator)||void 0===e||e.destroy(),super.doDestroy()}onFocusIn(e){var t;this.restoreActiveItem(null===(t=e._target)||void 0===t?void 0:t.closest(this.itemSelector)),super.onFocusIn(e)}contentTpl(){const e=this,t=e.store.records.map(((t,n)=>e.itemWrapperTpl(t,n)));return e.multiSelect&&!1!==e.selectAllItem&&t.unshift(e.selectAllItemTpl()),xa.tpl`${t}`}itemWrapperTpl(e,t){const{selected:n,getItemStyle:i}=this,r=i?`style="${this.callback(i,this,[e])}"`:"";return xa.tpl`<li ${r} class="${this.getItemClasses(e,t)}" role="option" aria-selected="${n.includes(e)}" data-index="${t}" data-id="${S.encodeHtml(e.id)}" ${this.itemsFocusable?'tabindex="-1"':""}>${this.itemContentTpl(e,t)}</li>`}itemContentTpl(e,t){return"groupRowFor"in e.meta?this.groupHeaderTpl(e,S.capitalize(e.groupChildren[0][e.meta.groupField])):`${this.itemIconTpl(e,t)}${this.itemTpl(e,t)}`}itemIconTpl(e,t){return this.multiSelect?`<i class="b-selected-icon b-icon ${this.selectIconCls}"></i>`:""}selectAllItemTpl(){const e=this.allSelected?"b-selected":"";return`<li class="${this.itemCls} b-select-all-item ${e}" data-noselect data-select-all data-id="select-all">${this.itemIconTpl({})}<div>${this.optionalL("Select All")}</div></li>`}getItemClasses(e){var t;const n=this,{getItemCls:i}=n,r=null===(t=n._navigator)||void 0===t?void 0:t.activeItem,s=(null==r?void 0:r.dataset.id)==e.id,o="groupRowFor"in e.meta?"b-list-item-group-header":"",l=n.selected.includes(e),a=i?this.callback(i,this,[e]):"";return`${n.itemCls} ${e.cls||""} ${a} ${l?n.selectedCls:""} ${s?n.navigator.focusCls:""} ${o}`}onBeforeStoreLoad(){this.mask(this.L("L{loading}"))}onAfterStoreRequest(){this.unmask()}onStoreChange({source:e,action:t,records:n,record:i,changes:r}){const s=this,{selected:o}=s;switch(t){case"dataset":o.match(e.storage,!s._externallyOwnedSelection);break;case"remove":o.remove(n);break;case"clear":s.deselectAll();break;case"update":{const{id:e}=r;return e&&gi.setAttributes(s.contentElement.querySelector(S.encodeAttributeSelector("data-id",e.oldValue)),{"data-id":e.value}),void s.refreshItem(i)}}s.refresh()}onStoreRefresh(){this.refresh()}refresh(){const e=this;if(e.isVisible){var t;const n=null===(t=e.navigator)||void 0===t?void 0:t.activeItem;e.paintListener=null;const i=gi.createElementFromTemplate(e.contentTpl(),{fragment:!0});e.clearItems().insertNode(i),n&&e.restoreActiveItem(n),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty"),e.updateSelectAllState()}else e.paintListener||(e.paintListener=e.ion({paint:"refresh",thisObj:e,once:!0}))}clearItems(){const e=this,t=e.contentElement.querySelector(e.itemSelector),n=e.contentElement.lastChild;if(t){const n=e.contentElement.querySelectorAll(`${e.itemSelector}:not(.b-mask)`);ec.setStartBefore(t),ec.setEndAfter(n[n.length-1]),ec.deleteContents()}else n?(ec.setStartAfter(n),ec.setEndAfter(n)):(ec.setStart(e.contentElement,0),ec.setEnd(e.contentElement,0));return ec}refreshItem(...e){for(const t of e){const e=this.getItem(t);if(e){const n=this.store.indexOf(t),i=gi.createElementFromTemplate(this.itemWrapperTpl(t,n));gi.sync(i,e)}}}getItem(e){var t;if(null!=e)return"number"==typeof e?this.contentElement.querySelector(`[data-index="${e<0?this.store.count+e:e}"]`):(e.nodeType===Element.ELEMENT_NODE&&(e=e.dataset.id),null!=(null===(t=e)||void 0===t?void 0:t.id)&&(e=e.id),this.contentElement.querySelector(S.encodeAttributeSelector("data-id",e)))}getRecordFromElement(e){return e.target&&(e=e.target),e=e.closest(this.itemSelector),this.store.getAt(parseInt(e.dataset.index))}updateItems(e){const t=this;t.store&&t.store.autoCreated&&t.store.destroy(),t.store=Es.getStore(e)}updateDisabled(e){super.updateDisabled(...arguments),this.navigator&&(this.navigator.disabled=e)}changeSelected(e,n){if(e){let n;e.isCollection?this._externallyOwnedSelection=!0:(Array.isArray(e)?(n=e,e={}):e.values&&(n=e.values,e=t(t({},e),{},{values:[]})),e=new Hr(e)),e.ion({change:"onSelectionChange",thisObj:this}),this.initialSelection=n}else null==n||n.destroy();return e}get itemSelector(){return`.${this.itemCls}`}get selected(){return this._selected}get store(){return this.getConfig("items"),this._store}changeStore(e){const t=this;if(e instanceof Es||(Array.isArray(e)&&(e={data:e}),e=new Es(e)),t.detachListeners("store"),e){const n={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:t};e.readUrl&&(n.beforeLoad="onBeforeStoreLoad",n.afterRequest="onAfterStoreRequest"),e.isGrouped&&(t.element.classList.add("b-grouped"),n.groupchange="onStoreRefresh"),e.ion(n)}return e}updateStore(e){const{initialSelection:t}=this;null!=t&&t.length&&(e.count?this.select(t):e.ion({refresh:()=>this.select(t),once:!0})),this.refresh()}changeNavigator(e,t){const n=this,{element:i}=n;var r;i&&((null===(r=e=Ra.reconfigure(t,e?Ra.mergeConfigs({ownerCmp:n,disabled:n.disabled,target:i,keyEventTarget:i},e):null,n))||void 0===r?void 0:r.keyEventTarget)!==i||n.itemsTabbable||(i.tabIndex=0));return e}get minAlignHeight(){const e=this.element.lastElementChild,t=this.minHeight;if(null!=t)return e?Math.min(e.offsetTop+e.offsetHeight,t):0}alignTo(...e){super.minHeight=this.minAlignHeight,super.alignTo(...e)}hide(...e){return this.navigator&&(this.navigator.activeItem=null),super.hide(...e)}show(){const{refreshCount:e}=this,{previousActiveItem:t}=this.navigator;super.minHeight=this._minHeight;const n=super.show(...arguments);return this.refreshCount===e&&this.restoreActiveItem(t,!0),n}restoreActiveItem(e=this.navigator.previousActiveItem,t="nearest"){const n=this,{navigator:i,lastAlignSpec:r}=n;if(null!=e){if("string"!=typeof t){const e=r?r.zone:1;t=1&e?"nearest":e?"start":"end"}(e=n.getItem(e))&&!n.disabled&&(n.scrollable.scrollIntoView(e,{block:t}),i.activeItem=e)}}onMouseOver(e){const t=this,n=e.currentTarget;!gi.isTouchEvent&&n&&t.navigator&&t.activateOnMouseover&&t.setTimeout({fn:"handleMouseOver",delay:30,args:[n],cancelOutstanding:!0})}handleMouseOver(e){this.navigator.activeItem=e}onClick(e){const t=e.target.closest(this.itemSelector);t&&this.onItemClick(t,e)}onInternalKeyDown(e){const t=this.navigator.activeItem;if(!this.disabled)switch(e.key){case" ":if("INPUT"===e.target.nodeName.toUpperCase()&&!e.target.readOnly)break;case"Enter":t&&(this.onItemClick(t,e),e.stopImmediatePropagation(),e.preventDefault())}}onItemClick(e,t){const n=this,i=parseInt(e.dataset.index);let r=n.store.getAt(i);if(!n.disabled&&!1!==n.trigger("beforeItem",{item:e,record:r,index:i,event:t,userAction:!0})){if(n._isUserAction=!0,n.allowGroupSelect||r&&!r.isSpecialRow)if(e.contains(t.target.closest("[data-noselect]")))e.contains(t.target.closest("[data-select-all]"))&&n.onSelectAllClick(e,t);else{const e=n.selected;let i=e.includes(r);n.multiSelect?(n.toggleAllIfCtrlPressed&&t.ctrlKey?r=n.store.records:n.allowGroupSelect&&r.isSpecialRow&&(i=!r.groupChildren.some((t=>!e.includes(t))),r=r.groupChildren),e[i?"remove":"add"](r)):e.splice(0,e.count,r)}n.lastClicked=r,n.trigger("item",{item:e,record:r,index:i,event:t,userAction:!0}),n._isUserAction=!1}}onSelectionChange({action:e,removed:t,added:n,replaced:i}){const r=this,{selectedCls:s,unselectedCls:o}=r;let l,a;if("clear"===e)for(a of r.element.querySelectorAll(`.${s}`))a.classList.remove(s),a.setAttribute("aria-selected",!1),o&&a.classList.remove(o);else if("replaceValues"!==e){for(l of t)a=r.getItem(l),a&&(a.classList.remove(s),a.setAttribute("aria-selected",!1));for(l of n)a=r.getItem(l),a&&(a.classList.add(s),a.setAttribute("aria-selected",!0))}r.selectAllItem&&r.updateSelectAllState()}onSelectAllClick(e){e.classList.contains(this.selectedCls)?this.deselectAll():this.selectAll()}updateSelectAllState(){var e;null===(e=this.element.querySelector(".b-select-all-item"))||void 0===e||e.classList.toggle(this.selectedCls,this.allSelected)}get allSelected(){const{selected:e,store:t}=this;return e.count&&(t.isFiltered?t.records.every((t=>e.includes(t))):t.count===e.count)}selectAll(e){const t=this;!t.multiSelect&&e||(t.selected.add(t.store.records),e&&!t.navigator.activeItem&&(t.navigator.activeItem=t.getItem(-1)))}deselectAll(){this.selected.clear()}select(e){const{store:t}=this,{modelClass:n}=t;e=he.asArray(e).reduce(((e,i)=>((i=t.getById(n.asId(i)))&&e.push(i),e)),[]),this.selected.add(e)}deselect(e){const{modelClass:t}=this.store;e=he.asArray(e).reduce(((e,n)=>((n=this.selected.get(t.asId(n)))&&e.push(n),e)),[]),this.selected.remove(e)}}tc.initClass(),tc.prototype.navigatorClass=Ra,tc._$name="List";class nc extends tc{static get $name(){return"ChipView"}static get type(){return"chipview"}static get configurable(){return{itemCls:"b-chip",multiSelect:!1,closable:!0,iconTpl:null,closeHandler:null}}itemContentTpl(e,t){const n=this;return xa.tpl`${n.iconTpl?this.iconTpl(e):""}
            ${n.itemTpl(e,t)}
            ${n.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':""}`}onInternalKeyDown(e){const t=this;t.closable&&t.selected.count&&("Delete"===e.key||"Backspace"===e.key)?t.callback(t.closeHandler,t.owner,[t.selected.values,{isKeyEvent:!0}]):super.onInternalKeyDown(e)}updateClosable(e){this.element.classList[e?"add":"remove"]("b-chips-closable"),this.navigator&&(this.navigator.disabled=!e),this.isConfiguring||this.refresh()}onClick(e){const t=this,n=e.target.closest(`.${t.itemCls}`);if(t.closable&&e.target.classList.contains("b-close-icon")){const e=t.store.getAt(parseInt(n.dataset.index));t.callback(t.closeHandler,t.owner,[[e]])}else super.onClick(e)}}nc.initClass(),nc._$name="ChipView";class ic extends Qa{static get $name(){return"Combo"}static get type(){return"combo"}static get alias(){return"combobox,dropdown"}static get configurable(){return{primaryFilter:{},picker:{type:"list",floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},multiSelect:null,items:null,store:null,valueField:void 0,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:e=>e.map((e=>e.value)),filterOnEnter:!1,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:"all",filterOperator:"startsWith",caseSensitive:!1,hidePickerOnSelect:null,chipView:{$config:["lazy","nullify"],value:{type:"combochipview"}},chipStore:{$config:["lazy","nullify"],value:{}},filterSelected:null,emptyText:null,value:null,valueCollection:{$config:["nullify","lazy"],value:{}},validateFilter:!0,clearTextOnPickerHide:!0,destroyStore:!1,multiValueSeparator:",",createOnUnmatched:null,role:"combobox",inlinePicker:null,testConfig:{keyStrokeFilterDelay:0},localizeDisplayFields:!1,buildItems:null}}static get queryLast(){return"last"}construct(e){super.construct(...arguments),this.store||(this.items=[]),this.filterOnEnter&&(this.hideTrigger=!0)}startConfigure(e){this.usingRecordAsValue=null===e.valueField,super.startConfigure(...arguments)}afterConfigure(){super.afterConfigure();const e=this;Nt.hasOwn(e,"_value")||(e._value=e.valueField===e.displayField?"":null,e._lastValue=e._lastValue||e._value)}get childItems(){const{_chipView:e,_picker:t}=this,n=super.childItems;return e&&n.push(e),t&&n.push(t),n}get innerElements(){var e;const t=null===(e=this._chipView)||void 0===e?void 0:e.element,{input:n,inputElement:i}=this;return t&&zs.sync({targetElement:n,domConfig:i}),[t||i]}updateInlinePicker(e){e&&(this.element.classList.add("b-inline-picker"),this.getConfig("picker"),this.triggers.expand=null,this.pickerVisible=!0)}hidePicker(){if(!this.inlinePicker)return super.hidePicker(...arguments)}changeChipStore(e){return!e||e instanceof Es||(e=new Es(Es.mergeConfigs({storage:this.valueCollection},e))),e}updateChipStore(e,t){null==t||t.destroy()}changeChipView(e,t){const n=this;if(n.element.classList[e?"add":"remove"]("b-uses-chipview"),e){const{input:i}=n;return n.chipStore||(n.chipStore={}),rc.reconfigure(t,e,{defaults:{parent:n,insertBefore:i,store:n.chipStore,closable:!n.readOnly,navigator:{type:"combochipnavigator",keyEventTarget:i}}})}null==t||t.destroy()}updateChipView(e){var t;const n=this;n._chipViewEventDetacher=null===(t=n._chipViewEventDetacher)||void 0===t?void 0:t.call(n),n.chipStore=null==e?void 0:e.store,e&&(e.element.appendChild(n.input),n._chipViewEventDetacher=En.on({element:e.element,mousedown:"onChipViewMousedown",thisObj:n}))}updateMultiSelect(e,t){const n=this,{input:i,element:r}=n,s=!n.isConfiguring;let{value:o}=n;if(r.classList[e?"add":"remove"]("b-multiselect"),e){const{chipView:e}=n,{parentNode:t}=i,r=null==e?void 0:e.element;r&&r!==t&&(t.insertBefore(r,i),r.appendChild(i),n.chipView.refresh()),i.value="",s&&(o=he.asArray(o))}else{const e=n._chipView,{parentNode:t}=i,a=null==e?void 0:e.element;var l;if(a===t&&(a.parentNode.insertBefore(i,a),a.remove(),r.classList.remove("b-uses-chipview")),s&&"string"!=typeof o)o=null!==(l=o)&&void 0!==l&&l.length?o[0]:null}s&&(n.value=o)}onChipViewMousedown(e){e.preventDefault(),this.containsFocus||this.focus()}onChipClose(e,t={}){(t.isKeyEvent&&""===this.input.value||!t.isKeyEvent)&&(this._isUserAction=!0,this.valueCollection.remove(e),this._isUserAction=!1)}updateFilterParamName(e){!1!==this.hideTrigger&&(this.hideTrigger=Boolean(e))}updateHideTrigger(e){this.element.classList[e?"add":"remove"]("b-hide-trigger")}updateKeyStrokeFilterDelay(e){this.filterOnInput.delay=e}updateReadOnly(e){super.updateReadOnly(...arguments),this._chipView&&(this._chipView.closable=!e)}updateDisabled(e){super.updateDisabled(...arguments),this._chipView&&(this._chipView.closable=!e)}updateFilterOperator(e){this.primaryFilter&&(this.primaryFilter.operator=e)}get minChars(){const e=this._minChars;return null!=e?e:this.remoteFilter?4:1}get validateFilter(){return this._validateFilter&&!this.createOnUnmatched}get items(){return this.store.allRecords}updateBuildItems(e){e&&(this.items=e.call(this))}changeItems(e){var t;const n=this;if(null==e){if(n.store&&!n.store.isItemStore)return;e=[]}if(!n.buildItems||null!==(t=e)&&void 0!==t&&t.length||(e=n.buildItems()),e instanceof Es)return void(n.store=e);const i=n.displayField;let r,s,o=n.valueField;if(Array.isArray(e)?s=e.map((e=>{let t=e;return e instanceof xr?(r=e.constructor,o||(n.valueField=o=r.idField)):"string"==typeof e||"number"==typeof e?(o||(n.valueField=o=n.displayField),t={[o]:e,[i]:e}):(o||(n.valueField=o="value"),Array.isArray(e)&&(t={[o]:e[0],[i]:e[1]})),e.selected&&(n.value=t),t})):(o||(n.valueField=o="value"),s=[],Object.entries(e).forEach((([e,t])=>{s.push({[o]:e,[i]:t})}))),n.store)n.store.data=s;else{const e=o===i?{name:"value",dataSource:i}:o;n.store=new Es({isItemStore:!0,data:s,idField:o,verifyNoGeneratedIds:!1,modelClass:r||class extends xr{static get idField(){return n.valueField}static set idField(e){super.idField=e}static get fields(){return[e,i]}}})}}get value(){const e=this,{valueCollection:t,valueField:n}=e;if(null==n)return e.multiSelect?t.values.slice():t.first;let i;return i=e.multiSelect?t.count?t.map((e=>e[n])):e._lastValue||[]:t.count?t.first[n]:e._lastValue,i}set value(e){super.value=e}get needsInputSync(){return!this.usesChipView&&!this.editable}changeValue(e,t){var n;const i=this;if(e===t)return void i.syncInputFieldValue(!0);if(!i.multiSelect&&Array.isArray(e)&&e.length>1)throw new Error("Multiple values cannot be set to a non-multiSelect Combo");var r;(i.triggerConfig("items"),i.inputting)||(null===(r=i._chipView)||void 0===r||r.selected.clear());i.store||(i.items=[]);const{valueField:s,displayField:o,store:l,valueCollection:a,_picker:c}=i,{storage:d}=l,u=null!==(n=i.hidePickerOnSelect)&&void 0!==n?n:!i.multiSelect,h=i._isUserAction||(null==c?void 0:c._isUserAction)||u&&i.pickerVisible||!1;if(!i.remoteFilter&&l.isAjaxStore&&!l.count)return l.ion({load:()=>i.value=e,once:!0,thisObj:i}),void(i._lastValue=e);if(i.remoteFilter){if(null!=e){if(Nt.isObject(e)||e.isModel)i.store.data=[e],i.valueCollection.splice(0,i.valueCollection.count,i.store.first);else{const t=i.isConfiguring;i.primaryFilter.setConfig({value:e,disabled:!1}),l.performFilter(!0).then((()=>{if(i.isDestroyed)return;const{isConfiguring:e}=i;i.isConfiguring=t,a.splice(0,a.count,l.allRecords),i.isConfiguring=e}))}return}}else l.filtered&&(i.primaryFilter.disabled=!0,l.filter());let g;if(null!=e){const n=Array.isArray(e),r=n?e.slice():[e];for(let e=0,t=r.length;e<t;e++){let n=r[e];if(n instanceof xr)d.includes(n,!0)||l.add(n);else{const i=Nt.isObject(n);i&&(n=n[l.modelClass.fieldMap[s].dataSource]),g=d.getBy(o,n)||d.getBy(s,n)||a.getBy(o,n)||a.getBy(s,n),g instanceof Set&&(g=[...g][0]),g?(i&&g.set(r[e]),r[e]=g):(r.splice(e,1),t--,e--)}}const c=!r.length,u=a.generation;a.splice(0,a.count,r),c&&(i._value=n&&0===e.length?null:e,i._lastValue=i._value),(c||a.generation===u)&&i.syncInputFieldValue(),i.syncEmpty(),c&&!i.isConfiguring&&i.triggerFieldChange({value:e,oldValue:t,userAction:h,valid:i.isValid})}else if(a.count)a.clear();else{const t=i._value;i._value=null,i.syncInputFieldValue(),i.syncEmpty(),i.isConfiguring||i.triggerFieldChange({value:e,oldValue:t,userAction:h,valid:i.isValid})}i._lastValue=i._value}hasChanged(e,t){return this.multiSelect?!Nt.isEqual(e,t):super.hasChanged(...arguments)}onComboStoreChange({action:e}){"filter"!==e&&this.syncInputFieldValue(!0)}syncInputFieldValue(e){var t;this.usesChipView?null===(t=this.chipView)||void 0===t||t.refresh():super.syncInputFieldValue(e)}get usesChipView(){return Boolean(this.multiSelect&&this._chipView)}get isEmpty(){return 0===this.valueCollection.count}get inputValue(){const e=this;let t=e.selected?e.selected[e.displayField]:e.value;return e.displayValueRenderer&&(t=e.callback(e.displayValueRenderer,e,[e.selected,e])),null==t?"":t}get nonEditableClickTarget(){var e;return this.multiSelect&&(null===(e=this.chipView)||void 0===e?void 0:e.element)||super.nonEditableClickTarget}changeValueCollection(e,t){if(null==t||t.destroy(),e)return e.isCollection||(e=new Hr({internalListeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),e}changePrimaryFilter(e){return e.isCollectionFilter?e.setConfig({disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive}):("function"==typeof e&&(e={filterBy:e}),e=new Fr(t({id:"primary",disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive},e))),e}changeStore(e){const t=this,n=[],{valueCollection:i,keyStrokeFilterDelay:r,filterParamName:s}=t;if(Array.isArray(e))return void(t.items=e);let o;if(e){if(e.isStore){const i=e.filters.get("primary");t.remoteFilter&&(e.filterParamName=s),o=e.remoteFilter||e.restfulFilter,i?t.primaryFilter=i:n.push(t.primaryFilter)}else"string"==typeof e?e=Es.getStore(e):(e=new(e.readUrl?Ds:Es)(e),t.destroyStore=!0),o=t.remoteFilter||e.restfulFilter,o&&s&&(e.filterParamName=s,t.encodeFilterParams&&(e.encodeFilterParams=t.encodeFilterParams)),n.push(t.primaryFilter);if(t.valueField||t.usingRecordAsValue||(t.valueField=e.modelClass.idField),t.filterSelected){const r=e=>!t.containsFocus||!i.includes(e);o?(e.storage.autoFilter=!0,e.storage.addFilter({id:`${t.id}-selected-filter`,filterBy:r})):(n.push(r),e.reapplyFilterOnAdd=!0)}i.addIndex({property:t.displayField,unique:!1}),i.addIndex({property:t.valueField,unique:!0}),n.forEach((t=>e.addFilter(t,!0))),t.keyStrokeFilterDelay=o?Math.max(300,r||0):null!=r?r:10}return e}updateStore(e,t){const n=this,{_picker:i}=n;let r;n.destroyStore&&t&&t.destroy(),i&&(i.store=e),e.storage.addIndex({property:n.displayField,unique:!1}),e.storage.addIndex({property:n.valueField,unique:!0}),r={filter:"onStoreFilter"},n.displayValueRenderer&&((r||(r={})).change="onComboStoreChange"),n.detachListeners("store"),(null==e?void 0:e.storage)&&n.valueCollection.match(e.storage),n.syncInputFieldValue(),r&&(r.name="store",r.thisObj=n,e.ion(r))}get remoteFilter(){var e;return Boolean(this.filterParamName||(null===(e=this._store)||void 0===e?void 0:e.restfulFilter))}get record(){return this.selected}get records(){return this.valueCollection.values.slice()}get selected(){const{store:e}=this;return this.multiSelect?this.valueCollection.values.slice().sort(((t,n)=>e.indexOf(t)-e.indexOf(n)))[0]:this.valueCollection.first}onEditComplete(){const e=this,t=e.valueCollection.count;super.onEditComplete(),t&&(e.clearError("L{Field.validateFilter}"),e.syncInputFieldValue()),e.required&&!t&&e.setError("L{Field.fieldRequired}")}onTriggerClick(e){const t=this,n="key"in e;if(!(t.ignoreTriggerClick||t.remoteFilter&&t.filterOnEnter))if(t.pickerVisible)t.hidePicker();else if(!t.readOnly&&!t.disabled){var i;switch(null===(i=t.triggerAction)||void 0===i?void 0:i.toLowerCase()){case"all":t.doFilter(null,n);break;case"last":t.doFilter(t.lastQuery,n);break;default:t.doFilter(t.input.value,n)}}}internalOnInput(e){const t=this;t.syncEmpty(),t.syncInputWidth(),t.filterOnInput(e),t.trigger("input",{value:t.input.value,event:e})}filterOnInput(e){const t=this,n=e.target.value,i=n.length;t.inputting=!0,t.inlinePicker||i>=t.minChars&&(!t.filterOnEnter||"Enter"===e.key)?t.doFilter(n):(t.validateFilter&&!t.remoteFilter&&t[i?"setError":"clearError"]("L{Field.validateFilter}"),t.hidePicker()),t.inputting=!1}syncInputWidth(){const e=this;if(e.usesChipView){const t=e.input,n=e._inputPadding||(e._inputPadding=gi.getEdgeSize(t,"padding","lr")),i=t.value||"",r=gi.measureText(i+"W",t,!1,e.element)+n.width;t.style.flex=`1 1 ${Math.ceil(r)}px`}}doFilter(e,t){var n;const i=this,{store:r,picker:s}=i,o=null==e||""===e;i.lastQuery=e,i.primaryFilter.setConfig({value:e,disabled:o}),i.remoteFilter&&r.clear(!0);const l=()=>{const{navigator:e,isVisible:t}=s;r.count?!o&&e&&(e.activeItem=0):i.remoteFilter||o||(e&&(e.activeItem=null),i.validateFilter&&i.setError("L{Field.validateFilter}")),t&&s.realign()};null===(n=i.filterPromise=r.filter())||void 0===n||n.then((()=>{i.filterPromise=null,l()})),i.inlinePicker||(null!=s&&s.isVisible?0===s.lastAlignSpec.zone&&s.realign():i.showPicker(t)),i.filterPromise||l()}onStoreFilter({source:e}){const t=this,n=t._picker,i=null==n?void 0:n.element.dataset,{count:r}=e;t.remoteFilter&&(r?n&&(n.navigator.activeItem=0):t.validateFilter&&t.setError("L{Field.validateFilter}"),t.filterSelected&&t.valueCollection.count&&(e.storage.onFiltersChanged({action:"splice",oldCount:1}),n&&n.refresh())),i&&(t.createOnUnmatched&&!r?i.addNewValue=t.L("L{addNewValue}")(t.primaryFilter.value):null==i||delete i.addNewValue)}onValueCollectionChange({source:e}){var t;const n=this,{multiSelect:i,_picker:r}=n,s=null!==(t=n.hidePickerOnSelect)&&void 0!==t?t:!i,o=i?e.values.slice():e.first,l=e.values.slice(),a=n._isUserAction||(null==r?void 0:r._isUserAction)||s&&n.pickerVisible||!1,c=n._value;s&&n.hidePicker(),!e.count&&n.required?n.setError("L{Field.fieldRequired}"):(n.clearError("L{Field.fieldRequired}"),n.clearError("L{Field.validateFilter}")),n.validateFilter&&o&&n.clearError("L{Field.validateFilter}"),n.filterSelected&&(n.remoteFilter?(n.store.storage.onFiltersChanged({action:"splice",oldCount:1}),n._picker&&n._picker.refresh()):n.store.filter()),n._value=null,n._lastValue=null;const d=n.cacheCurrentValue(n.value);n.syncInputFieldValue(),n.syncEmpty(),n.isConfiguring||(n.triggerFieldChange({value:d,oldValue:c,userAction:a,valid:n.isValid}),n.trigger("select",{record:o,records:l,userAction:a}),"select"===n.defaultAction&&n.trigger("action",{value:d,record:o,records:l,userAction:a}))}cacheCurrentValue(e){return this._value=e}onValueCollectionNoChange({toAdd:e}){!this.inlinePicker&&!this.multiSelect&&e.length&&this.pickerVisible&&this.picker.hide()}showPicker(){const e=this,{picker:t}=e;if(!e.readOnly&&!e.inlinePicker){var n;if(t.multiSelect=e.multiSelect,super.showPicker(...arguments),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),t.restoreActiveItem)if(e.multiSelect)t.restoreActiveItem((null===(n=t.navigator)||void 0===n?void 0:n.previousActiveItem)||e.selected||0,!0);else t.restoreActiveItem(e.selected||0,!0);e.input.focus()}}changePicker(e,t){var n;const i=this,r=i.pickerWidth||(null===(n=e)||void 0===n?void 0:n.width),s=tc.mergeConfigs({owner:i,store:i.store,selected:i.valueCollection,multiSelect:i.multiSelect,cls:i.listCls,displayField:i.displayField,forElement:i[i.pickerAlignElement],align:{matchSize:null==r,anchor:i.overlayAnchor,target:i[i.pickerAlignElement],minHeight:i.inlinePicker?null:40*Math.min(3,i.store.count)},[i.listItemTpl?"itemTpl":void 0]:i.listItemTpl,width:r,navigator:{keyEventTarget:i.input}},e);return i.inlinePicker&&Object.assign(s,{floating:!1,align:null,activateOnMouseover:!1,maxHeight:null,appendTo:i.element}),(e=tc.reconfigure(t,e?s:null,i))&&(e.element.classList.add("b-combo-picker"),e.element.dataset.emptyText=i.emptyText?i.L(i.emptyText):i.L("L{noResults}"),e.ion({navigate:"onPickerNavigate",thisObj:i})),e}onPickerNavigate({event:e}){e.target.matches("[data-add-new-value]")&&this.addNewRecord(this.primaryFilter.value)}onPickerHide(){const e=this;super.onPickerHide(),e.multiSelect&&e.clearTextOnPickerHide&&(e.input.value="")}async internalOnKeyEvent(e){const t=this,n=t.input[t.inputValueAttr],i=n.length,{key:r}=e,{store:s,_picker:o,multiSelect:l}=t;if("keydown"===e.type&&null!=o&&o.isVisible&&o.navigator){const{activeItem:i}=o.navigator;if(i&&l&&r===t.multiValueSeparator)return t.input.value="",t.primaryFilter.setConfig({value:"",disabled:!0}),s.filter(),o.onItemClick(i,e),o.hide(),void e.preventDefault();if(!i&&t.createOnUnmatched&&(l&&r===t.multiValueSeparator||"Enter"===r))return e.preventDefault(),void await t.addNewRecord(n)}super.internalOnKeyEvent(...arguments),"keydown"===e.type&&"Enter"===r&&t.filterOnEnter&&i>=t.minChars&&(e.stopPropagation(),t.filterOnInput.now(e))}async addNewRecord(e){const t=this,{store:n,_picker:i,valueCollection:r,multiSelect:s,primaryFilter:o}=t,l=n.remoteFilter&&n.autoCommit;t.filterPromise&&await t.filterPromise,l||(o.setConfig({value:"",disabled:!0}),n.filter());const[a]=n.add(t.callback(t.createOnUnmatched,t,[e,t]));if(n.isCommitting){let e;try{await n.commitPromise}catch(t){var c,d;e=null===(c=t.response)||void 0===c||null===(d=c.parsedJson)||void 0===d?void 0:d.error}a.isPhantom&&(t.clearError(),t.setError(e||"L{Combo.recordNotCommitted}",!1,!0),n.remove(a),n.removed.remove(a))}l&&(o.setConfig({value:"",disabled:!0}),n.filter()),t.input.value="",n.includes(a)&&r.splice(s?r.count:0,s?0:r.count,a),null==i||i.hide()}changeCreateOnUnmatched(e){return!0===e&&(e=this.defaultRecordCreater),e}defaultRecordCreater(e){return this.store.createRecord({[this.displayField]:e})}updateLocalization(){super.updateLocalization();const e=this,{displayField:t}=e;let{localizedDisplayFieldsMap:n}=e;if(!0===e.localizeDisplayFields){n||(e.localizedDisplayFieldsMap=n=new Map),!e.store&&e.buildItems&&(e.items=e.buildItems());for(const r of e.items)if(r.id){var i;let s=n.get(r.id);!s&&null!==(i=r[t])&&void 0!==i&&i.startsWith("L{")&&(s=r[t],n.set(r.id,s)),s&&(r[t]=e.L(s))}e.syncInputFieldValue()}}}n(ic,"delayable",{filterOnInput:0});class rc extends nc{static get $name(){return"ComboChipView"}static get type(){return"combochipview"}static get defaultConfig(){return{closeHandler:"up.onChipClose",itemsFocusable:!1,multiSelect:!0,itemTpl(e){return S.encodeHtml(e[this.owner.displayField])},scrollable:{overflowY:"auto"}}}}ic.initClass(),rc.initClass(),class extends Ra{static get $name(){return"ComboChipNavigator"}static get type(){return"combochipnavigator"}static get configurable(){return{allowShiftKey:!0}}onTargetClick(e){const t=this,n=e.target.closest(t.itemSelector);n&&!e.target.classList.contains("b-close-icon")&&(e.shiftKey||n.contains(e.target.closest("[data-noselect]"))||t.ownerCmp.selected.clear(),t.inClickHandler=!0,t.activeItem=n,t.inClickHandler=!1)}onKeyDown(e){"Enter"!==e.key&&super.onKeyDown(e)}updateActiveItem(e,t){const n=this.ownerCmp;super.updateActiveItem(e,t),e&&!this.inClickHandler&&n.selected.add(n.getRecordFromElement(e))}navigatePrevious(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.previous?super.navigatePrevious(e):this.activeItem=null}navigateNext(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.next?super.navigateNext(e):this.activeItem=null}}.initClass(),ic._$name="Combo";class sc extends ko{}n(sc,"$name","Fit"),n(sc,"type","fit"),n(sc,"configurable",{containerCls:"b-fit-container",itemCls:"b-fit-item"}),sc.initClass(),sc._$name="Fit";class oc extends Bo{afterConfigure(){const e=this;super.afterConfigure(),e.onTargetSizeChange=e.onTargetSizeChange.bind(e),En.on({element:e.element,keydown:"onKeyDown",contextmenu:"stopMouseEvents",mousedown:"stopMouseEvents",mouseover:"stopMouseEvents",mouseout:"stopMouseEvents",mouseup:"stopMouseEvents",click:"stopMouseEvents",dblclick:"stopMouseEvents",thisObj:e}),e.ion({beforeHide:"beforeEditorHide",hide:"afterEditorHide",thisObj:e}),Ve.ion({locale:"onLocaleChange",thisObj:e})}onLocaleChange(){const{inputField:e}=this;e&&!e.isDestroyed&&e.syncInputFieldValue&&e.syncInputFieldValue(!0)}render(e){const t=this.element.parentNode,[n]=this.getRenderContext(this,e);n.classList.add("b-editing"),super.render(...arguments),null!=t&&t.classList&&n!==t&&t.classList.remove("b-editing")}async startEdit(e){const n=this;if(e=Nt.assignIf(e,{align:n.align,hideTarget:n.hideTarget,matchSize:n.matchSize,matchFont:n.matchFont,fitTargetContent:n.fitTargetContent,focus:!0}),!1!==n.trigger("beforeStart",e)){var i,r,s;const{target:o,hideTarget:l,matchSize:a,matchFont:c,fitTargetContent:d,record:u,field:h=n.inputField.name,focus:g}=e,{inputField:m}=n,{input:p}=m,f=gi.getStyleValue(o,"font-size"),v=gi.getStyleValue(o,"font-family");let{value:y,align:b}=e;if(u&&h&&(n.record=u,n.dataField=h,void 0===y&&(y=u[h])),a&&(o instanceof HTMLElement&&n.updateSize(o,a),o instanceof HTMLElement&&qs.addResizeListener(o,n.onTargetSizeChange)),p&&(c?(p.style.fontSize=f,p.style.fontFamily=v):p.style.fontSize=p.style.fontFamily=""),n.assigningValues=!0,null===(i=m.clearError)||void 0===i||i.call(m),m.value=y,n.assigningValues=!1,"string"==typeof b&&(b={align:b}),await n.showBy(t({target:o,allowTargetOut:!0},b)),d){const e=p.scrollWidth-p.clientWidth;e>0&&(n.width+=e+gi.scrollBarWidth)}return g&&(null===(r=m.focus)||void 0===r||r.call(m)),o.nodeType===Element.ELEMENT_NODE&&l&&o.classList.add("b-hide-visibility"),n.editing=!0,n.trigger("start",{value:m.value}),Array.isArray(m.value)&&m.editingRecords&&null!==(s=m.value[0])&&void 0!==s&&s.isModel?n.oldValue=m.value.map((e=>e.copy(e.id))):(n.oldValue=m.value,Array.isArray(n.oldValue)&&(n.oldValue=n.oldValue.slice())),m.initialValue=n.oldValue,!0}return!1}refreshEdit(){if(this.isVisible){const{record:e,dataField:t,inputField:n}=this;if(e&&t){const i=e[t];Nt.isEqual(n.value,i)||(n.value=i)}}}finishEdit(){const{target:e,aligningToElement:t}=this.lastAlignSpec;t&&(e.classList.remove("b-editing"),e.classList.remove("b-hide-visibility")),this.editing=!1,this.trigger("finishEdit")}onKeyDown(e){var t;const n=this;switch(e.key){case n.completeKey:n.completeEdit(null,e),e.stopImmediatePropagation();break;case n.cancelKey:n.cancelEdit(e),e.stopImmediatePropagation()}null===(t=n.trigger)||void 0===t||t.call(n,"keydown",{event:e})}stopMouseEvents(e){this.allowMouseEvents||e.stopPropagation()}onFocusOut(e){super.onFocusOut(e);const t=this;if(!t.isFinishing&&t.editing)switch(t.blurAction){case"cancel":t.cancelEdit(e);break;case"complete":t.completeEdit(null,e)}}async completeEdit(e,t){const n=this,{inputField:i,oldValue:r,record:s}=n,o=i.invalidAction||(!1===i.allowInvalid?"block":n.invalidAction),{value:l}=i;if(n.isVisible){if(i.isValid||"allow"===o){if(Nt.isEqual(l,r))return n.cancelEdit(t),!0;{const t={inputField:i,record:s,value:l,oldValue:r};if(!1!==n.trigger("beforeComplete",t)){var a;if(!e)e=t.finalize||(null===(a=t.editorContext)||void 0===a?void 0:a.finalize);if(e){let s=await e(t);if(!0===s)n.onEditComplete();else{if(i.setError){const e=s||i.invalidValueError,t=()=>{n(),i.clearError(e)},n=i.ion({change:t,input:t});i.setError(e)}var c;if("block"===o)null===(c=i.focus)||void 0===c||c.call(i);else"revert"===o&&(i.value=r,s=!0);s=!1}return s}return n.onEditComplete(),!0}var d;null===(d=i.focus)||void 0===d||d.call(i)}}else{var u;if("block"===o)return null===(u=i.focus)||void 0===u||u.call(i),!1;if("revert"===o)return n.cancelEdit(t),!0}return!1}}cancelEdit(e){const t=this,{inputField:n,oldValue:i}=t,{value:r}=n;t.editing&&!t.isFinishing&&!1!==t.trigger("beforeCancel",{value:r,oldValue:i,event:e})&&(t.isFinishing=!0,t.hide(),t.trigger("cancel",{value:r,oldValue:i,event:e}),t.finishEdit(),t.isFinishing=!1)}onEditComplete(){const e=this,{record:t,dataField:n,inputField:i,oldValue:r}=e,{value:s}=i;if(!e.isFinishing){if(e.isFinishing=!0,e.hide(),t){const e=`set${S.capitalize(n)}`;t[e]?t[e](s):n.includes(".")?t.set(n,s):t[n]=s}e.trigger("complete",{value:s,oldValue:r}),e.finishEdit(),e.isFinishing=!1}}doDestroy(){this.createdInputField&&this.inputField.destroy(),super.doDestroy()}set owner(e){this._owner=e}get owner(){return this._owner||Io.fromElement(this.element.parentNode)}changeInputField(e,t){const n=this;return t&&t.destroy(),"string"==typeof e&&(e={type:e}),e instanceof Io||(e=Io.create(e),n.createdInputField=!0),n.completeOnChange&&e.ion({change:"onInputFieldChange",thisObj:n}),e.parent=n,e}updateInputField(e){this.removeAll(),this.add(e)}get inputField(){return this.items[0]}onInputFieldChange(){this.containsFocus&&this.completeEdit()}onTargetSizeChange(e,t,n){t&&n&&this.updateSize(e)}updateSize(e,t=this.lastMatchSize){const n=this,i=dn.inner(e);n.width=!1===t.width?"auto":i.width-n.align.offset[0],n.height=!1===t.height?"auto":i.height,n.lastMatchSize=t}beforeEditorHide(){if(this.editing&&!this.isFinishing)return this.cancelEdit(),!1}afterEditorHide(){this.positioned&&this.element.remove(),qs.removeResizeListener(this.lastAlignSpec.target,this.onTargetSizeChange)}}n(oc,"$name","Editor"),n(oc,"type","editor"),n(oc,"configurable",{positioned:!0,hidden:!0,layout:"fit",align:{align:"t0-t0",offset:[0,0]},hideTarget:!1,matchSize:!0,matchFont:!0,fitTargetContent:!1,inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",invalidAction:"block",completeOnChange:null,isolateFields:!0}),oc.initClass(),oc._$name="Editor";export{_e as AjaxHelper,Ds as AjaxStore,Qo as Animator,dr as ArrayDataField,he as ArrayHelper,Re as AsyncHelper,Bl as Badge,Yr as Bag,de as Base,ur as BooleanDataField,r as BrowserHelper,Kl as Button,nc as ChipView,el as ClickRepeater,al as CollapseTool,Hr as Collection,Fr as CollectionFilter,Ar as CollectionSorter,ic as Combo,U as Config,Bo as Container,Ea as ContextMenuBase,cr as DataField,hr as DateDataField,$t as DateHelper,Na as DayTime,Pi as Delayable,gn as DomClassList,Os as DomDataStore,gi as DomHelper,zs as DomSync,Dr as Duration,Il as DynamicObject,oc as Editor,En as EventHelper,$e as Events,lr as Factoryable,Ja as Field,qa as FieldContainer,Bs as Fullscreen,be as FunctionHelper,Mi as GlobalEvents,Lr as IdHelper,Ki as Identifiable,Ii as InstancePlugin,pr as IntegerDataField,oo as KeyMap,Ua as Labelable,ko as Layout,tc as List,Pa as LoadMaskable,Ne as LocaleHelper,Ve as LocaleManagerSingleton,Ye as Localizable,so as Mask,Ca as Menu,ya as MenuItem,xr as Model,fr as ModelDataField,ir as ModelLink,Ji as ModelStm,Ra as Navigator,vr as NumberDataField,yr as ObjectDataField,Nt as ObjectHelper,L as Objects,ma as Panel,Ol as PanelCollapser,Qa as PickerField,Fi as Pluggable,mn as Point,pa as Popup,no as Promissory,lo as RTL,dn as Rectangle,ro as Renderable,qs as ResizeMonitor,$o as Ripple,rl as Rotatable,ja as ScrollManager,to as Scroller,Ui as State,Bi as StateProvider,_i as StateStorage,Es as Store,Gr as StoreCRUD,cs as StoreChained,Xr as StoreChanges,br as StoreDataField,Jr as StoreFilter,Qr as StoreGroup,es as StoreProxy,ts as StoreRelation,ss as StoreSearch,ls as StoreSort,ds as StoreState,ys as StoreStm,ns as StoreSum,fs as StoreSync,ms as StoreTree,gr as StringDataField,S as StringHelper,xa as TemplateHelper,Za as TextField,Aa as TimeZoneHelper,$a as Toast,sl as Tool,Al as Toolable,ra as Toolbar,Ha as Tooltip,er as TreeNode,A as VersionHelper,ps as WalkHelper,hs as Wbs,Io as Widget,n as _defineProperty,t as _objectSpread2,i as _objectWithoutProperties,an as parseAlign,kt as unitMagnitudes};
//# sourceMappingURL=Editor.js.map
