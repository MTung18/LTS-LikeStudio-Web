import{d as Ge,j as o,Q as Oe,bb as Ae,b as W,e as Ie,r,o as d,c as g,g as l,w as n,a as c,D as R,u as a,A as ve,I as V,f as K,a3 as ye,ai as pt,M as p,bq as _t,aj as vt,_ as Ue,W as yt,l as ht,ab as bt,bG as gt,bH as wt,bI as Dt,bJ as Ct,bK as St,bw as Et,i as Fe,s as me,at as xt,T as Tt,a1 as te,bp as Mt,F as pe,z as Re,a2 as z,be as ae,bk as kt,bd as _e,aH as Ft,ax as Rt,ay as Pt}from"./index.611fe570.js";import{S as Gt}from"./grid.module.3b00878a.js";import{B as he}from"./BryntumGrid.2c4be387.js";import{E as L,u as Ot}from"./EmployeeDocumentState.b6e49771.js";import{D as At,u as Be,a as It}from"./documentMetadataStore.ea29648e.js";import{_ as Ut}from"./deleteConfirmationModal.vue_vue_type_script_setup_true_lang.7d561088.js";import{u as Bt,_ as Nt,a as $t}from"./useBryntumSelector.93a74318.js";import{e as Ht}from"./employeeHeader.c061ea79.js";import{B as Lt}from"./bryntumSearchBar.3bdd630f.js";import{f as Wt}from"./filterStoreDataBySearchText.3eea2082.js";import{u as Vt}from"./useBryntumGridSearchFilter.628f2003.js";import{d as Qt}from"./darkThemeModal.413e0de8.js";import"./whqDocumentsApi.6aaa1d96.js";import"./foundationCompanyCasConnectionStore.b3301598.js";import"./debounce.cf77a06e.js";import"./isObject.c4ad145e.js";import"./statefulSortFeature.3df4a43a.js";import"./gridConfigDefaults.8c72c19b.js";const qt={class:"contain hq-pg__container container-fluid bg-gray pb-0"},jt={class:"hq-pg__title ml-2 text-cyan"},zt={class:"ms-auto filter-tabs"},Kt={class:"list__integration list__table"},Jt=["accept"],Zt=Ge({__name:"federalStateDocumentationWidget",props:{federalStateGridConfig:{default:[]},federalStateGridRenderedConfig:{default:[]},folderPath:{default:""},employeeId:{default:null},title:{default:""},dataForGrid:null},emits:["documentUploaded"],setup(v,{emit:w}){const P=v,G=o(L.Rendered),O=o(null),J=o(null),D=o({name:""}),Q=o(""),C=o(new At),{notifySuccess:oe,notifyError:le}=Oe(),_=Ae(),f=Be(),x=W(()=>_.allowedExtensions),T=o(new Gt({sorters:[{field:"lastEdited",ascending:!0}]}));Ie(async()=>{await S()});function A(u){G.value=u}async function S(){x.value?.length<=0&&(await _.fetchAllowedExtensions(),Q.value=x.value?.map(u=>u.extensionType)?.join(", "))}async function y(u){const i=u.target;i&&i.files&&i.files.length>0&&(D.value=i.files[0],await M())}async function M(){try{await ne(),await se()}catch(u){le(p.COMMON.UPLOAD_ERROR),console.debug(u)}}async function ne(){D.value&&(await _.uploadDocument({path:_t(P.folderPath),file:D.value,fileName:D.value.name},!0),O.value=_.uploadedDocumentDetails)}async function se(){C.value.documentCategoryId=It.General,C.value.name=D.value.name,C.value.description=P.title,P.employeeId&&(C.value.employeeId=P.employeeId),O.value?.path&&O.value?.path!=""&&(C.value.filePath=O.value.path,await f.addDocumentMetadata(C.value),oe(p.DOCUMENT_META.SAVE_SUCCESS),w("documentUploaded"))}return(u,i)=>{const I=r("fs-col"),U=r("fs-button"),k=r("fs-button-group"),B=r("fs-card-header"),N=r("fs-card-body"),q=r("font-awesome-icon"),Z=r("fs-link"),X=r("fs-card-footer"),E=r("fs-card");return d(),g("div",qt,[l(E,{class:"dashboard-card","no-body":""},{default:n(()=>[l(B,{class:"dashboard-card__header"},{default:n(()=>[l(I,null,{default:n(()=>[c("h2",jt,R(v.title),1)]),_:1}),l(I,{lg:"auto",class:"mb-1"},{default:n(()=>[c("div",zt,[l(k,null,{default:n(()=>[l(U,{variant:"link",onClick:i[0]||(i[0]=h=>A(a(L).Rendered)),class:ve({active:G.value===a(L).Rendered})},{default:n(()=>[V("Rendered")]),_:1},8,["class"]),l(U,{variant:"link",onClick:i[1]||(i[1]=h=>A(a(L).Uploaded)),class:ve({active:G.value===a(L).Uploaded})},{default:n(()=>[V("Uploaded")]),_:1},8,["class"])]),_:1})])]),_:1})]),_:1}),l(N,{class:"p-0"},{default:n(()=>[c("div",Kt,[l(N,{class:"dashboard-card__content chart-card__content"},{default:n(()=>[G.value===a(L).Rendered?(d(),K(a(he),ye({key:0,readOnly:!0,ref:"grid"},v.federalStateGridRenderedConfig,{data:u.$props.dataForGrid}),null,16,["data"])):(d(),K(a(he),ye({key:1,readOnly:!0,ref:"grid"},v.federalStateGridConfig,{data:u.$props.dataForGrid,store:T.value}),null,16,["data","store"]))]),_:1})])]),_:1}),l(X,{class:"federalStateCard_footer upload_text"},{default:n(()=>[l(q,{icon:["fal","upload"],class:"text-primary"}),pt(c("input",{id:"fileInput",type:"file",ref_key:"fileInput",ref:J,accept:Q.value,onChange:i[2]||(i[2]=h=>y(h))},null,40,Jt),[[vt,!1]]),l(Z,{class:"upload_text",onClick:i[3]||(i[3]=h=>u.$refs.fileInput.click())},{default:n(()=>[V(" Upload")]),_:1})]),_:1})]),_:1})])}}});const Pe=Ue(Zt,[["__scopeId","data-v-ea25e3b7"]]),Ne=v=>(Rt("data-v-402d3258"),v=v(),Pt(),v),Xt={class:"hq-pg list"},Yt={key:0,class:"list__table"},ea={class:"list__table list__table--onpage list__b-grid--hover"},ta={key:0,class:"scroll-y-auto scroll--xs pt-2"},aa=Ne(()=>c("i",{class:"b-fa b-fa-file-contract"},null,-1)),oa={class:"ps-2"},la={key:0,class:"b-fa b-fa-download"},na={class:"ps-2"},sa={class:"b-fa b-fa-trash-alt"},ia={class:"ps-2"},ra={class:"d-flex my-2"},da=Ne(()=>c("span",{class:"text-lg"}," The document you have selected has been electronically rendered. If providing this form to a government entity, please review and determine if it should be filled out manually before submitting. ",-1)),ua=Ge({__name:"employeeDocumentation",setup(v){const w=yt("$providePermissions");ht.add(bt,gt,wt,Dt,Ct,St,Et);const P=o(null),{fetchEmployeeDetails:G}=Fe(),{getEmployeeDetails:O}=me(Fe()),J=Ot(),{employeeDocumentations:D}=me(J),Q=Be(),{isDocumentDeleted:C}=me(Q),oe=xt(),le=Tt(),_=W(()=>w.value.WHQ_254_3155),f=W(()=>oe.params?.id?.toString()),x=W(()=>le?.activeUserClient?.clientGuid??"Shared"),T=W(()=>b.value==="General"),{notifySuccess:A,notifyError:S}=Oe(),y=Ae(),{currentSelectedRows:M,selectedRowCount:ne,isRowSelected:se,bryntumSelectedRowHandler:u}=Bt(),i=o(!1),I=o(!1),U=o(!1),k=o(!1),B=o(""),N=o(""),q=o(""),Z=o([]),X=o([]),E=o(!1),h=o(),ie=o(!1),be=o(""),ge=o(!1);let b=o("General");const $e=o([{id:1,text:"General",value:"General",uiFieldTag:"WHQ_254_3154"},{id:2,text:"Federal/State",value:"Federal/State",uiFieldTag:"WHQ_254_3156"}]),Y={flex:2,text:"Name",id:"name",field:"name",groupable:!1},ee={flex:1,text:"Date",id:"lastEdited",field:"lastEdited",renderer:({row:t,value:e})=>kt(e),groupable:!1},we={flex:1,type:"action",id:"action",text:"Actions",columnDragToolbar:!1,enableHeaderContextMenu:!1,enableCellContextMenu:!1,cellCls:"b-action-cell--hover",actions:[{visible:!0,renderer:()=>'<i class="b-action-item b-fa b-fa-download btn btn-link text-success no-underline"> Download</i>',onClick:et},{visible:_.value,renderer:()=>'<i class="b-action-item b-fa b-fa-trash-alt btn btn-link text-red no-underline">Delete</i>',onClick:st}]},He={flex:1,type:"action",id:"action",text:"Actions",columnDragToolbar:!1,enableHeaderContextMenu:!1,enableCellContextMenu:!1,cellCls:"b-action-cell--hover",actions:[{visible:!0,renderer:()=>'<i class="b-action-item b-fa b-fa-external-link btn btn-link text-success no-underline"> View</i>',onClick:tt}]},Le={flex:1,type:"action",id:"action",text:"Actions",columnDragToolbar:!1,enableHeaderContextMenu:!1,enableCellContextMenu:!1,cellCls:"b-action-cell--hover",actions:[{visible:!0,renderer:()=>'<i class="b-action-item b-fa b-fa-external-link btn btn-link text-success no-underline"> View</i>',onClick:at}]},re=o(null),De=W(()=>re.value?.instance.value.features),Ce="employeeDocumentListGrid",We={field:"name",ascending:!0},{filteredData:de,defaultGridConfig:Ve,statefulFilterFeature:Qe,statefulSortFeature:qe,searchText:ue,gridStore:ce,saveGridSettings:je,clearGridSettings:ze,hideFilterBar:Ke,populateBryntumStore:Je}=Vt(De,Ce,We,Se),Ze=o({...Ve,...Qe,...qe,minHeight:"40em",emptyText:p.DOCUMENT_META.NO_RECORD,selectionMode:{cell:!1,row:!1,autoWidth:!0,toggleable:!0,checkboxOnly:!0,showCheckAll:!0},columns:[Y,{flex:2,text:"Description",id:"description",field:"description",groupable:!1},{flex:1,text:"Contains Restricted Info",id:"isRestricted",field:"isRestricted",hidden:!_.value,htmlEncode:!1,renderer({record:t,widgets:e,cellElement:m,value:j}){const H=["d-flex","justify-content-center","b-fa","b-fa-exclamation-circle","text-warning"];j===!0?(e&&e[0]&&(e[0].hidden=!0),H.forEach(F=>{m.classList.add(F)})):(e&&e[0]&&(e[0].hidden=!1),H.forEach(F=>{m.classList.remove(F)}))},groupable:!1},ee,{flex:1,text:"Uploaded By",id:"updatedBy",field:"updatedBy",groupable:!1},we],listeners:{selectionChange:t=>u(M,t)}}),Xe=[];function Se(){const t=Wt(de.value,Xe,ue.value,ce.value);ce.value.data=t}async function $(){await Ye(),_.value?de.value=D.value.filter(t=>t.filePath.includes(B.value)):de.value=D.value.filter(t=>!t.isRestricted&&t.filePath.includes(B.value)),Z.value=(await y.fetchRecordItems(N.value)).filter(t=>!t.isFolder&&t.contentType==="pdf"),X.value=(await y.fetchRecordItems(q.value)).filter(t=>!t.isFolder&&t.contentType==="pdf"),await Je(),ue.value!==""&&Se()}async function Ye(){await J.fetchEmployeeDocumentations(+f.value)}async function et(t){if(t.record.data.isRestricted&&!_.value){S("Only HRM Admin can download this item");return}A(p.COMMON.DOWNLOADING),await y.downloadFile(t.record.data.path)}async function tt(t){if(t.record.data.contentType=="pdf")try{await y.previewPDFFile(t.record.data.path)}catch{S("There was an error while previewing file, please try again later.")}}async function at(t){t.record.data.contentType=="pdf"&&(be.value=t.record.data.path,ie.value=!0,ge.value=!0)}const ot=async()=>{try{await y.previewPDFFile(be.value)}catch{S("There was an error while previewing file, please try again later.")}ie.value=!1};async function Ee(){const t=Promise.resolve(_e(ae.EmployeeDocument,x.value,f.value)),e=Promise.resolve(_e(ae.EmployeeW4,x.value,f.value)),m=Promise.resolve(_e(ae.EmployeeFederalReporting,x.value,f.value));await Promise.all([t,e,m]).then(([j,H,F])=>{B.value=j,N.value=H,q.value=F})}te([f,x],()=>{Ee()},{deep:!0}),te(se,(t,e)=>{i.value=t}),te(i,(t,e)=>{t||(M.value=[],re.value?.instance.value.deselectAll())}),Ie(async()=>{U.value=!0,await Ee(),await $(),U.value=!1,G(f.value).then(()=>{P.value=O.value})});const xe=o({columns:[Y,ee,we]}),lt=o({columns:[Y,ee,He]}),nt=o({columns:[Y,ee,Le]});te(b,t=>{b.value=t});function st(t){if(!_.value){S("Only HRM Admin can delete this item");return}h.value=t.record.data,k.value=!1,E.value=!0}async function it(){k.value?await ut():h.value&&(await Te(h.value.id,h.value.filePath)?(A(p.DOCUMENT_META.DELETE_SUCCESS),await $()):S(p.DOCUMENT_META.DELETE_ERROR)),k.value=!1}async function Te(t,e){try{return E.value=!1,await y.deleteFile(e)?(await Q.deleteDocument(t),C.value):(S(`${p.DOCUMENT_META.DELETE_ERROR} - ${e}`),!1)}catch{return!1}}function rt(){const t=M.value.map(e=>e.filePath);i.value=!1,y.downloadFilesAsZip(t)}async function dt(){k.value=!0,E.value=!0}async function ut(){const t=[];M.value.forEach(m=>{t.push(Te(m.id,m.filePath))});var e=await Promise.all(t);i.value=!1,e.every(m=>m===!1)||A(p.DOCUMENT_META.DELETE_SUCCESS),await $()}return(t,e)=>{const m=r("fs-form-radio"),j=r("fs-button"),H=r("fs-col"),F=r("fs-row"),ct=r("fs-container"),Me=r("fs-list-group-item"),ft=r("fs-list-group"),mt=r("font-awesome-icon");return d(),g("div",Xt,[l(Ht,{employeeId:a(f),class:"position-relative"},null,8,["employeeId"]),l(Lt,{title:"","local-storage-key":Ce,"show-settings-button":a(T),"show-search-button":a(T),"show-filter-button":a(T),"show-refresh-button":!1,"show-footer-search":!1,onSaveSettings:e[2]||(e[2]=s=>a(je)()),onClearSettings:e[3]||(e[3]=s=>a(ze)()),onHideFilterBar:e[4]||(e[4]=s=>a(Ke)()),onShowFilterBar:e[5]||(e[5]=s=>a(De).filterBar.showFilterBar()),onSearchTextInput:e[6]||(e[6]=s=>ue.value=s)},Mt({headers:n(()=>[(d(!0),g(pe,null,Re($e.value,(s,fe)=>(d(),g(pe,{key:s.id},[a(w)[s.uiFieldTag]?(d(),K(m,{modelValue:a(b),"onUpdate:modelValue":e[0]||(e[0]=ke=>Ft(b)?b.value=ke:b=ke),value:s.value,button:"","button-variant":a(b)===s.value?"index-color-5 ":"link",class:ve(a(b)===s.value?"rounded-pill":"hq-pg__tab text-decoration-none"),key:fe},{default:n(()=>[V(R(s.text),1)]),_:2},1032,["modelValue","value","button-variant","class"])):z("",!0)],64))),128))]),_:2},[a(T)&&a(w).WHQ_254_3154?{name:"buttons",fn:n(()=>[l(j,{variant:"btn-primary",onClick:e[1]||(e[1]=s=>I.value=!0),class:"btn btn-primary ms-3"},{default:n(()=>[V(R(a(p).DOCUMENT_META.ADD_DOCUMENT),1)]),_:1})]),key:"0"}:void 0]),1032,["show-settings-button","show-search-button","show-filter-button"]),a(T)&&a(w).WHQ_254_3154?(d(),g("div",Yt,[c("div",ea,[l(a(he),ye({readOnly:!0},Ze.value,{store:a(ce),ref_key:"grid",ref:re}),null,16,["store"])])])):a(w).WHQ_254_3156?(d(),K(ct,{key:1,fluid:"",class:"contain px-0 bg-gray"},{default:n(()=>[l(F,{class:"dashboard__row"},{default:n(()=>[l(H,null,{default:n(()=>[l(Pe,{title:"W-4 Documents",federalStateGridConfig:xe.value,federalStateGridRenderedConfig:nt.value,folderPath:N.value,employeeId:+a(f),onDocumentUploaded:$,dataForGrid:Z.value},null,8,["federalStateGridConfig","federalStateGridRenderedConfig","folderPath","employeeId","dataForGrid"]),l(Pe,{title:"Federal Reporting",federalStateGridConfig:xe.value,federalStateGridRenderedConfig:lt.value,folderPath:q.value,employeeId:+a(f),onDocumentUploaded:$,dataForGrid:X.value},null,8,["federalStateGridConfig","federalStateGridRenderedConfig","folderPath","employeeId","dataForGrid"])]),_:1})]),_:1})]),_:1})):z("",!0),U.value?z("",!0):(d(),K(Nt,{key:2,showPanel:I.value,"onUpdate:showPanel":e[7]||(e[7]=s=>I.value=s),docType:a(ae).EmployeeDocument,folderPath:B.value,employeeId:+a(f),onDocumentUploaded:$},null,8,["showPanel","docType","folderPath","employeeId"])),l(Ut,{showDeleteModal:E.value,"onUpdate:showDeleteModal":e[8]||(e[8]=s=>E.value=s),onOK:e[9]||(e[9]=s=>it()),onCANCEL:e[10]||(e[10]=s=>E.value=!1)},{default:n(()=>[c("span",null,[V(R(a(p).DOCUMENT_META.DELETE_MESSAGE)+" ",1),k.value?(d(),g("div",ta,[(d(!0),g(pe,null,Re(a(M),(s,fe)=>(d(),g("p",{key:fe,class:"mb-1"},[aa,c("span",oa,R(s.name),1)]))),128))])):z("",!0)])]),_:1},8,["showDeleteModal"]),l($t,{"number-of-items-selected":a(ne),showPanel:i.value,"onUpdate:showPanel":e[11]||(e[11]=s=>i.value=s)},{default:n(()=>[l(ft,null,{default:n(()=>[l(Me,{button:"",onClick:rt},{default:n(()=>[a(w).WHQ_254_3155?(d(),g("i",la,[c("span",na,R(a(p).COMMON.DOWNLOAD),1)])):z("",!0)]),_:1}),l(Me,{button:"",onClick:dt},{default:n(()=>[c("i",sa,[c("span",ia,R(a(p).COMMON.DELETE),1)])]),_:1})]),_:1})]),_:1},8,["number-of-items-selected","showPanel"]),l(Qt,{title:"Warning!","show-modal":ie.value,hideCancelButton:ge.value,okText:"OK",okTextVariant:"primary",onOk:ot},{content:n(()=>[c("div",ra,[l(mt,{icon:["fas","triangle-exclamation"],class:"text-warning me-2 mt-1"}),da])]),_:1},8,["show-modal","hideCancelButton"])])}}});const ka=Ue(ua,[["__scopeId","data-v-402d3258"]]);export{ka as default};
