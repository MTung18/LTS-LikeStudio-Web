import{B as J}from"./bryntumSearchBar.3bdd630f.js";import{f as M}from"./gridConfigDefaults.8c72c19b.js";import{f as K}from"./filterStoreDataBySearchText.3eea2082.js";import{g as z,a as Q}from"./statefulSortFeature.3df4a43a.js";import{S as X}from"./grid.module.3b00878a.js";import{B as Z}from"./BryntumGrid.2c4be387.js";import{J as ee,K as te,L as oe,N as G,R as re,j as b,d as Y,s as q,l as ae,af as se,a_ as le,cf as ne,aU as U,a1 as L,b as $,r as C,o as y,f as N,w as m,a as V,g as n,u as r,C as ie,I as P,ao as ue,a2 as S,c as h,a4 as pe,bc as j,ax as de,ay as me,_ as W,y as ce,bO as fe,a3 as ye,F as ve}from"./index.611fe570.js";import{R as v}from"./ReportType.5066718f.js";import"./foundationCompanyCasConnectionStore.b3301598.js";import"./debounce.cf77a06e.js";import"./isObject.c4ad145e.js";class ge extends oe{constructor(c){const d=G().ClientSide.WorkforceManagement;super(c,d)}async getReportCriteria(c){let d;try{const t=await this.axiosInstance.get(`v1/ReportCriteria/${c}`);if(t&&t.data&&t.status===200)d=t.data;else throw new Error("Failed to parse report criteria")}catch(t){console.error("An unexpected error occurred attempting to retrieve the report criteria.",t)}return d}}const Se=new ge([ee,te]),H=re("reportStore",()=>{const u=b({});async function c(d){u.value=await Se.getReportCriteria(d)}return{fetchReportCriteriaStore:c,reportsCriteriaStore:u}}),he=u=>(de("data-v-a759e069"),u=u(),me(),u),be={class:"d-flex justify-content-between py-2"},_e=he(()=>V("span",null,"Generate Report ",-1)),Ce={key:1},Te={key:2},Ve={key:3},Re={key:4},Oe={key:5},ke={key:6},we={key:7},xe={class:"p-3 d-flex justify-content-between"},Ie=Y({__name:"reportsSidebar",props:{typeReport:null,isOpen:{type:Boolean}},emits:["save","close"],setup(u,{emit:c}){const d=H(),{reportsCriteriaStore:t}=q(d);ae.add(se,le,ne);const O=b(null),R={[v.PendingAndApprovedTimeOff]:"Pending and Approved Time Off Report",[v.TimeOffBalance]:"Time Off Balance Report",[v.EmployeeContactInformation]:"Employee Contact Information",[v.W2ElectronicConsent]:"W-2 Electronic Consent Report"},F=i=>{const o=[];for(const[a]of Object.entries(t.value))o.push({name:a,value:[]});for(const[a,s]of Object.entries(i))if(a==="dateRange")o.push({name:a,value:s});else{const _=o.find(T=>T.name===a);_&&(_.value=s)}return o};function k(){pe(()=>{for(const[i]of Object.entries(e))e[i]=[];p.fromTime=j("").format("YYYY-MM-DD"),p.toTime=j("").format("YYYY-MM-DD"),O.value.resetForm(),c("close")})}const e=U({dateRange:[]});function w(){if(!e.employees&&e.reportingSupervisors&&e.reportingSupervisors.length>0||e.employees&&e.employees.length===0&&e.reportingSupervisors&&e.reportingSupervisors.length>0){const o=e.reportingSupervisors.map(a=>a.id);e.employees=t.value.employees.filter(a=>o.includes(+a.referenceInformation))}(!e.employees&&!e.reportingSupervisors||e.employees.length===0&&e.reportingSupervisors.length===0||!e.employees&&e.reportingSupervisors.length===0||e.employees.length===0&&!e.reportingSupervisors)&&(e.employees=t.value.employees);const i=F(e);c("save",i)}const p=U({fromTime:"",toTime:""});L(()=>p.fromTime,i=>{e.dateRange[0]={name:"fromTime",id:1,guid:null,default:!1,referenceInformation:i,sortByField:null}}),L(()=>p.toTime,i=>{e.dateRange[1]={name:"toTime",id:1,guid:null,default:!1,referenceInformation:i,sortByField:null}});const x=$(()=>{if(e.reportingSupervisors!==void 0&&e.reportingSupervisors.length>0){const i=e.reportingSupervisors.map(o=>o.id);return t.value.employees.filter(o=>i.includes(+o.referenceInformation))}return t.value.employees});return L(()=>e.reportingSupervisors,i=>{if(i&&i.length>0){const o=i.map(a=>a.id);e.employees&&e.employees.length>0&&(e.employees=e.employees.filter(a=>o.includes(+a.referenceInformation)))}}),(i,o)=>{const a=C("fs-link"),s=C("fs-input"),_=C("fs-col"),T=C("fs-row"),I=C("fs-container"),B=C("fs-button"),A=C("fs-sidebar");return y(),N(A,{visible:u.isOpen,sidebar:"",id:"report-sidebar",class:"publishPostForm",right:"","sidebar-class":"fsi-sidebar help-center header-grey","body-class":"help-center__body","no-close-on-esc":"","no-close-on-backdrop":"","bg-variant":"white",width:"392px",shadow:"","header-class":"border-bottom","footer-class":"border-top","no-header-close":""},{title:m(()=>[V("div",be,[_e,n(a,{class:"text-secondary",role:"button",onClick:k},{default:m(()=>[n(r(ie),{icon:["fal","times"],size:"sm"})]),_:1})])]),footer:m(()=>[V("div",xe,[n(B,{type:"button",variant:"outline-secondary",onClick:k},{default:m(()=>[P(" CANCEL ")]),_:1}),n(B,{variant:"primary",type:"submit",form:"form"},{default:m(()=>[P(" RUN REPORT ")]),_:1})])]),default:m(()=>[n(I,{fluid:"",class:"px-3 py-3"},{default:m(()=>[n(r(ue),{onSubmit:w,ref_key:"form",ref:O,class:"form",id:"form"},{default:m(({errors:D})=>[n(s,{label:"Report Name",id:"title",type:"fsTextInput",modelValue:R[u.typeReport],"onUpdate:modelValue":o[0]||(o[0]=l=>R[u.typeReport]=l),name:"title",placeholder:"Title here...",disabled:""},null,8,["modelValue"]),r(v).W2ElectronicConsent!==u.typeReport?(y(),N(T,{key:0},{default:m(()=>[n(_,null,{default:m(()=>[n(s,{type:"fsDateInput",name:"From Date",modelValue:p.fromTime,"onUpdate:modelValue":o[1]||(o[1]=l=>p.fromTime=l),label:"From Date",required:!0,rules:{required:!0,dateBeforeOrEqualTarget:["To Date",p.toTime]}},null,8,["modelValue","rules"])]),_:1}),n(_,null,{default:m(()=>[n(s,{type:"fsDateInput",name:"To Date",modelValue:p.toTime,"onUpdate:modelValue":o[2]||(o[2]=l=>p.toTime=l),label:"To Date",required:!0,rules:{required:!0,dateAfterOrEqualTarget:["From Date",p.fromTime]}},null,8,["modelValue","rules"])]),_:1})]),_:1})):S("",!0),r(t).status&&r(t).status.length>0?(y(),h("div",Ce,[n(s,{type:"fsMultiselectList",multiple:!0,closeOnSelect:!1,showClear:!0,label:"Status",typeaheaddata:r(t)?.status,typeaheadkey:"name",typeaheadvalueattribute:"id",name:"Status",autocomplete:"donotfill",modelValue:e.status,"onUpdate:modelValue":o[3]||(o[3]=l=>e.status=l),defaultEmptyValue:null},null,8,["typeaheaddata","modelValue"])])):S("",!0),r(t).reportingSupervisors&&r(t).reportingSupervisors.length>0?(y(),h("div",Te,[n(s,{type:"fsMultiselectList",label:"Reporting Supervisor(s)",multiple:!0,closeOnSelect:!1,showClear:!0,typeaheaddata:r(t).reportingSupervisors,typeaheadkey:"name",typeaheadvalueattribute:"id",name:"supervisors",modelValue:e.reportingSupervisors,"onUpdate:modelValue":o[4]||(o[4]=l=>e.reportingSupervisors=l)},null,8,["typeaheaddata","modelValue"])])):S("",!0),r(t)?.employees&&r(t)?.employees.length>0?(y(),h("div",Ve,[n(s,{type:"fsMultiselectList",label:"Employee(s)",multiple:!0,closeOnSelect:!1,showClear:!0,typeaheaddata:r(x),defaultEmptyValue:null,typeaheadkey:"name",modelValue:e.employees,"onUpdate:modelValue":o[5]||(o[5]=l=>e.employees=l),typeaheadvalueattribute:"id",name:"employees"},null,8,["typeaheaddata","modelValue"])])):S("",!0),r(t)?.consentStatus&&r(t)?.consentStatus.length>0?(y(),h("div",Re,[n(s,{type:"fsMultiselectList",multiple:!0,closeOnSelect:!1,showClear:!0,label:"Consent Status",typeaheaddata:r(t)?.consentStatus,typeaheadkey:"name",typeaheadvalueattribute:"default",name:"Consent Status",autocomplete:"donotfill",defaultEmptyValue:null,modelValue:e.consentStatus,"onUpdate:modelValue":o[6]||(o[6]=l=>e.consentStatus=l)},null,8,["typeaheaddata","modelValue"])])):S("",!0),r(t)?.unions&&r(t)?.unions.length>0?(y(),h("div",Oe,[n(s,{type:"fsMultiselectList",multiple:!0,closeOnSelect:!1,showClear:!0,label:"Union(s)",typeaheaddata:r(t)?.unions,typeaheadkey:"name",typeaheadvalueattribute:"id",name:"Union(s)",autocomplete:"donotfill",defaultEmptyValue:null,modelValue:e.unions,"onUpdate:modelValue":o[7]||(o[7]=l=>e.unions=l)},null,8,["typeaheaddata","modelValue"])])):S("",!0),r(t)?.trades&&r(t)?.trades.length>0?(y(),h("div",ke,[n(s,{type:"fsMultiselectList",multiple:!0,closeOnSelect:!1,showClear:!0,label:"Trade(s)",typeaheaddata:r(t)?.trades,typeaheadkey:"name",typeaheadvalueattribute:"id",name:"Trade(s)",autocomplete:"donotfill",defaultEmptyValue:null,modelValue:e.trades,"onUpdate:modelValue":o[8]||(o[8]=l=>e.trades=l)},null,8,["typeaheaddata","modelValue"])])):S("",!0),r(t)?.departments&&r(t)?.departments.length>0?(y(),h("div",we,[n(s,{type:"fsMultiselectList",multiple:!0,closeOnSelect:!1,showClear:!0,label:"Department(s)",typeaheaddata:r(t)?.departments,typeaheadkey:"name",typeaheadvalueattribute:"id",name:"Department(s)",autocomplete:"donotfill",defaultEmptyValue:null,modelValue:e.departments,"onUpdate:modelValue":o[9]||(o[9]=l=>e.departments=l)},null,8,["typeaheaddata","modelValue"])])):S("",!0)]),_:1},512)]),_:1})]),_:1},8,["visible"])}}});const Be=W(Ie,[["__scopeId","data-v-a759e069"]]),Ee={class:"hq-pg list"},Fe={class:"dashboard-card__content list__table",id:"deductionTable"},Ae={class:"list__table b-stripe-vertical b-grid-header-no-border"},Le=Y({__name:"reports",setup(u){const c=ce(),d=H(),{setLoading:t}=fe(),{reportsCriteriaStore:O}=q(d),R={field:"title",ascending:!0},F=$(()=>G().ClientSide.StimulsoftApiUrl+"/viewer");function k(){if(!window.hasOwnProperty("Stimulsoft")){const g=document.createElement("script");g.setAttribute("src",F.value),g.setAttribute("type","text/javascript"),document.body.appendChild(g)}}k();const e=U({isOpen:!1,type:v.PendingAndApprovedTimeOff,title:""}),w=b(0),p=["id"],x=b(new Array),i=b(localStorage.getItem(`${x.value}SearchText`)??"");function o(){K(x.value,p,i.value,a.value)}const a=b(new X({...M.gridStoreConfig,sorters:[R],onFilter:()=>{i.value&&a.value.filters.count<w.value&&o(),w.value=a.value.filters.count},data:[{id:1,title:"Pending and Approved Time Off Report",type:v.PendingAndApprovedTimeOff},{id:2,title:"Time Off Balance Report",type:v.TimeOffBalance},{id:3,title:"Employee Contact Information",type:v.EmployeeContactInformation},{id:4,title:"W-2 Electronic Consent Report",type:v.W2ElectronicConsent}]})),s="reportList",_=b({...M.gridConfig,...z(s),...Q(s,R),minHeight:"80vh",emptyText:"",rowHeight:50,features:{search:!0},columns:[{flex:8,text:"Name",id:"title",field:"title",htmlEncode:!1},{flex:2,text:"Actions",type:"action",htmlEncode:!1,actions:[{renderer:()=>`
                <i class='b-action-item b-fa b-fa-file-chart-line'>Generate</i>`,onClick:async({record:g})=>{t(!0),e.type=g.data.type,O.value={},await d.fetchReportCriteriaStore(e.type),t(!1),e.isOpen=!0}}]}]}),T=b(null),I=$(()=>T.value?.instance.value.features);function B(){a.value.clearFilters(),I.value.filterBar.hideFilterBar()}function A(){localStorage.setItem(`${s}State`,JSON.stringify(a.value.state)),localStorage.setItem(`${s}SearchText`,i.value)}function D(){a.value.clearFilters(),a.value.clearSorters(),localStorage.removeItem(`${s}State`),localStorage.removeItem(`${s}SearchText`)}function l(g){localStorage.setItem("report",JSON.stringify(g)),c.push({name:"reportGenerate",params:{guid:e.type}})}return(g,f)=>(y(),h(ve,null,[V("div",Ee,[n(J,{title:"Report List","show-settings-button":!0,"show-filter-button":!0,"local-storage-key":s,onSaveSettings:f[0]||(f[0]=E=>A()),onClearSettings:f[1]||(f[1]=E=>D()),onHideFilterBar:f[2]||(f[2]=E=>B()),onShowFilterBar:f[3]||(f[3]=E=>r(I).filterBar.showFilterBar())}),V("div",Fe,[V("div",Ae,[n(r(Z),ye(_.value,{store:a.value,ref_key:"grid",ref:T}),null,16,["store"])])])]),n(Be,{isOpen:e.isOpen,onClose:f[4]||(f[4]=E=>e.isOpen=!1),typeReport:e.type,onSave:l},null,8,["isOpen","typeReport"])],64))}});const He=W(Le,[["__scopeId","data-v-e4783e31"]]);export{He as default};
