import{f as j}from"./gridConfigDefaults.8c72c19b.js";import{B as ae}from"./bryntumSearchBar.3bdd630f.js";import{S as ie,i as se}from"./grid.module.3b00878a.js";import{B as re}from"./BryntumGrid.2c4be387.js";import{g as le,a as de}from"./statefulSortFeature.3df4a43a.js";import{J as ue,K as ce,L as fe,N as pe,e4 as me,R as ve,d as J,Q as X,l as Z,a_ as be,j as f,b as ee,a1 as G,r as h,o as x,f as $,w as c,g as m,a as _,D as Q,I as T,u as w,aY as te,c as K,a2 as ge,aH as De,_ as oe,$ as _e,a0 as ye,e as he,F as Ee,z as we,A as xe,a3 as Se}from"./index.611fe570.js";import{c as b,b as Y,E as R}from"./DeductionType.5fffbeba.js";import"./foundationCompanyCasConnectionStore.b3301598.js";import"./debounce.cf77a06e.js";import"./isObject.c4ad145e.js";class Ie extends fe{constructor(i){const t=pe().ClientSide.WorkforceManagement+"/v1";super(i,t)}urlApi="Deductions";async getListOfDeductions(i){let t;try{const e=await this.axiosInstance.get(this.urlApi,{params:{deductionType:i}});if(e&&e.data&&e.status===200)t=e.data.filter(l=>l.deductionTypeId===i);else throw new Error("Failed to parse list of deductions")}catch(e){console.error("An unexpected error occurred attempting to retrieve the list of deductions.",e)}return t}async deactivateDeduction(i,t){let e;try{e=await this.PerformPatch(`${this.urlApi}/deactivate/${i}`,null)}catch{e=!1}return{success:e,errorMessage:e?`${t} deleted.`:"An unexpected error occurred attempting to delete benefit/deduction"}}async activateDeduction(i){let t;try{const e=this.getDeductionWithEncodedProperties(i);t=await this.PerformPatch(`${this.urlApi}/activate`,e)}catch{t=!1}return{success:t,errorMessage:t?"Deduction created.":"An unexpected error occurred attempting to create benefit/deduction"}}async updateDeduction(i){let t;try{const l=[this.getDeductionWithEncodedProperties(i)];t=await this.PerformPut(`${this.urlApi}`,l)}catch{t=!1}return{success:t,errorMessage:t?"Deduction updated.":"An unexpected error occurred attempting to update benefit/deduction"}}async getDeductions(i){let t;try{const e=await this.axiosInstance.get(`${this.urlApi}/${i}`);if(e&&e.data&&e.status===200)t=e.data;else throw new Error("Failed to parse deduction")}catch(e){console.error("An unexpected error occurred attempting to retrieve the deduction.",e)}return t}async getListOptionDeductions(i){let t;try{const e=await this.axiosInstance.get(`${this.urlApi}/listOfFoundationDeductions`,{params:{deductionMode:i}});if(e&&e.data&&e.data.length>0&&e.status===200)t=e.data.sort((l,d)=>l.miscellaneousDeductionId.localeCompare(d.miscellaneousDeductionId));else throw new Error("Failed to parse list of deductions")}catch(e){console.error("An unexpected error occurred attempting to retrieve the list of deductions.",e)}return t}getDeductionWithEncodedProperties(i){const t=["deductionName","customizedName"],e={...i};return me(t,e),e}}const O=new Ie([ue,ce]),ne=ve("deduction",()=>{async function g(a){return await O.getListOfDeductions(a)}async function i(a){return await O.getListOptionDeductions(a)}async function t(a){return await O.getDeductions(a)}async function e(a){return await O.activateDeduction(a)}async function l(a){return await O.updateDeduction(a)}async function d(a,v){return await O.deactivateDeduction(a,v)}return{getDeductionList:g,getDeductionOptionList:i,getDeductionDetail:t,activateDeduction:e,deactivateDeduction:d,updateDeduction:l}});var E=(g=>(g[g.ADD=1]="ADD",g[g.EDIT=2]="EDIT",g))(E||{});const Fe=[{id:b.BENEFIT,name:Y.BENEFIT},{id:b.DEDUCTION,name:Y.DEDUCTION}],Te=[{value:b.BENEFIT,text:"Benefit"},{value:b.DEDUCTION,text:"Deduction"}],Ae={class:"mr-3 d-flex align-items-center"},Ne={class:"h5 pl-2 my-auto font-weight-bold"},Be={class:"ms-auto"},ke={class:"d-flex align-items-center justify-content-between p-2"},Ce={class:"d-flex flex-column h-100 w-100 p-2 pt-3 toggle--green"},Oe={class:"deduction"},$e={class:"deduction"},Ve={key:0},Le=J({__name:"upsertBenefitPanel",props:{showAssignOnboardingPlan:{type:Boolean,default:!1}},emits:[R.RELOAD,R.CLOSE_FORM],setup(g,{expose:i,emit:t}){const e=g,l=ne(),d=X();Z.add(be);const a=f(null),v=f([]),o=f({}),A=f(null),N=ee(()=>e.showAssignOnboardingPlan),y=f(b.BENEFIT),S=f(null),M=()=>S.value==E.EDIT?"Edit Benefit/Deduction":"Add Benefit/Deduction";G(()=>y.value,()=>{o.value.deductionTypeId=y.value},{immediate:!0});const D=I=>{I?o.value.deductionFsNo=I.value:o.value.deductionFsNo=null},V=async()=>{const I=S.value,u=I===E.EDIT?"edit":"add";let F;if(I===E.EDIT?F=await l.updateDeduction(o.value):F=await l.activateDeduction(o.value),F.success){const B=y.value==b.BENEFIT?"Benefit":"Deduction";d.notifySuccess(`${B} ${u==="edit"?"updated":"added"}.`)}else d.notifyError(F.errorMessage);t(R.RELOAD),L(),setTimeout(()=>{A.value.resetForm()})},L=()=>{o.value.id=0,o.value.customizedName="",o.value.deductionName="",o.value.isViewInESS=!1,o.value.isWHQEditable=!0,o.value.foundationDeduction=null},U=()=>{L(),setTimeout(()=>{A.value.resetForm()}),y.value=b.BENEFIT,t(R.CLOSE_FORM)};return i({formData:o,selectedDeductionType:y,deductionModeActive:S,listOfFoundationDeduction:v,originalFormData:a}),(I,u)=>{const F=h("font-awesome-icon"),B=h("fs-link"),P=h("fs-button"),k=h("fs-form-radio-group"),z=h("fs-row"),W=h("fs-input"),H=h("fs-form-checkbox"),q=h("fs-container"),n=h("fs-sidebar"),s=h("VeeForm");return x(),$(s,{ref_key:"form",ref:A,id:"form",onSubmit:V},{default:c(({meta:p})=>[m(n,{id:"editBenefit","sidebar-class":"fsi-sidebar help-center","body-class":"help-center__body",right:"","no-close-on-esc":"","no-close-on-backdrop":"","bg-variant":"white",width:"425px",shadow:"sm","header-class":"border-bottom","footer-class":"border-top","aria-label":"benefit plan","no-header-close":"",modelValue:w(N),"onUpdate:modelValue":u[5]||(u[5]=r=>De(N)?N.value=r:null)},{title:c(()=>[_("div",Ae,[_("div",Ne,Q(M()),1),_("div",Be,[m(B,{class:"text-secondary",tag:"a",onClick:U},{default:c(()=>[m(F,{icon:["fal","times"],size:"sm"})]),_:1})])])]),footer:c(()=>[_("div",ke,[m(P,{variant:"outline-secondary",class:"btn btn-outline-gray",onClick:U},{default:c(()=>[T("Cancel")]),_:1}),S.value==w(E).EDIT?(x(),$(P,{key:0,variant:"btn-primary",class:"btn btn-primary",type:"submit",form:"form",disabled:!(p.valid&&!w(te.exports.isEqual)(a.value,o.value))},{default:c(()=>[T("SAVE")]),_:2},1032,["disabled"])):(x(),$(P,{key:1,variant:"btn-primary",class:"btn btn-primary",type:"submit",form:"form",disabled:!p.valid},{default:c(()=>[T("SAVE")]),_:2},1032,["disabled"]))])]),default:c(()=>[_("div",Ce,[m(q,{fluid:""},{default:c(()=>[m(z,{class:"align-items-center"},{default:c(()=>[m(k,{id:"radio-group-unit-options",modelValue:y.value,"onUpdate:modelValue":u[0]||(u[0]=r=>y.value=r),options:w(Te),name:"unit-options"},null,8,["modelValue","options"])]),_:1}),m(z,{class:"align-items-center pt-2"},{default:c(()=>[_("div",Oe,[m(W,{required:!0,label:"Name",rules:"required",type:"fsTextInput",maxlength:255,name:"DeductionName",modelValue:o.value.customizedName,"onUpdate:modelValue":u[1]||(u[1]=r=>o.value.customizedName=r)},null,8,["modelValue"])]),_("div",$e,[m(W,{type:"fsMultiselectList",label:"Foundation Deduction",required:!0,typeaheaddata:v.value,typeaheadkey:"text",modelValue:o.value.foundationDeduction,"onUpdate:modelValue":[u[2]||(u[2]=r=>o.value.foundationDeduction=r),D],typeaheadvalueattribute:"value",name:"FoundationDeduction",autocomplete:"donotfill",rules:{required:!0},disabled:S.value==w(E).EDIT&&o.value.deductionFsNo!=""},null,8,["typeaheaddata","modelValue","disabled"])]),_("div",null,[m(H,{modelValue:o.value.isViewInESS,"onUpdate:modelValue":u[3]||(u[3]=r=>o.value.isViewInESS=r),switch:"",size:"lg",name:"viewableInESS"},{default:c(()=>[T("Viewable to Employee")]),_:1},8,["modelValue"])]),y.value==w(b).BENEFIT?(x(),K("div",Ve,[m(H,{modelValue:o.value.isWHQEditable,"onUpdate:modelValue":u[4]||(u[4]=r=>o.value.isWHQEditable=r),switch:"",size:"lg",name:"isWHQEditable"},{default:c(()=>[T("401K Plan")]),_:1},8,["modelValue"])])):ge("",!0)]),_:1})]),_:1})])]),_:2},1032,["modelValue"])]),_:1},512)}}});const Pe=oe(Le,[["__scopeId","data-v-91f140a1"]]),Me={id:"benefitSearch",class:"dashboard-card","no-body":""},Ue={class:"deduction-tab"},ze={class:"dashboard-card__content list__table",id:"deductionTable"},We={class:"list__table b-stripe-vertical b-grid-header-no-border"},He=J({__name:"benefitsDeductions",setup(g){Z.add(_e);const{responsive:i}=ye(),t=f(0),e=X(),l=ne(),d=f(b.BENEFIT),a=f(null),v=f(!1),o="benefitsDeductionsId",A={field:"id",ascending:!1},N=f(null),y=ee(()=>N.value?.instance.value.features),S=f(0),M=f(localStorage.getItem(`${o}SearchText`)??""),D=f(new ie({...j.gridStoreConfig,sorters:[A],onFilter:()=>{M.value&&D.value.filters.count<S.value&&L(),S.value=D.value.filters.count}})),V=f(new Array);function L(){D.value.data=(V.value||[]).filter(U)}const U=n=>!0,I=()=>{localStorage.setItem(`${o}State`,JSON.stringify(D.value.state))},u=()=>{D.value.clearFilters(),D.value.clearSorters(),localStorage.removeItem(`${o}State`)};function F(){D.value.clearFilters(),y.value.filterBar.hideFilterBar()}const B=f({...j.gridConfig,...le(o),...de(o,A),minHeight:"100%",emptyText:"",columns:[{flex:2,text:"Name",id:"customizedName",field:"customizedName",sortable:!0,groupable:!1,htmlEncode:!1,cellTooltip:!0,region:!1},{hidden:!1,flex:2,text:"Foundation Deduction",id:"foundationDisplayName",field:"foundationDisplayName",sortable:!0,groupable:!1,htmlEncode:!1,region:!1},{hidden:!1,flex:2,columnWidth:100,text:"Viewable to Employee",id:"isViewInESS",align:"center",field:"isViewInESS",sortable:!0,groupable:!1,htmlEncode:!1,region:!1,renderer:({record:n})=>n.isViewInESS==!0?'<i class="b-fa b-icon-check"></i>':'<i class="b-fa b-fa-xmark"></i>'},{flex:1,type:"action",locked:i.breakpoint==="md",id:"action",text:"Actions",htmlEncode:!1,responsiveLevels:{small:{region:"right"}},columnDragToolbar:!1,enableHeaderContextMenu:!1,enableCellContextMenu:!1,cellCls:"b-action-cell--hover",region:!1,actions:[{renderer:()=>'<i class="b-action-item b-fa b-fa-edit btn btn-link text-green no-underline btn-deduction"><span>Edit</span></i>',onClick:({record:n})=>H(n.id)},{renderer:()=>'<i class="b-action-item b-fa b-fa-trash btn btn-link text-red no-underline btn-deduction"><span>Delete</span></i>',onClick:({record:n})=>q(n)}]}],subGridConfigs:{left:{flex:"1"},right:{width:120}}});async function P(){D.value.data=V.value;const n=localStorage.getItem(`${o}State`);n&&(D.value.state=JSON.parse(n))}G(d,()=>{k(d.value)});const k=async n=>{V.value=await l.getDeductionList(n),P(),M.value!==""&&L()},z=()=>{k(d.value),v.value=!v.value};he(async()=>{await k(b.BENEFIT)});const W=async()=>{const n=await l.getDeductionOptionList(E.ADD);a.value.deductionModeActive=E.ADD,a.value.listOfFoundationDeduction=n.map(s=>({text:`${s.miscellaneousDeductionId} - ${s.description}`,value:s.miscellaneousDeductionId})),a.value.selectedDeductionType=d.value,v.value=!v.value},H=async n=>{const s=await l.getDeductionDetail(n);let p;s.deductionFsNo!=""?p=await l.getDeductionOptionList(E.EDIT):p=await l.getDeductionOptionList(E.ADD),a.value.listOfFoundationDeduction=p.map(C=>({text:`${C.miscellaneousDeductionId} - ${C.description}`,value:C.miscellaneousDeductionId}));const r=a.value.listOfFoundationDeduction.find(C=>C.value===s.deductionFsNo);a.value.formData={...s,foundationDeduction:r},a.value.selectedDeductionType=s.deductionTypeId,a.value.deductionModeActive=E.EDIT,a.value.originalFormData=te.exports.cloneDeep(a.value.formData),v.value=!v.value},q=async n=>{const s=new se({header:`Delete ${n.deductionTypeId==b.BENEFIT?"Benefit":"Deduction"}`,autoShow:!1,centered:!0,closeAction:"destroy",closable:!0,autoClose:!1,width:"500px",cls:"popup-delete",modal:!0,bbar:{items:{cancel:{text:"CANCEL",minWidth:100,onAction:()=>{s.close()}},delete:{text:"DELETE",minWidth:100,cls:"b-raised b-red",onAction:async()=>{try{const p=await l.deactivateDeduction(n.id,n.deductionName);p.success?e.notifySuccess(p.errorMessage):e.notifyError(p.errorMessage),k(d.value)}catch(p){console.log(p)}s.close()}}}},html:`<div class="d-flex align-items-center h-100">
                <i class="b-fa b-fa-exclamation-circle icon-exclamation-circle"></i>
                Are you sure you want to delete the ${n.deductionName} ${n.deductionTypeId==b.BENEFIT?"benefit":"deduction"}?
                </br>This process cannot be undone.</div>`});s.show()};return G(()=>i.breakpoint,()=>{i.breakpoint==="sm"&&B.value.columns.forEach(n=>{["foundationDeduction","viewInEss"].includes(n.id)&&(n.hidden=!0)}),t.value++}),(n,s)=>{const p=h("fs-button");return x(),K("div",Me,[_("div",null,[m(ae,{title:"Benefits/Deductions","local-storage-key":o,"show-settings-button":!0,"show-filter-button":!0,"show-search-button":!1,"show-footer-search":!1,onSaveSettings:s[0]||(s[0]=r=>I()),onClearSettings:s[1]||(s[1]=r=>u()),onHideFilterBar:s[2]||(s[2]=r=>F()),onShowFilterBar:s[3]||(s[3]=r=>w(y).filterBar.showFilterBar())},{buttons:c(()=>[m(p,{variant:"btn-primary",class:"btn btn-primary ms-2",onClick:W},{default:c(()=>[T(Q(d.value===w(b).BENEFIT?"Add Benefit":"Add Deduction"),1)]),_:1})]),_:1})]),_("div",Ue,[(x(!0),K(Ee,null,we(w(Fe),r=>(x(),$(p,{key:r.id,pill:"",variant:d.value===r.id?"boat-orchid":"link",class:xe({"text-dark text-decoration-none":d.value!==r.id}),onClick:C=>d.value=r.id},{default:c(()=>[T(Q(r.name),1)]),_:2},1032,["variant","class","onClick"]))),128))]),_("div",ze,[_("div",We,[(x(),$(w(re),Se(B.value,{store:D.value,ref_key:"grid",ref:N,key:t.value}),null,16,["store"]))])]),m(Pe,{showAssignOnboardingPlan:v.value,onReload:z,onCloseForm:s[4]||(s[4]=r=>v.value=!v.value),ref_key:"childComponent",ref:a},null,8,["showAssignOnboardingPlan"])])}}});const Re=oe(He,[["__scopeId","data-v-96452ea6"]]),tt=J({__name:"benefitsCenter",setup(g){return(i,t)=>(x(),$(Re))}});export{tt as default};
