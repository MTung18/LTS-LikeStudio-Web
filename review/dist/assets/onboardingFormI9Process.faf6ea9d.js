import{d as We,T as Xe,Q as Ze,b as ea,y as aa,j as r,s as oe,i as Se,bb as la,bO as ta,l as oa,dh as sa,cb as ia,c5 as na,c4 as q,cp as se,dC as ra,aJ as ua,m as da,S as ca,dd as ma,a1 as Ie,aW as fa,e as pa,E as V,r as C,o as y,c as b,u as _,f as Ce,w as c,a as t,g as i,I as d,F as ie,z as ne,A as De,a2 as re,aY as O,dD as v,bd as va,be as _a,D as ue,cN as de,ax as ha,ay as ya,_ as Fa}from"./index.611fe570.js";import{D as Ne}from"./darkThemeModal.c38e7d4c.js";import{u as Te}from"./onboardingFormI9Store.aced3dfd.js";import{u as we}from"./onboardingStore.b8199798.js";import{F as H}from"./FormField.7af7663e.js";import{u as ga}from"./reportTemplateStore.f0128478.js";import"./onboardingFormINineApi.7260ada1.js";const S=x=>(ha("data-v-de5c991a"),x=x(),ya(),x),Ea={class:"tax-withholding-header d-flex align-items-center py-3"},ba=S(()=>t("div",{class:"tax-withholding-header__title"},"Form I-9",-1)),Sa={class:"d-flex align-items-center"},Ia={class:"mb-3 section"},Ca={class:"d-flex justify-content-between"},Da={class:"fw-bold"},Na={class:"d-flex align-items-center"},Ta=["innerHTML"],wa={class:"mb-3 section"},ka={class:"d-flex justify-content-between"},Pa={class:"fw-bold"},Oa={class:"d-flex align-items-center"},xa=["innerHTML"],Ma=S(()=>t("div",{class:"label-required"},[t("div",null,"Upload file")],-1)),Ua={class:"mb-3"},Aa=["onClick"],La=["onClick"],Ra=S(()=>t("div",{class:"label-required"},[t("div",null,"Supporting Document(s)")],-1)),$a={class:"mb-3"},Ba=["onClick"],za=["onClick"],Ga={class:"d-flex"},qa=S(()=>t("h5",null,[d(" Are you sure you want to leave this page? "),t("br"),d(" You have unsaved changes, your data will be lost. ")],-1)),Va={class:"tax-withholding-header d-flex align-items-center py-3"},Ha=S(()=>t("div",{class:"tax-withholding-header__title"},"Form I-9",-1)),Ya={class:"d-flex align-items-center"},ja={class:"mb-1"},Qa={class:"mb-3"},Ja=S(()=>t("div",{class:"label-required"},[t("div",null,"Upload file"),t("div",{class:"required"},"*")],-1)),Ka={class:"mb-3"},Wa=["onClick"],Xa=["onClick"],Za={class:"d-flex"},el=S(()=>t("h5",null,[d(" Are you sure you want to leave this page? "),t("br"),d(" You have unsaved changes, your data will be lost. ")],-1)),al=We({__name:"onboardingFormI9Process",setup(x){const ke=Xe(),{notifyError:M}=Ze(),Pe=ea(()=>ke?.activeUserClient?.clientGuid??"Shared"),Y=aa(),D=r(),U=r(),{employeeDetails:Oe}=oe(Se()),{fetchEmployeeDetails:xe}=Se(),u=r(),A=r(),g=r(),j=r(),Me=r(null),h=Y.currentRoute.value.params.id,L=r(!1),Q=la(),R=Te(),{setLoading:F}=ta(),{dataOnboardingFormINine:$}=oe(Te()),{onboardingSideNavItem:ce}=oe(we()),B=we(),m=r(!1),Ue=r(!1),me=r(""),N=r(!1),J=r(!1),E=r(!1);oa.add(sa,ia,na,q,se,ra,ua,da,ca,ma);const K={UPDATE:"Update",DELETE:"Delete"},W={Employee:"Employee",Employer:"Employer"},p={UPLOAD_DOCUMENT:"File Form I9",SUPPORTING_DOCUMENT:"Support File Form I9"},I=r([]),T=r([]),X=r([]),Z=a=>{a===p.UPLOAD_DOCUMENT?document.getElementById("upload_file").click():a===p.SUPPORTING_DOCUMENT&&document.getElementById("upload_document_support").click()},Ae=()=>{const a=u.value.fieldModels.reduce((e,{fieldKey:l,fieldValue:n})=>(n!==void 0&&(e[l]=n),e),{});g.value=a,j.value={...g.value}},Le=()=>{const a=u.value.fieldModels.map(e=>{const l=g.value[e.fieldKey]||"";return{...e,fieldValue:l}});u.value.fieldModels=a},fe=r(),pe=r(),w=r(),k=r(),Re=async()=>{await R.fetchFormINine(Number(h),H.I9Employer),fe.value=$.value,await R.fetchFormINine(Number(h),H.I9Employee),pe.value=$.value,$e()},$e=()=>{const a=fe.value.fieldModels.reduce((l,{fieldKey:n,fieldValue:s})=>(s!==void 0&&(l[n]=s),l),{});w.value=a,w.value.status==""&&(w.value.status=1);const e=pe.value.fieldModels.reduce((l,{fieldKey:n,fieldValue:s})=>(s!==void 0&&(l[n]=s),l),{});k.value=e,k.value.status==""&&(k.value.status=0)},z=r(!0),Be=a=>{let e;return a==0?(e=v.NOT_STARTED,z.value=!0):L.value?(e=v.COMPLETED,z.value=!1):(e=v.IN_PROGRESS,z.value=!0),e},ee=r(null),ze=async a=>{await Re(),ce.value.length==0&&await B.getOnboardingSideNavItems(Number(h));const e=Be(Number(k.value.status));a||(ee.value=ce.value.find(l=>l.progressSidebarUrl.trim().toLowerCase()==="onboardingFormI9".trim().toLocaleLowerCase()),w.value.status==v.COMPLETED&&e==v.COMPLETED||u.value.uploadFileStateForms.length>0&&u.value.uploadFileStateForms.find(l=>l.description===p.UPLOAD_DOCUMENT)!=null?await B.markOnboardingSidenavItemAsDone(ee.value.progressSidebarId,!0,Number(h)):await B.markOnboardingSidenavItemAsDone(ee.value.progressSidebarId,!1,Number(h)))},ve=async a=>{I.value=[],T.value=[],X.value=[],await R.fetchFormINine(Number(h),U.value),u.value=$.value,A.value=O.exports.cloneDeep($.value),Ae(),m.value=!1,await ze(a)},ae=(a,e,l)=>{T.value.push(a),X.value.push(e),I.value=I.value.filter(n=>!T.value.includes(n.fileName)),he(null,T.value,K.DELETE)},Ge=a=>{const e=["pdf","jpeg","png","jpg"],l=a.split(".").pop().toLowerCase();return e.includes(l)},qe=a=>a<=1e7,le=async(a,e)=>{const l=a.target,n=l.files;for(let s=0;s<n.length;s++){if(!Ge(n[s].name)){M("Wrong file format, upload PDF, PNG, JPEG or JPG only!");return}if(!qe(n[s].size)){M("The maximum upload size is 10MB!");return}}[...l.files].forEach(s=>{Ve(s,e)}),F(!1)},_e=(a,e,l)=>{let n,s,f;switch(a==W.Employee?e==0?f=v.NOT_STARTED:l?f=v.COMPLETED:f=v.IN_PROGRESS:f=e,f){case v.COMPLETED:n="#1ABC9C",s="Completed";break;case v.NOT_STARTED:n="#6E7C8F",s="Not Started";break;case v.IN_PROGRESS:n="#FF6600",s="In Progress";break;default:n="#000000",s="unknown";break}return`<div style="display: flex; align-items: center">
    <span style="display: inline-block; width: 5px; height: 5px; border-radius: 50%; background-color: ${n}; margin-right: 5px;"></span>
    ${s}
  </div>`},Ve=async(a,e)=>{const l=await va(_a.EmployeeI9,`${Pe.value}`,`${h}`),n=a.name,s={fileName:n,filePath:`${l}`,fileObject:new File([a],n),description:e};I.value.push(s),he(I.value,null,K.UPDATE)},he=(a,e,l)=>{if(l===K.UPDATE)u.value.uploadFileStateForms=[...A.value.uploadFileStateForms],u.value.uploadFileStateForms=u.value.uploadFileStateForms.filter(s=>!T.value.includes(s.fileName)),a.map(s=>({fileName:s.fileName,filePath:s.filePath+"/"+s.fileName,formFieldId:u.value.fieldModels.filter(f=>f.fieldKey==="formFiles")[0].formFieldId,description:s.description})).forEach(s=>{u.value.uploadFileStateForms.push(s)});else{const n=[...u.value.uploadFileStateForms.filter(s=>!e.includes(s.fileName))];u.value.uploadFileStateForms=n}};Ie(()=>!O.exports.isEqual(u.value?.uploadFileStateForms,A.value?.uploadFileStateForms),()=>{E.value&&(O.exports.isEqual(u.value?.uploadFileStateForms,A.value?.uploadFileStateForms)?m.value=!1:m.value=!0)}),Ie(()=>!O.exports.isEqual(g.value,j.value),()=>{E.value&&(O.exports.isEqual(g.value,j.value)?m.value=!1:m.value=!0)});const He=async(a,e)=>{await Q.uploadDocument({path:a,file:e,fileName:e.name},!0)},Ye=async a=>{await Q.deleteFile(a)},je=async()=>{await R.editFormINine(u.value,U.value),await ve(!1)},Qe=async()=>{await Promise.all(I.value.map(async a=>{await He(a.filePath,a.fileObject)})),await Promise.all(X.value.map(async a=>{await Ye(a)}))},te=async a=>{await Q.downloadFile(a)},G=async a=>{try{F(!0),m.value&&(Le(),await Qe(),await je(),m.value=!1)}catch(e){console.error(e)}finally{Ue.value=!1,m.value=!1,F(!1),a&&Y.push({name:"onboardingEEOSelfIdentification"})}};fa((a,e,l)=>{if(m.value)return N.value=!0,me.value=a.fullPath,J.value?(l(),!0):(l(!1),!1);l()});const ye=()=>{N.value=!1,J.value=!0,Y.push(me.value)},Fe=()=>{N.value=!1,J.value=!1},Je=async()=>{await xe(h),D.value=Oe.value.employeeStatusId};pa(async()=>{try{F(!0),L.value=await B.getEmployeeFormSubmit(Number(h)),await Je(),D.value==V.Onboard?U.value=H.I9Summary:D.value==V.QuickHire&&(U.value=H.I9QuickHire),await ve(!0),E.value=!0,F(!1)}catch(a){M("There was an error fetching Form I9"),console.error(a)}finally{E.value=!0,F(!1)}});const{getDocumentTemplate:Ke}=ga(),ge=async(a,e)=>{F(!0);try{await Ke(a,e)}catch{M(`${a} is missing`)}finally{F(!1)}};return(a,e)=>{const l=C("font-awesome-icon"),n=C("fs-button"),s=C("fs-link"),f=C("fs-col"),Ee=C("fs-input"),be=C("fs-container");return E.value?(y(),b("div",{key:0,ref_key:"container",ref:Me},[D.value==_(V).Onboard&&E.value?(y(),Ce(be,{key:0,fluid:"",class:"overflow-auto px-4",id:"form-i9",style:{paddingBottom:"100px"}},{default:c(()=>[t("div",Ea,[ba,t("div",Sa,[i(n,{class:"d-flex align-items-center",type:"submit",variant:"outline-primary",disabled:!m.value,onClick:e[0]||(e[0]=o=>G(!1))},{default:c(()=>[i(l,{icon:["fal","floppy-disk"]}),d(" Save")]),_:1},8,["disabled"]),i(n,{type:"submit",variant:"primary",disabled:!m.value,onClick:e[1]||(e[1]=o=>G(!0))},{default:c(()=>[d("Save & next")]),_:1},8,["disabled"])])]),i(f,{md:"10"},{default:c(()=>[t("div",Ia,[t("div",Ca,[t("div",Da,[i(l,{icon:["fal","user"],size:"lg",class:"me-2"}),d(" SECTION 1: Employee Information and Attestation ")]),t("div",Na,[t("div",{innerHTML:_e(W.Employee,Number(k.value.status),L.value)},null,8,Ta),i(s,{to:{name:"onboardingI9Employee"},tag:"a"},{default:c(()=>[i(l,{size:"lg",icon:["fal","arrow-up-right-from-square"],class:"text-primary"})]),_:1})])])]),t("div",wa,[t("div",ka,[t("div",Pa,[i(l,{icon:["fal","city"],size:"lg",class:"me-2"}),d(" SECTION 2 & 3: Employment Eligibility Verification ")]),t("div",Oa,[t("div",{innerHTML:_e(W.Employer,Number(w.value.status),L.value)},null,8,xa),i(s,{to:{name:"onboardingI9Employer"},tag:"a",disabled:z.value},{default:c(()=>[i(l,{size:"lg",icon:["fal","pen-to-square"],class:"text-primary"})]),_:1},8,["disabled"])])])]),Ma,t("div",Ua,[i(f,{cols:"5"},{default:c(()=>[t("span",null,[t("input",{type:"file",multiple:"",id:"upload_file",onChange:e[2]||(e[2]=o=>le(o,p.UPLOAD_DOCUMENT)),ref:"fileInput",hidden:""},null,544)]),i(n,{variant:"outline-primary",onClick:e[3]||(e[3]=o=>Z(p.UPLOAD_DOCUMENT))},{default:c(()=>[i(l,{icon:["fal","arrow-up-from-bracket"],class:"me-2"}),d("Upload")]),_:1}),(y(!0),b(ie,null,ne(u.value?.uploadFileStateForms.filter(o=>o.description===p.UPLOAD_DOCUMENT),o=>(y(),b("a",{key:o.filePath,class:"text-success d-block my-2"},[i(l,{icon:["fal","paperclip"],style:{color:"rgba(0, 0, 0, 0.45)"}}),t("span",{class:"ms-2",onClick:P=>te(o.filePath)},ue(_(de)(o.fileName)),9,Aa),d(" \xA0 "),t("div",{style:{display:"inline",float:"right"},onClick:P=>ae(o.fileName,o.filePath,o.description)},[i(l,{icon:_(q),class:"text-danger"},null,8,["icon"])],8,La)]))),128))]),_:1})]),Ra,t("div",$a,[i(f,{cols:"5"},{default:c(()=>[t("span",null,[t("input",{type:"file",multiple:"",id:"upload_document_support",onChange:e[4]||(e[4]=o=>le(o,p.SUPPORTING_DOCUMENT)),ref:"fileInput",hidden:""},null,544)]),i(n,{variant:"outline-primary",onClick:e[5]||(e[5]=o=>Z(p.SUPPORTING_DOCUMENT))},{default:c(()=>[i(l,{icon:["fal","arrow-up-from-bracket"],class:"me-2"}),d("Upload")]),_:1}),(y(!0),b(ie,null,ne(u.value?.uploadFileStateForms.filter(o=>o.description===p.SUPPORTING_DOCUMENT),o=>(y(),b("a",{key:o.filePath,class:"text-success d-block my-2"},[i(l,{icon:["fal","paperclip"],style:{color:"rgba(0, 0, 0, 0.45)"}}),t("span",{class:"ms-2",onClick:P=>te(o.filePath)},ue(_(de)(o.fileName)),9,Ba),d(" \xA0 "),t("div",{style:{display:"inline",float:"right"},onClick:P=>ae(o.fileName,o.filePath,o.description)},[i(l,{icon:_(q),class:"text-danger"},null,8,["icon"])],8,za)]))),128))]),_:1})]),t("div",null,[i(Ee,{type:"fsTextArea",modelValue:g.value.note,"onUpdate:modelValue":e[6]||(e[6]=o=>g.value.note=o),label:"Note",rows:"5"},null,8,["modelValue"])])]),_:1}),i(Ne,{ref:"leaveDialog",showModal:N.value,title:"Unsaved Changes",okText:"YES, LEAVE",okTextVariant:"danger",cancelText:"stay",cancelBtnVariant:"light",onClose:Fe,onOk:ye},{content:c(()=>[t("span",Ga,[i(l,{class:De(["me-2","text-danger"]),icon:_(se),size:"lg"},null,8,["icon"]),qa])]),_:1},8,["showModal"])]),_:1})):re("",!0),D.value==_(V).QuickHire&&E.value?(y(),Ce(be,{key:1,fluid:"",class:"overflow-auto px-4",id:"form-i9",style:{paddingBottom:"100px"}},{default:c(()=>[t("div",Va,[Ha,t("div",Ya,[i(n,{class:"d-flex align-items-center",type:"submit",variant:"outline-primary",disabled:!m.value||u.value?.uploadFileStateForms.length==0,onClick:e[7]||(e[7]=o=>G(!1))},{default:c(()=>[i(l,{icon:["fal","floppy-disk"]}),d(" Save")]),_:1},8,["disabled"]),i(n,{type:"submit",variant:"primary",disabled:!m.value||u.value?.uploadFileStateForms.length==0,onClick:e[8]||(e[8]=o=>G(!0))},{default:c(()=>[d("Save & next")]),_:1},8,["disabled"])])]),t("div",ja,[d(" Read instructions carefully before completing this form. See the Form I-9 filling instructions "),i(s,{onClick:e[9]||(e[9]=o=>ge("Form_I9.pdf",!1)),class:"desc-link"},{default:c(()=>[d("here.")]),_:1})]),t("div",Qa,[d(" Please download and fill in the "),i(s,{onClick:e[10]||(e[10]=o=>ge("Form_I9_Paper_Version.pdf",!1)),class:"desc-link"},{default:c(()=>[d("Form I-9")]),_:1}),d(" form, then upload the file(s) below. ")]),i(f,{md:"10"},{default:c(()=>[Ja,t("div",Ka,[i(f,{cols:"5"},{default:c(()=>[t("span",null,[t("input",{type:"file",multiple:"",id:"upload_file",onChange:e[11]||(e[11]=o=>le(o,p.UPLOAD_DOCUMENT)),ref:"fileInput",hidden:""},null,544)]),i(n,{variant:"outline-primary",onClick:e[12]||(e[12]=o=>Z(p.UPLOAD_DOCUMENT))},{default:c(()=>[i(l,{icon:["fal","arrow-up-from-bracket"],class:"me-2"}),d("Upload")]),_:1}),(y(!0),b(ie,null,ne(u.value?.uploadFileStateForms.filter(o=>o.description===p.UPLOAD_DOCUMENT),o=>(y(),b("a",{key:o.filePath,class:"text-success d-block my-2"},[i(l,{icon:["fal","paperclip"],style:{color:"rgba(0, 0, 0, 0.45)"}}),t("span",{class:"ms-2",onClick:P=>te(o.filePath)},ue(_(de)(o.fileName)),9,Wa),d(" \xA0 "),t("div",{style:{display:"inline",float:"right"},onClick:P=>ae(o.fileName,o.filePath,o.description)},[i(l,{icon:_(q),class:"text-danger"},null,8,["icon"])],8,Xa)]))),128))]),_:1})])]),_:1}),i(Ne,{ref:"leaveDialog",showModal:N.value,title:"Unsaved Changes",okText:"YES, LEAVE",okTextVariant:"danger",cancelText:"stay",cancelBtnVariant:"light",onClose:Fe,onOk:ye},{content:c(()=>[t("span",Za,[i(l,{class:De(["me-2","text-danger"]),icon:_(se),size:"lg"},null,8,["icon"]),el])]),_:1},8,["showModal"])]),_:1})):re("",!0)],512)):re("",!0)}}});const ul=Fa(al,[["__scopeId","data-v-de5c991a"]]);export{ul as default};
