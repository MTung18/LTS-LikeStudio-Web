import{d as q,b as w,r as c,o as R,f as T,w as l,a as _,g as n,D as N,H as X,u as C,aH as F,be as $,l as Y,af as Z,j as i,s as ee,bb as te,Q as ae,a1 as oe,e as le,I as x,ao as ne,a2 as se,ai as ue,a4 as de,ap as ie,M as g,aj as re,bq as ce}from"./index.611fe570.js";import{D as B,u as me,a as fe}from"./documentMetadataStore.ea29648e.js";const pe={class:"d-flex align-items-center justify-content-around w-100"},ve=_("div",{class:"fsi-pg__title"},"Actions",-1),ye={class:"text-secondary my-3"},De=q({__name:"actionPanel",props:{showPanel:{type:Boolean,default:!0},title:{default:"Actions"},numberOfItemsSelected:null},setup(m,{emit:y}){const r=m,a=w({get(){return r.showPanel},set(t){y("update:showPanel",t)}});return(t,s)=>{const f=c("font-awesome-icon"),I=c("fs-link"),d=c("fs-container"),p=c("fs-sidebar");return R(),T(p,{id:"sidebar","sidebar-class":"fsi-sidebar border-start",shadow:"",right:"",modelValue:C(a),"onUpdate:modelValue":s[1]||(s[1]=h=>F(a)?a.value=h:null),"no-header-close":"","header-class":"border-bottom",width:"320px"},{title:l(()=>[_("div",pe,[ve,n(I,{class:"ms-auto text-secondary",tag:"a",onClick:s[0]||(s[0]=h=>a.value=!1)},{default:l(()=>[n(f,{icon:["fal","times"],size:"sm"})]),_:1})])]),default:l(()=>[n(d,{fluid:"",class:"fsi-pg__container contain"},{default:l(()=>[_("div",ye,N(m.numberOfItemsSelected)+" "+N(m.numberOfItemsSelected===1?"entry":"entries")+" selected",1),X(t.$slots,"default")]),_:3})]),_:3},8,["modelValue"])}}}),be={class:"d-flex contain py-3"},_e={class:"d-flex flex-column h-100 w-100 pt-3"},we=_("span",{class:"ms-1"},"Contains Restricted Info",-1),he=["accept"],Se=q({__name:"addDocumentPanel",props:{folderPath:{default:""},showPanel:{type:Boolean,default:!1},docType:{default:$.ClientDocument},employeeId:{default:null}},emits:["update:showPanel","documentUploaded"],setup(m,{emit:y}){const r=m;Y.add(Z);const a=i(null),t=i(new B),s=i(),f=i(null),I=i(null),d=i({name:""}),p=i(!1),h=i(""),b=i(!0),D=me(),{documentCategories:H}=ee(D),S=te(),{notifySuccess:P,notifyError:A}=ae(),L=w(()=>r.docType===$.ClientDocument),O=w(()=>S.allowedExtensions),E=w({get(){return r.showPanel},set(o){k(!0),de(),y("update:showPanel",o)}});oe(()=>[t.value,d.value,a],()=>{(t.value.name||t.value.description||t.value.isRestricted||a.value&&a.value.id>0||d.value?.name)&&(b.value=!1)},{immediate:!0,deep:!0});function j(o){const e=o.target;e&&e.files&&e.files.length>0&&(d.value=e.files[0])}async function G(){d.value&&(await S.uploadDocument({path:ce(r.folderPath),file:d.value,fileName:d.value.name},!0),f.value=S.uploadedDocumentDetails)}async function Q(o){a.value&&(t.value.documentCategoryId=a.value.id),r.employeeId&&(t.value.employeeId=r.employeeId,t.value.documentCategoryId=fe.General),f.value?.path&&f.value?.path!=""?(t.value.filePath=f.value.path,await D.addDocumentMetadata(t.value),D.isDocumentUploaded?(P(g.DOCUMENT_META.SAVE_SUCCESS),E.value=o,k(o),y("documentUploaded")):A(g.DOCUMENT_META.SAVE_ERROR)):A(g.DOCUMENT_META.SAVE_ERROR)}async function k(o=!1){d.value={name:""};const e=document.getElementById("fileInput");e&&(e.value=null),a.value=null,await s.value.resetForm(),p.value=!1,t.value=new B,b.value=!0,o&&setTimeout(async()=>{await k()},25)}async function U(o){try{const e=await s.value.validate();if(p.value=!0,!e.valid){ie("observer");return}b.value=!0,P(g.COMMON.UPLOADING),await G(),await Q(o)}catch(e){A(g.COMMON.UPLOAD_ERROR),console.debug(e)}finally{b.value=!1}}async function W(){O.value?.length<=0&&(await S.fetchAllowedExtensions(),h.value=O.value?.map(o=>o.extensionType)?.join(", "))}return le(async()=>{await Promise.all([W(),D.fetchDocumentCategoryList()]),b.value=!0}),(o,e)=>{const M=c("fs-button"),V=c("fs-input"),z=c("fs-form-checkbox"),J=c("fs-container"),K=c("fs-sidebar");return R(),T(K,{"sidebar-class":"fsi-sidebar help-center","body-class":"help-center__body",right:"","no-close-on-esc":"","no-close-on-backdrop":"","bg-variant":"white",width:"425px",shadow:"sm","header-class":"border-bottom","footer-class":"border-top","aria-label":"addDocumentMetaData",modelValue:C(E),"onUpdate:modelValue":e[8]||(e[8]=v=>F(E)?E.value=v:null),title:"Add Document"},{footer:l(({hide:v})=>[_("div",be,[n(M,{variant:"outline-secondary",class:"btn btn-outline-gray",onClick:v},{default:l(()=>[x("Cancel")]),_:2},1032,["onClick"]),n(M,{variant:"outline-green",class:"ms-auto",disabled:b.value,onClick:e[0]||(e[0]=u=>U(!1))},{default:l(()=>[x("SAVE & DONE")]),_:1},8,["disabled"]),n(M,{variant:"btn-primary",class:"btn btn-primary",disabled:b.value,onClick:e[1]||(e[1]=u=>U(!0))},{default:l(()=>[x("SAVE & NEW")]),_:1},8,["disabled"])])]),default:l(()=>[_("div",_e,[n(J,{fluid:"",class:"contain"},{default:l(()=>[n(C(ne),{ref_key:"observer",ref:s,id:"observer"},{default:l(({meta:v})=>[n(V,{required:!0,modelValue:t.value.name,"onUpdate:modelValue":e[2]||(e[2]=u=>t.value.name=u),type:"fsTextInput",label:"Name",maxlength:100,rules:{required:!0},name:"name",formMeta:{...v,validated:p.value}},null,8,["modelValue","formMeta"]),n(V,{type:"fsTextInput",label:"Description",maxlength:200,modelValue:t.value.description,"onUpdate:modelValue":e[3]||(e[3]=u=>t.value.description=u),name:"description",formMeta:{...v,validated:p.value}},null,8,["modelValue","formMeta"]),n(z,{class:"mb-3",style:{"margin-left":"-0.5em"},modelValue:t.value.isRestricted,"onUpdate:modelValue":e[4]||(e[4]=u=>t.value.isRestricted=u)},{default:l(()=>[we]),_:1},8,["modelValue"]),C(L)?(R(),T(V,{key:0,type:"fsMultiselectList",label:"Document Category",id:"documentCategory",labelId:"documentCategoryLabelId",modelValue:a.value,"onUpdate:modelValue":e[5]||(e[5]=u=>a.value=u),required:!0,typeaheaddata:C(H),typeaheadkey:"name",typeaheadvalueattribute:"id",name:"documentCategory",autocomplete:"donotfill",dropdownSearchable:!0,rules:{required:!0},formMeta:{...v,validated:p.value}},null,8,["modelValue","typeaheaddata","formMeta"])):se("",!0),n(V,{id:"uploaderText",required:!0,type:"fsTextInput",label:"Upload Document",readonly:!0,name:"upload",rules:{required:!0},onClick:e[7]||(e[7]=u=>o.$refs.fileInput.click()),formMeta:{...v,validated:p.value},"model-value":d.value?.name??""},{"input-group-content":l(()=>[ue(_("input",{id:"fileInput",type:"file",ref_key:"fileInput",ref:I,accept:h.value,onChange:e[6]||(e[6]=u=>j(u))},null,40,he),[[re,!1]]),n(M,{variant:"btn-primary",class:"btn btn-primary"},{default:l(()=>[x("BROWSE")]),_:1})]),_:2},1032,["formMeta","model-value"])]),_:1},512)]),_:1})])]),_:1},8,["modelValue"])}}});function Ee(){const m=i([]),y=w(()=>m.value.length),r=w(()=>y.value>0);function a(t,s){Array.isArray(s.selection)&&s.selection.length>0?t.value=s.selection.map(f=>f.data):t.value=[]}return{currentSelectedRows:m,selectedRowCount:y,isRowSelected:r,bryntumSelectedRowHandler:a}}export{Se as _,De as a,Ee as u};
