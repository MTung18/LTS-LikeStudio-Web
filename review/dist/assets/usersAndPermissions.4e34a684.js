import{S as L}from"./grid.module.3b00878a.js";import{B as T}from"./BryntumGrid.2c4be387.js";import{d as y,s as V,j as r,y as N,e as x,r as b,o as h,c as S,g as o,a as F,a3 as P,u as v,a1 as k,w as f,ai as M,aj as J,f as $,a2 as q,F as K,at as Q,I as W,aH as X}from"./index.611fe570.js";import{u as A}from"./permissionGroupStore.a1288023.js";import{s as _}from"./SorterFunctions.d9cfdebe.js";import{f as Y}from"./gridConfigDefaults.8c72c19b.js";import{B as Z}from"./bryntumSearchBar.3bdd630f.js";import{f as ee}from"./filterStoreDataBySearchText.3eea2082.js";import{u as I}from"./userStore.52ce8b56.js";import{_ as te}from"./iconsToolbarWidget.vue_vue_type_script_setup_true_lang.c4241c47.js";import{_ as se}from"./emptyGridLayout.vue_vue_type_script_setup_true_lang.16e4a64a.js";import"./foundationCompanyCasConnectionStore.b3301598.js";import"./debounce.cf77a06e.js";import"./isObject.c4ad145e.js";const ae={class:"list__table b-stripe-vertical b-stripe-horizontal b-grid-header-no-border"},re=y({__name:"permissionGroupList",setup(w){const{fetchPermissionGroupList:g}=A(),{permissionGroupList:l}=V(A()),t=r(new L),n=N(),u=r(!1);x(async()=>{u.value=!0,await g(),t.value.data=l.value,t.value.sort({field:"name",ascending:!0}),u.value=!1});const c=r({autoHeight:!0,emptyText:"",columns:[{flex:2,text:"Name",id:"name",field:"name",sortable:(s,i)=>_(s.name,i.name),groupable:!1,cellCls:"ps-3",cls:"ps-3"},{flex:2,text:"Description",id:"description",field:"description",sortable:(s,i)=>_(s.description,i.description),groupable:!1},{flex:1,text:"Users",id:"userCount",field:"userCount",sortable:!0,groupable:!1}],sortFeature:{prioritizeColumns:!0}});function m(s){n.push({name:"permissionGroupDetails",params:{permissionGroupId:s.record.data.id}})}return(s,i)=>{const d=b("fs-overlay");return h(),S("div",null,[o(d,{show:u.value,"spinner-variant":"primary",class:"fsi-pg__overlay","no-wrap":""},null,8,["show"]),F("div",ae,[o(v(T),P({readOnly:!0},c.value,{store:t.value,onCellClick:m}),null,16,["store"])])])}}}),oe={class:"hq-pg list"},le={class:"list__table b-stripe-vertical b-stripe-horizontal b-grid-header-no-border"},ie=y({__name:"userList",setup(w){const{fetchUserList:g}=I(),{userList:l}=V(I()),t=r(!1),n=r(""),u=0,c=1,m=2,s=r(0),i=r(0),d=r(0),B=r(0),U=[{id:u,icon:["fal","user"],selectedBackground:"#0376F2",background:"rgba(3, 118, 242, 0.1)",selectedColor:"#FFFFFF",color:"#0376F2",title:"Total",label:i},{id:c,icon:["fal","user"],selectedBackground:"#1ABC9C",background:"rgba(26, 188, 156, 0.1)",selectedColor:"#FFFFFF",color:"#1ABC9C",title:"Active",label:d},{id:m,icon:["fal","user"],selectedBackground:"#6E7C8F",background:"rgba(110, 124, 143, 0.1)",selectedColor:"#FFFFFF",color:"#6E7C8F",title:"Inactive",label:B}],E="userListGrid",z=["id"],p=r(new L({...Y.gridStoreConfig}));function G(){ee(p.value.data,z,n.value,p.value)}function D(e){switch(s.value){case u:return!0;case c:return e.isActive===!0;case m:return e.isActive===!1;default:return!0}}k(n,()=>{G()}),k(s,()=>{p.value.filter({filterBy:D})});const R=r({columns:[{flex:1,text:"Name",id:"name",field:"name",groupable:!1,sortable:(e,a)=>_(e.lastFirstName,a.lastFirstName),cellCls:"ps-3",cls:"ps-3"},{flex:1,text:"Email Address",id:"emailAddress",field:"emailAddress",groupable:!1,sortable:(e,a)=>_(e.emailAddress,a.emailAddress)},{flex:1,text:"Permission Group",id:"permissionGroup",field:"permissionGroup",groupable:!1,sortable:(e,a)=>_(e.permissionGroup,a.permissionGroup)},{flex:1,text:"Status",id:"status",field:"status",htmlEncode:!1,groupable:!1,sortable:(e,a)=>_(e.status,a.status),renderer:({record:e})=>`<span class="rounded-pill badge status-${e.status.toLowerCase()}"> ${e.status} </span>`}],sortFeature:{prioritizeColumns:!0}});async function j(){p.value.data=l.value,p.value.sort({field:"name",ascending:!0});const e=localStorage.getItem(`${E}State`);e&&(p.value.state=JSON.parse(e))}function O(){i.value=l.value.length,d.value=l.value.filter(e=>e.isActive).length,B.value=l.value.filter(e=>!e.isActive).length}return x(async()=>{t.value=!1,await g(),j(),O(),n.value!==""&&G(),t.value=!0}),(e,a)=>{const H=b("fs-overlay");return h(),S(K,null,[o(H,{show:!t.value,"spinner-variant":"primary",class:"fsi-pg__overlay","no-wrap":""},null,8,["show"]),o(Z,{title:"users","show-footer-search":!0,"show-title-header":!1,onSearchTextInput:a[1]||(a[1]=C=>n.value=C)},{footer:f(()=>[o(te,{"status-items":U,modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=C=>s.value=C)},null,8,["modelValue"])]),_:1}),F("div",oe,[F("div",le,[M(o(v(T),P({readOnly:!0},R.value,{store:p.value}),null,16,["store"]),[[J,v(l).length>0]]),v(l).length===0?(h(),$(se,{key:0,emptyMessage:"There are no users for this client.",icon:"users"})):q("",!0)])])],64)}}}),ne={class:"hq-pg"},xe=y({__name:"usersAndPermissions",setup(w){const g=N(),l=Q();let t=r(0);function n(u){g.push({name:"permissionGroupForm"})}return x(()=>{l.hash.toLocaleLowerCase()==="#pg"&&(t.value=1)}),(u,c)=>{const m=b("fs-button"),s=b("fs-tab"),i=b("fs-tabs");return h(),S("div",ne,[o(i,{modelValue:v(t),"onUpdate:modelValue":c[0]||(c[0]=d=>X(t)?t.value=d:t=d),pills:"","active-nav-item-class":"bg-index-color-1 hq-pg__tab--active","nav-wrapper-class":"hq-pg__header hq-pg__header--sticky justify-content-center contain","content-class":"flex-fill mb-4"},{"tabs-end":f(()=>[v(t)==1?(h(),$(m,{key:0,variant:"primary",class:"ms-auto",onClick:n},{default:f(()=>[W(" Create Permission Group ")]),_:1})):q("",!0)]),default:f(()=>[o(s,{title:"Users",active:"","title-item-class":"mx-1","title-link-class":"hq-pg__tab"},{default:f(()=>[o(ie)]),_:1}),o(s,{title:"Permission Groups","title-item-class":"mx-1","title-link-class":"hq-pg__tab"},{default:f(()=>[o(re)]),_:1})]),_:1},8,["modelValue"])])}}});export{xe as default};
