import{S as pe}from"./grid.module.3b00878a.js";import{B as fe}from"./BryntumGrid.2c4be387.js";import{B as ge}from"./bryntumSearchBar.3bdd630f.js";import{E as b}from"./EmployeeType.3dd8cf38.js";import{d as X,l as ve,Z as ye,$ as be,a0 as Se,i as W,s as U,j as a,b as _e,a1 as w,e as he,r as S,o as f,c as _,g as s,w as d,D as Ce,a2 as ke,A as Ie,u as g,a as Y,f as q,a3 as we,M as Fe,F as Be,E as o,_ as xe,y as Ee}from"./index.611fe570.js";import{f as K}from"./gridConfigDefaults.8c72c19b.js";import{g as Te,a as Le}from"./statefulSortFeature.3df4a43a.js";import{u as Z}from"./EmployeePendingApprovalStore.dd669e09.js";import{_ as $e}from"./iconsToolbarWidget.vue_vue_type_script_setup_true_lang.c4241c47.js";import{_ as Ne}from"./emptyGridLayout.vue_vue_type_script_setup_true_lang.16e4a64a.js";import"./foundationCompanyCasConnectionStore.b3301598.js";import"./debounce.cf77a06e.js";import"./isObject.c4ad145e.js";const Oe={key:0,class:"approvals-count"},Ae={key:0},Ve={key:1},He={class:"list__table"},Pe=X({__name:"employeeList",props:{modelValue:{default:null}},setup(ee,{emit:h}){ve.add(ye,be);const{responsive:C}=Se(),{fetchEmployeeList:u}=W(),{fetchPendingApprovalList:k}=Z(),{employeeList:i}=U(W()),{pendingApprovalList:v}=U(Z()),l="employeeListGrid",F={field:"fullName",ascending:!0},B=a(null),x=_e(()=>B.value?.instance.value.features),te=a({...K.gridConfig,...Te(l),...Le(l,F),minHeight:"100%",emptyText:"",columns:[{flex:2,text:"Name",id:"fullName",field:"fullName",groupable:!1,sortable:!0,htmlEncode:!1,renderer:({record:e})=>`${ae(e.employeeType)}&nbsp;${e.fullName}`},{flex:2,text:"Job Title",id:"jobTitle",field:"jobTitle",sortable:!0,groupable:!1},{flex:2,id:"employmentStatus",text:"Employment Status",field:"employmentStatus",sortable:!0,groupable:!1},{vue:!0,flex:2,text:"Employee Status",id:"employeeStatus",field:"employeeStatusName",sortable:!0,groupable:!1,renderer({record:e}){return{is:"employee-status-badge",statusId:e.data.employeeStatusId,statusContent:e.data.employeeStatusName}}},{flex:1,text:"Synced With Foundation",id:"synced",field:"isFoundationSynced",groupable:!1,sortable:!0,htmlEncode:!1,renderer:({record:e})=>e.isFoundationSynced?'<i class="b-fa b-icon-check" style="color: rgba(3,169,244,1); min-width: 32px"></i>':""}]}),ae=e=>{switch(e){case b.Employee:return'<i class="b-fa b-icon-user" style="color: rgba(26,188,156,1)"></i>';case b.Contractor:return'<i class="b-fa b-fa-user-hard-hat" style="color: rgba(196,61,151,1)"></i>';case b.Onboarding:return'<i class="b-fa b-fa-user-plus text-warning" style="color: rgba(247,159,31,1)"></i>'}},r=a(new pe({...K.gridStoreConfig,sorters:[F],onFilter:()=>{m.value&&r.value.filters.count<E.value&&T(),E.value=r.value.filters.count}}));async function oe(){r.value.data=n.value;const e=localStorage.getItem(`${l}State`);e&&(r.value.state=JSON.parse(e))}const E=a(0),n=a(new Array);function T(){r.value.data=n.value.filter(e=>e.fullName?.toLowerCase().includes(m.value.toLowerCase()))}function L(){n.value=i.value.filter(re).filter(e=>e.fullName?.toLowerCase().includes(m.value.toLowerCase())),r.value.data=n.value}const m=a(localStorage.getItem(`${l}SearchText`)??"");w(m,()=>{L()});const $=a(0),N=a(0),O=a(0),A=a(0),V=a(0),I=a(0);function le(){$.value=n.value.filter(e=>e.employeeStatusId==o.Active).length,N.value=n.value.filter(e=>e.employeeType==b.Employee).length,O.value=n.value.filter(e=>e.employeeStatusId==o.OnLeave).length,A.value=n.value.filter(e=>e.employeeStatusId==o.Onboard||e.employeeStatusId==o.QuickHire).length,V.value=n.value.filter(e=>e.employeeStatusId==o.Inactive).length}function re(e){switch(p.value){case M:return e.employeeStatusId==o.Active;case G:return e.employeeType==b.Employee;case D:return e.employeeStatusId==o.OnLeave;case Q:return e.employeeStatusId==o.Onboard||e.employeeStatusId==o.QuickHire;case j:return e.employeeStatusId==o.Inactive;default:return!0}}const p=a(-1),H=a(-1);w(p,()=>{L()});const P=-1,G=1,M=2,Q=3,D=4,j=5;function y(e,t){if(t===H.value){p.value=P;return}H.value=t}const se=[{id:G,icon:["fal","users"],selectedBackground:"rgba(3,169,244,1)",background:"rgba(3,169,244,.1)",selectedColor:"white",color:"rgba(3,169,244,1)",title:"All",label:N,onClickFunction:y},{id:M,icon:["fal","user"],selectedBackground:"rgba(26,188,156,1)",background:"rgba(26,188,156,.1)",selectedColor:"white",color:"rgba(26,188,156,1)",title:"Active",label:$,onClickFunction:y},{id:Q,icon:["fal","fa-user-plus"],selectedBackground:"rgba(255,80,148,1)",background:"rgba(255,80,148,.1)",selectedColor:"white",color:"rgba(255,80,148,1)",title:"New Hire",label:A,onClickFunction:y},{id:D,icon:["fal","user-hard-hat"],selectedBackground:"rgba(3,155,177,1)",background:"rgba(3,155,177,.1)",selectedColor:"white",color:"rgba(3,155,177,1)",title:"On Leave",label:O,onClickFunction:y},{id:j,icon:["fal","user"],selectedBackground:"rgba(110,124,143,1)",background:"rgba(110,124,143,.1)",selectedColor:"white",color:"rgba(110,124,143,1)",title:"Inactive",label:V,onClickFunction:y}];function ne(){localStorage.setItem(`${l}State`,JSON.stringify(r.value.state)),localStorage.setItem(`${l}SearchText`,m.value)}function ie(){r.value.clearFilters(),r.value.clearSorters(),localStorage.removeItem(`${l}State`),localStorage.removeItem(`${l}SearchText`),window.location.reload()}function ue(){r.value.clearFilters(),x.value.filterBar.hideFilterBar()}function De(){}const ce=e=>{h("update:modelValue",e.record.data)};return he(async()=>{await Promise.all([u(),k()]),n.value=i.value,I.value=v.value.length,oe(),le(),m.value!==""&&T(),+localStorage.getItem("employeeType")?(p.value=+localStorage.getItem("employeeType"),localStorage.removeItem("employeeType")):p.value=P}),(e,t)=>{const z=S("font-awesome-icon"),J=S("fs-button"),de=S("fs-link"),me=S("fs-popper"),R=S("granular-security");return f(),_(Be,null,[s(ge,{title:"Employees","local-storage-key":l,"show-settings-button":!0,"show-search-button":!1,"show-filter-button":!0,"show-refresh-button":!0,"show-footer-search":!0,onSaveSettings:t[1]||(t[1]=c=>ne()),onClearSettings:t[2]||(t[2]=c=>ie()),onHideFilterBar:t[3]||(t[3]=c=>ue()),onShowFilterBar:t[4]||(t[4]=c=>g(x).filterBar.showFilterBar()),onSearchTextInput:t[5]||(t[5]=c=>m.value=c),onRefreshGrid:t[6]||(t[6]=c=>void 0)},{buttons:d(()=>[s(R,{hasPermission:"WHQ_247_3113"},{default:d(()=>[s(me,{tooltip:"",hover:"",content:"Approvals",placement:"bottom",class:"me-2"},{default:d(()=>[s(de,{to:{name:"reviews"}},{default:d(()=>[s(J,{variant:"outline-primary",type:"button",class:"px-2 btn--h-40 position-relative"},{default:d(()=>[s(z,{icon:["fal","stamp"],size:"lg"}),I.value>0?(f(),_("span",Oe,Ce(I.value),1)):ke("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),s(R,{hasPermission:"WHQ_247_3114"},{default:d(()=>[s(J,{variant:"btn-primary",class:Ie("btn btn-primary "+(g(C).mobile?"p-2":"")),to:{name:"createEmployee"}},{default:d(()=>[g(C).mobile?(f(),_("span",Ae,[s(z,{icon:["fas","plus"],size:"lg"})])):(f(),_("span",Ve,"Create Employee"))]),_:1},8,["class"])]),_:1})]),footer:d(()=>[s($e,{"status-items":se,modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=c=>p.value=c)},null,8,["modelValue"])]),_:1}),Y("div",He,[g(i)?.length>0?(f(),q(g(fe),we({key:0},te.value,{store:r.value,ref_key:"grid",ref:B,onCellClick:ce}),null,16,["store"])):(f(),q(Ne,{key:1,emptyMessage:g(Fe).COMMON.NO_DATA},null,8,["emptyMessage"]))])],64)}}});const Ge=xe(Pe,[["__scopeId","data-v-8b0ce777"]]),Me={class:"hq-pg list"},Qe={class:"list__table"},at=X({__name:"employees",setup(ee){const h=Ee(),C=a(null),u=a(null),k=i=>i===o.Onboard||i===o.QuickHire||i===o.PendingOnboard||i===o.PendingQuickhire;return w(u,()=>{k(u.value.employeeStatusId)?h.push({name:"onboardingDetail",params:{id:u.value.id}}):h.push({name:"employeeInformation",params:{id:u.value.id}})}),(i,v)=>(f(),_("div",Me,[Y("div",Qe,[s(Ge,{ref_key:"employeeTable",ref:C,modelValue:u.value,"onUpdate:modelValue":v[0]||(v[0]=l=>u.value=l)},null,8,["modelValue"])])]))}});export{at as default};
