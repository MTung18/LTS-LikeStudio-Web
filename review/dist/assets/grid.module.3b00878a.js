/*!
 *
 * Bryntum Grid 5.3.0
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */const kc="grid";function xl(u,e){var t=Object.keys(u);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(u);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(u,r).enumerable})),t.push.apply(t,i)}return t}function F(u){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xl(Object(t),!0).forEach(function(i){T(u,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(t)):xl(Object(t)).forEach(function(i){Object.defineProperty(u,i,Object.getOwnPropertyDescriptor(t,i))})}return u}function T(u,e,t){return e=Pc(e),e in u?Object.defineProperty(u,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):u[e]=t,u}function Lc(u,e){if(typeof u!="object"||u===null)return u;var t=u[Symbol.toPrimitive];if(t!==void 0){var i=t.call(u,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(u)}function Pc(u){var e=Lc(u,"string");return typeof e=="symbol"?e:String(e)}class W{static cacheFlags(e=navigator.platform,t=navigator.userAgent){const i=this;i._isLinux=Boolean(e.match(/Linux/)),i._isMac=Boolean(e.match(/Mac/)),i._isWindows=Boolean(e.match(/Win32/)),i._isWebkit=Boolean(t.match(/WebKit/)&&!t.match(/Edg/)),i._firefoxVersion=i.getVersion(t,/Firefox\/(\d+)\./),i._isFirefox=i._firefoxVersion>0,i._chromeVersion=i.getVersion(t,/Chrom(?:e|ium)\/(\d+)\./),i._isChrome=i._chromeVersion>0,i._isSafari=Boolean(t.match(/Safari/))&&!i._isChrome,i._isMobileSafari=Boolean(t.match(/Mobile.*Safari/)),i._safariVersion=i.getVersion(t,/Version\/(.*).Safari/),i._isAndroid=Boolean(t.match(/Android/g))}static get supportsOverflowClip(){if(this._supportsOverflowClip==null){const e=document.createElement("div");e.style.overflow="clip",e.style.display="none",document.documentElement.appendChild(e),this._supportsOverflowClip=e.ownerDocument.defaultView.getComputedStyle(e).getPropertyValue("overflow")==="clip",e.remove()}return this._supportsOverflowClip}static get supportsSticky(){return!0}static getVersion(e,t){const i=e.match(t);return i?parseFloat(i[1]):0}static get isTouchDevice(){return this._isTouchDevice===void 0&&(this._isTouchDevice=globalThis.matchMedia("(pointer:coarse)").matches),this._isTouchDevice}static get isHoverableDevice(){return this._isHoverableDevice===void 0&&(this._isHoverableDevice=globalThis.matchMedia("(any-hover: hover)").matches),this._isHoverableDevice}static get isBrowserEnv(){return typeof window<"u"}static get isMac(){return this._isMac}static get isWindows(){return this._isWindows}static get isLinux(){return this._isLinux}static get isAndroid(){return this._isAndroid}static get isWebkit(){return this._isWebkit}static get isChrome(){return this._isChrome}static get chromeVersion(){return this._chromeVersion}static get isFirefox(){return this._isFirefox}static get firefoxVersion(){return this._firefoxVersion}static get isSafari(){return this._isSafari}static get safariVersion(){return this._safariVersion}static get isMobileSafari(){return this._isMobileSafari}static get platform(){const e=this;return e._isLinux?"linux":e._isMac?"mac":e._isWindows?"windows":e._isAndroid?"android":e._isMobileSafari?"ios":null}static get supportsPassive(){return!0}static get supportsRandomUUID(){if(this._supportsRandomUUID===void 0)try{this._supportsRandomUUID=Boolean(globalThis.crypto.randomUUID().length>0)}catch{this._supportsRandomUUID=!1}return this._supportsRandomUUID}static get storageAvailable(){let e,t;try{return e=localStorage,t="__storage_test__",e.setItem(t,t),e.removeItem(t),!0}catch(i){return i instanceof DOMException&&(i.code===22||i.code===1014||i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e.length!==0}}static setLocalStorageItem(e,t){this.storageAvailable&&localStorage.setItem(e,t)}static getLocalStorageItem(e){return this.storageAvailable&&localStorage.getItem(e)}static removeLocalStorageItem(e){this.storageAvailable&&localStorage.removeItem(e)}static searchParam(e,t=null,i=document.location.search){const r=new RegExp(`[?&]${e}=?([^&]*)`),n=i.match(r);return n&&n[1]||t}static getCookie(e){const t=encodeURIComponent(e)+"=",i=document.cookie.split(";");for(let r=0;r<i.length;r++){let n=i[r];for(;n.charAt(0)===" ";)n=n.substring(1,n.length);if(n.indexOf(t)===0)return decodeURIComponent(n.substring(t.length,n.length))}return""}static download(e,t){const i=document.createElement("a");i.download=e,i.href=t||e,i.style.cssText="display:none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}static downloadBlob(e,t){const i=globalThis.URL.createObjectURL(e);this.download(t,i),globalThis.URL.revokeObjectURL(i)}static get queryString(){var e;const t=new URL(globalThis.location.href).searchParams;return(e=Object.fromEntries)===null||e===void 0?void 0:e.call(Object,t.entries())}static copyToClipboard(e){let t=!0;const i=document.createElement("textarea");i.value=e,i.style.height=i.style.width=0,document.body.appendChild(i),i.select();try{document.execCommand("copy")}catch{t=!1}return i.remove(),t}static isBryntumOnline(e){var t;return e=Array.isArray(e)?e:[e],Boolean(/^(www\.)?bryntum\.com/.test(globalThis.location.host)||((t=e)===null||t===void 0?void 0:t.some(i=>this.queryString[i]!=null)))}static get isCSP(){const{bryntum:e,document:t}=globalThis;return e.CSP==null&&(e.CSP=Boolean(t.querySelector('meta[http-equiv="Content-Security-Policy"]'))),e.CSP}static async setupClipboard(){return window.bryntum.clipboard||(window.bryntum.clipboard={hasNativeAccess:!0,async writeText(e,t){if(t&&this.hasNativeAccess)try{await navigator.clipboard.writeText(e)}catch{this.hasNativeAccess=!1}this._content=e},async readText(e){if(e&&this.hasNativeAccess)try{return await navigator.clipboard.readText()}catch{this.hasNativeAccess=!1}return this._content}}),window.bryntum.clipboard}static async writeToClipboard(e,t=!0){return await(await this.setupClipboard()).writeText(e,t)}static async readFromClipboard(e=!0){return await(await this.setupClipboard()).readText(e)}}T(W,"supportsPointerEvents",Boolean(globalThis.PointerEvent||globalThis.MSPointerEvent));T(W,"supportsPointerEventConstructor",typeof PointerEvent<"u");W.isBrowserEnv&&W.cacheFlags();W._$name="BrowserHelper";let Ya,qa,Sl,El;const Tl=/([a-z])([A-Z])/g,Oc=/[\n\r]/g,Ac=/[.*+?^${}()|[\]\\]/g,$c=/[&<]/,_c=/(^[^a-z]+[^\w]+)/gi,Hc=/\s+/,Nc=/^[^a-z]+|[^\w:.-]+/gi,Bc=(u,e)=>qa[e.toLowerCase()]||String.fromCharCode(parseInt(e.substr(2),10)),Vc=(u,e)=>Ya[e],zc=(u,e,t)=>`${e}-${t.toLowerCase()}`,Wc=(u,e,t)=>`${e} ${t.toLowerCase()}`,jc=u=>u?`_x${[...u].map(e=>e.charCodeAt(0).toString(16)).join("")}`:"__blank__",Rl={},Dl={};class _{static capitalize(e){return e&&e[0].toUpperCase()+e.substr(1)}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substr(1)}static hyphenate(e){const t=Rl[e];return t||(Rl[e]=e.replace(Tl,zc))}static separate(e){const t=Dl[e];return t||(Dl[e]=this.capitalize(e.replace(Tl,Wc)))}static createId(e){return String(e).replace(_c,jc)}static makeValidDomId(e,t=""){return e==null?null:String(e).replace(Nc,t)}static escapeRegExp(e,t){let i=e.replace(Ac,"\\$&");return t!==void 0&&(i=new RegExp(i,t)),i}static decodeHtml(e){return e&&String(e).replace(El,Bc)}static encodeHtml(e=""){return e&&String(e).replace(Sl,Vc)}static encodeHtmlBR(e){var t;return(t=_.encodeHtml(e))===null||t===void 0?void 0:t.replace(Oc,"<br>")}static isHtml(e){return typeof e=="string"&&$c.test(e||"")}static initHtmlEntities(e){e=e||{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};const t=Object.keys(e);Ya=e,qa=t.reduce((i,r)=>(i[e[r]]=r,i),{}),Sl=new RegExp(`([${t.map(i=>"[-]".includes(i)?"\\"+i:i).join("")}])`,"g"),El=new RegExp(`(${Object.values(e).join("|")}|&#[0-9]+;)`,"ig")}static safeJsonParse(e){let t=null;try{t=JSON.parse(e)}catch{}return t}static safeJsonStringify(e,t=null,i=null){let r=null;try{r=JSON.stringify(e,t,i)}catch{}return r}static joinPaths(e,t="/"){return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}static split(e,t=Hc){let i=e;return typeof i=="string"&&(i=e.trim(),i=i?i.split(t):[]),i}static xss(e,...t){const i=[];let r=t.length;for(i[r]=e[r];r-- >0;)i[r]=e[r]+_.encodeHtml(t[r]);return i.join("")}static xssBR(e,...t){const i=[];let r=t.length;for(i[r]=e[r];r-- >0;)i[r]=e[r]+_.encodeHtmlBR(t[r]);return i.join("")}static toJavaScriptValue(e,t){const i=N.typeOf(e);if(i==="boolean"||i==="string"||i==="number"||e===null)return _.safeJsonStringify(e);if(e===globalThis)return"window";if(i==="date")return`new Date(${e.getFullYear()}, ${e.getMonth()}, ${e.getDate()}, ${e.getHours()}, ${e.getMinutes()}, ${e.getSeconds()}, ${e.getMilliseconds()})`;if(i==="array")return`[${e.map(r=>_.toJavaScriptValue(r,t))}]`;if(i==="object"||i==="instance")return this.toJavaScriptString(e,t);if(i==="function"){let r=e.toString();return r.match(/^async (\w+?)\(/)?r=r.replace(/^async (\w+?)\(/,"async function("):!r.startsWith("async(")&&r.match(/^(\w+?)\(/)&&(r=r.replace(/^(\w+?)\(/,"function(")),r}if(i==="class")return e.toJavaScriptValue?e.toJavaScriptValue(t):Object.prototype.hasOwnProperty.call(e,"$name")?e.$name:e.name}static toJavaScriptString(e,t={}){var i;const r=(i=t.level)!==null&&i!==void 0?i:0,n=2;return`{
`+Object.keys(e).map(s=>" ".repeat((r+1)*n)+(s.match(/[- *]/)?`"${s}"`:s)+`: ${_.toJavaScriptValue(e[s],F(F({},t),{},{level:r+1}))}`).join(`,
`)+`
`+" ".repeat(r*n)+"}"}static encodeAttributeSelector(e,t){return`[${e}="${String(t).replace(/["\\]/g,"\\$&")}"]`}static generateUUID(){var e;return W.supportsRandomUUID?globalThis.crypto.randomUUID():(e=globalThis.crypto)!==null&&e!==void 0&&e.getRandomValues?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^globalThis.crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)):`${Date.now()}-${++_.fakeNodeUUIDIndex}`}}T(_,"fakeNodeUUIDIndex",0);_.initHtmlEntities();_._$name="StringHelper";const{hasOwnProperty:Gc,toString:Uc}=Object.prototype,{isFrozen:Ml}=Object,Yc=/\s*<\s*/,qc=/\s*>\s*/,Il={},Fl={},kl=Object.freeze({});class N{static assign(e,...t){for(let i,r,n=0;n<t.length;n++)if(i=t[n],i)for(r in i)e[r]=i[r];return e}static assignIf(e,...t){for(let i,r,n=0;n<t.length;n++)if(i=t[n],i)for(r in i)(!(r in e)||e[r]===void 0)&&(e[r]=i[r]);return e}static blend(e,t,i){i=i||Il,e=e||{};const{clone:r=N.clone,merge:n=N.blend}=i;if(Array.isArray(t)){if(t.length>1)return t.forEach(s=>{e=N.blend(e,s,i)}),e;t=t[0]}if(t){let s,l,o;for(l in t)o=t[l],o&&N.isObject(o)&&(s=e[l],i.key=l,s&&N.isObject(s)?(Ml(s)&&(e[l]=s=r(s,i)),o=n(s,o,i)):o=Ml(o)?o:r(o,i)),e[l]=o}return e}static clone(e,t){let i=e,r;if(e&&typeof e=="object")if(t&&typeof t=="object"&&t&&(t=null),N.isObject(e))if(e.skipClone)i=e;else{i={};for(r in e)i[r]=N.clone(e[r])}else if(Array.isArray(e))for(i=[],r=e.length;r-- >0;)i[r]=N.clone(e[r]);else N.isDate(e)?i=new Date(e.getTime()):t&&(i=t(e));return i}static createTruthyKeys(e){const t=_.split(e),i=t&&{};if(t)for(const r of t)r&&(i[r]=!0);return i}static getPath(e,t){return t.split(".").reduce((i,r)=>(i||kl)[r],e)}static getPathDefault(e,t,i){const r=Array.isArray(t)?t:typeof t=="string"?t.split("."):[t],n=r.length-1;return r.reduce((s,l,o)=>(i&&!(l in s)&&(s[l]=o===n?i:{}),(s||kl)[l]),e)}static hasPath(e,t){return t.split(".").every(i=>i in e?(e=e[i],!0):!1)}static getTruthyKeys(e){const t=[];for(const i in e)e[i]&&t.push(i);return t}static getTruthyValues(e){const t=[];for(const i in e)e[i]&&t.push(e[i]);return t}static isClass(e){var t;return typeof e=="function"&&((t=e.prototype)===null||t===void 0?void 0:t.constructor)===e}static isDate(e){return Boolean(e?.getUTCDate)&&N.typeOf(e)==="date"}static isPromise(e){if(Promise&&Promise.resolve)return Promise.resolve(e)===e||typeof e?.then=="function";throw new Error("Promise not supported in your environment")}static isEmpty(e){if(e&&typeof e=="object")for(const t in e)return!1;return!0}static isObject(e){const t=e?.constructor;return Boolean(t?t===Object||t.getPrototypeOf&&t.prototype&&!Object.getPrototypeOf(t.prototype):e&&typeof e=="object")}static isInstantiated(e){return e?typeof e=="object"&&!N.isObject(e):!1}static merge(e,...t){return N.blend(e,t)}static mergeItems(e,t,i){i=i||Il;let r,n,s,l,o,a,d;const{merge:c=N.blend}=i;if(e=e||{},Array.isArray(t))t.forEach(g=>{e=N.mergeItems(e,g,i)});else if(t)for(o in t)if(d=t[o],r=null,o.includes(">")?([o,r]=o.split(qc),n=0):o.includes("<")&&([r,o]=o.split(Yc),n=1),o in e)d&&e[o]&&c&&(i.key=o,d=c(e[o],d,i)),e[o]=d;else if(r){if(!l){l=new Map,s=0;for(const g in e)l.set(g,s++)}if(s=l.get(r),e[o]=d,s==null&&n)s=l.size;else{a=a||[],s=(s||0)+n;for(const g of l){const[f,m]=g;s<=m&&(a&&(a[l.size-m-1]=f),l.set(f,m+1))}if(a)for(;a.length;){const g=a.pop(),f=e[g];delete e[g],e[g]=f}}l.set(o,s)}else{var h;e[o]=d,(h=l)===null||h===void 0||h.set(o,l.size)}return e}static setPath(e,t,i){return t.split(".").reduce((r,n,s,l)=>s===l.length-1?r[n]=i:(r[n]instanceof Object||(r[n]={}),r[n]),e),e}static typeOf(e){let t,i;return e===null?i="null":e!==e?i="nan":(i=typeof e,i==="object"?e.isBase?i="instance":Array.isArray(e)?i="array":(i=Fl[t=Uc.call(e)])||(Fl[t]=i=t.slice(8,-1).toLowerCase()):i==="function"&&e.isBase&&(i="class")),i}}Object.defineProperty(N,"hasOwn",{value:Object.hasOwn||((u,e)=>Gc.call(u,e))});N._$name="Objects";class re{static setVersion(e,t){e=e.toLowerCase(),qe[e]={version:t,isNewerThan(n){return re.semanticCompareVersion(n,t,"<")},isOlderThan(n){return re.semanticCompareVersion(n,t,">")}};let i="";i=kc;const r=`${i}.${e}${t.replace(/\./g,"-")}`;if(W.isBrowserEnv&&!globalThis.bryntum.silenceBundleException)if(globalThis.bryntum[r]===!0)if(this.isTestEnv)globalThis.BUNDLE_EXCEPTION=!0;else{let n=i||e;n==="core"&&(n="grid");let s=_.capitalize(n);throw n==="schedulerpro"&&(s="SchedulerPro"),new Error(`The Bryntum ${s} bundle was loaded multiple times by the application.

Common reasons you are getting this error includes:

* Imports point to different types of the bundle (e.g. *.module.js and *.umd.js)
* Imports point to both sources and bundle
* Imports do not use the shortest relative path, JS treats them as different files
* Cache busters differ between imports, JS treats ${n}.module.js?1 and ${n}.module.js?2 as different files
* Imports missing file type, verify they all end in .js

See https://bryntum.com/products/${n}/docs/guide/${s}/gettingstarted/es6bundle#troubleshooting for more information

`)}else globalThis.bryntum[r]=!0}static getVersion(e){if(e=e.toLowerCase(),!qe[e])throw new Error("No version specified! Please check that you import VersionHelper correctly into the class from where you call `deprecate` function.");return qe[e].version}static semanticCompareVersion(e,t,i="="){e=e||"",t=t||"";const r=e.split(/[-.]/),n=t.split(/[-.]/),s=i.includes("<"),l=(a,d)=>{const c=["rc","beta","alpha"],h=a.map(g=>{if(c.includes(g))return-c.indexOf(g)-2;const f=Number.parseInt(g);return Number.isNaN(f)?-c.length:f});for(;h.length<d;)h.push(-1);return h},o=()=>{const a=Math.max(r.length,n.length),d=l(r,a),c=l(n,a);for(let h=0;h<a;h++)if(d[h]!==c[h])return s?d[h]<c[h]:d[h]>c[h];return!0};switch(i){case"=":return e===t;case"<=":case">=":return e===t||o();case"<":case">":return e!==t&&o()}return!1}static checkVersion(e,t,i){return re.semanticCompareVersion(qe.getVersion(e),t,i)}static deprecate(e,t,i){if(qe.checkVersion(e,t,"<"))console.warn(`Deprecation warning: You are using a deprecated API which will change in v${t}. ${i}`);else throw new Error(`Deprecated API use. ${i}`)}static get isTestEnv(){var e;const t=Boolean((e=globalThis.bryntum)===null||e===void 0?void 0:e.isTestEnv);try{var i,r;return t||Boolean((i=globalThis.parent)===null||i===void 0||(r=i.bryntum)===null||r===void 0?void 0:r.isTestEnv)}catch{return t}}static get isDebug(){return!1}}const qe=re;W.isBrowserEnv&&(qe.isTestEnv&&(W._isHoverableDevice=!0),globalThis.bryntum=Object.assign(globalThis.bryntum||{},{getVersion:qe.getVersion.bind(qe),checkVersion:qe.checkVersion.bind(qe),deprecate:qe.deprecate.bind(qe),license:"3bdf5168-3655-11eb-b269-d094663d5c88"}));re._$name="VersionHelper";const{defineProperty:yr,getOwnPropertyDescriptor:Ll}=Reflect,{hasOwnProperty:Pl,toString:Ts}=Object.prototype,Rs=Symbol("instanceProperties"),Ka=Symbol("configuring"),ni=Symbol("lazyConfigValues"),Ol=Ts.call(new Date),Kc=/\s+/,Xc=(u,e)=>(u[e]=1,u);class de{static get(e,t){const{cache:i}=this,r=i[e]||(i[e]=new de(e));let n=r,s;return t&&(s=de.makeCacheKey(e,t),(n=s&&i[s])||(n=r.extend(t),s&&(i[s]=n))),n}constructor(e){const t=this,i=e[0].toUpperCase()+e.substr(1);t.base=t,t.name=e,t.field="_"+e,t.capName=i,t.changer="change"+i,t.initializing="initializing"+i,t.updater="update"+i}get descriptor(){let e=this._descriptor;return(!e||!Pl.call(this,"_descriptor"))&&(this._descriptor=e=this.makeDescriptor()),e}get initDescriptor(){let e=this._initDescriptor;return(!e||!Pl.call(this,"_initDescriptor"))&&(this._initDescriptor=e=this.makeInitter()),e}equal(e,t){return e===t}extend(e){const t=Object.assign(Object.create(this),e),{equal:i,merge:r}=e,{equalityMethods:n}=de;return typeof i=="string"&&(i.endsWith("[]")?t.equal=de.makeArrayEquals(n[i.substr(0,i.length-2)]):t.equal=n[i]),typeof r=="string"&&(t.merge=de.mergeMethods[r]),t}define(e){const t=Ll(e,this.name);let i=this.descriptor;t&&t.get&&(i=Object.assign({},i),i.get=t.get),yr(e,this.name,i)}defineInitter(e,t){const{name:i}=this,r=e[Rs];let n,s;!r[i]&&(s=Ll(e,i))&&!("value"in s)&&(r[i]=s),yr(e,i,this.initDescriptor),this.lazy&&(n=e[ni]||(e[ni]=new Map),n.set(i,t))}static makeArrayEquals(e){return(t,i)=>{let r,n=t&&i&&t.length===(r=i.length);if(n&&Array.isArray(t)&&Array.isArray(i))if(e)for(;n&&r-- >0;)n=e(t[r],i[r]);else for(;n&&r-- >0;)n=t[r]===i[r];else n=e?e(t,i):t===i;return n}}static makeCacheKey(e,t){const i=Object.keys(t).sort();for(let r,n,s,l=i.length;l-- >0;)if(s=t[r=i[l]],s==null&&s===!1)i.splice(l,1);else{if(n=typeof s,n==="function")return null;n==="string"?i[l]=`${r}:"${s}"`:n==="number"&&(i[l]=`${r}:${s}`)}return i.length?`${e}>${i.join("|")}`:e}makeDescriptor(){const e=this,{base:t,field:i,changer:r,updater:n,name:s}=e;return t!==e&&t.equal===e.equal?t.descriptor:{get(){var l;return(l=this.configObserver)===null||l===void 0||l.get(s,this),this[i]},set(l){const o=this;let a=o[i],d,c;if(typeof l=="string"){let f=l;if(l.startsWith("up.")){var h;f=(h=o.owner)===null||h===void 0?void 0:h.resolveProperty(l.substr(3))}else l.startsWith("this.")&&(f=o.resolveProperty(l.substr(5)));f!==void 0&&typeof f!="function"&&(l=f)}if(o[r]&&(d=(c=o[r](l,a))===void 0,d||(l=c,a=o[i])),!d&&!(e.equal===Xa?a===l:e.equal(a,l))){var g;o[i]=l,d=!0,(g=o[n])===null||g===void 0||g.call(o,l,a)}d&&!o.onConfigChange.$nullFn&&o.onConfigChange({name:s,value:l,was:a,config:e})}}}makeInitter(){const e=this;return e!==e.base?e.lazy?e.makeLazyInitter():e.base.initDescriptor:e.makeBasicInitter()}makeBasicInitter(){const e=this,{initializing:t,name:i}=e;return{configurable:!0,get(){const r=this;return e.removeInitter(r),r[t]=!0,r[i]=r[Ka][i],r[t]=!1,r.configDone[i]=!0,r[i]},set(r){e.removeInitter(this),this.configDone[i]=!0,this[i]=r}}}makeLazyInitter(){const e=this,{initializing:t,name:i}=e;return{configurable:!0,get(){const r=this,n=r[ni].get(i);return e.removeInitter(r),r.isDestroying||(r[t]=!0,r[i]=n,r[t]=!1),r[i]},set(r){e.removeInitter(this),this[i]=r}}}removeInitter(e){const{name:t}=this,i=e[Rs][t],r=e[ni];i?yr(e,t,i):delete e[t],r!=null&&r.delete(t)&&!r.size&&delete e[ni]}setDefault(e,t){yr(e.prototype,this.field,{configurable:!0,writable:!0,value:t})}merge(e,t){if(t&&e&&N.isObject(e)){if(t.isBase)return t.setConfig(e);N.isObject(t)&&(e=N.merge(N.clone(t),e))}return e}}const{prototype:Gi}=de,{equal:Xa}=Gi;de.symbols={configuring:Ka,instanceProperties:Rs,lazyConfigs:ni};de.cache=Object.create(null);de.equalityMethods={array:de.makeArrayEquals(),date(u,e){return u===e?!0:u&&e&&Ts.call(u)===Ol&&Ts.call(e)===Ol?u.getTime()===e.getTime():!1},strict:de.equal=Xa};de.mergeMethods={distinct(u,e){let t=e?e.slice():[];if(u!=null)if(N.isObject(u))if(e===void 0)t=u;else{let i,r;for(i in u)r=t.indexOf(i),u[i]?r<0&&t.push(i):r>-1&&t.splice(r,1)}else Array.isArray(u)?u.forEach(i=>!t.includes(i)&&t.push(i)):t.includes(u)||t.push(u);return t},merge:de.merge=Gi.merge,classList(u,e){if(typeof u=="string"){if(!u.length)return e;u=u.split(Kc)}return Array.isArray(u)&&(u=u.reduce(Xc,{})),de.merge(u,e)},objects(u,e){return u===!0?e||{}:de.merge(u,e)},replace(u){return u},items(u,e,t,i){return i?N.mergeItems(e,u,{merge:(r,n)=>Gi.merge(n,r)}):Gi.merge(u,e)}};Object.assign(Gi,{_descriptor:null,_initDescriptor:null,lazy:!1,nullify:!1,render:!1});de._$name="Config";class Jc{constructor(e){e&&Object.assign(this,e)}getInherited(e,t=!0){let i=this[e];if(!(e in this)){var r;i=(r=this.super)===null||r===void 0?void 0:r.getInherited(e,t),(i||t)&&(this[e]=i=Object.create(i||null))}return i}}const{getPrototypeOf:Al}=Object,{hasOwn:Qe}=N,{defineProperty:$l}=Reflect,Br=Symbol("classMetaData"),_l=Symbol("mixinTag"),In=Symbol("originalConfig"),ct=de.symbols.configuring,Qc=de.symbols.instanceProperties,Mi=de.symbols.lazyConfigs,Zc={merge:"replace",simple:!0},qr=()=>{},Ja=u=>new Jc(u),Hl={},eu=Object.freeze({}),Nl=Object.freeze([]);class ${static get isBase(){return!0}get isBase(){return!0}static get declarable(){return["declarable","configurable","defaultConfig","properties","prototypeProperties"]}constructor(...e){const t=this,i=t.constructor;t.$meta.class!==i&&qr(i.$meta),t.construct(...e),t.afterConstruct(),t.isConstructing=!1}static new(...e){return e=e.filter(t=>t),new this(e.length>1?this.mergeConfigs(...e):e[0])}construct(...e){e[0]!==null&&this.configure(...e),this.afterConfigure()}static destroy(...e){const t=i=>{i!=null&&i.destroy?i.destroy():Array.isArray(i)&&i.forEach(t)};t(e)}destroy(){const e=this,{id:t}=e;e.isDestroying=!0,e.destroy=qr,e.doDestroy(),Object.setPrototypeOf(e,null);for(const i in e)i!=="destroy"&&i!=="isDestroying"&&delete e[i];delete e[In],e.isDestroyed=!0,e.id=t}_thisIsAUsedExpression(e){}static get $$name(){return Qe(this,"$name")&&this.$name||Qe(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}startConfigure(e){}finishConfigure(e){}afterConfigure(){}afterConstruct(){}callback(e,t,i=Nl){const{handler:r,thisObj:n}=this.resolveCallback(e,t==="this"?this:t)||eu;return r?.apply(n,i)}resolveProperty(e){let t=this;for(;t;){if(N.hasPath(t,e))return N.getPath(t,e);t=t.owner}}resolveCallback(e,t=this,i=!0){var r;if((r=e)!==null&&r!==void 0&&r.substring){if(e.endsWith("?")&&(i=!1,e=e.substring(0,e.length-1)),e.startsWith("up.")){for(e=e.substring(3),t=this.owner;t&&!t[e];t=t.owner);if(!t)return}else e.startsWith("this.")&&(e=e.substring(5),t=this);if(!t||!(t instanceof Object))return;e=t[e]}if(typeof e=="function")return{handler:e,thisObj:t};if(i)throw new Error(`No method named ${e} on ${t.$$name||"thisObj object"}`)}bindCallback(e,t=this){if(e){const{handler:i,thisObj:r}=this.resolveCallback(e,t);if(i)return i.bind(r)}}delay(e,t,i=e.name||e){return e=this.setTimeout?e:e.bind(this),(this.setTimeout?this:globalThis)[typeof t=="number"?"setTimeout":"requestAnimationFrame"](e,t,i)}doDestroy(){const e=this,{nullify:t}=e.$meta;if(t)for(let i=0;i<t.length;++i)e[t[i].field]!=null&&(e[t[i].name]=null)}destroyProperties(...e){const t=this;let i,r;for(i of e)if(i in t&&(!t[ct]||!t[ct][i])){var n;r=t[i],(n=r)!==null&&n!==void 0&&n.destroy&&r.destroy(),delete t[i]}}configure(e={}){const t=this,i=t.$meta,{beforeConfigure:r}=e,n=i.configs,s=t.getDefaultConfiguration();let l,o,a;t.initialConfig=e,t.isConfiguring=!0,Object.assign(t,t.getProperties());for(o in e)a=e[o],l=n[o],s[o]=l?l.merge(a,s[o],null,i):a;r&&(delete s.beforeConfigure,r(t,s)),t.setConfig(t[In]=s,!0),t.isConfiguring=!1}getConfig(e){return this[e]}setConfig(e,t){const i=this,r=i[ct],n=r?i.configDone:i.configDone={},s=i.$meta.configs;let l,o;i[Qc]={},i[ct]=r?Object.setPrototypeOf(Object.assign({},e),r):e;for(o in e)e[o]!=null||Qe(e,o)?(l=s[o]||de.get(o),l.defineInitter(i,e[o]),t||(n[o]=!1)):n[o]=!0;t&&i.startConfigure(e);for(o in e){var a;!n[o]&&!((a=s[o])!==null&&a!==void 0&&a.lazy)&&(i[o]=e[o])}return r?i[ct]=r:delete i[ct],t&&i.finishConfigure(e),i}hasConfig(e){var t;const i=this,r=i[ct];return Boolean(i["_"+e]!=null||((t=i[Mi])===null||t===void 0?void 0:t.get(e))!=null||!i.configDone[e]&&r&&(r[e]!=null||Qe(r,e)))}peekConfig(e){const t=this,i=t[Mi],r=t[ct];if(i!=null&&i.has(e))return i.get(e);if(t.configDone[e])return t[e];if(r?.[e]!=null||Qe(r,e))return r[e]}triggerConfig(e){const t=this,{configDone:i}=t,r=t[Mi],n=t[ct],s=r!=null&&r.has(e)||n&&(n[e]!=null||Qe(n,e))?!i[e]:null;return s&&t.getConfig(e),s}triggerConfigs(e){const t=this,i=t.$meta.configs,r=t[Mi],n=r?[...r.keys()].filter(s=>i[s].lazy===e):Nl;for(const s of n)t.triggerConfig(s);return n.length?n:null}onConfigChange(){}get config(){const e={},t=this[In];for(const i in t)e[i]=t[i];return e}static processConfigValue(e,t){if(e===globalThis)return globalThis;if(Array.isArray(e))return e.map(i=>$.processConfigValue(i,t));if(e instanceof $)return t.visited.has(e)?void 0:e.getCurrentConfig(t);if(e instanceof HTMLElement||e instanceof DocumentFragment)return null;if(N.isObject(e)){const i={};for(const r in e)i[r]=$.processConfigValue(e[r],t);return i}return e}getConfigValue(e,t){var i;const r=this,n=r[Mi];if(!((i=r.$meta.configs[e])!==null&&i!==void 0&&i.lazy))return $.processConfigValue(r[e],t);if(n!=null&&n.has(e))return $.processConfigValue(n.get(e),t)}preProcessCurrentConfigs(){}getCurrentConfig(e={}){const t=this,i=e.configs==="all"?t.config:N.clone(t.initialConfig),r=e.visited||(e.visited=new Set),n=e.depth||(e.depth=0),s={};if(!r.has(t)){r.add(t),this.preProcessCurrentConfigs(i);for(const l in i){const o=t.getConfigValue(l,F(F({},e),{},{depth:n+1}));o!==void 0&&(s[l]=o)}return s}}getConfigString(e={}){return _.toJavaScriptString(this.getCurrentConfig(e))}getTestCase(e={}){const t=this.isGantt?"Gantt":this.isSchedulerPro?"SchedulerPro":this.isCalendar?"Calendar":this.isScheduler?"Scheduler":this.isGrid?"Grid":this.isTaskBoard?"TaskBoard":null;if(t){const i=t.toLowerCase(),r=`../../build/${i}.module.js`;let n,s;e.import==="static"?(n=`import * as module from "${r}";Object.assign(window, module);`,s=""):(n=`import("${r}").then(module => { Object.assign(window, module);
`,s="});");const l=re.getVersion(i);return l&&(n+=`
console.log('${t} ${l}');
`),`${n}      
const ${i} = new ${t}(${this.getConfigString(e)});
${s}`}}downloadTestCase(e={}){e.output="return";const t=this.getTestCase(e);W.download("app.js","data:application/javascript;charset=utf-8,"+escape(t))}static initClass(){return this.$meta.class}static get $meta(){const e=this;let t=e[Br];return Qe(e,Br)||(e[Br]=t=Ja(),t.class=e,e.setupClass(t)),t}static onClassMixedIn(){}static mergeConfigs(e,...t){const i=this.$meta.configs,r=N.clone(e)||{};let n,s,l,o;for(s=0;s<t.length;++s)if(n=t[s],n)for(l in n)o=n[l],i[l]?o=i[l].merge(o,r[l]):r[l]&&o&&(o=de.merge(o,r[l])),r[l]=o;return r}static mixin(...e){let t=this,i;for(i=0;i<e.length;++i){const r=e[i],n=r[_l]||(r[_l]=Symbol("mixinTag"));t[n]||(t=r(t),t[n]=!0,Qe(t,"onClassMixedIn")&&t.onClassMixedIn())}return t}static setupClass(e){var t;const i=e.class,r=Al(i).$meta,n=i.$$name,s=r.names,l=i.prototype;if($l(l,"$meta",{value:e}),Object.assign(e,{super:r,config:Object.create(r.config),configs:Object.create(r.configs),declarables:r.declarables,forkConfigs:r.forkConfigs,hierarchy:Object.freeze([...r.hierarchy,i]),names:s.includes(n)?s:Object.freeze([...s,n]),properties:r.properties,nullify:(t=r.nullify)===null||t===void 0?void 0:t.slice()}),s!==e.names){const o=`is${n}`,a=d=>{Qe(d,o)||$l(d,o,{get(){return Qe(typeof d=="object"?d.constructor:d,"$name")||console.warn(`$name static property or getter required for class ${n} to provide class name for minified sources.`+(re.isTestEnv?"":`
https://bryntum.com/products/grid/docs/api/Core/widget/Widget#property-$name-static`)),!0}})};a(l),a(i)}for(let o,a,d=0;d<e.declarables.length;++d)o=e.declarables[d],Qe(i,o)&&(a=Hl[o]||(Hl[o]=`setup${_.capitalize(o)}`),i[a](i,e))}static setupConfigs(e,t,i){const r=e.config,n=e.configs,s=e.class,l=e.super;let{nullify:o}=e,a,d,c,h,g,f;for(const m in t)g=t[m],i?(a=n[m])?g=a.merge(g,r[m],e,l):a=de.get(m,Zc):(d=c=h=void 0,g&&typeof g=="object"&&"$config"in g&&(c=g.$config,c&&!N.isObject(c)&&(c=N.createTruthyKeys(c)),h="default"in g,d=h?g.default:d,g=g.value),(a=n[m])?(f=a.nullify,c&&(a=a.extend(c)),g=a.merge(g,r[m],e,l)):(a=de.get(m,c),a.define(s.prototype),h=!(a.field in s.prototype),f=!1),h&&a.setDefault(s,d),a.nullify&&!f&&(o||(o=e.nullify||(e.nullify=[]))).push(a)),g&&(N.isObject(g)||Array.isArray(g))&&!Object.isFrozen(g)&&(e.forkConfigs=!0),n[m]=a,r[m]=g}static setupConfigurable(e,t){e.setupConfigs(t,e.configurable,!1)}static setupDefaultConfig(e,t){e.setupConfigs(t,e.defaultConfig,!0)}static setupDeclarable(e,t){const i=e.declarable;let r=t.declarables,n,s;for(s=0;s<i.length;++s)r.includes(i[s])||(n||(t.declarables=n=r=r.slice()),r.push(i[s]))}static setupProperties(e,t){t.properties=t.super.properties.slice(),t.properties.push(e),Object.freeze(t.properties)}static setupPrototypeProperties(e){Object.assign(e.prototype,e.prototypeProperties)}getDefaultConfiguration(){return this.constructor.getDefaultConfiguration()}static getDefaultConfiguration(){const e=this.$meta,t=e.forkConfigs?$.fork(e.config):Object.create(e.config);if(re.isTestEnv&&W.isBrowserEnv&&t.testConfig&&globalThis.__applyTestConfigs)for(const i in t.testConfig)t[i]=t.testConfig[i];return t}static fork(e){let t=e,i,r;if(e&&N.isObject(e)&&!Object.isFrozen(e)){t=Object.create(e);for(i in e)r=e[i],r&&(N.isObject(r)?t[i]=$.fork(r):Array.isArray(r)&&(t[i]=r.slice()))}return t}getProperties(){const e=this.$meta.properties,t={};for(let i=0;i<e.length;i++)Object.assign(t,e[i].properties);return t}static get superclass(){return Al(this)}classHierarchy(e){const t=this.$meta.hierarchy,i=e?t.indexOf(e):0;return i>0?t.slice(i):t}static isOfTypeName(e){return this.$meta.names.includes(e)}detachListeners(e){var t;let i=this.$detachers;if(i=(t=i)===null||t===void 0?void 0:t[e],i)for(;i.length;)i.pop()()}trackDetacher(e,t){const i=this.$detachers||(this.$detachers={});(i[e]||(i[e]=[])).push(t)}untrackDetachers(e){const t=this.$detachers;if(t)for(const i in t){const r=t[i];for(let n=r.length;n-- >0;)r[n].eventer===e&&r.splice(n,1)}}}const Ns=$.prototype;Ns.onConfigChange.$nullFn=qr.$nullFn=!0;$[Br]=Ns.$meta=Ja({class:$,config:Object.freeze({}),configs:Object.create(null),declarables:$.declarable,forkConfigs:!1,hierarchy:Object.freeze([$]),names:Object.freeze(["Base"]),nullify:null,properties:Object.freeze([]),super:null});Object.assign(Ns,{$detachers:null,configObserver:null,isConstructing:!0,isDestroyed:!1,isDestroying:!1});$.emptyFn=qr;re.setVersion("core","5.3.0");$._$name="Base";class B{static clean(e){return e.reduce((t,i)=>(i!=null&&!(Array.isArray(i)&&i.length===0)&&i!==""&&t.push(i),t),[])}static from(e,t,i){const r=[];if(e)for(const n of e)(!t||t(n))&&r.push(i?i(n):n);return r}static remove(e,...t){let i,r,n=!1;for(let s=0;s<t.length;s++)r=t[s],(i=e.indexOf(r))!==-1&&(e.splice(i,1),n=!0);return n}static findInsertionIndex(e,t,i=this.lexicalCompare,r){const n=t.length;let s,l;return r<n&&(s=r>0?i(t[r-1],e):0,l=r<n-1?i(e,t[r]):0,s<1&&l<1)?r:this.binarySearch(t,e,i)}static findLast(e,t,i){for(let{length:r}=e,n=r-1;n>=0;n--)if(t.call(i,e[n],n,e))return e[n]}static binarySearch(e,t,i=0,r=e.length,n=this.lexicalCompare){const s=e.length;let l,o;for(i instanceof Function?(n=i,i=0):r instanceof Function&&(n=r,r=s),--r;i<=r;)l=i+r>>1,o=n(t,e[l]),o>=0?i=l+1:o<0&&(r=l-1);return i}magnitudeCompare(e,t){return e<t?-1:e>t?1:0}lexicalCompare(e,t){return e=String(e),t=String(t),e<t?-1:e>t?1:0}static fill(e,t={},i=null){const r=[],n=Array.isArray(t)?t:[t];for(let s=0;s<e;s++)for(const l of n){const o=Object.assign({},l);i&&i(o,s),r.push(o)}return r}static populate(e,t,i=!1){const r=[];for(let n=0;n<e;n++)r.push(t(n+(i?1:0)));return r}static include(e,...t){for(const i of t)e.includes(i)||e.push(i)}static unique(e){return[...new Set(e)]}static allowNegative(e){return new Proxy(e,{get(t,i,r){if(typeof i!="string")return Reflect.get(t,i,r);const n=Number(i);return Number.isNaN(n)?Reflect.get(t,i,r):t[n<0?t.length+n:n]},set(t,i,r,n){if(typeof i!="string")return Reflect.set(t,i,r,n);const s=Number(i);return Number.isNaN(s)?Reflect.set(t,i,r,n):(t[s<0?t.length+s:s]=r,!0)}})}static delta(e,t,i=!1){if(!t)return i?{toAdd:e,toRemove:[],toKeep:[]}:{onlyInA:e,onlyInB:[],inBoth:[]};const r=[],n=[],s=new Set,l=new Set(t);for(let o=0;o<e.length;o++){const a=e[o];l.has(a)?s.add(a):r.push(a)}for(let o=0;o<t.length;o++){const a=t[o];s.has(a)||n.push(a)}return i?{toAdd:r,toRemove:n,toKeep:s}:{onlyInA:r,onlyInB:n,inBoth:[...s]}}static asArray(e){return e==null?e:e instanceof Set?Array.from(e):Array.isArray(e)?e:[e]}static identity(e){return e}static keyBy(e,t,i=B.identity){const r=typeof t=="string"?s=>s?.[t]:t,n=typeof i=="string"?s=>s?.[i]:i;return e.reduce((s,l)=>(s[r(l)]=n(l),s),{})}}B._$name="ArrayHelper";const Bl=/,\s*/,Fn=Symbol("decompiled"),tu=/^\s*(async\s+)?([a-z_]\w*)\s*=>([\s\S]+)$/i,iu=/^\s*(async\s*)?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)\s+=>([\s\S]+)$/i,ru=/^(\s*async)?(?:\s*function)?(?:\s*([a-z_]\w*))?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)([\s\S]+)$/i,{hasOwnProperty:nu}=Object.prototype;class pe{static after(e,t,i,r,n){const s=typeof i=="string",l=n?.return!==!1,o=(...a)=>{const d=o.$nextHook.call(e,...a),c=r!=null&&r.isDestroyed?void 0:l?s?r[i](d,...a):i.call(r,d,...a):s?r[i](...a):i.call(r,...a);return c===void 0?d:c};return pe.hookMethod(e,t,o)}static before(e,t,i,r){const n=typeof i=="string",s=(...l)=>{const o=r!=null&&r.isDestroyed?0:n?r[i](...l):i.call(r,...l);return o===!1?o:s.$nextHook.call(e,...l)};return pe.hookMethod(e,t,s)}static curry(e){return function t(...i){return i.length>=e.length?e.apply(this,i):function(...r){return t.apply(this,i.concat(r))}}}static bindAll(e){for(const t in e)typeof e[t]=="function"&&(e[t]=e[t].bind(e))}static createInterceptor(e,t,i){return function(...r){const n=i||this;return t.call(n,...r)!==!1?e.call(n,...r):!1}}static createSequence(e,t,i){return(...r)=>{const n=e.call(i,...r),s=t.call(i,...r);return s===void 0?n:s}}static createThrottled(e,t,i,r,n){let s=-Number.MAX_VALUE,l,o;const a=()=>{o=0,s=performance.now(),l.push.apply(l,r),e.apply(i,l)},d=function(...c){const h=performance.now()-s;l=c,h>=t?(clearTimeout(o),a()):(o||(o=setTimeout(a,t-h)),n&&(l.push.apply(l,r),n.apply(i,l)))};return d.cancel=()=>clearTimeout(o),d}static createBuffered(e,t,i,r){let n,s;const l=()=>{s=0,o.isPending=!1,n.push.apply(n,r),e.apply(i,n)},o=function(...a){n=a,s&&clearTimeout(s),o.isPending=!0,s=setTimeout(l,t)};return o.cancel=()=>{o.isPending=!1,clearTimeout(s)},o}static decompile(e){if(!(Fn in e)){var t,i;const r=e.toString();let n=tu.exec(r),s,l,o,a,d;n?(s=[n[2]],l=n[3]):(n=iu.exec(r))?(d=n[2].trim(),s=d?d.split(Bl):[],l=n[3]):(n=ru.exec(r))&&(o=n[2],d=n[3].trim(),s=d?d.split(Bl):[],l=n[4]),l=(t=l)===null||t===void 0?void 0:t.trim(),e[Fn]=a=n&&{args:s,async:Boolean(n[1]),body:(i=l)!==null&&i!==void 0&&i.startsWith("{")?l.substring(1,l.length-1).trim():l},o&&(a.name=o)}return e[Fn]}static hookMethod(e,t,i){return i.$nextHook=e[t],e[t]=i,()=>{if(nu.call(e,t)){let s=e[t],l;if(s===i){var r;((r=Object.getPrototypeOf(e))===null||r===void 0?void 0:r[t])===i.$nextHook?delete e[t]:e[t]=i.$nextHook}else for(;l=(n=s)===null||n===void 0?void 0:n.$nextHook;s=l){var n;if(l===i){s.$nextHook=i.$nextHook;break}}}}}static noThrow(e,t,i){const r=e[t];e[t]=(...n)=>{try{return r.apply(e,n)}catch(s){return i?.(s)}}}static returnTrue(){return!0}static animate(e,t,i,r="linear"){let n=!1;const s=new Promise(l=>{const o=performance.now(),a=()=>{const d=Math.min((performance.now()-o)/e,1),c=i&&i.setTimeout?i:globalThis;n||t.call(i,this.easingFunctions[r](d))===!1&&l(),n||d===1?c.requestAnimationFrame(()=>l()):c.requestAnimationFrame(a)};a()});return s.cancel=()=>(n=!0,!1),s}}const le=.5,yt=1.70158,Ue=7.5625,Cr=1.525,kn=2/2.75,Ln=2.25/2.75,Pn=1/2.75,On=1.5/2.75,An=2.5/2.75,$n=2.625/2.75,_n=.75,Hn=.9375,Nn=.984375,su=1.70158,lu=1.70158;pe.easingFunctions={linear:u=>u,easeInQuad:u=>Math.pow(u,2),easeOutQuad:u=>-(Math.pow(u-1,2)-1),easeInOutQuad:u=>(u/=le)<1?le*Math.pow(u,2):-le*((u-=2)*u-2),easeInCubic:u=>Math.pow(u,3),easeOutCubic:u=>Math.pow(u-1,3)+1,easeInOutCubic:u=>(u/=le)<1?le*Math.pow(u,3):le*(Math.pow(u-2,3)+2),easeInQuart:u=>Math.pow(u,4),easeOutQuart:u=>-(Math.pow(u-1,4)-1),easeInOutQuart:u=>(u/=le)<1?le*Math.pow(u,4):-le*((u-=2)*Math.pow(u,3)-2),easeInQuint:u=>Math.pow(u,5),easeOutQuint:u=>Math.pow(u-1,5)+1,easeInOutQuint:u=>(u/=le)<1?le*Math.pow(u,5):le*(Math.pow(u-2,5)+2),easeInSine:u=>-Math.cos(u*(Math.PI/2))+1,easeOutSine:u=>Math.sin(u*(Math.PI/2)),easeInOutSine:u=>-le*(Math.cos(Math.PI*u)-1),easeInExpo:u=>u===0?0:Math.pow(2,10*(u-1)),easeOutExpo:u=>u===1?1:-Math.pow(2,-10*u)+1,easeInOutExpo:u=>u===0?0:u===1?1:(u/=le)<1?le*Math.pow(2,10*(u-1)):le*(-Math.pow(2,-10*--u)+2),easeInCirc:u=>-(Math.sqrt(1-u*u)-1),easeOutCirc:u=>Math.sqrt(1-Math.pow(u-1,2)),easeInOutCirc:u=>(u/=le)<1?-le*(Math.sqrt(1-u*u)-1):le*(Math.sqrt(1-(u-=2)*u)+1),easeOutBounce:u=>u<Pn?Ue*u*u:u<kn?Ue*(u-=On)*u+_n:u<An?Ue*(u-=Ln)*u+Hn:Ue*(u-=$n)*u+Nn,easeInBack:u=>u*u*((yt+1)*u-yt),easeOutBack:u=>(u=u-1)*u*((yt+1)*u+yt)+1,easeInOutBack:u=>{let e=su;return(u/=le)<1?le*(u*u*(((e*=Cr)+1)*u-e)):le*((u-=2)*u*(((e*=Cr)+1)*u+e)+2)},elastic:u=>-1*Math.pow(4,-8*u)*Math.sin((u*6-1)*(2*Math.PI)/2)+1,swingFromTo:u=>{let e=lu;return(u/=le)<1?le*(u*u*(((e*=Cr)+1)*u-e)):le*((u-=2)*u*(((e*=Cr)+1)*u+e)+2)},swingFrom:u=>u*u*((yt+1)*u-yt),swingTo:u=>(u-=1)*u*((yt+1)*u+yt)+1,bounce:u=>u<Pn?Ue*u*u:u<kn?Ue*(u-=On)*u+_n:u<An?Ue*(u-=Ln)*u+Hn:Ue*(u-=$n)*u+Nn,bouncePast:u=>u<Pn?Ue*u*u:u<kn?2-(Ue*(u-=On)*u+_n):u<An?2-(Ue*(u-=Ln)*u+Hn):2-(Ue*(u-=$n)*u+Nn),easeFromTo:u=>(u/=le)<1?le*Math.pow(u,4):-le*((u-=2)*Math.pow(u,3)-2),easeFrom:u=>Math.pow(u,4),easeTo:u=>Math.pow(u,.25)};pe._$name="FunctionHelper";const{isArray:Vl}=Array,{hasOwnProperty:ou}=Object.prototype,zl={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,buffer:1,throttle:1,name:1,$internal:1},Wl=(u,e)=>e.prio-u.prio;var Me=u=>class Ds extends(u||$){constructor(...t){super(...t),T(this,"eventsSuspended",null)}static get $name(){return"Events"}static get declarable(){return["deprecatedEvents"]}static setupDeprecatedEvents(t,i){const r=i.getInherited("deprecatedEvents"),n=t.deprecatedEvents;for(const s in n)r[s.toLowerCase()]=r[s]=n[s]}static get configurable(){return{listeners:{value:null,$config:{merge(t,i){if(t!==null){if(!t)return i;i&&(t=t?[t]:[],t.push[Vl(i)?"apply":"call"](t,i))}return t}}},internalListeners:null,bubbleEvents:null}}destroy(){this.trigger("beforeDestroy"),super.destroy()}construct(t,...i){var r;(this.configuredListeners=(r=t)===null||r===void 0?void 0:r.listeners)&&(t=N.assign({},t),delete t.listeners),super.construct(t,...i),this.processConfiguredListeners()}processConfiguredListeners(){if(this.configuredListeners){const t=this,{isConfiguring:i}=t;t.isConfiguring=!1,t.listeners=t.configuredListeners,t.configuredListeners=null,t.isConfiguring=i}}doDestroy(){this.trigger("destroy"),this.removeAllListeners(!1),super.doDestroy()}static setupClass(t){super.setupClass(t),Ds.prototype.onListen.$nullFn=!0,Ds.prototype.onUnlisten.$nullFn=!0}addListener(t,i,r){if(Vl(t)){for(let o=0,{length:a}=t;o<a;o++)this.addListener(t[o],i);return}const n=this,s=n.$meta.getInherited("deprecatedEvents");if(typeof t=="string")return n.addListener({[t]:i,detachable:i.detachable!==!1,thisObj:r});{i=t.thisObj=t.thisObj!==void 0?t.thisObj:i;for(const c in t)if(!zl[c]&&t[c]!=null){const h=c.toLowerCase(),g=s?.[h],f=n.eventListeners||(n.eventListeners={}),m=t[c],p=m.expires||t.expires,v={fn:typeof m=="object"?m.fn:m,thisObj:m.thisObj!==void 0?m.thisObj:i,args:m.args||t.args,prio:m.prio!==void 0?m.prio:t.prio!==void 0?t.prio:0,once:m.once!==void 0?m.once:t.once!==void 0?t.once:!1,buffer:m.buffer||t.buffer,throttle:m.throttle||t.throttle,$internal:t.$internal,catchAll:c==="catchAll"};if(g){const{product:C,invalidAsOfVersion:w,message:S}=g;re.deprecate(C,w,S)}if(p){const{alt:C}=p,w=C?p.delay:p,S=t.name||c,D=()=>{n.un(h,v),C&&!v.called&&n.callback(C,i)};n.isDelayable?n.setTimeout({fn:D,name:S,cancelOutstanding:!0,delay:w}):globalThis.setTimeout(D,w)}let y=f[h]||(f[h]=[]);y.$firing&&(f[h]=y=y.slice()),y.splice(B.findInsertionIndex(v,y,Wl,y.length),0,v),!n.onListen.$nullFn&&y.length<2&&n.onListen(h)}t.relayAll&&n.relayAll(t.relayAll),i&&i!==n&&n.attachAutoDetacher(t,i);const o=t.detachable!==!1,a=t.name,d=t.expires||o||a?()=>{n.isDestroyed||n.removeListener(t,i)}:null;if(d){var l;if(d.eventer=n,d.listenerName=a,a&&(l=i)!==null&&l!==void 0&&l.trackDetacher&&i.trackDetacher(a,d),t.expires&&n.delay(d,isNaN(t.expires)?t.expires.delay:t.expires,a),o)return d}}}on(t,i,r){return this.addListener(t,i,r)}ion(t){return t.$internal=!0,this.on(t)}un(...t){this.removeListener(...t)}updateInternalListeners(t,i){i?.detach(),t&&(t.detach=this.ion(t))}get listeners(){return this.eventListeners}changeListeners(t){if(this.isConfiguring)this.getConfig("internalListeners"),t&&this.on(t,this);else{if(Array.isArray(t))for(let i=0,r=t[0],{length:n}=t;i<n;r=t[++i])"thisObj"in r||(t[i]=N.assign({thisObj:this},r));else t&&!("thisObj"in t)&&(t=N.assign({thisObj:this},t));return t}}updateListeners(t,i){i&&this.un(i),t&&this.on(t)}removeListener(t,i=t.thisObj,r){const n=this;if(typeof t=="string")return n.removeListener({[t]:i},r);Object.entries(t).forEach(([s,l])=>{if(!zl[s]&&l!=null){s=s.toLowerCase();const o=n.eventListeners,a=n.findListener(s,l,i);if(a>=0){let d=o[s];d.length>1?(d.$firing&&(o[s]=d=d.slice()),d.splice(a,1)):(delete o[s],n.onUnlisten.$nullFn||n.onUnlisten(s))}}}),t.thisObj&&!t.thisObj.isDestroyed&&n.detachAutoDetacher(t)}findListener(t,i,r){var n;const s=(n=this.eventListeners)===null||n===void 0?void 0:n[t],l=i.fn||i,o=i.thisObj||r;if(s){for(let a,d=0,{length:c}=s;d<c;d++)if(a=s[d],a.fn===l&&a.thisObj===o)return d}return-1}hasListener(t){var i;return Boolean((i=this.eventListeners)===null||i===void 0?void 0:i[t?.toLowerCase()])}relayAll(t,i,r=!0){this.relayAllTargets||(this.relayAllTargets=[]);const n=this.relayAllTargets;t.on({beforeDestroy:({source:s})=>{s===t&&n.filter(o=>o.through===t).forEach(o=>B.remove(n,o))}}),n.push({through:t,prefix:i,transformCase:r})}removeAllListeners(t=!0){const i=this.eventListeners;let r,n;for(const a in i){const d=i[a];for(r=d.length;r-- >0;){const c=d[r];if(!c.$internal||!t){var s,l,o;this.removeListener(a,c),n=c.thisObj,(s=n)===null||s===void 0||(l=(o=s).untrackDetachers)===null||l===void 0||l.call(o,this)}}}}relayEvents(t,i,r=""){const n={detachable:!0,thisObj:this};return i.forEach(s=>{n[s]=(l,...o)=>this.trigger(r+s,l,...o)}),t.on(n)}onListen(){}onUnlisten(){}destructorInterceptor(){const{autoDetachers:t,target:i,oldDestructor:r}=this;for(let n=0;n<t.length;n++){const{dispatcher:s,config:l}=t[n];s.isDestroyed||s.removeListener(l,i)}r.call(i)}attachAutoDetacher(t,i){const r=t.thisObj||i,n="doDestroy"in r?"doDestroy":"destroy";if(n in r){let{$autoDetachers:s}=r;s||(r.$autoDetachers=s=[]),r.$oldDestructor||(r.$oldDestructor=r[n],r[n]=this.destructorInterceptor.bind({autoDetachers:s,oldDestructor:r.$oldDestructor,target:r})),s.push({config:t,dispatcher:this})}else r[n]=()=>{this.removeListener(t)}}detachAutoDetacher(t){const i=t.thisObj;i.$oldDestructor&&!i.isDestroying&&(B.remove(i.$autoDetachers,i.$autoDetachers.find(r=>r.config===t&&r.dispatcher===this)),i.$autoDetachers.length||(i["doDestroy"in i?"doDestroy":"destroy"]=i.$oldDestructor,i.$oldDestructor=null))}await(t,i={checkLog:!0,resetLog:!0,args:null}){const r=this;i===!1&&(i={checkLog:!1});const{args:n}=i;return new Promise(s=>{var l;if(i.checkLog&&(l=r._triggered)!==null&&l!==void 0&&l[t]&&(s(),i.resetLog&&r.clearLog(t)),n){const o=r.on({[t]:(...a)=>{Object.keys(n).every(c=>c in a[0]&&a[0][c]===n[c])&&(s(...a),i.resetLog&&r.clearLog(t),o())},prio:-1e4})}else r.on({[t]:(...o)=>{s(...o),i.resetLog&&r.clearLog(t)},prio:-1e4,once:!0})})}clearLog(t){this._triggered&&(t?delete this._triggered[t]:this._triggered={})}trigger(t,i){var r,n,s,l,o;const a=this,d=t.toLowerCase(),{eventsSuspended:c,relayAllTargets:h,callOnFunctions:g}=a;let f=(r=a.eventListeners)===null||r===void 0?void 0:r[d],m;if(a._triggered||(a._triggered={}),a._triggered[t]=!0,c)return c.shouldQueue&&c.queue.push(arguments),!0;if((n=a.eventListeners)!==null&&n!==void 0&&n.catchall&&((f=f?f.slice():[]).push(...a.eventListeners.catchall),f.sort(Wl)),!f&&!h&&!g)return!0;if(i?"source"in i||(Object.isExtensible(i)?i.source=a:i=Object.setPrototypeOf({source:a},i)):i={source:a},i.type!==d&&(i.constructor!==Object?Reflect.defineProperty(i,"type",{get:()=>d}):i.type=d),!("bubbles"in i)&&(s=a.bubbleEvents)!==null&&s!==void 0&&s[t]&&(i.bubbles=a.bubbleEvents[t]),g){const y="on"+_.capitalize(t);if(y in a){var p;const C=a[y]?a.callback(a[y],a,[i]):!0;let w;if(N.isPromise(C)?(m||(m=[])).push(C):w=C===!1||w,!a.isDestroyed&&ou.call(a,y)&&!((p=a.pluginFunctionChain)!==null&&p!==void 0&&p[y])){const S=Object.getPrototypeOf(a);if(y in S){const D=S[y].call(a,i);if(N.isPromise(D)?(m||(m=[])).push(D):w=D===!1||w,a.isDestroyed)return}}if(w)return!1}}let v;if(f){let y=0,C=!1;for(f.$firing=!0,y;y<f.length&&!a.isDestroyed&&!C;y++){const w=f[y];if(v===!1&&!w.$internal)continue;let S,D=w.thisObj;if(!D||!D.isDestroyed){if(w.called=!0,w.once&&a.removeListener(d,w),typeof w.fn=="string"){if(D&&(S=D[w.fn]),!S){const R=a.resolveCallback(w.fn);S=R.handler,D=R.thisObj}}else S=w.fn;if(w.buffer){if(!w.bufferFn){const R=Number(w.buffer);if(typeof R!="number"||isNaN(R))throw new Error(`Incorrect type for buffer, got "${R}" (expected a Number)`);w.bufferFn=pe.createBuffered(S,R,D,w.args)}S=w.bufferFn}if(w.throttle){const R=Number(w.throttle);if(typeof R!="number"||isNaN(R))throw new Error(`Incorrect type for throttle, got "${R}" (expected a Number)`);w.throttledFn||(w.throttledFn=pe.createThrottled(S,R,D,w.args)),S=w.throttledFn}const I=S.call(D||a,...w.args||[],i);v!==!1&&(v=I),w.$internal&&I===!1&&(C=!0),N.isPromise(I)&&(I.$internal=w.$internal,(m||(m=[])).push(I))}}if(f.$firing=!1,C)return!1}return h?.forEach(y=>{let C=t;if(y.transformCase&&(C=_.capitalize(C)),y.prefix&&(C=y.prefix+C),y.through.trigger(C,i)===!1)return!1}),i.bubbles&&a.owner&&!a.owner.isDestroyed?a.owner.trigger(t,i):(m=(l=m)===null||l===void 0?void 0:l.filter(y=>v!==!1||y.$internal),(o=m)!==null&&o!==void 0&&o.length?new Promise(y=>{Promise.all(m).then(C=>{const w=!C.some(S=>S===!1);y(w)})}):v!==!1)}suspendEvents(t=!1){const i=this.eventsSuspended||(this.eventsSuspended={shouldQueue:t,queue:[],count:0});i.count++}resumeEvents(){const t=this.eventsSuspended;if(t&&--t.count===0&&(this.eventsSuspended=null,t.shouldQueue))for(const i of t.queue)this.trigger(...i);return!Boolean(this.eventsSuspended)}};class Qa{static animationFrame(){return new Promise(e=>{requestAnimationFrame(e)})}static sleep(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}static yield(){return Promise.resolve()}}Qa._$name="AsyncHelper";const au=/^(\w+)=(.*)$/,du=function(u){const e={},t=u.split("&");for(const i of t){const[r,n,s]=au.exec(i),l=decodeURIComponent(n),o=decodeURIComponent(s);if(r){let a=e[l];a?(Array.isArray(a)||(a=e[l]=[a]),a.push(o)):e[l]=o}}return e};class He{static get(e,t){return this.fetch(e,t)}static post(e,t,i={}){return!(t instanceof FormData)&&typeof t!="string"&&(t=JSON.stringify(t),i.headers=i.headers||{},i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},i))}static fetch(e,t){let i;if(t=N.merge({},He.DEFAULT_FETCH_OPTIONS,t),typeof AbortController<"u"&&(i=t.abortController=new AbortController,t.signal=i.signal),"credentials"in t||(t.credentials="include"),t.queryParams){const n=Object.entries(t.queryParams);if(n.length){let s=!1;if(t.headers&&t.addQueryParamsToBody===!0){const l=new Headers(t.headers).get("Content-Type");let o;switch(l){case"application/x-www-form-urlencoded":o=URLSearchParams;break;case"multipart/form-data":o=FormData;break}if(o){const a=t.body||(t.body=new o);a instanceof o&&(n.forEach(([d,c])=>a.set(d,c)),s=!0)}}s||(e+=(e.includes("?")?"&":"?")+n.map(([l,o])=>`${l}=${encodeURIComponent(o)}`).join("&"))}}const r=new Promise((n,s)=>{fetch(e,t).then(l=>{t.parseJson?l.json().then(o=>{l.parsedJson=o,n(l)}).catch(o=>{l.parsedJson=null,l.error=o,s(l)}):n(l)}).catch(l=>{l.stack=r.stack,s(l)})});return r.stack=new Error().stack,r.abort=function(){var n;(n=i)===null||n===void 0||n.abort()},r}static mockUrl(e,t){const i=this;(i.mockAjaxMap||(i.mockAjaxMap={}))[e]=t,He.originalFetch||(He.originalFetch=He.fetch,He.fetch=i.mockAjaxFetch.bind(i))}static async mockAjaxFetch(e,t){const i=e.split("?");let r=this.mockAjaxMap[i[0]],n=null;if(r){typeof r=="function"&&(r=await r(i[0],i[1]&&du(i[1]),t));try{n=t.parseJson&&JSON.parse(r.responseText)}catch(s){n=null,r.error=s}return r=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:e,parsedJson:n,text:()=>new Promise(s=>{s(r.responseText)}),json:()=>new Promise(s=>{s(n)})},r),new Promise(function(s,l){r.synchronous?s(r):setTimeout(function(){s(r)},"delay"in r?r.delay:100)})}else return He.originalFetch(e,t)}}T(He,"DEFAULT_FETCH_OPTIONS",{});He._$name="AjaxHelper";class Ie{static mergeLocales(...e){const t={};return e.forEach(i=>{Object.keys(i).forEach(r=>{typeof i[r]=="object"?t[r]=F(F({},t[r]),i[r]):t[r]=i[r]})}),t}static trimLocale(e,t){const i=(r,n)=>{e[r]&&(n?e[r][n]&&delete e[r][n]:delete e[r])};Object.keys(t).forEach(r=>{Object.keys(t[r]).length>0?Object.keys(t[r]).forEach(n=>i(r,n)):i(r)})}static normalizeLocale(e,t){if(!e)throw new Error('"nameOrConfig" parameter can not be empty');if(typeof e=="string"){if(!t)throw new Error('"config" parameter can not be empty');t.locale?t.name=e||t.name:t.localeName=e}else t=e;let i={};if(t.name||t.locale)i=Object.assign({localeName:t.name},t.locale),t.desc&&(i.localeDesc=t.desc),t.code&&(i.localeCode=t.code),t.path&&(i.localePath=t.path);else{if(!t.localeName)throw new Error(`"config" parameter doesn't have "localeName" property`);i=Object.assign({},t)}for(const r of["name","desc","code","path"])i[r]&&delete i[r];if(!i.localeName)throw new Error("Locale name can not be empty");return i}static get locales(){return globalThis.bryntum.locales||{}}static set locales(e){globalThis.bryntum.locales=e}static get localeName(){return globalThis.bryntum.locale||"En"}static set localeName(e){globalThis.bryntum.locale=e||Ie.localeName}static get locale(){return Ie.localeName&&this.locales[Ie.localeName]||this.locales.En||Object.values(this.locales)[0]||{localeName:"",localeDesc:"",localeCoode:""}}static publishLocale(e,t){const{locales:i}=globalThis.bryntum,r=Ie.normalizeLocale(e,t),{localeName:n}=r;return!i[n]||t===!0?i[n]=r:i[n]=this.mergeLocales(i[n]||{},r||{}),i[n]}}T(Ie,"skipLocaleIntegrityCheck",!1);globalThis.bryntum=globalThis.bryntum||{};globalThis.bryntum.locales=globalThis.bryntum.locales||{};Ie._$name="LocaleHelper";class cu extends Me($){static get defaultConfig(){return{throwOnMissingLocale:re.isTestEnv}}construct(...e){const t=this;if(super.construct(...e),W.isBrowserEnv){var i;const r=document.querySelector("script[data-default-locale]");r?t.applyLocale(r.dataset.defaultLocale):(i=t.locale)!==null&&i!==void 0&&i.localeName&&t.applyLocale(t.locale.localeName)}}get locales(){return Ie.locales}set locales(e){Ie.locales=e}set locale(e){this.applyLocale(e)}get locale(){return Ie.locale}registerLocale(e,t){re.deprecate("Core","6.0.0","LocaleManager.registerLocale deprecated, use LocaleHelper.publishLocale instead"),Ie.publishLocale(e,t)}extendLocale(e,t){re.deprecate("Core","6.0.0","LocaleManager.extendLocale deprecated, use LocaleManager.applyLocale instead");const i=Ie.publishLocale(e,t);return this.applyLocale(i,!0)}applyLocale(e,t,i=!1){const r=this;let n;if(typeof e=="string")if(typeof t!="object"){if(n=r.locales[e],!n){if(i)return!0;throw new Error(`Locale "${e}" is not published. Publish with LocaleHelper.publishLocale() before applying.`)}}else n=Ie.publishLocale(e,t);else n=Ie.publishLocale(e);if(r.locale.localeName&&r.locale.localeName===n.localeName&&t!==!0)return r.locale;Ie.localeName=n.localeName;const s=()=>{r.trigger("locale",n)};return n.localePath?new Promise((l,o)=>{r.loadLocale(n.localePath).then(a=>{a.text().then(d=>{new Function(d)(),W.isBrowserEnv&&(n=r.locales[n.localeName],n&&delete n.localePath),s(),l(n)})}).catch(a=>o(a))}):(s(),n)}loadLocale(e){return He.get(e)}set throwOnMissingLocale(e){this._throwOnMissingLocale=e}get throwOnMissingLocale(){return this._throwOnMissingLocale}}const Te=new cu,uu=Object.getPrototypeOf(Object),jl=/L{.*?}/g,Gl=/L{(.*?)}/g,Ul=/((.*?)\.)?(.+)/g,hu=u=>u.replace(/{(\d+)}/gm,"[[$1]]"),Yl=u=>u.replace(/\[\[(\d+)]]/gm,"{$1}"),fu=Object.freeze(Object.create(null));var zt=u=>class rt extends(u||$){static get $name(){return"Localizable"}static get configurable(){return{localeClass:null,localizable:null,localizableProperties:{value:[],$config:{merge:"distinct"}}}}static clsName(t){var i,r;return typeof t=="string"?t:t===uu?"Object":t.$$name||t.name||((i=t.prototype)===null||i===void 0?void 0:i.$$name)||((r=t.prototype)===null||r===void 0?void 0:r.name)}static parseLocaleString(t){var i;const r=[];let n;if((i=t)!==null&&i!==void 0&&i.includes("L{"))for(t=hu(t),Gl.lastIndex=0;(n=Gl.exec(t))!=null;){Ul.lastIndex=0;const s=Ul.exec(n[1]);r.push({match:Yl(n[0]),localeKey:Yl(s[3]),localeClass:s[2]})}return r.length>0?r:[{match:t,localeKey:t,localeClass:void 0}]}construct(t={},...i){super.construct(t,...i),Te.ion({locale:"updateLocalization",thisObj:this}),this.updateLocalization()}get localeClass(){return this._localeClass||null}localizeProperty(t){var i,r,n;const s=this,l=N.getPath(s,t),o=((i=s.$meta.configs[t])===null||i===void 0?void 0:i.localeKey)||((r=s.fieldMap)===null||r===void 0||(n=r[t])===null||n===void 0?void 0:n.defaultValue);let a;return o?(a=rt.localize(o,s,s.localeClass||s),a&&!(t in(s.initialConfig||fu))&&N.setPath(s.isColumn?s.data:s,t,a)):typeof l=="string"&&(s.originalLocales=s.originalLocales||{},a=N.getPath(s.originalLocales,t),a===void 0&&(N.setPath(s.originalLocales,t,l),a=l),a&&N.setPath(s,t,a=s.optionalL(a,s))),a||l}updateLocalization(){if(this.localizable!==!1){var t,i;(t=this.localizableProperties)===null||t===void 0||t.forEach(this.localizeProperty,this),(i=this.trigger)===null||i===void 0||i.call(this,"localized")}}static getTranslation(t,i,r){const n=Te.locale;let s=null,l,o;if(n)for(const{match:a,localeKey:d,localeClass:c}of this.parseLocaleString(t)){const h=f=>{var m;const p=(m=n[f])===null||m===void 0?void 0:m[d];return p&&(typeof p=="function"?s=i!=null?p(i):p:typeof p=="object"||t===a?s=p:s=(s||t).replace(a,p),typeof p=="string"&&p.includes("L{")&&(s=this.getTranslation(p,i,r))),p};let g=!1;for(o=r;o&&(l=rt.clsName(o))&&!(g=h(l));o=Object.getPrototypeOf(o))if(typeof o=="string")break;!g&&c&&h(c)}return s}static localize(t,i=void 0,...r){var n;((n=r)===null||n===void 0?void 0:n.length)===0&&(r=[this]);let s=null;return r.some(l=>(s=rt.getTranslation(t,i,l),s!=null)),s}static L(t,i=void 0,...r){var n;((n=r)===null||n===void 0?void 0:n.length)===0&&(r=[this]);const s=this.localize(t,i,...r);if(s==null&&Te.throwOnMissingLocale&&t.includes("L{"))throw new Error(`Localization is not found for '${t}' in '${r.map(l=>rt.clsName(l)).join(", ")}'. ${Te.locale.localeName?`Locale : ${Te.locale.localeName}`:""}`);return s??t}L(t,i){const{localeClass:r,constructor:n}=this;return r&&rt.clsName(r)!==rt.clsName(n)?rt.L(t,i,r,n):rt.L(t,i,n)}static optionalL(t,i=void 0,...r){var n;const s=Te.throwOnMissingLocale;Te.throwOnMissingLocale=s&&jl.test(t),((n=r)===null||n===void 0?void 0:n.length)===0&&(r=[this]);const l=rt.L(t,i,...r);return Te.throwOnMissingLocale=s,l}optionalL(t,i=this,r=!1){const n=Te.throwOnMissingLocale;Te.throwOnMissingLocale=n&&jl.test(t)&&!r;const s=this.L(t,i);return Te.throwOnMissingLocale=n,s}get localeManager(){return Te}get localeHelper(){return Ie}};const gu={localeName:"En",localeDesc:"English (US)",localeCode:"en-US",Object:{Yes:"Yes",No:"No",Cancel:"Cancel",Ok:"OK",Week:"Week"},Combo:{noResults:"No results",recordNotCommitted:"Record could not be added",addNewValue:u=>`Add ${u}`},FilePicker:{file:"File"},Field:{badInput:"Invalid field value",patternMismatch:"Value should match a specific pattern",rangeOverflow:u=>`Value must be less than or equal to ${u.max}`,rangeUnderflow:u=>`Value must be greater than or equal to ${u.min}`,stepMismatch:"Value should fit the step",tooLong:"Value should be shorter",tooShort:"Value should be longer",typeMismatch:"Value is required to be in a special format",valueMissing:"This field is required",invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},DatePicker:{gotoPrevYear:"Go to previous year",gotoPrevMonth:"Go to previous month",gotoNextMonth:"Go to next month",gotoNextYear:"Go to next year"},NumberFormat:{locale:"en-US",currency:"USD"},DurationField:{invalidUnit:"Invalid unit"},TimeField:{invalidTime:"Invalid time input"},TimePicker:{hour:"Hour",minute:"Minute",second:"Second"},List:{loading:"Loading..."},GridBase:{loadMask:"Loading...",syncMask:"Saving changes, please wait..."},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:u=>`of ${u.lastPage}`,summaryTemplate:u=>`Displaying records ${u.start} - ${u.end} of ${u.allCount}`},PanelCollapser:{Collapse:"Collapse",Expand:"Expand"},Popup:{close:"Close"},UndoRedo:{Undo:"Undo",Redo:"Redo",UndoLastAction:"Undo last action",RedoLastAction:"Redo last undone action",NoActions:"No items in the undo queue"},FieldFilterPicker:{equals:"equals",doesNotEqual:"does not equal",isEmpty:"is empty",isNotEmpty:"is not empty",contains:"contains",doesNotContain:"does not contain",startsWith:"starts with",endsWith:"ends with",isOneOf:"is one of",isNotOneOf:"is not one of",isGreaterThan:"is greater than",isLessThan:"is less than",isGreaterThanOrEqualTo:"is greater than or equal to",isLessThanOrEqualTo:"is less than or equal to",isBetween:"is between",isNotBetween:"is not between",isBefore:"is before",isAfter:"is after",isToday:"is today",isTomorrow:"is tomorrow",isYesterday:"is yesterday",isThisWeek:"is this week",isNextWeek:"is next week",isLastWeek:"is last week",isThisMonth:"is this month",isNextMonth:"is next month",isLastMonth:"is last month",isThisYear:"is this year",isNextYear:"is next year",isLastYear:"is last year",isYearToDate:"is year to date",isTrue:"is true",isFalse:"is false",selectAProperty:"Select a property",selectAnOperator:"Select an operator",caseSensitive:"Case-sensitive",and:"and",dateFormat:"D/M/YY",selectOneOrMoreValues:"Select one or more values",enterAValue:"Enter a value",enterANumber:"Enter a number",selectADate:"Select a date"},FieldFilterPickerGroup:{addFilter:"Add filter"},DateHelper:{locale:"en-US",weekStartDay:0,nonWorkingDays:{0:!0,6:!0},weekends:{0:!0,6:!0},unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"},{single:"decade",plural:"decades",abbrev:"dec"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A"},ordinalSuffix:u=>{const e=["11","12","13"].find(i=>u.endsWith(i));let t="th";if(!e){const i=u[u.length-1];t={1:"st",2:"nd",3:"rd"}[i]||"th"}return u+t}}};Ie.publishLocale(gu);const{toString:Za}=Object.prototype,mu=Za.call(new Date),wr=new Date,Ms=1e3*60*60,Bn=(u,e)=>isNaN(u)||u==null?e:u,pu=/([ES]){([^}]+)}/g,ed=u=>{const e=["11","12","13"].find(i=>u.endsWith(i));let t="th";if(!e){const i=u[u.length-1];t={1:"st",2:"nd",3:"rd"}[i]||"th"}return u+t},ke=(u,e,t)=>(Mt[u]||(Mt[u]=new Intl.DateTimeFormat(Rt,e))).format(t),Ii=(u,e,t,i=!1)=>{let r=ke(u,e,t);return/am|pm/i.test(r)&&(r=r.replace(/^0/,""),i&&(r=r.replace(/:00/,""))),r},vu=(u,e)=>Math.floor((u.getTime()-e.getTime()-(u.getTimezoneOffset()-e.getTimezoneOffset())*Ne.minute.millisecond)/Ne.day.millisecond)+1,ql=u=>u>=0?u:u+7,bu=/([^\w])(S+)/gm,yu=(u,e,t)=>e+"SSS";let Rt="en-US",mt=ed,xr={},Ui={},Mt={},Vn={};const Kl=u=>{const e=Is[u];if(!e)throw new Error("Only international formats should be used here");if(Ui[u]!==void 0)return Ui[u];const t=new Intl.DateTimeFormat(Rt,e),i=t.formatToParts(new Date(2001,1,2,3,4,5,6)).map(r=>{const n=r.type,s=e[n];if(n==="literal")return r.value.replace(/,/g,"");if(n==="day")return s==="numeric"?"D":"DD";if(n==="month")return s==="short"?"MMM":s==="long"?"MMMM":s==="numeric"?"M":"MM";if(n==="year")return s==="numeric"?"YYYY":"YY"}).join("");return Ui[u]=i},Xl=2020,Jl=0,Ql=1,Is={l:{year:"numeric",month:"numeric",day:"numeric"},ll:{year:"numeric",month:"short",day:"numeric"}},De={M:u=>u.getMonth()+1,Mo:u=>mt(De.M(u).toString()),MM:u=>(u.getMonth()+1).toString().padStart(2,"0"),MMM:u=>ke("MMM",{month:"short"},u),MMMM:u=>ke("MMMM",{month:"long"},u),Q:u=>Math.ceil((u.getMonth()+1)/3),Qo:u=>mt(De.Q(u).toString()),D:u=>u.getDate(),Do:u=>mt(De.D(u).toString()),DD:u=>u.getDate().toString().padStart(2,"0"),DDD:u=>Math.ceil((new Date(u.getFullYear(),u.getMonth(),u.getDate(),12,0,0)-new Date(u.getFullYear(),0,0,12,0,0))/Ne.day.millisecond),DDDo:u=>mt(De.DDD(u).toString()),DDDD:u=>De.DDD(u).toString().padStart(3,"0"),d:u=>u.getDay(),do:u=>mt(u.getDay().toString()),d1:u=>ke("d1",{weekday:"narrow"},u).substr(0,1),dd:u=>De.ddd(u).substring(0,2),ddd:u=>ke("ddd",{weekday:"short"},u),dddd:u=>ke("dddd",{weekday:"long"},u),u:u=>{const e=Mt.u||(Mt.u=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"})),t=e.formatToParts(u);return`${t[4].value}${t[2].value}${t[0].value}Z`},uu:u=>{const e=Mt.uu||(Mt.uu=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),t=e.formatToParts(u);return`${t[4].value}${t[2].value}${t[0].value}T${t[6].value}${t[8].value}${t[10].value}Z`},e:u=>u.getDay(),E:u=>u.getDay()+1,W:u=>E.getWeekNumber(u)[1],Wo:u=>mt(De.W(u).toString()),WW:u=>De.W(u).toString().padStart(2,"0"),Wp:u=>`${E.localize("L{Week}")} ${De.W(u)}`,WWp:u=>`${E.localize("L{Week}")} ${De.WW(u)}`,Wp0:u=>`${E.localize("L{Week}")[0]}${De.W(u)}`,WWp0:u=>`${E.localize("L{Week}")[0]}${De.WW(u)}`,Y:u=>u.getFullYear(),YY:u=>u.getFullYear()%100,YYYY:u=>u.getFullYear(),A:u=>u.getHours()<12?"AM":"PM",a:u=>u.getHours()<12?"am":"pm",H:u=>u.getHours(),HH:u=>u.getHours().toString().padStart(2,"0"),h:u=>u.getHours()%12||12,hh:u=>De.h(u).toString().padStart(2,"0"),k:u=>u.getHours()||24,kk:u=>De.k(u).toString().padStart(2,"0"),K:u=>Ii("K",{hour:"numeric"},u),KK:u=>Ii("KK",{hour:"2-digit"},u),m:u=>u.getMinutes(),mm:u=>De.m(u).toString().padStart(2,"0"),s:u=>u.getSeconds(),ss:u=>De.s(u).toString().padStart(2,"0"),S:u=>Math.floor(u.getMilliseconds()/100).toString(),SS:u=>Math.floor(u.getMilliseconds()/10).toString().padStart(2,"0"),SSS:u=>u.getMilliseconds().toString().padStart(3,"0"),z:u=>ke("z",{timeZoneName:"short"},u),zz:u=>ke("zz",{timeZoneName:"long"},u),Z:u=>M.getGMTOffset(u),LT:u=>Ii("LT",{hour:"2-digit",minute:"2-digit"},u),LST:u=>Ii("LST",{hour:"numeric",minute:"2-digit"},u,!0),LTS:u=>Ii("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},u),L:u=>ke("L",{year:"numeric",month:"2-digit",day:"2-digit"},u),l:u=>ke("l",Is.l,u),LL:u=>ke("LL",{year:"numeric",month:"long",day:"numeric"},u),ll:u=>ke("ll",Is.ll,u),LLL:u=>ke("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},u),lll:u=>ke("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},u),LLLL:u=>ke("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},u),llll:u=>ke("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},u)},Cu=Object.keys(De).sort((u,e)=>e.length-u.length),wu=`^(?:${Cu.join("|")})`,Fe=()=>({}),xu=u=>Fu.test(u),zn=u=>xu(u)&&{milliseconds:parseInt(u.padEnd(3,"0").substring(0,3))},td={YYYY:u=>{const e=parseInt(u);return{year:e>=1e3&&e<=9999?e:NaN}},Y:u=>({year:parseInt(u)}),YY:u=>{const e=parseInt(u);return{year:e+(e>1968?1900:2e3)}},M:u=>({month:parseInt(u)-1}),MM:u=>({month:parseInt(u)-1}),Mo:u=>({month:parseInt(u)-1}),MMM:u=>{const e=(u||"").toLowerCase();for(const[t,i]of Object.entries(E._monthShortNamesIndex))if(e.startsWith(t))return{month:i.value}},MMMM:Fe,DD:u=>({date:parseInt(u)}),D:u=>({date:parseInt(u)}),Do:u=>({date:parseInt(u)}),DDD:Fe,DDDo:Fe,DDDD:Fe,d:Fe,do:Fe,d1:Fe,dd:Fe,ddd:Fe,dddd:Fe,Q:Fe,Qo:Fe,W:Fe,Wo:Fe,WW:Fe,e:Fe,E:Fe,HH:u=>({hours:parseInt(u)}),hh:u=>({hours:parseInt(u)}),mm:u=>({minutes:parseInt(u)}),H:u=>({hours:parseInt(u)}),m:u=>({minutes:parseInt(u)}),ss:u=>({seconds:parseInt(u)}),s:u=>({seconds:parseInt(u)}),S:zn,SS:zn,SSS:zn,A:u=>({amPm:u.toLowerCase()}),a:u=>({amPm:u.toLowerCase()}),L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A",l:{type:"dynamic",parser:()=>Kl("l")},ll:{type:"dynamic",parser:()=>Kl("ll")},Z:u=>{if(!u||!to.test(u)&&u!=="Z")return null;let e=0;if(u!=="Z"){const t=to.exec(u);if(t){const i=t[1]==="+"?1:-1,r=parseInt(t[2])||0,n=parseInt(t[3])||0;e=i*(r*60+n)}else e=-1*new Date().getTimezoneOffset()}return{timeZone:e}}},Su=Object.keys(td).sort((u,e)=>e.length-u.length),Zl=new RegExp(`(${Su.join("|")})`),Eu=new RegExp("^(LL|LLL|lll|LLLL|llll)$"),Ne={decade:{decade:1,year:10,quarter:40,month:120,week:520,day:3652,hour:24*3652,minute:1440*3652,second:86400*3652,millisecond:864e5*3652},year:{decade:.1,year:1,quarter:4,month:12,week:52,day:365,hour:24*365,minute:1440*365,second:86400*365,millisecond:864e5*365},quarter:{decade:1/40,year:1/4,quarter:1,month:3,week:4,day:91,hour:24*91,minute:1440*91,second:86400*91,millisecond:864e5*91},month:{decade:1/120,year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-24*30,minute:-1440*30,second:-86400*30,millisecond:-864e5*30},week:{decade:-1/520,year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{decade:-1/3652,year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{decade:-1/(3652*24),year:-1/(365*24),quarter:-1/(91*24),month:-1/(30*24),week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{decade:-1/(3652*1440),year:-1/(365*1440),quarter:-1/(91*1440),month:-1/(30*1440),week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{decade:-1/(3652*86400),year:-1/(365*86400),quarter:-1/(91*86400),month:-1/(30*86400),week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{decade:-1/(3652*864e5),year:-1/(365*864e5),quarter:-1/(91*864e5),month:-1/(30*864e5),week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:1/1e3}},eo={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",mi:"minute",min:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",mo:"month",mon:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year",dec:"decade",decades:"decade"},Tu=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,Ru=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,Kt=["millisecond","second","minute","hour","day","week","month","quarter","year","decade"],Du=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],Wn=["decade","year","month","week","day","hour","minute","second","millisecond"],Mu=["milliseconds","seconds","minutes","hours","date","month","year"],Iu=u=>{const e=parseFloat(u);return isNaN(e)?null:e},Fu=/^[0-9]+$/,to=/([+-])(\d\d):*(\d\d)*$/,Ct={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8,decade:9},ku={round(u,e=1){return Math.round(u/e)*e},floor(u,e=1){return Math.floor(u/e)*e},ceil(u,e=1){return Math.ceil(u/e)*e}},io={};class E extends zt(){static get $name(){return"DateHelper"}static set defaultFormat(e){M._defaultFormat=e}static get defaultFormat(){return M._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}static set defaultParseFormat(e){this._defaultParseFormat=e}static get defaultParseFormat(){return this._defaultParseFormat||this._defaultFormat||"YYYY-MM-DDTHH:mm:ss.SSSZ"}static buildParser(e){const t=e.split(Zl),i=[];return t.length===1||Eu.test(e)?[]:(t.reduce((r,n,s,l)=>{if(s!==0||n!=="")if(Zl.test(n)){const o=this.localize("L{parsers}")||{},a=o[n]||td[n];if(n==="Z"&&s<l.length-2)throw new Error(`Invalid format ${e} TimeZone (Z) must be last token`);const d=typeof a=="function"||typeof a=="string"?a:a.parser();if(typeof d=="string"){const c=M.buildParser(d),h=c.pop();delete h.last,i.push(...c),r=h}else r.pattern=n,r.fn=d}else r.splitter=n,i.push(r),r={};else Object.prototype.hasOwnProperty.call(r,"pattern")&&i.push(r);return r},{}),i[i.length-1].last=!0,i)}static makeKey(e){if(e.length===10)return e;e.getTime&&(e=e.getTime());const t=io[Math.trunc(e/Ms)];if(t)return t;wr.setTime(e);const i=wr.getMonth()+1,r=wr.getDate();return io[Math.trunc(e/Ms)]=`${wr.getFullYear()}-${i<10?"0"+i:i}-${r<10?"0"+r:r}`}static parseKey(e){return M.parse(e,"YYYY-MM-DD")}static parse(e,t=M.defaultParseFormat,i=!1){if(e instanceof Date)return e;if(typeof e!="string"||!e)return null;const r={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null};t=t.replace(bu,yu);let n=Vn[t],s;n||(n=Vn[t]=M.buildParser(t)),e.includes("\u202F")&&(e=e.replace(/\s/g," ")),n.reduce((o,a)=>{if(a.last)Object.assign(r,a.fn(o));else{let d;a.splitter==="T"&&o.indexOf("T")===-1?d=o.indexOf(" "):d=a.splitter!==""?o.indexOf(a.splitter):a.pattern&&a.pattern.length||-1;let c,h;if(d===-1||a.pattern==="SSS"&&o.match(/^\d+Z$/)){const g=o.split(/([Z\-+])/);g.length===1?(c=o,h=""):(c=g[0],h=`${g[1]}${g[2]}`)}else c=o.substring(0,d)||o,h=o.substring(d+a.splitter.length);if(a.fn){const g=a.fn(c);g?Object.assign(r,g):h=c+h}return h}},e),r.year&&!r.date&&(r.date=1);const l=M.create(r,i);return l?s=l:i||(s=new Date(e)),s}static create(e,t=!1){const i=F({},e);let r=isNaN(i.year),n=!1;if(!r){let l=!0;Mu.forEach(o=>{(!(o in i)||isNaN(i[o]))&&(i[o]=0),l=l&&i[o]===null}),r=l}if(i.amPm==="am"?i.hours=i.hours%12:i.amPm==="pm"&&(i.hours=i.hours%12+12),"timeZone"in i&&(n=!0,i.minutes-=i.timeZone),r||t&&(i.year==null||i.month==null||i.date==null))return null;const s=[Bn(i.year,Xl),Bn(i.month,Jl),Bn(i.date,Ql),i.hours,i.minutes,i.seconds,i.milliseconds];return n?new Date(Date.UTC(...s)):new Date(...s)}static toUTC(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))}static format(e,t=M.defaultFormat){if(!e||isNaN(e))return null;let i=xr[t],r="";if(!i){i=xr[t]=[];for(let n=0;n<t.length;n++){const s=t.slice(n).match(wu),l=s?.[0];if(l){const o=this.localize("L{formats}")||{},a=o[l]||De[l];i.push(a),n+=l.length-1}else if(t[n]==="{"){const o=t.indexOf("}",n+1);o===-1?(i.push(t.substr(n+1)),n=t.length):(i.push(t.substring(n+1,o)),n=o)}else i.push(t[n])}}return i.forEach(n=>{typeof n=="string"?r+=n:r+=n(e)}),r}static formatRange(e,t){return t.replace(pu,(i,r,n)=>E.format(e[r==="S"?0:1],n))}static asMilliseconds(e,t=null){return typeof e=="string"&&(t=e,e=1),M.as("millisecond",e,t)}static asMonths(e){const t=M.as("ms",M.daysInMonth(e),"day"),i=(e.valueOf()-M.startOf(e,"month").valueOf())/t;return e.getYear()*12+e.getMonth()+i}static monthsToDate(e){const t=Math.floor(e),i=e-t,r=new Date(0,t),n=M.as("ms",M.daysInMonth(r),"days");return r.setTime(r.getTime()+i*n),r}static formatDelta(e,t){let i,r;typeof t=="boolean"?i=t:t&&(i=t.abbrev);const n=this.getDelta(e,t),s=[],l=t?.separator||(i?"":" ");for(r in n)s.push(`${n[r]}${l}${r}`);return t?.asString===!1?s:s.join(", ")}static getDelta(e,t){let i,r,n,s,l,o,a;typeof t=="boolean"?i=t:t&&(i=t.abbrev,s=M.normalizeUnit(t.precision),o=t.maxUnit,a=!i&&t.ignoreLocale);const d={},c=i?M.getShortNameOfUnit:M.getLocalizedNameOfUnit,h=o?Wn.slice(Wn.indexOf(o)):Wn;for(l of h)if(r=M.as(l,e),n=s===l,r=Math[n?"round":"floor"](r),(r||n&&!d.length)&&(d[a?l:c.call(M,l,r!==1)]=r,e-=M.as("ms",r,l)),n||!e)break;return d}static as(e,t,i="ms"){return typeof t=="string"&&(t=M.parseDuration(t)),typeof t=="object"&&(i=t.unit,t=t.magnitude),e===i||(e=M.normalizeUnit(e),i=M.normalizeUnit(i),e===i)?t:Ct[i]>Ct[e]?t*Math.abs(Ne[i][e]):t/Math.abs(Ne[e][i])}static formatContainsHourInfo(e){const t=/(\\.)/g;return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(t,""))}static is24HourFormat(e){return M.format(M.getTime(13,0,0),e).includes("13")}static add(e,t,i="ms",r=!0){let n;if(typeof e=="string"?n=M.parse(e):r?n=new Date(e.getTime()):n=e,typeof t=="string"){const s=E.parseDuration(t);t=s.magnitude,i=s.unit}else t&&typeof t=="object"&&(i=t.unit,t=t.magnitude);if(!i||t===0)return n;switch(i=M.normalizeUnit(i),i){case"millisecond":n.setTime(n.getTime()+t);break;case"second":n.setTime(n.getTime()+t*1e3);break;case"minute":n.setTime(n.getTime()+t*6e4);break;case"hour":n.setTime(n.getTime()+t*36e5);break;case"day":t%1===0?(n.setDate(n.getDate()+t),n.getHours()===23&&e.getHours()===0&&n.setHours(n.getHours()+1)):n.setTime(n.getTime()+t*864e5);break;case"week":n.setDate(n.getDate()+t*7);break;case"month":{let s=n.getDate();s>28&&(s=Math.min(s,M.getLastDateOfMonth(M.add(M.getFirstDateOfMonth(n),t,"month")).getDate())),n.setDate(s),n.setMonth(n.getMonth()+t);break}case"quarter":M.add(n,t*3,"month",!1);break;case"year":n.setFullYear(n.getFullYear()+t);break;case"decade":n.setFullYear(n.getFullYear()+t*10);break}return n}static diff(e,t,i="ms",r=!0){if(i=M.normalizeUnit(i),!e||!t)return 0;let n;switch(i){case"year":n=M.diff(e,t,"month")/12;break;case"quarter":n=M.diff(e,t,"month")/3;break;case"month":n=(t.getFullYear()-e.getFullYear())*12+(t.getMonth()-e.getMonth());break;case"week":n=M.diff(e,t,"day")/7;break;case"day":{const s=e.getTimezoneOffset()-t.getTimezoneOffset();n=(t-e+s*60*1e3)/864e5;break}case"hour":n=(t-e)/36e5;break;case"minute":n=(t-e)/6e4;break;case"second":n=(t-e)/1e3;break;case"millisecond":n=t-e;break}return r?n:Math.round(n)}static startOf(e,t="day",i=!0,r=M.weekStartDay){if(!e)return null;switch(t=M.normalizeUnit(t),i&&(e=M.clone(e)),t){case"year":return e.setMonth(0,1),e.setHours(0,0,0,0),e;case"quarter":return e.setMonth((M.get(e,"quarter")-1)*3,1),e.setHours(0,0,0,0),e;case"month":return e.setDate(1),e.setHours(0,0,0,0),e;case"week":{const n=e.getDay()-r;return e.setDate(e.getDate()-n),e.setHours(0,0,0,0),e}case"day":return e.setHours(0,0,0,0),e;case"hour":e.getMinutes()>0&&e.setMinutes(0);case"minute":e.getSeconds()>0&&e.setSeconds(0);case"second":e.getMilliseconds()>0&&e.setMilliseconds(0);case"millisecond":return e}}static endOf(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}static clone(e){return new Date(e.getTime())}static clearTime(e,t=!0){return e?(t&&(e=new Date(e.getTime())),e.setHours(0,0,0,0),e):null}static midnight(e,t){let i=M.clearTime(e);return t&&i<e&&(i=M.add(i,1,"d")),i}static getTimeOfDay(e,t="ms"){const i=e.getHours()*Ne.hour.millisecond+e.getMinutes()*Ne.minute.millisecond+e.getSeconds()*Ne.second.millisecond+e.getMilliseconds();return t==="ms"?i:M.as(t,i,"ms")}static set(e,t,i){if(!t)return e;if(typeof t=="string")switch(M.normalizeUnit(t)){case"millisecond":(i!==0||e.getMilliseconds()>0)&&e.setMilliseconds(i);break;case"second":(i!==0||e.getSeconds()>0)&&e.setSeconds(i);break;case"minute":(i!==0||e.getMinutes()>0)&&e.setMinutes(i);break;case"hour":e.setHours(i);break;case"day":case"date":e.setDate(i);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(i);break;case"quarter":e.setDate(1),e.setMonth((i-1)*3);break;case"year":e.setFullYear(i);break}else Object.entries(t).sort((r,n)=>Ct[r[0]]-Ct[n[0]]).forEach(([r,n])=>{M.set(e,r,n)});return e}static setDateToMidday(e,t=!0){return M.set(M.clearTime(e,t),"hour",12)}static constrain(e,t,i){return t!=null&&(e=M.max(e,t)),i==null?e:M.min(e,i)}static getTime(e,t=0,i=0,r=0){return e instanceof Date&&(r=e.getMilliseconds(),i=e.getSeconds(),t=e.getMinutes(),e=e.getHours()),new Date(Xl,Jl,Ql,e,t,i,r)}static copyTimeValues(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}static get isDSTEnabled(){const e=new Date().getFullYear(),t=new Date(e,0,1),i=new Date(e,6,1);return t.getTimezoneOffset()!==i.getTimezoneOffset()}static isDST(e){const t=e.getFullYear(),i=new Date(t,0,1),r=new Date(t,6,1);return e.getTimezoneOffset()<Math.max(i.getTimezoneOffset(),r.getTimezoneOffset())}static isBefore(e,t){return e<t}static isAfter(e,t){return e>t}static isEqual(e,t,i=null){return i===null?e&&t&&e.getTime()===t.getTime():M.startOf(e,i)-M.startOf(t,i)===0}static compare(e,t,i=null){return i&&(e=M.startOf(e,i),t=M.startOf(t,i)),e<t?-1:e>t?1:0}static clamp(e,t,i){if(!isNaN(e))return t!=null&&(e=Math.max(e,t)),i!=null&&(e=Math.min(e,i)),new Date(e)}static isSameDate(e,t){return M.compare(e,t,"d")===0}static isSameTime(e,t){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds()&&e.getMilliseconds()===t.getMilliseconds()}static isStartOf(e,t){return M.isEqual(e,M.startOf(e,t))}static betweenLesser(e,t,i){return t.getTime()<=e.getTime()&&e.getTime()<i.getTime()}static betweenLesserEqual(e,t,i){return t.getTime()<=e.getTime()&&e.getTime()<=i.getTime()}static intersectSpans(e,t,i,r){return M.betweenLesser(e,i,r)||M.betweenLesser(i,e,t)}static compareUnits(e,t){return Math.sign(Ct[M.normalizeUnit(e)]-Ct[M.normalizeUnit(t)])}static timeSpanContains(e,t,i,r){return i-e>=0&&t-r>=0}static get weekStartDay(){return M._weekStartDay==null&&(M._weekStartDay=this.localize("L{weekStartDay}")||0),M._weekStartDay}static get nonWorkingDays(){return F({},this.localize("L{nonWorkingDays}"))}static get nonWorkingDaysAsArray(){return Object.keys(this.nonWorkingDays).map(Number)}static get weekends(){return F({},this.localize("L{weekends}"))}static get(e,t){switch(M.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return De.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}static daysInYear(e){const t=e.getFullYear(),i=new Date(t+1,0,1)-new Date(t,0,1);return this.as("day",i)}static daysInMonth(e){return 32-new Date(e.getFullYear(),e.getMonth(),32).getDate()}static hoursInDay(e){const t=e.getFullYear(),i=e.getMonth(),r=e.getDate(),n=new Date(t,i,r+1)-new Date(t,i,r);return this.as("hour",n)}static getNormalizedUnitDuration(e,t){let i;switch(t){case"month":i=M.asMilliseconds(M.daysInMonth(e),"day");break;case"year":i=M.asMilliseconds(M.daysInYear(e),"day");break;case"day":i=M.asMilliseconds(M.hoursInDay(e),"hour");break;default:i=M.asMilliseconds(t)}return i}static getFirstDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth(),1)}static getLastDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}static min(e,t){return e.getTime()<t.getTime()?e:t}static max(e,t){return e.getTime()>t.getTime()?e:t}static getNext(e,t,i=1,r=M.weekStartDay){if(t==="week"){const n=M.clone(e),s=n.getDay();return M.startOf(n,"day",!1),M.add(n,r-s+7*(i-(r<=s?0:1)),"day",!1),n.getDay()!==r&&M.add(n,1,"hour"),n}return M.startOf(M.add(e,i,t),t,!1)}static isValidDate(e){return M.isDate(e)&&!isNaN(e)}static isDate(e){return e&&Za.call(e)===mu}static getStartOfNextDay(e,t=!1,i=!1){let r=M.add(i?e:M.clearTime(e,t),1,"day");if(r.getDate()===e.getDate()){const n=M.add(M.clearTime(e,t),2,"day").getTimezoneOffset(),s=e.getTimezoneOffset();r=M.add(r,s-n,"minute")}return r}static getEndOfPreviousDay(e,t=!1){const i=t?e:M.clearTime(e,!0);return i-e?i:M.add(i,-1,"day")}static getWeekDescription(e,t=e){const i=e.getMonth()===t.getMonth()?E.format(e,"MMMM"):`${E.format(e,"MMM")} - ${E.format(t,"MMM")}`,r=E.getWeekNumber(e);return`${r[1]}, ${i} ${r[0]}`}static getWeekNumber(e,t=E.weekStartDay){const i=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),11,31),n=ql(i.getDay()-t),s=ql(r.getDay()-t),l=vu(e,i);let o;if(n<4?o=Math.floor((l+n-1)/7)+1:o=Math.floor((l+n-1)/7),o){let d=e.getFullYear();return o===53&&s<3&&(d++,o=1),[d,o]}const a=E.getWeekNumber(new Date(e.getFullYear()-1,11,31))[1];return[e.getFullYear()-1,a]}static formatCount(e,t){return t=M.normalizeUnit(t),e!==1&&(t+="s"),e+" "+t}static getUnitToBaseUnitRatio(e,t,i=!1){return e=M.normalizeUnit(e),t=M.normalizeUnit(t),e===t?1:Ne[e]&&Ne[e][t]&&(i||Ne[e][t]>0)?1/M.as(t,1,e):Ne[t]&&Ne[t][e]&&(i||Ne[t][e]>0)?M.as(e,1,t):-1}static getShortNameOfUnit(e){return e=M.parseTimeUnit(e),M.unitLookup[e].abbrev}static getLocalizedNameOfUnit(e,t=!1){const i=e.charAt(0)===e.charAt(0).toUpperCase();return e=M.normalizeUnit(e),e=M.parseTimeUnit(e),e=M.unitLookup[e][t?"plural":"single"],i&&(e=_.capitalize(e)),e}static normalizeUnit(e){if(!e)return null;const t=e.toLowerCase();return t==="date"||Kt.includes(t)?t:eo[e]||eo[t]}static getUnitByName(e){return M.normalizeUnit(e)||M.normalizeUnit(M.parseTimeUnit(e))}static getDurationInUnit(e,t,i,r){return M.diff(e,t,i,r)}static doesUnitsAlign(e,t){return!(e!==t&&t==="week")}static getSmallerUnit(e){return Kt[Ct[M.normalizeUnit(e)]-1]||null}static getLargerUnit(e){return Kt[Ct[M.normalizeUnit(e)]+1]||null}static round(e,t,i,r){return M.snap("round",e,t,i,r)}static floor(e,t,i,r){return M.snap("floor",e,t,i,r)}static ceil(e,t,i,r){return M.snap("ceil",e,t,i,r)}static snap(e,t,i,r,n=M.weekStartDay){const s=ku[e];if(typeof i=="string"&&(i=M.parseDuration(i)),N.isObject(i)){const l=i.magnitude||i.increment;switch(i.unit){case"week":{const o=t.getDay();return r=M.add(M.clearTime(t),o>=n?n-o:-(o-n+7),"day"),M[e](t,`${l*7} days`,r)}case"month":{t=M.asMonths(t);let o;return r?(r=M.asMonths(r),o=t+s(t-r,l)):o=s(t,l),M.monthsToDate(o)}case"quarter":return M[e](t,`${l*3} months`,r);case"year":return M[e](t,`${l*12} months`,r);case"decade":return M[e](t,`${l*10} years`,r)}i=M.as("ms",l,i.unit)}if(r){const l=M.as("ms",r.getTimezoneOffset()-t.getTimezoneOffset(),"ms");return new Date(r.valueOf()+s(M.diff(r,t,"ms")+l,i))}else{const l=t.getTimezoneOffset()*60*1e3;return new Date(s(t.valueOf()-l,i)+l)}}static parseDuration(e,t=!0,i){var r;const n=t?Tu:Ru,s=n.exec(e);if(e==null||!s)return null;const l=Iu((r=s[1])===null||r===void 0?void 0:r.replace(",",".")),o=M.parseTimeUnit(s[2])||i;return o?{magnitude:l,unit:o}:null}static parseTimeUnit(e){const t=e==null?null:M.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(let i=0;i<Kt.length;i++)if(t[i+1])return Kt[i]}static getGMTOffset(e=new Date){if(!e)return;const t=e.getTimezoneOffset();return t?(t>0?"-":"+")+Math.abs(Math.trunc(t/60)).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0"):"Z"}static fillDayNames(){const e=new Date("2000-01-01T12:00:00"),t=M._dayNames||[],i=M._dayShortNames||[];t.length=0,i.length=0;for(let r=2;r<9;r++)e.setDate(r),t.push(M.format(e,"dddd")),i.push(M.format(e,"ddd"));M._dayNames=t,M._dayShortNames=i}static getDayNames(){return M._dayNames}static getDayName(e){return M._dayNames[e]}static getDayShortNames(){return M._dayShortNames}static getDayShortName(e){return M._dayShortNames[e]}static fillMonthNames(){const e=new Date("2000-01-15T12:00:00"),t=M._monthNames||[],i=M._monthShortNames||[],r={},n={};t.length=0,i.length=0;for(let s=0;s<12;s++){e.setMonth(s);const l=M.format(e,"MMMM");t.push(l);const o=M.format(e,"MMM");i.push(o),r[l.toLowerCase()]={name:l,value:s},n[o.toLowerCase()]={name:o,value:s}}M._monthNames=t,M._monthShortNames=i,M._monthNamesIndex=r,M._monthShortNamesIndex=n}static getMonthShortNames(){return M._monthShortNames}static getMonthShortName(e){return M._monthShortNames[e]}static getMonthNames(){return M._monthNames}static getMonthName(e){return M._monthNames[e]}static set locale(e){Rt=e,Mt={},xr={},Ui={}}static get locale(){return Rt}static setupDurationRegEx(e=[],t=[]){const i=this,r={};let n="";for(let s=0;s<t.length;s++){const l=t[s],o=e[s];o.canonicalUnitName=Kt[s],r[o.single]=r[o.single.toUpperCase()]=r[o.canonicalUnitName]=r[o.canonicalUnitName.toUpperCase()]=o,n+=`${s?"|":""}(`;for(let a=0;a<l.length;a++)n+=`${l[a]}|`;if(Rt=i.localize("L{locale}")||"en-US",Rt!=="en-US"){const a=Du[s];for(let d=0;d<a.length;d++)n+=`${a[d]}|`}n+=`${o.single}|${o.plural}|${o.canonicalUnitName}|${o.canonicalUnitName}s)`}i.unitLookup=r,i.durationRegEx=new RegExp(`^(?:${n})$`)}static applyLocale(){const e=this,t=e.localize("L{unitAbbreviations}")||[],i=e.unitNames=e.localize("L{unitNames}");i!=="unitNames"&&(Rt=e.localize("L{locale}")||"en-US",Rt==="en-US"?mt=ed:mt=e.localize("L{ordinalSuffix}")||mt,xr={},Ui={},Vn={},Mt={},M._weekStartDay=null,M.setupDurationRegEx(i,t),M.fillDayNames(),M.fillMonthNames())}}T(E,"MS_PER_DAY",Ms*24);const M=E;M.useIntlFormat=ke;Te.ion({locale:"applyLocale",prio:1e3,thisObj:M});Te.locale&&M.applyLocale();E._$name="DateHelper";const{hasOwn:jn}=N,ro=1.005 .toFixed(2)==="1.01"?null:function(u,e){const t=u.toString().split("."),i=+(t[1]?t.join(".")+"1":t[0]);return u.toFixed.call(i,e)};class x extends N{static transformArrayToNamedObject(e,t="ref"){const i={};return e.forEach((r,n)=>{const s=r[t]!=null&&r[t].toString().length?r[t]:n;i[s]=r}),i}static transformNamedObjectToArray(e,t="ref"){return Object.keys(e).filter(i=>e[i]).map(i=>{const r=e[i];return r[t]=i,r})}static isEqual(e,t,i=!1){if(e===null&&t!==null||e===void 0&&t!==void 0||t===null&&e!==null||t===void 0&&e!==void 0)return!1;if(e==null&&t==null||e===t)return!0;const r=typeof e;if(r===typeof t){switch(r){case"number":case"string":case"boolean":return e===t}switch(!0){case(e instanceof Date&&t instanceof Date):return e.getTime()===t.getTime();case(Array.isArray(e)&&Array.isArray(t)):return e.length===t.length?e.every((s,l)=>Be.isEqual(s,t[l],i)):!1;case(r==="object"&&e.constructor.prototype===t.constructor.prototype):return i?Be.isDeeplyEqual(e,t,i):JSON.stringify(e)===JSON.stringify(t)}}return String(e)===String(t)}static isDeeplyEqual(e,t,i={}){if(e===t)return!0;if(!e||!t)return!1;const r=Be.keys(e,i.ignore),n=Be.keys(t,i.ignore);if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++){const l=r[s],o=n[s];if(l!==o)return!1;const a=e[l],d=t[o];if(!(i.shouldEvaluate&&i.shouldEvaluate(l,{value:a,object:e},{value:d,object:t})===!1)){if(i.evaluate){const c=i.evaluate(l,{value:a,object:e},{value:d,object:t});if(c===!1)return!1;if(c===!0)continue}if(!Be.isEqual(a,d,i))return!1}}return!0}static isPartial(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),e.indexOf(t)!==-1}static isLessThan(e,t){return e instanceof Date&&t instanceof Date?E.isBefore(e,t):e<t}static isMoreThan(e,t){return e instanceof Date&&t instanceof Date?E.isAfter(e,t):e>t}static fork(e){let t,i,r;if(e&&e.constructor===Object){t=Object.setPrototypeOf({},e);for(i in e)r=e[i],r&&(r.constructor===Object?t[i]=Be.fork(r):r instanceof Array&&(t[i]=r.slice()))}else t=e;return t}static copyProperties(e,t,i){let r,n;for(n=0;n<i.length;n++)r=i[n],r in t&&(e[r]=t[r]);return e}static copyPropertiesIf(e,t,i){if(t)for(const r of i)r in e||(e[r]=t[r]);return e}static entries(e,t){const i=[],r=typeof t=="function";if(e)for(const n in e)(r?!t(n,e[n]):!(t!=null&&t[n]))&&i.push([n,e[n]]);return i}static fromEntries(e,t){if(t=t||{},e)for(let i=0;i<e.length;++i)t[e[i][0]]=e[i][1];return t}static keys(e,t,i){const r=[],n=typeof t=="function";if(e){let s=0;for(const l in e)(n?!t(l,e[l]):!(t!=null&&t[l]))&&(r.push(i?i(l,s):l),++s)}return r}static values(e,t,i){const r=[],n=typeof t=="function";if(e){let s=0;for(const l in e)(n?!t(l,e[l]):!(t!=null&&t[l]))&&(r.push(i?i(e[l],s):e[l]),++s)}return r}static pathExists(e,t){return t.split(".").every(r=>!e||!(r in e)?!1:(e=e[r],!0))}static pathifyKeys(e){const t={};for(const i in e)if(jn(e,i))if(Array.isArray(e[i]))t[i]=e[i].slice();else if(e[i]instanceof Object){const r=this.pathifyKeys(e[i]);for(const n in r)t[`${i}.${n}`]=r[n]}else t[i]=e[i];return t}static deletePath(e,t){t.split(".").reduce((i,r,n,s)=>{if(i==null)return null;if(jn(i,r))if(n===s.length-1)delete i[r];else return i[r]},e)}static coerce(e,t){const i=N.typeOf(e),r=N.typeOf(t),n=typeof e=="string";if(i!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return n&&(!e||e==="false"||e==="0")?!1:Boolean(e);case"null":return n&&(!e||e==="null")?null:!1;case"undefined":return n&&(!e||e==="undefined")?void 0:!1;case"date":return n&&isNaN(e)?E.parse(e):Date(Number(e))}return e}static wrapProperty(e,t,i,r,n=!0){const s={};let l=Object.getPrototypeOf(e),o=Object.getOwnPropertyDescriptor(l,t);for(;!o&&l&&n;)l=Object.getPrototypeOf(l),l&&(o=Object.getOwnPropertyDescriptor(l,t));o?(o.set?s.set=a=>{o.set.call(e,a),r&&r.call(e,o.get.call(e))}:s.set=r,o.get?s.get=()=>{let a=o.get.call(e);return i&&(a=i.call(e,a)),a}:s.get=i):(s.set=a=>{e[`_${t}`]=a,r&&r.call(e,a)},s.get=()=>{let a=e[`_${t}`];return i&&(a=i.call(e,a)),a}),Object.defineProperty(e,t,s)}static hookProperty(e,t,i){const r=x.getPropertyDescriptor(i.prototype,"value"),n=x.getPropertyDescriptor(e,t),s=`_${t}`,l=class{get value(){return n?n.get.call(this):this[s]}set value(a){n?n.set.call(this,a):this[s]=a}},o=x.getPropertyDescriptor(l.prototype,"value");return Object.setPrototypeOf(i.prototype,l.prototype),Object.defineProperty(e,t,{configurable:!0,get:r.get||o.get,set:r.set||o.set}),()=>delete e[t]}static getPropertyDescriptor(e,t){let i=null;for(let r=e;r&&!i&&!jn(r,"isBase");r=Object.getPrototypeOf(r))i=Object.getOwnPropertyDescriptor(r,t);return i}static cleanupProperties(e,t=!1){return Object.entries(e).forEach(([i,r])=>{t?r===void 0&&delete e[i]:r==null&&delete e[i]}),e}static removeAllProperties(e){return Object.keys(e).forEach(t=>delete e[t]),e}static assertType(e,t,i){const r=N.typeOf(e);if(e!=null&&r!==t)throw new Error(`Incorrect type "${r}" for ${i}, expected "${t}"`)}static assertObject(e,t){Be.assertType(e,"object",t)}static assertInstance(e,t){Be.assertType(e,"instance",t)}static assertClass(e,t){Be.assertType(e,"class",t)}static assertFunction(e,t){if(typeof e!="function"||e.isBase||e.$$name)throw new Error(`Incorrect type for ${t}, got "${e}" (expected a function)`)}static assertNumber(e,t){const i=Number(e);if(typeof e!="number"||isNaN(i))throw new Error(`Incorrect type for ${t}, got "${e}" (expected a Number)`)}static assertBoolean(e,t){Be.assertType(e,"boolean",t)}static assertString(e,t){Be.assertType(e,"string",t)}static assertArray(e,t){Be.assertType(e,"array",t)}static toFixed(e,t){return ro?ro(e,t):e.toFixed(t)}static roundTo(e,t=1){return Math.round(e/t)*t}static round(e,t){if(t==null)return e;const i=10**t;return Math.round(e*i)/i}static getMapPath(e,t,i){const r=Array.isArray(t)?t:typeof t=="string"?t.split("."):[t],n=r.length===1,s=r[0],l=e.has(s)?e.get(s):e.set(s,n?i:{}).get(s);return n?l:Be.getPathDefault(l,r.slice(1),i)}}const Be=x;x._$name="ObjectHelper";const no=["border-top-width","border-right-width","border-bottom-width","border-left-width"],Lu=["margin-top","margin-right","margin-bottom","margin-left"],Pu=["padding-top","padding-right","padding-bottom","padding-left"],wt={t:"border-top-width",r:"border-right-width",b:"border-bottom-width",l:"border-left-width"},Sr={t:"padding-top",r:"padding-right",b:"padding-bottom",l:"padding-left"},Ou=Object.freeze({x:0,y:0}),Au=/^([trblc])(\d*)-([trblc])(\d*)$/i,$u=/^([trblc])(\d*)$/i,Kr=["top","right","bottom","left"],Yi={t:0,r:1,b:2,l:3},Gn=["b-t","l-r","t-b","r-l"],_u={bt:1,tb:1,lr:2,rl:2},id=Object.freeze([0,0]),Hu=["width","height"],Vr=(u,e=u,t=u,i=e)=>Array.isArray(u)?Vr.apply(null,u):[u,e,t,i];function Nu(u,e){const t=Au.exec(u),i=t[1],r=t[3],n=parseInt(t[2]||50),s=parseInt(t[4]||50),l=e&&!(Yi[i]&1)?100-n:n,o=e&&!(Yi[r]&1)?100-s:s,a=_u[i+r];return{myAlignmentPoint:i+l,myEdge:i,myOffset:l,targetAlignmentPoint:r+o,targetEdge:r,targetOffset:o,startZone:Yi[r],edgeAligned:a}}function Bu(u){return`${Kr[(Yi[u.myEdge]+2)%4][0]}${u.myOffset}-${Kr[(Yi[u.targetEdge]+2)%4][0]}${u.targetOffset}`}function Vu(u){return u==null?id:typeof u=="number"?[u,u]:u}class O{get isRectangle(){return!0}static from(e,t,i){var r,n;if(typeof e=="string"?e=document.querySelector(e):((r=e)===null||r===void 0?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host||e.ownerDocument),typeof t=="string"&&(t=document.querySelector(t)),e==null||e.isRectangle)return e;if(e=e.element||e,i===void 0&&typeof t=="boolean"&&(i=t,t=null),!((n=t)!==null&&n!==void 0&&n.isRectangle))if(t){let{scrollLeft:c,scrollTop:h}=t;W.isSafari&&t===document.body&&(c=h=0),t=O.from(t).translate(-c,-h)}else t=Ou;const s=e===document||e===globalThis,l=e===document.body&&document.body.offsetHeight===0,o=l&&e.getBoundingClientRect(),a=l?new O(o.left,o.top,o.width,document.body.parentElement.scrollHeight):s?new O(0,0,globalThis.innerWidth,globalThis.innerHeight):e.getBoundingClientRect(),d=i||s?[0,0]:[globalThis.pageXOffset,globalThis.pageYOffset];return new O(a.left+d[0]-t.x,a.top+d[1]-t.y,a.width,a.height)}static fromScreen(e,t){return O.from(e,t,!0)}static inner(e,t,i=!1){const r=this.from(e,t,i);if(document.body.contains(e)){const n=b.getStyleValue(e,no);r.x+=parseFloat(n[wt.l]),r.y+=parseFloat(n[wt.t]),r.right-=parseFloat(n[wt.r]),r.bottom-=parseFloat(n[wt.b])}return r}static content(e,t,i=!1){const r=this.from(e,t,i);if(document.body.contains(e)){const n=b.getStyleValue(e,no),s=b.getStyleValue(e,Pu);r.x+=parseFloat(n[wt.l])+parseFloat(s[Sr.l]),r.y+=parseFloat(n[wt.t])+parseFloat(s[Sr.t]),r.right-=parseFloat(n[wt.r])+parseFloat(s[Sr.r]),r.bottom-=parseFloat(n[wt.b])+parseFloat(s[Sr.b])}return r}static client(e,t,i=!1){const r=this.content(e,t,i),n=b.scrollBarWidth;let s;return n&&(e.scrollHeight>e.clientHeight&&b.getStyleValue(e,"overflow-y")!=="hidden"&&(s=parseFloat(b.getStyleValue(e,"padding-right")),r.right+=s-Math.max(s,n)),e.scrollWidth>e.clientWidth&&b.getStyleValue(e,"overflow-x")!=="hidden"&&(s=parseFloat(b.getStyleValue(e,"padding-bottom")),r.bottom+=s-Math.max(s,n))),r}static outer(e,t,i=!1){const r=this.from(e,t,i);if(document.body.contains(e)){const n=b.getStyleValue(e,Lu);r.x-=parseFloat(n["margin-left"]),r.y-=parseFloat(n["margin-top"]),r.right+=parseFloat(n["margin-right"]),r.bottom+=parseFloat(n["margin-bottom"])}return r}static union(...e){let{x:t,y:i,right:r,bottom:n}=e[0],s;if(e.length>1)for(let l=1;l<e.length;l++)s=e[l],s.x<t&&(t=s.x),s.y<i&&(i=s.y),s.right>r&&(r=s.right),s.bottom>n&&(n=s.bottom);return new O(t,i,r-t,n-i)}roundPx(e=globalThis.devicePixelRatio||1){const t=this;return t._x=b.roundPx(t._x,e),t._y=b.roundPx(t._y,e),t._width=b.roundPx(t._width,e),t._height=b.roundPx(t._height,e),t}static get $$name(){return hasOwnProperty.call(this,"$name")&&this.$name||hasOwnProperty.call(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}constructor(e,t,i,r){x.assertNumber(e,"Rectangle.x"),x.assertNumber(t,"Rectangle.y"),x.assertNumber(i,"Rectangle.width"),x.assertNumber(r,"Rectangle.height");const n=this;i<0&&(e+=i,i=-i),r<0&&(t+=r,r=-r),n._x=e,n._y=t,n._width=i,n._height=r}clone(){const e=this,t=new O(e.x,e.y,e.width,e.height);return t.isAlignRectangle=e.isAlignRectangle,t.minHeight=e.minHeight,t.minWidth=e.minWidth,t}contains(e){const t=this;return e.isRectangle?e._x>=t._x&&e._y>=t._y&&e.right<=t.right&&e.bottom<=t.bottom:!1}intersect(e,t=!1,i=!1){const r=this,n=Math.max(r.y,e.y),s=Math.min(r.right,e.right),l=Math.min(r.bottom,e.bottom),o=Math.max(r.x,e.x);return(i?l>=n&&s>=o:l>n&&s>o)?t?!0:new O(o,n,s-o,l-n):!1}equals(e,t=!1){const i=t?r=>Math.round(r):r=>r;return e.isRectangle&&i(e.x)===i(this.x)&&i(e.y)===i(this.y)&&i(e.width)===i(this.width)&&i(e.height)===i(this.height)}translate(e,t){return this._x+=e||0,this._y+=t||0,this}moveTo(e,t){return e!=null&&(this._x=e),t!=null&&(this._y=t),this}getDelta(e){return[e.x-this.x,e.y-this.y]}get center(){return new O.Point(this.x+this.width/2,this.y+this.height/2)}set x(e){const t=e-this._x;this._x=e,this._width-=t}get x(){return this._x}get start(){return this.left}set left(e){this.x=e}get left(){return this.x}set top(e){this.y=e}get top(){return this.y}set y(e){const t=e-this._y;this._y=e,this._height-=t}get y(){return this._y}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set right(e){this._width=e-this._x}get right(){return this._x+this._width}get end(){return this.right}set bottom(e){this._height=e-this._y}get bottom(){return this._y+this._height}getStart(e,t=!0){return t?e?this.right:this.left:this.top}getEnd(e,t=!0){return t?e?this.left:this.right:this.bottom}get area(){return this.width*this.height}set minWidth(e){const t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.isAlignRectangle||(t.width=Math.max(t.width,t._minWidth)))}get minWidth(){return this._minWidth}set minHeight(e){const t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.isAlignRectangle||(t.height=Math.max(t.height,t._minHeight)))}get minHeight(){return this._minHeight}adjust(e,t,i,r){const n=this;return n.x+=e,n.y+=t,n.width+=i,n.height+=r,n}inflate(e,t=e,i=e,r=t){return Array.isArray(e)&&([e,t,i,r]=Vr(e)),this.adjust(-r,-e,t,i)}deflate(e,t=e,i=e,r=t){return Array.isArray(e)&&([e,t,i,r]=Vr(e)),this.adjust(r,e,-t,-i)}constrainTo(e,t){const i=this,r=i.height,n=i.y,s=i.minWidth||i.width,l=i.minHeight||i.height;if(i.height>=e.height){if(t&&l>e.height)return!1;i._y=e.y,i.height=e.height}if(i.width>=e.width){if(t&&s>e.width)return i.y=n,i.height=r,!1;i._x=e.x,i.width=e.width}let o=i.bottom-e.bottom;return o>0&&i.translate(0,-o),o=i.right-e.right,o>0&&i.translate(-o),o=e.y-i.y,o>0&&i.translate(0,o),o=e.x-i.x,o>0&&i.translate(o),i}alignTo(e){let t=this.clone(),{target:i,constrainTo:r,constrainPadding:n}=e,s,l,o,a;if(i&&!i.isRectangle&&(i=O.from(i.element?i.element:i)),r){if(!r.isRectangle){a=r===globalThis||r===document;const H="ignorePageScroll"in e?e.ignorePageScroll:!a;r=O.from(r.element?r.element:r,null,H)}n&&(n=Vr(n),n[0]=Math.min(n[0],i.top),n[1]=Math.min(n[1],r.right-i.right),n[2]=Math.min(n[0],r.bottom-i.bottom),n[3]=Math.min(n[0],i.left),r=r.deflate.apply(r.clone(),n))}const d=this,c=Vu(e.offset),{align:h,axisLock:g,anchorSize:f,anchorPosition:m,matchSize:p,position:v,rtl:y}=e,C=Nu(h,y),w=r&&r.clone(),S=[],D=[{zone:l=C.startZone,align:h}],I=p&&Hu[C.startZone&1],R=d[I];if(I&&g?t[I]=i[I]:!C.edgeAligned&&p&&(t.width=i.width,t.height=i.height),r&&t.constrainTo(r),r&&C.startZone!=null)if(g)D.push({zone:l=(l+2)%4,align:Bu(C)}),g==="flexible"&&(D.push({zone:l=(C.startZone+1)%4,align:Gn[l]}),D.push({zone:l=(l+2)%4,align:Gn[l]}));else for(let H=1;H<4;H++)D.push({zone:l=(l+1)%4,align:Gn[l]});if(m){const H=C.startZone&1?"y":"x";s={[H]:m[H],edge:Kr[(C.startZone+2)%4]}}if(w&&i&&(w.adjust(-i.width,-i.height,i.width,i.height),i.constrainTo(w)),t.minWidth=d.minWidth,t.minHeight=d.minHeight,v)t.moveTo(v.x,v.y),r&&t.constrainTo(r);else{const H=C.myEdge==="c"||C.targetEdge==="c",L=f&&!H?[f[1]+c[0],f[1]+c[1]]:c,V=i.getAlignmentPoint(C.targetAlignmentPoint,L),U=t.getAlignmentPoint(C.myAlignmentPoint);t.translate(V[0]-U[0],V[1]-U[1]);let Y=t.intersect(i,!0);if(Y)r&&t.constrainTo(r),o=C.startZone,t.translate(...L);else if(r&&!r.contains(t)){const j=t.clone(),z=[];let Z,ne;s=null,S[0]=Z=r.clone(),Z.bottom=i.y-L[1],S[1]=Z=r.clone(),Z.x=i.right+L[0],S[2]=Z=r.clone(),Z.y=i.bottom+L[1],S[3]=Z=r.clone(),Z.right=i.x-L[0];for(let X=0;X<D.length;X++){if(I&&X==2&&(t[I]=R),Z=S[o=D[X].zone],t=t.alignTo({target:i,offsets:L,align:D[X].align}),t.constrainTo(Z,!0)&&(z.push({result:t,zone:o}),!ne||t.width<d.width||t.height<d.height)){t.align=D[X].align;break}if(!ne||Z.area>ne.area){const ie=t.clone();switch(o){case 0:ie.moveTo(null,Z.bottom-ie.height);break;case 1:ie.moveTo(Z.left);break;case 2:ie.moveTo(null,Z.top);break;case 3:ie.moveTo(Z.right-ie.width);break}ne={area:Z.area,result:ie,zone:o}}}z.length?(z.length>1&&!g&&z.sort((X,ie)=>{const ve=Math.sqrt((j.x-X.result.x)**2+(j.y-X.result.y)**2),Di=Math.sqrt((j.x-ie.result.x)**2+(j.y-ie.result.y)**2);return ve-Di}),t=z[0].result,o=z[0].zone):(t=ne.result,o=ne.zone,a&&t.constrainTo(r))}else o=C.startZone;if(t.zone=o,t.overlap=Y=t.intersect(i,!0),f&&!Y){if(!s){const j=o&1,z=j?"y":"x",Z=j?"bottom":"right",ne=Math.max(i[z],t[z]),X=Math.min(i[Z],t[Z]);let ie=ne+(X-ne)/2-f[0]/2;const ve=ie+f[0];ve>t[Z]&&(ie-=ve-t[Z]),ie<t[z]&&(ie+=t[z]-ie),s={[z]:ie-t[z],edge:Kr[(o+2)%4]}}t.anchor=s}}return t}getAlignmentPoint(e,t=id){const i=this,r=$u.exec(e),n=r[1].toLowerCase(),s=Math.min(Math.max(parseInt(r[2]||50),0),100)/100;switch(n){case"t":return[i.x+i.width*s,i.y-t[1]];case"r":return[i.right+t[0],i.y+i.height*s];case"b":return[i.x+i.width*s,i.bottom+t[1]];case"l":return[i.x-t[0],i.y+i.height*s];case"c":return[i.x+i.width/2,i.y+i.height/2]}}highlight(){const e=this,t=b.createElement({parent:document.body,style:`position:absolute;z-index:9999999;pointer-events:none;
                            left:${e.x}px;top:${e.y}px;width:${e.width}px;height:${e.height}px`});return b.highlight(t).then(()=>t.remove())}visualize(e,t){const i=this,r=x.merge({style:F({left:`${i.x}px`,top:`${i.y}px`,width:`${i.width}px`,height:`${i.height}px`,pointerEvents:"none"},e.class?{}:{position:"absolute","z-index":9999999})},e);return t?r:b.createElement(r)}toString(e=","){return[`${this.top}px`,`${this.right}px`,`${this.bottom}px`,`${this.left}px`].join(e)}}O._$name="Rectangle";const Ot=Symbol("value"),so=Symbol("length");class q{static change(e,t,i,r="string"){i=q.normalize(i,"object");const n=q.normalize(e,"array").filter(s=>!i[s]);if(t){t=q.normalize(t,"array");for(let s=0;s<t.length;++s)n.includes(t[s])||n.push(t[s])}return q.normalize(n,r)}static from(e,t){if(e){if(e.isDomClassList){var i;t=(i=t)!==null&&i!==void 0?i:!0}else{var r;t=(r=t)!==null&&r!==void 0?r:N.isObject(e)&&!N.isEmpty(e),e=new q(e)}!e.value&&!t&&(e=null)}return e||(t?new q:null)}static normalize(e,t="string"){e=e||"";const i=typeof e,r=t==="array",n=t==="object",s=!r&&!n;let l=i==="string",o,a,d;if(i==="object"){var c;e.nodeType===Element.ELEMENT_NODE&&typeof e.getAttribute=="function"?(e=e.getAttribute("class")||"",l=!0):(c=e)!==null&&c!==void 0&&c.isDomClassList?e=e.values:e instanceof DOMTokenList?e=Array.from(e):e instanceof Map?e=Array.from(e.keys()).filter(h=>e.get(h)):e instanceof Set?e=Array.from(e):Array.isArray(e)||(e=N.getTruthyKeys(e))}for(l&&(e=[...new Set(_.split(e))]),a=e.length;a-- >0;)o=e[a],o.length?o.includes(" ")&&e.splice(a,1,..._.split(o)):e.splice(a,1);if(r)d=e;else if(s)d=e.join(" ");else for(d=Object.create(null),a=0;a<e.length;++a)d[e[a]]=!0;return d}constructor(...e){this.process(1,e)}clear(){for(const e in this)this[e]=!1;return this}set(...e){return this.clear().process(1,e)}get isDomClassList(){return!0}clone(){return new q(this)}contains(e){return typeof e=="string"&&e?Boolean(this[e]):!1}toString(){return this.length?`${this.value} `:""}toJSON(){return this.toString()}trim(){return this.value}isEqual(e){const t=q.normalize(e,"array"),i=t.length;if(this.length===i){for(let r=0;r<i;r++)if(!this[t[r]])return!1;return!0}return!1}get value(){let e=this[Ot],t;return e==null&&(t=N.getTruthyKeys(this),this[so]=t.length,this[Ot]=e=t.join(" ")),e}set value(e){const t=this,i=Object.keys(t),r=i.length;for(let n=0;n<r;n++)delete t[i[n]];e?t.process(1,[e]):delete t[Ot]}get values(){return N.getTruthyKeys(this)}get length(){return this.value?this[so]:0}process(e,t){for(let i,r,n=0;n<t.length;n++)if(t[n])if(i=t[n],i.isDomClassList||N.isObject(i))for(r in i)this[r]=e?i[r]:!i[r];else for(i=q.normalize(t[n],"array"),r=0;r<i.length;++r)this[i[r]]=e;return delete this[Ot],this}assign(e){for(const t in e)!this[t]!=!e[t]&&(this[t]=e[t],delete this[Ot]);return this}assignTo(e){const t=e.nodeType===Element.ELEMENT_NODE?e.classList:e,i=q.from(t);i.add(this),t.value=i.value}add(...e){return this.process(1,e)}remove(...e){return this.process(0,e)}toggle(e,t=Boolean(!this[e])){if(t=Boolean(t),Boolean(this[e])!==t)return this[e]=t,delete this[Ot],!0}split(){return N.getTruthyKeys(this)}forEach(e){return N.getTruthyKeys(this).forEach(e)}}q.prototype[Ot]=null;q._$name="DomClassList";class pt extends O{static from(e){const t=e.changedTouches;return new pt(t?t[0].screenX:e.screenX,t?t[0].screenY:e.pageY)}constructor(e,t){super(e,t,0,0)}constrain(e){return this.x=Math.min(Math.max(this.x,e.x),e.right-1),this.y=Math.min(Math.max(this.y,e.y),e.bottom-1),this}toArray(){return[this.x,this.y]}}Object.getPrototypeOf(pt).Point=pt;pt._$name="Point";const zu=["clientX","clientY","pageX","pageY","screenX","screenY"],Wu={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1,block:1},Et=!0,lo={configurable:Et,value:!0},ju={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},Gu={Meta:1,Control:1,Alt:1},Uu={Control:"ctrl",Alt:"alt",Shift:"shift"},oo=5,Yu=/^(ctrl|shift|alt|meta)$/;class A{static normalizeEvent(e){return x.copyPropertiesIf(e,e.changedTouches[0]||e.touches[0],zu)}static getXY(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}static getDistanceBetween(e,t){const i=oe.getXY(e),r=oe.getXY(t);return Math.sqrt(Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2))}static getPagePoint(e){return new O.Point(e.pageX,e.pageY)}static getClientPoint(e){return new O.Point(e.clientX,e.clientY)}static addListener(e,t,i,r){return e.nodeType?typeof t=="string"?r=Object.assign({element:e,[t]:i},r):r=Object.assign({element:e},t):r=e,oe.on(r)}static on(e){const t=e.element,i=e.thisObj,r=[];for(const s in e)if(!Wu[s]){let l=e[s];typeof l!="object"&&(l={handler:l});const o=l.element||t;W.isTouchDevice&&!W.isAndroid&&s==="contextmenu"&&r.push(oe.addElementListener(o,"touchstart",{handler:oe.createContextMenuWrapper(l.handler,l.thisObj||i)},e)),r.push(oe.addElementListener(o,s,l,e))}const n=()=>{for(let s,l=0;l<r.length;l++)s=r[l],oe.removeEventListener(s[0],s[1],s[2]);r.length=0};return i&&e.autoDetach!==!1&&(i.doDestroy=pe.createInterceptor(i.doDestroy,n,i)),n}static addElementListener(e,t,i,r){const n=oe.createHandler(e,t,i,r),{spec:s}=n,l=i.expires||r.expires,o=s.capture!=null||s.passive!=null?{capture:s.capture,passive:s.passive}:void 0;if(e.addEventListener(t,n,o),l){const a=i.thisObj||r.thisObj,d=a!=null&&a.isDelayable?a:globalThis,{alt:c}=l,h=c?l.delay:l,{spec:g}=n;g.expires=l,g.timerId=d[typeof h=="number"?"setTimeout":"requestAnimationFrame"](()=>{g.timerId=null,oe.removeEventListener(e,t,n),c&&!n.called&&(typeof c=="string"?a[c]:c).call(a)},h,`listener-timer-${performance.now()}`)}return[e,t,n,o]}static getComposedPathTarget(e){return e.composedPath()[0]||e.path[0]}static fixEvent(e){var t,i;if(e.fixed)return e;const{type:r,target:n}=e;if((n!=null&&n.shadowRoot||n!=null&&(t=n.getRootNode)!==null&&t!==void 0&&t.call(n).host)&&e.composedPath){const s=this.getComposedPathTarget(e),l=n;Object.defineProperty(e,"target",{value:s,configurable:Et}),Object.defineProperty(e,"originalTarget",{value:l,configurable:Et})}if(Object.defineProperty(e,"fixed",lo),r.startsWith("key")){const s=ju[e.key];s&&Object.defineProperty(e,"key",{value:s,configurable:Et}),e.key===" "&&!e.code&&Object.defineProperty(e,"code",{value:"Space",configurable:Et})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",lo),n&&"offsetX"in e&&(Object.getOwnPropertyDescriptor(e,"borderOffsetX")||Object.defineProperty(e,"borderOffsetX",{get:()=>e.offsetX+(W.isSafari?0:parseInt(n.ownerDocument.defaultView.getComputedStyle(n).getPropertyValue("border-left-width")))}),Object.getOwnPropertyDescriptor(e,"borderOffsetY")||Object.defineProperty(e,"borderOffsetY",{get:()=>e.offsetY+(W.isSafari?0:parseInt(n.ownerDocument.defaultView.getComputedStyle(n).getPropertyValue("border-top-width")))})),n?.nodeType===Element.DOCUMENT_NODE&&"clientX"in e){const s=b.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{value:s,configurable:Et})}if(n?.nodeType===Element.TEXT_NODE){const s=e.target.parentElement;Object.defineProperty(e,"target",{value:s,configurable:Et})}if(((i=e.relatedTarget)===null||i===void 0?void 0:i.nodeType)===Element.TEXT_NODE){const s=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{value:s,configurable:Et})}return r.startsWith("touch")&&e.touches.length&&this.normalizeEvent(e),e}static createHandler(e,t,i,r){const n=i.delay||r.delay,s=i.throttled||r.throttled,l=i.block||r.block,o="once"in i?i.once:r.once,a="capture"in i?i.capture:r.capture,d="passive"in i?i.passive:r.passive,c="delegate"in i?i.delegate:r.delegate,h=i.handler,g=i.expires,f=i.thisObj||r.thisObj,{rtlSource:m=f}=f||{};let p=(v,...y)=>{oe.playingDemo&&v.isTrusted||f!=null&&f.isDestroyed||(v=oe.fixEvent(v,m?.rtl),p.called=!0,(typeof h=="string"?f[h]:h).call(f,v,...y),delete v.target,delete v.relatedTarget,delete v.originalarget,delete v.key,delete v.code,delete v.ctrlKey,delete v.fixed)};if(l){const v=p;let y,C;p=(w,...S)=>{const D=performance.now();(!y||w.target!==C||D-y>l)&&(C=w.target,y=D,v(w,...S))}}if(n!=null){const v=p,y=f!=null&&f.setTimeout?f:globalThis;p=(...C)=>{y.setTimeout(()=>{v(...C)},n)}}if(s!=null){let v,y=s;s.buffer&&(v=C=>s.alt.call(oe,oe.fixEvent(C,m?.rtl)),y=s.buffer),f!=null&&f.isDelayable?p=f.throttle(p,{delay:y,throttled:v}):p=pe.createThrottled(p,y,f,null,v)}if(o){const v=p;p=(...y)=>{oe.removeEventListener(e,t,p),v(...y)}}if(c){const v=p;p=(y,...C)=>{var w;y=oe.fixEvent(y,m?.rtl);const S=((w=y.target.closest)===null||w===void 0?void 0:w.call)&&y.target.closest(c);!S||(Object.defineProperty(y,"currentTarget",{get:()=>S,configurable:!0}),v(y,...C))}}return i.thisObj&&i.autoDetach!==!1&&(f.doDestroy=pe.createInterceptor(f.doDestroy,()=>oe.removeEventListener(e,t,p),f)),p.spec={delay:n,throttled:s,block:l,once:o,thisObj:f,capture:a,expires:g,passive:d,delegate:c},p}static removeEventListener(e,t,i){const{expires:r,timerId:n,thisObj:s,capture:l}=i.spec;r!=null&&r.alt&&n&&(s!=null&&s.isDelayable?s:globalThis)[typeof r.delay=="number"?"clearTimeout":"cancelAnimationFrame"](n),e.removeEventListener(t,i,l)}static onTransitionEnd({element:e,animationName:t,property:i,handler:r,mode:n=t?"animation":"transition",duration:s=b[`get${n==="transition"?"Property":""}${_.capitalize(n)}Duration`](e,i),thisObj:l=globalThis,args:o=[],timerSource:a,runOnDestroy:d}){let c;a=a||(l.isDelayable?l:globalThis);const h=[e,i,...o],g=()=>{f(),l.isDestroyed||(l.callback?l.callback(r,l,h):r.apply(l,h))},f=oe.on({element:e,[`${n}end`]({animationName:m,propertyName:p,target:v}){v===e&&(p===i||m!=null&&m.match(t))&&(c&&(a.clearTimeout(c),c=null),g())}});return s!=null&&(c=a.setTimeout(g,s+50,"onTransitionEnd",d)),f}static async waitForTransitionEnd(e){return new Promise(t=>{e.handler=t,A.onTransitionEnd(e)})}static createContextMenuWrapper(e,t){return i=>{if(i.touches.length===1){if(i.target.closest("[data-feature]"))return;const r=i.touches[0],n=setTimeout(()=>{l();const o=new MouseEvent("contextmenu",r);Object.defineProperty(o,"target",{get(){return r.target}}),typeof e=="string"&&(e=t[e]),o.browserEvent=i,e.call(t,o),oe.contextMenuTouchId=r.identifier},oe.longPressTime),s=({clientX:o,clientY:a,type:d})=>{let c=d==="touchend"||d==="pointerup";if(!c){const h=Math.abs(o-r.clientX),g=Math.abs(a-r.clientY);c=h>=oo||g>=oo}c&&(oe.contextMenuTouchId=null,l(),clearTimeout(n))},l=oe.on({element:document,touchmove:s,touchend:s,pointermove:s,pointerup:s,capture:!0})}}}static createDblClickWrapper(e,t,i){let r,n,s;return()=>{n||(n=oe.on({element:e,touchstart:l=>{r=l.changedTouches[0].identifier,l.preventDefault()},touchend:l=>{if(l.changedTouches[0].identifier===r){l.preventDefault(),clearTimeout(s),r=n=null;const o=O.from(l.changedTouches[0].target,null,!0),a=l.changedTouches[0].pageX-o.x,d=l.changedTouches[0].pageY-o.y,c=Object.assign({browserEvent:l},l),h=new MouseEvent("dblclick",c);Object.defineProperties(h,{target:{value:l.target},offsetX:{value:a},offsetY:{value:d}}),typeof t=="string"&&(t=i[t]),t.call(i,h)}},once:!0}),s=setTimeout(()=>{n(),r=n=null},oe.dblClickTime))}}static toSpecialKey(e,t="ctrlKey"){let i=!1;return e===!0?i=t:typeof e=="string"&&(e=e.toLowerCase(),e.match(Yu)&&(i=`${e}Key`)),i}static specialKeyFromEventKey(e){return Uu[e]||""}}T(A,"eventNameMap",{mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseover:"MouseOver",mouseout:"MouseOut",keyup:"KeyUp",keydown:"KeyDown",keypress:"KeyPress"});const oe=A;oe.longPressTime=500;oe.dblClickTime=300;oe.globalListenerDetacher=oe.on({element:document,capture:!0,passive:!0,pointerdown({target:u}){var e;const t=b.getRootElement(u);b.usingKeyboard=!1,(e=t.classList)===null||e===void 0||e.remove("b-using-keyboard"),b.removeClsGlobally(t,"b-using-keyboard")},keydown({target:u,key:e}){if(!Gu[e]){b.usingKeyboard=!0;const t=b.getRootElement(u);t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Array.from(t.children).forEach(i=>{i.matches(".b-outer")&&i.classList.add("b-using-keyboard")}):t.classList.add("b-using-keyboard")}}});W.isTouchDevice&&oe.on({element:document,touchmove:u=>{u.target.closest(".b-dragging")&&u.preventDefault()},passive:!1,capture:!0});A._$name="EventHelper";const qu=14,Ku={align:"t0-t0"},Fi=Node.ELEMENT_NODE,Er=Node.TEXT_NODE,{isObject:Xu}=x,rd=/[+-]?\d*\.?\d+[eE]?-?\d*/g,nt=rd.source,Ju=new RegExp(`matrix\\((?:${nt}),\\s?(?:${nt}),\\s?(?:${nt}),\\s?(?:${nt}),\\s?(${nt}),\\s?(${nt})`),Qu=new RegExp("matrix3d\\((?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(-?\\d*),\\s?(-?\\d*)"),Tr=new RegExp(`(?:${Ju.source})|(?:${Qu.source})`),Zu=new RegExp(`translate(3d|X)?\\((${nt})px(?:,\\s?(${nt})px)?`),eh=new RegExp(`translate(3d|Y)?\\((${nt})px(?:,\\s?(${nt})px)?`),th=/\s+/,ih=/\s*;\s*/,rh=/\s*:\s*/,nh=/^-?((\d+(\.\d*)?)|(\.?\d+))$/,sh="$bryntum",lh={elementData:"",for:"htmlFor",retainElement:""},oh={tag:1,html:1,text:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,class:1,className:1,unmatched:1,onlyChildren:1,listeners:1,compareHtml:1,syncOptions:1,keepChildren:1},ao={length:1,parentRule:1,style:1},ah={INPUT:1,TEXTAREA:1},dh={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,BODY:1},zr=globalThis,be=document,ch=Object.freeze({}),Un=Array.prototype.slice,uh=Promise.resolve(),hh=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],fh=u=>u._hidden,gh=u=>u.parentNode||u.host,mh=(u,e,t)=>t.key==="children"?x.mergeItems(u,e,t):x.blend(u,e,t),Fs=u=>{const e=u.ownerDocument.defaultView.getComputedStyle(u);return e.getPropertyValue("display")!=="none"&&e.getPropertyValue("visibility")!=="hidden"},ph=be.documentElement.getRootNode?u=>u.getRootNode():u=>{for(;u.parentNode;)u=u.parentNode;return u},vh=u=>u.host&&u.host instanceof Element,Dt=u=>u&&(u===be.body||Boolean(u.offsetParent)||(u.ownerDocument.defaultView&&"offsetParent"in u&&b.getStyleValue(u,"position")!=="fixed"?u.offsetParent:Dt(u.parentNode))),si=u=>u&&(be.body.contains(u)||(Yn=ph(u))&&vh(Yn)&&si(Yn.host)),co=u=>u instanceof Node?u:typeof u=="string"?P.createElementFromTemplate(u):P.createElement(u),Bi=Object.create(null),nd=(u,e)=>{const t=Bi[u]||[_.hyphenate(u),e];return Bi[u]||(Bi[t[0]]=Bi[u]=t),t},bh=u=>u.ownerSVGElement?u.ownerSVGElement.parentNode:u.offsetParent,yh=/b-slide-in-from-\w+/;["top","right","bottom","left","width","height","maxWidth","maxHeight","minWidth","minHeight","borderSpacing","borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","letterSpacing","lineHeight","outlineWidth","textIndent","wordSpacing"].forEach(u=>nd(u,!0));let Vi=null,Ch=0,Lt=null,Yn,qn,uo,ho;class b{static async slideIn(e,t=1){const i=`b-slide-in-${t>0?"next":"previous"}`,{classList:r}=e,{style:n}=e.parentNode,{overflow:s,overflowX:l,overflowY:o}=n;n.overflow="hidden",r.add(i),await A.waitForTransitionEnd({element:e,animationName:yh}),n.overflow=s,n.overflowX=l,n.overflowY=o,r.remove(i)}static isFocusable(e,t=!1){if(!t&&(!P.isVisible(e)||P.Widget.fromElement(e,fh)))return!1;const i=e.nodeName;return dh[i]||(i==="A"||i==="LINK")&&!!e.href||e.getAttribute("tabIndex")!=null||e.contentEditable==="true"}static isEditable(e){return e.isContentEditable||ah[e.nodeName]}static isInView(e,t=!1,i){if(!Dt(e))return!1;const r=i?.positioned&&b.getStyleValue(i.element,"position")!=="fixed",n=O.from(globalThis),s=t?"contains":"intersect",l=r&&i.element.offsetParent,o=r&&O.from(l);if(n.height=be.scrollingElement.scrollHeight,e===be.body)return n;const a=this.getViewportIntersection(e,n,s);return a&&r&&a.translate(be.scrollingElement.scrollLeft,be.scrollingElement.scrollTop),r&&a?a.translate(-o.x+l.scrollLeft,-o.y+l.scrollTop):a}static getViewportIntersection(e,t,i){const{parentNode:r}=e,{parentElement:n}=r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.getRootNode().host:e,s=n.ownerDocument.defaultView.getComputedStyle(n),l=s.overflowX!=="visible"||s.overflowY!=="visible",o=bh(e);let a=O.from(e,null,!0);for(let d=l?e.parentNode:o;a&&d!==be.documentElement;d=d.parentNode){d.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&d.host&&(d=d.host.parentNode);const c=d===be.body,h=d.ownerDocument.defaultView.getComputedStyle(d),g=c?t:O.inner(d,null,!0);(c||h.overflow!=="visible")&&(a=g[i](a,!1,!0))}return a}static isVisible(e){const t=e.ownerDocument;for(;e;e=gh(e)){if(e===t)return!0;if(e.nodeType===e.ELEMENT_NODE&&!Fs(e))return!1}return!1}static isDOMEvent(e){return e instanceof Event}static merge(e,...t){return x.blend(e,t,{merge:mh})}static normalizeChildren(e,t,i){var r;let n=e?.children,s,l,o,a,d;if(e!=null&&(r=e.syncOptions)!==null&&r!==void 0&&r.ignoreRefs&&(i=!0),n&&!(e instanceof Node))if(Array.isArray(n))for(l=0;l<n.length;++l)P.normalizeChildren(n[l],t,i);else{a=n,e.children=n=[];for(o in a){var c;s=a[o],(c=s)!==null&&c!==void 0&&c.isWidget&&(s=s.element),d=!o.startsWith("$")&&!P.isElement(s),d&&t?.(o,!i),s&&(s instanceof Node||(s.reference===!1?delete s.reference:d&&typeof s!="string"&&(s.reference=o),P.normalizeChildren(s,t,i)),n.push(s))}}return e}static roundPx(e,t=globalThis.devicePixelRatio||1){const i=1/t;return Math.round(e/i)*i}static floorPx(e,t=globalThis.devicePixelRatio||1){const i=1/t;return Math.floor(e*i)/i}static isCustomElement(e){return Boolean(e?.shadowRoot)}static elementFromPoint(e,t){let i=document.elementFromPoint(e,t);return P.isCustomElement(i)&&(i=i.shadowRoot.elementFromPoint(e,t)||i),i}static childFromPoint(e,t,i,r=e){const n=i==null?t:new O(t,i,0,0);let s=null;return Array.from(e.children).some(l=>{if(O.from(l,r).contains(n))return s=l.children.length&&P.childFromPoint(l,n,null,r)||l,!0}),s}static unitize(e,t,i="px"){const[r,n]=nd(e);return t!=null&&(t=String(t),t=n&&nh.test(t)?t+i:t),[r,t]}static get activeElement(){let e=document.activeElement;for(;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}static getActiveElement(e){var t,i;(t=e)!==null&&t!==void 0&&t.isWidget&&(e=e.element);let r=(((i=e)===null||i===void 0?void 0:i.getRootNode())||document).activeElement;for(;(n=r)!==null&&n!==void 0&&n.shadowRoot;){var n;r=r.shadowRoot.activeElement}return r}static getRootElement(e){var t;const i=(t=e.getRootNode)===null||t===void 0?void 0:t.call(e),{nodeType:r}=i;return r===Node.DOCUMENT_NODE?i.body:r===Node.DOCUMENT_FRAGMENT_NODE?i:e.ownerDocument.contains(e)?e.ownerDocument.body:null}static getOutermostElement(e){var t,i;const r=(t=(i=e).getRootNode)===null||t===void 0?void 0:t.call(i);if(r!=null&&r.body)return r?.body;for(;e.parentNode!==r&&e.parentNode;)e=e.parentNode;return e}static isValidFloatRootParent(e){return e===document.body||e.constructor.name==="ShadowRoot"}static getId(e){return e.id||(e.id="b-element-"+ ++Ch)}static getCommonAncestor(e,t){if(e===t)return e;for(;e&&!((i=(r=e)[e.isWidget?"owns":"contains"])!==null&&i!==void 0&&i.call(r,t)||e===t);){var i,r;e=e.owner||e.parentNode}return e}static getElement(e){return e instanceof Element?e:be.querySelector(e)}static setAttributes(e,t){const i=P.getElement(e);if(i&&t)for(const r in t)t[r]==null?i.removeAttribute(r):i.setAttribute(r,t[r])}static setLength(e,t,i){if(arguments.length===1){var r;i=typeof e=="number"?`${e}px`:(r=e)!==null&&r!==void 0?r:""}else{var n;e=P.getElement(e),i=e.style[t]=typeof i=="number"?`${i}px`:(n=i)!==null&&n!==void 0?n:""}return i}static percentify(e,t=2){const i=Math.pow(10,t);return e==null||e===""||isNaN(e)?"":`${Math.round(e*i)/i}%`}static getChild(e,t){return e.querySelector(":scope>"+t)}static hasChild(e,t){return P.getChild(e,t)!=null}static children(e,t){return(t[0]===">"||t.startsWith("# "))&&(t[0]==="#"&&(t=t.substr(2)),t=":scope "+t),Array.from(e.querySelectorAll(t))}static getChildElementCount(e){return e.childElementCount}static down(e,t){return e?e.matches&&e.matches(t)?e:(t=":scope "+t,e.querySelector(t)):null}static isDescendant(e,t){const i=P.getRootElement(e),r=P.getRootElement(t);return r&&i!==r&&r.host?P.isDescendant(i,r.host):e.contains(t)}static getEventElement(e,t="target"){return!e||P.isElement(e)?e:e[t]}static isElement(e){return e?.nodeType===document.ELEMENT_NODE&&P.isNode(e)}static isReactElement(e){return e?.$$typeof===Symbol.for("react.element")}static isNode(e){return Boolean(e)&&typeof e.nodeType=="number"&&!Xu(e)}static forEachSelector(e,t,i){if(typeof e=="string")throw new Error("DomHelper.forEachSelector must provide a root element context (for shadow root scenario)");P.children(e,t).forEach(i)}static forEachChild(e,t){Array.from(e.children).forEach(t)}static removeEachSelector(e,t){P.forEachSelector(e,t,i=>i.remove())}static removeClsGlobally(e,...t){t.forEach(i=>P.forEachSelector(e,"."+i,r=>r.classList.remove(i)))}static isOrphaned(e){return!si(e)}static up(e,t){return re.deprecate("Core","6.0.0","DomHelper.up() deprecated, use native `element.closest()` instead"),e.closest(t)}static getAncestor(e,t,i=null){let r=!1,n,s=e;for(t=B.asArray(t);s=s.parentElement;){if(t.includes(s)){r=!0;break}if(i&&s===i)break;n=s}return r?n||e:null}static getParents(e){const t=[];for(;e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}static makeValidId(e,t=""){return _.makeValidDomId(e,t)}static createElement(e={},t){var i,r,n;let s=t,l,o,a,d,c,h,g,f,m,p,v;if(typeof s=="boolean")throw new Error("Clean up");t&&(c=t.ignoreRefs,m=t.refOwner,p=t.refs,s=t.returnAll,v=t.syncIdField,c&&(a=!0,c=c!=="children")),typeof e.parent=="string"&&(e.parent=document.getElementById(e.parent));const y=e.parent||e.nextSibling&&e.nextSibling.parentNode,{dataset:C,html:w,reference:S,syncOptions:D,text:I}=e;if(D&&(v=D.syncIdField||v,d=D.ignoreRefs,d&&(a=!0,c=d!=="children",t=F(F({},t),{},{ignoreRefs:!0}))),c&&(m=null),e.ns?l=be.createElementNS(e.ns,e.tag||"svg"):l=be.createElement(e.tag||"div"),I!=null?P.setInnerText(l,I):w!=null&&(w instanceof DocumentFragment?l.appendChild(w):l.innerHTML=w),e.tooltip&&P.Widget.attachTooltip(l,e.tooltip),e.style&&P.applyStyle(l,e.style),C)for(g in C)f=C[g],f!=null&&(l.dataset[g]=f);y&&this.addChild(y,l,e.nextSibling),m&&(l.$refOwnerId=m.id),S&&!c&&(m?(l.$reference=S,m.attachRef(S,l,e)):(p||(t=Object.assign({},t),t.refs=p={}),p[S]=l,l.setAttribute("data-reference",S)));const R=e.className||e.class,H=Object.keys(e);for(R&&l.setAttribute("class",q.normalize(R)),o=0;o<H.length;++o)g=H[o],f=e[g],(h=lh[g])!=null?l[h||g]=f:!oh[g]&&g&&f!=null&&l.setAttribute(g,f);return!e["aria-hidden"]&&!e.role&&!e.tabIndex&&!b.isFocusable(l,!0)&&!l.htmlFor&&l.setAttribute("role","presentation"),(i=t)===null||i===void 0||(r=i.callback)===null||r===void 0||r.call(i,{action:"newElement",domConfig:e,targetElement:l,syncId:m?S:t.syncIdField&&((n=e.dataset)===null||n===void 0?void 0:n[t.syncIdField])}),s===!0?t.returnAll=s=[l]:Array.isArray(s)&&s.push(l),e.children&&(v&&(l.syncIdMap={}),e.children.forEach(L=>{if(L)if(typeof L=="string"){const j=document.createTextNode(L);m&&(j.$refOwnerId=m.id),l.appendChild(j)}else if(isNaN(L.nodeType)){var V,U,Y;L.parent=l,!L.ns&&e.ns&&(L.ns=e.ns);const j=P.createElement(L,F(F({},t),{},{ignoreRefs:(V=(U=e.syncOptions)===null||U===void 0?void 0:U.ignoreRef)!==null&&V!==void 0?V:a})),z=(Y=L.dataset)===null||Y===void 0?void 0:Y[v];z!=null&&(l.syncIdMap[z]=j),delete L.parent}else l.appendChild(L)})),l.lastDomConfig=e,p||s||l}static createElementFromTemplate(e,t=ch){const{array:i,raw:r,fragment:n}=t;let s;if(P.supportsTemplate){if((qn||(qn=be.createElement("template"))).innerHTML=e,s=qn.content,n)return s.cloneNode(!0)}else if(s=(uo||(uo=new DOMParser)).parseFromString(e,"text/html").body,n){const l=s.childNodes;for(s=document.createDocumentFragment();l.length;)s.appendChild(l[0]);return s}return r?s=s.childNodes:s=s.children,s.length===1&&!i?s[0]:Un.call(s)}static triggerMouseEvent(e,t="contextmenu"){const i=this.isInView(e),r=i||O.from(e),n=r.center,s=new MouseEvent(t,{clientX:n.x,clientY:n.y,bubbles:!0});e.dispatchEvent(s)}static insertFirst(e,t){return t&&t.nodeType!==Fi&&t.tag&&(t=P.createElement(t)),e.insertBefore(t,e.firstElementChild)}static insertBefore(e,t,i){return t&&t.nodeType!==Fi&&t.tag&&(t=P.createElement(t)),i?e.insertBefore(t,i):P.insertFirst(e,t)}static insertAt(e,t,i){const r=Array.from(e.children);if(i>=r.length)return P.append(e,t);const n=r[i];return P.insertBefore(e,t,n)}static append(e,t){if(t.forEach){if(Array.isArray(t)&&(t=t.map(i=>co(i))),e.append)e.append(...t);else{const i=document.createDocumentFragment();t.forEach(function(r){i.appendChild(r)}),e.appendChild(i)}return t}else return e.appendChild(co(t))}static getTranslateX(e){const t=e.style.transform;let i=Zu.exec(t);return i?parseFloat(i[2]):(i=Tr.exec(t)||Tr.exec(P.getStyleValue(e,"transform")),i?parseFloat(i[1]||i[3]):0)}static getTranslateY(e){const t=e.style.transform;let i=eh.exec(t);if(i){const r=parseFloat(i[i[1]==="Y"?2:3]);return isNaN(r)?0:r}else return i=Tr.exec(t)||Tr.exec(P.getStyleValue(e,"transform")),i?parseFloat(i[2]||i[4]):0}static getTranslateXY(e){return[P.getTranslateX(e),P.getTranslateY(e)]}static getOffsetX(e,t=null){return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}static getOffsetY(e,t=null){return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}static getOffsetXY(e,t=null){return[P.getOffsetX(e,t),P.getOffsetY(e,t)]}static focusWithoutScrolling(e){function t(r){r.forEach(({element:n,scrollLeft:s,scrollTop:l})=>{n.scrollLeft!==s&&(n.scrollLeft=s),n.scrollTop!==l&&(n.scrollTop=l)})}if(!W.isSafari)e.focus({preventScroll:!0});else{const r=P.getParents(e),n=r.map(s=>({element:s,scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}));e.focus(),setTimeout(()=>t(n),0)}}static getPageX(e){return e.getBoundingClientRect().left+zr.pageXOffset}static getPageY(e){return e.getBoundingClientRect().top+zr.pageYOffset}static getExtremalSizePX(e,t){const i=_.hyphenate(t),r=i.split("-")[1];let n=P.getStyleValue(e,i);return/%/.test(n)?e.parentElement?n=parseInt(P.getStyleValue(e.parentElement,r),10):n=NaN:n=parseInt(n,10),n}static setScale(e,t,i=t){const r=P.getStyleValue(e,"transform").split(/,\s*/);r.length>1?(r[0].startsWith("matrix3d")?(r[0]=`matrix3d(${t}`,r[5]=i):(r[0]=`matrix(${t}`,r[3]=i),e.style.transform=r.join(",")):e.style.transform=`scale(${t}, ${i})`}static setTranslateX(e,t){const i=P.getStyleValue(e,"transform").split(/,\s*/);t=P.roundPx(t),i.length>1?(i[i[0].startsWith("matrix3d")?12:4]=t,e.style.transform=i.join(",")):e.style.transform=`translateX(${t}px)`}static setTranslateY(e,t){const i=P.getStyleValue(e,"transform").split(/,\s*/);t=P.roundPx(t),i.length>1?(i[i[0].startsWith("matrix3d")?13:5]=t,e.style.transform=i.join(",")+")"):e.style.transform=`translateY(${t}px)`}static setTop(e,t){P.setLength(e,"top",t)}static setLeft(e,t){P.setLength(e,"left",t)}static setTopLeft(e,t,i){P.setLength(e,"top",t),P.setLength(e,"left",i)}static setRect(e,{x:t,y:i,width:r,height:n}){P.setTopLeft(e,i,t),P.setLength(e,"width",r),P.setLength(e,"height",n)}static setTranslateXY(e,t,i){if(t==null)return P.setTranslateY(e,i);if(i==null)return P.setTranslateX(e,t);t=P.roundPx(t),i=P.roundPx(i);const r=P.getStyleValue(e,"transform").split(/,\s*/),n=r[0].startsWith("matrix3d");r.length>1?(r[n?12:4]=t,r[n?13:5]=i,e.style.transform=r.join(",")+")"):e.style.transform=`translate(${t}px, ${i}px)`}static addTranslateX(e,t){P.setTranslateX(e,P.getTranslateX(e)+t)}static addTranslateY(e,t){P.setTranslateY(e,P.getTranslateY(e)+t)}static addLeft(e,t){P.setLeft(e,P.getOffsetX(e)+t)}static addTop(e,t){P.setTop(e,P.getOffsetY(e)+t)}static alignTo(e,t,i=Ku,r){t=t instanceof O?t:O.from(t,!0);const n=P.getTranslateXY(e),s=O.from(e,!0);r&&(s.roundPx(),t.roundPx());const l=s.alignTo(Object.assign(i,{target:t}));P.setTranslateXY(e,n[0]+l.x-s.x,n[1]+l.y-s.y)}static getStyleValue(e,t,i,r){const n=i?e.style:e.ownerDocument.defaultView.getComputedStyle(e,r);if(Array.isArray(t)){const s={};for(const l of t)s[l]=n.getPropertyValue(_.hyphenate(l));return s}return n.getPropertyValue(_.hyphenate(t))}static getEdgeSize(e,t,i){const r=t==="border"?"-width":"",n={raw:{}};for(const s of["top","right","bottom","left"])(!i||i.includes(s[0]))&&(n[s]=parseFloat(n.raw[s]=P.getStyleValue(e,`${t}-${s}${r}`)));return n.width=(n.left||0)+(n.right||0),n.height=(n.top||0)+(n.bottom||0),n}static parseStyle(e){if(typeof e=="string"){const t=e.split(ih);e={};for(let i=0,{length:r}=t;i<r;i++){const n=t[i].split(rh);e[n[0]]=n[1]}}return e||{}}static applyStyle(e,t,i=!1){if(typeof t=="string")i?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else if(t){i&&(e.style.cssText=""),t.style&&typeof t.style!="string"&&(t=x.assign({},t,t.style));let r,n;for(r in t)ao[r]||([r,n]=P.unitize(r,t[r]),n==null?e.style.removeProperty(r):e.style.setProperty(r,n));typeof t.style=="string"&&(e.style.cssText+=t.style)}}static getCSSText(e){if(typeof e=="string")return e;let t="";for(const i in e)ao[i]||(t+=`${_.hyphenate(i)}:${e[i]};`);return t}static addClasses(e,t){re.deprecate("Core","6.0.0","DomHelper.addClasses should be replaced by native classList.add"),e.classList.add(...t)}static removeClasses(e,t){re.deprecate("Core","6.0.0","DomHelper.removeClasses should be replaced by native classList.remove"),e.classList.remove(...t)}static toggleClasses(e,t,i=null){t=B.asArray(t),i===!0?e.classList.add(...t):i===!1?e.classList.remove(...t):t.forEach(r=>e.classList.toggle(r))}static addTemporaryClass(e,t,i,r=globalThis){i>0&&(e.classList.add(t),r.setTimeout({fn:n=>e.classList.remove(n),delay:i,name:t,args:[t],cancelOutstanding:!0}))}static getPropertyTransitionDuration(e,t){const i=globalThis.getComputedStyle(e),r=i.transitionProperty.split(", "),n=i.transitionDuration.split(", "),s=r.indexOf(_.hyphenate(t));let l;return s!==-1&&(l=parseFloat(n[s])*1e3),l}static getAnimationDuration(e){return parseFloat(P.getStyleValue(e,"animation-duration"))*1e3}static highlight(e,t=globalThis){return e instanceof O?e.highlight():new Promise(i=>{t.setTimeout(()=>{e.classList.add("b-fx-highlight"),t.setTimeout(()=>{e.classList.remove("b-fx-highlight"),i()},1e3)},0)})}static get scrollBarWidth(){if(Vi===null&&be.body){const e=ho||(ho=P.createElement({parent:be.body,style:"position:absolute;top:-9999em;height:100px;overflow-y:scroll"}));e.parentNode!==be.body&&be.body.appendChild(e),Vi=e.offsetWidth}return Vi}static get scrollBarPadElement(){return{className:"b-yscroll-pad",children:[{className:"b-yscroll-pad-sizer"}]}}static resetScrollBarWidth(){Vi=null}static measureText(e,t,i=!1,r=void 0){const n=P.getMeasureElement(t,r);n[i?"innerHTML":"innerText"]=e;const s=n.clientWidth;return n.className="",s}static measureSize(e,t,i=!0){if(!e)return 0;if(typeof e=="number")return e;if(!e.length)return 0;if(/^\d+(px)?$/.test(e))return parseInt(e);if(t){const r=P.getMeasureElement(t);r.innerHTML="",r.style.width=P.setLength(e);const n=i?r.offsetWidth:r.getBoundingClientRect().width;return r.style.width=r.className="",n}return/^\d+em$/.test(e)?parseInt(e)*qu:isNaN(e)?0:parseInt(e)}static getMeasureElement(e,t=be.body){const i=zr.getComputedStyle(e),r=t.offScreenDiv=t.offScreenDiv||P.createElement({parent:t,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},{returnAll:!0})[1];return hh.forEach(n=>{r.style[n]!==i[n]&&(r.style[n]=i[n])}),r.className=e.className,r.parentElement.parentElement!==t&&t.appendChild(r.parentElement),r}static stripTags(e){return(P.$domParser||(P.$domParser=new DOMParser)).parseFromString(e,"text/html").body.textContent}static sync(e,t){if(typeof e=="string")if(e===""){t.innerHTML="";return}else e=P.createElementFromTemplate(e);return P.performSync(e,t),t}static performSync(e,t){return e.outerHTML!==t.outerHTML?(P.syncAttributes(e,t),P.syncContent(e,t),P.syncChildren(e,t),!0):!1}static getSyncAttributes(e){const t={},i=[];for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];if(n.specified){const s=n.name.toLowerCase();t[s]=n.value,i.push(s)}}return{attributes:t,names:i}}static syncAttributes(e,t){const{attributes:i,names:r}=P.getSyncAttributes(e),{attributes:n,names:s}=P.getSyncAttributes(t),l=r.includes("dataset"),o=r.filter(c=>!s.includes(c)),a=s.filter(c=>!r.includes(c)&&(!l||!c.startsWith("data-"))),d=r.filter(c=>s.includes(c));if(o.length>0)for(let c=0;c<o.length;c++){const h=o[c];h==="style"?P.applyStyle(t,i.style,!0):h==="dataset"?Object.assign(t.dataset,i.dataset):t.setAttribute(h,i[h])}if(a.length>0)for(let c=0;c<a.length;c++)t.removeAttribute(a[c]);if(d.length>0)for(let c=0;c<d.length;c++){const h=d[c];if(h==="style")P.applyStyle(t,i.style,!0);else if(h==="dataset")Object.assign(t.dataset,i.dataset);else if(h==="class"&&(i.class.isDomClassList||typeof i.class=="object")){let g;i.class.isDomClassList?g=i.class:g=new q(i.class),g.isEqual(n.class)||t.setAttribute("class",g)}else n[h]!==i[h]&&t.setAttribute(h,i[h])}}static syncContent(e,t){P.getChildElementCount(e)===0&&(t.innerText=e.innerText)}static setInnerText(e,t){const{firstChild:i}=e;i?.nodeType===Element.TEXT_NODE?i.data=t:e.textContent=t}static syncChildren(e,t){const i=this,r=Un.call(e.childNodes),n=Un.call(t.childNodes);for(;r.length;){const s=r.shift(),l=n.shift();if(s&&s.nodeType!==Er&&s.nodeType!==Fi)throw new Error(`Source node type ${s.nodeType} not supported by DomHelper.sync()`);if(l&&l.nodeType!==Er&&l.nodeType!==Fi)throw new Error(`Target node type ${l.nodeType} not supported by DomHelper.sync()`);if(!l)t.appendChild(s);else if(s.nodeType===l.nodeType)s.nodeType===Er?l.data=s.data:s.tagName===l.tagName?i.performSync(s,l):(t.insertBefore(s,l),l.remove());else if(s.nodeType===Er&&l.nodeType===Fi)t.innerText=s.data.trim();else{const o=s.parentElement||s;throw new Error(`Currently no support for transforming nodeType.
${o.outerHTML}`)}}n.forEach(s=>{s.remove()})}static syncClassList(e,t){const{classList:i}=e,r=typeof t=="string",n=r?t.split(th):q.normalize(t,"array"),s=n.length;let l=i.length!==s,o;for(o=0;!l&&o<s;o++)l=!i.contains(n[o]);return l&&(e.className=r?t:n.join(" ")),l}static updateClassList(e,t){const{classList:i}=e;let r,n,s=!1;for(r in t)n=Boolean(t[r]),i.contains(r)!==n&&(i[n?"add":"remove"](r),s=!0);return s}static setTheme(e,t){e=e.toLowerCase();const{head:i}=document,r=P.getThemeInfo(t).name.toLowerCase();let n=i.querySelectorAll("[data-bryntum-theme]:not([data-loading])"),s=0;if(r===e)return uh;P.removeEachSelector(i,"#bryntum-theme[data-loading],link[data-bryntum-theme][data-loading]");const l={theme:e,prev:r};function o(a,d,c){const h=b.createElement({tag:"link",rel:"stylesheet",dataset:{loading:!0,bryntumTheme:!0},href:a.href.replace(r,e),nextSibling:a});h.addEventListener("load",()=>{delete h.dataset.loading,Lt=null,++s===n.length&&(n.forEach(g=>g.remove()),te.trigger("theme",l),d(l))}),h.addEventListener("error",g=>{delete h.dataset.loading,c(g)})}if(n.length)return new Promise((a,d)=>{n.forEach((c,h)=>{o(c,a,d,h===n.length-1)})});{const a=i.querySelector("#bryntum-theme:not([data-loading])")||i.querySelector(`[href*="${r}.css"]:not([data-loading])`);if(!(a!=null&&a.href.includes(`${r}.css`)))throw new Error(`Theme link for ${r} not found`);return n=[a],new Promise((d,c)=>o(a,d,c))}}static get themeInfo(){return b.getThemeInfo()}static getThemeInfo(e){if(!Lt){const t=P.createElement({parent:document.body,className:"b-theme-info"}),i=P.getStyleValue(t,"content",!1,":before");if(i)try{Lt=JSON.parse(i.replace(/^["']|["']$|\\/g,""))}catch{Lt=null}Lt=Lt||(e?{name:e}:null),t.remove()}return Lt}static async transition({element:e,selector:t="[data-dom-transition]",duration:i,action:r,thisObj:n=this,addTransition:s={},removeTransition:l={}}){const o=new Set,a=Array.from(e.querySelectorAll(t)),d=new Map(a.map(f=>{let m=0,p=f.parentElement;for(;p&&p!==e;)m++,p=p.parentElement;f.$depth=m,f.scrollHeight>f.offsetHeight&&getComputedStyle(f).overflow==="auto"&&(f.$scrollTop=f.scrollTop,o.add(f));const{parentElement:v}=f,y=O.from(f,e),C=O.from(f,v),w=getComputedStyle(v),S=parseFloat(w.borderLeftWidth);return S&&(y.left-=S,C.left-=S),[f.id,{element:f,globalBounds:y,localBounds:C,depth:m,parentElement:v}]}));r.call(n);const c=Array.from(e.querySelectorAll(t)),h=new Map(c.map(f=>{const m=O.from(f,e),p=O.from(f,f.parentElement),v=globalThis.getComputedStyle(f.parentElement),y=parseFloat(v.borderLeftWidth);return y&&(m.left-=y,p.left-=y),[f.id,{element:f,globalBounds:m,localBounds:p}]})),g=["position","top","left","width","height","padding","margin","zIndex","minWidth","minHeight","opacity","overflow"];for(const[f,m]of d){const p=h.get(f);if(p){const{element:v}=p,{style:y,parentElement:C}=v,w=parseInt(P.getStyleValue(v,"zIndex")),{globalBounds:S,localBounds:D,depth:I,parentElement:R}=m,H=R!==C;x.copyProperties(v.$initial={parentElement:C},y,g);let L;H?(p.bounds=p.globalBounds,L=S,e.appendChild(v)):(p.bounds=p.localBounds,L=D,R.appendChild(v));let V="hidden";o.has(v)&&(v.$scrollPlaceholder=P.createElement({parent:v,style:{height:v.scrollHeight}}),V="auto"),Object.assign(y,{position:"absolute",top:`${L.top}px`,left:`${L.left}px`,width:`${L.width}px`,height:`${L.height}px`,minWidth:0,minHeight:0,padding:0,margin:0,zIndex:I+(w||0),overflow:V}),p.processed=!0}else{const{element:v,localBounds:y,depth:C,parentElement:w}=m;v.$initial={removed:!0},Object.assign(v.style,{position:"absolute",top:`${y.top}px`,left:`${y.left}px`,width:`${y.width}px`,height:`${y.height}px`,minWidth:0,minHeight:0,padding:0,margin:0,zIndex:C,overflow:"hidden"}),w.appendChild(v),h.set(f,{element:v,bounds:y,removed:!0,processed:!0}),c.push(v)}}for(const[,f]of h)if(!f.processed){const{element:m}=f,{style:p,parentElement:v}=m,y=f.bounds=f.localBounds;m.classList.add("b-dom-transition-adding"),x.copyProperties(m.$initial={parentElement:v},p,g),Object.assign(p,{position:"absolute",top:s.top?0:`${y.top}px`,left:s.left?0:`${y.left}px`,width:s.width?0:`${y.width}px`,height:s.height?0:`${y.height}px`,opacity:s.opacity?0:null,zIndex:v.$depth+1,overflow:"hidden"})}for(const f of o)f.scrollTop=f.$scrollTop;e.classList.add("b-dom-transition"),e.firstElementChild.offsetWidth;for(const[,{element:f,bounds:m,removed:p}]of h)p?Object.assign(f.style,{top:l.top?0:`${m.top}px`,left:l.left?0:`${m.left}px`,width:l.width?0:`${m.width}px`,height:l.height?0:`${m.height}px`,opacity:l.opacity?0:f.$initial.opacity}):Object.assign(f.style,{top:`${m.top}px`,left:`${m.left}px`,width:`${m.width}px`,height:`${m.height}px`,opacity:f.$initial.opacity});await Qa.sleep(i),e.classList.remove("b-dom-transition");for(const f of c)f.$initial&&(f.$initial.removed?f.remove():(x.copyProperties(f.style,f.$initial,g),f.$scrollPlaceholder&&(f.$scrollPlaceholder.remove(),delete f.$scrollPlaceholder),f.classList.remove("b-dom-transition-adding"),f.$initial.parentElement.appendChild(f)));for(const f of o)f.scrollTop=f.$scrollTop,delete f.$scrollTop}static async loadScript(e){return new Promise((t,i)=>{const r=document.createElement("script");r.src=e,r.onload=t,r.onerror=i,document.head.appendChild(r)})}static isNamedColor(e){return e&&!/^(#|hsl|rgb|hwb)/.test(e)}static get NodeFilter(){return NodeFilter}static addChild(e,t,i){e.insertBefore(t,i)}}const P=b;let fo;const wh=()=>P.isTouchEvent=!1,sd=()=>{P.isTouchEvent=!0,clearTimeout(fo),fo=setTimeout(wh,400)};be.addEventListener("touchstart",sd,!0);be.addEventListener("touchend",sd,!0);P.canonicalStyles=Bi;P.supportsTemplate="content"in be.createElement("template");P.elementPropKey=sh;P.numberRe=rd;if(!("children"in Node.prototype)){const u=e=>e.nodeType===e.ELEMENT_NODE;Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,u)}})}Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(u){const e=(this.document||this.ownerDocument).querySelectorAll(u);let t=e.length;for(;--t>=0&&e.item(t)!==this;);return t>-1});zr.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(u){let e=this;if(!be.documentElement.contains(e))return null;do{if(e.matches(u))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===e.ELEMENT_NODE);return null}:Node.prototype.closest=function(u){var e;return(e=this.parentNode)===null||e===void 0?void 0:e.closest(u)};(function(u){u.forEach(function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})})([Element.prototype,CharacterData.prototype,DocumentType.prototype]);globalThis.addEventListener("resize",()=>Vi=null);b._$name="DomHelper";const xh=u=>u.floating,gt=new class extends $.mixin(Me){suspendFocusEvents(){Rr=!0}resumeFocusEvents(){Rr=!1}setupFocusListenersOnce(u,e){u&&!gt.observedElements.has(u)&&(gt.setupFocusListeners(u,e),gt.observedElements.add(u))}setupFocusListeners(u=document,e,t=!1){var i;const r={element:u,touchstart(n){!xt&&n.changedTouches.length===1?xt=n.changedTouches[0]:xt=null},touchend:{handler:n=>{xt&&(xt.identifier===e.contextMenuTouchId?(n.stopImmediatePropagation(),n.preventDefault()):n.changedTouches.length===1&&n.changedTouches[0].identifier===xt.identifier&&gt.trigger("globaltap",{event:n}),xt=null)},passive:!1},mousedown:{handler:n=>{Dr="mouse",xt||gt.trigger("globaltap",{event:n}),Xt=n;const s=n.ctrlKey||n.altKey||n.shiftKey||n.metaKey;!Oe&&s?Oe=new KeyboardEvent("keydown",{key:n.ctrlKey?"Control":n.shiftKey?"Shift":n.altKey?"Alt":"Meta",ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey,metaKey:n.metaKey}):Oe&&!s&&(Oe=null)},passive:!1},mouseup(){Xt=null},keydown(n){Dr="key",Oe=n},keypress(){Dr="key"},keyup(){Oe=null},focusin(n){const{Widget:s}=gt;if(s.resetFloatRootScroll(),Rr)return;const l=n.relatedTarget?n.relatedTarget instanceof HTMLElement?n.relatedTarget:document.body:null,o=n.target||document.body,a=s.fromElement(l),d=s.fromElement(o),c=b.getCommonAncestor(a,d),h=!!(l&&o.compareDocumentPosition(l)&4),g=s.query(Sh);let f=null;if(o&&o!==document.body?f=b.getActiveElement(o):f=b.getActiveElement(document),g&&!g._isRevertingFocus&&(!d||!g.owns(d)&&!(g.element.compareDocumentPosition(d.element)&4&&d.up(xh))))return g.focus();let m=Kn("focusout",l,n.target,a,d,h);for(let C=a,w;C&&C!==c;C=w)if(w=C.owner,!C.isDestroying&&C.onFocusOut&&(C.onFocusOut(m),n.target&&f!==b.getActiveElement(n.target)))return;if(c&&n.target===c.element)!c.isDestroying&&b.getActiveElement(c)===o&&c.focusElement&&c.focusElement!==c.element&&(!c.element.contains(f)||c.focusDescendant)&&c.setTimeout(()=>{var C;return(C=c.focus)===null||C===void 0?void 0:C.call(c)},0);else{m=Kn("focusin",o,l,a,d,h);for(let C=d;C&&C!==c;C=C.owner)if(!C.isDestroying){var p,v;(p=(v=C).onFocusIn)===null||p===void 0||p.call(v,m)}}const y=b.getCommonAncestor(l?.nodeType===Element.ELEMENT_NODE?l:null,o)||o.parentNode;y&&(m=Kn("focusmove",o,l,a,d,h,{bubbles:!0}),y.dispatchEvent(m))},focusout(n){if(!Rr&&(!n.relatedTarget||!gt.Widget.fromElement(n.relatedTarget))){const s=n.relatedTarget&&n.relatedTarget instanceof HTMLElement?n.relatedTarget:null;r.focusin({target:s,relatedTarget:n.target}),Oe=Xt=null}},blur:{element:window,handler(n){n.target===window&&(Oe=null,Xt=null)}},capture:!0,passive:!0};t&&((i=go)===null||i===void 0||i()),go=this.detachEvents=e.on(r)}get lastInteractionType(){return Dr}get shiftKeyDown(){var u;return(u=Oe)===null||u===void 0?void 0:u.shiftKey}get ctrlKeyDown(){var u,e;return((u=Oe)===null||u===void 0?void 0:u.ctrlKey)||((e=Oe)===null||e===void 0?void 0:e.metaKey)}get altKeyDown(){var u;return(u=Oe)===null||u===void 0?void 0:u.altKey}isKeyDown(u){var e;return u?((e=Oe)===null||e===void 0?void 0:e.key)===u||Oe[u?.toLowerCase()+"Key"]===!0:Boolean(Oe)}isMouseDown(u=0){var e;return((e=Xt)===null||e===void 0?void 0:e.button)===u}get currentMouseDown(){return Xt}get currentKeyDown(){return Oe}},Sh=u=>u.isVisible&&u.isTopModal;gt.observedElements=new Set;let xt,Rr=!1,Dr,Oe,Xt,go;function Kn(u,e,t,i,r,n,s){const l=new CustomEvent(u,s);return Object.defineProperty(l,"_target",{get(){return e}}),Object.defineProperty(l,"relatedTarget",{get(){return t}}),l.fromWidget=i,l.toWidget=r,l.backwards=n,l}var te=gt;function Eh(u,e){const t=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(u),e);return t&&(t.get||t.set)?t:null}class ee extends $.mixin(Me,zt){static get configurable(){return{clientListeners:null,disabled:!1,client:null,keyMap:null}}updateClient(e){this.owner||(this.owner=e)}updateKeyMap(e){const{client:t}=this;t.keyMap=t.mergeKeyMaps(t.keyMap,e,_.uncapitalize(this.constructor.$name))}static initPlugins(e,...t){const i=e.plugins||(e.plugins={});for(const r of t)i[r.$$name]=new r(e)}get enabled(){return!this.disabled}getFocusRevertTarget(){var e;return(e=this.client)===null||e===void 0?void 0:e.getFocusRevertTarget()}construct(...e){const t=this;let[i,r]=e,n;e.length===1?x.isObject(i)&&(r=i,i=r.client):(r=x.assign({},r),delete r.client),t.client=i,super.construct(r),t.applyPluginConfig(i),n=t.clientListeners,n&&(n=x.assign({},n),n.thisObj=t,i.ion(n))}applyPluginConfig(e){const t=this,i=t.pluginConfig||t.constructor.pluginConfig;if(i){const{assign:r,chain:n,after:s,before:l,override:o}=i;r&&t.applyAssign(e,r),(n||s)&&t.applyChain(e,n||s),l&&t.applyChain(e,l,!1),o&&t.applyOverride(e,o)}}applyAssign(e,t){t.forEach(i=>this.assign(e,i))}applyChain(e,t,i=!0){if(Array.isArray(t))for(const r of t)this.chain(e,r,r,i);else for(const r in t)this.chain(e,r,t[r],i)}applyOverride(e,t){const i=this;i.overridden||(i.overridden={}),t.forEach(r=>{if(!i[r])throw new Error(`Trying to chain fn ${e.$$name}#${r}, but plugin fn ${i.$$name}#${r} does not exist`);typeof e[r]=="function"&&(i.overridden[r]=e[r].bind(e)),e[r]=i[r].bind(i)})}assign(e,t){const i=this,r=Eh(i,t);r?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:r.get&&r.get.bind(i),set:r.set&&r.set.bind(i)}):e[t]=i[t].bind(i)}chain(e,t,i,r=!0){let n=0;typeof t=="object"&&(t=t.fn),typeof i=="object"&&(n=i.prio||0,i=i.fn);const s=this,l=e.pluginFunctionChain||(e.pluginFunctionChain={}),o=s[i]&&s[i].bind(s),a=s.functionChainRunner;if(!o)throw new Error(`Trying to chain fn ${e.$$name}#${i}, but plugin fn ${s.$$name}#${i} does not exist`);if(!l[t]){let d=e[t];d&&(d=d.bind(e),d.$this=e,d.$prio=0),l[t]=d?[d]:[],e[t]=(...c)=>a(l[t],c)}o.$this=s,o.$prio=n,l[t][r?"push":"unshift"](o),l[t].$sorted=!1}functionChainRunner(e,t){let i,r,n;for(e.$sorted||(e.sort((s,l)=>l.$prio-s.$prio),e.$sorted=!0),r=0;r<e.length&&(i=e[r],!(!i.$this.isDestroyed&&(n=i(...t),n===!1)));r++);return n}doDisable(e){const t=this,{constructor:i}=t,r="featureClass"in i?i.featureClass:`b-${i.$$name.toLowerCase()}`;if(r){var n,s;(n=t.client)===null||n===void 0||(s=n.element)===null||s===void 0||s.classList[e?"remove":"add"](r)}t.isConfiguring||(e?t.trigger("disable"):t.trigger("enable"))}updateDisabled(e){this.doDisable(e)}throwOverrideIsMissing(e){throw new Error(`Trying to override fn ${e.plugIntoName}#${e.fnName}, but plugin fn ${e.pluginName}#${e.fnName} does not exist`)}get rootElement(){return this.client.rootElement}}T(ee,"$name","InstancePlugin");ee._$name="InstancePlugin";var ld=u=>class extends(u||$){static get $name(){return"Pluggable"}get plugins(){return this._plugins||(this._plugins={}),this._plugins}set plugins(t){t&&(Array.isArray(t)||(t=[t]),ee.initPlugins(this,...t)),this.initPlugins()}initPlugins(){}addPlugins(...t){ee.initPlugins(this,...t)}hasPlugin(t){return this.getPlugin(t)!=null}getPlugin(t){var i;return typeof t=="function"&&(t=t.$$name),(i=this.plugins)===null||i===void 0?void 0:i[t]}get widgetClass(){}};const{defineProperty:ks}=Reflect;let Xr;W.isBrowserEnv?Xr=globalThis.performance:Xr={now(){return new Date().getTime()}};let we=null;if(re.isTestEnv){const u=globalThis.bryntum||(globalThis.bryntum={});we=u.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,idleCallbacks:new Map,isEmpty(e=!1){return we.timeouts.size+we.animationFrames.size+we.idleCallbacks.size+(e?we.intervals.size:0)===0},getFiltered({ignoreTimeouts:e=[],maxDelay:t=5e3,includeIntervals:i=!1}){const r=[],n=["timeouts","animationFrames","idleCallbacks"];i&&n.push("intervals");for(const s of n){const l=we[s];for(const[,o]of l.entries())!e.includes(o.name)&&(!Number.isInteger(o.delay)||o.delay<t)&&r.push(o)}return r}}}const ki=(u,e,t,i)=>{const r=typeof e=="string",n=i?.appendArgs||[],s=()=>{t.timerId=null,t.lastCallTime=Xr.now();const l=t.args;t.args=null,r?u[e](...l,...n):e.call(u,...l,...n),t.called=!0,++t.calls};return i&&(u=i.thisObj||u),t.lastCallTime=-9e9,t.calls=0,t.invoker=s,s.wrapFn=t,s},Mr=(u,e,t="clearTimeout")=>(e.cancel=()=>{e.isPending&&(u[t](e.timerId),e.args=e.timerId=null)},e.flush=()=>{e.isPending&&(u[t](e.timerId),e.timerId=null,e.invoker())},e.now=(...i)=>{e.cancel(),e.args=i,e.invoker()},e.resume=i=>{const r=e.suspended;e.suspended=i||r<1?0:r-1},e.suspend=()=>{++e.suspended},e.immediate=!1,e.suspended=0,e.timerId=null,ks(e,"isPending",{get(){return e.timerId!==null}}),e);var Se=u=>class extends(u||$){static get $name(){return"Delayable"}static get declarable(){return["delayable"]}doDestroy(){const t=this;super.doDestroy(),t.timeoutIds&&(t.timeoutIds.forEach((i,r)=>{var n;typeof i=="function"&&i(),clearTimeout(r),(n=we)===null||n===void 0||n.timeouts.delete(r)}),t.timeoutIds=null),t.timeoutMap&&(t.timeoutMap.forEach((i,r)=>clearTimeout(r)),t.timeoutMap=null),t.intervalIds&&(t.intervalIds.forEach(i=>{var r;clearInterval(i),(r=we)===null||r===void 0||r.intervals.delete(i)}),t.intervalIds=null),t.animationFrameIds&&(t.animationFrameIds.forEach(i=>{var r;cancelAnimationFrame(i),(r=we)===null||r===void 0||r.animationFrames.delete(i)}),t.animationFrameIds=null),t.idleCallbackIds&&(t.idleCallbackIds.forEach(i=>{var r;cancelIdleCallback(i),(r=we)===null||r===void 0||r.idleCallbacks.delete(i)}),t.idleCallbackIds=null)}hasTimeout(t){var i;return Boolean((i=this.timeoutMap)===null||i===void 0?void 0:i.has(t))}setTimeout({fn:t,delay:i,name:r,runOnDestroy:n,cancelOutstanding:s,args:l}){var o;(arguments.length>1||typeof arguments[0]=="function")&&([t,i,r,n]=arguments),typeof t=="string"?r=t:r||(r=t.name||t),s&&this.clearTimeout(r);const a=this,d=a.timeoutIds||(a.timeoutIds=new Map),c=a.timeoutMap||(a.timeoutMap=new Map),h=setTimeout(()=>{var g;typeof t=="string"&&(t=a[r]),d?.delete(h),c?.delete(r),(g=we)===null||g===void 0||g.timeouts.delete(h),t.apply(a,l)},i);return d.set(h,n?t:!0),(o=we)===null||o===void 0||o.timeouts.set(h,{fn:t,delay:i,name:r}),r&&c.set(r,h),h}clearTimeout(t){var i,r;let n=t;if(typeof n=="string")if(this.timeoutMap)n=this.timeoutMap.get(t),this.timeoutMap.delete(t);else return;clearTimeout(n),(i=this.timeoutIds)===null||i===void 0||i.delete(n),(r=we)===null||r===void 0||r.timeouts.delete(n)}clearInterval(t){var i,r;clearInterval(t),(i=this.intervalIds)===null||i===void 0||i.delete(t),(r=we)===null||r===void 0||r.intervals.delete(t)}setInterval(t,i,r){var n;const s=setInterval(t,i);return(this.intervalIds||(this.intervalIds=new Set)).add(s),(n=we)===null||n===void 0||n.intervals.set(s,{fn:t,delay:i,name:r}),s}requestAnimationFrame(t,i=[],r=this){var n;const s=this.animationFrameIds||(this.animationFrameIds=new Set),l=requestAnimationFrame(()=>{var o;(o=we)===null||o===void 0||o.animationFrames.delete(l),s.delete(l)&&t.apply(r,i)});return s.add(l),(n=we)===null||n===void 0||n.animationFrames.set(l,{fn:t,extraArgs:i,thisObj:r}),l}requestIdleCallback(t,i=[],r=this){var n;const s=this.idleCallbackIds||(this.idleCallbackIds=new Set),l=requestIdleCallback(()=>{var o;(o=we)===null||o===void 0||o.idleCallbacks.delete(l),s.delete(l)&&t.apply(r,i)});return s.add(l),(n=we)===null||n===void 0||n.idleCallbacks.set(l,{fn:t,extraArgs:i,thisObj:r}),l}createOnFrame(t,i=[],r=this,n){let s;const l=(...o)=>{s!=null&&n&&(this.cancelAnimationFrame(s),s=null),s==null&&(s=this.requestAnimationFrame(()=>{typeof t=="string"&&(t=r[t]),s=null,o.push(...i),t.apply(r,o)}))};return l.cancel=()=>this.cancelAnimationFrame(s),l}cancelAnimationFrame(t){var i,r;cancelAnimationFrame(t),(i=this.animationFrameIds)===null||i===void 0||i.delete(t),(r=we)===null||r===void 0||r.animationFrames.delete(t)}cancelIdleCallback(t){var i,r;cancelIdleCallback(t),(i=this.idleCallbackIds)===null||i===void 0||i.delete(t),(r=we)===null||r===void 0||r.idleCallbacks.delete(t)}async nextAnimationFrame(){return new Promise(t=>this.requestAnimationFrame(t))}buffer(t,i){let r=i;i&&typeof i!="number"?r=i.delay:i=null;const n=(...l)=>{if(n.suspended)return;const{delay:o}=n;n.cancel(),n.called=!1,n.args=l,n.immediate||!o?s():n.timerId=this.setTimeout(s,o)},s=ki(this,t,n,i);return n.delay=r,Mr(this,n)}raf(t,i){let r=i;i&&typeof i!="boolean"?r=i.cancelOutstanding:i=null;const n=(...l)=>{n.suspended||(n.cancelOutstanding&&n.cancel(),n.called=!1,n.args=l,n.immediate?s():n.isPending||(n.timerId=this.requestAnimationFrame(s)))},s=ki(this,t,n,i);return n.cancelOutstanding=r,Mr(this,n,"cancelAnimationFrame")}idle(t,i){let r=i;i&&typeof i!="boolean"?r=i.cancelOutstanding:i=null;const n=(...l)=>{n.suspended||(n.cancelOutstanding&&n.cancel(),n.called=!1,n.args=l,n.immediate?s():n.isPending||(n.timerId=this.requestIdleCallback(s)))},s=ki(this,t,n,i);return n.cancelOutstanding=r,this.setTimeout(()=>this.idleCallbackIds.delete(n.timerId)&&n.now(),100),Mr(this,n,"cancelIdleCallback")}throttle(t,i){let r=i,n;i&&typeof i!="number"?(r=i.delay,n=i.throttled):i=null;const s=this,l=(...a)=>{if(l.suspended)return;const{delay:d}=l,c=Xr.now()-l.lastCallTime;l.args=a,l.immediate||c>=d?(s.clearTimeout(l.timerId),o()):(l.isPending||(l.timerId=s.setTimeout(o,d-c),l.called=!1),n&&(n.wrapFn.args=a,n()))},o=ki(s,t,l,i);return l.delay=r,n&&(n=ki(s,n,()=>{},i)),Mr(s,l)}static setupDelayable(t){t.setupDelayableMethods(t.delayable)}static setupDelayableMethods(t,i=null){const r=this,n=t.static,s=i||r.prototype;n&&delete t.static;for(const l in t){let o=t[l];const a=l+"Now",d=typeof o;s[a]||(s[a]=s[l]),d==="number"?o={type:"buffer",delay:o}:d==="string"&&(o={type:o}),ks(s,l,{get(){const c=this[o.type]((...h)=>{this[a](...h)},o);return ks(this,l,{value:c}),c}})}}get widgetClass(){}};class tr{get data(){return Object.create(null)}get keys(){return[]}clear(){}getItem(e){return null}removeItem(e){}setItem(e,t){}}tr._$name="StateStorage";const od=()=>Object.create(null),mo=(u,e=0)=>{const t=[],i=localStorage.length;for(let r,n=0;n<i;++n)r=localStorage.key(n),r.startsWith(u)&&t.push(r.slice(e));return t},Th=class extends tr{constructor(u){super(),this.prefix=u.prefix||""}get isLocal(){return!0}get data(){const u=od(),e=this.keys;for(const t of e)u[t]=this.getItem(t);return u}get keys(){return mo(this.prefix,this.prefix.length)}clear(){const u=mo(this.prefix);for(const e of u)localStorage.removeItem(e)}getItem(u){const e=localStorage.getItem(this.prefix+u);return e===null?e:JSON.parse(e)}removeItem(u){return localStorage.removeItem(this.prefix+u)}setItem(u,e){return localStorage.setItem(this.prefix+u,JSON.stringify(e))}},Rh=class extends tr{constructor(){super(),this.clear()}get isMemory(){return!0}get data(){return x.clone(this._data)}get keys(){return Object.keys(this._data)}clear(){this._data=od()}getItem(u){return u in this._data?this._data[u]:null}removeItem(u){delete this._data[u]}setItem(u,e){this._data[u]=e}},ad=new tr,Xn={local:Th,memory:Rh};class ui extends $.mixin(Se,Me){static get $name(){return"StateProvider"}static get configurable(){return{prefix:"bryntum-state:",storage:"local"}}static get delayable(){return{writeStatefuls:50}}static get instance(){return this._instance}static set instance(e){e==null?e=dd:((typeof e=="string"||x.isClass(e)||e instanceof tr)&&(e={storage:e}),x.isObject(e)&&(e=new ui(e))),this._instance=e}static setup(e){return this.instance=e,this.instance}doDestroy(){self.writeStatefuls.flush(),super.doDestroy()}get data(){return this.storage.data}set data(e){if(!e)this.clear();else for(const t in e)this.setValue(t,e[t])}clear(){return this.storage.clear(),this}changeStorage(e){if(e==null)e=ad;else{if(typeof e=="string"){if(!Xn[e])throw new Error(`Invalid storage type "${e}" (expected one of: "${Object.keys(Xn).join('", "')}")`);e=Xn[e]}x.isClass(e)&&(e=new e(this))}return e}saveStateful(e,t){(this.pendingSaves||(this.pendingSaves=[])).push([e,t]),this.writeStatefuls()}writeStatefuls(){const e=this,{pendingSaves:t}=e,i=t?.length,r=[],n=[];if(e.pendingSaves=null,i){for(let s,l,o,a=0;a<i;++a)[l,s]=t[a],!l.isDestroying&&l.isSaveStatePending&&(o=l.saveState(F(F({},s),{},{immediate:!0})),o&&(r.push(o),n.push(l)));r.length&&e.trigger("save",{stateIds:r,saved:n})}}getValue(e){return this.writeStatefuls.flush(),this.storage.getItem(e)}setValue(e,t){const i=this,{storage:r}=i,n=i.getValue(e);return t!=null?(r.setItem(e,t),i.trigger("set",{key:e,value:t,was:n})):n!==null&&(r.removeItem(e),i.trigger("remove",{key:e,was:n})),i}}const dd=new ui({storage:ad});ui._instance=dd;ui._$name="StateProvider";const Dh=/boolean|number|string/;var Bs=u=>{var e;return e=class extends(u||$){afterConstruct(){super.afterConstruct(),this.loadState()}finalizeInit(){this.loadState(),super.finalizeInit()}get isStateful(){return!0}get isStatefulActive(){return!this.statefulSuspended&&!this.isResponsivePending&&!this.isResponsiveUpdating}get state(){return this._state=this.getState()}set state(i){this._state=i,i&&this.applyState(i)}updateStatefulEvents(i){const r=this,n={name:"statefulEvents",thisObj:r};if(r.detachListeners(n.name),i&&(typeof i=="string"?i=_.split(i):Array.isArray(i)||(i=x.getTruthyKeys(i)),i.length)){var s;for(const l of i)n[l]="onStatefulEvent";(s=r.ion)===null||s===void 0||s.call(r,n)}}get statefulId(){const i=this,{responsiveState:r}=i;let n=i.stateId;return n==null&&i.hasGeneratedId===!1&&i.stateful!==!1&&(n=i.id),n&&r&&(n=`${n}[${r}]`),n}get statefulness(){const{stateful:i}=this;return Array.isArray(i)?x.createTruthyKeys(i):i}get stateProvider(){return this._stateProvider||ui.instance}applyState(i){i=this.pruneState(i),i&&this.setConfig(i)}getState(){const i=this,{statefulness:r}=i;let n=null,s,l;if(r){n={};for(s in r)if(r[s]){var o,a;if(l=i[s],(o=l)!==null&&o!==void 0&&o.isStateful)l=l.state;else if(l===((a=i.initialConfig)===null||a===void 0?void 0:a[s])||!Dh.test(typeof l))continue;n[s]=l}}return n}loadState(i,r){typeof i=="boolean"&&(r=i,i=null);const n=this,{statefulLoaded:s}=n;if(n.isStatefulActive&&(r||!s)){const l=n.loadStatefulData(i||(i=n.statefulId));!s&&i&&(n.defaultState=n.state,n.statefulLoaded=!0),l&&(n.state=l)}}loadStatefulData(i){var r;return i=this.isStatefulActive?i||this.statefulId:null,i&&((r=this.stateProvider)===null||r===void 0?void 0:r.getValue(i))}resetDefaultState(){this.defaultState&&(this.state=this.defaultState)}resumeStateful(i=!1){this.statefulSuspended=i?0:Math.max(this.statefulSuspended-1,0)}saveState(i){typeof i=="string"?i={id:i}:i=i||{};const r=this,{stateProvider:n}=r,s=i.id||r.isStatefulActive&&r.statefulId;if(s&&n)return i.immediate?(r.isSaveStatePending=!1,n.setValue(s,r.state)):r.isSaveStatePending||(r.isSaveStatePending=!0,n.saveStateful(r,i)),s}suspendStateful(){++this.statefulSuspended}onConfigChange({name:i,value:r,was:n,config:s}){if(super.onConfigChange({name:i,value:r,was:n,config:s}),!this.isConstructing&&this.isStatefulActive&&this.statefulId){const{stateful:l}=this;(Array.isArray(l)?l.includes(i):l?.[i])&&this.saveState()}}onStatefulEvent(){this.isConstructing||this.saveState()}pruneState(i){const{statefulness:r}=this;if(r){const n={};for(const s in i)r[s]&&(n[s]=i[s]);i=n}return i}get widgetClass(){}},T(e,"$name","State"),T(e,"configurable",{stateful:null,statefulEvents:{$config:{merge:"classList"},value:["stateChange"]},stateId:null,stateProvider:null}),T(e,"prototypeProperties",{statefulLoaded:!1,statefulSuspended:0}),e};const po=x.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null)),Mh={string:1,number:1};var ir=u=>class extends(u||$){static get $name(){return"Identifiable"}static get declarable(){return["identifiable"]}static get configurable(){return{id:""}}static setupIdentifiable(t,i){const{identifiable:r}=t;r.idMap=Object.create(null),Reflect.defineProperty(t,"identifiable",{get(){return r}})}doDestroy(){this.constructor.unregisterInstance(this),super.doDestroy()}changeId(t){return(this.hasGeneratedId=!t)?this.generateAutoId():t}updateId(t,i){const r=this,n=r.constructor;i&&n.unregisterInstance(r,i),(!r.hasGeneratedId||n.identifiable.registerGeneratedId!==!1)&&n.registerInstance(r,t)}generateAutoId(){return this.constructor.generateId(`b-${this.$$name.toLowerCase()}-`)}static get all(){return Object.values(this.identifiable.idMap)}static generateId(t="generatedId"){return t+(po[t]=(po[t]||0)+1)}static registerInstance(t,i=t.id){const{idMap:r}=this.identifiable;if(i in r&&!this.disableThrow)throw new Error("Id "+i+" already in use");r[i]=t}static unregisterInstance(t,i=t.id){const{idMap:r}=this.identifiable;Mh[typeof t]?delete r[t]:r[i]===t&&delete r[i]}static getById(t){const i=this.identifiable.idMap;if(i)return i[t]}static get registeredInstances(){const t=this.identifiable.idMap;return t?Object.values(t):[]}};const vo=Symbol("STM_PROP"),Jn={parentIndex:1};var Ih=u=>class extends(u||$){static get $name(){return"ModelStm"}static get defaultConfig(){return{stm:null}}joinStore(t){this.stm||(this.stm=t.stm)}unjoinStore(t){var i;this.stm===t.stm&&(this.stm=null),(i=super.unjoinStore)===null||i===void 0||i.call(this,t)}get stm(){return this[vo]}set stm(t){this[vo]=t}beforeChronoFieldSet(t,i){const r=this,{stm:n}=r,s=[];if(!r.inSetting&&n!==null&&n!==void 0&&n.enabled&&!Jn[t]&&!r.constructor.nonPersistableFields[t]&&r.getFieldDefinition(t)){const l={[t]:i},o={[t]:r[t]};s.push([l,o])}return s}beforeSet(t,i,r,n){const{stm:s}=this;if(s!=null&&s.enabled&&!Jn[t]&&!this.constructor.nonPersistableFields[t]){var l;const o=((l=super.beforeSet)===null||l===void 0?void 0:l.call(this,t,i,r,n))||[];let a,d;return typeof t=="object"?[a,d]=Object.keys(t).reduce((c,h)=>(c[0][h]=t[h],c[1][h]=this.get(h),c),[{},{}]):(a={[t]:i},d={[t]:this.get(t)}),o.push([a,d]),o}return[]}afterChronoFieldSet(t,i,r){r!=null&&r[0]&&this.afterSet(t,i,!1,!1,r,r[0][0],!0)}shouldRecordFieldChange(t,i,r){const n=this.firstStore;return!(this.constructor.nonPersistableFields[t]||i==null&&r==null||i===r||i instanceof Date&&r instanceof Date&&i.getTime()===r.getTime()||t==="id"||t==="parentId"&&n&&n.oldIdMap[i]===n.getById(r))}afterSet(t,i,r,n,s,l,o){const{stm:a}=this,d=this.constructor.nonPersistableFields;if(a!=null&&a.isBase&&a.enabled&&!Jn[t]&&!d[t]){const c=s.pop();if(l){let h;const[g,f]=c,[m,p]=Object.keys(l).reduce((v,y)=>{const C=g[y],w=f[y];return this.shouldRecordFieldChange(y,w,C)&&(h=!0,v[0][y]=C,v[1][y]=w),v},[{},{}]);h&&a.onModelUpdate(this,m,p,o)}}}beforeInsertChild(t){var i;const r=((i=super.beforeInsertChild)===null||i===void 0?void 0:i.call(this,t))||[],{stm:n}=this;return n!=null&&n.enabled&&r.push(t.reduce((s,l)=>(l.root===this.root&&s.set(l,{parent:l.parent,index:l.parent?l.parentIndex:void 0}),s),new Map)),r}afterInsertChild(t,i,r,n){var s;const{stm:l}=this;if(l!=null&&l.enabled){const o=r.pop();n&&l.onModelInsertChild(this,t,n,o)}(s=super.afterInsertChild)===null||s===void 0||s.call(this,t,i,r,n)}beforeRemoveChild(t,i){const r=super.beforeRemoveChild?super.beforeRemoveChild(t,i):[],{stm:n}=this;return n!=null&&n.enabled&&!i&&r.push(t.reduce((s,l)=>(s.set(l,l.parentIndex),s),new Map)),r}afterRemoveChild(t,i,r){var n;const{stm:s}=this;if(s!=null&&s.enabled&&!r){const l=i.pop();t&&t.length&&s.onModelRemoveChild(this,t,l)}(n=super.afterRemoveChild)===null||n===void 0||n.call(this,t,i,r)}};const Fh={includeFilteredOutRecords:!1},Qn=u=>(u=u||!1,typeof u=="boolean"&&(u={includeFilteredOutRecords:u}),u||Fh);var kh=u=>class extends(u||$){static get $name(){return"TreeNode"}static set convertEmptyParentToLeaf(t){t===!0?t={onLoad:!0,onRemove:!0}:t===!1&&(t={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=t}static get convertEmptyParentToLeaf(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}ingestChildren(t,i=this.stores){const{inProcessChildren:r,constructor:n}=this,s=i[0];if(t===!0)return r?!0:[];if(t){t=B.asArray(t);const l=t.length,o=[];for(let a=0,d;a<l;a++)d=t[a],d=d.isModel?d:s?s.createRecord(d,!1,!0):new n(d,null,null,!0),d=s?s.processRecord(d):d,o.push(d);if(this.children===!0&&s){const a=s.createSorterFn(s.sorters);o.sort(a)}return o}}processChildren(t=this.stores){const i=this,{meta:r}=i;i.inProcessChildren=!0;const n=i.ingestChildren(i.data[i.constructor.childrenField],t);if(n){const{convertEmptyParentToLeaf:s}=i.constructor;if(s===!0||s.onLoad?n.length:Array.isArray(n)){if(r.isLeaf=!1,i.children===!0)i.children=[];else if(n.length===0){i.children=n;return}i.appendChild(n)}else n===!0?(r.isLeaf=!1,i.children=!0):i.isRoot||(r.isLeaf=i.constructor.convertEmptyParentToLeaf.onLoad)}i.inProcessChildren=!1}ancestorsExpanded(t=this.firstStore){const{parent:i}=this;return!i||i.isExpanded(t)&&i.ancestorsExpanded(t)}isExpanded(t=this.firstStore){const i=this.instanceMeta(t.id);return Object.prototype.hasOwnProperty.call(i,"collapsed")||(i.collapsed=!this.expanded),!i.collapsed}get expanded(){return this.data.expanded}get childLevel(){let t=this,i=-1;for(;t&&!t.isRoot;)++i,t=t.parent;return i}get isLeaf(){return this.meta.isLeaf!==!1&&!this.isRoot}get isParent(){return!this.isLeaf}get isLoaded(){return this.isParent&&Array.isArray(this.children)}get descendantCount(){return this.getDescendantCount()}get visibleDescendantCount(){return this.getDescendantCount(!0)}getDescendantCount(t=!1,i=this.firstStore){const r=this.children;return!r||!Array.isArray(r)||t&&!this.isExpanded(i)?0:r.reduce((n,s)=>n+s.getDescendantCount(t),r.length)}get allChildren(){const t=this.children;return t?t.reduce((i,r)=>(i.push(r),i.push.apply(i,r.allChildren),i),[]):[]}get firstChild(){const t=this.children;return t?.length&&t[0]||null}get lastChild(){const t=this.children;return t?.length&&t[t.length-1]||null}get previousSiblingsTotalCount(){let t=this.previousSibling,i=this.parentIndex;for(;t;)i+=t.descendantCount,t=t.previousSibling;return i}get previousOrderedSibling(){var t;return(t=this.parent)===null||t===void 0?void 0:t.orderedChildren[this.orderedParentIndex-1]}get nextOrderedSibling(){var t;return(t=this.parent)===null||t===void 0?void 0:t.orderedChildren[this.orderedParentIndex+1]}get root(){var t;return((t=this.parent)===null||t===void 0?void 0:t.root)||this}get parentId(){return this.parent&&!this.parent.isAutoRoot?this.parent.id:null}set parentId(t){const i=this,{parent:r}=i,n=t===null?i.firstStore.rootNode:i.firstStore.getById(t);n===r||!r&&!n||(i.isBatchUpdating?i.meta.batchChanges.parentId=t:n?n.appendChild(i):i.parent.removeChild(i))}static set parentIdField(t){this._parentIdField=t,Object.defineProperty(this.prototype,t,{set:function(i){this.parentId=i},get:function(){return this.parentId}})}static get parentIdField(){return this._parentIdField||"parentId"}getChildren(t){let i;return t.includeFilteredOutRecords?i=this.unfilteredChildren||this.children:t.useOrderedTree?i=this.orderedChildren:i=this.children,i}traverse(t,i,r){r=Qn(r);const n=this,s=n.getChildren(r);i||t.call(n,n);for(let l=0,o=s?.length;l<o;l++)s[l].traverse(t,!1,r)}traverseBefore(t,i,r){r=Qn(r);const n=this,s=n.getChildren(r);for(let l=0,o=s?.length;l<o;l++)s[l].traverse(t,!1,r);i||t.call(n,n)}traverseWhile(t,i,r){r=Qn(r);const n=this;let s=i||t.call(n,n)!==!1;if(s){const l=n.getChildren(r);l!=null&&l.length&&(s=l.every(o=>o.traverseWhile(t,!1,r)))}return s}bubble(t,i=!1){let r=this;for(i||t.call(r,r);r.parent;)r=r.parent,t.call(r,r)}bubbleWhile(t,i=!1){let r=this,n=!0;for(i||(n=t.call(r,r));n&&r.parent;)r=r.parent,n=t.call(r,r);return n}contains(t,i=!1){return t&&typeof t=="object"&&(t=t.id),!this.traverseWhile(r=>r.id!=t,i)}getTopParent(t){let i;return t?(i=[],this.bubbleWhile(r=>(i.push(r),r.parent&&!r.parent.isRoot))):(i=null,this.bubbleWhile(r=>(r.parent||(i=r),r.parent&&!r.parent.isRoot))),i}appendChild(t,i=!1){return this.insertChild(t,null,i)}insertChild(t,i=null,r=!1,n={}){var s,l,o,a,d,c;const h=this,g=Array.isArray(t);if(t=B.asArray(t),typeof i=="number"){var f,m;i=(f=(m=h.children)===null||m===void 0?void 0:m[i])!==null&&f!==void 0?f:null}if(!r&&!h.stores.every(C=>C.trigger("beforeAdd",{records:t,parent:h})!==!1))return null;t=h.ingestChildren(t);const p=(s=(l=(o=i)===null||o===void 0?void 0:o.parentIndex)!==null&&l!==void 0?l:(a=h.children)===null||a===void 0?void 0:a.length)!==null&&s!==void 0?s:0,v=(d=h.beforeInsertChild)===null||d===void 0?void 0:d.call(h,t),y=h.internalAppendInsert(t,i,r,n);return y.length&&h.convertToParent(r),(c=h.afterInsertChild)===null||c===void 0||c.call(h,p,t,v,y),g||!y?y:y[0]}convertToParent(t=!1){const i=this,r=i.isLeaf;i.meta.isLeaf=!1,i.children||(i.children=[]),r&&!i.root.isLoading&&!t&&i.signalNodeChanged({isLeaf:{value:!1,oldValue:!0}})}signalNodeChanged(t){this.stores.forEach(i=>{i.trigger("update",{record:this,records:[this],changes:t}),i.trigger("change",{action:"update",record:this,records:[this],changes:t})})}tryInsertChild(){return this.insertChild(...arguments)}internalAppendInsert(t,i,r,n){const s=this,{stores:l,root:o}=s,{firstStore:a}=o,{parentIdField:d}=s.constructor,c=s.isAutoRoot?null:s.id,h=[],g={};let f,m,p,v;if(!o.isLoading)for(p=0;p<t.length;p++){const y=t[p];g[y.id]=y.root===o,h[p]=y.parentIndex}if(i&&i.parent!==s&&(i=null),s.children){const y=s.children,C=i?i.parentIndex:y.length;if(y[m=C]===t[0]||y[m=C-1]===t[0])for(f=!0,p=0;f&&p<t.length;p++)t[p]!==y[m+p]&&(f=!1)}if(f)return t;for(p=0;p<t.length;p++){const y=t[p],C=y.parent;a&&!o.isLoading&&y.traverse(w=>{w.root===o&&(g[w.id]=!0)}),C?.removeChild(y,g[y.id],r,F({isInserting:!0},n))===!1?(v||(t=t.slice(),v=!0),t.splice(p--,1)):(y.parent=s,y.data[d]=c,C&&(y.meta.oldParentId=C.id))}if(t.length){Array.isArray(s.children)||(s.children=[]),Array.isArray(s.orderedChildren)||(s.orderedChildren=[]);const y=s.addToChildren(i,t,n);l.forEach(C=>{C.isChained||(t.forEach(w=>{w.joinStore(C)}),C.onNodeAddChild(s,t,y,g,r),t.forEach((w,S)=>{if(w.meta.oldParentId!=null&&!(s.inProcessChildren||s.isLoading)){const D={[d]:c,[s.getDataSource("parentIndex")]:w.parentIndex},I={},{modified:R,oldParentId:H}=w.meta,L=h[S];delete w.meta.oldParentId,s.id!==H&&(I[d]={value:c,oldValue:H}),w.parentIndex!==L&&(I.parentIndex={value:w.parentIndex,oldValue:L}),R[d]===s.id?Reflect.deleteProperty(R,d):d in R||(R[d]=H),w.afterChange(D,I)}}))})}return t}removeChild(t,i=!1,r=!1,n={}){var s,l;const o=this,a=[],d=o.isLeaf,{children:c,stores:h}=o;if(t=B.asArray(t),t=t.filter(f=>f.parent===o),!r){for(const f of h)if(!f.isChained&&f.trigger("beforeRemove",{parent:o,records:t,isMove:i})===!1)return!1}const g=(s=o.beforeRemoveChild)===null||s===void 0?void 0:s.call(o,t,i);for(const f of t){const{parentIdField:m}=f.constructor,{modified:p}=f.meta,v=f.parent?f.parent.id:null;!(m in p)&&!f.isLinked&&(p[m]=v);const y=o.removeFromChildren(f,n);h.forEach(C=>{if(!C.isChained){const{isRemoving:w}=C;C.isRemoving=!0,a.push(...C.onNodeRemoveChild(o,[f],y,{isMove:i,silent:r})),C.isRemoving=w}}),i||(f.parent=f.parentIndex=f.unfilteredIndex=f.nextSibling=f.previousSibling=null,f.data[m]=null)}return(o.unfilteredChildren||c).length===0&&o.constructor.convertEmptyParentToLeaf.onRemove&&!o.isRoot&&(o.meta.isLeaf=!0),o.isLeaf!==d&&!r&&o.stores.forEach(f=>{const m={isLeaf:{value:!0,oldValue:!1}};f.trigger("update",{record:o,changes:m}),f.trigger("change",{action:"update",record:o,changes:m})}),(l=o.afterRemoveChild)===null||l===void 0||l.call(o,t,g,i),a}clearParentId(){const t=this;Reflect.deleteProperty(t.data,t.parentIdField),Reflect.deleteProperty(t.originalData,t.parentIdField),t.meta.modified&&Reflect.deleteProperty(t.meta.modified,t.parentIdField)}replaceChildren(t){return this.clearChildren(),this.data[this.constructor.childrenField]=t,this.processChildren(),this.children}clearChildren(t=!1){const i=this,{stores:r}=i,n=i.unfilteredChildren||i.children;i.children=[],i.orderedChildren=[],n&&n!==!0&&(r.forEach(s=>{s.isChained||s.onNodeRemoveChild(i,n,0,{unfiltered:!0,silent:t})}),i.unfilteredChildren&&(i.unfilteredChildren=[]))}clear(){var t;const i=this,{stores:r}=i,n=(t=i.children)===null||t===void 0?void 0:t.slice();if(!(!i.isRoot||!n)){for(const s of r)if(!s.isChained&&s.trigger("beforeRemove",{parent:i,records:n,isMove:!1,removingAll:!0})===!1)return!1;i.children.length=0,i.unfilteredChildren&&(i.unfilteredChildren.length=0),r.forEach(s=>{n.forEach(l=>{l.stores.includes(s)&&l.unjoinStore(s),l.parent=l.parentIndex=l.nextSibling=l.previousSibling=null}),s.storage.suspendEvents(),s.storage.clear(),s.storage.resumeEvents(),s.added.clear(),s.modified.clear(),s.trigger("removeAll"),s.trigger("change",{action:"removeall"})})}}updateChildrenIndices(t,i,r=!1){let n=null;for(let s=0;s<t.length;s++){const l=t[s],o=l[i];i==="parentIndex"||i==="orderedParentIndex"?o===void 0||r?l.setData(i,s):o!==s&&l.set(i,s,!0):l[i]=s,i==="parentIndex"&&(l.previousSibling=n,n&&(n.nextSibling=l),s===t.length-1&&(l.nextSibling=null),n=l)}}addToChildren(t,i,r={}){var n;const s=this,l=[[s.children,"parentIndex",t],[s.unfilteredChildren,"unfilteredIndex",t],[s.orderedChildren,"orderedParentIndex",(n=r?.orderedBeforeNode)!==null&&n!==void 0?n:t]];for(const a of l){const[d,c,h]=a;if(d){var o;const g=h?h[c]:d.length;a.push(g),d.splice(g,0,...i),r!=null&&(o=r[c])!==null&&o!==void 0&&o.skip||s.updateChildrenIndices(d,c)}}return l[0][3]}removeFromChildren(t,i){const r=[[this.children,"parentIndex"],[this.unfilteredChildren,"unfilteredIndex"],[this.orderedChildren,"orderedParentIndex"]];for(const s of r){const[l,o]=s;if(l){const a=l.indexOf(t);if(s.push(a),a>-1){var n;l.splice(a,1),i!=null&&(n=i[o])!==null&&n!==void 0&&n.skip||this.updateChildrenIndices(l,o)}}}return r[0][2]}sortOrderedChildren(t=!0,i=!1){const r=[];return this.isLeaf||(this.orderedChildren.sort((n,s)=>{if(i){var l,o;const a=(l=n.meta.modified.orderedParentIndex)!==null&&l!==void 0?l:n.orderedParentIndex,d=(o=s.meta.modified.orderedParentIndex)!==null&&o!==void 0?o:s.orderedParentIndex,c=a-d;return c!==0&&(r.push(n),r.push(s)),c}else return n.orderedParentIndex-s.orderedParentIndex}),t&&this.orderedChildren.forEach(n=>{r.push(...n.sortOrderedChildren(t,i))}),this.updateChildrenIndices(this.orderedChildren,"orderedParentIndex",!0)),new Set(r)}};const bo={id:1,stores:1,parentIndex:1,parent:1,previousSibling:1,nextSibling:1,unfilteredIndex:1},Lh={get(u,e){return e==="proxyMeta"?this.proxyMeta:e==="constructor"?u.constructor:e==="setData"?this.setDataOverride:e==="set"?this.setOverride:bo[e]?this.proxyMeta.data[e]:Reflect.get(u,e,this.proxyRecord)},set(u,e,t){return bo[e]?this.proxyMeta.data[e]=t:u[e]=t,!0},setDataOverride(u,e){u==="parentIndex"?this.proxyMeta.data.parentIndex=e:this.proxyMeta.originalRecord.setData(u,e)},setOverride(u,e,...t){u==="parentIndex"?this.proxyMeta.data.parentIndex=e:this.proxyMeta.originalRecord.set(u,e,...t)}};var Ph=u=>{var e;return e=class extends(u||$){link(){if(this.isLinked)return this.$original.link();const i=this,r=F(F({},Lh),{},{proxyMeta:{originalRecord:i,data:{id:`${i.id}_link_${_.generateUUID()}`,stores:[]}}}),n=new Proxy(i,r);return r.proxyRecord=n,(i.meta.linkedRecords||(i.meta.linkedRecords=[])).push(n),n}get isLinked(){var i;return Boolean((i=this.proxyMeta)===null||i===void 0?void 0:i.originalRecord)}get hasLinks(){return Boolean(!this.proxyMeta&&this.$links.length)}removeLink(i,r=null,n=!1){if(i.hasLinks)for(const s of i.$links.slice())r?B.include(r,s):s.remove(n);else i.isLinked&&B.remove(i.$original.$links,i)}beforeRemove(i){this.removeLink(this,i)}removeChild(i,r,n,s){if(!(s!=null&&s.isInserting)){i=B.asArray(i);for(const l of i)this.removeLink(l,null,n)}return super.removeChild(i,r,n,s)}get $originalId(){return this.$original.id}get $links(){var i;return(i=this.meta.linkedRecords)!==null&&i!==void 0?i:[]}},T(e,"$name","ModelLink"),e};const{defineProperty:yo}=Reflect,Zn=Symbol("owner"),Oh=/[\s,]+/;var hi=u=>class extends(u||$){static get $name(){return"Factoryable"}static get declarable(){return["factoryable","alias","type"]}static register(t,i,r=globalThis.__BRYNTUM_EXAMPLE){const{factoryable:n}=this.initClass(),{caseless:s,registry:l}=n,o=_.split(t,Oh);for(let a,d,c=0;c<o.length;++c){if(d=o[c],a=s?d.toLowerCase():d,!r&&a in l)throw new Error(`Type "${d}" already registered with ${n.class.name} factory`);l[d]=l[a]=i.initClass()}}static isA(t,i){return this.isType(t,i,!0)}static isType(t,i,r){const{factoryable:n}=this,{caseless:s,registry:l}=n,o=l[s?i.toLowerCase():i];return o?r?t instanceof o:t.constructor===o:!1}static setupAlias(t){t.register(t.alias,t)}static setupFactoryable(t,i){const r=i.super.class;let{factoryable:n}=t;n=F({caseless:!0,defaultType:null,extends:r.factoryable?[r]:null,typeKey:"type"},n),n.class=t,n.registry=Object.create(null),n.extends&&!Array.isArray(n.extends)&&(n.extends=[n.extends]),yo(t,"factoryable",{get(){return n}})}static setupType(t,i){const{type:r}=t;t.register(r,t,i.replaceType),yo(t.prototype,"type",{value:r})}static create(t,i){return this.reconfigure(null,t,i)}static reconfigure(t,i,r){const n=this,{factoryable:s}=n,{typeKey:l}=s;let o=r,a,d,c,h,g,f,m,p,v;if(r&&!x.isClass(r)&&(o=null,m=typeof r,m==="function"?f=r:m==="string"?o=r:x.isObject(r)?(a=r.cleanup,d=r.defaults,h=r.owner,f=r.setup,o=r.type,p=r.transform):h=r),p&&(i=typeof p=="string"?h[p](i):p(i)),v=i,typeof v=="string")i={};else if(i){if(i===!0&&(i={}),!x.isObject(i)){if(h&&i!==t&&t?.[Zn]===h){var y;typeof a=="string"?h[a](t):(y=a)===null||y===void 0||y(t),t.destroy()}return i}v=i[l]}if(v=v&&n.resolveType(v),t){if(i&&(!v||t.constructor===v))return l in i&&(i=x.assign({},i),delete i[l]),t.setConfig(i),t;if(h&&t[Zn]===h){var C;typeof a=="string"?h[a](t):(C=a)===null||C===void 0||C(t),t.destroy()}}if(i){if(d){if(!(c=v)){if(!(c=d[l]||o||s.defaultType))throw new Error(`No default mergeType defined for ${s.class.name} factory`);c=n.resolveType(c)}c&&(i=c.mergeConfigs(d,i))}if(f){if(g=typeof f=="string"?h[f](i,v,d):f(i,v,d),g===null)return g;i=g||i}if(!v){if(!(v=i[l]||o||s.defaultType))throw new Error(`No default type defined for ${s.class.name} factory`);v=n.resolveType(v)}d&&!c&&(i=v.mergeConfigs(d,i)),l in i&&(i=x.assign({},i),delete i[l]),i=new v(i),h&&(i[Zn]=h)}return i||null}static resolveType(t,i){if(typeof t!="string")return t;const{factoryable:r}=this,n=r.extends;let s=r.registry[r.caseless?t.toLowerCase():t],l;for(l=0;!s&&n&&l<n.length;++l)s=n[l].resolveType(t,!0);if(!s&&!i)throw new Error(`Invalid type name "${t}" passed to ${r.class.name} factory`);return s}};const{getOwnPropertyDescriptor:Ah}=Reflect;class tt extends $.mixin(hi){static get $name(){return"DataField"}static get type(){return"auto"}static get factoryable(){return{defaultType:"auto"}}static get prototypeProperties(){return{compare:null,compareItems:null,dataSource:null,alwaysWrite:!1,nullable:!0,nullText:null,nullValue:void 0,persist:!0,readOnly:!1,internal:!1}}construct(e){const t=this;e&&(t.name=e.name,Object.assign(t,e)),t.compare&&(t.compareItems=(i,r)=>t.compare(i?.[t.name],r?.[t.name]))}defineAccessor(e,t){const{name:i,dataSource:r}=this;!t&&i in e&&e.$meta.hierarchy.some(n=>{var s;return((s=Ah(n.prototype,i))===null||s===void 0?void 0:s.enumerable)===!1})||Reflect.defineProperty(e,i,{configurable:!0,enumerable:!0,get:this.complexMapping?function(){return this.complexGet(i,r)}:function(){return this.batching&&i in this.meta.batchChanges?this.meta.batchChanges[i]:r in this.data?this.data[r]:this.data[i]},set(n){const s=this.$meta.fields.map[i];s&&s.readOnly||this.set(i,n)}})}isEqual(e,t){return x.isEqual(e,t)}print(e){return e==null?this.nullText:this.printValue(e)}printValue(e){return String(e)}}tt._$name="DataField";class cd extends tt{static get $name(){return"ArrayDataField"}static get type(){return"array"}isEqual(e,t){return e===t}}cd.initClass();cd._$name="ArrayDataField";class ud extends tt{static get $name(){return"BooleanDataField"}static get type(){return"boolean"}static get alias(){return"bool"}static get prototypeProperties(){return{nullValue:!1}}isEqual(e,t){return e==null&&t==null?!0:super.isEqual(e,t)}convert(e){var t;return e==null?this.nullable?e:this.nullValue:((t=e.toLowerCase)===null||t===void 0?void 0:t.call(e))==="false"?!1:Boolean(e)}}ud.initClass();ud._$name="BooleanDataField";class hd extends tt{static get $name(){return"DateDataField"}static get type(){return"date"}static get prototypeProperties(){return{format:null}}convert(e){return e==null?this.nullable||(e=this.nullValue):e==="now"?e=new Date:e instanceof Date||(e=E.parse(e,this.format||E.defaultParseFormat),(!e||isNaN(e))&&(e=void 0)),e}serialize(e){return e instanceof Date&&(e=E.format(e,this.format||E.defaultFormat)),e}printValue(e){return E.format(e,this.format||E.defaultFormat)}}hd.initClass();hd._$name="DateDataField";class Vs extends tt{static get $name(){return"StringDataField"}static get type(){return"string"}static get prototypeProperties(){return{nullValue:""}}convert(e){return e==null?this.nullable?e:this.nullValue:String(e)}}Vs.initClass();Vs._$name="StringDataField";class fd extends Vs{static get $name(){return"DurationUnitDataField"}static get type(){return"durationunit"}isEqual(e,t){return E.compareUnits(e,t)===0}}fd.initClass();fd._$name="DurationUnitDataField";class gd extends tt{static get $name(){return"IntegerDataField"}static get type(){return"integer"}static get alias(){return"int"}static get prototypeProperties(){return{nullValue:0,rounding:"round"}}convert(e){return e==null?this.nullable?e:this.nullValue:Math[this.rounding](Number(e))}}gd.initClass();gd._$name="IntegerDataField";class md extends tt{static get $name(){return"ModelDataField"}static get type(){return"model"}static get prototypeProperties(){return{complexMapping:!0}}isEqual(e,t){return e&&t&&t instanceof e.constructor&&t.id==e.id}}md.initClass();md._$name="ModelDataField";class pd extends tt{static get $name(){return"NumberDataField"}static get type(){return"number"}static get alias(){return"float"}static get prototypeProperties(){return{nullValue:0,precision:null}}isEqual(e,t){return isNaN(Number(e))&&isNaN(Number(t))||super.isEqual(e,t)}convert(e){if(e==null)return this.nullable?e:this.nullValue;if(e=Number(e),isNaN(e))return;let t=this.precision;return t?(t=10**t,e=Math.round(e*t)/t):t===0&&(e=Math.round(e)),e}}pd.initClass();pd._$name="NumberDataField";class vd extends tt{static get $name(){return"ObjectDataField"}static get type(){return"object"}static get prototypeProperties(){return{complexMapping:!0}}}vd.initClass();vd._$name="ObjectDataField";class an extends tt{init(e,t){var i;const r=this,n=`${r.name}Store`,s={skipStack:!0};if(r.modelClass&&(s.modelClass=r.modelClass),(i=t[`init${_.capitalize(n)}`])===null||i===void 0||i.call(t,s),!s.storeClass&&!r.storeClass)throw new Error(`Field '${r.name}' with type 'store' must have a storeClass configured`);const l=t.meta[n]=new(s.storeClass||r.storeClass)(s);r.complexMapping?x.setPath(e,r.dataSource,l):e[r.dataSource]=l,l.verifyNoGeneratedIds=!1,l.usesId=!l.count||!l.every(o=>o.hasGeneratedId),l.$currentValue=r.getValue(l),l.ion({change:({action:o})=>{const a=r.getValue(l);if(!l.$isSettingStoreFieldData){const d=l.$preserveCurrentDataset;l.$preserveCurrentDataset=r.subStore&&(o==="update"||o==="remove"||o==="add"),t.set(r.name,a),l.$preserveCurrentDataset=d}l.$currentValue=a}})}set(e,t,i){var r,n;const s=this,l=`${s.name}Store`,{[l]:o}=i.meta;if(!o)return i.meta.initableValues.set(s,e),!1;o.$isSettingStoreFieldData||(o.$isSettingStoreFieldData=!0,e=(r=(n=i[`process${_.capitalize(l)}Data`])===null||n===void 0?void 0:n.call(i,e,i))!==null&&r!==void 0?r:e,o.$preserveCurrentDataset||(o.data=e),o.$isSettingStoreFieldData=!1,o.usesId=!o.count||!o.every(a=>a.hasGeneratedId))}serialize(e,t){return t.meta[`${this.name}Store`].$currentValue}getValue(e){return e.allRecords.map(t=>{const i=t.persistableData;return e.usesId||delete i.id,i})}isEqual(e,t){var i,r;return(i=e)!==null&&i!==void 0&&i.isStore&&(e=e.$currentValue),(r=t)!==null&&r!==void 0&&r.isStore&&(t=t.$currentValue),x.isDeeplyEqual(e,t)}}T(an,"$name","StoreDataField");T(an,"type","store");an.initClass();an._$name="StoreDataField";const{defineProperty:$h}=Reflect,{hasOwn:Li}=x,ut=void 0,_h={children:1,data:1,meta:1},Hh=["name","title","text","label","description"],Nh={boolean:1,number:1,date:1,object:1};class fe extends $.mixin(Ih,kh,Ph){static get $name(){return"Model"}static get declarable(){return["fields"]}static get fields(){return[{name:"parentIndex",type:"number",persist:!1,internal:!0},{name:"orderedParentIndex",type:"number",persist:!1,internal:!0},{name:"readOnly",type:"boolean"}]}static set idField(e){this._assignedIdField=!0,this._idField=e}static get idField(){return this._idField}static set childrenField(e){this._childrenField=e}static get childrenField(){if(!this._childrenField){const e=this.fieldMap.children;this._childrenField=e?.dataSource||"children"}return this._childrenField}get indexPath(){const e=[];let t=this,i=t.childLevel;for(t=this;t&&!t.isRoot;t=t.parent)e[i--]=t.parentIndex+1;return e}construct(e={},t=null,i=null,r=!1,n=!1,s=!1){var l,o;const a=this,d=(l=B.asArray(t))!==null&&l!==void 0?l:[],{constructor:c,fieldMap:h}=a;let g=null;if(t=d[0],a.meta=F(F({modified:{}},c.metaConfig),i),c.applyConfigs)for(const f in a.getDefaultConfiguration())g||(g={},(!a.useRawData||!a.useRawData.enabled)&&(e=F({},e))),f in e&&(e[f]!==void 0&&(g[f]=e[f]),delete e[f]);if(super.construct(g),r||c.exposeProperties(e,s),!Li(c,"idFieldProcessed")){let f=a.meta.idField;f||(c._assignedIdField?f=c.idField:t&&(f=t.idField)),f&&f!==h.id.dataSource&&c.addField({name:"id",dataSource:f,internal:!0}),c._idField=h.id.dataSource,c.idFieldProcessed=!0}a._internalId=fe._internalIdCounter++,a.stores=[],a.unjoinedStores=[],a.originalData||(a.originalData=e),a.data=c.processData(e,!1,t,a,n),!((o=a.meta.initableValues)===null||o===void 0)&&o.size&&a.assignInitables(),a.id==null&&a.setData("id",a.generateId(t)),a.data[c.childrenField]&&a.processChildren(d),a.generation=0}set isCreating(e){const t=this;Boolean(t.meta.isCreating)!==e&&(t.meta.isCreating=e,t.stores.forEach(i=>{i.onIsCreatingToggle(t,e)}))}get isCreating(){return Boolean(this.meta.isCreating)}equals(e){if(e instanceof this.constructor){for(let t=this.$meta.fields.defs,i=0,{length:r}=t;i<r;i++){const n=t[i],{name:s}=n;if(s!=="id"&&!n.isEqual(this[s],e[s]))return!1}return!0}return!1}get subclass(){return new this.constructor(Object.setPrototypeOf({id:ut},this.data),this.stores[0],null,!0)}static processData(e,t=!1,i,r,n){const{fieldMap:s,defaultValues:l}=this,{useRawData:o={enabled:!1}}=i||{},a=n||o.enabled?e:x.clone(e);let d;if(t=t||o.disableDefaultValue||n,!t){for(d in l)if(a[d]===ut){let c=l[d];Array.isArray(c)&&(c=c.slice()),a[d]=c}}if(!o.disableTypeConversion&&!n)for(d in s){const c=s[d],{name:h,dataSource:g}=c,f=g!==h,m=c.complexMapping,p=f&&(m?x.pathExists(e,g):g in e),v=h in e&&(!f||!p),y=!o.disableTypeConversion&&c.convert;if((v||y)&&(!t||v||p)){const C=v?a[h]:m?x.getPath(a,g):a[g],w=y?c.convert(C,r):C;m?x.setPath(a,g,w):a[g]=w,f&&delete a[h]}}return this.$meta.fields.initable.length&&this.initInitables(r,a),a}static setupClass(e){super.setupClass(e),e.fields||this.setupFields(this,e)}static setupFields(e,t){var i,r,n,s,l;const o=Li(e,"fields")&&e.fields,a=t.super.fields,d=t.fields={defs:(i=a?.defs.slice())!==null&&i!==void 0?i:[],exposedData:!1,defaults:a?F({},a.defaults):{},exposed:Object.create((r=a?.exposed)!==null&&r!==void 0?r:null),ordinals:Object.create((n=a?.ordinals)!==null&&n!==void 0?n:null),map:Object.create((s=a?.map)!==null&&s!==void 0?s:null),sources:Object.create((l=a?.sources)!==null&&l!==void 0?l:null)};Li(e,"defaults")&&Object.assign(d.defaults,e.defaults),Li(e,"idField")&&(e.addField({name:"id",dataSource:e.idField,internal:!0}),d.exposed[e.idField]=!0),o!=null&&o.length&&o.map(e.addField,e),d.initable=d.defs.filter(c=>c.init),e.exposeRelations()}static get defaultValues(){return this.$meta.fields.defaults}static get allFields(){return this.$meta.fields.defs}get allFields(){return this.$meta.fields.defs}static get fieldMap(){return this.$meta.fields.map}get fieldMap(){return this.$meta.fields.map}static get fieldDataSourceMap(){return this.$meta.fields.sources}static exposeProperties(e,t=!0){const i=this,r=i.$meta.fields,n=t?"exposed":"map";if(e&&i.autoExposeFields&&!r.exposedData){let s,l,o;for(s in e)!r[n][s]&&s!==i.childrenField&&(o=x.typeOf(e[s]),l={name:s,dataSource:s,fromData:!0},Nh[o]&&(l.type=o),i.addField(l));r.exposedData=!0}i.exposeRelations()}static addField(e){if(e==null)return;typeof e=="string"&&(e={name:e});const t=this.initClass(),i=t.$meta.fields,{ordinals:r}=i,n=i.exposed,{name:s}=e,l=i.map[s],o=e.dataSource||(e.dataSource=s);let a,d;if(!l||e.type&&e.type!==l.type)a=tt.create(e),a.definedBy=l?l.definedBy:t,a.ordinal=l?l.ordinal:r[s]=i.defs.length;else{a=Object.create(l);for(d in e)d!=="type"&&(a[d]=e[d])}return a.owner=t,i.defs[a.ordinal]=a,i.map[s]=a,i.sources[o]||(i.sources[o]=a),o.includes(".")&&(a.complexMapping=!0),a.complexMapping?n[o.split(".")[0]]=!0:n[o]=!0,"defaultValue"in a&&(i.defaults[o]=a.defaultValue),_h[s]||a.defineAccessor(t.prototype),t._nonPersistableFields=null,t._alwaysWriteFields=null,a}static removeField(e){const t=this.initClass(),i=t.$meta.fields,r=i.map[e],{ordinals:n}=i,s=n[e];if(r){i.defs.splice(s,1),delete n[e],delete i.defaults[e],delete i.exposed[e],delete i.map[e],delete i.sources[r.dataSource];for(const l in n)n[l]>s&&--n[l];delete t.prototype[e]}}static exposeRelations(){const e=this;if(!Li(e,"exposedRelations")&&e.relations){e.exposedRelations=[];for(const t in e.relations){const i=e.relations[t];i.relationName=t,e.exposedRelations.push(i),Reflect.ownKeys(e.prototype).includes(t)||$h(e.prototype,t,{enumerable:!0,get:function(){return this.getForeign(t)},set:function(r){this.setForeign(t,r,i)}})}}}static initInitables(e,t){const i=e.meta.initableValues=new Map;for(const r of this.$meta.fields.initable){const n=x.getPath(t,r.dataSource);n!==void 0&&i.set(r,n),!r.lazy&&r.init(t,e)}}assignInitables(){const{initableValues:e}=this.meta;for(const[t,i]of e)t.set(i,this.data,this)!==!1&&e.delete(t)}static get autoExposeFields(){return!0}get fields(){return this.$meta.fields.defs}getFieldDefinition(e){return this.$meta.fields.map[e]}getFieldDefinitionFromDataSource(e){return this.$meta.fields.sources[e]}get fieldNames(){return Object.keys(this.data)}static getFieldDefinition(e){return this.$meta.fields.map[e]}static getFieldDataSource(e){return this.getFieldDefinition(e).dataSource}getDataSource(e){const t=this.constructor.getFieldDefinition(e);return t?.dataSource||t?.name}static processField(e,t,i){const r=this.fieldMap[e];return r!=null&&r.convert?r.convert(t,i):t}initRelations(){const e=this;!e.constructor.exposedRelations||e.stores.forEach(i=>{var r;i.modelRelations||i.initRelations();const n=[];(r=i.modelRelations)===null||r===void 0||r.forEach(s=>{n.push({related:e.initRelation(s),config:s})}),i.updateRecordRelationCache(e,n)})}initRelation(e){const t=this,i=t.get(e.foreignKey),r=i!==ut&&typeof e.foreignStore!="string"&&e.foreignStore.getById(i),n=t.meta.relationCache||(t.meta.relationCache={});return n[e.relationName]=r||(i!=null?{id:i,placeHolder:!0}:null),r}removeRelation(e){const{relationName:t,foreignKey:i,nullFieldOnRemove:r}=e;this.meta.relationCache[t]&&(delete this.meta.relationCache[t],r&&this.setData(i,null))}getForeign(e){var t;return(t=this.meta.relationCache)===null||t===void 0?void 0:t[e]}setForeign(e,t,i){const r=fe.asId(t);return this.set(i.foreignKey,r)}getRelationConfig(e){var t,i;return(t=this.firstStore)===null||t===void 0||(i=t.modelRelations)===null||i===void 0?void 0:i.find(r=>r.foreignKey===e)}flatGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:t in this.data?this.data[t]:this.data[e]}complexGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:x.getPath(this.data,t)}get(e){if(!e)return;const t=this.fieldMap[e];return!t&&e.includes(".")?this.complexGet(e,e):t!=null&&t.complexMapping?this.complexGet(e,t.dataSource):this.flatGet(e,t?.dataSource||e)}setData(e,t){const{data:i,fieldMap:r}=this;if(typeof e=="string"){var n;const l=r[e],o=(n=l?.dataSource)!==null&&n!==void 0?n:e;l!=null&&l.set?l.set(t,this.data,this):l!=null&&l.complexMapping?x.setPath(i,o,t):i[o]=t}else{const l=Object.keys(e);for(let o=0;o<l.length;o++){var s;const a=l[o],d=r[a],c=(s=d?.dataSource)!==null&&s!==void 0?s:a;d!=null&&d.set?d.set(t,this.data,this):c&&(d!=null&&d.complexMapping?x.setPath(i,c,e[a]):i[c]=e[a])}}}getData(e){var t;const i=this.fieldMap[e],r=(t=i?.dataSource)!==null&&t!==void 0?t:e;if(r)return i!=null&&i.complexMapping?x.getPath(this.data,r):this.data[r]}syncId(e){const t=this.id;if(t!==e){this.setData("id",e);const i={id:{value:e,oldValue:t}};this.afterChange(i,i)}}set(e,t,i=!1,r=!1,n=!1,s=!1){const l=this;if(l.isBatchUpdating)return l.inBatchSet(e,t,i||l.$silenceBatch),null;{var o,a;const d=(o=l.beforeSet)===null||o===void 0?void 0:o.call(l,e,t,i,r),c=l.inSet(e,t,i,r,n,s);return(a=l.afterSet)===null||a===void 0||a.call(l,e,t,i,r,d,c),c}}fieldToKeys(e,t){return typeof e!="string"?x.assign({},e):{[e]:t}}inBatchSet(e,t,i){const r=this,{meta:n,constructor:s,fieldMap:l}=r,o={};let a,d=!1;if(typeof e!="string"?Object.keys(r.fieldToKeys(e,t)).forEach(c=>{a=l[c]||x,t=s.processField(c,e[c],r),a.isEqual(n.batchChanges[c],t)||(o[c]={value:t,oldValue:r.get(c)},n.batchChanges[c]=t,d=!0)}):(a=l[e]||x,a.isEqual(n.batchChanges[e],t)||(o[e]={value:t,oldValue:r.get(e)},n.batchChanges[e]=t,d=!0)),d&&(r.generation++,!i)){const c={action:"update",record:r,records:[r],changes:o};r.stores.forEach(h=>{h.trigger("batchedUpdate",F({},c))}),r.forEachLinked((h,g)=>h.trigger("batchedUpdate",F(F({},c),{},{record:g,records:[g]})))}}inSet(e,t,i,r,n=!1,s=!1){const l=this,{data:o,meta:a,fieldMap:d,constructor:c}=l,{prototype:h,childrenField:g}=c,f={},m=l.fieldToKeys(e,t),p=Object.keys(m);let v=!1;if(!i&&!l.triggerBeforeUpdate(m))return null;l.inSetting=!0;for(let C=0;C<p.length;C++){var y;const w=p[C];if(w===g)continue;const S=d[w],D=S||x,I=S?.readOnly,R=(y=S?.dataSource)!==null&&y!==void 0?y:w,H=!n&&!S&&w in h,L=H?l[R]:S!=null&&S.complexMapping?x.getPath(o,R):o[R],V=c.processField(w,m[w],l),U=m[w]={value:V},Y=l.getRelationConfig(w);!I&&!D.isEqual(L,V)&&(!s||V!==void 0)&&(l.generation++,U.oldValue=L,v=!0,D.isEqual(l.meta.modified[w],V)?Reflect.deleteProperty(a.modified,w):l.ignoreBag||(w in a.modified||l.storeFieldChange(w,L),U.oldValue===ut&&Reflect.deleteProperty(U,"oldValue")),f[w]=U,l.applyValue(H,R,V,n,S),Y&&!r&&(l.initRelation(Y),l.stores.forEach(j=>j.cacheRelatedRecord(l,V,Y.relationName,U.oldValue))))}return v&&l.afterChange(m,f,i,r,n),l.inSetting=!1,v?f:null}applyValue(e,t,i,r,n){var s,l;const o=this;let a=(s=n)===null||s===void 0?void 0:s.complexMapping;if(t===o.constructor.parentIdField){(o.firstStore.getById(i)||o.firstStore.rootNode).insertChild(o,null,!1,{orderedParentIndex:{skip:!0}});return}else if(e){var d;o[((d=n)===null||d===void 0?void 0:d.name)||t]=i;return}if((l=n)!==null&&l!==void 0&&l.set){n.set(i,o.data,o);return}if(!n&&t.includes(".")){var c,h;const g=t.split(".")[0];n=o.constructor.fieldMap[g],a=((c=n)===null||c===void 0?void 0:c.complexMapping)||((h=n)===null||h===void 0?void 0:h.type)==="object"}a?x.setPath(o.data,t,i):o.data[t]=i}afterChange(e,t,i,r,n){for(const s of this.stores)s.onModelChange(this,e,t,i,r,n);this.forEachLinked((s,l)=>s.onModelChange(l,e,t,i,r,n))}forEachLinked(e){for(const t of this.$links)for(const i of t.stores)e(i,t)}get isPersistable(){return!this.isBatchUpdating&&!this.isCreating}get isModified(){return Boolean(this.meta.modified&&Object.keys(this.meta.modified).length>0)}get hasPersistableChanges(){return this.isPersistable&&!x.isEmpty(this.rawModificationData)}isFieldModified(e){return this.isModified&&e in this.meta.modified}getFieldPersistentValue(e){const t=typeof e=="string"?this.getFieldDefinition(e):e,i=t?.name||e;let r;return(!t||t.persist)&&(r=this[i],t!=null&&t.serialize&&(r=t.serialize(r,this))),r}get modifications(){const e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}get rawModifications(){const e=this,t={};if(!e.isModified)return null;let i=!1;return Object.keys(e.meta.modified).forEach(r=>{const n=e.getFieldPersistentValue(r);n!==ut&&(t[r]=n,i=!0)}),i?t:null}get modificationData(){const e=this.rawModificationData;return e&&Object.keys(e).length&&x.setPath(e,this.constructor.idField,this.id),e}get rawModificationData(){const e=this,{fieldMap:t}=e.constructor,i={};if(!e.isModified)return null;let r=!1;return Object.keys(e.meta.modified).forEach(n=>{const s=t[n];if(s!=null&&s.persist){const l=e.getFieldPersistentValue(n);l!==ut&&(x.setPath(i,s.dataSource,l),r=!0)}}),r?i:null}get modificationDataToWrite(){const e=this.constructor.alwaysWriteFields,t=this.modificationData;return e.forEach(i=>{t[this.getFieldDefinition(i).dataSource]=this.getFieldPersistentValue(i)}),t}get persistableData(){const e=this,t={};return e.fields.forEach(i=>{const r=e.getFieldPersistentValue(i);r!==ut&&(i!=null&&i.complexMapping?x.setPath(t,i.dataSource,r):t[i.dataSource]=r)}),t}get isCommitting(){return Boolean(this.meta.committing)}clearChanges(e=!0,t=!0,i=null){const r=this,{meta:n}=r;if(i)for(const l in i)delete n.modified[l];else n.modified={};const s=x.isEmpty(n.modified);n.committing=!1,t&&r.stores.forEach(l=>{if(s&&l.modified.remove(r),l.added.remove(r),e){const o=l.collectDescendants(r).all;l.added.remove(o),s&&l.modified.remove(o)}})}storeFieldChange(e,t){this.meta.modified[e]=t}revertChanges(e=!1){this.set(this.meta.modified,ut,e)}applyChangeset(e,t="$PhantomId",i=!0){const r=this,n=r.constructor,{idField:s,fieldDataSourceMap:l}=n,o=x.pathifyKeys(e),a=x.pathifyKeys(r.modificationData),d={},c=t in e;for(const f in o){var h;const m=l[f],p=(h=m?.name)!==null&&h!==void 0?h:f;(i||(m?.name===s?c:o[f]===a[f]))&&(d[p]=o[f])}const g=r.set(d);return r.clearChanges(!1,!0,i?null:d),g?Object.entries(g).reduce((f,[m,p])=>(f[m]=p.value,f),{}):{}}get internalId(){return this._internalId}get isPhantom(){return this.id===""||this.id==null||this.hasGeneratedId}get isModel(){return!0}get hasGeneratedId(){return typeof this.id=="string"&&this.id.startsWith("_generated")}static generateId(e=this.$$name){return`_generated${e}_${_.generateUUID()}`}generateId(){return this.constructor.generateId()}static asId(e){return e!=null&&e.isModel?e.id:x.isObject(e)?e[this.fieldMap.id.dataSource]:e}get json(){return _.safeJsonStringify(this)}toJSON(){const{children:e,unfilteredChildren:t}=this,i=this.persistableData;return(t||e)&&(i[this.constructor.childrenField]=(t||e).map(r=>r.toJSON())),i}toString(){const e=this,t=Hh.find(r=>r in e.constructor.fieldMap),i=t?{[e.constructor.idField]:e.id,[t]:e[t]}:e.data;return _.safeJsonStringify(i)}get isBatchUpdating(){return Boolean(this.batching)}hasBatchedChange(e){var t,i;return(t=this.meta)===null||t===void 0||(i=t.batchChanges)===null||i===void 0?void 0:i[e]}beginBatch(e=!1){const t=this;t.batching||(t.batching=0,t.meta.batchChanges={}),e&&(t.$silenceBatch=(t.$silenceBatch||0)+1),t.batching++}endBatch(e=!1,t=!1){const i=this,{parentIdField:r}=i.constructor;if(!!i.batching&&(i.batching--,i.$silenceBatch&&i.$silenceBatch--,!(i.batching>0)&&!x.isEmpty(i.meta.batchChanges))){const n=F({},i.meta.batchChanges);i.meta.batchChanges=null,n[r]&&(i.parentId=n[r],delete n[r]),i.set(n,ut,e,!1,t)}}cancelBatch(){if(this.batching){const e=this,{batchChanges:t}=e.meta,i={};if(e.batching=null,e.meta.batchChanges=null,e.generation++,!e.$silenceBatch){Object.entries(t).forEach(([n,s])=>{i[n]={oldValue:s,value:e[n]}});const r={action:"update",record:e,records:[e],changes:i};e.stores.forEach(n=>{n.trigger("batchedUpdate",F({},r))}),e.forEachLinked((n,s)=>{n.trigger("batchedUpdate",F(F({},r),{},{record:s,records:[s]}))})}e.$silenceBatch&&e.$silenceBatch--}}triggerBeforeUpdate(e){var t;return!((t=this.stores)!==null&&t!==void 0&&t.some(i=>i.trigger("beforeUpdate",{record:this,changes:e})===!1))}copy(e=null,t){const i=this,r=x.clone(i.data),n=i.constructor.idField,s=x.isObject(t)?t.deep:t;let l;if(e&&typeof e=="object"?(l=e[n],Object.assign(r,e)):l=e,s&&i.children?r.children=i.children.map(a=>a.copy(void 0,t)):(delete r.children,delete r.expanded),i.$meta.fields.initable.length>0){const a=i.toJSON();for(const d of i.$meta.fields.initable)r[d.name]=a[d.name]}e!==!1&&(r[n]=l||i.generateId(i.firstStore));const o=new i.constructor(r,null,null,!1,!0);return o.originalInternalId=i.internalId,o}copyData(e){const t={};e.allFields.forEach(({name:i})=>{i!==e.constructor.idField&&(t[i]=e[i])}),this.set(t)}remove(e=!1){const t=this,{parent:i}=this;i?i.removeChild(t):t.stores.length&&!t.isSpecialRow&&t.stores.forEach(r=>r.remove(t,e,!1,!0))}beforeRemove(e,t){return super.beforeRemove(e,t)}get isValid(){return!0}get firstStore(){return this.stores.length>0&&this.stores[0]}joinStore(e){const t=this,{stores:i}=t;if(!i.includes(e)){const{unjoinedStores:r}=t;super.joinStore(e),e.register(t),i.push(e),r.includes(e)&&r.splice(r.indexOf(e),1),t.isLoaded&&t.children.forEach(n=>n.joinStore(e)),t.initRelations(),e.tree&&!t.isRoot&&(t.instanceMeta(e.id).collapsed=!t.expanded)}}unjoinStore(e,t=!1){const i=this,{stores:r,unjoinedStores:n}=i;if(r.includes(e)){var s,l,o;e.isDestroying||(e.unregister(i),n.push(e)),(s=i.unfilteredChildren||i.children)===null||s===void 0||(l=s.forEach)===null||l===void 0||l.call(s,a=>a.unjoinStore(e,t)),r.splice(r.indexOf(e),1),(o=super.unjoinStore)===null||o===void 0||o.call(this,e,t),e.uncacheRelatedRecord(i)}}isPartOfStore(e){return e?e.includes(this):this.stores.length>0}get isRemoved(){return!this.isPartOfStore()}instanceMeta(e){const{meta:t}=this,i=e.id||e;return t.map||(t.map={}),t.map[i]||(t.map[i]={})}get isGroupHeader(){return"groupRowFor"in this.meta}get isGroupFooter(){return"groupFooterFor"in this.meta}get isSpecialRow(){var e;return Boolean((e=this.meta)===null||e===void 0?void 0:e.specialRow)}get $original(){return this.isLinked?this.proxyMeta.originalRecord:this}static get nonPersistableFields(){const e=this;return e._nonPersistableFields||(e._nonPersistableFields={},e.allFields.forEach(t=>{(!t.persist||t.calculated)&&(e._nonPersistableFields[t.name]=1)})),e._nonPersistableFields}static get alwaysWriteFields(){const e=this;return e._alwaysWriteFields||(e._alwaysWriteFields=[],e.allFields.forEach(t=>{t.alwaysWrite&&e._alwaysWriteFields.push(t.name)})),e._alwaysWriteFields}get domId(){return typeof this.id=="string"?this.id.replace(/[ .]/g,"-"):this.id}static toJavaScriptValue(e){const{names:t}=this.$meta,i=t[t.length-2],r=t[t.length-3];return`class ${i} extends ${r} { static fields = ${_.toJavaScriptValue(this.fields,e)}; }`}getCurrentConfig(e){const{data:t,children:i}=this,{defaultValues:r,applyConfigs:n}=this.constructor,s=n?super.getCurrentConfig(e):{};if(s){for(const l of this.fields)if(l.persist){const o=x.getPath(t,l.dataSource);l.isEqual(o,r[l.name])||x.setPath(s,l.dataSource,$.processConfigValue(o,e))}if(i)if(Array.isArray(i)){s.children=[];for(const l of i)s.children.push(l.getCurrentConfig(e))}else s.children=i;this.hasGeneratedId&&delete s.id,delete s.parentId,delete s.parentIndex}return s}}T(fe,"relations",null);fe._idField="id";fe._internalIdCounter=1;fe._assignedIdField=!1;fe.exposeProperties();fe._$name="Model";class st{constructor(e,t){typeof e=="number"||e===null?(this._magnitude=e,this._unit=t):(typeof e=="string"&&Object.assign(this,E.parseDuration(e)),typeof e=="object"&&Object.assign(this,e))}get magnitude(){return this._magnitude}set magnitude(e){this._magnitude=typeof e=="number"&&e}get unit(){return this._unit}set unit(e){this._unit=E.parseTimeUnit(e)}get isValid(){return this._magnitude!=null&&Boolean(E.normalizeUnit(this._unit))}get milliseconds(){return this.isValid?Math.round(E.asMilliseconds(this._magnitude,this._unit)):0}isEqual(e){return Boolean(e)&&this._magnitude!=null&&e._magnitude!=null&&this.milliseconds===e.milliseconds}toString(e){const t=this,i=e?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?`${t._magnitude} ${E[i](t._unit,t._magnitude!==1)}`:""}toJSON(){return this.toString()}valueOf(){return this.milliseconds}}st._$name="Duration";const Bh=(u,e)=>u?.[e],Vh=/^is(this|next|last)(week|month|year)$/i,zh=["isToday","isTomorrow","isYesterday","isThisWeek","isNextWeek","isLastWeek","isThisMonth","isNextMonth","isLastMonth","isThisYear","isNextYear","isLastYear","isYearToDate"];class ye extends $.mixin(ir){static get defaultConfig(){return{value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null,type:null,internal:null,disabled:!1}}static get configurable(){return{property:null}}construct(e){typeof e=="function"&&(e={filterBy:e}),e.type?e.type==="date"&&e.value!=null&&!Array.isArray(e.value)?e.value=new Date(e.value):e.type==="duration"&&e.value!=null&&!Array.isArray(e.value)&&(e.value=new st(e.value)):E.isDate(e.value)||Array.isArray(e.value)&&e.value.every(E.isDate)?e.type="date":e.value instanceof st&&(e.type="duration"),super.construct(e)}get id(){return this._id||(this.internal?this._id=ye.generateId(`b-internal-${this.property}-filter-`):this._id=this.property||ye.generateId("b-filter-")),this._id}set id(e){this._id=e}onChange(e){var t;const i=this;!i.isConfiguring&&(t=i.owner)!==null&&t!==void 0&&t.onFilterChanged&&!i.owner.isConfiguring&&i.owner.onFilterChanged(i,e)}get filterBy(){return this._filterBy||this.defaultFilterBy}set filterBy(e){this._filterBy=e}defaultFilterBy(e){const t=this;let i;return t._propertyItems.length>1?i=t._propertyItems.reduce(Bh,e):i=e[t.property],t[t.operator](t.convert(i))}updateProperty(e){this._propertyItems=e.split("."),this.onChange("property")}set value(e){const t=this;t._value=e,Array.isArray(e)&&({date:1,duration:1}[t.type]||e.length>0&&typeof e[0]=="string")?t._filterValue=e.map(i=>t.convert(i)):!t.caseSensitive&&Array.isArray(e)&&e.length>0&&typeof e[0]=="string"?t._filterValue=e.map(i=>i?.toLowerCase()):!t.caseSensitive&&typeof e=="string"?t._filterValue=e.toLowerCase():t._filterValue=t.convert(e),t.onChange("value")}get value(){return this._value}get filterValue(){return this._filterValue}set operator(e){this._operator=e,this.onChange("operator")}get operator(){const e=this;return e._operator?e._operator:Array.isArray(e.filterValue)?"isIncludedIn":typeof e.filterValue=="string"?"*":"="}convert(e){if(this.operator!=="sameTime"&&!(typeof this.filterValue=="string"&&e instanceof Date)){var t,i;this.operator==="sameDay"&&(e=E.clearTime(e)),e=(t=(i=e)===null||i===void 0?void 0:i.valueOf())!==null&&t!==void 0?t:e}return e=!this.caseSensitive&&typeof e=="string"?e.toLowerCase():e,e}filter(e){return this.filterBy(e)}startsWith(e){return String(e).startsWith(this.filterValue)}endsWith(e){return String(e).endsWith(this.filterValue)}isIncludedIn(e){return this.filterValue.length===0||this.filterValue.includes(e)}isNotIncludedIn(e){return!this.isIncludedIn(e)}includes(e){return this.filterValue.length===0||String(e).includes(this.filterValue)}doesNotInclude(e){return!this.includes(e)}sameTime(e){return E.isSameTime(e,this.filterValue)}sameDay(e){return e===this.filterValue}"="(e){return x.isEqual(e,this.filterValue)}"!="(e){return!x.isEqual(e,this.filterValue)}">"(e){return x.isMoreThan(e,this.filterValue)}">="(e){return x.isMoreThan(e,this.filterValue)||x.isEqual(e,this.filterValue)}"<"(e){return x.isLessThan(e,this.filterValue)}"<="(e){return x.isLessThan(e,this.filterValue)||x.isEqual(e,this.filterValue)}"*"(e){return x.isPartial(e,this.filterValue)}between(e){const[t,i]=this._filterValue;return(x.isMoreThan(e,t)||x.isEqual(e,t))&&(x.isLessThan(e,i)||x.isEqual(e,i))}notBetween(e){return!this.between(e)}empty(e){return e==null||String(e).length===0}notEmpty(e){return!this.empty(e)}isToday(e){return this.between(e)}isTomorrow(e){return this.between(e)}isYesterday(e){return this.between(e)}isThisWeek(e){return this.between(e)}isNextWeek(e){return this.between(e)}isLastWeek(e){return this.between(e)}isThisMonth(e){return this.between(e)}isNextMonth(e){return this.between(e)}isLastMonth(e){return this.between(e)}isThisYear(e){return this.between(e)}isNextYear(e){return this.between(e)}isLastYear(e){return this.between(e)}isYearToDate(e){return this.between(e)}isTrue(e){return e===!0}isFalse(e){return e===!1}setRelativeDateValues(){this._filterValue=ye.getRelativeDateRange(this._operator).map(e=>e.valueOf())}static getRelativeDateRange(e,t=new Date){let i,r,n,s,l,o,a;switch(e){case"isYearToDate":return[E.floor(t,"1 year"),t];case"isToday":return i=E.floor(t,"1 day"),[i,E.add(i,1,"day")];case"isYesterday":return i=E.floor(t,"1 day"),[E.add(i,-1,"day"),i];case"isTomorrow":return r=E.getStartOfNextDay(t),[r,E.add(r,1,"day")];case"isThisWeek":case"isNextWeek":case"isLastWeek":case"isThisMonth":case"isNextMonth":case"isLastMonth":case"isThisYear":case"isNextYear":case"isLastYear":if(n=e.toLowerCase().match(Vh),!n)throw new Error(`Unrecognized relative date expression: ${e}`);return[,o,a]=n,s=`1 ${a}`,l=E.floor(t,s),o==="next"?l=E.add(l,1,a):o==="last"&&(l=E.add(l,-1,a)),[l,E.add(l,1,a)]}}static generateFiltersFunction(e){if(!e||!e.length&&!e.count)return pe.returnTrue;for(const t of e)t.type==="date"&&zh.includes(t._operator)&&t.setRelativeDateValues();return function(t){let i=!0;for(const r of e)if(r.disabled||(i=r.filter(t)),!i)break;return i}}}T(ye,"$name","CollectionFilter");ye._$name="CollectionFilter";const Co=x.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null));class dn{static generateId(e="generatedId"){return e+(Co[e]=(Co[e]||0)+1)}}dn._$name="IdHelper";class Wr extends ${static get defaultConfig(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}construct(e){typeof e=="function"&&(e={sortFn:e}),super.construct(e)}get id(){return this._id||(this._id=this.property||dn.generateId("b-sorter"))}set id(e){this._id=e}set sortFn(e){this._sortFn=e}get sortFn(){return this._sortFn?this._sortFn:this.defaultSortFn}defaultSortFn(e,t){const i=this,{convert:r,property:n,useLocaleSort:s}=i,l=i.direction.toLowerCase()==="desc"?-1:1;if(e=e[n],t=t[n],r&&(e=r(e),t=r(t)),s&&e!=null&&t!=null&&typeof e=="string"){if(s===!0)return String(e).localeCompare(t);if(typeof s=="string")return String(e).localeCompare(t,s);if(typeof s=="object")return String(e).localeCompare(t,s.locale,s)}return(e>t?1:e<t?-1:0)*l}static generateSortFunction(e,t){const i=e.isCollection?e.values:e,r=i.length;return(n,s)=>{let l,o;for(o=0;o<r;++o)if(l=i[o].sortFn(n,s),l)return l;return t?t(n,s):0}}}Wr._$name="CollectionSorter";let bd;const Wh=()=>0,jh=(u,e)=>e-u,es=Symbol("filteredIndicesProperty"),oi=Object.freeze([]),Gh=Object.freeze({action:"sort",added:oi,removed:oi,replaced:oi}),Uh=Object.freeze({action:"filter",added:oi,removed:oi,replaced:oi}),_t={string:1,number:1};function yd(u,e,t){if(e.unique!==!1)e.set(t,u);else{let i=e.get(t);i||(i=new Set,e.set(t,i)),i.add(u)}}function Yh(u,e,t){e.unique!==!1?e.delete(t):e.has(t)&&(e.get(t).delete(u),e.get(t).size||e.delete(t))}function wo(u,e,t,i){for(let r=0;r<u.length;r++){const n=u[r];for(let s=0;s<i;s++){const l=t[s],o=n[l],a=e[l];yd(n,a,o)}}}bd=Symbol.iterator;class at extends $.mixin(Me){constructor(...e){super(...e),T(this,"_sortFunction",null),T(this,"_addedValues",null)}static get configurable(){return{idProperty:"id",extraKeys:null,autoFilter:!0,autoSort:!0,sorters:{$config:["lazy"],value:[]}}}get isCollection(){return!0}construct(e){this.generation=0,this._values=[],super.construct(e)}doDestroy(){var e;super.doDestroy();const t=this;t._values.length=0,t.isFiltered&&(t._filteredValues.length=0,t.filters.destroy()),(e=t._sorters)===null||e===void 0||e.destroy()}clear(){const e=this,t=e._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}equals(e,t){if(e.isCollection&&(e=e.values),e.length===this.count){let{values:i}=this;return t&&(e=e.map(t),i=i.map(t)),B.delta(e,i).inBoth.length===this.count}return!1}replaceValues({values:e,filteredValues:t,silent:i=!1,isNewDataset:r=!1}){const n=this;let s,l;n.isFiltered&&!r?(Boolean(t)?e&&(s=n._values,n._values=e.slice()):(t=e.slice(),e=null),l=n._filteredValues,n._filteredValues=t.slice()):(s=n._values,n._values=e.slice(),t=null,n.isFiltered&&r&&n.autoFilter?(n._filterFunction=null,n._filteredValues=n._values.filter(n.filterFunction)):n._filteredValues&&(n._filteredValues.length=0)),n._indicesInvalid=!0,n._addedValues=void 0,n.generation++,i||n.trigger("change",{action:"replaceValues",replacedValues:s,replacedFilteredValues:l,values:e,filteredValues:t})}set values(e){this.invalidateIndices(),this.splice(0,this._values.length,e)}get values(){return this.isFiltered?this._filteredValues:this._values}get filteredValues(){return this._filteredValues}[bd](){return this.values[Symbol.iterator]()}forEach(e,t=!1){(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}map(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}find(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}get first(){return this.values[0]}get last(){return this.values[this.count-1]}get allValues(){return this._values}get addedValues(){return this._addedValues}match(e,t=!0){const i=this,{_values:r}=i,n=[];return i.forEach(s=>{const l=e.get(s.id,!0);if(l){const o=i.indexOf(s,!0),a=r[o];r[o]=l,i.removeFromIndices(a),i.addToIndices(l)}else t&&n.push(s)}),n.length&&i.remove(n),i.isFiltered&&(i._filteredValues=i._values.filter(i.filterFunction)),n}add(...e){e.length===1?this.splice(this._values.length,null,...e):this.splice(this._values.length,null,e)}remove(...e){e.length===1?this.splice(0,...e):this.splice(0,e)}move(e,t){for(e=B.asArray(e);e.length&&e[0]===t;)e.shift();if(!e.length)return;const i=this,{_values:r}=i,n=i.indexOf(e[0],!0);if(e.length===1&&r[n+1]===t)return;i.suspendEvents(),i.remove(e),i.resumeEvents();const s=t?i.indexOf(t,!0):r.length;if(s===-1)throw new Error("Collection move beforeItem parameter must be present in Collection");return r.splice(s,0,...e),i._indicesInvalid=1,i.trigger("change",{action:"move",items:e,from:n,to:s}),s}splice(e=0,t,...i){const r=this,n=r.idProperty,s=r._values,l={},o=[],a=[],d=r.totalCount;let c,h;if(r.trigger("beforeSplice",{index:e,toRemove:t,toAdd:i})!==!1){if(i)if(i.length===1&&Array.isArray(i[0])&&(i=i[0]),d&&i.length){const g=r.indices[n];c=[];for(let f=0;f<i.length;f++){const m=i[f],p=m[n],v=g.get(p),y=v?s.indexOf(v):-1;l[p]=!0,y!==-1?s[y]!==m&&(a.push([s[y],m]),s[y]=m):c.push(m)}}else c=i;if(t){if(typeof t=="number"){t=Math.min(t,s.length-e);for(let g=e;t;--t){const f=s[g][n];l[f]?(e++,g++):(o.push(s[g]),s.splice(g,1),h=!0)}}else{let g=c.length===0,f;t=B.asArray(t);const m=t.reduce((p,v)=>{const y=typeof v=="number",C=y?v:r.indexOf(v,!0);return g&&(f!=null&&C!==f+1||y)&&(g=!1),C>=0&&C<d&&p.push(C),f=C,p},[]).sort(jh);if(g)m.length&&(o.push.apply(o,t),s.splice(m[m.length-1],m.length),h=!0);else for(let p=0;p<m.length;p++){const v=m[p];if(v!==-1){const y=s[v][n];l[y]||(o.unshift(s[v]),s.splice(v,1),h=!0)}}}o.length&&!r._indicesInvalid&&o.forEach(r.removeFromIndices,r)}if(c.length){s.splice(Math.min(e,s.length),0,...c),h=!0,r._indicesInvalid||c.forEach(r.addToIndices,r),r._addedValues||(r._addedValues=new Set);for(const g of c)r._addedValues.add(g)}if(o.length&&r._addedValues)for(const g of o)r._addedValues.delete(g);a.length&&!r._indicesInvalid&&a.forEach(g=>{r.removeFromIndices(g[0]),r.addToIndices(g[1])}),h||a.length?(r.isSorted?r.onSortersChanged():r.isFiltered&&(r.autoFilter?r.onFiltersChanged({action:"splice",oldCount:1}):r._filteredValues.splice(Math.min(e,r._filteredValues.length),0,...c)),r.generation++,r.trigger("change",{action:"splice",removed:o,added:c,replaced:a,oldCount:d})):r.trigger("noChange",{index:e,toRemove:t,toAdd:i})}}changeId(e,t){const i=this,{idProperty:r}=i,n=_t[typeof e]?e:e[r],s=i.get(n);if(s){const l=i.get(t);if(l&&s!==l)throw new Error(`Attempt to set item ${n} to already existing member's id ${t}`);i.removeIndexEntry(e,r,n),i.addIndexEntry(e,r,t),s[r]=t}}get(e,t=!1){return this.getBy(this.idProperty,e,t)}getAt(e,t=!1){return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}getBy(e,t,i=!1){return this.findItem(e,t,this.isFiltered&&i)}get count(){return this.values.length}get totalCount(){return this._values.length}updateIdProperty(e){this.addIndex({property:e,unique:!0})}changeSorters(e){return new at({values:B.asArray(e),internalListeners:{change:"onSortersChanged",thisObj:this}})}addSorter(e){const t=e instanceof Wr?e:new Wr(e);return this.sorters.add(t),t}get isSorted(){var e;return Boolean((e=this._sorters)===null||e===void 0?void 0:e.count)}onSortersChanged(){const e=this;e._sortFunction=null,e._addedValues=null,e._values.sort(e.sortFunction),e.trigger("change",Gh)}get sortFunction(){return this._sortFunction||(this.isSorted?this._sortFunction=Wr.generateSortFunction(this.sorters.values):this._sortFunction=Wh),this._sortFunction}get filters(){return this._filters||(this._filters=new at({internalListeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}addFilter(e){const t=e instanceof ye?e:new ye(e);return this.filters.add(t),t}removeFilter(e){const{filters:t}=this;e.isCollectionFilter||(e=t.get(e)),t.remove(e)}clearFilters(){this.filters.clear()}get isFiltered(){return Boolean(this._filters&&this._filters.count)}onFiltersChanged({action:e,removed:t,oldCount:i}){const r=this,n=i||e==="clear"&&t.length?r._filteredValues:r._values;r._filterFunction=null,r._filteredValues=r._values.filter(r.filterFunction),r._indicesInvalid=!0;const{toAdd:s,toRemove:l}=B.delta(r._filteredValues,n,!0);r.trigger("change",F(F({},Uh),{},{added:s,removed:l}))}get filterFunction(){return this._filterFunction||(this.isFiltered?this._filterFunction=ye.generateFiltersFunction(this.filters.values):this._filterFunction=pe.returnTrue),this._filterFunction}changeExtraKeys(e){return B.asArray(e).map(i=>typeof i=="string"?{property:i,unique:!0}:i)}updateExtraKeys(e){for(let t=0;t<e.length;t++)this.addIndex(e[t])}addIndex(e){const t=this;e&&((t._indices||(t._indices={}))[e.property]=new Map,Object.assign(t._indices[e.property],e),t.invalidateIndices(),e.dependentOn&&(t.hasCompositeIndex=!0))}findIndex(e,t,i=!1){const r=this.findItem(e,t,i);return r?(this.isFiltered&&!i?this._filteredValues:this._values).indexOf(r):-1}findItem(e,t,i=!1){const r=this,{isFiltered:n}=r,s=n&&!i?r.indices[es][e]:r.indices[e];if(s){var l;const o=(l=s.get(t))!==null&&l!==void 0?l:typeof t=="string"&&t.length&&!isNaN(t)&&s.get(Number(t))||null;if(o!=null)return o}else{const o=n&&!i?r._filteredValues:r._values,a=o.length;for(let d=0;d<a;d++){const c=o[d];if(c[e]==t)return c}}return null}removeIndex(e){delete this._indices[e],this.hasCompositeIndex=Object.values(this.indices).some(t=>t.dependentOn)}indexOf(e,t=!1){return this.findIndex(this.idProperty,_t[typeof e]?e:e[this.idProperty],t)}includes(e,t=!1){return Array.isArray(e)?e.some(i=>this.includes(i)):Boolean(this.findItem(this.idProperty,_t[typeof e]?e:e[this.idProperty],t))}get indices(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}invalidateIndices(){this._indicesInvalid=!0}rebuildIndices(){const e=this,t=e.isFiltered,i=e._indices||(e._indices={}),r=Object.keys(i),n=r.length,s=e._values;let l;t&&(l=i[es]={});for(let o=0;o<n;o++){const a=i[r[o]];if(a.clear(),t){let d=l[r[o]];d?d.clear():(d=l[r[o]]=new Map,d.unique=a.unique)}}wo(s,i,r,n),t&&wo(e._filteredValues,l,r,n),e._indicesInvalid=!1}getIndices(e){const t=[this.indices[e]];return this.isFiltered&&t.push(this.indices[es][e]),t}addToIndices(e){Object.keys(this.indices).forEach(t=>{this.addIndexEntry(e,t,e[t])})}removeFromIndices(e){Object.keys(this.indices).forEach(t=>{this.removeIndexEntry(e,t,e[t])})}removeIndexEntry(e,t,i){this.getIndices(t).forEach(r=>Yh(e,r,i))}addIndexEntry(e,t,i){this.getIndices(t).forEach(r=>yd(e,r,i))}onItemMutation(e,t){const i=this;!i._indicesInvalid&&Object.keys(i.indices).length>1&&Object.keys(t).forEach(r=>{if(i.indices[r]){const{value:l,oldValue:o}=t[r];i.removeIndexEntry(e,r,o),i.addIndexEntry(e,r,l)}else if(i.hasCompositeIndex){const l=Object.values(i.indices).find(o=>{var a;return(a=o.dependentOn)===null||a===void 0?void 0:a[r]});if(l){const o={};for(const d in l.dependentOn){var s;o[d]=((s=t[d])===null||s===void 0?void 0:s.oldValue)||e[d]}const a=e.buildIndexKey(o);i.removeIndexEntry(e,l.property,a),i.addIndexEntry(e,l.property,e[l.property])}}})}}at._$name="Collection";const xo=new WeakMap,Pi=u=>{if(u&&typeof u=="object"){let e=xo.get(u);e===void 0&&(e=Symbol("bscik"),xo.set(u,e)),u=e}return u};class Jr{constructor(e){const t=this;t.generation=0,t.items=new Set,t.idMap={},t.idProperty="id",e&&(e.idProperty&&(t.idProperty=e.idProperty),e.values&&(t.values=e.values))}get(e){return this.idMap[Pi(e)]}get count(){return this.items.size}add(...e){e.length===1&&Array.isArray(e[0])&&(e=e[0]);const t=this,{items:i,idMap:r,idProperty:n}=t,s=e.length;for(let l=0;l<s;l++){const o=e[l],a=_t[typeof o]?o:Pi(o[n]),d=r[a];d==null?(r[a]=o,i.add(o),t.generation++):d!==o&&(r[a]=o,i.delete(d),i.add(o))}}at(e){let t,i;e<0&&(e+=this.count);for(t of this.items)if(!e--){i=t;break}return i}remove(e){e=B.asArray(e);const{items:t,idMap:i,idProperty:r}=this,n=e.length;for(let s=0;s<n;s++){const l=e[s],o=_t[typeof l]?l:Pi(l[r]),a=i[o];a!=null&&(t.delete(a),delete i[o],this.generation++)}}clear(){this.items.clear(),this.idMap={},this.generation++}countOf(e){let t=0,i;for(i of this.items)e(i)&&++t;return t}changeId(e,t){const i=this,{idMap:r,idProperty:n}=i,s=_t[typeof e]?e:Pi(e[n]),l=i.get(s);if(l){const o=i.get(t);if(o&&l!==o)throw new Error(`Attempt to set item ${s} to already existing member's id ${t}`);l[n]=t,delete r[s],r[t]=l}}filter(e,t){const{items:i}=this,r=[];let n=0;return i.forEach(s=>{e.call(t,s,n++,i)&&r.push(s)}),r}includes(e){const t=_t[typeof e]?e:Pi(e[this.idProperty]);return Boolean(this.idMap[t])}map(e,t){const{items:i}=this,r=new Array(i.size);let n=0;return i.forEach(s=>{r[n]=e.call(t,s,n++,i)}),r}forEach(e,t){return this.items.forEach(e,t)}find(e,t=0){let i,r;t<0&&(t+=this.countOf(e));for(i of this.items)if(e(i)&&!t--){r=i;break}return r}[Symbol.iterator](){return this.items[Symbol.iterator]()}indexOf(e,t){let i=-1,r;for(r of this.items)if((!t||t(r))&&(++i,r===e))return i;return-1}get values(){return[...this.items]}set values(e){e=B.asArray(e),this.clear(),this.add.apply(this,e),this.generation++}sort(e){this.values=this.values.sort(e)}some(e,t){return this.values.some(e,t)}}Jr._$name="Bag";class jr extends Jr{add(...e){return e.length===1&&Array.isArray(e[0])&&(e=e[0]),super.add(...e.filter(t=>t.isPersistable))}}jr._$name="StoreBag";var qh=u=>class extends(u||$){static get $name(){return"StoreCRUD"}static get defaultConfig(){return{autoCommit:!1}}static get properties(){return{isRemoving:!1,suspendCount:0}}remove(t,i=!1){const r=this,{storage:n}=r;if(t=B.asArray(t).reduce((s,l)=>(l=r.getById(l),l&&s.push(l),s),[]),t.length===0)return t;if(r.isRemoving=!0,r.isGrouped){const s=n.count,l=[],o=new Set;for(const a of t){const{groupParent:d}=a.instanceMeta(r);d.meta.collapsed&&l.push(a),B.remove(d.groupChildren,a),d.meta.childCount--,o.add(d)}for(const a of o)a.groupChildren.length>0&&r.onModelChange(a,{},{});l.length&&n.trigger("change",{action:"splice",removed:l,added:[],replaced:[],oldCount:s})}else if(r.tree){const s=[],l=t.length>1,o=t[0],a=l?void 0:n.indexOf(o),d=t.reduce((c,h)=>{const{parent:g}=h;return g&&(c[g.id]||(c[g.id]=[g,[]]),c[g.id][1].push(h)),c},{});if(!i&&r.trigger("beforeRemove",{records:t,isMove:!1,parent:l?void 0:o.parent})===!1)return r.isRemoving=!1,[];for(const c of Object.values(d)){const h=c[0],g=c[1];s.push(...h.removeChild(g,!1,!0))}return i||(r.trigger("remove",{parent:l?void 0:o.parent,index:a,isChild:!0,allRecords:s,isMove:!1,records:t}),r.trigger("change",{action:"remove",records:t}),r.isRemoving=!1),t}for(const s of t)s.beforeRemove(t);return t.length===0?t:!i&&r.trigger("beforeRemove",{records:t})===!1?(r.isRemoving=!1,[]):(i&&r.suspendEvents(),n.remove(t),i&&r.resumeEvents(),r.autoCommit&&r.doAutoCommit(),r.isRemoving=!1,t)}clear(t=!1){var i,r;const n=this,{storage:s}=n;if(n.storage.totalCount||(i=n.rootNode)!==null&&i!==void 0&&(r=i.unfilteredChildren)!==null&&r!==void 0&&r.length){if(!t&&n.trigger("beforeRemove",{records:s.allValues,removingAll:!0})===!1)return null;if(n.rootNode)n.isChained||n.rootNode.clearChildren(t);else if(t){const l=n.registeredRecords;for(let o=l.length-1,a;o>=0;o--)a=l[o],a&&!a.isDestroyed&&a.unjoinStore(n)}t&&(n.removed.clear(),s.suspendEvents()),s.clear(),t&&s.resumeEvents(),n.added.clear(),n.modified.clear()}}removeAll(t=!1){const i=this,r=i.storage;let n;if(i.isRemoving=!0,t){r.suspendEvents();const s=i.registeredRecords;for(let l=s.length-1,o;l>=0;l--)o=s[l],o&&!o.isDestroyed&&!o.isRoot&&o.unjoinStore(i)}return i.tree?n=i.rootNode.clear()!==!1:n=i.clear()!==null,t&&r.resumeEvents(),i.isRemoving=!1,n}add(t,i=!1,r={}){var n;const s=this,{storage:l}=s;if(t=B.asArray(t),!((n=t)!==null&&n!==void 0&&n.length))return;if(s.tree=s.tree||Boolean(s.autoTree&&t[0].children),s.tree){const a=new Map,d=s.modelClass.getFieldDataSource("parentIndex"),{parentIdField:c}=s.modelClass,h=[];return t.forEach(g=>{const f=g[c];a.has(f)||a.set(f,{append:[],insert:[]});const m=a.get(f);!g.isModel&&d in g?m.insert.push(g):m.append.push(g)}),a.forEach(({append:g,insert:f},m)=>{const p=m==null?s.rootNode:s.getById(m);if(!p)throw new Error(`Parent node with id ${m} not found, cannot add children.`);if(g.length&&h.push(...p.appendChild(g,i)),f.length)for(const v of f)h.push(p.insertChild(v,v[d],i,r))}),s.reapplySortersOnAdd&&s.sort(),h}if(!i&&s.trigger("beforeAdd",{records:t})===!1)return null;if(s.tree=s.tree||Boolean(s.autoTree&&t[0].children),s.tree)return s.rootNode.appendChild(t);const o=s.processRecords(t);return i&&s.suspendEvents(),l.add(o),i&&s.resumeEvents(),s.autoCommit&&s.doAutoCommit(),o}processRecords(t,i){return t.map(r=>{const n=this.processRecord(r.isModel?r:this.createRecord(r));return i?.call(this,n),n})}insert(t,i,r=!1){const n=this,s=n.storage,l=n.getAt(t),o=s.values,a=[];if(i=B.asArray(i),!r&&n.trigger("beforeAdd",{records:i})===!1)return null;let d,c,h;if(o[c=t]===i[0]||o[c=t-1]===i[0])for(d=!0,h=0;d&&h<i.length;h++)i[h]!==o[c+h]&&(d=!1);if(d)return null;const g=n.processRecords(i,m=>{const p=s.indexOf(m);m.children&&m.children.length&&n.autoTree&&(n.tree=!0),p>-1&&(p<t&&l&&t--,a.push(p)),m.meta.previousIndex=p});if(n.tree){var f;const m=n.rootNode;return m.insertChild(i,(f=m.children)===null||f===void 0?void 0:f[t],r)}return n.suspendEvents(),n.storage.remove(a),n.resumeEvents(),r&&n.suspendEvents(),s.splice(t,0,...g),r&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),g}move(t,i){this.isTree?i.parent.insertChild(t,i):this.storage.move(t,i)}setMultiple(t,i,r){const n=this,s=[],l=[];n.forEach(o=>{t(o)&&(l.push(o.set(i,r,!0)),s.push(o))}),n.trigger("updateMultiple",{records:s,all:n.records.length===s.length}),n.trigger("change",{action:"updatemultiple",records:s,all:n.records.length===s.length}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}setAll(t,i){const r=this,n=[];r.forEach(s=>{n.push(s.set(t,i,!0))}),r.trigger("updateMultiple",{records:r.records,all:!0}),r.trigger("change",{action:"updatemultiple",records:r.records,all:!0}),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}acceptChanges(){const t=this;t.added.forEach(i=>i.clearChanges(!0,!1)),t.modified.forEach(i=>i.clearChanges(!0,!1)),t.added.clear(),t.modified.clear(),t.removed.clear()}commit(t=!1){const{changes:i}=this;return!t&&this.trigger("beforeCommit",{changes:i})===!1?!1:(this.acceptChanges(),t||this.trigger("commit",{changes:i}),i)}revertChanges(){const t=this,{changes:i}=t;if(i){const r={action:"clearchanges",changes:i};t.add(t.removed.values,!0),t.remove(t.added.values,!0),t.modified.forEach(n=>n.revertChanges(!0)),t.added.clear(),t.modified.clear(),t.removed.clear(),t.trigger("change",r),t.trigger("refresh",r)}}get changes(){const t=this,i=t.modified.values.filter(r=>r.rawModifications);return t.added.count||i.length||t.removed.count?{added:t.added.values.slice(),modified:i,removed:t.removed.values.slice()}:null}get autoCommit(){return this._autoCommit}set autoCommit(t){this._autoCommit=t,t&&this.changes&&this.commit()}suspendAutoCommit(){this.suspendCount++}resumeAutoCommit(t=!0){this.suspendCount--,this.autoCommit&&t&&this.doAutoCommit()}doAutoCommit(){this.suspendCount<=0&&this.commit()}},Kh=u=>class extends(u||$){static get $name(){return"StoreChanges"}static get configurable(){return{applyChangesetFilterSortTarget:"changes"}}applyChangesFromStore(t){const i=this,{changes:r}=t;!r||(r.added&&i.add(r.added),r.removed&&i.remove(r.removed.map(n=>n.id)),r.modified&&r.modified.forEach(n=>{i.getById(n.id).set(n.modifications)}))}applyChangeset(t,i=null,r="$PhantomId",n=!0,s=!1){var l,o;const a=this,{added:d,updated:c,modified:h,removed:g}=(l=i?.(t,a))!==null&&l!==void 0?l:t,f=(o=c??h)!==null&&o!==void 0?o:[],m=a.modelClass.getFieldDataSource("id"),p=s?new Map:null,v=[],y=[];let C=!1,w=[];if(d?.length>0){var S;const I=[],R=[];for(const L of d){var D;a.getById((D=L[r])!==null&&D!==void 0?D:x.getPath(L,m))?I.push(L):R.push(L)}f.unshift.apply(f,I);const H=(S=a.add(R,!1,{orderedParentIndex:{skip:!0}}))!==null&&S!==void 0?S:[];if(v.push(...H),a.tree)for(const L of H){const{parent:V}=L;if(V.isRoot){C=!0,w=[V];break}!V.isRoot&&w.every(U=>!U.contains(V))&&w.push(V)}for(const L of H)p?.set(L.id,L.data),L.clearChanges()}if(f?.length>0)for(const I of f){const R=I[r],H=x.getPath(I,m),L=a.getById(R??H);if(L){const V=L.applyChangeset(I,r,n);a.tree&&!C&&w.every(U=>!U.contains(L))&&(L.parent.isRoot?(C=!0,w=[L.parent]):w.push(L.parent)),p?.set(H,V),y.push(L)}}return g?.length>0&&a.applyRemovals(g),a.afterChangesetApplied(w),a.applyChangesetFilterSortTarget==="changes"&&a.filterChangeset(v,y,a.isSorted?a.createSorterFn(a.sorters):void 0),p}afterChangesetApplied(t){t.forEach(i=>{i.traverse(r=>{r.sortOrderedChildren(!1,!1),r.children&&r.updateChildrenIndices(r.children,"parentIndex",!0),r.unfilteredChildren&&r.updateChildrenIndices(r.unfilteredChildren,"unfilteredIndex",!0)})})}applyRemovals(t){const i=this,{removed:r}=i,n=i.modelClass.idField,s=[];for(const l of t){const o=x.getPath(l,n);r.includes(o)?r.remove(o):s.push(o)}i.remove(s);for(const l of s)r.remove(l)}filterChangeset(t,i,r){const n=this,{isFiltered:s,isGrouped:l,tree:o}=n,{allValues:a,addedValues:d,isSorted:c,filterFunction:h}=n.storage,g=r!=null||c?r??n.storage.sortFunction:null;if(o||!s)return!1;let f=!1,m=!1,p;l&&(p=n.groupers,n.clearGroupers(!0));const{filteredValues:v}=n.storage;if(g){const C=d?v.findLastIndex(D=>!d.has(D))+1:v.length,w=v.slice(0,C),S=new Set(i.filter(h));for(const D of v)S.has(D)&&S.delete(D);for(const D of S)w.push(D);w.sort(g),v.splice(0,C,...w),m=!0}else{const C=new Set(i.filter(I=>h(I)&&!n.storage.includes(I)));let w=0,S=0,D=C.size===0;for(;S<a.length&&!D;){const I=v[w];let R=a[S];for(;I!==R;)C.has(R)&&(v.splice(w,0,R),m=f=!0,w++,C.delete(R),D=C.size===0),R=a[++S];w<v.length&&w++}}const y=new Set(t.filter(C=>!h(C)));for(let C=v.length-1;C>=0;C--){const w=v[C];y.has(w)&&(v.splice(C,1),m=f=!0,y.delete(w))}return p&&(n.group(p[0],null,!1,!0,!0),m=!0),m&&(n._idMap=null,n.trigger("refresh")),f}},Xh=u=>class extends(u||$){static get $name(){return"StoreFilter"}static get defaultConfig(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}set reapplyFilterOnAdd(t){this.storage.autoFilter=t}get reapplyFilterOnAdd(){return this.storage.autoFilter}set filters(t){const i=this,r=i.filters;if(r.clear(),i._filtersFunction=null,t){if(t.constructor.name==="Object")for(const n of Object.entries(t))n[0]==="filterBy"&&typeof n[1]=="function"?r.add(new ye({filterBy:n[1]})):r.add(new ye(n[1].constructor.name==="Object"?Object.assign({property:n[0]},n[1]):{property:n[0],value:n[1]}));else Array.isArray(t)?r.add(...t.map(n=>n instanceof ye?n:new ye(n))):t.isCollection?r.add(...t.values):r.add(new ye({filterBy:t}));r.forEach(n=>n.owner=i)}}get filters(){return this._filters||(this._filters=new at({extraKeys:["property"]}))}set filtersFunction(t){this._filtersFunction=t}get filtersFunction(){const t=this,{filters:i,isGrouped:r}=t;if(!t._filtersFunction)if(i.count){const n=ye.generateFiltersFunction(i);t._filtersFunction=s=>r&&s.isSpecialRow?s.groupChildren.some(n):n(s)}else t._filtersFunction=pe.returnTrue;return t._filtersFunction}get isFiltered(){return this.filters.values.some(t=>!t.disabled)}traverseFilter(t){const i=this,r=!t.isRoot&&i.filtersFunction(t),n=t.unfilteredChildren||t.children;return!n||!n.length?r:(t.unfilteredChildren||(t.unfilteredChildren=t.children.slice()),t.children=t.unfilteredChildren.filter(s=>i.traverseFilter(s)),t.updateChildrenIndices(t.unfilteredChildren,"unfilteredIndex",!0),t.updateChildrenIndices(t.children,"parentIndex",!0),r||Boolean(t.children.length))}traverseClearFilter(t){const i=this;t.unfilteredChildren&&(t.children=t.unfilteredChildren.slice(),t.unfilteredChildren=null),t.children&&(t.children.forEach(r=>i.traverseClearFilter(r)),t.updateChildrenIndices(t.children,"parentIndex",!0))}get latestFilterField(){return this.filters.last?this.filters.last.property:null}addFilter(t,i=!1){const r=this;if(t=t instanceof ye?t:new ye(t),t.owner=r,r.filters.add(t),!i){if(r.remoteFilter)return r.filter().then(()=>t);r.filter()}return t}filter(t){const i=this;let r=!1,n;if(t){let s=typeof t;if(s==="object"&&("silent"in t||"replace"in t||t.filters)&&(r=t.silent,t.replace&&i.clearFilters(t.filters.length===0),n=t.internal,t=t.filters,s=typeof t),t){const l=i.isFiltered;if(i.isConfiguring=!0,Array.isArray(t))t.forEach(o=>i.addFilter(o,!0),i);else if(s==="function"){const o=new ye(t);o.internal=n,i.addFilter(o,!0)}else s==="string"?i.addFilter({property:t,value:arguments[1]},!0):i.addFilter(t,!0);if(i.isConfiguring=!1,!i.isFiltered&&!l)return null}}return i.filtersFunction=null,i.performFilter(r)}performFilter(t){const i=this,{storage:r,filters:n,rootNode:s}=i,l=i.count;i.trigger("beforeFilter",{filters:n});let o,a;if(i.tree){const d=r.values;i.isFiltered?i.traverseFilter(s):i.traverseClearFilter(s);const c=i.collectDescendants(s).visible;r.replaceValues({values:c,silent:!0});const h=B.delta(c,d,!0);o=h.toAdd,a=h.toRemove}else r.ion({change({removed:d,added:c}){a=d,o=c},once:!0}),i.isFiltered?(i.isGrouped&&i.includeCollapsed(),r.addFilter({id:"primary-filter",filterBy:i.filtersFunction}),i.isGrouped&&i.excludeCollapsed()):r.filters.clear();i.afterPerformFilter(t||i.isRemoteDataLoading?null:{action:"filter",filters:n,oldCount:l,added:o,removed:a,records:i.storage.values})}afterPerformFilter(t){this.resetRelationCache(),t&&this.triggerFilterEvent(t)}get filtered(){return this.storage.isFiltered}triggerFilterEvent(t){this.trigger("filter",t),this.remoteFilter||(this.trigger("refresh",t),this.trigger("change",t))}filterBy(t){return this.filter(t)}removeFilter(t,i=!1){const r=this,n=t instanceof ye?t:r.filters.get(t);if(n){if(r.filters.remove(n),r._filtersFunction=null,!i){if(r.remoteFilter)return r.filter().then(()=>n);r.filter()}return n}}clearFilters(t=!0){if(this.filters.remove(this.filters.values.filter(i=>!i.internal)),t)return this.filter()}convertFilterToString(t){const i=this.filters.getBy("property",t);return i&&!i.filterBy?String(i):""}doDestroy(){var t;(t=this._filters)===null||t===void 0||t.destroy(),super.doDestroy()}};const Jh={add:1,replace:1};var Qh=u=>class extends(u||$){static get $name(){return"StoreGroup"}static get defaultConfig(){return{groupers:null,useGroupFooters:!1}}static get properties(){return{collapsedGroups:new Set}}construct(t){super.construct(t),this.ion({change:"onDataChanged",thisObj:this})}get groupers(){return this._groupers}set groupers(t){this.setGroupers(t)}setGroupers(t,i){const r=this,{storage:n}=r;let s;return t!=null&&t.length?r._groupers=t:r.groupers&&(delete r._groupers,r.includeCollapsed(),n.replaceValues({values:r.removeHeadersAndFooters(n._values),filteredValues:n.isFiltered?r.removeHeadersAndFooters(n._filteredValues):null,silent:!0}),s=r.group(null,null,null,!1,i?.silent)),r._idMap=null,s}get groupRecords(){const t=[];if(this.isGrouped)for(const i of this)i.isSpecialRow&&t.push(i);return t}includeCollapsed(){for(const t of this.collapsedGroups)this.expand(this.getById(t),!1)}excludeCollapsed(){for(const t of this.collapsedGroups)this.collapse(this.getById(t))}onDataChange({source:t,action:i,removed:r}){var n;const s=this,{groupers:l}=s;l&&(l.length?(i==="splice"&&r!==null&&r!==void 0&&r.length||i==="move")&&t.replaceValues({values:s.prepareGroupRecords(),silent:!0}):t.replaceValues({values:s.removeHeadersAndFooters(t.values),silent:!0})),(n=super.onDataChange)===null||n===void 0||n.call(this,...arguments)}move(t,i){const r=this;if(r.isGrouped){var n;if((n=i)!==null&&n!==void 0&&n.isSpecialRow&&(i=r.getPrev(i,!1,!1),!i))return;const s=r.groupers[0].field;let l;i?l=i.isGroupHeader?i.meta.groupRowFor:i[s]:l=r.groupRecords[r.groupRecords.length-1].meta.groupRowFor,r.beginBatch(),t.forEach(o=>o[s]=l),r.endBatch()}super.move(...arguments)}collapse(t){return t&&!t.meta.collapsed?(this.excludeGroupRecords(t),t.meta.collapsed=!0,this.collapsedGroups.add(t.id),!0):!1}expand(t,i=!0){return t!=null&&t.meta.collapsed?(this.includeGroupRecords(t),t.meta.collapsed=!1,i&&this.collapsedGroups.delete(t.id),!0):!1}removeHeadersAndFooters(t){return t.filter(i=>i.isSpecialRow?(this.unregister(i),!1):!0)}prepareGroupRecords(t){var i;const r=this,n=r.collapsedGroups,s=[];let l=(i=r.storage.filteredValues)!==null&&i!==void 0?i:r.storage.values;for(const f of l)f.isGroupHeader&&(f.meta.collapsed||n.has(f.id))&&(n.add(f.id),s.push(f));for(const f of s)r.includeGroupRecords(f);if(l=r.removeHeadersAndFooters(r.storage.values),t&&(l=l.sort(t)),!r.isGrouped)return l;const o=[],a=r.groupers[0].field;let d=null,c=null,h=0;function g(){const f=c.meta.groupRowFor,m=`group-footer-${typeof f=="number"?f:_.createId(f)}`,p=r.getById(m)||new r.modelClass({id:m},r,{specialRow:!0,groupFooterFor:f,groupRecord:c});return p.stores=[r],r.register(p),p.groupChildren=c.groupChildren,c.meta.collapsed||o.push(p),r.allRecords.push(p),c.groupChildren.push(p),h++,p}return l.forEach(f=>{var m;const p=f[a]==null?"__novalue__":f[a],v=`group-header-${typeof p=="number"?p:_.createId(p)}`;if(((m=f.groupChildren)===null||m===void 0?void 0:m.length)===0){r.unregister(f);return}x.isEqual(p,d)||(c&&(r.useGroupFooters&&g(),c.meta.childCount=h),c=r.getById(v)||new r.modelClass({id:v},r,{specialRow:!0,groupRowFor:p,groupField:a}),c.meta.collapsed=n.has(v),c.stores=[r],r.register(c),c.groupChildren=[],o.push(c),r.allRecords.push(c),d=p,h=0),f.instanceMeta(r.id).groupParent=c,n.has(v)||o.push(f),c.groupChildren.push(f),h++}),c&&(r.useGroupFooters&&g(),c.meta.childCount=h),r._idMap=null,o}get isGrouped(){var t;return Boolean((t=this.groupers)===null||t===void 0?void 0:t.length)}group(t,i,r=!1,n=!0,s=!1){const l=this;let o,a;if(t&&typeof t=="object"&&(i=t.ascending,a=t.fn,t=t.field),r)l.groupers.push(o={field:t,ascending:i,complexMapping:t.includes(".")});else if(t){if(i==null){var d,c;i=((d=l.groupInfo)===null||d===void 0?void 0:d.field)===t&&((c=l.groupInfo)===null||c===void 0?void 0:c.fn)===a?!l.groupInfo.ascending:!0}l.groupInfo=o={field:t,ascending:i,fn:a,complexMapping:t.includes(".")},l.groupers=[l.groupInfo]}if(o){const{prototype:h}=l.modelClass;o.complexMapping&&!Object.prototype.hasOwnProperty.call(h,t)&&Object.defineProperty(h,t,{get(){return x.getPath(this,t)}})}if(n!==!1){if(l.remoteSort&&!l.isRemoteDataLoading)return l.sort(null,null,!1,!0).then(()=>l.onAfterGrouping(s));l.sort(null,null,!1,!0)}l.onAfterGrouping(s)}onAfterGrouping(t){if(t)return;const i=this;i.trigger("group",{isGrouped:i.isGrouped,groupers:i.groupers,records:i.storage.values}),i.trigger("refresh",{action:"group",isGrouped:i.isGrouped,groupers:i.groupers,records:i.storage.values})}addGrouper(t,i=!0){return this.group(t,i,!0)}removeGrouper(t){const i=this,{groupers:r}=i,n=r.findIndex(s=>s.field===t);if(n>-1)return r.splice(n,1),r.length?i.group():i.clearGroupers()}clearGroupers(t=!1){return this.setGroupers(null,{silent:t})}isRecordInGroup(t,i){var r;if(!this.isGrouped)return null;const n=(r=this.groupers[0])===null||r===void 0?void 0:r.field;return t[n]===i&&!t.isSpecialRow}isInCollapsedGroup(t){const i=t.instanceMeta(this).groupParent;return i?.meta.collapsed}getGroupRecords(t){return this.isGrouped?this.storage.values.filter(i=>this.isRecordInGroup(i,t)):null}getGroupTitles(){return this.isGrouped?this.getDistinctValues(this.groupers[0].field):null}onDataChanged({changes:t,action:i}){this.isGrouped&&(!t&&Jh[i]||t&&this.groupers.some(r=>r.field in t))&&this.sort()}internalIncludeExcludeGroupRecords(t,i){const r=this,n=r.indexOf(t),{id:s,storage:l}=r,{meta:o,groupChildren:a}=t;if(!(n===-1||o.collapsed&&!i||!o.collapsed&&i)){if(a.forEach(d=>d.instanceMeta(s).hiddenByCollapse=!i),i){const d=a.filter(c=>!r.isAvailable(c));l.values.splice(n+1,0,...d)}else l.values.splice(n+1,a.length);l._indicesInvalid=!0,r._idMap=null}}excludeGroupRecords(t){this.internalIncludeExcludeGroupRecords(t,!1)}includeGroupRecords(t){this.internalIncludeExcludeGroupRecords(t,!0)}collectGroupRecords(t,i=!0){return(t?this.storage.allValues:this.storage.values).reduce((n,s)=>(s.isSpecialRow&&(i&&!s.isGroupFooter&&n.push(s),s.isGroupHeader&&n.push.apply(n,s.groupChildren)),n),[])}},Zh=u=>class extends(u||$){static get configurable(){return{objectify:null}}initProxy(){if(!globalThis.Proxy)throw new Error("Proxy not supported");return new Proxy(this,{get(i,r){if(r in i)return i[r];if(r==="$store")return i;let n=i.getById(r);return!n&&!isNaN(parseInt(r))&&(n=i.getAt(parseInt(r))),n},set(i,r,n){return r in i||i.isDestroying?i[r]=n:i.add(F({[i.modelClass.idField]:r},n)),!0},deleteProperty(i,r){return i.isDestroying?(delete i[r],!0):Boolean(i.remove(r).length)},has(i,r){if(r in i)return!0;if(r.startsWith("{")&&r.endsWith("}")){const n=_.safeJsonParse(r);r=n?.id}return i.includes(r)}})}},ef=u=>{var e;return e=class extends(u||$){initRelations(i){const r=this,n=r.modelClass.exposedRelations;i&&r.modelRelations&&r.modelRelations.forEach(s=>{var l;return(l=s.storeDetacher)===null||l===void 0?void 0:l.call(s)}),(!r.modelRelations||r.modelRelations.length===0||i)&&n&&(r.modelRelations=[],n?.forEach(s=>{const l=F({},s),{foreignStore:o,relationName:a,relatedCollectionName:d}=l,c=typeof o=="string"?r[o]:o;if(l.dependentStore=r,r.modelRelations.push(l),c){l.foreignStoreProperty=l.foreignStore,l.foreignStore=c;const h=c.dependentStoreConfigs;if(h.has(r)){const g=h.get(r);if(i){const f=g.find(m=>m.relationName===a);f&&B.remove(g,f)}g.push(l)}else h.set(r,[l]);d&&c.initRelationCollection(l,r),c.count>0&&c.updateDependentStores("dataset",c.records)}}))}initRelationCollection(i,r){const n=this,s=i.relatedCollectionName,l=n.collectionStores||(n.collectionStores={});l[s]={store:r,config:i},n[s+"Store"]||(n[s+"Store"]=r),n.count>0&&n.initModelRelationCollection(s,n.records)}initModelRelationCollection(i,r){const n=this;r.forEach(s=>{s.traverse(l=>{const o=i in l?`$related${_.capitalize(i)}`:i;Object.defineProperty(l,o,{enumerable:!0,configurable:!0,get:function(){return n.getCollection(this,i)},set:function(a){return n.setCollection(this,i,a)}})})})}resetRelationCache(){this.relationCache={},this.forEach(i=>i.initRelations())}updateRecordRelationCache(i,r){r?.forEach(n=>{const{config:s}=n,l=n.related?n.related.id:i.get(s.foreignKey);l!==void 0&&this.cacheRelatedRecord(i,l,s.relationName,l)})}getRelationCollection(i,r){const n=fe.asId(r);return this.relationCache[i]&&this.relationCache[i][n]||[]}getCollection(i,r){const{config:n,store:s}=this.collectionStores[r];return s.relationCache[n.relationName]&&s.relationCache[n.relationName][i.id]||[]}setCollection(i,r,n){const{config:s,store:l}=this.collectionStores[r],o=l.relationCache[s.relationName]||(l.relationCache[s.relationName]={}),a=(o[i.id]||[]).slice(),d=[],c=[];l.suspendEvents(),a.forEach(h=>{n.includes(h)||(h[s.foreignKey]=null,l.remove(h),c.push(h))}),n.forEach(h=>{h.isModel instanceof fe?h.stores.includes(l)||(l.add(h),d.push(h)):([h]=l.add(h),d.push(h)),h[s.foreignKey]=i.id}),l.resumeEvents(),c.length&&(l.trigger("remove",{records:c}),l.trigger("change",{action:"remove",records:c})),d.length&&(l.trigger("add",{records:d}),l.trigger("change",{action:"add",records:d}))}cacheRelatedRecord(i,r,n,s=null){const l=this,o=l.relationCache[n]||(l.relationCache[n]={});s!==null&&l.uncacheRelatedRecord(i,n,s),r!=null&&B.include(o[r]||(o[r]=[]),i)}uncacheRelatedRecord(i,r=null,n=null){const s=this;function l(o,a){const d=s.relationCache[o],c=d?.[a];if(c){const h=c.indexOf(i);h>=0&&c.splice(h,1),c.length===0&&delete d[a]}}n!=null?l(r,n):i.meta.relationCache&&Object.entries(i.meta.relationCache).forEach(([o,a])=>l(o,a?.id))}updateDependentStores(i,r){this.dependentStoreConfigs.forEach(n=>{n.forEach(s=>{const{dependentStore:l,relatedCollectionName:o,relationName:a,foreignKey:d}=s,c=l.relationCache[a];if(i==="dataset"){o&&this.initModelRelationCollection(o,r),l.forEach(h=>{const g=h.initRelation(s);g&&l.cacheRelatedRecord(h,g.id,a,g.id)});return}if(i==="removeall"){l.forEach(h=>h.removeRelation(s)),delete l.relationCache[a];return}i==="add"&&o&&this.initModelRelationCollection(o,r),(i==="add"||i==="remove")&&r.forEach(h=>{const g=c?.[h.id];switch(i){case"remove":g&&g.forEach(f=>f.removeRelation(s));break;case"add":l.forEach(f=>{f.get(d)==h.id&&(f.initRelation(s),l.cacheRelatedRecord(f,h.id,a))});break}})})})}updateDependentRecordIds(i,r){var n;(n=this.dependentStoreConfigs)===null||n===void 0||n.forEach(s=>{s.forEach(l=>{var o;const{dependentStore:a,relationName:d,foreignKey:c}=l,h=a.relationCache[d],g=h==null||(o=h[i])===null||o===void 0?void 0:o.slice();g?.forEach(f=>{a.cacheRelatedRecord(f,r,d,i),f.set(c,r,!1,!0)})})})}},T(e,"$name","StoreRelation"),e},tf=u=>class extends(u||$){static get $name(){return"StoreSum"}sum(t,i=this.storage.values){return i?i.reduce((r,n)=>{if(n.isSpecialRow)return r;const s=Number(n[t]);return isNaN(s)?r:r+s},0):0}min(t,i=this.storage.values){return!i||!i.length?0:i.reduce((r,n)=>{var s;return typeof((s=n[t])===null||s===void 0?void 0:s.valueOf())==="number"&&n[t]<r&&(r=n[t]),r},i[0][t])}max(t,i=this.storage.values){return!i||!i.length?0:i.reduce((r,n)=>{var s;return typeof((s=n[t])===null||s===void 0?void 0:s.valueOf())==="number"&&n[t]>r&&(r=n[t]),r},i[0][t])}average(t,i=this.storage.values){if(!i||!i.length)return 0;let r=0;const n=i.reduce((s,l)=>{if(l.isSpecialRow)return s;const o=parseFloat(l[t]);return isNaN(o)?s:(r++,s+o)},0);return r>0?n/r:0}groupSum(t,i){return this.sum(i,this.getGroupRecords(t))}};const ts=(u,e)=>String(u).toLowerCase().includes(e),So={string:ts,number:ts,boolean:ts,date:(u,e)=>u instanceof Date&&e instanceof Date?u-e===0:String(u.getMonth()+1).includes(e)||String(u.getDate()).includes(e)||String(u.getFullYear()).includes(e),object:(u,e)=>u===e,undefined:(u,e)=>u===e};var rf=u=>class extends(u||$){static get $name(){return"StoreSearch"}search(t,i=null,r,n){const s=this.isTree&&!n?this.rootNode.allChildren:this.getAllDataRecords(n),l=s.length,o=[];if(t==null)return[];typeof t=="string"&&(t=t.toLowerCase());let a,d,c,h,g,f;for(a=0;a<l;a++){c=s[a],d=0;for(const p of i||c.fieldNames){var m;h=c[p],g=h instanceof Date?"date":typeof h;const v=r?.[d];v&&(h=v(h),g="string"),f=So[g],h&&(m=f)!==null&&m!==void 0&&m(h,t)&&o.push({index:a,data:c,field:p,id:c.id}),d++}}return o}findByField(t,i,r=!1,n=!1){const s=this.getAllDataRecords(n),l=s.length,o=new Set,a=[];let d,c,h;for(i!=null&&(i=String(i).toLowerCase()),d=0;d<l;d++)if(c=s[d],h=c[t],!r||!o.has(h)){const g=h instanceof Date?"date":typeof h,f=So[g];(i==null&&h===i||i&&f(h,i))&&(a.push({id:c.id,index:d,data:c}),r&&o.add(h))}return a}find(t,i=!1){return this.getAllDataRecords(i).find(t)}findRecord(t,i,r=!1){const n=s=>x.isEqual(s[t],i);return this.isTree?this.query(n,r)[0]:this.getAllDataRecords(r).find(n)}query(t,i=!1){if(this.isTree){const r=[];return this.traverse(n=>{t(n)&&r.push(n)},void 0,void 0,i),r}return this.getAllDataRecords(i).filter(t)}some(t,i=!1){return this.getAllDataRecords(i).some(t)}};const nf=/\./;var sf=u=>class extends(u||$){static get $name(){return"StoreSort"}static get defaultConfig(){return{useLocaleSort:null}}static get configurable(){return{sorters:[],reapplySortersOnAdd:!1}}get isSorted(){return Boolean(this.sorters.length)||this.isGrouped}changeSorters(t){return t.map(i=>this.normalizeSorterConfig(i,!0))}updateReapplySortersOnAdd(t){this.storage.autoSort=t}sort(t,i,r=!1,n=!1){const s=this,l=s.allRecords,o=s.sorters?s.sorters.slice():[];let a=null,d;if(t)if(Array.isArray(t))s.sorters=t.map(c=>s.normalizeSorterConfig(c,typeof c=="string"?!0:i));else{const c=s.normalizeSorterConfig(t,i);r?(d=s.getCurrentSorterByField(c.field),d?(a=d.ascending,d.ascending=c.ascending):s.sorters.push(c)):s.sorters=[c]}return!n&&s.trigger("beforeSort",{sorters:s.sorters,records:l,currentSorters:o})===!1?(s.sorters=o,a!==null&&(d.ascending=a),null):s.performSort(n)}normalizeSorterConfig(t,i){const r=this,n={ascending:i};if(typeof t=="object"){var s;x.assign(n,t),t.fn&&(delete n.fn,n.sortFn=t.fn),n.ascending=(s=t.ascending)!==null&&s!==void 0?s:i}else typeof t=="function"?n.sortFn=t:n.field=t;if(n.ascending==null){const a=r.getCurrentSorterByField(n.field);n.ascending=a?!a.ascending:!0}if(n.sortFn==null){var l,o;const a=(l=r.modelClass)===null||l===void 0||(o=l.$meta.fields.map[n.field])===null||o===void 0?void 0:o.compareItems;a&&(n.sortFn=a)}return n}getCurrentSorterByField(t){return typeof t=="string"&&this.sorters.find(i=>i.field===t)||null}addSorter(t,i=!0){return this.sort(t,i,!0)}removeSorter(t){const i=this.sorters.findIndex(r=>r.field===t||r.sortFn===t);if(i>-1)return this.sorters.splice(i,1),this.sort()}clearSorters(t=!1){if(this.sorters.length)return this.sorters.length=0,this.sort(void 0,void 0,void 0,t)}createSorterFn(t){const i=this.useLocaleSort;return(r,n)=>{for(let s=0;s<t.length;s++){const l=t[s],{field:o,ascending:a=!0,useLocaleSort:d=i}=l,c=l.fn||l.sortFn,h=a?1:-1;if(c){const p=c.call(l,r,n);if(p!==null)return p*h}const g=nf.test(o),f=g?r.get(o):r[o],m=g?n.get(o):n[o];if(f!==m){if(f==null)return-h;if(m==null)return h;if(d&&typeof f=="string"){if(d===!0)return String(f).localeCompare(m)*h;if(typeof d=="string")return String(f).localeCompare(m,d)*h;if(typeof d=="object")return String(f).localeCompare(m,d.locale,d)*h}if(f>m)return h;if(f<m)return-h}}return 0}}get sorterFn(){const t=this,{sorters:i}=t;return t.createSorterFn(t.remoteSort?[{field:"_remoteSortIndex"}]:t.isGrouped?t.groupers.concat(i):i)}performSort(t){const i=this,{rootNode:r,storage:n,sorterFn:s}=i;i.tree?(!i.isChained&&r.traverse(l=>{l.isLoaded&&l.isParent&&(l.children.sort(s),l.updateChildrenIndices(l.children,"parentIndex",!0))}),n.replaceValues({values:i.collectDescendants(r).visible,silent:!0})):i.isGrouped?n.replaceValues({values:i.prepareGroupRecords(s),silent:!0}):n.replaceValues({values:n.values.sort(s),silent:!0}),i.afterPerformSort(t||i.isRemoteDataLoading)}afterPerformSort(t){if(t)return;const i=this;i._idMap=null;const r={action:"sort",sorters:i.sorters,records:i.allRecords};i.trigger("sort",r),i.trigger("refresh",r)}};const Eo=u=>!0;var lf=u=>class extends(u||$){static get $name(){return"StoreChained"}static get defaultConfig(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],keepUncommittedChanges:!1,excludeCollapsedRecords:!0}}static get properties(){return{chainedStores:null}}construct(t){super.construct(t);const i=this,{masterStore:r}=i,n=i.syncOrder?"sort":"";r&&(i.methodNamesToRelay.forEach(s=>i[s]=(...l)=>i.relayToMaster(s,l)),i.removeAll=(...s)=>{r.remove(i.getRange(),...s)},r.ion({changePreCommit:i.onMasterDataChangedPreCommit,change:i.onMasterDataChanged,[n]:i.onMasterDataChanged,prio:1,thisObj:i}),r.chainedStores||(r.chainedStores=[]),r.chainedStores.push(i),i.fillFromMaster())}get $master(){return this.masterStore||this}get isChained(){return Boolean(this.masterStore)}set chainedFilterFn(t){this._chainedFilterFn=this.thisObj?t.bind(this.thisObj):t}get chainedFilterFn(){return this._chainedFilterFn||Eo}get methodNamesToRelay(){const t=Array.isArray(this.doRelayToMaster),i=Array.isArray(this.dontRelayToMaster);return t&&this.doRelayToMaster.filter(r=>!i||!this.dontRelayToMaster.includes(r))||[]}updateChainedStores(){this.chainedStores&&this.chainedStores.forEach(t=>t.fillFromMaster())}fillFromMaster(){const t=this,{masterStore:i,isTree:r}=t,n=t.chainedFilterFn.length>0||t.chainedFilterFn.toString().length<=10;let s;if(!t.isChained)throw new Error("fillFromMaster only allowed on chained store");if(t.keepUncommittedChanges){if(r)throw new Error("Cannot use keepUncommittedChanges on a chained tree store");n?s=i.allRecords.filter(l=>!t.removed.includes(l)&&!t.added.includes(l)&&t.chainedFilterFn(l)):s=t.chainedFilterFn().filter(l=>!t.removed.includes(l)&&!t.added.includes(l)),s=t.added.values.filter(l=>!t.removed.includes(l)).concat(s)}else if(n?s=i.allRecords.filter(t.chainedFilterFn):s=t.chainedFilterFn(),r&&(t.idRegister={},t.internalIdRegister={},s.forEach(l=>{l.stores.includes(t)?t.register(l):l.joinStore(t)}),t.excludeCollapsedRecords)){const l=t.getChildren(t.rootNode);s=t.doIncludeExclude(l,!0)}t.data=s}commitToMaster(){const t=this,i=t.masterStore;if(!t.isChained)throw new Error("commitToMaster only allowed on chained store");return i.beginBatch(),i.remove(t.removed.values),i.add(t.added.values),i.endBatch(),t.commit()}relayToMaster(t,i){return this.masterStore[t](...i)}onMasterDataChangedPreCommit(t){this.onMasterDataChanged(t),this.$masterEventhandled=!0}onMasterDataChanged({action:t,changes:i,$handled:r,isMove:n}){var s;if(this.$masterEventhandled){this.$masterEventhandled=!1;return}n&&t==="remove"||(t!=="update"||(s=this.chainedFields)!==null&&s!==void 0&&s.some(l=>l in i))&&this.fillFromMaster()}makeChained(t=Eo,i,r){return new(r?.storeClass||this.constructor)(F(F({},r||{}),{},{tree:!1,autoTree:!1,masterStore:this.$master,modelClass:this.modelClass,syncDataOnLoad:!1,chainedFilterFn:t,chainedFields:i}))}chain(){return this.makeChained(...arguments)}doDestroy(){var t;(t=this.chainedStores)===null||t===void 0||t.forEach(i=>i.destroy()),super.doDestroy()}},of=u=>class extends(u||$){static get $name(){return"StoreState"}getState(){const{sorters:t,groupers:i,filters:r}=this,n={};return t!=null&&t.length&&(n.sorters=t.map(s=>{const l=x.cleanupProperties(x.clone(s));return delete l.fn,delete l.sortFn,l})),i!=null&&i.length&&(n.groupers=i.map(s=>{const l=x.cleanupProperties(x.clone(s));return delete l.fn,l})),r!=null&&r.values.length&&(n.filters=r.values.map(s=>{const l=x.cleanupProperties(x.clone(s.config));return l.value=s.value,l.caseSensitive&&delete l.caseSensitive,l})),n}applyState(t){const i=this,{sorters:r=[],groupers:n=[],filters:s=[]}=t,{sortParamName:l,filterParamName:o}=i;i.sorters=r.filter(a=>a.field||a.sortFn&&!l),i.groupers=n.slice(),i.sort(),i.filters=s.filter(a=>a.property||a.filterBy&&!o),i.filter()}};const af=u=>String(u).padStart(6,"0");class Ve{constructor(e){this.value=e,this._padded=null}set value(e){this._value=String(e??"")}get value(){return this._value}static from(e){return e==null||e instanceof Ve?e:new Ve(e)}static pad(e){return e instanceof Ve?e.valueOf():Ve.split(e).map(af).join(".")}static split(e){let t,i;if(e||e===0)switch(typeof e){case"object":e=String(e);case"string":for(i=e.split("."),t=i.length;t-- >0;)i[t]=parseInt(i[t],10);break;case"number":i=[e];break}return i||[]}static compare(e,t){return e===t?0:!e||!t?e?1:t?-1:0:(e=Ve.pad(e),t=Ve.pad(t),e<t?-1:t<e?1:0)}append(e){const t=this.value;return Ve.from(t?`${t}.${e}`:e)}isEqual(e){return!Ve.compare(this,e)}match(e){let t=!1;if(e){const i=this.value,r=e[0]==="*",n=e.endsWith("*"),s=e.length;r===n?t=i.indexOf(r?e.substr(1,s-2):e)>-1:r?t=i.endsWith(e.substr(1)):t=i.startsWith(e.substr(0,s-1))}return t}toString(){return this.value}toJSON(){return this.toString()}valueOf(){var e;return(e=this._padded)!==null&&e!==void 0?e:this._padded=Ve.pad(this.value)}}Ve._$name="Wbs";const df=Object.freeze([]);var cf=u=>{var e;return e=class extends(u||$){get isTree(){return this.tree||this.masterStore&&this.masterStore.tree}get leaves(){const i=this,r=[];return i.isTree?(i.traverse(n=>{n.isLeaf&&r.push(n)}),r):(i.allRecords.forEach(n=>{n.isLeaf&&r.push(n),n.traverse(s=>{s.isLeaf&&r.push(s)},!0)}),r)}async loadChildren(i){}onNodeAddChild(i,r,n,s,l=!1){const o=this,a=i===o.rootNode&&i.isLoading,{storage:d}=o,c=[],h=[],{previousSibling:g}=r[0];let f;if(o.collectDescendants(r,c,h,{inCollapsedBranch:!(i.isExpanded(o)&&i.ancestorsExpanded(o))}),!a&&h.length)for(const p of h)!o.modified.includes(p)&&!s[p.id]&&(o.removed.includes(p)?o.removed.remove(p):p.isLinked||o.added.add(p));if(a&&o.rootVisible&&(c.unshift(i),h.unshift(i)),c.length&&(n===0||!g?f=d.indexOf(i):f=d.indexOf(g)+g.getDescendantCount(!0,o),d.suspendEvents(),o.storage.splice(++f,0,c),d.resumeEvents(),o._idMap=null),o.updateDependentStores("add",r),a&&c.length){var m;if(o.sorters.length&&o.sort(null,null,!1,!0),(m=o.afterLoadData)===null||m===void 0||m.call(o),!l){const p={action:"dataset",data:o._data,records:c};o.trigger("refresh",p),o.trigger("change",p)}}else if(!l){const p={action:"add",parent:i,isChild:!0,isMove:s,records:r,allRecords:h,index:f};if(o.trigger("add",p),o.trigger("change",p),Object.values(s).some(v=>v)){const v={newParent:i,records:r.filter(y=>s[y.id]),oldParents:r.map(y=>{const C=o.getById(y.meta.oldParentId);return C!=null&&C.isRoot?null:C})};o.trigger("move",v)}}}onNodeRemoveChild(i,r,n,s={isMove:!1,silent:!1,unfiltered:!1}){const l=this,{storage:o}=l,a=[],d=[],{isMove:c,silent:h,unfiltered:g}=s,f=g&&l.isFiltered,m=f&&i.unfilteredChildren?i.unfilteredChildren:r;if(l.collectDescendants(m,a,d,{inCollapsedBranch:!(i.isExpanded(l)&&i.ancestorsExpanded(l)),unfiltered:f}),!c){for(const p of r)p.unjoinStore(l);for(const p of d)p.stores.includes(l)&&p.unjoinStore(l),l.added.includes(p)?l.added.remove(p):p.isLinked||l.removed.add(p);l.modified.remove(d)}if(a.length?(n=o.indexOf(a[0]),n>-1&&(o.suspendEvents(),o.splice(n,a.length),o.resumeEvents(),l._idMap=null)):n=-1,!h&&(l.fireRemoveEventForMoveAction||!c)){const p={action:"remove",parent:i,isChild:!0,isMove:c,records:r,allRecords:d,index:n};l.trigger("remove",p),l.trigger("change",p)}return d}collectDescendants(i,r=[],n=[],s){const l=this,{inCollapsedBranch:o=!1,unfiltered:a=!1}=s||0,d=Array.isArray(i)?i:l.getChildren(i,a);if(d)for(let c=0,h=d.length,g;c<h;c++)g=d[c],o||r.push(g),n.push(g),l.collectDescendants(g,r,n,{inCollapsedBranch:o||!g.isExpanded(l),unfiltered:a});return{visible:r,all:n}}getChildren(i,r=!1){const n=this,s=(r||n.isChained)&&i.unfilteredChildren||i.children;return s!=null&&s.length?n.isChained?s.filter(n.chainedFilterFn).sort(n.sorterFn):s:df}internalToggleTreeSubRecords(i,r){const n=this,{storage:s}=n,l=s.indexOf(i),o=n.doIncludeExclude(n.getChildren(i),r);if(n.isFiltered&&r&&i.unfilteredChildren&&n.updateChildrenHiddenState(i),o.length&&l!==!1){if(s.suspendEvents(),r){s.splice(l+1,0,...o);const a={action:"add",isExpand:!0,records:o,index:l+1};n.trigger("add",a),n.trigger("change",a)}else{s.splice(l+1,o.length);const a={action:"remove",isCollapse:!0,records:o,index:l+1};n.trigger("remove",a),n.trigger("change",a)}s.resumeEvents(),n._idMap=null}}updateChildrenHiddenState(i){var r;(r=i.unfilteredChildren)===null||r===void 0||r.forEach(n=>{n.instanceMeta(this.id).hidden=!1,n.isLeaf||this.updateChildrenHiddenState(n)})}doIncludeExclude(i,r,n=[]){const s=this,l=i?.length||0;for(let o=0;o<l;o++){const a=i[o];if(!s.isChained||s.chainedFilterFn(a)){const d=a.instanceMeta(s.id);(r||!d.hidden)&&n.push(a),d.hidden=!r,a.isExpanded(s)&&s.doIncludeExclude(s.getChildren(a),r,n)}}return n}async toggleCollapse(i,r){const n=this,s=n.getById(i),l=s.instanceMeta(n);if(r===void 0&&(r=!l.collapsed),!l.isLoadingChildren&&!s.isLeaf&&s.isExpanded(n)===r){if(n.trigger("beforeToggleNode",{record:s,collapse:r}),l.collapsed=r,l.collapsed)return n.onNodeCollapse(s),!0;{n.onNodeExpand(s);let o=!0;if(!s.isLoaded){l.isLoadingChildren=!0;try{await n.loadChildren(s)}catch(a){l.collapsed=!0,o=!1,n.trigger("loadChildrenException",{record:s,exception:a})}finally{l.isLoadingChildren=!1}}return o}}}onNodeCollapse(i){if(i.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(i,!1)}onNodeExpand(i){if(i.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(i,!0)}transformToTree(i){const{parentIdField:r,idField:n,childrenField:s}=this.modelClass,l=new Map,o=[];for(const d of i){const c=d[r];if(c!=null){let h=l.get(c);if(h===void 0){var a;h=(a=i.find(g=>g[n]===c))!==null&&a!==void 0?a:null,l.set(c,h)}h&&(h[s]||(h[s]=[]),h[s].push(d))}else o.push(d)}return o}treeify(i,r,n=!1){const{length:s}=i,l=[],o={};let a,d;for(a=0;a<s;a++){if(!i[a].call){const h=i[a];i[a]=g=>g[h]}l[a]=new Map}this.rootNode.traverse(h=>{if(d=null,h.isLeaf){for(a=0;a<s;a++){var g;const f=((g=d)===null||g===void 0?void 0:g.path)||"",m=l[a],p=i[a](h),v=`${f+p}/`,y=_.makeValidDomId(`generated_${v}`,"_"),C=m.get(y)||m.set(y,{id:y,key:p,path:v,expanded:!0,readOnly:!0,children:[],generatedParent:!0}).get(y);d&&!d.children.includes(C)&&d.children.push(C),d=C}d.children.push(h)}},!0),l.forEach(h=>h.forEach((g,f,m)=>{r?.(g),n&&(g=this.createRecord(g),m.set(f,g))})),o.children=[...l[0].values()];const c=h=>{h.children&&(h.children.sort((g,f)=>{if(g.isLeaf){let m;for(let p=0;!m&&p<s;p++){const v=i[p](g),y=i[p](f);m=v<y?-1:y>v?1:0}return m}else return typeof g.key=="string"||typeof f.key=="string"?g.key.localeCompare(f.key,void 0,{numeric:!0}):g.key<f.key?-1:g.key>f.key?1:0}),h.children.forEach(c))};return c(o),o}treeifyFlatData(i){const{childrenField:r,parentIdField:n}=this.modelClass;let s=!1,l=!0;for(const o of i){if(o.isModel||Array.isArray(o[r])){l=!1;break}o[n]!=null&&(s=!0)}return l&&s&&(i=this.transformToTree(i)),i}async indent(i){const r=this;if(i=Array.isArray(i)?i:[i],i=i.filter(n=>{let s=Boolean(n.previousSibling);for(;s&&!n.isRoot;)s=!i.includes(n.parent),n=n.parent;return s}),i.length&&r.trigger("beforeIndent",{records:i})!==!1){i.sort((n,s)=>Ve.compare(n.wbsCode,s.wbsCode)),r.beginBatch();for(const n of i){const s=n.previousSibling;s.appendChild(n),r.toggleCollapse(s,!1)}r.endBatch(),r.trigger("indent",{records:i}),r.trigger("change",{action:"indent",records:i})}}async outdent(i){const r=this;if(i=Array.isArray(i)?i:[i],i=i.filter(n=>{const{parent:s}=n;let l=s&&!s.isRoot;for(;l&&!n.isRoot;)l=!i.includes(s),n=n.parent;return l}),i.length&&r.trigger("beforeOutdent",{records:i})!==!1){i.sort((n,s)=>Ve.compare(n.wbsCode,s.wbsCode)),r.beginBatch();for(const n of i){const{parent:s}=n,l=s.children.slice(s.children.indexOf(n)+1);s.parent.insertChild(n,s.nextSibling),n.appendChild(l),r.toggleCollapse(n,!1)}r.endBatch(),r.trigger("outdent",{records:i}),r.trigger("change",{action:"outdent",records:i})}}},T(e,"$name","StoreTree"),T(e,"configurable",{transformFlatData:null,fireRemoveEventForMoveAction:re.checkVersion("core","6.0","<")}),e};class Ls{static preWalk(e,t,i){const r=[e];let n,s;for(;r.length;)n=r.pop(),i(n),s=t(n),s&&r.push.apply(r,s.slice().reverse())}static preWalkWithParent(e,t,i){const r=[{node:e,parent:null}];for(;r.length;){const{parent:n,node:s}=r.pop();i(n,s);const l=t(s);Array.isArray(l)&&r.push(...l.slice().reverse().map(o=>({node:o,parent:s})))}}static preWalkUnordered(e,t,i){const r=[e];let n,s;for(;r.length;)n=r[r.length-1],i(n),s=t(n),s?r.splice(r.length-1,1,...s):r.length=r.length-1}static postWalk(e,t,i){const r=new Map,n=[e];let s,l;for(;n.length;)s=n[n.length-1],r.has(s)?(i(s),n.pop()):(l=t(s),l&&n.push(...l.slice().reverse()),r.set(s,s))}static prePostWalk(e,t,i,r){const n=new Map,s=[e];let l,o;for(;s.length;)l=s[s.length-1],n.has(l)?(r(l),s.pop()):(i(l),o=t(l),o&&s.push(...o.slice().reverse()),n.set(l,l))}}Ls._$name="WalkHelper";var uf=u=>class extends(u||$){static get $name(){return"StoreSync"}static get configurable(){return{syncDataOnLoad:null}}syncDataset(t){const i=this,{storage:r}=i;i.isSyncingDataOnLoad=!0;const{toAdd:n,toRemove:s,toMove:l,updated:o,ids:a}=i.tree?i.syncTreeDataset(t):i.syncFlatDataset(t);let{threshold:d}=i.syncDataOnLoad,c=!1;if(d&&(typeof d=="string"&&(d=parseInt(d,10)/100*i.count),c=n.length+s.length+l.length+o.length>d),i.tree){if(n.length&&i.add(n,c).forEach(f=>f.clearParentId()),l.length)for(const{parent:g,node:f,index:m}of l)i.getById(g.id).insertChild(f,m);i.remove(s,c)}else c&&i.suspendEvents(),i.remove(s),i.add(n),c&&i.resumeEvents();d&&!c&&o.forEach(({record:g,toSet:f,wasSet:m})=>i.onModelChange(g,f,m)),i.acceptChanges();const h={added:n,removed:s,updated:o,thresholdSurpassed:c};if(i.isFiltered&&!i.remoteFilter&&i.filter({silent:i.isRemoteDataLoading}),i.isGrouped)i.group(null,null,!1,!0,i.isRemoteDataLoading);else if(i.isSorted)i.remoteSort?r.replaceValues({values:r.values.sort(i.createSorterFn(i.sorters)),silent:!0}):i.sort();else if(!i.tree)r.values.some((g,f)=>g.id!==a[f])&&(r.replaceValues({values:r.values.sort((g,f)=>a.indexOf(g.id)-a.indexOf(f.id)),silent:!0}),!c&&i.afterPerformSort());else{let g=!1,f=0;Ls.preWalk(i.rootNode,m=>Array.isArray(m.children)&&!g?m.children:null,m=>{m.id!==a[f++]&&(g=!0)}),g&&(i.sort((m,p)=>a.indexOf(m.id)-a.indexOf(p.id),void 0,void 0,!0),i.clearSorters(!0),!c&&i.afterPerformSort())}c&&i.trigger("refresh",{action:"batch",data:t,records:r.values,syncInfo:h}),i.isSyncingDataOnLoad=!1,i.trigger("loadSync",h)}syncFlatDataset(t){if(!t)return{toRemove:this.records};const i=this,{idField:r,allFields:n}=i.modelClass,s=[],l=[],o=[],a={},d=[],{threshold:c,keepMissingValues:h}=i.syncDataOnLoad;let g=0;return t.forEach(f=>{f=f.isModel?f.data:f;const m=f[r],p=i.getById(m);if(p){if(h===!1)for(const y of n)!(y.dataSource in f)&&y.dataSource in p.data&&(f[y.dataSource]=y.defaultValue);const v=p.set(f,null,Boolean(c));v&&o.push({record:p,wasSet:v,toSet:f}),g++}else l.push(i.processRecord(i.createRecord(f)));a[m]=1,d.push(m)}),g<i.allCount&&i.forEach(f=>{a[f.id]||s.push(f)}),{toAdd:l,toRemove:s,toMove:[],updated:o,ids:d}}syncTreeDataset(t){if(!t)return{toRemove:this.records};const i=this,{idField:r,parentIdField:n,childrenField:s,allFields:l}=i.modelClass,{keepMissingValues:o}=i.syncDataOnLoad,a=[],d=[],c=[],h=[],g={},f=[];i.transformFlatData&&(t=i.treeifyFlatData(t));const{threshold:m}=i.syncDataOnLoad;return Ls.preWalkWithParent({isRoot:!0,id:i.rootNode.id,children:t},p=>p.children,(p,v)=>{if(p){const y=v[r],C=i.getById(y);if(C){let w;const S=C.children;if(S!==!0&&v[s]===!0&&(C.clearChildren(),C.data[s]=C.children=!0,delete v[s],i.toggleCollapse(C,!0),w=!0),C.parent.id!==p[r]&&c.push({node:C,parent:p,index:p[s].indexOf(v)}),o===!1)for(const I of l)I.name!=="parentId"&&!(I.dataSource in v)&&I.dataSource in C.data&&(v[I.dataSource]=I.defaultValue);const D=C.set(v,null,Boolean(m));D?h.push({record:C,wasSet:D,toSet:v}):w&&C.signalNodeChanged({[s]:{value:!0,oldValue:S}})}else v[n]=p[r],d.push(F(F({},v),Array.isArray(v[s])?{children:[]}:void 0));g[y]=1,f.push(y)}}),i.traverse(p=>{g[p.id]||a.push(p)}),{toAdd:d,toRemove:a,toMove:c,updated:h,ids:f}}};const To=Symbol("STM_PROP");var hf=u=>class extends(u||$){static get $name(){return"StoreStm"}static get defaultConfig(){return{stm:null,ignoreRemoteChangesInSTM:!1}}get stm(){return this[To]}set stm(t){const i=this;if(i.stm!==t){var r;(r=i.stm)!==null&&r!==void 0&&r.hasStore(i)&&i.stm.removeStore(i),i[To]=t,i.stm&&!i.stm.hasStore(i)&&i.stm.addStore(i)}}add(t,i=!1,r={}){let n;const{stm:s}=this;if(!this.tree&&s!==null&&s!==void 0&&s.enabled){var l;n=super.add(t,i),(l=n)!==null&&l!==void 0&&l.length&&s.onStoreModelAdd(this,n,i)}else n=super.add(t,i,r);return n}insert(t,i,r=!1){let n;const{stm:s}=this;if(!this.tree&&s!==null&&s!==void 0&&s.enabled){var l;const o=(Array.isArray(i)?i:[i]).reduce((a,d)=>{const c=d instanceof fe?this.indexOf(d):void 0;return c!==void 0&&c!==-1&&a.set(d,c),a},new Map);n=super.insert(t,i),(l=n)!==null&&l!==void 0&&l.length&&(t=this.indexOf(n[0]),s.onStoreModelInsert(this,t,n,o,r))}else n=super.insert(t,i,r);return n}remove(t,i=!1,r){let n;const{stm:s}=this;if(!this.tree&&s!==null&&s!==void 0&&s.enabled){var l;const a=(Array.isArray(t)?t:[t]).map(d=>this.getById(d)).filter(d=>!!d).reduce((d,c)=>{const h=this.indexOf(c);return h!==void 0&&h!==-1&&d.set(c,h),d},new Map);n=super.remove(t,i,r),(l=n)!==null&&l!==void 0&&l.length&&s.onStoreModelRemove(this,n,a,i)}else n=super.remove(t,i,r);return n}removeAll(t){const{stm:i}=this;let r;if(i!=null&&i.enabled){const{tree:n,rootNode:s,allRecords:l}=this,o=l.length,a=n?s.children.slice():l.slice();r=super.removeAll(t),o&&this.count===0&&i.onStoreRemoveAll(this,a,t)}else r=super.removeAll(t);return r}beforeApplyChangeset(){const{stm:t,crudManager:i}=this;let r=!1;return!(i!=null&&i.applyingChangeset)&&t!==null&&t!==void 0&&t.enabled&&(r=!0,t.isRecording&&t.stash(),this.ignoreRemoteChangesInSTM?t.disable():t.startTransaction()),r}applyChangeset(t,i,r,n,s){const l=this.beforeApplyChangeset(),o=super.applyChangeset(t,i,r,n,s);return this.afterApplyChangeset(l),o}afterApplyChangeset(t){if(t){const{stm:i}=this;this.ignoreRemoteChangesInSTM?i.enable():i.stopTransaction(),i.applyStash()}}};const ff={splice:1,clear:1},gf={includeFilteredOutRecords:!1,includeCollapsedGroupRecords:!1},is=(u,e)=>(e=e||!1,typeof e=="boolean"&&(e={includeFilteredOutRecords:e,includeCollapsedGroupRecords:!1}),e||gf);class ue extends $.mixin(Se,ir,Me,ld,Bs,Xh,Kh,qh,ef,tf,rf,sf,Qh,lf,of,cf,hf,uf,Zh){static get $name(){return"Store"}static get properties(){return{relationCache:{},dependentStoreConfigs:new Map}}static get configurable(){return{id:!0,modelClass:fe,verifyNoGeneratedIds:!0}}static get defaultConfig(){return{fields:null,autoTree:!0,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null}}static get identifiable(){return{registerGeneratedId:!1}}constructor(...e){if(super(...e),this.objectify)return this.initProxy()}construct(e={}){const t=this;Object.assign(t,{added:new jr,removed:new jr,modified:new jr,idRegister:{},internalIdRegister:{},oldIdMap:{}}),e.storeId&&(e=x.assign({id:e.storeId},e)),super.construct(e),t.initRelations()}static from(e,t={},i=null){return e&&!e.isStore&&(typeof e=="string"?e=ue.getStore(e):(Array.isArray(e)&&(i&&(e=e.map(r=>r.isModel?r:i(r))),e=x.assign({},t,{data:e})),e=new ue(e))),e}doDestroy(){var e,t,i;const r=this,n=r.registeredRecords;for(let o=n.length-1,a;o>=0;o--){var s;a=n[o],(s=a)!==null&&s!==void 0&&s.isDestroyed||a.unjoinStore(r)}if((e=r._storage)===null||e===void 0||e.destroy(),(t=r.stm)===null||t===void 0||(i=t.removeStore)===null||i===void 0||i.call(t,r),!r.isChained){var l;(l=r.rootNode)===null||l===void 0||l.destroy()}super.doDestroy()}beginBatch(){this.suspendEvents()}endBatch(){this.resumeEvents()&&this.trigger("refresh",{action:"batch",data:this.storage.values,records:this.storage.values})}set storage(e){const t=this;e!=null&&e.isCollection?t._storage=e:t._storage=new at(e),t._storage.autoFilter=t.reapplyFilterOnAdd,t._storage.autoSort=t.reapplySortersOnAdd;for(const i of t._storage)i.joinStore(t);t._storage.ion({change:"onDataChange",thisObj:t})}get storage(){return this._storage||(this.storage={}),this._storage}get allRecords(){const e=this;if(e.isTree){const t=e.collectDescendants(e.rootNode,void 0,void 0,{unfiltered:!0}).all;return e.rootVisible&&t.unshift(e.rootNode),t}else return e.isGrouped?e.collectGroupRecords():e.storage.allValues}getAllDataRecords(e){return this.isGrouped?this.collectGroupRecords(e,!1):e?this.storage.allValues:this.storage.values}onIsCreatingToggle(e,t){const i=this,r=e.isPersistable&&!t;i.added[r?"add":"remove"](e),r&&(i.trigger("addConfirmed",{record:e}),i.autoCommit&&i.doAutoCommit())}joinRecordsToStore(e){const{allCount:t}=this;for(let i=0;i<e.length;i++){const r=e[i];r.setData("parentIndex",t+i-e.length),r.joinStore(this)}}onDataChange({source:e,action:t,added:i,removed:r,replaced:n,oldCount:s,items:l,from:o,to:a}){const d=this,c=ff[t],h=c&&i?.length,g=c&&r?.length;let f,m;if(d._idMap=null,h&&d.joinRecordsToStore(i),n?.forEach(([p,v])=>{p.unjoinStore(d,!0),v.joinStore(d)}),super.onDataChange(...arguments),!d.isTree){if(h){for(const p of i)d.removed.includes(p)?d.removed.remove(p):p.isLinked||d.added.add(p);f=!d.remoteFilter&&d.filtered&&d.reapplyFilterOnAdd,f&&d.filter({silent:!0}),m=!d.remoteSort&&d.isSorted&&d.reapplySortersOnAdd,m&&d.sort(null,null,!1,!0)}if(g){for(const p of r)p.cancelBatch(),p.unjoinStore(d),d.added.includes(p)?d.added.remove(p):!p._undoingInsertion&&!p.isCreating&&!p.isLinked&&d.removed.add(p);d.modified.remove(r),f=!d.remoteFilter&&d.filtered,f&&d.filter({silent:!0})}}switch(t){case"clear":d.relationCache={},d.updateDependentStores("removeall"),d.trigger("removeAll"),d.trigger("change",{action:"removeall"});break;case"splice":if(h){d.updateDependentStores("add",i);const p=i.reduce((C,w)=>{const{previousIndex:S}=w.meta;return S>-1&&S<C&&(C=S),C},i[0].meta.previousIndex),v=e.indexOf(i[0],!e.autoFilter),y={records:i,index:v};p>-1&&(y.oldIndex=p),d.trigger("add",y),d.trigger("change",Object.assign({action:"add"},y)),f&&d.triggerFilterEvent({action:"filter",filters:d.filters,oldCount:s,records:d.storage.allValues}),m&&d.trigger("sort",{action:"sort",sorters:d.sorters,records:d.storage.allValues})}r.length&&(d.updateDependentStores("remove",r),d.trigger("remove",{records:r}),d.trigger("change",{action:"remove",records:r})),n.length&&(d.trigger("replace",{records:n,all:d.records.length===n.length}),d.trigger("change",{action:"replace",replaced:n,all:d.records.length===n.length}));break;case"filter":(d.isGrouped||d.isSorted)&&d.performSort(!0);break;case"move":{const p=Math.min(o,a),v=Math.min(d.storage.allValues.length-1,Math.max(o,a));for(let y=d.storage.allValues,C=p;C<=v;C++)y[C].setData("parentIndex",C);d.trigger("move",{record:l[0],records:l,from:o,to:a}),d.isFiltered&&d.performFilter(),d.trigger("change",{action:t,record:l[0],records:l,from:o,to:a});break}}}onDataReplaced(e,t){var i;const r=this,{storage:n}=r,s=n.allValues,l=Boolean(r.sorters.length>0);for(let d=0;d<s.length;d++)s[d].joinStore(r);const o=r.prepareGroupRecords();if(!r.remoteFilter&&r.isFiltered&&r.filter({silent:!0}),r.remoteSort?r.isGrouped&&n.replaceValues({values:o,silent:!0}):(r.isGrouped&&r.group(null,null,!1,!l,!0),l&&r.sort(null,null,!1,!0)),!r.useRawData.disableDuplicateIdCheck){const{idMap:d}=r;if(Object.keys(d).length<n.values.length){const c=[];throw n.values.forEach(h=>d[h.id]?delete d[h.id]:c.push(h)),new Error(`Id collision on ${c.map(h=>h.id)}`)}}const a={action:e,data:t,records:n.values};r.updateDependentStores(e,a.records),(i=r.afterLoadData)===null||i===void 0||i.call(r),r.isRemoteDataLoading||r.trigger("refresh",a),r.trigger("change",a)}onModelChange(e,t,i,r,n){const s=this,l={record:e,records:[e],changes:i,batch:e.batching!=null,fromRelationUpdate:n},o=e.ignoreBag||e.isLinked?!1:s.updateModifiedBagForRecord(e);if(s.storage.onItemMutation(e,i),"id"in i){const{oldValue:a,value:d}=t.id;s.updateDependentRecordIds(a,d),s.onRecordIdChange({record:e,oldValue:a,value:d})}if(!r){if("id"in i){const{oldValue:a,value:d}=t.id;s.trigger("idChange",{store:s,record:e,oldValue:a,value:d})}s.onUpdateRecord(e,i),s.trigger("update",l),s.trigger("change",Object.assign({action:"update"},l))}s.autoCommit&&o&&s.doAutoCommit()}updateModifiedBagForRecord(e){const t=this;let i=!1;return e.isModified?!t.modified.includes(e)&&!t.added.includes(e)&&e.isPartOfStore(t)&&!e.isAutoRoot&&(e.isPhantom?t.added.add(e):t.modified.add(e),i=!0):t.modified.remove(e),i}get idMap(){const e=this,t=!e._idMap,i=e._idMap||(e._idMap={});if(t){const r=e.storage.values;for(let n,s=0,l=0;s<r.length;s++)n=r[s],i[n.id]={index:s,visibleIndex:l,record:n},n.isSpecialRow||l++}return i}changeModelClass(e){const{fields:t}=this;this.originalModelClass=e;let i=e;return t!=null&&t.length?i=class extends e{static get fields(){return t}}:this.preventSubClassingModel||(i=class extends e{}),i.initClass(),i}set storeId(e){this.id=e}get storeId(){return this.id}changeId(e,t){return super.changeId(e!==!0&&e,t)}updateId(e,t){const i=ue.getById(e);i&&ue.unregisterInstance(i),super.updateId(e,t)}generateAutoId(){return ue.generateId("store-")}get tree(){return this._tree}set tree(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode(),this.rootNode.isAutoRoot=!0)}buildRootNode(){return{}}static getStore(e,t){if(e instanceof ue)return e;if(this.getById(e))return this.getById(e);if(Array.isArray(e)){let i;const r=e.map(n=>(n instanceof fe?i=n.constructor:typeof n=="string"&&(n={text:n}),n));e={autoCreated:!0,data:r,modelClass:i||class extends fe{},allowNoId:!0},t||(t=ue)}if(t)return new t(e)}static get stores(){return ue.registeredInstances}get rootNode(){return this.masterStore?this.masterStore.rootNode:this._rootNode}set rootNode(e){var t;const i=this,r=i._rootNode;e!==r&&(r&&i.clear(!0),e instanceof fe?(e.instanceMeta(i).collapsed=!1,i._rootNode=e):i._rootNode=e=new i.modelClass(Object.assign({expanded:!0,[i.modelClass.idField]:`${i.id}-rootNode`},e),i,null,!0),i._tree=!0,e.isRoot=!0,e.joinStore(i),((t=e.children)!==null&&t!==void 0&&t.length||i.rootVisible)&&(e.isLoading=!0,i.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),i.trigger("rootChange",{oldRoot:r,rootNode:e}))}set data(e){this.setStoreData(e)}setStoreData(e){var t,i;const r=this,{idField:n,childrenField:s}=r.modelClass;if(r.transformFlatData&&((t=e)===null||t===void 0?void 0:t.length)>0&&!Object.isExtensible(e[0])&&(r.useRawData=r.useRawData||{disableDuplicateIdCheck:!1,disableDefaultValue:!1,disableTypeConversion:!1},e=x.clone(e)),r.getConfig("plugins"),r.processConfiguredListeners(),e&&!Array.isArray(e)&&(e=x.transformNamedObjectToArray(e,n)),r.tree=!r.isChained&&(r.tree||Boolean(r.autoTree&&((i=e)===null||i===void 0?void 0:i.some(l=>l[s])))),e&&(r.remoteSort||r.remoteFilter))for(let l=0;l<e.length;l++)e[l]._remoteSortIndex=l;if(!r.syncDataOnLoad||!r._data){if(r._data=e,r.tree){r.transformFlatData&&(e=r.treeifyFlatData(e));const l=r.rootNode;if(l.isLoading=!0,r._data.forEach(o=>delete o.parentId),r.clear(!0),l.appendChild(e),r.updateDependentStores("dataset",[l]),l.isLoading=!1,e.length===0){const o={action:"dataset",data:[],records:[]};r.trigger("refresh",o),r.trigger("change",o)}else r.isFiltered&&r.filter()}else r.loadData(e);r.added.clear(),r.removed.clear(),r.modified.clear()}else r.syncDataset(e)}loadData(e,t="dataset"){const i=this,{storage:r,allowNoId:n}=i,s=i.modelClass.fieldMap.id.dataSource,l=i.find(h=>h.isCreating);l&&r.values.splice(i.records.indexOf(l),1);let o=i.verifyNoGeneratedIds;if(i.removeHeadersAndFooters(i.storage.values),i._idMap=null,i.oldIdMap={},e){if(!(e[0]instanceof fe)){i.modelClass.exposeProperties(e[0]);const g=e.length,f=new Array(g);for(let m=0;m<g;m++){var a,d,c;const p=e[m];if(!n&&p[s]==null)throw new Error(`Id required but not found on row ${m}`);o&&(a=p[s])!==null&&a!==void 0&&(d=(c=a).startsWith)!==null&&d!==void 0&&d.call(c,"_generated")&&(console.warn(`Generated id found in data: ${p[s]}. Generated ids are temporary and should be replaced with real ids by the backend`),o=!1),f[m]=i.processRecord(i.createRecord(p,!0),!0),f[m].setData("parentIndex",m)}i.clear(!0),r.replaceValues({values:f,isNewDataset:!0,silent:!0})}else i.clear(!0),r.replaceValues({values:e.slice(),isNewDataset:!0,silent:!0});l&&r.values.push(l),i._data=e,i.onDataReplaced(t,e)}else i.clear(!0),i._data=null;i.isSyncingDataOnLoad=!1}get data(){return this._data}getRange(e,t,i=!0){return(i?this.storage.allValues:this.storage.values).slice(e,t)}createRecord(e,t=!1,i=!1){return new this.modelClass(e,this,null,t,!1,i)}processRecord(e,t=!1){return e}refreshData(){this.filter(),this.sort()}onRecordIdChange({record:e,oldValue:t,value:i}){const r=this,n=r._idMap,{idRegister:s,oldIdMap:l}=r;if(r.storage._indicesInvalid=!0,l[t]=e,n&&!n[i]){const o=n[t];delete n[t],n[i]=o}r.added.changeId(t,i),r.removed.changeId(t,i),r.modified.changeId(t,i),delete s[t],s[i]=e,e.index=r.storage.indexOf(e)}onUpdateRecord(e,t){const i=this,{internalId:r}=t,{internalIdRegister:n}=i;r&&(this.storage._indicesInvalid=!0,delete n[r.oldValue],n[r.value]=e),i.reapplyFilterOnUpdate&&i.isFiltered&&i.filter()}get useRawData(){return this._useRawData}set useRawData(e){e===!0?this._useRawData={enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:this._useRawData=e?Object.assign(e,{enabled:!0}):{enabled:!1}}getCount(e=!0){return e?this.count:this.originalCount}get originalCount(){var e;return this.storage.totalCount-(((e=this.groupRecords)===null||e===void 0?void 0:e.length)||0)}get count(){return this.storage.count}get allCount(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}get records(){return this.storage.values}get first(){return this.storage.values[0]}get last(){return this.storage.values[this.storage.values.length-1]}getAt(e,t=!1){return this.storage.getAt(e,t)}register(e){const t=this;if(!t.useRawData.disableDuplicateIdCheck){const i=t.isTree&&t.idRegister[e.id];if(i&&i!==e)throw new Error(`Id collision on ${e.id}`)}t.idRegister[e.id]=e,t.internalIdRegister[e.internalId]=e}unregister(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}get registeredRecords(){return Object.values(this.idRegister)}getById(e){if(e!=null&&e.isModel){const t=e;return t.hasLinks&&!this.storage.allValues.includes(t)?t.$links.find(i=>this.storage.allValues.includes(i)):t}return this.idRegister[e]}isAvailable(e){const t=this.getById(e);return t&&this.storage.includes(t)||!1}getByInternalId(e){return this.internalIdRegister[e]}includes(e){return this.isTree?this.idRegister[fe.asId(e)]!=null:this.indexOf(e)>-1}indexOf(e,t=!1,i=!1){if(e!=null&&e.isModel&&!e.stores.includes(this.$store||this)){const s=e.$links.find(l=>this.storage.allValues.includes(l));return s?this.indexOf(s,t):-1}if(this.isTree)return(i?this.rootNode.allChildren:this.storage.values).indexOf(this.getById(e));const r=fe.asId(e);if(r==null)return-1;const n=this.idMap[r];return n?n[t?"visibleIndex":"index"]:-1}allIndexOf(e){if(this.isTree){const t=this.getById(e);let i=-1;return t&&t.bubble(r=>{r.parent?i+=r.parentIndex+1:r===this.rootNode&&this.rootVisible&&(i+=1)}),i}else return this.storage.indexOf(e,!0)}getDistinctValues(e,t=!1){const i=this,r=[],n={};let s;return i.forEach(l=>{if(!l.isSpecialRow&&!l.isRoot){s=l.get(e);const o=s instanceof Date?s.getTime():s;n[o]||(r.push(s),n[o]=1)}},i,t),r}getValueCount(e,t){let i=0;return this.forEach(r=>{x.isEqual(r.get(e),t)&&i++}),i}set json(e){typeof e=="string"&&(e=_.safeJsonParse(e)),this.data=e}get json(){return _.safeJsonStringify(this)}get formattedJSON(){return _.safeJsonStringify(this,null,4)}toJSON(){return(this.isTree?this.rootNode.unfilteredChildren||this.rootNode.children||[]:this.allRecords).map(e=>e.toJSON())}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.project}getInlineData(e){const t=[];if(this.tree){var i;(i=this.rootNode.children)===null||i===void 0||i.forEach(r=>t.push(r.getCurrentConfig(e)))}else this.forEach(r=>t.push(r.getCurrentConfig(e)));return t}getCurrentConfig(e){const t=super.getCurrentConfig(e),{state:i}=this;if(t){var r;t.data&&(t.data=this.getInlineData(e)),delete t.project,delete t.stm,delete t.asyncEvents,((r=t.modelClass)===null||r===void 0?void 0:r.$meta.hierarchy[t.modelClass.$meta.hierarchy.length-2])===this.constructor.defaultConfig.modelClass&&delete t.modelClass,this.tree||delete t.tree,i&&Object.assign(t,i)}return t}forEach(e,t=this,i){const r=this,n=(s,l)=>{if(!s.isRoot&&!s.isSpecialRow)return e.call(t,s,l)};if(i=is(r,i),r.isTree)r.isChained&&(i=F(F({},i),{},{sorterFn:r.sorterFn})),r.rootNode.traverseWhile(n,!1,i);else{const s=i.includeFilteredOutRecords?r.storage.allValues:r.storage.values;if(r.isGrouped&&i.includeCollapsedGroupRecords)for(let l=0;l<s.length;l++){const o=s[l];if(o.groupChildren&&o.meta.collapsed===!0)for(let a=0;a<o.groupChildren.length;a++){const d=o.groupChildren[a];if(n(d,a)===!1)return}else if(n(o,l)===!1)return}else for(let l=0;l<s.length;l++)if(n(s[l],l)===!1)return}}map(e,t=this){return this.storage.values.map(e,t)}every(e,t=this,i){return this.storage[i?"allValues":"values"].every(e,t)}reduce(e,t=[],i=this){return i!==this&&(e=e.bind(i)),this.storage.values.reduce(e,t,i)}[Symbol.iterator](){return this.storage.values[Symbol.iterator]()}traverse(e,t=this.rootNode,i=t===this.rootNode,r){const n=this;if(r=is(n,r),n.isTree){if(typeof t=="boolean"&&(i=t,t=n.rootNode),n.isChained){const s=e;e=l=>{n.chainedFilterFn(l)&&s(l)}}t.traverse(e,i,r)}else n.forEach(s=>s.traverse(e,!1,r),n,r)}traverseWhile(e,t=this.rootNode,i=t===this.rootNode,r){const n=this;if(r=is(n,r),n.isTree){if(typeof t=="boolean"&&(i=t,t=n.rootNode),n.isChained){const s=e;e=l=>{n.chainedFilterFn(l)&&s(l)}}t.traverseWhile(e,i,r)}else for(const s of n.storage)if(s.traverse(e,!1,r)===!1)break}getNext(e,t=!1,i=!1){const r=this,n=r.storage.values;let s=r.indexOf(e);if(s>=n.length-1)if(t)s=-1;else return null;const l=n[s+1];return i&&l&&l.isSpecialRow?r.getNext(n[s+1],t,!0):l}getPrev(e,t=!1,i=!1){const r=this,n=r.storage.values;let s=r.indexOf(e);if(s===0)if(t)s=n.length;else return null;const l=n[s-1];return i&&l&&l.isSpecialRow&&s>0?r.getPrev(n[s-1],t,!0):l}getAdjacent(e,t=!0,i=!1,r=!1){return t?this.getNext(e,i,r):this.getPrev(e,i,r)}getNextLeaf(e,t=!1){const i=this,r=i.leaves,n=i.getById(e);let s=r.indexOf(n);if(s>=r.length-1)if(t)s=-1;else return null;return r[s+1]}getPrevLeaf(e,t=!1){const i=this,r=i.leaves,n=i.getById(e);let s=r.indexOf(n);if(s===0)if(t)s=r.length;else return null;return r[s-1]}getAdjacentLeaf(e,t=!0,i=!1){return t?this.getNextLeaf(e,i):this.getPrevLeaf(e,i)}}ue.initClass();ue._$name="Store";const mf=(u,e)=>(Array.isArray(e[1])?e[1].forEach(t=>u.push(encodeURIComponent(e[0])+"="+encodeURIComponent(t))):u.push(encodeURIComponent(e[0])+"="+encodeURIComponent(e[1])),u),Ir=Promise.resolve(),Oi=u=>String(u).padStart(2,"0"),pf=u=>`${u.getFullYear()}-${Oi(u.getMonth()+1)}-${Oi(u.getDate())}T${Oi(u.getHours())}:${Oi(u.getMinutes())}:${Oi(u.getSeconds())}.${u.getMilliseconds()}`;class cn extends ue{static get defaultConfig(){return{headers:null,fetchOptions:null,sendAsFormData:null,writeAllFields:null,parentIdParamName:"id",responseSuccessProperty:"success",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,restfulFilter:!1,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",pageSize:50,useRestfulMethods:null,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}static get configurable(){return{params:null}}afterConstruct(e){super.afterConstruct(e),this.autoLoad&&this.load().catch(()=>{})}get isLoading(){return this._isLoading?2:this.loadTriggerPromise?1:!1}get isCommitting(){return Boolean(this.commitPromise)}set pageParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=e}get pageParamName(){return this._pageParamName}set pageStartParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=e}get pageStartParamName(){return this._pageStartParamName}get isPaged(){return this.pageParamName||this.pageStartParamName}get allCount(){return"remoteTotal"in this?this.remoteTotal:super.allCount}get lastPage(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}buildQueryString(e,...t){const i=e.includes("?"),r=Object.entries(Object.assign({},...t)).reduce(mf,[]).join("&");return r?(i?"&":"?")+r:""}async performSort(e){const t=this;if(t.remoteSort&&!t.isRemoteDataLoading){t.isRemoteDataLoading=!0;const i=await t.internalLoad({},"",r=>{t.data=r.data,t.afterPerformSort(e)});return t.isRemoteDataLoading=!1,i}else super.performSort(e)}async performFilter(e){const t=this;if(t.remoteFilter){var i;(i=t.loadingPromise)===null||i===void 0||i.abort(),t.isRemoteDataLoading=!0;const r=t.count,{filters:n}=t;t.currentPage=1;const s=await t.internalLoad({},"",l=>{t.data=l.data,l=e?null:{action:"filter",filters:n,oldCount:r,records:t.storage.values},t.afterPerformFilter(l),t.trigger("refresh",l)});return t.isRemoteDataLoading=!1,s}else super.performFilter(e)}encodeFilterParams(e){const t=[];for(const{property:i,operator:r,value:n,caseSensitive:s}of e)t.push({field:i,operator:r,value:n,caseSensitive:s});return JSON.stringify(t,function(i,r){return i===""?r:this[i]instanceof Date?pf(this[i]):r})}encodeSorterParams(e){return JSON.stringify(e.filter(t=>!t.sortFn).map(t=>t))}buildReadUrl(){const{readUrl:e}=this;return this.restfulFilter&&this.filters.count?(e.endsWith("/")?e:e+"/")+this.filters.first.value:e}internalLoad(e,t,i,r=0){e=x.assign({},this.params,e);const n=this,s=n.buildReadUrl(),l={action:"read"+t,params:e,url:s};if(!s)throw new Error("No load url specified");if(n.trigger("beforeLoad"+t,l)===!1)throw!1;return n.loadArgs=[s,l,e,t,i],r===!1?new Promise((o,a)=>n.sendLoadRequest(o,a)):n.loadTriggerPromise||(n.loadTriggerPromise=new Promise((o,a)=>{n.setTimeout({delay:r,fn:"sendLoadRequest",args:[o,a],cancelOutstanding:!0})}))}async sendLoadRequest(e,t){const i=this,[r,n,s,l,o]=i.loadArgs;if(i.loadTriggerPromise=null,r){if(i._isLoading=!0,i.trigger(`load${l}Start`,n),i.trigger("beforeRequest",n),i.filterParamName&&i.isFiltered&&(s[i.filterParamName]=i.encodeFilterParams(i.filters.values)),i.remoteSort&&i.isSorted&&(s[i.sortParamName]=i.encodeSorterParams(i.groupers?i.groupers.concat(i.sorters):i.sorters)),i.isPaged){if(!(i.pageParamName in s||i.pageStartParamName in s)){const d=Math.min(i.currentPage||1,i.allCount?i.lastPage:1/0);i.pageParamName?s[i.pageParamName]=d:s[i.pageStartParamName]=(d-1)*i.pageSize}s[i.pageSizeParamName]=i.pageSize}const a={headers:i.headers,parseJson:!0};i.useRestfulMethods&&(a.method=i.httpMethods.read,n.body&&(a.body=JSON.stringify(n.body)));try{const d=i.loadingPromise=He.get(n.url+i.buildQueryString(n.url,s),x.assign(a,i.fetchOptions)),c=await d,h=c.parsedJson,g=Array.isArray(h),f=g||h&&x.getPath(h,i.responseSuccessProperty)!==!1,m=g?null:x.getPath(h,i.responseTotalProperty);if(i.isDestroyed)return;if(i.loadingPromise=null,i._isLoading=!1,n.response=c,n.json=h,f){if(m!=null&&(i.remoteTotal=parseInt(m,10)),i.isPaged)if(i.remoteTotal>=0){const p=i.pageParamName?s[i.pageParamName]:s[i.pageStartParamName]/i.pageSize+1;i.currentPage=Math.min(p,i.lastPage)}else throw new Error("A paged store must receive its responseTotalProperty in each data packet");n.data=g?h:x.getPath(h,i.responseDataProperty),await o(n),!i.isDestroyed&&i.trigger("load"+l,n),e(n)}else Object.assign(n,{exception:!0,exceptionType:"server",error:h?.error}),!i.isDestroyed&&i.trigger("exception",n),t(n);!i.isDestroyed&&i.trigger("afterRequest",n)}catch(d){i._isLoading=!1,n.exception=!0,d instanceof Response?(n.exceptionType=d.ok?"server":"network",n.response=d,n.error=d.error):(n.exceptionType="server",n.error=d),!i.isDestroyed&&i.trigger("exception",n),t(n),!i.isDestroyed&&i.trigger("afterRequest",n)}}}async load(e){const t=this;return t.isPaged?t.loadPage(t.currentPage||1,e):t.internalLoad(e,"",i=>{t.data=i.data})}async loadChildren(e){return this.readUrl?this.internalLoad({[this.parentIdParamName]:e.id},"Children",t=>{t.parentRecord=e,e.children.length&&e.clearChildren(!0),e.data[e.constructor.childrenField]=t.data,e.processChildren(e.stores)},!1):this.immediatePromise}async loadPage(e,t){this.allCount&&(e=Math.min(e,this.lastPage));const i=this,r=i.pageParamName?{[i.pageParamName]:e}:{[i.pageStartParamName]:(e-1)*i.pageSize};return r[i.pageSizeParamName]=i.pageSize,i.internalLoad(x.assign(r,t),"Page",n=>{i.loadData(n.data,"pageLoad")})}async nextPage(e){const t=this;return t.isPaged&&t.currentPage!==t.lastPage?t.loadPage(t.currentPage+1,e):Ir}async previousPage(e){return this.isPaged&&this.currentPage!==1?this.loadPage(this.currentPage-1,e):Ir}async commit(){const e=this,{changes:t}=e,i=[];if(e.commitPromise)return!1;if(!t)return e.modified.count&&(e.modified.forEach(r=>r.clearChanges(!0,!1)),e.modified.clear()),Ir;if(e.trigger("beforeCommit",{changes:t})!==!1){[...t.added,...t.modified,...t.removed].forEach(s=>s.meta.committing=!0),e.trigger("commitStart",{changes:t});const r={action:"commit",exception:!1,changes:t};let n=e.commitRemoved(r);return n&&i.push(n),n=e.commitAdded(r),n&&i.push(n),n=e.commitModified(r),n&&i.push(n),i.length?(n=i.length===1?i[0]:Promise.all(i),e.commitPromise=new Promise((s,l)=>{n.then(()=>{e.commitPromise=null,r.exception?(e.trigger("exception",r),l(r)):(e.trigger("commit",{changes:t}),s(r))}).catch(()=>{e.commitPromise=null,l(r)})})):(e.modified.forEach(s=>s.clearChanges(!0,!1)),e.modified.clear(),e.added.forEach(s=>s.clearChanges(!0,!1)),e.added.clear(),e.removed.clear(),e.trigger("commit",{changes:t}),Ir)}}doAutoCommit(){this.suspendCount<=0&&this.commit().catch(e=>{const{response:t}=e;if(!(t&&(t.ok&&t.parsedJson||[500,404].includes(t.status))))throw e})}commitAdded(e){const t=this,i=t.added,r={action:"create",params:t.params};return i.count&&t.createUrl?new Promise(n=>{const s=i.values.map(d=>d.persistableData);e.create=r,r.body={data:s},t.trigger("beforeRequest",r);let l=r.body;if(t.sendAsFormData){const d=new FormData;d.append("data",JSON.stringify(s)),l=d}const o={headers:t.headers,parseJson:!0},a=t.createUrl+t.buildQueryString(t.createUrl,t.params);t.useRestfulMethods&&(o.method=t.httpMethods.create),He.post(a,l,x.assign(o,t.fetchOptions)).then(d=>{const c=d.parsedJson,h=Array.isArray(c),g=h||c&&c.success!==!1;e.response=d,r.json=c,r.response=d,g?(t.processReturnedData(i.values,h?c:x.getPath(c,t.responseDataProperty)),i.clear(),t.trigger("commitAdded"),t.trigger("refresh",r),n(e)):(i.forEach(f=>f.meta.committing=!1),e.exception=r.exception=!0,e.exceptionType=r.exceptionType="server",t.trigger("exception",r),n(e)),t.trigger("afterRequest",r)}).catch(d=>{i.forEach(c=>c.meta.committing=!1),e.exception=r.exception=!0,d instanceof Response?(e.response=d,r.exceptionType=d.ok?"server":"network",r.response=d,r.error=d.error):(r.exceptionType="server",r.error=d),t.trigger("exception",r),n(e),t.trigger("afterRequest",r)})}):null}commitModified(e){const t=this,{modified:i}=t.changes,r={action:"update",params:t.params},n=i.length&&t.updateUrl?new Promise(s=>{const l=i.map(d=>t.writeAllFields?d.persistableData:d.modificationDataToWrite).filter(d=>!x.isEmpty(d));if(l.length===0){t.modified.clear(),i.forEach(d=>d.meta.committing=!1),s();return}e.update=r,r.body={data:l},t.trigger("beforeRequest",r);let o=r.body;if(t.sendAsFormData){const d=new FormData;d.append("data",JSON.stringify(l)),o=d}const a={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(a.method=t.httpMethods.update),He.post(t.updateUrl+t.buildQueryString(t.updateUrl,t.params),o,x.assign(a,t.fetchOptions)).then(d=>{const c=d.parsedJson,h=Array.isArray(c),g=h||c&&c.success!==!1;e.response=d,r.json=c,r.response=d,g?(t.processReturnedData(i,h?c:x.getPath(c,t.responseDataProperty),!0),t.modified.clear(),t.trigger("commitModified"),t.trigger("refresh",r),s(e)):(i.forEach(f=>f.meta.committing=!1),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),s(e)),t.trigger("afterRequest",r)}).catch(d=>{i.forEach(c=>c.meta.committing=!1),e.exception=r.exception=!0,d instanceof Response?(e.response=d,r.exceptionType=d.ok?"server":"network",r.response=d,r.error=d.error):(r.exceptionType="server",r.error=d),t.trigger("exception",r),s(e),t.trigger("afterRequest",r)})}):null;return!i.length&&t.modified.count&&t.modified.clear(),n}processReturnedData(e,t,i=!1){const r=this,n=r.modelClass,s=n.fieldMap.id.dataSource;t.forEach((l,o)=>{const a=e[o];a.clearChanges(!0,!1),a.syncId(l[s]),Object.assign(e[o].data,n.processData(l,i,r,a))})}commitRemoved(e){const t=this,i=t.removed,r={action:"delete",params:t.params};return i.count&&t.deleteUrl?new Promise(n=>{e.delete=r,r.body={ids:i.map(o=>o.id)},t.trigger("beforeRequest",r);let s=r.body;if(t.sendAsFormData){const o=new FormData;o.append("id",JSON.stringify(s.ids)),s=o}const l={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(l.method=t.httpMethods.delete),He.post(t.deleteUrl+t.buildQueryString(t.deleteUrl,t.params),s,x.assign(l,t.fetchOptions)).then(o=>{const a=o.parsedJson,d=Array.isArray(a),c=d||a&&a.success!==!1;e.response=o,r.json=a,r.response=o,c?(i.forEach(h=>h.meta.committing=!1),i.clear(),t.trigger("commitRemoved"),t.trigger("refresh",r),n(e)):(i.forEach(h=>h.meta.committing=!1),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),n(e)),t.trigger("afterRequest",r)}).catch(o=>{i.forEach(a=>a.meta.committing=!1),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),n(e),t.trigger("afterRequest",r)})}):null}get remoteFilter(){return Boolean(this.filterParamName||this.restfulFilter)}get remoteSort(){return Boolean(this.sortParamName)}}T(cn,"$name","AjaxStore");cn._$name="AjaxStore";class Ae{static get(e,t){const i=e._domData||(e._domData={});return t!=null?i[t]:i}static remove(e,t){const{_domData:i}=e,r=i?.[t];return i==null||delete i[t],r}static set(e,t,i){arguments.length===3?(e._domData||(e._domData={}))[t]=i:e._domData=t}static assign(e,t){Object.assign(e._domData||(e._domData={}),t)}}Ae._$name="DomDataStore";const Ro=()=>{throw new Error("Abstract method call!")};class Ft extends ${get type(){return this.constructor.name}undo(){Ro()}redo(){Ro()}}Ft._$name="ActionBase";const Ee=()=>{throw new Error("Abstract method call!")},ce=()=>{throw new Error("Method cannot be called at this state!")};class Ht extends ${canUndo(e){Ee()}canRedo(e){Ee()}onUndo(e){Ee()}onRedo(e){Ee()}onStartTransaction(e){Ee()}onStopTransaction(e){Ee()}onStopTransactionDelayed(e){Ee()}onRejectTransaction(e){Ee()}onEnable(e){Ee()}onDisable(e){Ee()}onAutoRecordOn(e){Ee()}onAutoRecordOff(e){Ee()}onResetQueue(e){Ee()}onModelUpdate(e){Ee()}onStoreModelAdd(e){Ee()}onStoreModelInsert(e){Ee()}onStoreModelRemove(e){Ee()}onStoreModelRemoveAll(e){Ee()}onModelInsertChild(e){Ee()}onModelRemoveChild(e){Ee()}}Ht._$name="StateBase";const ae=Symbol("STATE_PROP"),Tt=Symbol("STORES_PROP"),We=Symbol("QUEUE_PROP"),Ze=Symbol("POS_PROP"),ge=Symbol("TRANSACTION_PROP"),Ye=Symbol("TRANSACTION_TIMER_PROP"),et=Symbol("AUTO_RECORD_PROP");Object.freeze([ae,Tt,We,Ze,ge,Ye,et]);const Cd=new Map,vf=(u,e)=>{Cd.set(u,e)},bf=u=>(typeof u=="string"&&(u=Cd.get(u)),u);var lt={registerStmState:vf,resolveStmState:bf};const un=(u,e)=>{const{undo:t,redo:i}=e;let r;return t&&!i?r={[We]:u[We].slice(u.position),[Ze]:0}:i&&!t?r={[We]:u[We].slice(0,u.position)}:r={[We]:[],[Ze]:0},[r,()=>{u.notifyStoresAboutQueueReset(e)}]};class yf extends Ht{canUndo(){return!1}canRedo(){return!1}onUndo(){ce()}onRedo(){ce()}onEnable(e){return e.autoRecord?"autoreadystate":"readystate"}onDisable(){ce()}onAutoRecordOn(){return{[et]:!0}}onAutoRecordOff(){return{[et]:!1}}onStartTransaction(){ce()}onStopTransaction(){ce()}onStopTransactionDelayed(){ce()}onRejectTransaction(){ce()}onResetQueue(e,t){return un(e,t)}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}}const wd=new yf;lt.registerStmState("disabledstate",wd);const Jt=Symbol("ACTION_QUEUE_PROP");class zs extends ${get defaultConfig(){return{title:null}}construct(...e){this[Jt]=[],super.construct(...e)}get queue(){return this[Jt].slice(0)}get length(){return this[Jt].length}addAction(e){this[Jt].push(e)}undo(){const e=this[Jt];for(let t=e.length-1;t>=0;--t)e[t].undo()}redo(){const e=this[Jt];for(let t=0,i=e.length;t<i;++t)e[t].redo()}}zs._$name="Transaction";class xd extends Ht{canUndo(e){return 0<e.position&&e.position<=e.length}canRedo(e){return 0<=e.position&&e.position<e.length}onUndo(e,t){let i=e.position;const r=e[We],n=Math.max(0,i-t),s=()=>{e.notifyStoresAboutStateRestoringStart();const l=[];for(;i!==n;){const o=r[--i];o.undo(),l.push(o)}return[e.autoRecord?"autoreadystate":"readystate",()=>{e.notifyStoresAboutStateRestoringStop({cause:"undo",transactions:l})}]};return[{[ae]:"restoringstate",[Ze]:n},s]}onRedo(e,t){let i=e.position;const r=e[We],n=Math.min(r.length,i+t),s=()=>{e.notifyStoresAboutStateRestoringStart();const l=[];do{const o=r[i++];o.redo(),l.push(o)}while(i!==n);return[e.autoRecord?"autoreadystate":"readystate",()=>{e.notifyStoresAboutStateRestoringStop({cause:"redo",transactions:l})}]};return[{[ae]:"restoringstate",[Ze]:n},s]}onEnable(){ce()}onDisable(){return"disabledstate"}onAutoRecordOn(){return{[ae]:"autoreadystate",[et]:!0}}onAutoRecordOff(){ce()}onStartTransaction(e,t){const i=new zs({title:t});return[{[ae]:"recordingstate",[ge]:i},()=>{e.notifyStoresAboutStateRecordingStart(i)}]}onStopTransaction(){ce()}onStopTransactionDelayed(){ce()}onRejectTransaction(){ce()}onResetQueue(e,t){return un(e,t)}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}}const Xi=new xd;lt.registerStmState("readystate",Xi);class Sd extends Ht{canUndo(){return!1}canRedo(){return!1}onEnable(){}onDisable(e){const t=e[ge];return e.notifyStoresAboutStateRecordingStop(t,{disabled:!0}),{[ae]:"disabledstate",[ge]:null}}onAutoRecordOn(e){return[{[ae]:"autorecordingstate",[et]:!0},()=>{e.stopTransactionDelayed()}]}onAutoRecordOff(){ce()}onStartTransaction(){ce()}onStopTransaction(e,t){const i=e[ge],r=e[We];let n=e[Ze];return i.length&&(!i.title&&!t&&e.getTransactionTitle?i.title=e.getTransactionTitle(i):t&&(i.title=t),r[n]=i,r.length=++n),[{[ae]:"readystate",[Ze]:n,[ge]:null},()=>{e.notifyStoresAboutStateRecordingStop(i,{stop:!0})}]}onRejectTransaction(e){const t=e[ge];return[{[ae]:"restoringstate",[ge]:null},()=>(t.length&&t.undo(),["readystate",()=>{e.notifyStoresAboutStateRecordingStop(t,{rejected:!0})}])]}onStopTransactionDelayed(){ce()}onResetQueue(e,t){return un(e,t)}onModelUpdate(e,t,i,r,n){e[ge].addAction(e.makeModelUpdateAction(t,i,r,n))}onModelInsertChild(e,t,i,r,n,s){e[ge].addAction(e.makeModelInsertChildAction(t,i,r,n,s))}onModelRemoveChild(e,t,i,r){e[ge].addAction(e.makeModelRemoveChildAction(t,i,r))}onStoreModelAdd(e,t,i,r){e[ge].addAction(e.makeStoreModelAddAction(t,i,r))}onStoreModelInsert(e,t,i,r,n,s){e[ge].addAction(e.makeStoreModelInsertAction(t,i,r,n,s))}onStoreModelRemove(e,t,i,r,n){e[ge].addAction(e.makeStoreModelRemoveAction(t,i,r,n))}onStoreRemoveAll(e,t,i,r){e[ge].addAction(e.makeStoreRemoveAllAction(t,i,r))}}const Ed=new Sd;lt.registerStmState("recordingstate",Ed);class Cf extends Ht{static get $name(){return"RestoringStateClass"}canUndo(){return!1}canRedo(){return!1}onUndo(){ce()}onRedo(){ce()}onEnable(){ce()}onDisable(){ce()}onAutoRecordOn(){return{[et]:!0}}onAutoRecordOff(){return{[et]:!1}}onStartTransaction(){ce()}onStopTransaction(){ce()}onStopTransactionDelayed(){ce()}onRejectTransaction(){ce()}onQueueReset(){ce()}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}}const Td=new Cf;lt.registerStmState("restoringstate",Td);class wf extends xd{onAutoRecordOn(){ce()}onAutoRecordOff(){return{[ae]:"readystate",[et]:!1}}onStartTransaction(e,t){const i=new zs({title:t});return[{[ae]:"autorecordingstate",[ge]:i},()=>{e.notifyStoresAboutStateRecordingStart(i),e.stopTransactionDelayed()}]}onModelUpdate(e,t,i,r){e.startTransaction(),e.onModelUpdate(t,i,r)}onModelInsertChild(e,t,i,r,n){e.startTransaction(),e.onModelInsertChild(t,i,r,n)}onModelRemoveChild(e,t,i,r){e.startTransaction(),e.onModelRemoveChild(t,i,r)}onStoreModelAdd(e,t,i,r){e.startTransaction(),e.onStoreModelAdd(t,i,r)}onStoreModelInsert(e,t,i,r,n,s){e.startTransaction(),e.onStoreModelInsert(t,i,r,n,s)}onStoreModelRemove(e,t,i,r,n){e.startTransaction(),e.onStoreModelRemove(t,i,r,n)}onStoreRemoveAll(e,t,i,r){e.startTransaction(),e.onStoreRemoveAll(t,i,r)}}const Qr=new wf;lt.registerStmState("autoreadystate",Qr);class xf extends Sd.mixin(Se){onDisable(e){const t=e[ge],i=e[Ye];return i&&this.clearTimeout(i),e.notifyStoresAboutStateRecordingStop(t,{disabled:!0}),{[ae]:"disabledstate",[ge]:null,[Ye]:null}}onAutoRecordOn(e){ce()}onAutoRecordOff(e){const t=e[Ye];return t&&this.clearTimeout(t),{[ae]:"recordingstate",[et]:!1,[Ye]:null}}onStopTransaction(e,t){const i=e[ge],r=e[Ye],n=e[We];let s=e[Ze];return r&&this.clearTimeout(r),i.length&&(!i.title&&!t&&e.getTransactionTitle?i.title=e.getTransactionTitle(i):t&&(i.title=t),n[s]=i,n.length=++s),[{[ae]:"autoreadystate",[Ze]:s,[ge]:null,[Ye]:null},()=>{e.notifyStoresAboutStateRecordingStop(i,{stop:!0})}]}onStopTransactionDelayed(e){let t=e[Ye];return t&&this.clearTimeout(t),t=this.setTimeout(()=>{e.stopTransaction()},e.autoRecordTransactionStopTimeout),{[ae]:Ws,[Ye]:t}}onResetQueue(e,t){return un(e,t)}onRejectTransaction(e){const t=e[ge],i=e[Ye];return i&&this.clearTimeout(i),[{[ae]:"restoringstate",[ge]:null,[Ye]:null},()=>(t.length&&t.undo(),["autoreadystate",()=>{e.notifyStoresAboutStateRecordingStop(t,{rejected:!0})}])]}onModelUpdate(e,...t){super.onModelUpdate(e,...t),e.stopTransactionDelayed()}onModelInsertChild(e,...t){super.onModelInsertChild(e,...t),e.stopTransactionDelayed()}onModelRemoveChild(e,...t){super.onModelRemoveChild(e,...t),e.stopTransactionDelayed()}onStoreModelAdd(e,...t){super.onStoreModelAdd(e,...t),e.stopTransactionDelayed()}onStoreModelInsert(e,...t){super.onStoreModelInsert(e,...t),e.stopTransactionDelayed()}onStoreModelRemove(e,...t){super.onStoreModelRemove(e,...t),e.stopTransactionDelayed()}onStoreRemoveAll(e,...t){super.onStoreRemoveAll(e,...t),e.stopTransactionDelayed()}}const Ws=new xf;lt.registerStmState("autorecordingstate",Ws);const Do=Symbol("MODEL_PROP"),Mo=Symbol("NEW_DATA_PROP"),Io=Symbol("OLD_DATA_PROP");class Rd extends Ft{static get defaultConfig(){return{model:void 0,newData:void 0,oldData:void 0,isInitialUserAction:!1}}get type(){return"UpdateAction"}get model(){return this[Do]}set model(e){this[Do]=e}get newData(){return this[Mo]}set newData(e){this[Mo]=F({},e)}get oldData(){return this[Io]}set oldData(e){this[Io]=F({},e)}undo(){const{model:e,oldData:t}=this;e.$&&Object.assign(e,t),e.set(t,null,null,null,!0)}redo(){const{model:e,newData:t}=this;e.$&&Object.assign(e,t),e.set(t,null,null,null,!0)}}Rd._$name="UpdateAction";const Fo=Symbol("PARENT_MODEL_PROP"),ko=Symbol("CHILD_MODELS_PROP"),Lo=Symbol("INSERT_INDEX_PROP"),Po=Symbol("CONTEXT_PROP");class Dd extends Ft{static get defaultConfig(){return{parentModel:void 0,childModels:void 0,insertIndex:void 0,context:void 0}}get type(){return"InsertChildAction"}get parentModel(){return this[Fo]}set parentModel(e){this[Fo]=e}get childModels(){return this[ko]}set childModels(e){this[ko]=e.slice(0)}get insertIndex(){return this[Lo]}set insertIndex(e){this[Lo]=e}get context(){return this[Po]}set context(e){this[Po]=e}undo(){const{parentModel:e,context:t,childModels:i}=this;i.sort((r,n)=>{const{lhsParent:s,lhsIndex:l}=t.get(r)||{},{rhsParent:o,rhsIndex:a}=t.get(n)||{};return s&&s===o?l-a:0}),i.forEach(r=>{const{parent:n,index:s}=t.get(r)||{};if(n)if(n===e){let l;l=s>r.parentIndex?s+1:s,l=s===n.children.length-1?null:l;const o=n.children[l];n.insertChild(r,o)}else n.insertChild(r,n.children[s]);else e.removeChild(r)})}redo(){const{parentModel:e,insertIndex:t,childModels:i}=this,r=e.children[t];e.insertChild(i,r)}}Dd._$name="InsertChildAction";const Oo=Symbol("PARENT_MODEL_PROP"),Ao=Symbol("CHILD_MODELS_PROP"),$o=Symbol("CONTEXT_PROP");class Md extends Ft{static get defaultConfig(){return{parentModel:void 0,childModels:void 0,context:void 0}}get type(){return"RemoveChildAction"}get parentModel(){return this[Oo]}set parentModel(e){this[Oo]=e}get childModels(){return this[Ao]}set childModels(e){this[Ao]=e.slice(0)}get context(){return this[$o]}set context(e){this[$o]=e}undo(){const{parentModel:e,context:t,childModels:i}=this;i.sort((r,n)=>{const s=t.get(r),l=t.get(n);return s-l}),i.forEach(r=>{e.insertChild(r,t.get(r))})}redo(){this.parentModel.removeChild(this.childModels)}}Md._$name="RemoveChildAction";const _o=Symbol("STORE_PROP"),Ho=Symbol("MODEL_LIST_PROP");class Id extends Ft{static get defaultConfig(){return{store:void 0,modelList:void 0,silent:!1}}get type(){return"AddAction"}get store(){return this[_o]}set store(e){this[_o]=e}get modelList(){return this[Ho]}set modelList(e){this[Ho]=e.slice(0)}undo(){this.store.remove(this.modelList,this.silent)}redo(){this.store.add(this.modelList,this.silent)}}Id._$name="AddAction";const No=Symbol("STORE_PROP"),Bo=Symbol("MODEL_LIST_PROP"),Vo=Symbol("INSERT_INDEX_PROP"),zo=Symbol("CONTEXT_PROP");class Fd extends Ft{static get defaultConfig(){return{store:void 0,modelList:void 0,insertIndex:void 0,context:void 0,silent:!1}}get type(){return"InsertAction"}get store(){return this[No]}set store(e){this[No]=e}get modelList(){return this[Bo]}set modelList(e){this[Bo]=e.slice(0)}get insertIndex(){return this[Vo]}set insertIndex(e){this[Vo]=e}get context(){return this[zo]}set context(e){this[zo]=e}undo(){const{store:e,modelList:t,context:i,silent:r}=this;t.sort((n,s)=>{const l=i.get(n),o=i.get(s);return l!==void 0&&o!==void 0?l-o:0}),t.forEach(n=>{const s=i.get(n);n._undoingInsertion=!0,s!==void 0?e.insert(s,n,r):e.remove(n,r),n._undoingInsertion=!1})}redo(){const e=this;e.store.insert(e.insertIndex,e.modelList,e.silent)}}Fd._$name="InsertAction";const Wo=Symbol("STORE_PROP"),jo=Symbol("MODEL_LIST_PROP"),Go=Symbol("CONTEXT_PROP");class kd extends Ft{static get defaultConfig(){return{store:void 0,modelList:void 0,context:void 0,silent:!1}}get type(){return"RemoveAction"}get store(){return this[Wo]}set store(e){this[Wo]=e}get modelList(){return this[jo]}set modelList(e){this[jo]=e.slice(0)}get context(){return this[Go]}set context(e){this[Go]=e}undo(){const{store:e,context:t,modelList:i,silent:r}=this;i.sort((n,s)=>{const l=t.get(n),o=t.get(s);return l-o}),i.forEach(n=>{const s=t.get(n);e.insert(s,n,r)})}redo(){this.store.remove(this.modelList,this.silent)}}kd._$name="RemoveAction";const Uo=Symbol("STORE_PROP"),Yo=Symbol("ALL_RECORDS_PROP");class Ld extends Ft{static get defaultConfig(){return{store:void 0,allRecords:void 0,silent:!1}}get type(){return"RemoveAllAction"}get store(){return this[Uo]}set store(e){this[Uo]=e}get allRecords(){return this[Yo]}set allRecords(e){this[Yo]=e.slice(0)}undo(){const{store:e,allRecords:t,silent:i}=this;e.add(t,i)}redo(){this.store.removeAll(this.silent)}}Ld._$name="RemoveAllAction";const Sf=(u,e,t,i)=>new Rd({model:u,newData:e,oldData:t,isInitialUserAction:i}),Ef=(u,e,t,i)=>new Dd({parentModel:u,childModels:t,insertIndex:e,context:i}),Tf=(u,e,t)=>new Md({parentModel:u,childModels:e,context:t}),Rf=(u,e,t)=>new Id({store:u,modelList:e,silent:t}),Df=(u,e,t,i,r)=>new Fd({store:u,insertIndex:e,modelList:t,context:i,silent:r}),Mf=(u,e,t,i)=>new kd({store:u,modelList:e,context:t,silent:i}),If=(u,e,t)=>new Ld({store:u,allRecords:e,silent:t}),Re=(u,e,...t)=>{const i=u.state,r=e.call(u[ae],u,...t);if(typeof r=="string")u[ae]=lt.resolveStmState(r);else if(r instanceof Ht)u[ae]=r;else if(Array.isArray(r)){const[n,s]=r;typeof n=="string"?u[ae]=lt.resolveStmState(n):n instanceof Ht?u[ae]=n:n&&typeof n=="object"&&(u=Object.assign(u,n),u[ae]=lt.resolveStmState(u[ae])),typeof s=="function"&&Re(u,s,...t)}else r&&typeof r=="object"&&(u=Object.assign(u,r),u[ae]=lt.resolveStmState(u[ae]));i!==Xi&&i!==Qr&&r!==Xi&&r!==Qr&&u.trigger("ready")};class Ff extends Me($){static get defaultConfig(){return{disabled:!0,autoRecord:!1,autoRecordTransactionStopTimeout:100,makeModelUpdateAction:Sf,makeModelInsertChildAction:Ef,makeModelRemoveChildAction:Tf,makeStoreModelAddAction:Rf,makeStoreModelInsertAction:Df,makeStoreModelRemoveAction:Mf,makeStoreRemoveAllAction:If,getTransactionTitle:null}}construct(...e){Object.assign(this,{[ae]:Xi,[Tt]:[],[We]:[],[Ze]:0,[ge]:null,[Ye]:null,[et]:!1}),super.construct(...e)}get state(){return this[ae]}get position(){return this[Ze]}get length(){return this[We].length}get stores(){return Array.from(this[Tt])}hasStore(e){return this[Tt].includes(e)}addStore(e){this.hasStore(e)||(this[Tt].push(e),e.stm=this)}removeStore(e){this.hasStore(e)&&(this[Tt]=this[Tt].filter(t=>t!==e),e.stm=null)}forEachStore(e){this[Tt].forEach(t=>e(t,t.id))}get disabled(){return this.state===wd}set disabled(e){const t=this;t.disabled!==e&&(e?Re(t,t.state.onDisable,t):Re(t,t.state.onEnable,t),t.trigger("stmDisabled",{disabled:e}),t.trigger("disabled",{disabled:e}))}get enabled(){return!this.disabled}enable(){this.disabled=!1}disable(){this.disabled=!0}get isReady(){return this.state===Xi||this.state===Qr}waitForReadiness(){return this.await("ready",!1)}get isRecording(){return this.state===Ed||this.state===Ws}get autoRecord(){return this[et]}set autoRecord(e){const t=this;t.autoRecord!=e&&(e?Re(t,t.state.onAutoRecordOn,t):Re(t,t.state.onAutoRecordOff,t))}startTransaction(e=null){Re(this,this.state.onStartTransaction,e)}stopTransaction(e=null){Re(this,this.state.onStopTransaction,e)}stopTransactionDelayed(){Re(this,this.state.onStopTransactionDelayed)}rejectTransaction(){Re(this,this.state.onRejectTransaction)}get transaction(){return this[ge]}get queue(){return this[We].map(e=>e.title)}get isRestoring(){return this.state===Td}get canUndo(){return this.state.canUndo(this)}get canRedo(){return this.state.canRedo(this)}async undo(e=1){this.isReady||await this.waitForReadiness(),Re(this,this.state.onUndo,e)}async undoAll(){this.isReady||await this.waitForReadiness(),this.undo(this.length)}async redo(e=1){this.isReady||await this.waitForReadiness(),Re(this,this.state.onRedo,e)}async redoAll(){this.isReady||await this.waitForReadiness(),this.redo(this.length)}resetQueue(e={undo:!0,redo:!0}){Re(this,this.state.onResetQueue,e)}resetUndoQueue(){this.resetQueue({undo:!0})}resetRedoQueue(){this.resetQueue({redo:!0})}notifyStoresAboutStateRecordingStart(e){this.forEachStore(t=>{var i;return(i=t.onStmRecordingStart)===null||i===void 0?void 0:i.call(t,this,e)}),this.trigger("recordingStart",{stm:this,transaction:e})}notifyStoresAboutStateRecordingStop(e,t){this.forEachStore(i=>{var r;return(r=i.onStmRecordingStop)===null||r===void 0?void 0:r.call(i,this,e,t)}),this.trigger("recordingStop",{stm:this,transaction:e,reason:t})}notifyStoresAboutStateRestoringStart(){this.forEachStore(e=>{var t;return(t=e.onStmRestoringStart)===null||t===void 0?void 0:t.call(e,this)}),this.trigger("restoringStart",{stm:this})}notifyStoresAboutStateRestoringStop({cause:e,transactions:t}){this.forEachStore(i=>{var r;return(r=i.onStmRestoringStop)===null||r===void 0?void 0:r.call(i,this)}),this.trigger("restoringStop",{stm:this,cause:e,transactions:t})}notifyStoresAboutQueueReset(e){this.forEachStore(t=>{var i;return(i=t.onStmQueueReset)===null||i===void 0?void 0:i.call(t,this,e)}),this.trigger("queueReset",{stm:this,options:e})}onModelUpdate(e,t,i,r){Re(this,this.state.onModelUpdate,e,t,i,r)}onModelInsertChild(e,t,i,r){Re(this,this.state.onModelInsertChild,e,t,i,r)}onModelRemoveChild(e,t,i){Re(this,this.state.onModelRemoveChild,e,t,i)}onStoreModelAdd(e,t,i){Re(this,this.state.onStoreModelAdd,e,t,i)}onStoreModelInsert(e,t,i,r,n){Re(this,this.state.onStoreModelInsert,e,t,i,r,n)}onStoreModelRemove(e,t,i,r){Re(this,this.state.onStoreModelRemove,e,t,i,r)}onStoreRemoveAll(e,t,i){Re(this,this.state.onStoreRemoveAll,e,t,i)}onUndoKeyPress(e){const t=this;t.enabled&&(e.shiftKey?t.canRedo&&(e.preventDefault(),t.redo()):t.canUndo&&(e.preventDefault(),t.undo()))}stash(){this.transaction&&(this.stashedTransaction=this.transaction,this.rejectTransaction())}applyStash(){this.stashedTransaction&&(this.startTransaction(this.stashedTransaction.title),this.stashedTransaction.redo(),delete this.stashedTransaction)}}Ff._$name="StateTrackingManager";const qo=Array.prototype.slice,Ko=Object.freeze([]),kf=Object.freeze({}),Xo=/[&<]/,{getPrototypeOf:Jo}=Object,{toString:Lf}=Object.prototype,{isEqual:Qo,isObject:Pf}=x,Of={parent:1,elementData:1,ns:1,syncOptions:1},Zo=()=>({ignore:Of,refsFound:new Set}),ea={class:1,className:1,classname:1},Af={bigint:1,boolean:1,function:1,number:1,string:1,symbol:1},$f={tag:1,html:1,text:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,listeners:1,isReleased:1,null:1,"":1,keepChildren:1},_f=(u,e)=>{const t="className"in e?"className":"class",i=e[t];if(i)if(typeof i=="string"){const r=i.split(" ");r.includes(u)||(r.push(u),e[t]=r.join(" "))}else Array.isArray(i)?i.includes(u)||i.push(u):i.isDomClassList?i.add(u):x.isObject(i)&&(i[u]=1)},Hf=(u,e)=>{const t="className"in e?"className":"class",i=e[t];if(i)if(typeof i=="string"){const r=i.split(" ");r.includes(u)&&(r.splice(r.indexOf(u),1),e[t]=r.join(" "))}else Array.isArray(i)?i.includes(u)&&i.splice(i.indexOf(u),1):i.isDomClassList?i.remove(u):x.isObject(i)&&delete i[u]};class J{static checkEquality(e,t,i,r){if(e===t)return!0;if(e==null)return t==null;if(!e||!t)return!1;const n=typeof e;if(n!==typeof t||Af[n])return!1;let l=i.equalityCache||(i.equalityCache=new Map),o=Boolean(r),a,d,c,h,g,f,m;if(l=l.get(e)||l.set(e,new Map).get(e),a=l.get(t),a===void 0){if(a=!0,Jo(e)!==Jo(t)||e instanceof Node)a=!1;else if(Array.isArray(e)){if(d=e.length,d!==t.length)a=!1;else for(;d-- >0;)if(!J.checkEquality(e[d],t[d],i,o)){a=!1;break}}else{var p;f=e.syncOptions,h=(p=f)===null||p===void 0?void 0:p.ignoreRefs,h&&(o=!0,r=h!=="children"),c=i.ignore||kf;for(g in t)if(!c[g]&&!(g in e)&&!(r&&g==="reference")){a=!1;break}if(a){if(Lf.call(t)==="[object Date]")a=e.getTime()===t.getTime();else for(g in e)if(!c[g]&&!(r&&g==="reference")){if(!(g in t)){a=!1;break}if(m=e[g],!J.checkEquality(m,t[g],i,o)){a=!1;break}}}}if(!r&&Pf(e)&&e.reference){var v;(v=i.refsFound)===null||v===void 0||v.add(e.reference)}l.set(t,a)}return a}static sync(e){const t=e,{refOwner:i}=e,r=i?.byRef,n=Zo();let s=e.affected,l,o,a,d;if(typeof s=="string"&&(s=[s]),e=F(F({},e),{},{checkEqualityOptions:n}),i){if(i.byRef={},s)for(o in r)s.includes(o)||(i.byRef[o]=r[o]);e.refsWas=r}if(t.changed=J.performSync(e,e.targetElement),i)for(s||(s=Object.keys(r)),l=0;l<s.length;++l)o=s[l],a=r[o],n.refsFound.has(o)||a.retainElement?i.byRef[o]=a:(d=a.lastDomConfig,a.remove(),i.detachRef(o,a,d));return e.targetElement}static performSync(e,t){const{domConfig:i,callback:r}=e,{lastDomConfig:n}=t;if((e.configEquality||J.checkEquality)(i,n,e.checkEqualityOptions,e.ignoreRefs))r?.({action:"none",domConfig:i,targetElement:t});else return i?(i.onlyChildren||(J.syncAttributes(i,t,e),J.syncContent(i,t)),i.keepChildren||J.syncChildren(e,t)):(t.innerHTML=null,t.syncIdMap=null),t.lastDomConfig=i!=null&&i.onlyChildren&&n?F(F({},n),{},{children:i.children}):i,!0;return!1}static syncDataset(e,t){const{lastDomConfig:i}=t,r=e===i,n=Object.keys(e.dataset),s=i&&i.dataset&&Object.keys(i.dataset),l=B.delta(n,s);let o,a,d,c;for(a=0;a<l.onlyInA.length;a++)o=l.onlyInA[a],c=e.dataset[o],c!=null&&t.setAttribute(`data-${_.hyphenate(o)}`,c);for(a=0;a<l.inBoth.length;a++)o=l.inBoth[a],c=e.dataset[o],(r||c!=i.dataset[o])&&(d=`data-${_.hyphenate(o)}`,c==null?t.removeAttribute(d):t.setAttribute(d,c));for(a=0;a<l.onlyInB.length;a++)t.removeAttribute(`data-${_.hyphenate(l.onlyInB[a])}`)}static addCls(e,t){const{lastDomConfig:i}=t;e=q.normalize(e,"array"),e.forEach(r=>{t.classList.add(r),_f(r,i)})}static removeCls(e,t){const{lastDomConfig:i}=t;e=q.normalize(e,"array"),e.forEach(r=>{t.classList.remove(r),Hf(r,i)})}static syncClassList(e,t,i){let r=e.className||e.class,n=!1,s,l,o,a,d,c;if(i){for(l=q.normalize(t,"array"),r=q.normalize(r,"object"),c=q.normalize(i.className||i.class,"object"),d=[],o=0,a=l.length;o<a;++o)s=l[o],r[s]||!(s in c)?(c[s]=1,d.push(s)):n=!0;for(s in r)c[s]||(d.push(s),n=!0);if(!n)return;r=d.join(" ")}else r=q.normalize(r);t.setAttribute("class",r)}static getSyncAttributes(e){const t={},i=[];return e&&Object.keys(e).forEach(r=>{if(!$f[r]){const n=r.toLowerCase();t[n]=e[r],i.push(n)}}),{attributes:t,names:i}}static syncAttributes(e,t,i){const{lastDomConfig:r}=t,n=e===r,s=J.getSyncAttributes(e),{attributes:l,names:o}=s,{attributes:a,names:d}=n?s:J.getSyncAttributes(r),{onlyInA:c,onlyInB:h,inBoth:g}=n?{onlyInA:Ko,onlyInB:Ko,inBoth:o}:B.delta(o,d);let f,m;for(m=0;m<c.length;m++){f=c[m];const p=l[f];f==="style"&&p!=null?b.applyStyle(t,p,!0):f==="dataset"?J.syncDataset(e,t):ea[f]?J.syncClassList(e,t):p!=null&&t.setAttribute(f,p)}for(m=0;m<h.length;m++)t.removeAttribute(h[m]);for(m=0;m<g.length;m++){f=g[m];const p=l[f],v=a[f];p==null?t.removeAttribute(f):f==="style"?i.strict?n?J.syncStyles(t,p):Qo(p,v,!0)||J.syncStyles(t,p,v):(n||!Qo(p,v,!0))&&b.applyStyle(t,p,!0):f==="dataset"?J.syncDataset(e,t):ea[f]?J.syncClassList(e,t,i.strict&&t.lastDomConfig):(n||p!==v)&&t.setAttribute(f,p)}}static syncStyles(e,t,i){let r,n,s;if(!i)r=t;else{if(r={},t=b.parseStyle(t),i=b.parseStyle(i),t)for(n in t)s=t[n],i[n]!==s&&(r[n]=s);for(n in i)n in t||(r[n]="")}b.applyStyle(e,r)}static syncContent(e,t){const{html:i,text:r}=e,n=r??i;if(t.didSetTextContent=!1,e.elementData&&(t.elementData=e.elementData),n instanceof DocumentFragment)t.childNodes.length===1&&b.getChildElementCount(t)===0&&n.childNodes.length===1&&b.getChildElementCount(n)===0?b.setInnerText(t,n.firstChild.data):(t.innerHTML="",t.appendChild(n));else if(i!=null&&Xo.test(i))t.innerHTML=String(i);else if(n!=null){var s;const{lastDomConfig:l}=t;l!=null&&(s=l.children)!==null&&s!==void 0&&s.length||l!=null&&l.html&&Xo.test(t.lastDomConfig.html)?t.innerHTML=n:(b.setInnerText(t,String(n)),t.didSetTextContent=!0)}}static insertTextNode(e,t,i,r,n=null){const s=document.createTextNode(e);t.insertBefore(s,n),r&&(s.$refOwnerId=r.id),i?.({action:"newNode",domConfig:e,targetElement:s})}static insertElement(e,t,i,r,n,s,l){var o;const a=l.ns?document.createElementNS(l.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(a,i),J.performSync(l,a),s!=null&&(n[s]=a),!e.role&&!e.tabIndex&&!e["aria-hidden"]&&!b.isFocusable(a,!0)&&!a.htmlFor&&a.setAttribute("role","presentation"),r&&(a.$refOwnerId=r.id,s&&(a.$reference=s,r.attachRef(s,a,e))),(o=l.callback)===null||o===void 0||o.call(l,{action:"newElement",domConfig:e,targetElement:a,syncId:s})}static syncChildren(e,t){var i,r;let{domConfig:n,syncIdField:s,callback:l,releaseThreshold:o,configEquality:a,ns:d,refOwner:c,refsWas:h,strict:g,checkEqualityOptions:f,ignoreRefs:m}=e,p=n.syncOptions||{},v=null,y,C,w;if((i=n.html)!==null&&i!==void 0?i:n.text)return;m=Boolean((r=p.ignoreRefs)!==null&&r!==void 0?r:m),m&&(c=h=null),"strict"in p&&(g=p.strict);const S=c?c.byRef:{},D=qo.call(n.children||[]),I=qo.call(t.childNodes),R=h||t.syncIdMap||{},H=t.releasedIdMap||{},L=z=>{for(;I.length&&I[0].parentNode!==t;)I.shift();return(z?I.shift():I[0])||null};s=p.syncIdField||s,g=p.strict||g,l=p.callback||l,a=p.configEquality||a,o="releaseThreshold"in p?p.releaseThreshold:o,s&&(t.syncIdMap=S);const V={checkEqualityOptions:f||Zo(),ignoreRefs:m,refOwner:c,refsWas:h,strict:g,syncIdField:s,releaseThreshold:o,callback:l,configEquality:a};for(;D.length;){const z=D.shift();if(w=null,!z)continue;if(b.isReactElement(z)){l({jsx:z,targetElement:t});continue}if(z instanceof Node){C=L(),z!==C&&t.insertBefore(z,C),y=I.indexOf(z),y>-1&&I.splice(y,1);continue}const Z=typeof z=="string";if(V.domConfig=z,V.ns=z.ns||d,!Z){if(c?w=z.reference:s&&z.dataset&&(w=z.dataset[s]),w!=null&&!z.unmatched){const ve=R[w]||H[w];if(ve){const{lastDomConfig:Di}=ve;if(!ve.retainElement){if(J.performSync(V,ve)){var U;(U=l)===null||U===void 0||U({action:"reuseOwnElement",domConfig:z,targetElement:ve,lastDomConfig:Di,syncId:w})}}z.retainElement&&(ve.retainElement=!0),S[w]=ve,B.remove(I,ve),delete H[w],ve.isReleased=!1,C=L(),(ve.parentNode!==t||g&&ve.nextSibling!==C)&&t.insertBefore(ve,C)}else g?J.insertElement(z,t,L(),c,S,w,V):(D.push(z),z.unmatched=!0);continue}z.unmatched&&delete z.unmatched}let ne=null,X=null,ie;for(;!X&&(ie=L(!0));){if(c){if(ie.$refOwnerId!==c.id)continue;if(ie.$reference){if(!g)continue;ne=ie;break}X=ie}else ie.retainElement||(X=ie);X||(v||(v=[])).push(ie)}if(ne||!X)Z?J.insertTextNode(z,t,l,c,ne):J.insertElement(z,t,ne,c,S,w,V);else if(!Z&&X.nodeType===Node.ELEMENT_NODE&&(z.tag||"div").toLowerCase()===X.tagName.toLowerCase()){var Y,j;const{lastDomConfig:ve}=X,Di=J.performSync(V,X);if(s&&(ve==null||(Y=ve.dataset)===null||Y===void 0?void 0:Y[s])!=null){const wl=ve.dataset[s];delete H[wl],delete R[wl]}w!=null&&(S[w]=X),X.isReleased=!1,Di&&((j=l)===null||j===void 0||j({action:"reuseElement",domConfig:z,targetElement:X,lastDomConfig:ve,syncId:w}))}else Z&&X.nodeType===Node.TEXT_NODE?X.data=z:(Z?J.insertTextNode(z,t,l,c,X):J.insertElement(z,t,X,c,S,w,V),X.remove())}if(!(t.didSetTextContent&&I.length===1&&I[0].nodeType===Node.TEXT_NODE)){for(;C=L(!0);)(!c||C.$refOwnerId===c.id&&!C.$reference)&&(v||(v=[])).push(C);v&&J.syncChildrenCleanup(t,v,S,l,c,o,s)}}static syncChildrenCleanup(e,t,i,r,n,s,l){let o=0,a;for(const d of t){const{lastDomConfig:c}=d;if(d.nodeType===Element.TEXT_NODE){d.remove();continue}d.retainElement?l&&c&&(i[d.dataset[l]]=d):!n&&l&&(s==null||o<s)?(d.isReleased||(d.className="b-released",d.isReleased=!0,c!=null&&c.dataset&&(e.releasedIdMap||(e.releasedIdMap={}),e.releasedIdMap[c.dataset[l]]=d),r?.({action:"releaseElement",domConfig:c,lastDomConfig:c,targetElement:d}),c&&(c.isReleased=!0,c.className&&(c.className="b-released"),c.class&&(c.class="b-released"),c.style&&(c.style=null))),o++):(d.remove(),n&&(a=d.$reference,a&&n.detachRef(a,d,c)),e.releasedIdMap&&l&&c!==null&&c!==void 0&&c.dataset&&delete e.releasedIdMap[c.dataset[l]],r?.({action:"removeElement",domConfig:d.lastDomConfig,lastDomConfig:d.lastDomConfig,targetElement:d}))}}static removeChild(e,t){if(e.contains(t)){const i=e.syncIdMap;if(i){const r=Object.values(i).indexOf(t);r>-1&&delete i[Object.keys(i)[r]]}e.removeChild(t)}}static addChild(e,t,i){e.appendChild(t),e.syncIdMap||(e.syncIdMap={}),e.syncIdMap[i]=t}static getChild(e,t){const i=String(t).split(".");for(const s of i){var r,n;if(e=(r=e)===null||r===void 0||(n=r.syncIdMap)===null||n===void 0?void 0:n[s],!e)return null}return e}}J._$name="DomSync";class At{static init(){const e=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],t=s=>e.map(l=>{let o=s+_.capitalize(l);return s==="moz"&&(o=o.replace("screen","Screen"),"mozCancelFullScreen"in document&&l==="exitFullscreen"&&(o="mozCancelFullScreen")),o});this.functions="fullscreenEnabled"in document&&e||"webkitFullscreenEnabled"in document&&t("webkit")||"mozFullScreenEnabled"in document&&t("moz")||"msFullscreenEnabled"in document&&t("ms")||[];const i=["fullscreenchange","fullscreenerror"],r=["MSFullscreenChange","MSFullscreenError"],n=s=>i.map(l=>s+_.capitalize(l));this.events="fullscreenEnabled"in document&&i||"webkitFullscreenEnabled"in document&&n("webkit")||"mozFullscreenEnabled"in document&&n("moz")||"msFullscreenEnabled"in document&&r||[]}static get enabled(){return Boolean(this.functions[0]&&document[this.functions[0]])}static async request(e){return this.functions[1]&&e?.[this.functions[1]]()}static async exit(){return this.functions[2]&&document[this.functions[2]]()}static get isFullscreen(){return!!this.element}static get element(){return this.functions[3]&&document[this.functions[3]]}static onFullscreenChange(e){this.events[0]&&document.addEventListener(this.events[0],e)}static unFullscreenChange(e){this.events[0]&&document.removeEventListener(this.events[0],e)}}At.init();At._$name="Fullscreen";let rs=null;const ns=[],Nf=u=>{var e;return u.nodeType===u.ELEMENT_NODE&&((e=u.ownerDocument.defaultView)===null||e===void 0?void 0:e.getComputedStyle(u).getPropertyValue("position"))==="absolute"};class Le{static addResizeListener(e,t){const i=this;if((e===document||e===globalThis)&&(e=document.body),e.nodeType===e.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)i.hasWindowResizeListener||(globalThis.addEventListener("resize",i.onWindowResize),i.hasWindowResizeListener=!0);else if(globalThis.ResizeObserver)i.resizeObserver||(i.resizeObserver=new ResizeObserver(i.onElementResize)),i.resizeObserver.observe(e);else{e.classList.add("b-no-resizeobserver");const[r,n,s]=b.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},{returnAll:!0});n.scrollLeft=n.scrollTop=s.scrollLeft=s.scrollTop=1e6,n.addEventListener("scroll",i.onSizeMonitorScroll,!0),s.addEventListener("scroll",i.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver(l=>{const o=[],a=[];for(const c of l)c.type==="childList"&&(o.push.apply(o,c.addedNodes),a.push.apply(a,c.removedNodes));const d=[...o.filter(c=>!a.includes(c)),...a.filter(c=>!o.includes(c))];d.length!==0&&(d.length>0&&d.every(Nf)||n.dispatchEvent(new CustomEvent("scroll",{bubbles:!1})))})).observe(e,{childList:!0,subtree:!0}),t.monitorElement=r}e._bResizemonitor.handlers.push(t)}static removeResizeListener(e,t){if(e){(e===document||e===globalThis)&&(e=document.body);const i=e._bResizemonitor;let r=0;i&&i.handlers&&(B.remove(i.handlers,t),r=i.handlers.length),r||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}static onElementResize(e){for(const t of e){const i=t.target,r=i._bResizemonitor,n=t.contentRect||i.getBoundingClientRect();if(Dt(i)&&(!r.rectangle||n.width!==r.rectangle.width||n.height!==r.rectangle.height)){const s=r.rectangle;r.rectangle=n;for(const l of r.handlers)l(i,s,n)}}}static onSizeMonitorScroll(e){var t;if((t=document.body)!==null&&t!==void 0&&t.contains(e.target)){e.stopImmediatePropagation();const i=e.target.parentNode,r=i.parentNode,n=r._bResizemonitor,s=r.getBoundingClientRect();(!n.rectangle||s.width!==n.rectangle.width||s.height!==n.rectangle.height)&&(ns.push([r,n.rectangle,s]),n.rectangle=s,rs||(rs=requestAnimationFrame(Le.fireResizeEvents))),i.firstChild.scrollLeft=i.firstChild.scrollTop=i.childNodes[1].scrollTop=i.childNodes[1].scrollLeft=1e6}}static onWindowResize(e){const t=document.body,i=t._bResizemonitor,r=i.rectangle;i.rectangle=document.documentElement.getBoundingClientRect();for(const n of i.handlers)n(t,r,i.rectangle)}static fireResizeEvents(){for(const e of ns)for(const t of e[0]._bResizemonitor.handlers)e[0].offsetParent&&t.apply(this,e);rs=null,ns.length=0}static removeGlobalListeners(){globalThis.removeEventListener("resize",this.onWindowResize)}}Le._$name="ResizeMonitor";const ta={auto:"auto",true:"auto",false:"hidden","hidden-scroll":"auto",clip:W.supportsOverflowClip?"clip":"hidden"},ia="b-widget-scroller",ss={block:"nearest"},ra=Promise.resolve(),na=u=>new Promise(e=>A.on({element:u===document.documentElement?window:u,scroll:e,once:!0})),Bf={x:1},Fr={auto:1,scroll:1},Vf={true:1,auto:1},zf={overflowX:"auto",overflowY:"auto"},Wf=u=>{let e,t,i,r;if(!u)e=t=i=r=0;else if(typeof u=="number")e=t=i=r=u;else{var n,s,l,o;e=(n=u.top)!==null&&n!==void 0?n:0,t=(s=u.bottom)!==null&&s!==void 0?s:0,i=(l=u.start)!==null&&l!==void 0?l:0,r=(o=u.end)!==null&&o!==void 0?o:0}return{top:e,bottom:t,start:i,end:r}};class ot extends Se(Me($)){static get configurable(){return{widget:null,element:{$config:{nullify:!0},value:null},contentElement:{$config:{nullify:!0},value:null},overflowX:null,overflowY:null,translate:null,x:0,y:0,rtlSource:null}}static get delayable(){return{onScrollEnd:{type:"buffer",delay:100}}}get isRTL(){var e;return Boolean((e=this.rtlSource)===null||e===void 0?void 0:e.rtl)}syncOverflowState(){const e=this,{element:t}=e,i=new q(t.classList),r=e.hasOverflowX=t.scrollWidth>t.clientWidth,n=e.hasOverflowY=t.scrollHeight>t.clientHeight;i.value=t.classList,(i.toggle("b-horizontal-overflow",r)||i.toggle("b-vertical-overflow",n))&&(b.syncClassList(t,i),e.isConfiguring||e.trigger("overflowChange",{x:r,y:n}))}hasOverflow(e="y"){const t=this[`overflow${e.toUpperCase()}`],i=this[`overflow${e==="y"?"x":"y"}`];if(!b.scrollBarWidth||!Vf[t]||i==="hidden-scroll"||W.isFirefox){const r=e==="y"?"Height":"Width";return this[`scroll${r}`]>this[`client${r}`]}else return this[`hasOverflow${e.toUpperCase()}`]}hasScrollbar(e="y"){const{element:t}=this;if(t&&b.scrollBarWidth){const i=e==="y",r=i?"Width":"Height",n=t[`client${r}`],s=parseInt(b.getStyleValue(t,`border${i?"Left":"Top"}Width`))+parseInt(b.getStyleValue(t,`border${i?"Right":"Bottom"}Width`)),l=t[`offset${r}`]-s-n;return Math.abs(l-b.scrollBarWidth)<2}}addPartner(e,t=Bf){const i=this;typeof t=="string"&&(t={[t]:1}),i.partners||(i.partners={}),i.partners[e.id]={scroller:e,axes:t},t.x&&(e.x=i.x),t.y&&(e.y=i.y),e.isPartneredWith(i)||e.addPartner(i,t)}eachPartner(e){const{partners:t}=this;t&&Object.values(t).forEach(e)}removePartner(e){this.isPartneredWith(e)&&(delete this.partners[e.id],e.removePartner(this))}isPartneredWith(e){var t;return Boolean((t=this.partners)===null||t===void 0?void 0:t[e.id])}clearPartners(){this.partners&&Object.values(this.partners).forEach(e=>e.scroller.removePartner(this))}async scrollIntoView(e,t=ss){const i=this,{isRectangle:r}=e,n=r?e:O.from(e),{xDelta:s,yDelta:l}=i.getDeltaTo(e,t),o=i.scrollBy(s,l,t);return(t.highlight||t.focus)&&o.then(()=>{r&&(e=n.translate(-s,-l)),t.highlight&&(isNaN(t.highlight)?(i.widget||i).callback(t.highlight,null,[e]):b.highlight(e,i)),t.focus&&b.focusWithoutScrolling(e)}),o}static async scrollIntoView(e,t=ss,i=!1){const r=O.from(e),n=typeof t=="object"?t.animate:t,s=ot._globalScroller||(ot._globalScroller=new ot),l=[];s.rtlSource={rtl:i};let o=0,a=0,d;for(let c=e.parentNode;c.nodeType===Node.ELEMENT_NODE;c=c.parentNode){if(c===document.body&&c!==document.scrollingElement)continue;const h=c===document.scrollingElement?zf:c.ownerDocument.defaultView.getComputedStyle(c);if(t.y!==!1&&Fr[h.overflowY]&&c.scrollHeight>c.clientHeight||t.x!==!1&&Fr[h.overflowX]&&c.scrollWidth>c.clientWidth){s.element=c,s.positionDirty=!0;const{xDelta:g,yDelta:f}=s.getDeltaTo(r,t);(g||f)&&(l.push({element:c,x:c.scrollLeft,y:c.scrollTop,xDelta:g,yDelta:f}),r.translate(-g,-f),o+=g,a+=f)}}if(l.length){const c=Math.abs(o),h=Math.abs(a);let g=n&&(typeof n=="number"?n:typeof n.duration=="number"?n.duration:300);if(g&&(c>10||h>10))Math.max(c,h)<50&&(g=Math.min(g,500)),d=s.scrollAnimation=pe.animate(g,f=>{const m=f===1;for(const{element:p,x:v,y,xDelta:C,yDelta:w}of l)s.element=p,C&&(s.x=Math[i?"min":"max"](v+(m?C:Math.round(C*f)),0)),w&&(s.y=Math.max(y+(m?w:Math.round(w*f)),0))},null,n.easing),d.then(()=>{s.scrollAnimation=null});else{for(const{element:f,xDelta:m,yDelta:p}of l)f.scrollTop+=p,f.scrollLeft+=m;d=na(l[l.length-1].element)}}else d=ra;return(t.highlight||t.focus)&&d.then(()=>{t.highlight&&(isNaN(t.highlight)?s.callback(t.highlight,null,[e]):b.highlight(e,s)),t.focus&&e.focus()}),d}async scrollBy(e=0,t=0,i=ss){const r=this,n=typeof i=="object"?i.animate:i,s=Math.abs(e),l=Math.abs(t);r.scrollAnimation&&(r.scrollAnimation.cancel(),r.scrollAnimation=null),(e||t)&&(r.silent=i.silent);let o=n&&(typeof n=="number"?n:typeof n.duration=="number"?n.duration:300);if(o&&(s>10||l>10)){const{x:a,y:d}=r;let c=a,h=d;return Math.max(s,l)<50&&(o=Math.min(o,500)),r.scrollAnimation=pe.animate(o,g=>{const f=g===1;if(e){if(r.x!==c&&!i.force){var m;return(m=r.scrollAnimation)===null||m===void 0?void 0:m.cancel()}r.x=Math.max(a+(f?e:Math.round(e*g)),0)}if(t){if(r.y!==h&&!i.force){var p;return(p=r.scrollAnimation)===null||p===void 0?void 0:p.cancel()}r.y=Math.max(d+(f?t:Math.round(t*g)),0)}c=r.x,h=r.y},r,n.easing),r.element.classList.add("b-scrolling"),r.scrollAnimation.then(()=>{r.isDestroyed||(r.element.classList.remove("b-scrolling"),r.scrollAnimation=null)}),r.scrollAnimation}else{if(e|t){const a=r.x,d=r.y;if(r.x+=e,r.y+=t,r.x!==a||r.y!==d)return na(r.element)}return ra}}async scrollTo(e,t,i){const{x:r,y:n}=this,s=e==null?0:e-r,l=t==null?0:t-n;return this.scrollBy(s,l,i)}doDestroy(){var e;const t=this;if(t._element){var i;t._element.removeEventListener("scroll",t.scrollHandler),(i=t.wheelListenerRemover)===null||i===void 0||i.call(t)}(e=t.scrollAnimation)===null||e===void 0||e.cancel(),Object.values(t.partners||{}).forEach(({scroller:r})=>r.removePartner(t)),super.doDestroy()}onElMutation(e){const t=this,[i,r]=b.getTranslateXY(t.element);if(t._x!==-i||t.y!==-r){const n=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(n,"target",{get:()=>t.element}),t.onScroll(n)}}onElResize(){const e=this,{widget:t}=e;t!=null&&t.isAnimating?t.findListener("animationend","onElResize",e)===-1&&t.ion({animationEnd:"onElResize",thisObj:e,once:!0}):e.syncOverflowState()}onScroll(e){const t=this,{_x:i,_y:r,element:n}=t;let s=0;t.overflowX==="clip"&&n.scrollLeft!==i&&(n.scrollLeft=i,++s),t.overflowY==="clip"&&n.scrollTop!==r&&(n.scrollTop=r,++s),s!==2&&(!t.widget||!t.widget.isDestroyed)&&(t.positionDirty=!0,n.classList.contains("b-scrolling")||n.classList.add("b-scrolling"),e.widget=t.widget,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.onScrollEnd(e))}syncPartners(e,t){const i=this;i.partners&&Object.values(i.partners).forEach(({axes:r,scroller:n})=>{(n!==i.controllingPartner||e)&&n.sync(i,r)&&t&&n.syncPartners(e,t)})}onScrollEnd(e){const t=this;t.silent&&(t.silent=!1),t.trigger("scrollEnd",e),t.controllingPartner=null,t.element.classList.remove("b-scrolling")}getDeltaTo(e,t){const i=this;if(!i.viewport)return{xDelta:0,yDelta:0};const{x:r,y:n,scrollWidth:s,scrollHeight:l,isRTL:o}=i,a=e instanceof O?e:O.from(e),d=t.block||"nearest",c=i.viewport,h=Wf(t.edgeOffset),g=c.width>=a.width+(h.start+h.end)?h:{start:0,end:0},f=c.height>=a.height+(h.top+h.bottom)?h:{top:0,bottom:0},m=new O(o?c.right- -r-s:c.x-r,c.y-n,s,l),p=a.clone().adjust(-g.start,-f.top,g.end,f.bottom).constrainTo(m),v=p.clone(),y=i.isRTL?-1:1;let C=0,w=0;if(d==="start")v.moveTo(c.x+(i.isRTL?c.width:0),c.y),C=p.x-v.x,w=p.y-v.y;else if(d==="end")i.isRTL?v.moveTo(c.left+(i.isRTL?v.width:0),c.y):v.translate(c.right-v.right,c.bottom-v.bottom),C=p.x-v.x,w=p.y-v.y;else if(d==="center"){const S=c.center;v.moveTo(S.x-v.width/2,S.y-v.height/2),C=C||p.x-v.x,w=w||p.y-v.y}else v.width>c.width?C=v.x-c.x:v.right>c.right?C=v.right-c.right:v.x<c.x&&(C=v.x-c.x),v.height>c.height?w=v.y-c.y:v.bottom>c.bottom?w=v.bottom-c.bottom:v.y<c.y&&(w=v.y-c.y);return C=y*Math.round(C),w=Math.round(w),{xDelta:t.x===!1?0:Math.max(Math.min(C,i.maxX-r),-r),yDelta:t.y===!1?0:Math.max(Math.min(w,i.maxY-n),-n)}}get viewport(){return O.client(this.element)}updateWidget(e){this.rtlSource=this.owner=e}updateElement(e,t){const i=this;if(i===ot._globalScroller){i._element=e,i.positionDirty=!0;return}const r=i.scrollHandler||(i.scrollHandler=i.onScroll.bind(i)),n=i.resizeHandler||(i.resizeHandler=i.onElResize.bind(i));if(t){if(i.translate){var s;(s=i.mutationObserver)===null||s===void 0||s.disconnect(t)}else t.removeEventListener("scroll",r),t.classList.remove(ia),t.style.overflowX=t.style.overflowY="";Le.removeResizeListener(t,n)}if(e){if(i.translate){if(i.mutationObserver||(i.mutationObserver=new MutationObserver(i.mutationHandler||(i.mutationHandler=i.onElMutation.bind(i)))),i._x=i._y=0,document.contains(e)){const[l,o]=b.getTranslateXY(e);i._x=-l,i._y=-o}i.mutationObserver.observe(e,{attributes:!0})}else e.addEventListener("scroll",r),e.classList.add(ia);Le.addResizeListener(e,n),i.widget||(i.rtlSource={get rtl(){return b.getStyleValue(e,"direction")==="rtl"}}),i.isRTL&&e.classList.add("b-rtl"),i.positionDirty&&(i.updateOverflowX(i.overflowX),i.updateOverflowY(i.overflowY)),i.syncOverflowState(),i.isConfiguring&&(i._x&&i.updateX(i._x),i._y&&i.updateY(i._y))}i.positionDirty=!0}get x(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[i,r]=b.getTranslateXY(t);e._x=-i,e._y=-r}else e._x=Math.abs(t.scrollLeft),e._y=t.scrollTop;e.positionDirty=!1}return e._x}get scrollLeft(){return this.element.scrollLeft}changeX(e){if(e=Math.max(e,0),!this.isConfiguring||e)return e;this._x=e}updateContentElement(e){e&&(e=typeof e=="string"?this.element.querySelector(e):e,Le.addResizeListener(e,this.resizeHandler))}updateX(e){var t;const{element:i}=this;i&&!((t=this.widget)!==null&&t!==void 0&&t.isConfiguring)&&(e=Math.round(e),this.trigger("scrollStart",{x:e}),this.translate?b.setTranslateX(i,-e):i.scrollLeft=this.isRTL?-e:e),this.positionDirty=!0}sync(e,t){const i=this,{x:r,y:n}=t;let s=!1;return r!=null&&i.x!==e.x&&(i.controllingPartner=e,i.x=e.x,s=!0),n!=null&&i.y!==e.y&&(i.controllingPartner=e,i.y=e.y,s=!0),s}get y(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[i,r]=b.getTranslateXY(t);e._x=-i,e._y=-r}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y}changeY(e){if(!this.isConfiguring||e)return e;this._y=e}updateY(e){const{element:t,widget:i}=this;t&&!(i!=null&&i.isConfiguring)&&(this.trigger("scrollStart",{y:e}),this.translate?b.setTranslateY(t,-e):t.scrollTop=e),this.positionDirty=!0}get maxX(){return this.scrollWidth-this.clientWidth}get maxY(){return this.scrollHeight-this.clientHeight}get lastScrollLeft(){return(this.scrollWidth-this.clientWidth)*(this.isRTL?-1:1)}updateOverflowX(e,t){const i=this,{element:r,translate:n}=i,{style:s,classList:l}=r;t==="hidden-scroll"&&l.remove("b-hide-scroll"),e==="hidden-scroll"&&!n&&(Fr[s.overflowY]?(e="hidden",i.enableWheel()):l.add("b-hide-scroll")),n||(s.overflowX=ta[e]||e),i.isConfiguring||(i.positionDirty=!0,i.syncOverflowState())}updateOverflowY(e,t){const i=this,{element:r,translate:n}=i,{style:s,classList:l}=r;t==="hidden-scroll"&&l.remove("b-hide-scroll"),e==="hidden-scroll"&&!n&&(Fr[s.overflowX]?(e="hidden",i.enableWheel()):l.add("b-hide-scroll")),n||(s.overflowY=ta[e]||e),i.isConfiguring||(i.positionDirty=!0,i.syncOverflowState())}enableWheel(){this.wheelListenerRemover||(this.wheelListenerRemover=A.on({element:this.element,wheel:"onWheel",thisObj:this}))}onWheel(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&this.overflowX==="hidden-scroll"?this.x+=e.deltaX:this.overflowY==="hidden-scroll"&&(this.y+=e.deltaY)}get scrollWidth(){var e,t;return(e=(t=this.element)===null||t===void 0?void 0:t.scrollWidth)!==null&&e!==void 0?e:0}set scrollWidth(e){const t=this,{element:i,isRTL:r}=t;let n=t.widthStretcher;n&&e==null?(n.remove(),t.widthStretcher=null):e&&(e=Math.abs(e),n||(n=t.widthStretcher=b.createElement({className:"b-scroller-stretcher b-horizontal-stretcher",retainElement:!0})),n.style.transform=`translateX(${(e-1)*(r?-1:1)}px)`,i&&!i.contains(n)&&i.insertBefore(n,i.firstElementChild)),t.propagate!==!1&&t.eachPartner(({scroller:s})=>{s.propagate=!1,s.scrollWidth=e,delete s.propagate}),t.positionDirty=!0,t.syncOverflowState()}get scrollHeight(){var e,t;return(e=(t=this.element)===null||t===void 0?void 0:t.scrollHeight)!==null&&e!==void 0?e:0}set scrollHeight(e){const t=this,i=t.stretcher||(t.stretcher=b.createElement({className:"b-scroller-stretcher"}));i.style.transform=`translateY(${e-1}px)`,t.element&&t.element.lastChild!==i&&t.element.appendChild(i),t.positionDirty=!0,t.syncOverflowState()}get clientWidth(){var e;return((e=this.element)===null||e===void 0?void 0:e.clientWidth)||0}get clientHeight(){var e;return((e=this.element)===null||e===void 0?void 0:e.clientHeight)||0}get id(){return this._id||(this.widget?this._id=`${this.widget.id}-scroller`:this._id=dn.generateId("scroller-")),this._id}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(),delete e.widget,delete e.element}}ot._$name="Scroller";class js{constructor(e){this.promise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),e&&e(this)}}js._$name="Promissory";const{defineProperty:ls}=Reflect;class Nt extends $.mixin(zt,Me,Se,ir){static get configurable(){return{element:null}}static get delayable(){return{refreshDom:"raf"}}static get identifiable(){return{}}static get renderConfigs(){const e=this,t=e.$meta;let i=t.renderConfigs,r,n;if(i===void 0){i=null,r=t.configs;for(n in r)r[n].render&&(i||(i=new Set)).add(n);t.renderConfigs=e.prototype.$renderConfigs=i}return i}construct(...e){this.$iid=++Nt.$idSeed,this.byRef={},super.construct(...e),this.onDraw!==Nt.prototype.onDraw&&this.initDrawable()}startConfigure(e){this.element=this.renderContext.renderDom(),super.startConfigure(e)}get element(){return this.refreshDom.flush(),this._element}changeElement(e,t){const i=this;return t&&t.remove(),e&&(e.id=i.id,e=b.createElement(e,{refOwner:i})),e}updateId(e,t){const i=this;if(t){const r=i.element;r.id=e,i.fixRefOwnerId(r,e,t)}}get classes(){return this.element.classList}fixRefOwnerId(e,t,i){if(e.$refOwnerId===i){e.$refOwnerId=t;const r=e.$reference;r&&(e.id=`${t}-${r}`);for(const n of e.childNodes)this.fixRefOwnerId(n,t,i)}}onConfigChange({name:e}){!this.isConfiguring&&this.$renderConfigs.has(e)&&this.refreshDom()}attachRef(e,t,i){const r=this,n="_"+e,{listeners:s}=i;n in r||ls(r,e,{get(){return r.refreshDom.flush(),r[n]},set(l){r[n]=l}}),t.id=`${r.id}-${e}`,r.byRef[e]=t,r[e]=t,s&&(i.listeners={on:s,un:A.on(Object.assign({element:t,thisObj:r},s))})}detachRef(e,t,i){i.listeners&&(i.listeners.un(),i.listeners=null),this[e]=null,delete this.byRef[e]}renderDom(){return{}}get renderContext(){const e=this,t=e.$meta,i=e.constructor;let r=t.renderConfigs||i.renderConfigs,n=e;if(!r){n=Object.create(e),r=new Set;for(const s in t.configs)ls(n,s,{get(){return r.add(s),e[s]}});n.renderDom=()=>e.renderDom.call(n),e.$renderConfigs=r}return ls(e,"renderContext",{value:n}),n}refreshDom(){J.sync({targetElement:this.element,domConfig:this.renderContext.renderDom(),refOwner:this,strict:!0})}onListen(e){e==="draw"&&this.initDrawable()}initDrawable(){const e=this;if(!e.intersector){let t=Object.values(e.byRef).find(i=>i.classList.contains("b-drawable"));t||(t=e.element,t.classList.add("b-drawable")),e.intersector=new IntersectionObserver(i=>{e.isDestroyed||i.forEach(r=>{r.isIntersecting&&e.onDraw({count:++e.drawCounter})})}),e.intersector.observe(t)}}onDraw(e){this.trigger("draw",e)}}Nt.$idSeed=0;Object.assign(Nt.prototype,{drawCounter:0,hasGeneratedId:!1,intersector:null});Nt._$name="Renderable";class Pe extends Nt{construct(e){if(e){let r=e.element,n;r&&(re.deprecate("Core","4.0.0",'Mask "element" config has been renamed to "target"'),e=n=Object.assign({},e),delete n.element,n.target=r),r=e.target,typeof r=="string"&&(e=n=n||Object.assign({},e),n.target=e.owner[r])}super.construct(e);const t=this,{type:i}=t;t.target||(t.target=document.body),t.maskName=`mask${typeof i=="string"?i.trim():""}-${Pe.counter++}`,t.show()}doDestroy(){const e=this,{element:t}=e;if(e.type==="trial")return!1;t&&(e.element=null,e.mode.endsWith("blur")&&b.forEachChild(t,i=>{i.classList.remove(`b-masked-${e.mode}`)}),e.target.classList.remove("b-masked"),e.target[e.maskName]=null,B.remove(Pe.masks,e)),super.doDestroy()}get maskElement(){return this.element}set error(e){this.setConfig(this.errorDefaults),this.text=e}renderDom(){const e=this,{maxProgress:t}=e;return{class:{"b-mask":1,"b-delayed-show":e.showDelay,"b-widget":1,[`b-mask-${e.mode}`]:1,"b-progress":t,"b-prevent-transitions":!e.useTransition},children:[{reference:"maskContent",class:"b-mask-content b-drawable",children:[t?{reference:"progressElement",class:"b-mask-progress-bar",style:{width:`${Math.max(0,Math.min(100,Math.round(e.progress/t*100)))}%`}}:null,{reference:"maskText",class:"b-mask-text",html:(e.icon?`<i class="b-mask-icon ${e.icon}"></i>`:"")+e.text}]}]}}static mergeConfigs(...e){const t={};for(const i of e)typeof i=="string"?t.text=i:x.assign(t,i);return t}static mask(e,t=document.body){return Pe.new({target:t},typeof e!="string"?F({},e):{text:e})}static unmask(e=document.body){const t=this.getElementMasks(e);return t.length>0?t[t.length-1].close():null}static unmaskAll(e=document.body){return this.getElementMasks(e).forEach(t=>t.close())}static getElementMasks(e){return this.masks.filter(t=>t.target===e)}updateAutoClose(e){this.deferredClose.cancel(),e&&(this.deferredClose.delay=e,this.deferredClose())}updateCover(){this.syncCover()}syncCover(){var e,t;(e=this.owner)===null||e===void 0||(t=e.syncMaskCover)===null||t===void 0||t.call(e,this)}onOwnerResize(){this.syncCover()}updateOwner(e){this.detachListeners("cover"),e?.ion({name:"cover",recompose:"onOwnerResize",resize:"onOwnerResize",thisObj:this})}updateShowDelay(e){const{delayedShow:t}=this;t.delay=e,e||t.flush()}deferredClose(){var e;const{owner:t}=this;this.close().then(()=>{var i;t==null||(i=t.onMaskAutoClose)===null||i===void 0||i.call(t,this)}),t==null||(e=t.onMaskAutoClosing)===null||e===void 0||e.call(t,this)}delayedShow(){this.classes.remove("b-delayed-show")}show(){const e=this,{element:t,target:i,hiding:r,maskName:n}=e;r&&(r.resolve(),e.hiding=null,e.clearTimeout("hide")),e.showDelay&&(t.classList.add("b-delayed-show"),e.delayedShow()),t.classList.add("b-visible"),t.classList.remove("b-hidden"),i.classList.add("b-masked"),i[n]||(i[n]=e,i.appendChild(t)),B.include(Pe.masks,e),e.shown=!0,e.trigger("show"),e.mode.endsWith("blur")&&b.forEachChild(i,s=>{s!==t&&s.classList.add(`b-masked-${e.mode}`)})}hide(){const e=this,{target:t,element:i}=e;let{hiding:r}=e;if(!r){if(!e.shown)return Promise.resolve();e.hiding=r=new js,e.shown=!1,i.classList.remove("b-visible"),i.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&b.forEachChild(t,n=>{n!==i&&n.classList.remove(`b-masked-${e.mode}`)}),r.promise=r.promise.then(()=>{e.hiding===r&&(e.hiding=null)}),e.setTimeout(()=>r.resolve(),500,"hide")}return r.promise}async close(){await this.hide(),this.destroy()}}T(Pe,"$name","Mask");T(Pe,"type","mask");T(Pe,"configurable",{autoClose:null,cover:null,icon:"b-icon b-icon-spinner",errorDefaults:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maxProgress:null,mode:"dark",progress:null,owner:{$config:"nullify",value:null},target:null,text:null,type:null,showDelay:null,useTransition:!1});T(Pe,"delayable",{deferredClose:0,delayedShow:0,syncCover:{type:"throttle",delay:100}});T(Pe,"counter",0);T(Pe,"masks",[]);Pe._$name="Mask";var jf=u=>{var e;return e=class extends(u||$){get widgetClass(){}get keyMapElement(){return this.element}get keyMapSubComponents(){return this.features}performKeyMapAction(i){const{keyMap:r}=this;let n=!1;if(r&&!i.handled&&i.key!==void 0){const l=x.keys(r).find(o=>{const a=o.split("+"),d=a.includes("Alt"),c=a.includes("Shift"),h=a.includes("Ctrl");let g=a[a.length-1].toLowerCase();return g==="space"&&(g=" "),g===i.key.toLowerCase()&&(!i.altKey&&!d||i.altKey&&d)&&(!i.ctrlKey&&!h||i.ctrlKey&&h)&&(!i.shiftKey&&!c||i.shiftKey&&c)});if(r[l]){const o=B.asArray(r[l]);i.fromKeyMap=!0;let a;for(let d of o){if(a=!0,x.isObject(d)){if(!d.handler)continue;d.preventDefault===!1&&(a=!1),d=d.handler}if(typeof d=="string"){var s;const{thisObj:c,handler:h}=this.resolveKeyMapAction(d);if(((s=c.isActionAvailable)===null||s===void 0?void 0:s.call(c,l,d,i))!==!1&&h.call(c,i)!==!1){n=!0;break}}else if(d.call(this)!==!1){n=!0;break}}delete i.fromKeyMap,n&&(a&&i.preventDefault(),i.handled=!0)}}return n}resolveKeyMapAction(i){const{keyMapSubComponents:r}=this;if(r&&i.includes(".")){const[n,s]=i.split(".");if(n&&s)return{thisObj:r[n],handler:r[n][s]}}return{thisObj:this,handler:this[i]}}updateKeyMap(i){var r;(r=this.keyMapDetacher)===null||r===void 0||r.call(this),x.isEmpty(i)||(this.keyMapDetacher=A.on({element:this.keyMapElement,keydown:"keyMapOnKeyDown",thisObj:this}))}keyMapOnKeyDown(i){this.performKeyMapAction(i)}mergeKeyMaps(i,r,n=null){const s={};i&&x.assign(s,i);for(const l in r){if(!r[l])continue;const o=B.asArray(i?.[l]),a=[];o!=null&&o.length&&a.push(...o);for(const d of B.asArray(r[l]))x.isObject(d)&&d.handler?a.push(x.assignIf({handler:(n?n+".":"")+d.handler},d)):a.push((n?n+".":"")+d);a.sort((d,c)=>{const h=(d.weight||0)-(c.weight||0);return h===0&&o!==null&&o!==void 0&&o.length?o.indexOf(d)-o.indexOf(c):h}),s[l]=a}return s}},T(e,"$name","KeyMap"),T(e,"configurable",{keyMap:{value:null,$config:{merge:"objects",nullify:!0}}}),e},Gf=u=>{var e;return e=class extends(u||$){get widgetClass(){}updateRtl(i){const{element:r}=this;r&&(r.classList.toggle("b-rtl",i===!0),r.classList.toggle("b-ltr",i===!1))}startConfigure(i){var r;if((r=super.startConfigure)===null||r===void 0||r.call(this,arguments),!i.floating&&i.rtl==null){var n;const s=this,l=i.rootElement||i.forElement||((n=s.parent)===null||n===void 0?void 0:n.contentElement)||(s.floating?s.floatRoot:s.changeElementRef(s.getRenderContext(i)[0]||i.adopt||document.body)),o=i.owner||i.parent||s.constructor.fromElement(l);o?i.rtl=o[o.isConfiguring?"peekConfig":"getConfig"]("rtl"):i.rtl=l?.nodeType===1&&getComputedStyle(l).getPropertyValue("direction")==="rtl",i.rtl&&(s.configDone.rtl=!1)}}render(...i){var r;if(super.render&&super.render(...i),(W.isChrome&&W.chromeVersion<87||W.isFirefox&&W.firefoxVersion<66||W.isSafari&&W.safariVersion<14.1)&&this.element.classList.add("b-legacy-inset"),getComputedStyle(this.element).direction==="rtl"||(r=this.owner)!==null&&r!==void 0&&r.rtl){var n;this.rtl=!0,(n=this.childItems)===null||n===void 0||n.forEach(s=>s.rtl=!0)}}},T(e,"$name","RTL"),T(e,"configurable",{rtl:null}),e};const sa=Object.freeze({highlight:!1,onlyName:!1}),Ai=[],os="highlightExternalChange",as=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,Uf={INPUT:1,TEXTAREA:1},ds=(u,e,t,i)=>{var r;let n=t?.listeners||t?.internalListeners;if(n=((r=n)===null||r===void 0?void 0:r.ion)||n,n){const s=A.on(x.assign({element:e,thisObj:u},n));i?(u._refListeners||(u._refListeners=Object.create(null)))[i]=s:t.listeners={on:n,un:s}}},la=(u,e)=>u&&e&&e[x.keys(u)[0]]?de.merge(u,e):u,Yf=u=>{u.isVisible&&u.triggerPaint()},qf=/^:not\((.+)\)$/,Kf=/absolute|fixed/i,Xf=u=>u.scale!=null,{hasOwnProperty:Qt}=Object.prototype,{defineProperty:oa}=Reflect,aa=u=>parseFloat(u)*(u.endsWith("ms")?1:1e3),da=["b-aligned-above","b-aligned-right","b-aligned-below","b-aligned-left"],Jf={configurable:!0,get(){return!1}},kr=/(?:L\{([^}.]+)\})/,Qf=(u,e)=>"L{Tooltip."+e+"}",ca=/^([trblc])(\d*)-([trblc])(\d*)$/i,Zf=(u,e)=>(ca.test(u)&&(u={align:u}),ca.test(e)&&(e={align:e}),de.merge(u,e)),eg=/^[\w.]+$/;class k extends $.mixin(zt,Me,Se,ir,hi,jf,Gf){static mergeCls(e,t){return t&&e?e=new q(t).assign(typeof e=="string"?new q(e):e):e&&!e.isDomClassList&&(e=new q(e)),e}static get $name(){return"Widget"}static get type(){return"widget"}static get configurable(){return{element:!0,callOnFunctions:!0,id:"",html:null,content:null,cls:{$config:{merge:"classList"},value:null},ui:{$config:{merge:"classList"},value:null},collapsify:null,contentElementCls:{$config:{merge:"classList"},value:null},defaultCls:{$config:{merge:"classList"},value:null},dock:null,forwardTwinEvents:{$config:{merge:"classList"},value:null},parent:null,tab:null,elementAttributes:null,htmlCls:{$config:{merge:"classList"},value:{"b-html":1}},style:null,disabled:null,readOnly:{value:null,default:!1,$config:null},ignoreParentReadOnly:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:{$config:["lazy","nullify"],value:null},showTooltipWhenDisabled:!0,preventTooltipOnTouch:null,monitorResize:{$config:["lazy","nullify"],value:null},masked:{$config:"nullify",value:null},maskDefaults:{target:"element"},cache:{},floating:null,positioned:null,draggable:null,align:{$config:{merge:Zf},value:"t-b"},centered:null,constrainTo:void 0,anchor:null,owner:null,scrollAction:null,hideAnimation:{$config:{merge:la},value:null},showAnimation:{$config:{merge:la},value:null},x:null,y:null,scrollable:{$config:["lazy","nullify"],value:null},scrollerClass:ot,defaultBindProperty:"html",defaultAction:null,overflowable:{value:null,default:!0,$config:null},width:null,height:null,maxHeight:null,maxWidth:null,minWidth:null,minHeight:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,weight:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title","ariaLabel","ariaDescription"],requireSize:!1,ref:null,hidden:null,textAlign:null,ignoreScrollDuration:500,tag:"div",recomposeAsync:null,rootElement:null,htmlMutationObserver:{$config:["lazy","nullify"],value:{childList:!0,subtree:!0}},role:{$config:"lazy",value:"presentation"},ariaLabel:{$config:"lazy",value:null},ariaDescription:{$config:"lazy",value:null},ariaElement:"element",ariaHasPopup:null,realignTimeout:300,testConfig:{ignoreScrollDuration:100,realignTimeout:50}}}static get prototypeProperties(){return{hasGeneratedId:!1,innerItem:!0}}static get declarable(){return["renderConfigs"]}static get delayable(){return{recompose:"raf",doHideOrRealign:"raf",onAlignConstraintChange:"raf"}}static get factoryable(){return{defaultType:"widget"}}static get identifiable(){return{}}static get all(){return super.all}static get recomposeAsync(){return k._recomposeAsync}static set recomposeAsync(e){if(k._recomposeAsync=e,e!=null){const{all:t}=k;for(let i=0;i<t.length;++i)t[i].isComposable&&(t[i].recomposeAsync=e)}}isType(e,t){return k.isType(this,e,t)}static setupRenderConfigs(e,t){let{renderConfigs:i}=e,r;if(i){const n=t.getInherited("renderConfigs",!1)||Object.create(null);if(Array.isArray(i)){for(r=0;r<i.length;++r)n[i[r]]=!0;i=n}else i=Object.assign(n,i)}t.renderConfigs=i}construct(e={},...t){const i=this,{domSyncCallback:r}=i;i.configureAriaDescription=e.ariaDescription,i._isAnimatingCounter=0,i.alignConstrained=0,i.byRef=Object.create(null),i.onTargetResize=i.onTargetResize.bind(i),i.onFullscreenChange=i.onFullscreenChange.bind(i),i.domSyncCallback=r.$nullFn?null:r.bind(i),i._isUserAction=!1,super.construct(e,...t);const{recomposeAsync:n}=k;n!=null&&i.recomposeAsync==null&&(i.recomposeAsync=n),i.finalizeInit()}startConfigure(e){super.startConfigure(e);const t=this,{adopt:i,element:r}=t;i&&(t.adoptElement(r,i,e.id),t.updateElement(t._element,r))}finalizeInit(){const e=this;(e.insertBefore||e.appendTo||e.insertFirst||e.adopt)&&e.render()}doDestroy(){const e=this,{preExistingElements:t,element:i,_refListeners:r}=e;if(r&&(Object.values(r,o=>o()),e._refListeners=null),i){var n,s,l;const o=!e._tooltip&&e._rootElement&&((n=k.Tooltip)===null||n===void 0?void 0:n.getSharedTooltip(e._rootElement,!0));if(o?.owner===e&&(o.owner=null,o.hide()),e.onExitFullscreen(),e.clearTimeout(e.scrollListenerTimeout),e.clearTimeout(e.resizeListenerTimeout),e.removeTransientListeners(),e.floating||e.positioned?e.hide(!1):e.revertFocus(),Le.removeResizeListener(i.parentElement,e.onParentElementResize),Le.removeResizeListener(i,e.onElementResize),e.adopt){for(let a=Array.from(i.childNodes),d=0,{length:c}=a;d<c;d++){const h=a[d];!t.includes(h)&&h!==e.floatRoot&&h.remove()}i.className=e.adoptedElementClassName,i.style.cssText=e.adoptedElementCssText}else i.remove();(s=e.dragEventDetacher)===null||s===void 0||s.call(e),(l=e.dragOverEventDetacher)===null||l===void 0||l.call(e),e.dragGhost.remove()}super.doDestroy()}get assignValueDefaults(){return sa}get valueName(){return this.name||this.ref||this.id}getValueName(e){return e=e&&typeof e=="object"?e.onlyName:e,e?this.name:this.valueName}assignFieldValue(e,t,i){const r=this,n=r.defaultBindProperty;n in r&&(r[n]=i)}assignValue(e,t){t=t||sa;const i=this,r=i[os],n=i.getValueName(t);n&&(!e||n in e)&&(t.highlight===!1&&(i[os]=!1),i.assignFieldValue(e,n,e?e[n]:null),i[os]=r)}gatherValue(e){const t=this,i=t.defaultBindProperty;t.constructor!==k&&i in t&&(e[t.name||t.ref||t.id]=t[i])}gatherValues(e){this.eachWidget(t=>t.gatherValue(e),!1)}get forwardTwinEvents(){const e=this._forwardTwinEvents;return e&&x.getTruthyKeys(e)}configureOverflowTwin(e){var t;const i=this;let r=x.clone(i.initialConfig);return delete r.id,r.hidden=!1,r.type=i.type,r._overflowTwinOrigin=i,r.disabled=i.disabled,"value"in i&&(r.value=i.value),(t=i.forwardTwinEvents)===null||t===void 0||t.forEach(n=>{delete r[`on${_.capitalize(n)}`]}),e&&(r=typeof e=="function"?e(r)||r:x.assign(r,e)),r}createOverflowTwin(e){var t;const i=this,r=i.configureOverflowTwin(e),n=k.create(r);return(t=i.forwardTwinEvents)===null||t===void 0||t.forEach(s=>{n.ion({[s]:l=>{i.overflowTwin===l.source&&(l=x.assign({},l),delete l.source,i.trigger(l.type,l))}})}),n}ensureOverflowTwin(e,t){let{overflowTwin:i}=this;return i||(this.overflowTwin=i=this.createOverflowTwin(e),t?.(i)),i}get isComposable(){return!this.compose.$nullFn}adoptElement(e,t,i){const r=this,n=typeof t=="string"?document.getElementById(t):t,s=k.fromElement(n);s&&s.adopt&&s!==r&&(typeof s.adopt=="string"?document.getElementById(s.adopt):s.adopt)===n&&s.destroy(),r.preExistingElements=Array.from(n.childNodes),r.adoptedElementClassName=n.className,r.adoptedElementCssText=n.style.cssText,n.id&&!i&&(r.id=e.id=n.id),b.syncAttributes(e,n);for(let d=0,{length:c}=e.childNodes;d<c;d++)n.appendChild(e.childNodes[0]);delete r._contentRange,r._element=n;const l=e.lastDomConfig,o=l?.listeners;if(o&&r.isComposable){var a;(a=o.un)===null||a===void 0||a.call(o),ds(r,n,l)}n.lastDomConfig=l||n.lastDomConfig,n.$refOwnerId=r.id,r.scaleToFitWidth||r.getConfig("monitorResize")}addRefAccessor(e,t){const{prototype:i}=this.constructor;oa(i,t,{writable:!0,value:null}),oa(i,e,{get(){return this.recompose.flush(),this[t]},set(r){this[t]=r}})}attachRef(e,t,i){const r=this,n="_"+e;t.dataset&&(t.dataset.ownerCmp=r.id),r.isComposable&&(n in r||r.addRefAccessor(e,n),ds(r,t,i,e)),r.byRef[e]=t,r[e]=t}detachRef(e,t,i){const r=this,n=r._refListeners;n!=null&&n[e]&&(n[e](),delete n[e]),r[e]=null,delete r.byRef[e]}afterRecompose(){}compose(){return{class:q.normalize(this.widgetClassList,"object")}}doCompose(){const e=this,{$meta:t}=e,i=t.hierarchy;let{composers:r}=t,n=null,s,l,o,a,d,c;if(e.recompose.suspend(),!r){for(o=!0,t.composers=r=[],a=i.indexOf(k);a<i.length;++a)d=i[a].prototype,Qt.call(d,"compose")&&r.push(d);(c=t.getInherited("renderConfigs",!1))||(c=Object.create(null),e.configObserver={get(h){c[h]=!0}}),t.$renderConfigs=c}for(a=0;a<r.length;++a)s=r[a].compose.call(e,n),n=n?b.merge(n,s):s;return Qt.call(e,"compose")&&(s=e.compose)&&(s=s.call(e,n),b.merge(n,s)),o&&delete e.configObserver,b.normalizeChildren(n,(h,g)=>{g&&(l="_"+h,l in e||e.addRefAccessor(h,l))})}get element(){return this.isComposable&&!this.isDestroying&&this.recompose.flush(),this._element}domSyncCallback(e){}changeElement(e){const t=this,i=t.isComposable;return i&&(e=t.doCompose()),typeof e=="string"?e=b.createElementFromTemplate(e):x.isObject(e)?(e=b.createElement(e,{refOwner:t,callback:t.domSyncCallback}),t.recompose.resume(),i&&ds(t,e,e.lastDomConfig)):b.isReactElement(t.peekConfig("html"))?e=document.createElement("div"):e.nodeType!==1&&(e=b.createElementFromTemplate(t.template(t))),e.id=t.id,t.elementAttributes&&b.setAttributes(e,t.elementAttributes),e}updateElement(e){const t=this,{className:i}=e,{contentElement:r,contentElementCls:n,isComposable:s}=t,l=r!==e,o=!s&&e.querySelectorAll("[data-reference]"),a=s?[]:t.widgetClassList;let d=(l||!s)&&t.uiClasses;if(i&&a.unshift(i),t._hidden&&a.push("b-hidden"),t._readOnly&&a.push("b-readonly"),pe.noThrow(e,"remove"),d?(n!=null&&n.value&&(d=d.slice(),d.push(n.value)),d=d.join(" ")):d=n?.value,d&&(l?r.className+=" "+d:a.push(d)),!t.parent){const{defaultCls:c}=t,{outerCls:h}=k;a.push(...c?h.filter(g=>!(g in c)||c[g]):h)}if(e.className=a.join(" "),o)for(let c,h=0;h<o.length;++h)c=o[h],t.attachRef(c.getAttribute("data-reference"),c),c.removeAttribute("data-reference");!t.adopt&&!t.scaleToFitWidth&&t.getConfig("monitorResize"),t.getConfig("role"),t.getConfig("ariaLabel"),t.getConfig("ariaDescription"),t._html&&t.getConfig("htmlMutationObserver"),t.trigger("elementCreated",{element:e})}updateAriaDescription(e){const{ariaElement:t}=this,i=`${this.id}-aria-desc-el`;if(e){const r=this._ariaDescEl||(this._ariaDescEl=b.createElement({className:"b-aria-desc-element",id:i,parent:t}));r.innerText=e.match(kr)?this.L(e,this):e,t.setAttribute("aria-describedBy",r.id)}else t.getAttribute("aria-describedby")===i&&t.removeAttribute("aria-describedBy")}updateAriaLabel(e){b.setAttributes(this.ariaElement,{"aria-label":e!=null&&e.match(kr)?this.L(e,this):e})}updateAriaHasPopup(e){b.setAttributes(this.ariaElement,{"aria-haspopup":e})}updateRole(e){if(e){var t;(t=this.ariaElement)===null||t===void 0||t.setAttribute("role",e)}else{var i;(i=this.ariaElement)===null||i===void 0||i.removeAttribute("role")}}get ariaElement(){this.getConfig("element");const{_ariaElement:e}=this;return e.nodeType===Node.ELEMENT_NODE?e:x.getPath(this,e)}isCollapsified(e,t){const{collapsify:i}=this;let r=!t;return i==null?r=t?e:!e:i==="overlay"&&(r=t),Boolean(r)}async recompose(){const e=this,t={targetElement:e.element,domConfig:e.doCompose(),refOwner:e,callback:e.domSyncCallback,strict:!0};if(e.transitionRecompose){if(e.isTransitioningDom=!0,await b.transition(x.assign({element:e.element,action(){J.sync(t)}},e.transitionRecompose)),e.isDestroyed)return;e.isTransitioningDom=!1,e.trigger("transitionedRecompose")}else J.sync(t);t.changed&&(e.afterRecompose(),e.trigger("recompose")),e.recompose.resume()}changeElementRef(e){if(typeof e=="string"){const t=e;if(!(e=document.getElementById(t)))throw new Error(`No element found with id '${t}'`)}return e}changeAppendTo(e){return this.changeElementRef(e)}updateAppendTo(e){!this.isConfiguring&&e&&this.render()}changeInsertBefore(e){return this.changeElementRef(e)}updateInsertBefore(e){!this.isConfiguring&&e&&this.render()}changeInsertFirst(e){return this.changeElementRef(e)}updateInsertFirst(e){!this.isConfiguring&&e&&this.render()}getRenderContext(e=this,t){let i=t||e.appendTo,{insertFirst:r,insertBefore:n}=e;return r&&(i=r,n=i.firstChild),n&&(i||(i=n.parentElement)),[i,n||void 0]}render(e,t=!0){const i=this,{element:r}=i,[n,s]=i.getRenderContext(i,e);i.emptyCache(),i.syncElement&&i.currentElement?b.sync(r,i.currentElement):(n?.insertBefore(r,s),i.currentElement=r),k.fromElement(r.parentElement)&&r.classList.remove(...k.outerCls),super.render(n,t),i.rendered=!0,i.getConfig("role"),t&&(i.getConfig("contentRange"),i.triggerPaint()),i.setupFocusListeners()}template({tag:e,html:t,htmlCls:i,name:r}){var n;const s=this;typeof t=="string"&&eg.test(t)&&s.resolveCallback(t,s,!1)&&(t=s.callback(t,s,[s]));const l=(n=t)!==null&&n!==void 0&&n.call?t.call(s,s):t;return`<${e} class="${l?i:""}" ${r?`data-name="${r}"`:""}>${l||""}</${e}>`}updateRecomposeAsync(e){this.recompose.immediate=!e}onConfigChange({name:e}){var t;this._element&&!this.isDestroying&&(t=this.$meta.$renderConfigs)!==null&&t!==void 0&&t[e]&&this.recompose()}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.parent}getConfigValue(e,t){return e==="style"?this._style:super.getConfigValue(e,t)}getCurrentConfig(e){const t=super.getCurrentConfig(e);return e?.depth>0&&(t.type=this.type),t}get dataset(){return this.element.dataset}changeDataset(e){Object.assign(this.dataset,e)}get dragGhost(){return this.constructor._dragGhost||(this.constructor._dragGhost=b.createElement({html:"\xA0",style:"position:absolute;top:-10000em;left:-10000em"}))}updateParent(e){const{_element:t}=this;t&&t.classList[e?"remove":"add"](...k.outerCls)}get constrainTo(){var e;let t=this._constrainTo;if(t=t===void 0?globalThis:((e=t)===null||e===void 0?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE?t.host||t.ownerDocument:t,this.positioned){const{offsetParent:i}=this.element;if(i&&b.getStyleValue(i,"overflow")==="hidden")t=O.from(i).moveTo(0,0);else if(t&&!t.isRectangle){const r=t===document||t===globalThis;t=O.from(t,i),r&&t.translate(globalThis.pageXOffset,globalThis.pageYOffset)}}return t}updateCentered(e){const{element:t,_anchorElement:i}=this;if(e&&!this.floating&&!this.positioned)throw new Error("`centered` is only relevant when a Widget is `floating` or `positioned`");e?(t.classList.add("b-centered"),t.style.transform=t.style.left=t.style.top="",i?.classList.add("b-hide-display"),t.classList.remove("b-anchored")):t.classList.remove("b-centered")}get contentElement(){return this.element}get contentRange(){const e=this,{contentElement:t}=e,i=e._contentRange||(e._contentRange=new Range);return i.collapsed&&(i.setStart(t,e.contentRangeStartOffset||0),i.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),i}fixRefOwnerId(e,t,i){if(e.$refOwnerId===i){e.$refOwnerId=t;for(let{childNodes:r}=e,n=r.length;n-- >0;)this.fixRefOwnerId(r[n],t,i)}}get placement(){const e=this,{element:t}=e;let i,r,n;if(t!=null&&t.offsetParent&&!Kf.test(b.getStyleValue(t,"position"))){const l=t.nextElementSibling,o=t.previousElementSibling,a=!l&&o;if(r=b.getStyleValue(t.parentElement,"flex-direction"),r)r=r.startsWith("row")?"h":"v";else{var s;i=(s=l||o)===null||s===void 0?void 0:s.getBoundingClientRect(),n=i&&t.getBoundingClientRect(),r=i&&Math.abs(i.top-n.top)<Math.abs(i.left-n.left)?"h":"v"}r+=r==="h"?a?"r":"l":a?"b":"t"}return r}updateId(e,t){if(super.updateId(e,t),t){const{byRef:i,element:r}=this;for(const n in i)i[n].dataset&&(i[n].dataset.ownerCmp=e);r.id=e,this.fixRefOwnerId(r,e,t)}}get style(){const{element:e}=this;return e?.ownerDocument.defaultView.getComputedStyle(e)||this._style}updateStyle(e){this.element&&b.applyStyle(this.element,e)}updateTitle(e){this.titleElement&&(this.titleElement.innerHTML=e)}beforeAlignTo(e){}alignTo(e){var t;const i=this,{lastAlignSpec:r,element:n}=i,{offsetParent:s,style:l,classList:o}=n;if(r&&(r.monitorIntersection&&i.intersectionObserver.unobserve(r.target),isFinite(r.zone)&&n.classList.remove(da[r.zone])),!e){i.removeTransientListeners(),i.anchor=i.lastAlignSpec=null;return}i.beforeAlignTo(e),(e.nodeType===Element.ELEMENT_NODE||e.isWidget||e.$$name==="Point")&&(e={target:e}),i.releaseSizeConstraints();const{scrollable:a,constrainTo:d}=i,c=i.positioned&&b.getStyleValue(n,"position")!=="fixed",h=i.scale||1,g=e.target,f=g&&(g.isRectangle?g:g.element||g),m=O.from(n,c?s:null,!0),{width:p,height:v}=m,y=f&&f.nodeType===Element.ELEMENT_NODE;e=e.realignTarget?e:x.assign({aligningToElement:y,constrainTo:d,align:"b-t",axisLock:i.axisLock,anchor:i.anchor},i.align,e);const C=e.minWidth||i.minWidth,w=e.minHeight||i.minHeight;if(m.isAlignRectangle=!0,C&&(m.minWidth=C*h),w&&(m.minHeight=w*h),i.lastAlignSpec=e,y&&(i.lastAlignSpec.target=f),y&&Dt(f instanceof SVGElement?f.closest("svg"):f)){if(e=Object.setPrototypeOf({},e),e.target=i.lastAlignSpec.targetRect=e.realignTarget||(e.allowTargetOut?O.from(f,c?s:null,!c):b.isInView(f,!1,i)),!e.target){const j=i.hide();return i.isDestroyed||(i.lastAlignSpec.targetOutOfView=!0),j}e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1),i.lastAlignSpec.anchoredTo=f}e.anchor&&(e.anchorSize=i.anchorSize,n.contains(i.anchorPathElement)||n.appendChild(i.anchorElement)),i.isAligning=!0,i.trigger("beforeAlign",e),i.isAligning=!1,e.rtl=i.rtl,(e.align.includes("s")||e.align.includes("e"))&&(i.rtl?e.align=e.align.replace(/s/g,"r").replace(/e/g,"l"):e.align=e.align.replace(/s/g,"l").replace(/e/g,"r"));const S=m.alignTo(e);let{align:D,anchor:I,x:R,y:H,width:L,height:V,overlap:U}=S;if(i.lastAlignSpec.zone=S.zone,V!=v&&("configuredHeight"in i||(i.configuredHeight=l.height),i.height=V/h,i.alignConstrained=i.alignConstrained|1,a&&(a.overflowY=!0)),L!=p&&("configuredWidth"in i||(i.configuredWidth=l.width),i.width=L/h,i.alignConstrained=i.alignConstrained|2,a&&(a.overflowX=a.clientWidth>a.scrollWidth)),D&&i.alignConstrained){e.align=D;const j=O.from(n,c?s:null,!0).alignTo(e);I=j.anchor,R=j.x,H=j.y,L=j.width,V=j.height}if(i.centered||i.setXY(R,H),!S.overlap&&isFinite(S.zone)&&o.add(da[S.zone]),(t=I)!==null&&t!==void 0&&t.edge){var Y;const{edge:j}=I,{anchorElement:z}=i,Z=O.from(n),ne=[];j==="top"||j==="bottom"?(ne[0]=I.x,ne[1]=j==="top"?1:Z.height-1):(ne[0]=j==="left"?1:Z.width-1,ne[1]=I.y);let X=b.childFromPoint(n,...ne);if((Y=X)!==null&&Y!==void 0&&Y.matches(":hover,:focus")&&n.compareDocumentPosition(X)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(X=X.parentNode),X&&X!==document){let ie=b.getStyleValue(X,"background-color");for(;ie.match(as)&&b.getStyleValue(X,"position")!=="absolute"&&(X=X.parentNode,X!==document);)ie=b.getStyleValue(X,"background-color");ie.match(as)?i.anchorPathElement.setAttribute("fill",i.defaultAnchorBackgroundColor):i.anchorPathElement.setAttribute("fill",ie)}z.classList.remove("b-hide-display"),z.style.transform="",z.className=`b-anchor b-anchor-${j}`,I.x&&(I.x/=h),I.y&&(I.y/=h),b.setTranslateXY(z,I.x,I.y),o.add("b-anchored")}else i._anchorElement&&(i.anchorElement.classList.add("b-hide-display"),o.remove("b-anchored"));if(!y){l.pointerEvents="none";const j=b.elementFromPoint(R,H);i.owns(j)||(i.lastAlignSpec.anchoredTo=j),l.pointerEvents=""}if((i.scrollAction==="realign"&&y||i.scrollAction==="hide")&&!i.documentScrollListener&&(i.clearTimeout(i.scrollListenerTimeout),e.monitorTargetMutation&&!i.targetObserver&&(i.targetObserver||(i.targetObserver=new MutationObserver(i.onTargetParentMutation.bind(i)))).observe(b.getRootElement(f),{childList:!0,attributes:!0,subtree:!0}),i.scrollListenerTimeout=i.setTimeout(()=>{var j;const z=(j=f.getRootNode)===null||j===void 0?void 0:j.call(f);i.documentScrollListener=A.addListener(document,"scroll","doHideOrRealign",{capture:!0,thisObj:i}),z!=null&&z.mode&&(i.targetRootScrollListener=A.addListener(z,"scroll","doHideOrRealign",{capture:!0,thisObj:i}))},i.scrollAction==="hide"?i.ignoreScrollDuration:0)),y&&(e.monitorResize&&!i.targetResizeListener&&(Le.addResizeListener(f,i.onTargetResize),i.targetResizeListener=!0),e.monitorIntersection&&!(U||f.contains(n)||f.ownerSVGElement)&&i.intersectionObserver.observe(f)),!W.isAndroid&&!i.constrainListeners){const j=d!=null&&d.isRectangle?globalThis:d;i.clearTimeout(i.resizeListenerTimeout),i.resizeListenerTimeout=i.setTimeout(()=>{i.constrainListeners=!0,Le.addResizeListener(j||globalThis,i.onAlignConstraintChange)},i.ignoreScrollDuration)}}onTargetParentMutation(e){const{element:t,lastAlignSpec:i}=this;i!=null&&i.aligningToElement&&(si(i.target)?e.some(({target:r})=>r.contains(i.target)&&!t.contains(r))&&this.realign():this.hide())}get intersectionObserver(){return this._intersectionObserver||(this._intersectionObserver=new IntersectionObserver(this.onTargetIntersectionchange.bind(this),{root:W.isSafari?this.rootElement:this.rootElement.ownerDocument}))}onTargetIntersectionchange(e){if(!this.isDestroyed){const t=e[e.length-1];t.isIntersecting||this.onAlignTargetOutOfView(t.target)}}onTargetResize(){const{lastAlignSpec:e}=this;if(e){const{width:t,height:i}=e.targetRect,{width:r,height:n}=e.target.getBoundingClientRect();(r!==t||n!==i)&&this.onAlignConstraintChange(...arguments)}}onAlignTargetOutOfView(e){this.hide(),this.lastAlignSpec&&(this.lastAlignSpec.targetOutOfView=!0)}onAlignConstraintChange(e,t,{height:i}){const{style:r}=this.contentElement,{overflowY:n}=r;this.setTimeout(this.realign,50),t&&i>t.height&&(r.overflowY="hidden",this.requestAnimationFrame(()=>r.overflowY=n))}realign(){const e=this,{lastAlignSpec:t}=e;if((e.floating||e.positioned)&&t&&e.isVisible){if(t.aligningToElement){const i=t.target.contains(this.element),r=b.isInView(t.target,!1,e);if(!t.allowTargetOut&&(!Dt(t.target)||!r)){e.hide(),e.isDestroyed||(e.lastAlignSpec.targetOutOfView=!0);return}t.realignTarget=i?null:r}b.addTemporaryClass(e.element,"b-realigning",e.realignTimout,e),e.alignTo(t)}}rectangle(e,t,i){return this.rectangleOf("element",e,t,i)}rectangleOf(e,t,i,r){var n;return typeof t!="string"?(r=i,i=t,t=""):t==="border"&&(t=""),typeof i=="boolean"&&(r=i,i=void 0),e!=="element"&&i===void 0&&(i=this.element),i=(n=i)!==null&&n!==void 0&&n.isWidget?i.element:i,O[t||"from"](this[e],i,r)}releaseSizeConstraints(){const e=this,t=e.scrollable;e.alignConstrained&1&&(e.height=e.configuredHeight,t&&(t.overflowY=t.config.overflowY)),e.alignConstrained&2&&(e.width=e.configuredWidth,t&&(t.overflowX=t.config.overflowX)),e.alignConstrained=0}toFront(){const{element:e}=this,t=this.floating?this.floatRoot:this.positioned?e?.parentNode:null;if(e!=null&&e.nextSibling){const i=this._toFrontRange||(this._toFrontRange=document.createRange());i.setStartBefore(e.nextSibling),i.setEndAfter(t.lastElementChild),t.insertBefore(i.extractContents(),e)}}updateRef(e){this.element.dataset.ref=e}get overflowElement(){return this.contentElement}get maxHeightElement(){return this.element}changeAlign(e){return typeof e=="string"?{align:e}:e}changeScrollable(e,t){return typeof e=="boolean"&&(e={overflowX:e,overflowY:e}),e?(e.element=this.overflowElement,e.widget=this,e.isScroller||(e=t?t.setConfig(e):new this.scrollerClass(e)),e.syncOverflowState()):t?.destroy(),e}handleReactElement(e){const t=this.closest(i=>i.reactComponent);t!=null&&t.reactComponent&&t.reactComponent.processWidgetContent({reactElement:e,widget:this,reactComponent:t.reactComponent})}get html(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML}updateHtml(e){const t=this,i=e==null,{element:r,contentElement:n,htmlCls:s}=t;if(!r&&b.isReactElement(e)){t.whenVisible(()=>t.handleReactElement(e));return}if(r){t.updatingHtml=!0;const l=n===r&&t._anchorElement;s&&s.values.forEach(o=>r.classList[i?"remove":"add"](o)),l&&r.removeChild(l),e&&typeof e=="object"?b.isReactElement(e)?t.handleReactElement(e):J.sync({domConfig:F(F({},e),{},{onlyChildren:!0}),targetElement:t.contentElement}):t.contentElement.innerHTML=i?"":e,t.getConfig("htmlMutationObserver"),l&&r.appendChild(l),t.isComposable?t.recompose():(t.floating||t.positioned)&&(t.isAligning||t.realign())}}changeHtmlMutationObserver(e,t){const i=this,{contentElement:r}=i;if(t?.disconnect(r),e){const n=new MutationObserver(()=>{i.updatingHtml?i.updatingHtml=!1:i._html=r.innerHTML});return n.observe(r,e),n}}updateContent(e){const t=this,i=e==null,{element:r,htmlCls:n}=t;if(r){const{contentRange:s}=t;n&&n.values.forEach(l=>r.classList[i?"remove":"add"](l)),si(r)?(s.deleteContents(),i||s.insertNode(b.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=s.startOffset,t.contentRangeEndOffset=s.endOffset,(t.floating||t.positioned)&&!t.isAligning&&t.realign()}}onThemeChange(){var e;(e=this.anchorElement)!==null&&e!==void 0&&e.offsetParent&&(this._anchorSize=null,this.realign())}get anchorSize(){const e=this;let t=this._anchorSize;if(!t){const i=parseFloat(b.getStyleValue(e.element,"border-top-width")),r=b.getStyleValue(e.element,"border-top-color"),n=e.anchorElement,{className:s}=n,l=n.firstElementChild,o=e.anchorPathElement=l.lastElementChild,a=e._hidden;n.className="b-anchor b-anchor-top";let d=b.getStyleValue(e.contentElement,"background-color");d.match(as)&&(d=b.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=d,t=n.getBoundingClientRect();const[c,h]=t=e._anchorSize=[t.width,t.height];n.className=s,l.setAttribute("height",h+i),l.setAttribute("width",c),o.setAttribute("d",`M0,${h}L${c/2},0.5L${c},${h}`),i&&(o.setAttribute("stroke-width",i),o.setAttribute("stroke",r)),t[1]-=i,a&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=te.ion({theme:"onThemeChange",thisObj:e})),e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}return t}get anchorElement(){const e=this;if(!e._anchorElement){const t=e.floating,i=`${e.id}-shadow-filter`;e._anchorElement=b.createElement({parent:e.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[t?{tag:"defs",children:[{tag:"filter",id:i,children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:1,"flood-opacity":.2}]}]}:null,{tag:"path",[t?"filter":""]:`url(#${i})`}]}]})}return e._anchorElement}updateAnchor(e){this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")}updateDraggable(e){const t=this,{element:i}=t;if(e)t.dragEventDetacher=A.addListener({element:i,dragstart:"onWidgetDragStart",dragend:"onWidgetDragEnd",thisObj:t}),t.dragDetacher=A.on({element:i,mousedown(l){const{target:o}=l,a=k.fromElement(o);(!l.target.closest(".b-field-inner")&&a===this||this.strips&&Object.values(this.strips).includes(a))&&i.setAttribute("draggable","true")},thisObj:t});else{var r,n,s;(r=t.dragEventDetacher)===null||r===void 0||r.call(t),(n=t.dragOverEventDetacher)===null||n===void 0||n.call(t),(s=t.dragDetacher)===null||s===void 0||s.call(t)}}onWidgetDragStart(e){var t;const i=this;if(!i.validateDragStartEvent(e))return;const{element:r,align:n,constrainTo:s}=i,l=i.positioned&&b.getStyleValue(r,"position")!=="fixed",o=l?r.parentElement:i.rootElement,a=O.from(r,l?o:null),d=e.clientX,c=e.clientY,h=document.scrollingElement||document.body,[g,f]=l?b.getOffsetXY(r,o):i.getXY(),m=(t=l?O.content(o).moveTo(0,0):s&&(s!=null&&s.isRectangle?s:O.from(s)))===null||t===void 0?void 0:t.deflate(n.constrainPadding||0),p={element:o,dragover:v=>{r.classList.remove("b-centered"),a.moveTo(g+v.clientX-d-(l?0:h.scrollLeft),f+v.clientY-c-(l?0:h.scrollTop)),m&&a.constrainTo(m),b.setTranslateXY(r,a.x,a.y)}};W.isTouchDevice&&(p.touchmove=v=>v.preventDefault()),i.floatRoot.appendChild(i.dragGhost),i.setDragImage(e),e.dataTransfer.effectAllowed="none",i.dragOverEventDetacher=A.addListener(p),i.alignTo()}validateDragStartEvent(e){const t=this,{element:i}=t,r=b.elementFromPoint(e.clientX,e.clientY),{handleSelector:n}=t.draggable;if(n){var s;const l=(s=qf.exec(n))===null||s===void 0?void 0:s[1];if(l){if(r.closest(`#${i.id} ${l}`))return e.preventDefault(),!1}else if(!r.closest(`#${i.id} ${n}`))return e.preventDefault(),!1}return!0}setDragImage(e){e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(this.dragGhost,-9999,-9999))}setStyle(e,t){return b.applyStyle(this.element,x.isObject(e)?e:{[e]:t}),this}onWidgetDragEnd(){this.dragGhost.remove(),this.dragOverEventDetacher(),this.element.removeAttribute("draggable")}changeFloating(e){return Boolean(e)}changePositioned(e){return Boolean(e)}updatePositioned(e){this.element.classList[e?"add":"remove"]("b-positioned")}getXY(){return[b.getPageX(this.element),b.getPageY(this.element)]}setXY(e,t){const i=this,{element:r}=i;if(i.floating||i.positioned){if(e!=null&&(i._x=e),t!=null&&(i._y=t),b.getStyleValue(r,"position")==="fixed"){const n=r.getBoundingClientRect(),[s,l]=b.getTranslateXY(r),o=e-n.x,a=t-n.y;b.setTranslateXY(r,s+o,l+a)}else b.setTranslateXY(r,i._x||0,i._y||0);i.isConstructing?i.centered=!1:r.classList.remove("b-centered")}}get x(){return this.getXY()[0]}changeX(e){this.setXY(e)}get y(){return this.getXY()[1]}changeY(e){this.setXY(null,e)}get width(){const e=this,t=e.element;return e.monitorResize?(e._width==null&&(e._width=t.offsetWidth),e._width):t.offsetWidth}changeWidth(e){const t=this;b.setLength(t.element,"width",e),t._lastWidth=e,t._width=null,t._flex=null,t.element.style.flex=""}clearWidthCache(){this._width=null}get maxWidth(){return b.measureSize(this.element.style.maxWidth,this.element)}updateMaxWidth(e){b.setLength(this.element,"maxWidth",e)}get minWidth(){return b.measureSize(this.element.style.minWidth,this.element)}updateMinWidth(e){b.setLength(this.element,"minWidth",e)}updateFlex(e){this.getConfig("width"),(typeof e=="number"||!isNaN(e))&&(e=`${e} ${e}`),this.element.style.flex=e,this.element.style.width=""}updateAlignSelf(e){this.element.style.alignSelf=e}updateMargin(e){this.element.style.margin=this.parseTRBL(e).join(" ")}updateTextAlign(e,t){t&&this.element.classList.remove(`b-text-align-${t}`),this.element.classList.add(`b-text-align-${e}`)}updatePlaceholder(e){this.input&&(e==null?this.input.removeAttribute("placeholder"):this.input.placeholder=e)}get height(){const e=this,t=e.element;return e.monitorResize?(e._height==null&&(e._height=t.offsetHeight),e._height):t.offsetHeight}changeHeight(e){b.setLength(this.element,"height",e),this._lastHeight=e,this._height=null}get maxHeight(){return b.measureSize(this.maxHeightElement.style.maxHeight,this.element)}updateMaxHeight(e){b.setLength(this.maxHeightElement,"maxHeight",e)}get minHeight(){return b.measureSize(this.element.style.minHeight,this.element)}updateMinHeight(e){b.setLength(this.element,"minHeight",e)}updateDisabled(e=!1){const{element:t,focusElement:i,ariaElement:r}=this;this.trigger("beforeUpdateDisabled",{disabled:e}),!(e&&(this.revertFocus(),this._disabled!==e))&&(t&&(t.classList[e?"add":"remove"]("b-disabled"),i&&(i.disabled=e),r&&r.setAttribute("aria-disabled",e)),this.onDisabled(e))}onDisabled(e){}disable(){this.disabled=!0}enable(){this.disabled=!1}requestFullscreen(){const e=this,t=At.request(e.floating?e.floatRoot:e.element);return At.onFullscreenChange(e.onFullscreenChange),e.floating||(e.floatRoot._oldParent=e.floatRoot.parentElement,e.element.appendChild(e.floatRoot)),e.element.classList.add("b-fullscreen"),t}exitFullscreen(){return At.exit()}onFullscreenChange(){At.isFullscreen||this.onExitFullscreen()}onExitFullscreen(){var e;const t=this,i=(e=t._rootElement)===null||e===void 0?void 0:e.floatRoot;At.unFullscreenChange(t.onFullscreenChange),t.element.classList.remove("b-fullscreen"),t.element.contains(i)&&i!==null&&i!==void 0&&i._oldParent&&(i._oldParent.appendChild(i),i._oldParent=null)}get tooltip(){if(this._tooltip)return this._tooltip;{var e;const t=(e=k.Tooltip)===null||e===void 0?void 0:e.getSharedTooltip(this.rootElement);if(t&&t.activeTarget===this._element&&t.isVisible)return t}}changeTooltip(e,t){const i=this,{element:r}=i;if(e){if(!(i.preventTooltipOnTouch&&W.isTouchDevice)){if(!e.isTooltip&&e.constructor.name!=="Object"&&(e={html:typeof e=="string"?e:i.placeholder,textContent:!0}),!i.configureAriaDescription){var n;i.ariaDescription=(n=e.html)!==null&&n!==void 0&&n.match(kr)?e.html.replace(kr,Qf):e.html}if(t!=null&&t.isTooltip||e.newInstance)e.type="tooltip",e.forElement||(e.forElement=r),!("showOnHover"in e)&&!e.forSelector&&(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),e=k.reconfigure(t,e,i),i.detachListeners("tooltipValueListener"),i.configureAriaDescription||e.ion({name:"tooltipValueListener",innerHtmlUpdate:"onTooltipValueChange",thisObj:i});else{r.dataset.btip=!0,i.tipConfig=e;return}}}else if(t)if(e==null&&t.isTooltip)t.destroy();else{t.html=null;return}else delete r.dataset.btip;return e}onTooltipValueChange({value:e,source:t}){this.ariaDescription=typeof e=="string"?e:t.contentElement.innerText}get tooltipText(){const e=this._tooltip;if(e)return e.isTooltip?e.contentElement.innerText:typeof e=="string"?e:e.html;if(this.tipConfig)return this.tipConfig.html}get isVisible(){const e=this,{element:t}=e;let i;return Boolean(t&&!e._hidden&&!e.isDestroying&&si(t)&&(!e.requireSize||Dt(t))&&(!(i=e.containingWidget)||i.isVisible))}whenVisible(e,t=this,i,r=e){const n=this;n.isVisible&&n.isPainted?n.callback(e,t,i):(n.toCallWhenVisible||(n.toCallWhenVisible=new Map)).set(r,{callback:e,thisObj:t,args:i})}focus(){this.isFocusable&&b.focusWithoutScrolling(this.focusElement)}get focusElement(){}get isFocusable(){const e=!this.isDestroying&&this.isVisible&&!this.disabled&&this.focusElement;return e&&(e===document.body||e.offsetParent)}async show({align:e,animate:t=!0}={}){const i=this,{element:r,floating:n}=i,{style:s}=r,l=t&&i.showAnimation;let o,a,d=!i.isVisible;return d&&(d=i.trigger("beforeShow"),x.isPromise(d)&&(d=await d)),d!==!1&&(!i.internalBeforeShow||i.internalBeforeShow()!==!1)?new Promise(c=>{if(i.cancelHideShowAnimation(),i.updateCentered(i._centered),n){const h=i.floatRoot;h.contains(r)||(i.rendered?h.appendChild(i.element):i.render(h,!1)),s.transform.includes("scale")&&(i.scale=null,s.transform=s.transformOrigin="");const g=i.closest(Xf);if(g){const{scale:f}=g;i.scale=f,s.transform=`scale(${f})`,s.transformOrigin="0 0"}}if(i._hidden=!1,r.classList.remove("b-hidden"),n&&!Fs(r)&&(i.hide(!1),c()),i.onConfigChange({name:"hidden",value:!1,was:!0,config:i.$meta.configs.hidden}),l){o=Object.keys(l)[0],a=l[o];const h=i.currentAnimation={showing:!0,styleProp:o,resolve:c};i.isAnimating=!0,i.currentAnimation.detacher=A.onTransitionEnd({element:r,property:o,duration:aa(a.duration)+20,handler:()=>i.afterHideShowAnimate(h),thisObj:i}),s[o]=a.from,b.getStyleValue(r,o),s.transition=`${o} ${a.duration} ease ${a.delay}`,s[o]=a.to}i.afterShow(e,l?null:c)}):Promise.resolve()}async showBy(e,t,i){const r=this,n=Array.isArray(e);if(n||typeof e=="number"){const s=n?e:[e,t];e=Object.assign({target:new pt(s[0]+1,s[1]+1),matchSize:!1,align:"t0-b0"},n?t:i)}if(r.requireSize=!0,r.isVisible)b.addTemporaryClass(r.element,"b-realigning",300,r),r.alignTo(e);else return r.show({align:e})}async showByPoint(){return re.deprecate("Core","6.0.0","Widget.showByPoint() replaced by Widget.showBy() with the same signature"),this.showBy(...arguments)}afterShow(e,t){var i,r;const n=this;n.trigger("show"),n._configuredAnchorState=n.anchor,(i=n.owner)===null||i===void 0||(r=i.onChildShow)===null||r===void 0||r.call(i,n),n.triggerPaint(),(n.floating||n.positioned)&&(e?n.alignTo(e):n.centered?n.alignTo({target:n.constrainTo,align:"c-c"}):n.forElement&&n.alignTo(n.forElement)),t?.()}onChildHide(e){e.floating&&this.ariaElement.removeAttribute("aria-owns")}onChildShow(e){e.floating&&(this.ariaHasPopup=e.role,this.ariaElement.setAttribute("aria-owns",e.id))}triggerPaint(){const e=this,{element:t,toCallWhenVisible:i}=e,r=!e.isPainted;if(e.isVisible){if(r&&(e.getConfig("scrollable"),e.scaleToFitWidth&&!e.monitorResize&&(e.onParentElementResize=e.onParentElementResize.bind(e),Le.addResizeListener(t.parentElement,e.onParentElementResize),e.updateScale()),!e.hideBryntumDomMessage&&(e.isTaskBoardBase||e.isGridBase||e.isCalendar)&&t.insertBefore(new Comment("POWERED BY BRYNTUM (https://bryntum.com)"),t.firstChild)),e.eachWidget(Yf,!1),r&&(e.rootElement=b.getRootElement(t),e.getConfig("tooltip"),!k.Ripple&&k.RippleClass&&(k.Ripple=new k.RippleClass({rootElement:e.rootElement}))),e.isPainted=!0,r&&e.triggerConfigs("paint"),e.trigger("paint",{firstPaint:r}),i!=null&&i.size){for(const{callback:n,thisObj:s,args:l}of i.values())e.callback(n,s,l);i.clear()}r&&e.monitorResize&&!e.scaleToFitWidth&&Le.onElementResize([{target:t}])}}cancelHideShowAnimation(){const e=this,{currentAnimation:t,element:i}=e;t&&(e.isAnimating=!1,i.classList.contains("b-hiding")&&(i.classList.remove("b-hiding"),e._hidden=!1),t.detacher(),t.resolve(),i.style.transition=i.style[t.styleProp]="",e.currentAnimation=null,e.trigger(`${t.showing?"show":"hide"}AnimationEnd`))}afterHideShowAnimate(e){const t=this;e===t.currentAnimation&&(t.element.classList.remove("b-hiding"),t.cancelHideShowAnimation(),t._hidden&&t.afterHideAnimation())}suspendVisibility(){this._visibilitySuspended=(this._visibilitySuspended||0)+1,Object.defineProperty(this,"isVisible",Jf)}resumeVisibility(e=!0){--this._visibilitySuspended||(delete this.isVisible,e&&this.triggerPaint())}hide(e=!0){return new Promise(t=>{const i=this,{element:r,lastAlignSpec:n}=i,{style:s}=r,l=e&&i.hideAnimation;if(i.clearTimeout(i.scrollListenerTimeout),i.clearTimeout(i.resizeListenerTimeout),!i._hidden&&i.trigger("beforeHide",{animate:e})!==!1){if(i._hidden=!0,n&&(n.targetOutOfView=null,n.monitorIntersection&&(i.intersectionObserver.takeRecords(),i.intersectionObserver.unobserve(n.target))),i.onConfigChange({name:"hidden",value:!0,was:!1,config:i.$meta.configs.hidden}),!r){t();return}if(r.contains(b.getActiveElement(r))&&i.revertFocus(!0),i.isDestroyed){t();return}if(i.cancelHideShowAnimation(),l){const o=Object.keys(l)[0],a=l[o];if(Number(getComputedStyle(i.element)[o])!==a.to){const d=i.currentAnimation={hiding:!0,styleProp:o,resolve:t};r.classList.add("b-hiding"),i.isAnimating=!0,i.currentAnimation.detacher=A.onTransitionEnd({element:r,property:o,duration:aa(a.duration)+20,handler:()=>i.afterHideShowAnimate(d),thisObj:i}),s[o]=a.from,b.getStyleValue(r,o),s.transition=`${o} ${a.duration} ease ${a.delay}`,s[o]=a.to}else r.classList.add("b-hidden")}else r.classList.add("b-hidden");i.afterHide(!l&&t,l)}})}doHideOrRealign({target:e,isTrusted:t}){const i=this,{lastAlignSpec:r,element:n}=i,s=r?.anchoredTo,l=r?.target,o=r?.position,a=b.getActiveElement(i);if(!t||!Dt(n)||e&&(n.contains(e)||e.nodeType===Element.DOCUMENT_NODE&&n.contains(a)&&Uf[a]&&globalThis.innerHeight<document.body.offsetHeight))return;if(r.aligningToElement){const c=b.isInView(l,!1,i);if(c&&c.equals(r.targetRect))return}const d=i.scrollAction==="hide"&&i.getXY();if(i.realign(),!i.isDestroyed&&Fs(n)&&i.scrollAction==="hide"){const[c,h]=i.getXY();(c!==d[0]||h!==d[1]||l?.$$name==="Point"||o)&&(!s||!Dt(s)||e&&b.isDescendant(e,s))&&i.hide()}}afterHide(e=null,t=this.hideAnimation){var i,r;const n=this;n._anchor=n._configuredAnchorState,n.removeTransientListeners(),t||n.afterHideAnimation(),n.trigger("hide"),(i=n.owner)===null||i===void 0||(r=i.onChildHide)===null||r===void 0||r.call(i,n),e&&e()}removeTransientListeners(){var e,t;const i=this,{targetObserver:r,lastAlignSpec:n}=i;if(i.clearTimeout(i.resizeListenerTimeout),i.clearTimeout(i.scrollListenerTimeout),r&&(r.disconnect(),delete i.targetObserver),i.documentScrollListener=(e=i.documentScrollListener)===null||e===void 0?void 0:e.call(i),i.targetRootScrollListener=(t=i.targetRootScrollListener)===null||t===void 0?void 0:t.call(i),i.targetResizeListener&&(Le.removeResizeListener(n.target,i.onTargetResize),i.targetResizeListener=!1),i.constrainListeners){var s;const l=(s=n.constrainTo)!==null&&s!==void 0&&s.isRectangle?globalThis:n.constrainTo;Le.removeResizeListener(l||globalThis,i.onAlignConstraintChange),i.constrainListeners=!1}}afterHideAnimation(){const e=this,{element:t}=e;e.floating&&e.floatRoot.contains(t)?t.remove():t.classList.add("b-hidden"),e.defaultAnchorBackgroundColor&&e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}changeHidden(e){const t=this;let i;return t.isConfiguring?(i=Boolean(e),t.element.classList[e?"add":"remove"]("b-hidden")):(t.trigger("beforeChangeHidden",{hidden:e}),e?t.hide():t.show()),i}get assignedId(){return this.hasGeneratedId?null:this.id}get owner(){return this.parent||this._owner||this.containingWidget}get containingWidget(){let e=this.parent;if(!e){var t,i;const r=((t=this.forElement)===null||t===void 0?void 0:t.nodeType)===Element.ELEMENT_NODE?this.forElement:(i=this.element)===null||i===void 0?void 0:i.parentNode;e=r?.closest(".b-widget")&&k.fromElement(r)}return e}get previousSibling(){return this.getSibling(-1)}get nextSibling(){return this.getSibling(1)}getSibling(e){const t=this,{parent:i}=t,r=i?i.childItems:Array.from(t.element.parentElement.querySelectorAll(".b-widget"));return i?r[r.indexOf(t)+e]:k.fromElement(r[r.indexOf(t.element)+e])}up(e,t,i){var r;const{owner:n}=this;return e?n==null||(r=n.closest)===null||r===void 0?void 0:r.call(n,e,t,i):n}closest(e,t,i){const r=typeof i,n=r==="number",s=r==="string";for(let l=this,o=1;l;l=l.owner,o++){if(k.widgetMatches(l,e,t))return l;if(n&&o>=i)return;if(s&&k.widgetMatches(l,i,t))return;if(l===i)return}}owns(e){if(e){if("eventPhase"in e&&(e=e.target),e.nodeType===Element.ELEMENT_NODE){if(this.element.contains(e))return!0;e=k.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}eachAncestor(e){let t=this.owner;for(;t;){if(e(t)===!1)return!1;t=t.owner}return!0}changeMonitorResize(e,t){const i=this.scaleToFitWidth?!1:Boolean(e);if(i!==Boolean(t))return i}updateMonitorResize(e){const t=this;Qt.call(t,"onElementResize")||(t.onElementResize=t.onElementResize.bind(t)),Le[e?"addResizeListener":"removeResizeListener"](t.element,t.onElementResize)}changeReadOnly(e){if(e=Boolean(e),Boolean(this._readOnly)!==e)return e}updateReadOnly(e){var t;(t=this.element)===null||t===void 0||t.classList[e?"add":"remove"]("b-readonly"),this.isConfiguring||(this.eachWidget(i=>{i.ignoreParentReadOnly||("_originalReadOnly"in i||(i._originalReadOnly=i.config.readOnly||!1),i.readOnly=e||i._originalReadOnly)},!1),this.trigger("readOnly",{readOnly:e}))}eachWidget(e,t=!0){const i=this.childItems,r=i?.length||0,n={};for(let s=0;s<r;s++){const l=i[s];if(n.down=t,e(l,n)===!1||n.down&&l.eachWidget&&l.eachWidget(e,t)===!1)return!1}return!0}queryAll(e){const t=[];return this.eachWidget(i=>{e(i)&&t.push(i)}),t}query(e){let t=null;return this.eachWidget(i=>{if(e(i))return t=i,!1}),t}getWidgetByRef(e){var t,i;return e instanceof k?e:(this===null||this===void 0||(t=this.widgetMap)===null||t===void 0?void 0:t[e])||(this===null||this===void 0||(i=this.owner)===null||i===void 0?void 0:i.getWidgetByRef(e))}onFocusIn(e){const t=this,{element:i}=t;t.containsFocus=!0,t.focusInEvent=e,i.classList.add("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),i.contains(e._target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=A.on({element:i,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}onFocusOut(e){const t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!t.isVisible),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),t.trigger("focusout",e))}captureFocus(){const e=this,t=b.getActiveElement(e),i=e.contains(t)&&e.captureFocusItem(t);return(r,n)=>{i&&!e.isDestroying&&(b.getActiveElement(e)!==t||n)&&i(r)}}captureFocusItem(e){return(t=!0)=>{this.contains(e)&&(t?e.focus():b.focusWithoutScrolling(e))}}contains(e,t){const{element:i}=this;if(e&&i)return e.isWidget&&(e=e.element),i.contains(e)&&(!t||i!==e)}revertFocus(e){var t,i;const r=this,n=b.getActiveElement(r);let s=(t=r.focusInEvent)===null||t===void 0?void 0:t.relatedTarget;(e||r.containsFocus&&((i=s)===null||i===void 0?void 0:i.nodeType)===Element.ELEMENT_NODE&&r.element.contains(n))&&((!s||!b.isFocusable(s))&&(s=r.getFocusRevertTarget()),r._isRevertingFocus=!0,s&&b.isFocusable(s)?(s._isRevertingFocus=!0,b.focusWithoutScrolling(s),s._isRevertingFocus=!1):n?.blur(),r._isRevertingFocus=!1)}getFocusRevertTarget(){const e=this,{owner:t,focusInEvent:i}=e,r=i&&i.backwards?1:-1;let n=i&&i.relatedTarget;const s=n&&k.fromElement(n);if(t&&!t.isDestroyed&&(!n||!b.isFocusable(n)||s&&!s.isFocusable)){var l;if(n=null,t.eachWidget){const o=[];if(t.eachWidget(a=>{(a===e||a.isFocusable)&&o.push(a)},!1),o.length>1){const a=o.indexOf(e);n=o[a+r]||o[a-r]}}!n&&t.isFocusable&&(n=t),n=n?n.focusElement:(l=t.getFocusRevertTarget)===null||l===void 0?void 0:l.call(t)}return n}getStaticWidgetClasses(e,t){const i=new q,r=this.$meta.hierarchy;let n,s,l,o,a;for(s=r.indexOf(e);s<r.length;++s){var d;n=r[s],a=Reflect.getOwnPropertyDescriptor(n.prototype,"widgetClass"),(d=a)!==null&&d!==void 0&&d.get?o=a.get.call(this):(l=Qt.call(n,"$$name")||Qt.call(n,"$name")||Qt.call(n,"_$name")?n.$$name:n.name,(l.length<3||l.includes("$"))&&console.warn(`Class "${l}" extending "${n.$name}" should have "$name" static getter with no less than 3 chars.`),o=`b-${l.toLowerCase()}`),o&&i.add(t?o+t:o)}return i}get rootUiClass(){return k}get staticClassList(){const{$meta:e}=this;let t=e.staticClassList;return t||(e.staticClassList=t=this.getStaticWidgetClasses(k),W.isTouchDevice&&t.add("b-touch")),t}get uiClasses(){return this.getConfig("ui"),this._uiClasses}get uiClassList(){return this.getConfig("ui"),this._uiClassList}get widgetClassList(){const e=this,{cls:t,defaultCls:i,uiClasses:r}=e;let{staticClassList:n}=e;(i||t)&&(n=n.clone(),i&&n.assign(i),t&&n.assign(t));const s=n.values;return r&&s.push(...r),e.floating&&s.push("b-floating"),e.collapsify==="hide"&&s.push("b-collapsify-hide"),s}changeCls(e){return q.from(e)}changeContentElementCls(e){return q.from(e)}changeHtmlCls(e){return q.from(e)}changeDefaultCls(e){return q.from(e,!0)}changeUi(e){return q.from(e)}updateUi(e){var t;let i=null,r,n;if(e){const s=this.getStaticWidgetClasses(this.rootUiClass);for(n in e)if(e[n])for(r in s)s[r]&&((i||(i=new q))[`${r}-ui-${n}`]=1)}this._uiClasses=(t=i)===null||t===void 0?void 0:t.values,this._uiClassList=i}fromCache(e,t=!1,i=this.element){if(!i)return null;const r=this;return r.cache[e]||(r.cache[e]=t?b.children(i,e):b.down(i,e)),r.cache[e]}emptyCache(){this.cache={}}changeMasked(e,t){var i;if(((i=this.masked)===null||i===void 0?void 0:i.type)!=="trial"){if((e===!0||e==="")&&(e="\xA0"),t&&!t.isDestroyed)typeof e=="string"?(t.text=e,e=t):e?(t.setConfig(e),e=t):t.destroy();else if(e){const r=k.resolveType("mask");e=r.mergeConfigs(this.maskDefaults,e),e.owner=this,e=r.mask(e)}return e||null}}onMaskAutoClose(e){e.isDestroyed&&e===this.masked&&(this.masked=null)}mask(e){return this.masked=e,this.masked}unmask(){this.masked=null}onInternalResize(e,t,i,r,n){this._width=e.offsetWidth,this._height=e.offsetHeight}onElementResize(e,t){const i=this,{element:r}=i,n=i._width,s=i._height,l=r.offsetWidth,o=r.offsetHeight;i.floating&&t&&i.onFloatingWidgetResize(...arguments),!i.suspendResizeMonitor&&(n!==l||s!==o)&&(i.onInternalResize(r,l,o,n,s),i.trigger("resize",{width:l,height:o,oldWidth:n,oldHeight:s}))}onFloatingWidgetResize(e,t,i){const r=this,{lastAlignSpec:n,constrainTo:s}=r;if(r.isVisible&&n&&n.target){const l=!t||i.height!==t.height,o=!t||i.width!==t.width,a=s&&!O.from(s).contains(O.from(r.element,null,!0));(l&&n.zone!==2||o&&n.zone!==1||a)&&r.requestAnimationFrame(()=>r.realign())}}updateScale(){const e=this,t=e.element,i=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),t.style.display="none";const r=O.client(i),n=r.width/e.configuredWidth,s=e.scale=e.allowGrowWidth?Math.min(n,1):n;t.style.transform=`scale(${s})`,t.style.transformOrigin="top left",t.style.display="",e.allowGrowWidth&&n>1&&(e.width=e.configuredWidth*n)}onParentElementResize(e){this.updateScale()}parseTRBL(e,t="px"){if(e=e||0,typeof e=="number")return[`${e}${t}`,`${e}${t}`,`${e}${t}`,`${e}${t}`];const i=e.split(" "),r=i.length;return r===1?i[1]=i[2]=i[3]=i[0]:r===2?(i[2]=i[0],i[3]=i[1]):r===3&&(i[3]=i[1]),[isFinite(i[0])?`${i[0]}${t}`:i[0],isFinite(i[1])?`${i[1]}${t}`:i[2],isFinite(i[2])?`${i[2]}${t}`:i[3],isFinite(i[3])?`${i[3]}${t}`:i[4]]}get documentRoot(){var e;return((e=this.owner)===null||e===void 0?void 0:e.documentRoot)||this.element.getRootNode()}get rootElement(){const e=this;if(!e._rootElement){var t;let i=((t=e.owner)===null||t===void 0?void 0:t.rootElement)||b.getRootElement(e.forElement||(si(e.element)?e.element:e.getRenderContext()[0]||e.element));i||(i=document.body),e._rootElement=i}return e._rootElement}get floatRoot(){var e;const t=this,i=t.rootElement||((e=t.owner)===null||e===void 0?void 0:e.rootElement);let{floatRoot:r}=i;if(r)i.contains(r)||i.appendChild(r);else{var n;const{outerCls:s}=k,l=(n=b.getThemeInfo(null,i))===null||n===void 0?void 0:n.name;if(!b.isValidFloatRootParent(i))throw new Error("Attaching float root to wrong root");l&&s.push(`b-theme-${l.toLowerCase()}`),r=i.floatRoot=b.createElement({className:`b-float-root ${s.join(" ")}`,parent:i}),Ai.push(r),W.isAndroid&&(r.style.height=`${screen.height}px`,A.on({element:globalThis,orientationchange:()=>r.style.height=`${screen.height}px`,thisObj:this})),!W.isHoverableDevice&&globalThis.visualViewport&&A.on({element:globalThis.visualViewport,resize:({target:o})=>r.style.height=`${o.height}px`,thisObj:this}),te.ion({theme:({theme:o,prev:a})=>{r.classList.add(`b-theme-${o.toLowerCase()}`),r.classList.remove(`b-theme-${a.toLowerCase()}`)}})}return r}get floatRootMaxZIndex(){let e=1;return Array.from(this.floatRoot.children).forEach(t=>{const i=parseInt(getComputedStyle(t).zIndex||0,10);i>e&&(e=i)}),e}static resetFloatRootScroll(){Ai.forEach(e=>e.scrollTop=e.scrollLeft=0)}static get floatRoots(){return Ai}static removeFloatRoot(e){Ai.splice(Ai.indexOf(e),1)}static get outerCls(){const e=["b-outer"],{platform:t}=W;return t&&e.push(`b-${t}`),W.isTouchDevice&&e.push("b-touch-events"),b.scrollBarWidth?e.push("b-visible-scrollbar"):e.push("b-overlay-scrollbar"),W.isChrome?e.push("b-chrome"):W.isSafari?e.push("b-safari"):W.isFirefox&&e.push("b-firefox"),globalThis.ResizeObserver||e.push("b-no-resizeobserver"),e}get isAnimating(){return this._isAnimatingCounter>0}set isAnimating(e){const t=this,{_isAnimatingCounter:i}=t;t._isAnimatingCounter=Math.max(0,i+(e?1:-1)),i===0&&e?(t.element.classList.add("b-animating"),t.trigger("animationStart")):i===1&&!e&&(t.element.classList.remove("b-animating"),t.trigger("animationEnd"))}async waitForAnimations(){this.isAnimating&&await this.await("animationend",{checkLog:!1})}static query(e,t=!1){const{idMap:i}=k.identifiable;for(const r in i)if(k.widgetMatches(i[r],e,t))return i[r];return null}static queryAll(e,t=!1){const{idMap:i}=k.identifiable,r=[];for(const n in i)k.widgetMatches(i[n],e,t)&&r.push(i[n]);return r}static fromElement(e,t,i){const r=typeof t;e&&!e.nodeType&&(e=e.target),(r==="number"||t&&t.nodeType===Element.ELEMENT_NODE)&&(i=t,t=null);let n=e,s=0,l,o,a;for(typeof i!="number"&&(l=i,i=Number.MAX_VALUE),r==="string"&&(t=t.toLowerCase());n&&n.nodeType===Element.ELEMENT_NODE&&s<i&&n!==l;){if(o=n.dataset&&n.dataset.ownerCmp||n.id,o){if(a=k.getById(o),a)if(t){if(r==="function"){if(t(a))return a}else if(k.widgetMatches(a,t,!0))return a}else return a;s++}n=n.parentNode}return null}triggerFieldChange(e,t=!0){t&&this.trigger("change",e),this.eachAncestor(i=>{var r,n;if((r=i.onFieldChange)===null||r===void 0||r.call(i,e),(n=i.isolateFieldChange)!==null&&n!==void 0&&n.call(i,this))return!1})}isolateFieldChange(e){return this.isolateFields}setupFocusListeners(){te.setupFocusListenersOnce(this._rootElement,A)}static widgetMatches(e,t,i){return t==="*"?!0:typeof t=="function"?t(e):k.isType(e,t,i)}static attachTooltip(e,t){return typeof t=="string"&&(t={html:t}),k.create(Object.assign({forElement:e},t),"tooltip"),e}changeDock(e){return e==="start"?"left":e==="end"?"right":e}updateRtl(e){super.updateRtl(e),this.eachWidget(t=>{"rtl"in t.initialConfig||(t.rtl=e)})}}const tg=k.prototype;["compose","domSyncCallback"].forEach(u=>tg[u].$nullFn=!0);k.initClass();k.register("mask",Pe);b.Widget=k;te.Widget=k;Pe.identifiable.idMap=k.identifiable.idMap;Object.assign(globalThis.bryntum||(globalThis.bryntum={}),{get:k.getById.bind(k),query:k.query,queryAll:k.queryAll,fromElement:k.fromElement});k._$name="Widget";class vt extends $.mixin(Me,hi){get contentElement(){var e;return(e=this.owner)===null||e===void 0?void 0:e.contentElement}onChildAdd(e){}onChildRemove(e){}renderChildren(){const e=this,{owner:t,itemCls:i}=e,{contentElement:r,items:n}=t,s=t.itemCls,l=n?.length;if(l){t.textContent=!1;for(let o=0;o<l;o++){const a=n[o],{element:d}=a,{classList:c}=d;d.dataset.itemIndex=o,c.contains("b-outer")&&c.remove(...k.outerCls),i&&c.add(i),s&&c.add(s),a.render(r,Boolean(t.isPainted))}}e.syncPendingConfigs(),e.syncChildCount()}removeChild(e){const t=this,{element:i}=e,{owner:r,itemCls:n}=t,{contentElement:s}=r,l=r.itemCls;s.contains(i)&&i.remove(),delete i.dataset.itemIndex,n&&i.classList.remove(n),l&&i.classList.remove(l),t.fixChildIndices(),t.syncChildCount()}appendChild(e){const{element:t}=e,{owner:i,itemCls:r}=this,{contentElement:n}=i,s=i.itemCls;t.dataset.itemIndex=i.indexOfChild(e),i.textContent=!1,r&&t.classList.add(r),s&&t.classList.add(s),e.render(n,Boolean(i.isPainted)),this.syncChildCount()}insertChild(e,t){const i=this,{element:r}=e,{owner:n,itemCls:s}=i,{contentElement:l}=n,o=b.getChild(l,`[data-item-index="${t}"]`),a=n.itemCls;n.textContent=!1,s&&r.classList.add(s),a&&r.classList.add(a),l.insertBefore(r,o),e.render(null,Boolean(n.isPainted)),i.fixChildIndices(),i.syncChildCount()}fixChildIndices(){this.owner.items.forEach((e,t)=>{e.element.dataset.itemIndex=t})}syncChildCount(){var e;const{owner:t}=this,{length:i}=t.items;(e=t.contentElement)===null||e===void 0||e.classList[i===1?"add":"remove"]("b-single-child")}syncConfigLater(e){const t=this.pendingConfigs||(this.pendingConfigs=[]);t.includes(e)||t.push(e)}syncConfigStyle({name:e,style:t,classes:i,map:r}){const n=this,s=`b-box-${e}-`,{contentElement:l}=n,o=n[e];let a=r?.[o]||o;if(l){if(i){const{classList:d}=l;i.forEach(c=>{c!==a&&d.remove(s+c)}),i.includes(a)&&(d.add(s+a),a="")}l.style[t]=a}else n.syncConfigLater(e)}syncPendingConfigs(){const e=this,{pendingConfigs:t}=e;let i;if(t)for(e.pendingConfigs=null;i=t.pop();)e[e.$meta.configs[i].updater](e[i])}}T(vt,"type","default");T(vt,"configurable",{owner:null,containerCls:"b-auto-container",itemCls:null});T(vt,"factoryable",{defaultType:"default"});vt.initClass();vt._$name="Layout";let ua=0;const ig=u=>u.ripple;class Pd extends k{static get defaultConfig(){return{old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}static get $name(){return"Ripple"}afterConstruct(){super.afterConstruct(),A.on({element:this.rootElement,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}onRippleControllingEvent(e){var t;const i=this;i.show();const r=b.getStyleValue(i.circleElement,"animationName");i.hide(),(t=i.listenerDetacher)===null||t===void 0||t.call(i),r&&r!=="none"&&(i.listenerDetacher=A.on({mousedown:{element:i.rootElement,capture:!0,handler:"onMousedown"},touchstart:{element:i.rootElement,capture:!0,handler:"onTouchStart"},animationend:{element:i.circleElement,handler:"onAnimationEnd"},thisObj:i}),e.type==="mousedown"&&(i.onMousedown(e),te.ion({theme:"onRippleControllingEvent",thisObj:this})))}onTouchStart(e){ua=performance.now(),this.handleTriggerEvent(e)}onMousedown(e){performance.now()-ua>200&&this.handleTriggerEvent(e)}handleTriggerEvent(e){const t=k.fromElement(e.target,ig);if(t){const i=t.ripple,r=i.delegate?e.target.closest(i.delegate):t.focusElement||t.element;if(r){const n=x.assign({event:e,target:r,radius:this.radius},i);if(typeof n.clip=="string"&&(n.clip=t[n.clip]||e.target.closest(n.clip),!n.clip))return;this.ripple(n)}}}ripple({event:e,point:t=A.getClientPoint(e),target:i=e.target,clip:r=i,radius:n=this.radius,color:s=this.color}){this.clip=r,r=O.from(r,null,!0);const l=this,o=r.getDelta(t),a=l.rippleElement.style,d=l.circleElement,c=b.getStyleValue(i,"border-radius");l.hide(),a.transform=`translateX(${o[0]}px) translateY(${o[1]}px)`,a.height=a.width=`${n}px`,l.element.style.borderRadius=c,d.setAttribute("r",n),d.setAttribute("fill",s),l.showBy({target:r,align:"c-c",matchSize:!0})}onAnimationEnd(e){e.animationName==="b-ripple-expand"&&this.hide()}}k.RippleClass=Pd;Pd._$name="Ripple";const rg=Object.freeze({}),{isArray:Zt}=Array,ng=u=>u.weight,ha=({weight:u},{weight:e})=>typeof u=="string"||typeof e=="string"?String(u).localeCompare(String(e)):(u??Number.MAX_SAFE_INTEGER)-(e??Number.MAX_SAFE_INTEGER),fa=u=>u&&!u.hidden,sg=["display","flex-direction"],lg={default:1,box:1};class Je extends k{static get $name(){return"Container"}static get type(){return"container"}static get configurable(){return{items:null,lazyItems:{$config:["lazy"],value:null},defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:{type:"default"},namedItems:null,overflowable:{value:null,default:!1,$config:null},textContent:!0,record:null,autoUpdateRecord:null,autoUpdateFields:null,hideWhenEmpty:null,contentElMutationObserver:{$config:["lazy","nullify"],value:!0},isolateFields:!1,focusDescendant:!1,defaultBindProperty:null,defaultFocus:null}}static get prototypeProperties(){return{flexRowCls:"b-flex-row",flexColCls:"b-flex-column",initialItems:!0}}startConfigure(e){const t=e.items||e.lazyItems;(this.hasItems=Boolean(t&&(Zt(t)?t:Object.keys(t)).length))||(this.initialItems=!1),super.startConfigure(e)}get firstItem(){return this.getAt(0)}get lastItem(){return this.getAt(-1)}getAt(e){return this.ensureItems().at(e)}remove(...e){let t=!0;e.length===1&&(Zt(e[0])?e=e[0]:t=!1);const i=this,{_items:r}=i,n=[];for(let s=0;s<e.length;s++){const l=e[s];r.includes(l)&&(r.remove(l),i.layout.removeChild(l),n.push(l),i.onChildRemove(l))}return t?n:n[0]}removeAll(){return this.remove(this.items)}add(...e){const t=this,i=t.ensureItems(),r=[];let n=!0,s,l,o;for(e.length===1&&(Zt(e[0])?e=e[0]:n=!1),l=0;l<e.length;l++){var a;s=e[l],s.isWidget?s.parent=t:s=t.createWidget(s),((a=s)===null||a===void 0?void 0:a.weight)!=null?(o=B.findInsertionIndex(s,i.values,ha),r.push(t.insert(s,o))):s&&(i.includes(s)||(i.add(s),t.onChildAdd(s),t.layout.appendChild(s),r.push(s)))}return n?r:r[0]}ensureItems(){const e=this;return e.getConfig("items"),e.getConfig("lazyItems"),e._items||(e.items=[]),e._items}insert(e,t){const i=this,r=i.ensureItems();e instanceof k?e.parent=i:e=i.createWidget(e),r.includes(t)&&(t=i.indexOfChild(t)),t=Math.min(t,r.count);const n=r.values;return n.splice(t,0,e),r.values=n,i.onChildAdd(e),i.layout.insertChild(e,t),e}indexOfChild(e){return this.items.indexOf(e)}changeLazyItems(e){this.items=e,this.layout.renderChildren()}changeItems(e,t){const i=this,r=[],n=new Jr;return Zt(e)?i.processItemsArray(e,r):e&&i.processItemsObject(e,i.namedItems,r),r.some(ng)&&r.sort(ha),n.add(r),t&&t.forEach(s=>{i.remove(s),!n.includes(s)&&s._createdBy===i&&s.destroy()}),n}afterConstruct(){const{rtl:e}=this,{classList:t}=this.contentElement;t.toggle("b-rtl",e===!0),t.toggle("b-ltr",e===!1)}updateRtl(e){super.updateRtl(e);const{contentElement:t}=this;t&&(t.classList.toggle("b-rtl",e===!0),t.classList.toggle("b-ltr",e===!1))}updateItems(e,t){let i=0;e.forEach(r=>{this.onChildAdd(r),t&&!t.temporary&&this.layout.insertChild(r,i),++i}),this.initialItems=!1}updateHideWhenEmpty(){this.syncChildCount(this.rendered)}get items(){const e=this;if(e.getConfig("lazyItems"),!e._items){if(e.initializingItems)return[];e._items=new Jr,e._items.temporary=!0}return e._items.values}processItemsArray(e,t){const i=e.length;let r,n;for(r=0;r<i;r++)n=e[r],n instanceof k?(n.parent=this,n.element.classList.remove(...k.outerCls)):n=this.createWidget(n),n&&((n.ref||n.id)&&this.addDescendant(n),t.push(n))}processItemsObject(e,t,i){let r,n;for(n in e)r=e[n],r&&(t&&n in t&&(r=typeof r=="object"?x.merge(x.clone(t[n]),r):t[n]),r&&(r instanceof k?r.parent=this:(r instanceof Object&&(r.ref=n),r=this.createWidget(r)),r&&(r.ref=n,this.addDescendant(r),i.push(r))))}onChildAdd(e){if(e.innerItem&&this.readOnly&&!e.ignoreParentReadOnly&&(e.readOnly=!0),this.onChildAddLayout(e),e.ref||e.id)for(let t=this;t;t=t.parent)t.addDescendant(e);this.syncChildCount(!0)}onChildAddLayout(e){e.innerItem&&this.layout.onChildAdd(e)}onChildHide(e){var t;super.onChildHide(e),(t=this._items)!==null&&t!==void 0&&t.includes(e)&&this.syncChildCount(!0)}onChildShow(e){var t;super.onChildShow(e),(t=this._items)!==null&&t!==void 0&&t.includes(e)&&this.syncChildCount(!0)}syncChildCount(e){if(!this.isConfiguring){const t=this,{items:i,hasItems:r}=t,n=i.filter(fa),{length:s}=n;if(t.visibleChildCount=s,t.hideWhenEmpty&&e){const l=Boolean(!s);Boolean(t._hidden)!==l&&(t.hidden=l)}i.forEach(l=>l.element.classList.remove("b-last-visible-child","b-first-visible-child")),s&&(n[0].element.classList.add("b-first-visible-child"),n[s-1].element.classList.add("b-last-visible-child")),t.hasItems=Boolean(t.childItems.length),t.contentElement.classList[s?"remove":"add"]("b-no-visible-children"),t.isComposable?r!==t.hasItems&&t.recompose():t.updateTextContent(t._textContent)}}syncFlexDirection(){const e=this,{contentElement:t,flexColCls:i,flexRowCls:r}=e,n=new q(t.className),s=b.getStyleValue(t,sg);n[r]=n[i]=0,s.display==="flex"&&(n[s["flex-direction"]==="row"?r:i]=1),b.syncClassList(t,n)}addDescendant(e){const t=e.ref||e.id,i=this._widgetMap||(this._widgetMap={});i[t]||(i[t]=e)}onChildRemove(e){const t=this,i=e.ref||e.id;if(i)for(let r=t;r;r=r.parent)r.widgetMap[i]===e&&delete r.widgetMap[i];t.layout.onChildRemove(e),t.syncChildCount(!0)}get widgetMap(){return this._widgetMap||(this._widgetMap={}),this.initializingItems||this.getConfig("items"),this._widgetMap}changeRecord(e){return this._record=e==null?rg:null,e}updateRecord(e){var t;const i=this;(t=i.recordUpdateDetacher)===null||t===void 0||t.call(i),i.trigger("beforeSetRecord",{record:e}),i.setValues(e,{onlyName:!0,highlight:Boolean(i.$highlight)}),i.autoUpdateFields&&e!==null&&e!==void 0&&e.firstStore&&(i.recordUpdateDetacher=e.firstStore.ion({update:i.onRecordUpdated,thisObj:i}))}setRecord(e,t){this.$highlight=t,this.record=e,this.$highlight=!1}onRecordUpdated({record:e}){e===this.record&&this.setValues(this.record,!0,!0)}onFieldChange({source:e,userAction:t}){if(this.autoUpdateRecord&&t){const{record:i}=this,{name:r,isValid:n=!0,value:s}=e;i&&r&&n&&(i[r]=s)}}getValues(e){const t={};return this.eachWidget((i,r)=>{i.isolateFields?r.down=!1:"name"in i&&(!e||e(i))&&(t[i.name]=i.value)},!0),t}get hasNoChildren(){const e=this,{items:t,lazyItems:i}=e.initialConfig,r=t&&(Zt(t)?t:x.values(t)),n=i&&(Zt(i)?i:x.values(i)),s=e.isConfiguring?n||r:e.items;return!(s!=null&&s.filter(fa).length)}afterRecompose(){super.afterRecompose(),this.realign()}updateTextContent(e){const t=this;if(!t.isComposable){const i=Boolean(e&&t.hasNoChildren),{classList:r}=t.contentElement;i!==r.contains("b-text-content")&&(r[i?"add":"remove"]("b-text-content"),t.rendered&&t.realign())}}updateLayoutStyle(e){b.applyStyle(this.contentElement,e)}updateElement(e){if(super.updateElement(...arguments),e){const{classList:t}=this.contentElement,{containerCls:i}=this.layout;t.add("b-content-element"),i&&t.add(i)}}onPaint(){var e;(e=super.onPaint)===null||e===void 0||e.call(this,...arguments),this.getConfig("contentElMutationObserver")}changeContentElMutationObserver(e,t){if(t&&(t.takeRecords(),t.disconnect()),e){const i=this,{element:r,contentElement:n}=i;e=new MutationObserver(s=>i.onContentElMutation(s)),e.observe(n,{attributes:!0}),n!==r&&e.observe(r,{attributes:!0}),i.syncFlexDirection()}return e}onContentElMutation(){lg[this.layout.type]&&this.isVisible&&this.syncFlexDirection()}changeLayout(e,t){return vt.reconfigure(t,e,{owner:this,defaults:{owner:this}})}get childItems(){return this.items}getWidgetById(e){return this.widgetMap[e]}processWidgetConfig(e){}setupWidgetConfig(e,t){const i=this;typeof e=="string"?e={html:e}:e.nodeType===Element.ELEMENT_NODE&&(e={element:e,id:e.id}),(typeof t=="string"||!t&&(t=e.type))&&(t=k.resolveType(t,!0)),e=(t||k).mergeConfigs(i.defaults,e,{parent:i});for(let r=e.parent;r;r=r.parent)if(r.processWidgetConfig(e)===!1)return null;return i.trigger("beforeWidgetCreate",{widgetConfig:e})===!1?null:e}createWidget(e){const t=k.create(this.setupWidgetConfig(e),this.defaultType);return t&&(t._createdBy=this),t}updateDefaults(e,t){if(!this.isConfiguring&&e){const i=Object.entries(e);this.eachWidget(r=>{i.forEach(([n,s])=>{(!t||r[n]===t[n])&&(r[n]=s)})},!1)}}render(){this.getConfig("lazyItems"),this.layout.renderChildren(),this.syncChildCount(),super.render(...arguments)}get focusElement(){const e=this.query(this.defaultFocus||(t=>{var i;return t.isFocusable&&t.ref!=="close"&&!((i=t.ref)!==null&&i!==void 0&&i.endsWith("collapse"))}));return e?e.focusElement:super.focusElement}doDestroy(){var e;(e=this._items)===null||e===void 0||e.forEach(t=>{var i;return(i=t.destroy)===null||i===void 0?void 0:i.call(t)}),this.layout.destroy(),super.doDestroy()}get isValid(){let e=!0;return this.eachWidget(t=>{t.isVisible&&"isValid"in t&&!t.isValid&&(e=!1)},!0),e}get values(){const e={};return this.gatherValue(e),e}set values(e){this.assignValue(e)}get isSettingValues(){return Boolean(this.assigningValues)}get assigningValues(){var e;return this._assigningValues||((e=this.parent)===null||e===void 0?void 0:e.assigningValues)}set assigningValues(e){this._assigningValues=e}assignValue(e,t){super.assignValue(e,t),this.isolateFields||this.setValues(e,t)}gatherValue(e){super.gatherValue(e),this.isolateFields||this.gatherValues(e)}setValues(e,t){t=t||this.assignValueDefaults,this.assigningValues=t,this.eachWidget(i=>i.assignValue(e,t),!1),this.assigningValues=!1}}Je.initClass();Je._$name="Container";const{assign:zi}=x,ga=()=>performance.now(),og={start:!1},ag=/^[.\d]+([^\d].*)?$/,Od=u=>{const e=u.$bryntum||(u.$bryntum={});return e.transitions||(e.transitions=Object.create(null))},ma=(u,e)=>{if(typeof u=="string"){var t;e=(t=ag.exec(u))===null||t===void 0?void 0:t[1],u=parseFloat(u)}return u&&u*(e==="s"||!e&&u<10?1e3:1)},Ps=u=>{const e=x.values(Od(u)).filter(t=>t.completed==null).map(t=>t.toString());u.style.transition=e.join(", ")},Ad=u=>class extends u{static get prototypeProperties(){return{_delay:null,_duration:null,_retain:null,_timing:null,_unit:null,owner:null,reverting:null}}constructor(...t){super(...t),this.id=++dg}start(){this.startTime=ga()}get delay(){var t,i,r;return ma((t=(i=this._delay)!==null&&i!==void 0?i:(r=this.owner)===null||r===void 0?void 0:r.delay)!==null&&t!==void 0?t:0,this.unit)}set delay(t){this._delay=t}get duration(){var t;const{owner:i,unit:r}=this;return ma((t=this._duration)!==null&&t!==void 0?t:i?i.duration:he.defaultDuration,r)}set duration(t){this._duration=t}get elapsed(){return ga()-this.startTime}get remaining(){return this.duration-this.elapsed}get retain(){var t,i;return(t=this._retain)!==null&&t!==void 0?t:(i=this.owner)===null||i===void 0?void 0:i.retain}set retain(t){this._retain=t}get timing(){var t,i;return(t=this._timing)!==null&&t!==void 0?t:(i=this.owner)===null||i===void 0?void 0:i.timing}set timing(t){this._timing=t}get unit(){var t,i;return(t=this._unit)!==null&&t!==void 0?t:(i=this.owner)===null||i===void 0?void 0:i.unit}set unit(t){this._unit=t}};let dg=0;class rr extends $.mixin(Ad){static get $name(){return"AnimatorTransition"}static get prototypeProperties(){return{element:null,property:null,from:null,to:null,completed:null,promissory:null,reverting:null}}afterConstruct(){super.afterConstruct();const e=this,{element:t,transitions:i}=e;let{property:r}=e;[r,e.to]=b.unitize(r,e.to),e.from=b.unitize(r,e.from)[1],e.promissory=new js,e.property=r;const n=i[r];i[r]=e;let{from:s}=e;n&&(e.from=n.to,s=null,n.destroy()),s===null&&(s=e.getCurrentStyleValue(),n||(e.from=s)),t.style[r]=s,e.getCurrentStyleValue()}doDestroy(){const e=this;e.finish(!1),e.completed&&!e.retain&&e.clearStyle(),super.doDestroy()}get promise(){var e;return(e=this.promissory)===null||e===void 0?void 0:e.promise}get transitions(){return Od(this.element)}clearStyle(){this.setStyle("")}finish(e){const t=this,{transitions:i,promissory:r,property:n}=t;r&&(t.completed=e,t.promissory=null,r.resolve(e),i[n]===t?(delete i[n],e||(Ps(t.element),t.clearStyle())):t.completed=!1)}getCurrentStyleValue(){return b.getStyleValue(this.element,this.property)}revert(){const{duration:e,elapsed:t,element:i,from:r,property:n,_retain:s,_timing:l}=this;return new rr({element:i,property:n,retain:s,timing:l,duration:Math.round(Math.min(e,t)),reverting:this,to:r,unit:"ms"})}setStyle(e){this.element.style[this.property]=e}start(){const e=this,{delay:t,duration:i,element:r,property:n}=e;A.onTransitionEnd({element:r,property:n,duration:t+i+20,thisObj:e.owner,handler:()=>{var s;return(s=e.finish)===null||s===void 0?void 0:s.call(e,!0)}}),super.start(),e.setStyle(e.to)}toString(){const{delay:e,duration:t,property:i,timing:r}=this;return`${i} ${t}ms ${r||"ease-in-out"}${e?` ${e}ms`:""}`}}rr.initClass();class he extends $.mixin(Ad){static get $name(){return"Animator"}static get prototypeProperties(){return{element:null,finalize:null,prefinalize:null,completed:null,items:null}}static register(e,t){if(x.isObject(e)){x.entries(e).forEach(i=>he.register(...i));return}he.fx[e]=t,he[e]=i=>(b.isElement(i)?i={element:i,[e]:{}}:(i={element:i.element,[e]:i},delete i[e].element),he.run(i))}static run(e){return new he(e).start()}constructor(e){var t;super(null);const i=this,r=[],n={};let s,l,o,a;if(Array.isArray(e))i.items=e;else for(o in e)(he.specialPropsRe.test(o)?i:n)[o]=e[o];x.keys(n).forEach(d=>{a=n[d],a!=null&&a!==!1&&a===a&&((l=he.fx[d])?(a=zi(i.defaults,l(a,i,d)),a.owner=i,s=new he(a)):(a=zi(i.defaults,typeof a=="object"?a:{to:a}),a.owner=i,a.property=d,s=new rr(a)),r.push(s))}),(t=i.items)===null||t===void 0||t.forEach(d=>{x.isInstantiated(d)?d.owner=i:(d=zi(i.defaults,d),d.owner=i,d=new he(d)),r.push(d)}),i.items=r,i.promise=(r.length===1?r[0].promise:Promise.all(r.map(d=>d.promise))).then(d=>{var c;return(c=i.finish)===null||c===void 0||c.call(i,d),i.completed||!1})}doDestroy(){this.items.forEach(e=>e.destroy()),super.doDestroy()}get defaults(){return{element:this.element}}get retain(){const{_retain:e,finalize:t,owner:i}=this;return e??(t?!1:i?i.retain:!0)}set retain(e){super.retain=e}done(){return this.promise}finish(e){var t,i;const r=this,{items:n}=r;for(Ps(r.element),r.completed=typeof e=="boolean"?e:!e.some(s=>!s),(t=r.prefinalize)===null||t===void 0||t.call(r,r.completed,r);n.length;)n.pop().destroy();(i=r.finalize)===null||i===void 0||i.call(r,r.completed,r)}revert(e){var t;const i=this,{reverting:r}=i,n=!e||((t=e.start)!==null&&t!==void 0?t:!0);let s=i.defaults;return r&&(r.finalize&&(s.finalize=r.finalize),r.prefinalize&&(s.prefinalize=r.prefinalize),s.retain=r._retain),s=zi(s,e,{items:i.items.map(l=>l.revert(og)),reverting:i}),s=new he(s),n&&s.start(),s}start(){const{element:e,items:t}=this;return super.start(),t.length&&(Ps(e),t.forEach(i=>i.start())),this}}he.initClass().Transition=rr;he.specialPropsRe=new RegExp(`^(?:${Object.keys(he.prototypeProperties).concat(Object.keys(he.superclass.prototypeProperties)).map(u=>u[0]==="_"?u.substr(1):u).join("|")})$`);he.defaultDuration=200;he.fx={};he.register({puff(u){return u===!0?u={}:typeof u!="object"?u={transform:`scale(${u})`}:u.scale&&(u=x.clone(u),u.transform=`scale(${u.scale})`,delete u.scale),zi({opacity:0,transform:"scale(8)"},u)}});he._$name="Animator";class Gs extends $.mixin(Se){static get configurable(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3,pressedCls:"b-pressed"}}doDestroy(){var e;(e=this.mousedownRemover)===null||e===void 0||e.call(this),this.cancel(),super.doDestroy()}cancel(){var e,t,i;const r=this;(e=r.activeElement)===null||e===void 0||e.classList.remove(r.pressedCls),r.activeElement=null,(t=r.acceleration)===null||t===void 0||t.cancel(),r.activeListenerRemover=(i=r.activeListenerRemover)===null||i===void 0?void 0:i.call(r),r.clearTimeout(r.autoRepeatTimer),r.clearTimeout(r.repeatTimer)}updateElement(e){var t;(t=this.mousedownRemover)===null||t===void 0||t.call(this),this.mousedownRemover=A.on({element:e,mousedown:"onMouseDown",thisObj:this})}onMouseDown(e){const t=this,i=t.delegate?e.target.closest(t.delegate):t.element;t.cancel(),i&&(t.activeElement=i,t.triggerEvent=e,i.classList.add(t.pressedCls),t.activeListenerRemover=A.on({mouseup:{element:document,capture:!0,handler:"onMouseUp"},mousemove:{element:i,handler:"onTargetMouseMove"},mouseleave:{element:i,handler:"onTargetMouseLeave"},mouseenter:{element:i,handler:"onTargetMouseEnter"},thisObj:t}),t.autoRepeatTimer=t.setTimeout("startAutoRepeat",t.delay))}onMouseUp(){this.cancel()}onTargetMouseLeave(){this.activeElement.classList.remove(this.pressedCls),this.clearTimeout(this.repeatTimer)}onTargetMouseEnter(e){const t=this;e.buttons?(t.activeElement.classList.add(t.pressedCls),t.triggerEvent=e,t.fireClick()):t.cancel()}onTargetMouseMove(e){this.triggerEvent=e}startAutoRepeat(){const e=this;e.interval=e.startInterval=1e3/e.startRate,e.accelerationDelta=e.startInterval-1e3/e.endRate,e.fireClick(),e.acceleration=pe.animate(e.accelerateDuration,e.nextTick,e,"easeOutQuad")}nextTick(e){this.interval=this.startInterval-this.accelerationDelta*e}fireClick(){const e=this,t=new MouseEvent("click",e.triggerEvent);e.triggerEvent.target.dispatchEvent(t),e.repeatTimer=e.setTimeout(e.fireClick,e.interval)}}Gs._$name="ClickRepeater";const cg=/^(?:undefined|null|LEFT|RIGHT)$/,ug={TOP:"BOTTOM",RIGHT:"LEFT",BOTTOM:"TOP",LEFT:"RIGHT"},$d=u=>{const e=u?.toUpperCase();return[e,e==="LEFT"||e==="RIGHT"]};var Us=u=>class extends(u||$){static get $name(){return"Rotatable"}static get configurable(){return{rotate:null,invertRotate:null}}compose(){const{rotate:t}=this;return{class:{[`b-rotate-${(t||"").toLowerCase()}`]:t,"b-rotate-vertical":t}}}syncRotationToDock(t){if(cg.test(String(this.rotate))){const[i,r]=$d(t);this.rotate=r?this.invertRotate?ug[i]:i:null}}get widgetClass(){return null}};class fi extends k.mixin(Us){compose(){const{align:e,href:t}=this;return{tag:t!=null?"a":"button",class:{[`b-align-${e||"end"}`]:1,"b-icon":1},listeners:{click:"onInternalClick"}}}get focusElement(){return this.element}get panel(){var e,t;if((e=this.parent)!==null&&e!==void 0&&e.isPanel&&(t=this.element)!==null&&t!==void 0&&t.parentNode.matches(".b-panel-header"))return this.parent}changeAlign(e){return e}onInternalClick(e){const t=this,{handler:i,panel:r}=t,n={domEvent:e,tool:t};t.disabled||(t.trigger("click",n),t.isDestroyed||(t.trigger("action",n),!t.isDestroyed&&r?.trigger("toolClick",n)!==!1&&i&&t.callback(i,r,[e,r,t])))}onInternalKeyDown(e){(e.key.trim()||e.code)==="Enter"&&(e.cancelBubble=!0,e.stopPropagation())}updateDisabled(e,t){var i;super.updateDisabled(e,t),e&&((i=this.repeat)===null||i===void 0||i.cancel())}changeRepeat(e,t){return t?.destroy(),e&&Gs.new({element:this.element},e)}}T(fi,"$name","Tool");T(fi,"type","tool");T(fi,"configurable",{align:{value:null,$config:{merge:"replace"}},href:null,repeat:null,defaultBindProperty:null});fi.initClass();fi._$name="Tool";const hg=/right/i,fg=u=>(u.collapsed||u.collapsing)&&u.owner.expandedHeaderDock==="top"&&u.owner.collapsible.direction.match(hg)?"start":"end";class _d extends fi{static get $name(){return"CollapseTool"}static get type(){return"collapsetool"}static get configurable(){return{autoAlign:!0,collapsed:null,collapsing:null,collapsify:!1,direction:"up",defaultBindProperty:null}}compose(){const{collapsed:e,direction:t}=this;return{class:{[`b-icon-collapse-${t}`]:1,"b-collapsed":e}}}changeAutoAlign(e){return e===!0?fg:e}syncAutoAlign(){const{autoAlign:e}=this;e&&(this.align=e(this))}updateAutoAlign(){this.syncAutoAlign()}updateCollapsed(){this.syncAutoAlign()}updateCollapsing(){this.syncAutoAlign()}updateDirection(){this.syncAutoAlign()}}_d.initClass();_d._$name="CollapseTool";const pa=/^(?:UP|DOWN|LEFT|RIGHT)$/,gg=/^(left|top)$/i,va=[],mg=[va,va],ba=/^b-dock-(top|left|right|bottom)$/,cs="b-panel-collapse-revealer",pg=/^(?:left|right)$/i,Lr="b-collapse-unflex",{round:It}=Math,ya=["up","down","left","right"].reduce((u,e)=>(u[e.toUpperCase()]=u[e]=e,u),{}),Os={top:["top","bottom"],right:["right","left"],bottom:["bottom","top"],left:["left","right"]},vg={hl:"LEFT",hr:"RIGHT",vb:"DOWN",vt:"UP"},bg={h:"w",w:"h"},Hd={up:"top",right:"right",down:"bottom",left:"left"},Gr={top:!1,right:!0,bottom:!1,left:!0},yg={top:"UP",right:"RIGHT",bottom:"DOWN",left:"LEFT"},Ca={top:u=>`translate(0, -${It(u.height||0)}px)`,bottom:u=>`translate(0, ${It(u.height||0)}px)`,right:u=>`translate(${It(u.width||0)}px, 0)`,left:u=>`translate(-${It(u.width||0)}px, 0)`};let Cg=0;class gi extends $.mixin(hi){static get $name(){return"PanelCollapser"}static get type(){return"inline"}static get configurable(){return{animation:{duration:200},collapsed:{value:null,$config:null,default:!1},direction:null,collapseTooltip:"L{Collapse}",expandTooltip:"L{Expand}",panel:{value:null,$config:"nullify"},supportAxis:null,tool:{type:"collapsetool",handler(e){var t;(t=this.collapsible)===null||t===void 0||t.onCollapseClick(e)}}}}static get factoryable(){return{defaultType:"inline"}}get collapsing(){return this.collapsingExpanding==="collapsing"}get collapsingExpanding(){var e;const t=(e=this.currentOperation)===null||e===void 0?void 0:e.collapsing;return t==null?null:t?"collapsing":"expanding"}get currentDock(){var e,t,i,r;return(e=(t=this.panel)===null||t===void 0||(i=t.header)===null||i===void 0||(r=i.dock)===null||r===void 0?void 0:r.toLowerCase())!==null&&e!==void 0?e:"top"}get expanding(){return this.collapsingExpanding==="expanding"}get collapseTool(){var e,t;return(e=this.panel)===null||e===void 0||(t=e.tools)===null||t===void 0?void 0:t.collapse}get collapseDim(){return pg.test(this.collapseDir)?"width":"height"}getCollapseDir(e){let{direction:t,panel:i}=this;if(!t||pa.test(t)){const n=i?.placement;if(n)t=vg[n];else{var r;t=yg[(i==null||(r=i.header)===null||r===void 0?void 0:r.dock)||"top"]}}return e?ya[t]:t}get collapseDir(){return this.getCollapseDir(!0)}get collapseDock(){return this.collapseInfo[0]}get collapseInfo(){const{panel:e}=this,t=e.hasHeader&&e.expandedHeaderDock;let i=Hd[this.collapseDir],r=!1;return t&&((r=Gr[i]!==Gr[t])||(i=t)),[i,r]}get toolsConfig(){const{direction:e,tool:t}=this;return t&&{collapse:x.assign({direction:e.toLowerCase()},t)}}beforeCollapse(e){const{panel:t}=this,{element:i}=t;i.contains(b.getActiveElement(i))&&t.revertFocus(!0)}changeTool(e){const t=this,{panel:i}=t;if(t.isConfiguring||t.isDestroying||!i||i.isDestroying)return e;i.tools={collapse:e}}collapse(e){var t,i,r,n,s;const l=this,{panel:o}=l,a={id:++Cg,completed:!1,panel:o};let{currentOperation:d}=l;return e=(t=e)!==null&&t!==void 0?t:!0,x.isObject(e)&&(a.collapsed=!0,x.assign(a,e),e=a.collapsed,delete a.collapsed),a.collapsing=e,a.previous=(i=d)!==null&&i!==void 0?i:null,e!==l.collapsed?d?d.collapsing!==e&&(a.animation=d.animation.revert({finalize(){var c;(c=l.collapseFinalize)===null||c===void 0||c.call(l,a,!0)}}),a.collapsing=e,d=a):(a.animation=x.clone(("animation"in a?a:l).animation),l.beforeCollapse(a)!==!1&&(a.animation&&(a.animation.finalize=c=>{var h;return(h=l.collapseFinalize)===null||h===void 0?void 0:h.call(l,a,c)}),o.changingCollapse=!0,l[e?"collapseBegin":"expandBegin"](a),a.animation?d=a:(a.completed=!0,l[e?"collapseEnd":"expandEnd"](a)),o.changingCollapse=!1,a.animation||l.onComplete(e?"collapse":"expand"))):d&&d.collapsing!==e&&(l[e?"expandRevert":"collapseRevert"](a),a.animation=d.animation.revert({finalize(){var c;(c=l.collapseFinalize)===null||c===void 0||c.call(l,a,!1)}}),d=a),l.currentOperation=d,(r=(n=d)===null||n===void 0||(s=n.animation)===null||s===void 0?void 0:s.done())!==null&&r!==void 0?r:Promise.resolve(e===l.collapsed)}collapseFinalize(e,t){const i=this,{currentOperation:r,panel:n}=i,s=n.collapsed?"expand":"collapse";r===e&&(i.currentOperation=null,e.completed=t,n.changingCollapse=!0,i[s+"End"](e),n.changingCollapse=!1,t&&i.onComplete(s))}applyHeaderDock(e,t=!0){const i=this,{currentDock:r,panel:n}=i,s=e?i.collapseDock:n.expandedHeaderDock;s!==r&&n.hasHeader&&(n.header={dock:s},t&&n.recompose.flush())}composeHeader(e){const{panel:t}=this,{class:i}=e,r=t.expandedHeaderDock||Object.keys(i).filter(n=>i[n]&&ba.test(n)).map(n=>ba.exec(n)[1][0]);return i[cs]=1,i[`b-collapsible-${r[0]}${this.collapseDir[0]}`]=1,e}composeTitle(e){return e.class[cs]=1,e}collapseBegin(e){var t;const i=this,{animation:r}=e,{collapseDim:n,collapseTool:s,panel:l}=i,{element:o,placement:a}=l,[d,c]=i.collapseInfo,h=s?.element.classList,g=!a||a[0]==="h"&&n==="width"||a[0]==="v"&&n==="height";i.configuredWidth=l._lastWidth,i.configuredHeight=l._lastHeight,i.transverseCollapse=c,i.applyHeaderDock(!0);const f=l.rectangle(),m=i.lockInnerSize().moveTo(0,0),p=m.clone(),v=Os[d],y=(t=l.headerElement)===null||t===void 0?void 0:t.getBoundingClientRect(),C=It(y?.[n]||0);o.classList.toggle(Lr,g),r?(p[v[0]]=p[v[1]],o.classList.add("b-collapsing"),h?.add("b-collapsed","b-collapsing"),s&&(s.collapsing=!0),h&&(h.remove("b-collapsed"),l.rectangle(),h.remove("b-collapsing"),h.add("b-collapsed")),r.element=o,r.retain=!0,r[n]={from:It(f[n]),to:C},r.items=[{element:i.innerElement,retain:!1,clip:{from:`rect(${m})`,to:`rect(${p})`}}],c&&r.items.push({element:l.headerElement,duration:r.duration,retain:!1,transform:{from:Ca[d](y),to:"translate(0, 0)"}}),e.animation=he.run(r)):(o.style[n]=`${C}px`,s&&(h.add("b-collapsing","b-collapsed"),s.rectangle(),h.remove("b-collapsing")))}collapseEnd(e){const t=this,{collapseTool:i}=t;t.panel.element.classList.remove("b-collapsing"),i&&(i.collapsing=!1),e.completed?t.collapsed=!0:(t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}collapseRevert(e){var t;(t=this.collapseTool)===null||t===void 0||t.element.classList.remove("b-collapsed")}expandBegin(e){const t=this,{animation:i}=e,{collapseDim:r,collapseTool:n,panel:s}=t,[l,o]=t.collapseInfo,{element:a}=s,d=a.classList,c=d.contains(Lr),h=s.rectangle();d.remove("b-collapsed","b-collapsing"),s.element.style[r]="",t.restoreConfiguredSize(),t.lockInnerSize(!1);const g=s.rectangle(),f=t.lockInnerSize().moveTo(0,0),m=f.clone(),p=Os[t.collapseDock];n?.element.classList.remove("b-collapsed"),i&&(m[p[0]]=m[p[1]],d.add("b-collapsed","b-expanding"),c&&d.add(Lr),i.element=a,i[r]={from:It(h[r]),to:It(g[r])},i.items=[{element:t.innerElement,retain:!1,clip:{from:`rect(${m})`,to:`rect(${f})`}}],o&&i.items.push({element:s.headerElement,duration:i.duration,retain:!1,transform:{from:"translate(0, 0)",to:Ca[l](h)}}),e.animation=he.run(i))}expandEnd(e){const t=this;t.panel.element.classList.remove("b-expanding"),e.completed&&(t.collapsed=!1,t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}expandRevert(e){var t;(t=this.collapseTool)===null||t===void 0||t.element.classList.add("b-collapsed")}get innerElement(){return this.panel.collapseWrapElement||this.panel.bodyWrapElement}get innerSizeElement(){return this.transverseCollapse?this.panel.element:this.innerElement}get supportAxis(){let{_supportAxis:e}=this;const t=e===!0;return(t||e==null)&&(e=this.collapseDim[0],(t||b.getStyleValue(this.panel.element,"position")==="absolute")&&(e+=bg[e])),e||""}lockInnerSize(e=!0){const t=this,{innerElement:i,panel:r}=t,n=e?t.supportAxis:"",s=r.element,l=r.headerElement,o=e&&l&&O.from(l,s),a=e&&O.from(t.innerSizeElement,s),d=i.style;return l&&(l.style.minWidth=n.includes("w")?`${o.width}px`:"",l.style.minHeight=n.includes("h")?`${o.height}px`:""),d.width=e?`${a.width}px`:"",d.height=e?`${a.height}px`:"",i.classList[e?"add":"remove"]("b-panel-collapse-size-locker"),a}onCollapseClick(e){let t=this.collapsing?!1:this.expanding?!0:!this.collapsed;e.altKey&&(t={animation:null,collapsed:t}),this.collapse(t)}onComplete(e){var t;(t=this.panel)===null||t===void 0||t.trigger(e)}onHeaderClick({event:e}){e.button===0&&this.panel.collapsed&&e.target.classList.contains(cs)&&this.onRevealerClick()}onPanelConfigChange({name:e,value:t}){const i=this,{panel:r}=i;e==="collapsed"?r.isPainted&&(i.collapsed=t):e==="header"&&!r.changingCollapse&&i.syncDirection()}onPanelPaint(){this.syncDirection(),this.panel.collapsed&&!this.collapsed&&this.collapse({animation:null,collapsed:!0})}onRevealerClick(){this.panel._collapse({collapsed:!1})}restoreConfiguredSize(e){var t;const{configuredHeight:i,configuredWidth:r,panel:n}=this;e=(t=e)!==null&&t!==void 0?t:"wh",n.element.classList.remove(Lr),r!=null&&e.includes("w")&&(n.width=r),i!=null&&e.includes("h")&&(n.height=i)}splitHeaderItems(){return mg}syncDirection(){const e=this,{direction:t}=e;(!t||pa.test(t))&&(e.direction=e.getCollapseDir())}updateCollapsed(e){const{collapseTool:t,panel:i}=this;i&&(i.collapsed=e,i.element.classList[e?"add":"remove"]("b-collapsed")),t&&(t.collapsed=e)}updateDirection(e){const{collapseTool:t,panel:i}=this;t&&(t.direction=ya[e]),i!=null&&i.rendered&&i.recompose()}updatePanel(e){var t;const i=this;i.syncDirection(),(t=i.panelChangeDetacher)===null||t===void 0||t.call(i),i.panelChangeDetacher=e&&pe.after(e,"onConfigChange","onPanelConfigChange",i,{return:!1})}wrapCollapser(e,t){var i;const r=this,[n,s]=r.collapseInfo;if(!s)return[e,t];const{collapseDir:l,panel:o}=r,{expandedHeaderDock:a,header:d,uiClassList:c}=o,h=(i=o.tools)===null||i===void 0?void 0:i.recollapse,[g,f]=r.splitHeaderItems({dock:n,as:"element"}),m=o.hasHeader?o.title||d?.title||"\xA0":null,p=m&&{tag:"header",class:new q(F(F({},c),{},{[`b-dock-${a}`]:1,"b-panel-header":1,"b-panel-collapser-header":1}),d?.cls),children:[...g,{reference:"collapserTitleElement",html:m,class:F(F({},c),{},{[`b-align-${d?.titleAlign||"start"}`]:1,"b-header-title":1})},...f]};return h&&(h.direction=l),["collapseWrapElement",{class:F(F({},c),{},{[`b-panel-collapser-header-${a}`]:1,[`b-panel-collapser-${l}`]:1,[`b-${Gr[a]?"h":"v"}box`]:1,"b-panel-collapser":1,"b-box-center":1}),children:gg.test(a)?{collapserHeaderElement:p,[e]:t}:{[e]:t,collapserHeaderElement:p}}]}}gi.maps={clipByDock:Os,dockByDirection:Hd,dockIsHorz:Gr};gi.initClass();gi._$name="PanelCollapser";const $i=Symbol("pendingCreate");class nr extends ${static get prototypeProperties(){return{cleanup:null,configName:null,created:null,factory:null,inferType:"name",owner:null,ownerName:null,proxyable:typeof Proxy<"u",setup:null,transform:null}}static get properties(){return{defaults:{},instances:{},object:Object.create({})}}get proxy(){const e=this;let t=null;return e.proxyable&&(t=new Proxy(e.instances,{get(i,r){return e.get(r)},set(i,r,n){return e.set(r,n),!0},deleteProperty(i,r){return e.set(r,null),!0}})),Reflect.defineProperty(e,"proxy",{configurable:!0,value:t}),t}get target(){return this.proxy||this.object}define(e,t){const i=this,{transform:r}=i,n=r?r(t,e):t,s=x.isInstantiated(n);i.instances[e]=$i,s||i.setDefaults(e,n),i.defineProp(e,!0),s&&i.set(e,n)}defineProp(e,t){const i=this,{object:r}=i;i.proxy||Reflect.defineProperty(t?Object.getPrototypeOf(r):r,e,{configurable:!t,enumerable:!0,get(){return i.get(e)},set(n){return i.set(e,n)}})}flush(){const e=this;try{var t;e.updating=!0;for(const i in e.defaults)e.get(i);e.afterConfigureOwner=(t=e.afterConfigureOwner)===null||t===void 0?void 0:t.call(e)}finally{e.updating=!1}}get(e){const{defaults:t,instances:i}=this;return i[e]===$i&&this.set(e,$i),i[e]||t[e]&&null}set(e,t){const i=this,{cleanup:r,configName:n,defaults:s,factory:l,instances:o,owner:a,setup:d,transform:c,updating:h}=i,g=a&&n&&!h,f=o[e]===$i?null:o[e],m=l.reconfigure(f,t===$i?{}:t||null,{cleanup:r&&(v=>r(v,e)),defaults:s[e]||i.setDefaults(e,{}),owner:i.owner,setup:d&&((v,y,C)=>d(v,e,y,C)),transform:c&&(v=>c(v,e))});if(m!==f){const v=g&&F({},o);if(o[e]=m,m){var p;i.defineProp(e),(p=i.created)===null||p===void 0||p.call(i,m,e)}else delete i.object[e],delete o[e];g&&a.onConfigChange({name:n,config:a.$meta.configs[n],value:i.target,was:v})}}setDefaults(e,t){const{defaults:i,factory:r,inferType:n,instances:s,owner:l,ownerName:o}=this,{typeKey:a}=r.factoryable;return t=t===!0?{}:x.assign({},t),(n==="name"||n===!0&&!t[a])&&(t[a]=e),o&&(t[o]=l),t.beforeConfigure=d=>{s[e]=d},i[e]=t}update(e){const t=this,{owner:i}=t;let r,n;try{if(t.updating=!0,e)for(r in e)n=e[r],t.defaults[r]?t.set(r,n):n&&t.define(r,n);else for(r in t.instances)t.set(r,null)}finally{t.updating=!1}i&&(i.isConfiguring?t.afterConfigureOwner||(t.afterConfigureOwner=pe.before(i,"afterConfigure","flush",t)):t.flush())}}nr.initClass();nr._$name="DynamicObject";const wg=[],us={},xg={align:1,weight:1};var Nd=u=>class extends(u||k){static get $name(){return"Toolable"}static get configurable(){return{tools:{value:null,$config:{nullify:!0}},toolDefaults:{"*":{type:"tool",align:"end"}}}}byWeightSortFn(t,i){return(t.weight||0)-(i.weight||0)}byWeightReverseSortFn(t,i){return(i.weight||0)-(t.weight||0)}gatherTools({align:t,overlay:i,refs:r}=us){const{collapsed:n,tools:s}=this;let l=[],o,a,d,c,h;for(a in s){var g,f,m,p,v;h=s[a],o=(g=(f=(m=h)===null||m===void 0||(p=m.align)===null||p===void 0?void 0:p.align)!==null&&f!==void 0?f:(v=h)===null||v===void 0?void 0:v.align)!==null&&g!==void 0?g:"end",o===t&&h.isCollapsified(n,i)&&l.push(h)}if(l.sort(this[t==="end"?"byWeightReverseSortFn":"byWeightSortFn"]),r){const y=r==="widget",C={};for(d=0;d<l.length;++d)c=l[d],C[c.ref]=y?c:c.element;l=C}return l}getEndTools({overlay:t,refs:i}=us){return this.gatherTools({align:"end",overlay:t,refs:i})}getStartTools({overlay:t,refs:i}=us){return this.gatherTools({align:"start",overlay:t,refs:i})}get childItems(){return[...this.getStartTools(),...this._items||wg,...this.getEndTools()]}changeTools(t,i){const r=this,n=r.$tools||(r.$tools=new nr({configName:"tools",factory:k,inferType:!1,owner:r,created(s){var l,o;s.innerItem=!1,(l=s.syncRotationToDock)===null||l===void 0||l.call(s,(o=r.header)===null||o===void 0?void 0:o.dock),pe.after(s,"onConfigChange",(a,{name:d})=>{xg[d]&&r.onConfigChange({name:"tools",value:n.target})}),r.onChildAdd(s)},setup(s,l){return s=x.merge({},r.toolDefaults["*"],r.toolDefaults[l],s),s.parent=r,s.ref=l,s}}));if(n.update(t),!i)return n.target}get widgetClass(){}};const wa=["b-hbox","b-vbox"],Sg={name:"align",style:"alignItems"},Eg={name:"contentAlign",style:"alignContent"},Tg={name:"direction",style:"flexDirection"},Rg={name:"justify",style:"justifyContent",classes:["stretch"]},Dg={name:"wrap",style:"flexWrap",map:{false:"nowrap",true:"wrap",reverse:"wrap-reverse"}};class Wt extends vt{get vertical(){return this.horizontal===!1}set vertical(e){return this.horizontal=!e}updateAlign(){this.syncConfigStyle(Sg)}updateContentAlign(){this.syncConfigStyle(Eg)}updateDirection(){this.syncConfigStyle(Tg)}updateHorizontal(){var e;const t=this,i=(e=t.contentElement)===null||e===void 0?void 0:e.classList,r=Number(t.vertical);i?(i.remove(wa[1-r]),i.add(wa[r])):t.syncConfigLater("horizontal"),t.syncDirection()}updateJustify(){this.syncConfigStyle(Rg)}updateReverse(){this.syncDirection()}updateWrap(){this.syncConfigStyle(Dg)}syncDirection(){const e=this,{reverse:t}=e;e.direction=t?`${e.vertical?"column":"row"}${t?"-reverse":""}`:null}}T(Wt,"$name","Box");T(Wt,"type","box");T(Wt,"alias","hbox");T(Wt,"configurable",{itemCls:"b-box-item",align:null,contentAlign:null,direction:null,horizontal:!0,justify:null,reverse:null,wrap:null});Wt.initClass();Wt._$name="Box";class sr extends Wt{}T(sr,"$name","VBox");T(sr,"type","vbox");T(sr,"configurable",{horizontal:!1});sr.initClass();sr._$name="VBox";var Bd=u=>class extends(u||$){static get $name(){return"Badge"}static get configurable(){return{badge:null}}compose(){const{badge:t}=this;return{dataset:{badge:t},class:{"b-badge":t!=null&&t!==""}}}};const xa=/(?:^|\s)b-icon-/,Sa=/(?:^|\s)b-fa-/,Ea=Symbol("defaultToggleable"),Mg=["items","type","widgets","html","listeners"],Ta=Symbol("defaultListener");class Ys extends k.mixin(Bd,Us){static get $name(){return"Button"}static get type(){return"button"}static get configurable(){return{icon:null,menuIcon:"b-icon-picker",pressedIcon:null,iconAlign:"start",text:{value:null,$config:null,default:""},color:null,toggleable:Ea,pressed:!1,toggleGroup:null,ripple:{radius:75},forwardTwinEvents:["action","toggle"],localizableProperties:["text"],menu:{$config:["lazy","nullify"],value:null},menuDefaults:{type:"menu",autoShow:!1,autoClose:!0,floating:!0,scrollAction:"realign",align:"t0-b0"},href:null,target:null,defaultBindProperty:null}}updateElement(e,t){var i,r,n;const s=this,{constructor:l}=s,o=super.updateElement(e,t),a=s.peekConfig("menu"),d=a?a.isWidget?a.role:((i=l.resolveType(a.type))===null||i===void 0||(r=i.configurable)===null||r===void 0?void 0:r.role)||((n=l.configurable.menuDefaults)===null||n===void 0?void 0:n.type)||"menu":!1;return s.ariaHasPopup=d,o}compose(){const{color:e,href:t,icon:i,iconAlign:r,pressed:n,pressedIcon:s,target:l,text:o,toggleable:a,toggleGroup:d,menuIcon:c}=this,h=this.hasConfig("menu"),g=n&&s?s:i;return{tag:t?"a":"button",href:t,target:l,class:{[`b-icon-align-${r}`]:i,[e]:Boolean(e),"b-pressed":n&&a,"b-text":Boolean(o),"b-has-menu":h},"aria-pressed":n,dataset:{group:d},listeners:{click:"onInternalClick",mousedown:"onInternalMousedown"},children:{iconElement:(i||s)&&{"aria-hidden":!0,tag:"i",class:F(F({},q.normalize(g,"object")),{},{"b-icon":xa.test(g),"b-fa":Sa.test(g)})},label:o&&{tag:"label",text:o},menuIconElement:h&&c&&{tag:"i",class:{"b-icon":xa.test(c),"b-fa":Sa.test(c),"b-button-menu-icon":1,[c]:1}}}}}configureOverflowTwin(e){const t=this,i=super.configureOverflowTwin(e);return i.text||(i.text=t.tooltipText),i}onHide(){var e;(e=this._menu)===null||e===void 0||e.hide()}get childItems(){return this._menu&&[this.menu]}onFocusOut(e){var t;super.onFocusOut(e),(t=this.menu)===null||t===void 0||t.hide()}get focusElement(){return this.element}changeText(e){return e??""}changeToggleable(e){return e===Ea?this.toggleGroup||this.config.menu:e}changeMenu(e,t){const i=this,{element:r}=i;return e?(e.isWidget?(e.forElement=r,e.owner=i,e.constrainTo=i.rootElement):(typeof e=="object"&&!Mg.some(n=>n in e)&&(e={lazyItems:e}),e=k.reconfigure(t,e?x.merge({owner:i,constrainTo:i.rootElement,forElement:r},i.menuDefaults,e):null,i)),e.align.constrainPadding=10,i.detachListeners(Ta),e.ion({name:Ta,beforeShow:"onMenuBeforeShow",hide:"onMenuHide",show:"onMenuShow",thisObj:this})):t?.destroy(),e}onMenuBeforeShow({source:e}){return this.trigger("beforeShowMenu",{menu:e})}onMenuShow(){this.ariaElement.setAttribute("aria-expanded",!0)}onMenuHide(){this.ariaElement.setAttribute("aria-expanded",!1),this.toggle(!1)}updateMenu(e){this.toggleable=Boolean(e)}updatePressed(e){const t=this;if(!t.toggleable||t.isConfiguring)return;const{menu:i}=t;if(e&&b.forEachSelector(t.rootElement,`button[data-group=${t.toggleGroup}]`,s=>{s!==t.element&&(k.getById(s.id).pressed=!1)}),i){var r,n;i.initialConfig.minWidth||(i.minWidth=t.width),i.align.minHeight=(r=i._minHeight)!==null&&r!==void 0?r:100,i.align.minWidth=(n=i._minWidth)!==null&&n!==void 0?n:100,i[e?"show":"hide"]()}t.trigger("toggle",{pressed:e})}onInternalMousedown(e){var t;(t=this._menu)!==null&&t!==void 0&&t.containsFocus&&this.pressed&&e.preventDefault()}onInternalClick(e){const t=this,i={event:e};t.disabled||t.toggleable&&(t.toggleGroup&&t.pressed||(t.toggle(!t.pressed),t.isDestroyed))||(t.trigger("click",i),t.isDestroyed||t.trigger("action",i),t.href||(e.preventDefault(),e.stopPropagation()))}toggle(e=!this.pressed){this.trigger("beforeToggle",{pressed:e})!==!1&&(this.pressed=e)}}Ys.initClass();Ys._$name="Button";const Ra={refs:"element"},Ig=u=>u.element.style.margin="",Fg=u=>u.isToolbar,Da=u=>u[0]+(u[1].minifiable?0:9e9),Vd={hidden:!1,width:""},kg=F(F({},Vd),{},{flex:""}),Lg=[{box:"hbox",clientSizeProp:"clientWidth",edgeProp:"right",flexDir:"row",horizontal:!0,max:"maxX",overflow:"overflowX",pos:"x",scrollSize:"scrollWidth",sizeProp:"width"},{box:"vbox",clientSizeProp:"clientHeight",edgeProp:"bottom",flexDir:"column",horizontal:!1,max:"maxY",overflow:"overflowY",pos:"y",scrollSize:"scrollHeight",sizeProp:"height"}],Pg={delay:0,startRate:40,endRate:200,accelerateDuration:500},Og={menu:1,pressed:1};class mi extends Je.mixin(Nd){static get $name(){return"Toolbar"}static get type(){return"toolbar"}static get delayable(){return{syncOverflowVisibility:{type:"raf",cancelOutstanding:!0}}}static get configurable(){return{defaultType:"button",dock:"top",layout:{type:"box"},overflow:{$config:["lazy","nullify"],value:{type:"menu"}},toolDefaults:{overflowMenuButton:{type:"button",hidden:!0,icon:"b-icon-menu",menuIcon:null,defaultCls:{"b-overflow-button":1}},overflowScrollEnd:{handler:"up.onEndScrollClick",hidden:!0,defaultCls:{"b-icon-angle-right":1,"b-overflow-button":1,"b-icon":1}},overflowScrollStart:{align:"start",handler:"up.onStartScrollClick",hidden:!0,defaultCls:{"b-icon-angle-left":1,"b-overflow-button":1,"b-icon":1}}},widgetCls:null,ignoreParentReadOnly:!0}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}static getEvictionList(e){const t=e.filter(i=>i.overflowable!=="none");return t.forEach((i,r)=>t[r]=[r,i]),t.sort((i,r)=>Da(r)-Da(i)),t}compose(){const e=this,{axisProps:t,dock:i}=e,r=e.getEndTools(Ra),n=e.getStartTools(Ra);return{class:{[`b-dock-${i}`]:1,[`b-${i}-toolbar`]:1,[`b-${t.box}`]:1},children:F(F({},n),{},{toolbarContent:{class:{"b-box-center":1,"b-toolbar-content":1}}},r)}}get axisProps(){return Lg[this.layout.horizontal?0:1]}get contentElement(){return this.toolbarContent}get overflowMenuButton(){var e;return(e=this.tools)===null||e===void 0?void 0:e.overflowMenuButton}get overflowType(){const{overflow:e}=this;return typeof e=="string"?e:e?.type}onChildAdd(e){var t;super.onChildAdd(e),this.processAddedLeafItem(e),(t=e.syncRotationToDock)===null||t===void 0||t.call(e,this.dock)}onChildRemove(e){super.onChildRemove(e),this.syncOverflowVisibility()}processAddedLeafItem(e){pe.after(e,"onConfigChange",this.onLeafItemConfigChange,e),e.isContainer&&e.eachWidget(t=>this.processAddedLeafItem(t))}onPaint({firstPaint:e}){var t;(t=super.onPaint)===null||t===void 0||t.call(this,...arguments),e&&this.getConfig("overflow")}updateDock(e){const t=this,{layout:i}=t,{vertical:r}=i;if(i.vertical=$d(e)[1],!t.initialItems){r!==i.vertical&&t.updateOverflow(t.overflow);for(const s of t.childItems){var n;(n=s.syncRotationToDock)===null||n===void 0||n.call(s,e)}}}updateOverflow(e,t){var i;const r=this,{axisProps:n,contentElement:s,overflowType:l}=r,{flexDir:o}=n,a=(i=r.overflowMenuButton)===null||i===void 0?void 0:i._menu,d={};if(a&&(e?a?.removeAll():a.eachWidget(h=>{h._overflowTwinOrigin.overflowTwin=null})),t==="menu"?d.overflowMenuButton=null:t==="scroll"&&(d.overflowScrollStart=d.overflowScrollEnd=null),l==="menu"){var c;(c=r.scrollable)===null||c===void 0||c.destroy(),s.style.overflow=s.style.overflowX=s.style.overflowY="",d.overflowMenuButton={cls:{[`b-${o}-menu`]:1}}}else if(l==="scroll"){const h=typeof e=="object"&&e?.repeat||Pg;r.scrollable={[n.overflow]:"hidden-scroll",element:s,internalListeners:{scroll:"onContentScroll",thisObj:r}},d.overflowScrollStart={repeat:h,invertRotate:!0,cls:{[`b-${o}-start-scroller`]:1}},d.overflowScrollEnd={repeat:h,invertRotate:!0,cls:{[`b-${o}-end-scroller`]:1}}}r.tools=d,l?(s.classList.add("b-overflow"),r.monitorResize=!0,r.syncOverflowVisibility()):(s.classList.remove("b-overflow"),r.monitorResize=!1)}onContentScroll(){this.syncScrollerState()}onStartScrollClick(){this.scrollable[this.axisProps.pos]-=2}onEndScrollClick(){this.scrollable[this.axisProps.pos]+=2}onInternalResize(){super.onInternalResize(...arguments),this.isPainted&&this.syncOverflowVisibility()}syncOverflowVisibility(){const e=this,{overflowType:t,contentElement:i,isVisible:r}=e,{clientSizeProp:n,edgeProp:s,sizeProp:l}=e.axisProps,{overflowMenuButton:o,overflowScrollStart:a,overflowScrollEnd:d}=e.tools,c=e.rtl&&e.layout.horizontal,h=t==="menu",g=()=>Math.ceil(i[n]+(!a||a.hidden?0:a.rectangle("outer")[l])+(!d||d.hidden?0:d.rectangle("outer")[l])),f=()=>{if(L.length===0)return 0;const Y=L[L.length-1].rectangle(i);return Math.floor(c?i[n]-Y.left:Y[s])};let m,p,v,y,C,w,S,D,I,R,H,L;if(!(!r||!t||e.items.length===0)){if(e.inSyncOverflowVisibility=!0,o?.hide(),e.eachWidget((Y,j)=>{S=Y.minifiable,R=Y.overflowable,R=S?R||S:R,Y.floating?j.down=!1:(j.down=!R,Y.innerItem&&(Y._toolbarOverflow&&(Y.hidden=Y._toolbarOverflow=!1),Y._toolbarMinified&&(Y.minified=Y._toolbarMinified=!1),Y.isVisible&&(S&&(D||(D=[])).push(Y),R&&(L||(L=[])).push(Y))))}),L&&(m=g(),p=f()),L&&p>m)if(h){for(;p>m&&(C=(V=D)===null||V===void 0?void 0:V.pop());){var V;w=p,C._toolbarMinified=!0,C.minified=!0,p=f(),w-=p,(I||(I=[])).push([C,w])}if(p>m){o.show(),m=g(),y=mi.getEvictionList(L);for(v of y)p>m&&(C=v[1],C._toolbarOverflowWidth=C.width,C._toolbarOverflow=!0,C.hidden=!0,L.splice(L.indexOf(C),1),(H||(H=[])).push(v),p=f());if(H){for(H.sort((Y,j)=>Y[0]-j[0]).forEach((Y,j)=>H[j]=Y[1]);(U=I)!==null&&U!==void 0&&U.length;){var U;[C,w]=I.pop(),p+w<=m&&!C._toolbarOverflow&&(p+=w,C.minified=C._toolbarMinified=!1)}e.syncOverflowMenuButton(H)}else o.hide()}}else d.show(),a.show(),e.syncScrollerState();else h||(d?.hide(),a?.hide());e.inSyncOverflowVisibility=!1}}syncOverflowMenuButton(e){var t;const i=this,{axisProps:r,overflowMenuButton:n}=i,s={cls:"b-toolbar-overflow-menu",minWidth:280,items:[],align:{align:r.horizontal?"t100-b100":"r100-l100",axisLock:"flexible"}};if(i.addToMenu(s,e.filter(l=>i.overflowItemFilter(l))),(t=n._menu)!==null&&t!==void 0&&t.isMenu){const l=n.menu,{toAdd:o,toRemove:a}=B.delta(s.items,l.items,1);if(l.remove(a),l.items.length)for(let d=o.length-1;d>=0;d--)l.insert(o[d],0);else l.add(o)}else n.menu=s}syncScrollerState(){const e=this,{axisProps:t,scrollable:i}=e,{overflowScrollStart:r,overflowScrollEnd:n}=e.tools,s=i[t.pos],l=i[t.max];r.disabled=!s,n.disabled=Math.abs(Math.ceil(s))>=Math.abs(l)}overflowItemFilter(e){const{filter:t}=this.overflow;return Boolean(t?t.call(this,e):b.getChildElementCount(e.element))}addToMenu(e,t){const i=this.horizontal?kg:Vd;for(const r of t){const n=r.ensureOverflowTwin(i,Ig);e.items.push(n)}}onLeafItemConfigChange(e,{name:t,value:i}){const r=this,n=r.up(Fg),s=n.hasConfig("overflow"),{overflowTwin:l}=r;!s||n!=null&&n.inSyncOverflowVisibility||t==="hidden"&&i===r._toolbarOverflow||(l&&!Og[t]&&(l[t]=i),n!=null&&n.isPainted&&r.ref!=="overflowMenuButton"&&(r.isTextField&&t==="value"&&(r.containsFocus||l!=null&&l.containsFocus)||n.syncOverflowVisibility()))}createWidget(e){e==="->"?e={type:"widget",cls:"b-toolbar-fill"}:e==="|"?e={type:"widget",cls:"b-toolbar-separator"}:typeof e=="string"&&(e={type:"widget",cls:"b-toolbar-text",html:e});const t=super.createWidget(e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}}mi.initClass();mi._$name="Toolbar";const Ag=u=>!u.classList.contains("b-focus-trap")&&b.isFocusable(u)?b.NodeFilter.FILTER_ACCEPT:b.NodeFilter.FILTER_SKIP,As=[],$g={},Ma=[As,As],Ia=(u,e,t)=>{const{vertical:i}=u;return delete u.vertical,F(F({},u),{},{class:F(F({},e),{},{[`b-${i?"v":"h"}box`]:1,"b-box-center":1,"b-panel-bar-wrap":!t})})},hs=(u,e,t=!1)=>{const i={vertical:t,children:u?[u]:[]};return e&&(i.tag=e),i},_g={dock:1,hidden:1,weight:1},Pt={top:[!0,!0],bottom:[!0,!1],left:[!1,!0],right:[!1,!1]},Fa={header:1,"pre-header":1};class Ke extends Je.mixin(Bs,Nd){static get $name(){return"Panel"}static get type(){return"panel"}static get configurable(){return{localizableProperties:["title"],collapsed:{value:null,$config:null,default:!1},collapsible:{value:null,$config:"nullify"},bodyCls:{$config:{merge:"classList"},value:null},bodyTag:null,bodyWrapTag:null,trapFocus:null,title:null,header:null,stateful:["collapsed"],stripDefaults:{"*":{type:"toolbar",dock:"top"},bbar:{dock:"bottom",weight:-1e3},tbar:{weight:-1e3}},strips:{value:null,$config:"nullify"},toolDefaults:{close:{weight:-1e3},collapse:{weight:-990}},footer:null,revealed:null,tbar:null,bbar:null,role:"region"}}updateElement(e,t){const i=super.updateElement(e,t);return this.titleElement&&b.setAttributes(this.ariaElement,{"aria-describedby":this.titleElement.id}),i}compose(){const e=this,{collapsible:t,focusable:i,hasItems:r,revealed:n,tools:s}=e,l=e.composeHeader(),o=l?.class["b-dock-left"]||l?.class["b-dock-right"];let a=e.composeBody(),d="bodyWrapElement";return t&&([d,a]=t.wrapCollapser(d,a)),{tabIndex:r&&i!==!1||i?0:null,class:{[`b-panel-collapsible-${t?.type}`]:t,[`b-panel-collapse-${t?.collapseDir}`]:t,[`b-${o?"h":"v"}box`]:1,"b-panel-collapsible":t,"b-panel-has-header":l,"b-panel-has-tools":s?1:0,"b-panel-overlay-revealed":n},children:{topFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1}},headerElement:l,[d]:a,bottomFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1,"b-end-focus-trap":1}}}}}composeBody(){const e=this,{bodyCls:t,bodyConfig:i,bodyWrapTag:r,footer:n,uiClassList:s}=e,l=x.values(e.strips,(p,v)=>!Pt[v?.dock]).sort(e.byWeightSortFn);let o,a,d,c,h,g,f;for(n&&(d=n.dock||"bottom",l.unshift({dock:d,element:{tag:"footer",reference:"footerElement",html:typeof n=="string"?n:n.html,class:F(F({},s),{},{[`b-dock-${d}`]:1,[`${n.cls||""}`]:1})}})),t&&(i[h="className"]||(h="class"),i[h]=new q(i[h]).assign(t)),c=l.length;c-- >0;)o=l[c],[g,a]=Pt[o.dock],f?f.vertical!==g&&(f=hs(Ia(f,s),"",g)):f=hs(i,r,g),f.children[a?"unshift":"push"](o.element);const m=Ia(f||hs(i,r),s,!0);return m.class["b-panel-body-wrap"]=1,m.class[`b-${e.$$name.toLowerCase()}-body-wrap`]=1,m}get hasHeader(){if(this.header===!1)return!1;const{header:e,title:t,tools:i,parent:r}=this,n=this.maximizable||Object.values(i||{}).some(s=>!s.hidden);return e||!(r!=null&&r.suppressChildHeaders)&&(t||n)}get rootUiClass(){return Ke}composeHeader(e){var t;const i=this;if(!i.hasHeader&&!e)return;const r=i.header||{},n=r.dock||"top",[s,l]=i.splitHeaderItems({dock:n,as:"element"}),o=i.$meta.hierarchy,a=i.composeTitle(r),d=new q(F({[`b-dock-${n}`]:1},i.uiClassList),r.cls);let c,h;for(c=o.indexOf(Ke);c<o.length;++c)h=o[c].$$name,h!=="Grid"&&(d[`b-${h.toLowerCase()}-header`]=1);const g={tag:"header",class:d,children:[...s,a,...l]};return((t=i.collapsible)===null||t===void 0?void 0:t.composeHeader(g))||g}composeTitle(e){var t;const i=typeof e=="string"?e:this.title||e.title,r={reference:"titleElement",id:`${this.id}-panel-title`,html:i??"\xA0",class:F({[`b-align-${e.titleAlign||"start"}`]:1,"b-header-title":1},this.uiClassList)};return x.isObject(i)&&(delete r.html,x.merge(r,i)),((t=this.collapsible)===null||t===void 0?void 0:t.composeTitle(r))||r}updateTitle(){}afterRecompose(){var e;super.afterRecompose();const t=this,{headerElement:i}=t;(e=t._headerClickDetacher)===null||e===void 0||e.call(t),t._headerClickDetacher=i&&A.on({element:i,click:r=>{var n;return(n=t.trigger)===null||n===void 0?void 0:n.call(t,"headerClick",{event:r})}})}onHeaderClick(e){var t;(t=this.collapsible)===null||t===void 0||t.onHeaderClick(e)}onPaint(){var e;super.onPaint(...arguments),(e=this.collapsible)===null||e===void 0||e.onPanelPaint(this)}splitHeaderItems({as:e,overlay:t,dock:i}=$g){const r=this,n=e==="element",{collapsed:s}=r,l=r.getEndTools({overlay:t}),o=r.getStartTools({overlay:t}),a=x.values(r.strips,(y,C)=>!Fa[C?.dock]&&C.isCollapsified(s,t));let d=Ma,c,h,g;if(a.length+l.length+o.length){for(d=[h=[...o,...a.filter(y=>y.dock==="pre-header").sort(r.byWeightSortFn)],c=[...a.filter(y=>y.dock==="header").sort(r.byWeightReverseSortFn),...l]],g=0;g<h.length;++g){var f,m;i&&((f=(m=h[g]).syncRotationToDock)===null||f===void 0||f.call(m,i)),n&&(h[g]=h[g].element)}for(g=0;g<c.length;++g){var p,v;i&&((p=(v=c[g]).syncRotationToDock)===null||p===void 0||p.call(v,i)),n&&(c[g]=c[g].element)}}return d}set bodyConfig(e){this._bodyConfig=e}get bodyConfig(){const e=this,{bodyTag:t}=e,i=x.merge({reference:"bodyElement",className:F(F({},e.getStaticWidgetClasses(Ke,"-content")),{},{"b-box-center":1,"b-text-content":e.textContent&&e.hasNoChildren})},e._bodyConfig);return t&&(i.tag=t),(e.initializingElement||!e._element)&&(i.html=e.content||e._html),i}changeBodyCls(e){return q.from(e)}changeTbar(e){return this.getConfig("strips"),this.strips={tbar:e},this.strips.tbar}changeBbar(e){return this.getConfig("strips"),this.strips={bbar:e},this.strips.bbar}get childItems(){var e;const t=this,i=x.values(t.strips,(o,a)=>!Pt[a?.dock]).sort(t.byWeightSortFn),[r,n]=t.splitHeaderItems(),[s,l]=((e=t.collapsible)===null||e===void 0?void 0:e.splitHeaderItems())||Ma;return[...r,...s,...n,...l,...i.filter(o=>Pt[o.dock][1]),...t._items||As,...i.filter(o=>!Pt[o.dock][1]).reverse()]}changeStrips(e,t){const i=this,r=i.$strips||(i.$strips=new nr({configName:"strips",factory:k,inferType:!1,owner:i,created(n){var s;const{dock:l}=n;if(!Fa[l]&&!Pt[l])throw new Error(`Invalid dock value "${l}"; must be: top, left, right, bottom, header, or pre-header`);pe.after(n,"onConfigChange",(o,{name:a})=>{_g[a]&&i.onConfigChange({name:"strips",value:r.target})}),n.innerItem=!1,i.onChildAdd(n),n.parent=i,(s=n.layout)===null||s===void 0||s.renderChildren(),n.hasItems&&(i.hasItems=!0)},setup(n,s){return n=x.merge(x.clone(i.stripDefaults["*"]),i.stripDefaults[s],n),n.parent=i,n.ref=s,n},transform(n){return Array.isArray(n)&&(n={items:n}),n||null}}));if(r.update(e),!t)return r.target}get collapsing(){var e;return(e=this.collapsible)===null||e===void 0?void 0:e.collapsing}get collapsingExpanding(){var e;return(e=this.collapsible)===null||e===void 0?void 0:e.collapsingExpanding}get expanding(){var e;return(e=this.collapsible)===null||e===void 0?void 0:e.expanding}changeCollapsed(e){const t=this,{collapsible:i}=t;if(t.recompose.flush(),e=Boolean(e),!i||t.changingCollapse||!t.isPainted)return e;i?.collapse({animation:null,collapsed:e})}changeCollapsible(e,t){const i=this;return i.getConfig("tools"),e&&(e===!0?e={}:typeof e=="string"&&(e={[Pt[e]?"direction":"type"]:e})),gi.reconfigure(t,e,{owner:i,defaults:{panel:i},cleanup(){i.collapsed&&(t.collapse({animation:null,collapsed:!1}),i._collapsed=1)}})}updateCollapsible(e){const t=this,i=e?.toolsConfig;t.tools={collapse:i?.collapse||null,recollapse:i?.recollapse||null},e&&t.isPainted&&t.collapsed&&(t._collapsed=1),t.collapsed===1&&(t.collapsed=!0)}_collapse(e,t){var i;return t!==!0&&t!==void 0&&(t===!1?e.collapsed=!e.collapsed:typeof t=="number"?e.animation={duration:t}:t===null?e.animation=t:t===!0||("animation"in t?x.merge(e,t):e.animation=t)),(i=this.collapsible)===null||i===void 0?void 0:i.collapse(e)}collapse(e){return this._collapse({collapsed:!0},e)}expand(e){return this._collapse({collapsed:!1},e)}toggleCollapsed(e){return this.collapsed?this.expand(e):this.collapse(e)}get expandedHeaderDock(){var e,t,i;return(e=(t=this._expandedHeaderDock)!==null&&t!==void 0?t:(i=this.initialConfig.header)===null||i===void 0?void 0:i.dock)!==null&&e!==void 0?e:"top"}set expandedHeaderDock(e){this._expandedHeaderDock=e?.toLowerCase()}updateHeader(e){this.changingCollapse||(this.expandedHeaderDock=e?.dock)}updateTrapFocus(e){var t;const i=this;i.element.classList[e?"add":"remove"]("b-focus-trapped"),i.focusTrapListener=(t=i.focusTrapListener)===null||t===void 0?void 0:t.call(i),e&&(i.focusTrapListener=A.on({element:i.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:i}),i.treeWalker||(i.treeWalker=this.setupTreeWalker(i.element,b.NodeFilter.SHOW_ELEMENT,Ag)))}setupTreeWalker(e,t,i){return document.createTreeWalker(e,t,i)}onFocusTrapped(e){const t=this,i=t.treeWalker;if(e.target===t.bottomFocusTrap)i.currentNode=t.topFocusTrap,i.nextNode();else if(e.target===t.topFocusTrap)i.currentNode=t.bottomFocusTrap,i.previousNode();else return;t.requestAnimationFrame(()=>i.currentNode.focus())}get focusElement(){return this.hasItems&&(super.focusElement||this.element)}get contentElement(){return this.element&&this.bodyElement}get widgetClassList(){const e=this,t=super.widgetClassList;if(e.hasHeader){var i;t.push("b-panel-has-header",`b-header-dock-${((i=e.header)===null||i===void 0?void 0:i.dock)||"top"}`)}return e.tbar&&t.push("b-panel-has-top-toolbar"),e.bbar&&t.push("b-panel-has-bottom-toolbar"),t}}Ke.initClass();Ke._$name="Panel";class ze extends Ke{static get $name(){return"Popup"}static get type(){return"popup"}static get configurable(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},stripDefaults:{bbar:{layout:{justify:"flex-end"}}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,maximizable:null,modal:null,maximized:null,tools:{close:{cls:"b-popup-close",handler:"close",weight:-1e3,ariaLabel:"L{Popup.close}",hidden:!0},maximize:{cls:"b-popup-expand",handler:"toggleMaximized",weight:-999,hidden:!0}},highlightReturnedFocus:!0,role:"dialog"}}finalizeInit(){const e=this,{forElement:t}=e;e.anchoredTo=t,e.initialAnchor=e.anchor,t&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),A.on({element:t,click:"onElementUserAction",thisObj:e})),super.finalizeInit(),e.autoShow&&(!t||b.isVisible(t))&&(e.autoShow===!0?e.show():e.setTimeout(()=>e.show(),e.autoShow))}onPaint({firstPaint:e}){var t;(t=super.onPaint)===null||t===void 0||t.call(this,...arguments);const i=this;e&&i.headerElement&&A.on({element:i.headerElement,dblclick:i.onHeaderDblClick,thisObj:i})}doDestroy(){this.syncModalMask(),super.doDestroy()}compose(){const{hasNoChildren:e,textContent:t}=this;return{class:{"b-text-popup":Boolean(t&&e)}}}close(){const e=this;if(!e._hidden&&e.trigger("beforeClose")!==!1||e._hidden&&e.closeAction==="destroy")return e.modal&&e.closeAction==="destroy"&&e.revertFocus(),e.unmask(),e.containsFocus&&e.highlightReturnedFocus&&e.setTimeout(()=>e.element.classList.add("b-using-keyboard"),0),e[e.closeAction]()}toggleMaximized(){this.maximized=!this.maximized}updateMaximized(e){b.toggleClasses(this.element,["b-maximized"],e)}onInternalKeyDown(e){const t=this;e.key==="Escape"&&(e.stopImmediatePropagation(),t.floating||t.positioned?t.close(!0):t.collapsible&&(t.revealed?t.collapsible.toggleReveal():t.collapse()))}onDocumentMouseDown({event:e}){const t=this,{owner:i}=t,{target:r}=e;if(e.type!=="touchend"&&i!==null&&i!==void 0&&i.isButton&&i._menu===t&&i.element.contains(r))return e.preventDefault(),!1;t.modal&&r===ze.modalMask?(e.preventDefault(),t.modal.closeOnMaskTap?t.close():t.containsFocus||t.focus()):!t.owns(r)&&t.autoClose&&!t.containsFocus&&t.close()}get isTopModal(){return b.isVisible(ze.modalMask)&&this.element.previousElementSibling===ze.modalMask}onFocusIn(e){const t=b.getActiveElement(this);super.onFocusIn(e),b.getActiveElement(this)===t&&e.target===this.element&&this.focus()}onFocusOut(e){!(globalThis.visualViewport&&globalThis.visualViewport.height<document.documentElement.clientHeight-1)&&!this.modal&&this.autoClose&&this.close(),super.onFocusOut(e)}onShow(){var e;const t=this;t.autoClose&&t.addDocumentMouseDownListener(),t.focusOnToFront&&t.focus(),(e=super.onShow)===null||e===void 0||e.call(this),t.syncModalMask()}addDocumentMouseDownListener(){this.mouseDownRemover||(this.mouseDownRemover=te.ion({globaltap:"onDocumentMouseDown",thisObj:this}))}updateModal(e){e&&(this.floating=!0)}syncModalMask(){const e=this,{modal:t,element:i}=e;if(i.setAttribute("aria-modal",Boolean(t)),t&&e.isVisible)typeof e._x!="number"&&typeof e._y!="number"&&(e.centered=!0,e.anchor=!1),e.modalMask.classList.remove("b-hide-display"),i.classList.add("b-modal");else if(e.isPainted){i.classList.remove("b-modal");const r=e.floatRoot.querySelectorAll(".b-modal"),n=r.length?ze.fromElement(r[r.length-1],"popup"):null;n?n.syncModalMask():ze.modalMask.classList.add("b-hide-display")}}onHide(){var e,t;const i=this;(e=i.mouseDownRemover)===null||e===void 0||e.call(i),i.mouseDownRemover=null,(t=super.onHide)===null||t===void 0||t.call(this),i.syncModalMask()}onElementUserAction(){this.show()}onHeaderDblClick(){this.maximizable&&this.toggleMaximized()}updateClosable(e){this.tools.close.hidden=!e}updateMaximizable(e){this.tools.maximize.hidden=!e}get modalMask(){const{modalMask:e}=ze;return e.nextElementSibling!==this.element&&this.floatRoot.insertBefore(e,this.element),e}static get modalMask(){return this._modalMask||(this._modalMask=b.createElement({className:"b-modal-mask b-hide-display"}),A.on({element:this._modalMask,wheel:e=>e.preventDefault()})),this._modalMask}}ze.initClass();ze._$name="Popup";const Hg=/^b-icon-/,Ng=/^b-fa-/;class Zr extends k{static get $name(){return"MenuItem"}static get type(){return"menuitem"}static get configurable(){return{checked:null,separator:null,toggleGroup:null,menu:{value:null,$config:["lazy","nullify"]},icon:null,closeParent:null,href:null,target:null,localizableProperties:["text"],role:"menuitem",closeMenuDelay:200}}updateElement(e,t){const i=super.updateElement(e,t);return typeof this.checked=="boolean"&&(this.role="menuitemcheckbox"),this.ariaHasPopup=this.hasMenu?"menu":!1,i}compose(){var e;const t=this,{checked:i,href:r,hasMenu:n,separator:s,target:l,text:o,toggleGroup:a}=t,d=typeof i=="boolean",c=t.icon||(d?"b-fw-icon":""),h=`b-icon-${a?"radio-":""}`,g=typeof o=="object";return{tag:r?"a":"div",tabIndex:-1,href:r,target:l,class:{"b-has-submenu":n,"b-checked":i,"b-separator":s||((e=t.cls)===null||e===void 0?void 0:e["b-separator"])},dataset:{group:t.toggleGroup},[d?"aria-checked":""]:i,[n?"aria-expanded":""]:!1,children:{iconElement:c&&{"aria-hidden":!0,tag:"i",class:F({"b-fa":Ng.test(c),"b-icon":Hg.test(c),"b-menuitem-icon":1,[`${h}checked`]:i===!0,[`${h}unchecked`]:i===!1},q.normalize(c,"object"))},textElement:{tag:"span",html:g?null:o,class:{"b-menu-text":1,"b-menu-custom-content":g},children:g?[o]:null},subMenuIcon:n&&{"aria-hidden":!0,tag:"i",class:{"b-fw-icon":1,"b-icon-sub-menu":1}}}}}doAction(e){const t=this,i=this.parent,r={menu:i,item:t,element:t.element,bubbles:!0};if(typeof t.checked=="boolean"){const n=!t.checked;(!t.toggleGroup||n)&&(t.checked=!t.checked)}t.trigger("beforeItem",r),t.trigger("item",r),t.closeParent&&i&&(i.rootMenu.close(),e&&!t.href&&e.preventDefault())}get focusElement(){return this.element}get contentElement(){return this.textElement}get isFocusable(){const{focusElement:e}=this;return e&&this.isVisible&&(e===document.body||e.offsetParent)}get hasMenu(){return this.hasConfig("menu")}get childItems(){const{_menu:e}=this;return e?[e]:[]}get text(){return this.html}set text(e){this.html=e}onFocusIn(e){super.onFocusIn(e),!this.disabled&&this.menu&&this.delay("openMenu",200)}onFocusOut(e){this.clearTimeout("openMenu"),super.onFocusOut(e),this._menu&&(this.menu.closeTimer=this.menu.setTimeout(()=>this.closeMenu(),this.closeMenuDelay))}openMenu(e){const{menu:t}=this;!this.disabled&&t&&(t.focusOnToFront=e,t.show())}onChildShow(e){super.onChildShow(e),this.ariaElement.setAttribute("aria-expanded",!0)}closeMenu(){this._menu instanceof k&&this.menu.close()}onChildHide(e){super.onChildHide(e),this.ariaElement.setAttribute("aria-expanded",!1)}changeToggleGroup(e){return e&&typeof this.checked!="boolean"&&(this.checked=!1),e}changeChecked(e,t){if(this.isConfiguring||typeof t=="boolean")return Boolean(e)}updateChecked(e){const t=this;t.isConfiguring||(t.toggleGroup&&t.uncheckToggleGroupMembers(),t.element.setAttribute("aria-checked",e),t.trigger("toggle",{menu:t.owner,item:t,element:t.element,bubbles:!0,checked:e}))}getToggleGroupMembers(){const e=this,{checked:t,toggleGroup:i,element:r}=e,n=[];return t&&i&&b.forEachSelector(e.rootElement,`[data-group=${i}]`,s=>{if(s!==r){const l=k.fromElement(s);l&&n.push(l)}}),n}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach(e=>e.checked=!1)}get closeParent(){return(typeof this.checked=="boolean"?this._closeParent:this._closeParent!==!1)&&!this.hasMenu}changeMenu(e,t){const i=this,{constrainTo:r,scrollAction:n}=i.owner;return e&&typeof e=="object"&&!("items"in e)&&!("widgets"in e)&&!("html"in e)&&(e={lazyItems:e}),Ji.reconfigure(t,e,{owner:i,defaults:{type:"menu",align:"s0-e0",anchor:!0,autoClose:!0,autoShow:!1,cls:"b-sub-menu",forElement:i.element,owner:i,ariaLabel:i.text,constrainTo:r,scrollAction:n}})}}Zr.initClass();Zr._$name="MenuItem";const Bg={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1};class Ji extends ze{static get $name(){return"Menu"}static get type(){return"menu"}static get configurable(){return{focusable:!0,align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem",tools:{close:!1},role:"menu",ariaElement:"bodyElement"}}construct(e){Array.isArray(e)&&(e={lazyItems:e}),super.construct(e),A.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",thisObj:this})}afterShow(e){const{items:t,element:i}=this;t.some(s=>Boolean(s._menu))&&i.classList.add("b-menu-with-submenu"),t.some(s=>s.icon)&&i.classList.add("b-menu-with-icon"),super.afterShow(e)}createWidget(e){return typeof e=="string"&&(e={text:e}),super.createWidget(e)}get focusElement(){var e;const t=this,i=(e=t.parentMenu)===null||e===void 0?void 0:e.element.contains(b.getActiveElement(t.parentMenu)),r=t.items[0];return i||b.usingKeyboard||!(r instanceof Zr)?super.focusElement:t.element}onDocumentMouseDown({event:e}){if(!this.parentMenu||!this.parentMenu.owns(e.target))return super.onDocumentMouseDown(...arguments)}hide(e){const t=this;if(super.hide(e),!t.isVisible){var i,r;(i=t.currentSubMenu)===null||i===void 0||(r=i.hide)===null||r===void 0||r.call(i,e),t.parentMenu&&(t.parentMenu.currentSubMenu=null)}}show(){super.show(...arguments);const{parentMenu:e}=this;this.isVisible&&e&&(e.currentSubMenu=this)}onMouseClick(e){const t=e.target.closest(".b-menuitem");t&&this.triggerElement(t,e)}onMouseOver(e){if(this.focusOnHover!==!1){var t;const i=(t=e.relatedTarget)===null||t===void 0?void 0:t.closest(".b-widget"),r=e.target.closest(".b-widget"),n=k.fromElement(r);!b.isTouchEvent&&r&&r!==i&&n.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[n],cancelOutstanding:!0})}}handleMouseOver(e){e.focus()}onMouseEnter(){this.clearTimeout(this.closeTimer)}onMouseLeave(e){const t=this,{relatedTarget:i}=e,r=i&&t.owns(i);let n=i instanceof HTMLElement&&k.fromElement(i),s=!r;if(n){for(;n.ownerCmp;)n=n.ownerCmp;s&=!b.getAncestor(n.element,[e.target])}!r&&s&&(t.currentSubMenu&&!t.currentSubMenu.closeTimer&&t.currentSubMenu.hide(),t.element.contains(b.getActiveElement(t))&&b.getActiveElement(t).matches(".b-menuitem")&&t.focusElement.focus())}onInternalKeyDown(e){const t=k.fromElement(e),i=t&&t!==this&&!(t instanceof Zr);if(e.key==="Escape"){(i?this:this.rootMenu).close();return}if(super.onInternalKeyDown(e),i)return;Bg[e.key]&&e.preventDefault();const r=this.element,n=b.getActiveElement(r);this.navigateFrom(n!==r&&r.contains(n)?n:null,e.key,e)}navigateFrom(e,t,i){const r=this,{treeWalker:n}=r,s=e&&r.getItem(e),l=r.rtl?"ArrowLeft":"ArrowRight",o=r.rtl?"ArrowRight":"ArrowLeft";let a;switch(t){case"ArrowUp":n.currentNode=e||(e=r.bottomFocusTrap),n.previousNode(),a=n.currentNode;break;case"ArrowDown":n.currentNode=e||(e=r.topFocusTrap),n.nextNode(),a=n.currentNode;break;case" ":e&&!e.classList.contains("b-disabled")&&(s!=null&&s.menu?r.openSubMenu(e,s):r.triggerElement(e,i));break;case l:if(e&&s!==null&&s!==void 0&&s.menu&&!e.classList.contains("b-disabled")){const d=r.openSubMenu(e,s);d?.focus()}else n.currentNode=e||(e=r.topFocusTrap),n.nextNode(),a=n.currentNode;break;case o:r.isSubMenu?r.hide():e||(n.currentNode=e||(e=r.topFocusTrap),n.nextNode(),a=n.currentNode);break;case"Enter":e&&!e.classList.contains("b-disabled")&&r.triggerElement(e,i);break}a&&(a===r.element?r.navigateFrom(r.bottomFocusTrap,"ArrowUp",i):a===e?r.navigateFrom(r.topFocusTrap,"ArrowDown",i):a.focus())}getItem(e){if(e!=null)return typeof e=="number"?this.items[e]:e.nodeType===Element.ELEMENT_NODE?k.fromElement(e,"menuitem",this.contentElement):this.items.find(t=>t.id==e)}triggerElement(e,t){const i=this.getItem(e);i&&!i.disabled&&i.doAction(t)}get isSubMenu(){var e;return this===((e=this.owner)===null||e===void 0?void 0:e.menu)}openSubMenu(e,t){const i=this,r=t.menu;if(r){if(!r.isVisible){var n;const s={item:t,element:e};if(i.trigger("beforeSubMenu",s)===!1||((n=t.onBeforeSubMenu)===null||n===void 0?void 0:n.call(t,s))===!1)return;r.show()}return i.currentSubMenu=r}}set selectedElement(e){const t=this,i=t._selectedElement;if(i){const r=t.getItem(i),n=r?.menu;n?.hide(),i.classList.remove("b-active")}if(t._selectedElement=e,e){const r=b.isFocusable(e);e.classList.add("b-active"),t.scrollable.scrollIntoView(e,{animate:!r,focus:r})}}get selectedElement(){return this._selectedElement}selectFirst(){const e=this.treeWalker;e.currentNode=this.topFocusTrap,e.nextNode(),this.requestAnimationFrame(()=>e.currentNode.focus())}get parentMenu(){var e;const t=this.owner;return t&&(t.isMenu?t:(e=t.up)===null||e===void 0?void 0:e.call(t,"menu"))}get rootMenu(){let e=this;for(;e.parentMenu instanceof this.constructor;)e=e.parentMenu;return e}}Ji.initClass();Ji._$name="Menu";let Pr;class qs extends ee{static get $name(){return"ContextMenuBase"}static get configurable(){return{type:null,menu:{$config:["lazy","nullify"],value:{type:"menu",autoShow:!1,closeAction:"hide",scrollAction:"hide",constrainTo:globalThis}},items:{},triggerEvent:!1,keyMap:{" ":{handler:"showContextMenuByKey",weight:100},"Ctrl+Space":"showContextMenuByKey"}}}static get pluginConfig(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick"]}}construct(...e){var t;if(super.construct(...e),!((t=this.type)!==null&&t!==void 0&&t.length))throw new Error("Config 'type' is required to be specified for context menu")}onElementContextMenu(e){this.onElementEvent(e)}onElementClick(e){this.onElementEvent(e)}onElementDblClick(e){this.onElementEvent(e)}onElementEvent(e){if(e.ctrlKey===!0){e.preventDefault();return}if(!e.handled&&this.triggerEvent===e.type){const t=e;if(Pr){const{target:i}=Pr;e=A.fixEvent(new MouseEvent(e.type,e)),Object.defineProperty(e,"target",{get:()=>i,configurable:!0}),e.preventDefault=function(){t.preventDefault(),t.handled=!0}}this.internalShowContextMenu(e)}}showContextMenuByKey(e){if(!b.isEditable(e.target)){const t=this.getKeyboardContextMenuTarget(e.target);if(t)return Pr=e,b.triggerMouseEvent(t,this.triggerEvent),e.handled=!0,e.preventDefault(),e.stopImmediatePropagation(),Pr=null,!0}return!1}getKeyboardContextMenuTarget(e){const t=b.isInView(e);return e.children.length?b.childFromPoint(e,t.width/2,t.height/2):e}internalShowContextMenu(e){const t=this;if(t.disabled)return;const i=t.getDataFromEvent(e);!e.handled&&i&&t.shouldShowMenu(i)&&(e.type==="contextmenu"&&W.isSafari&&e.ctrlKey&&!e.metaKey&&A.on({element:e.target,capture:!0,once:!0,thisObj:this,click(r){r.preventDefault(),r.stopImmediatePropagation()}}),i.domEvent=e,t.showContextMenu(i))}getDataFromEvent(e){return{event:e,targetElement:this.getTargetElementFromEvent(e)}}getTargetElementFromEvent(e){return e.target}showContextMenu(e,t){var i;const r=this,n=b.isDOMEvent(e),s=n?r.getDataFromEvent(e):e,l=n?e:s.domEvent;if((i=r._menu)===null||i===void 0||i.hide(),r.disabled)return;r.menuContext=s;const{type:o,client:a,processItems:d}=r,c=b.isInView(s.targetElement).center;if(N.assign(s,{feature:r,point:l!=null&&l.clientX?[l.clientX+1,l.clientY+1]:[c.x,c.y],menu:r,items:{},selection:a.selectedRecords}),r.callChainablePopulateMenuMethod(s),N.merge(s.items,r.baseItems),r.preventDefaultEvent(s),(!d||r.callback(d,a,[s])!==!1)&&r.hasActiveMenuItems(s)&&(r.populateItemsWithData(s),r.beforeContextMenuShow(s)!==!1)){const{menu:g}=r;if(a.trigger(`${o}MenuBeforeShow`,s)!==!1){var h;g.items=s.items,g.showBy(t||s.point),(h=r.touchMoveDetacher)===null||h===void 0||h.call(r),r.touchMoveDetacher=A.on({element:a.element,touchmove:()=>g.hide(),thisObj:g,once:!0}),l&&(l.preventDefault(),l.handled=!0)}}}get baseItems(){if(!this._baseItems){const e=this,{namedItems:t}=e,i=e._baseItems=N.assign({},e.items);for(const r in i){const n=i[r];n&&(t&&r in t?i[r]=typeof n=="object"?N.merge(N.clone(t[r]),n):t[r]:n===!0&&delete i[r])}}return this._baseItems}hideContextMenu(e){var t;(t=this.menu)===null||t===void 0||t.hide(e)}callChainablePopulateMenuMethod(e){var t,i;(t=(i=this.client)[`populate${_.capitalize(this.type)}Menu`])===null||t===void 0||t.call(i,e)}hasActiveMenuItems(e){return Object.values(e.items).some(t=>t&&!t.hidden)}shouldShowMenu(){return!0}beforeContextMenuShow(e){}populateItemsWithData(e){}preventDefaultEvent(e){var t;(t=e.event)===null||t===void 0||t.preventDefault()}changeTriggerEvent(e){return e||this.client.contextMenuTriggerEvent}changeMenu(e,t){const i=this,{client:r,type:n}=i;if(e)return Ji.reconfigure(t,e?Ji.mergeConfigs({owner:r,rootElement:r.rootElement,onItem(s){r.trigger(`${n}MenuItem`,s)},onToggle(s){r.trigger(`${n}MenuToggleItem`,s)},onDestroy(){i.menu=null},onBeforeItem(s){Object.assign(s,i.menuContext)},onShow({source:s}){i.menuContext.menu=s,r.trigger(`${n}MenuShow`,i.menuContext)}},e):null,i);t!=null&&t.isWidget&&t.destroy()}}qs._$name="ContextMenuBase";var Vg=u=>class extends(u||$){static get $name(){return"DragHelperContainer"}initContainerDrag(){const t=this;if(t.mode||(t.mode="container"),t.mode==="container"&&!t.containers)throw new Error("Container drag mode must specify containers")}grabContainerDrag(t){const i=this;if(!i.ignoreSelector||!t.target.closest(i.ignoreSelector)){const r=b.getAncestor(t.target,i.containers,i.outerElement);if(r){const n=r.getBoundingClientRect();i.context={element:r,valid:!0,action:"container",offsetX:t.pageX-n.left,offsetY:t.pageY-n.top,originalPosition:{parent:r.parentElement,prev:r.previousElementSibling,next:r.nextElementSibling}}}return!0}return!1}startContainerDrag(t){var i;const r=this,{context:n,floatRootOwner:s}=r,{element:l}=n,o=l.cloneNode(!0),a=l.getBoundingClientRect(),d=s?.element.closest(".b-outer");o.classList.add(r.dragProxyCls),o.classList.add(r.draggingCls),(s?.floatRoot||b.getRootElement(l)).appendChild(o),n.dragProxy=o,o.style.width=a.width+"px",o.style.height=a.height+"px",b.setTranslateXY(n.dragProxy,a.left,a.top),n.dragging=l,l.classList.add(r.dropPlaceholderCls),d!=null&&(i=d.parentElement)!==null&&i!==void 0&&i.matches(".b-float-root")&&(o.style.zIndex=s.floatRootMaxZIndex+1)}updateContainerDrag(t){var i;const r=this,{context:n}=r;if(!n.started||!n.targetElement)return;const s=b.getAncestor(n.targetElement,r.containers,"b-gridbase"),l=(i=n.dragging)===null||i===void 0?void 0:i.contains(b.getActiveElement(n.dragging));s&&b.isDescendant(n.element,s)||(l&&te.suspendFocusEvents(),s&&n.valid?r.moveNextTo(s,t):r.revertPosition(),l&&te.resumeFocusEvents(),t.preventDefault())}finishContainerDrag(t){const i=this,{context:r}=i,{dragging:n,dragProxy:s,valid:l,draggedTo:o,insertBefore:a,originalPosition:d}=r;n&&(r.valid=l&&o&&(n!==a||d.parent!==o),r.finalize=(c=r.valid)=>{!c&&i.context&&i.revertPosition(),n.classList.remove(i.dropPlaceholderCls),s.remove(),i.reset()},r.async=!1,i.trigger("drop",{context:r,event:t}),r.async||r.finalize())}abortContainerDrag(t=!1,i=null,r=!1){const n=this,{context:s}=n;s.dragging&&(s.dragging.classList.remove(n.dropPlaceholderCls),s.dragProxy.remove(),n.revertPosition()),r||n.trigger(t?"drop":"abort",{context:s,event:i}),n.reset()}updateContainerProxy(t){const i=this,{context:r}=i,n=r.dragProxy;let s=t.pageX-r.offsetX,l=t.pageY-r.offsetY;typeof i.minX=="number"&&(s=Math.max(i.minX,s)),typeof i.maxX=="number"&&(s=Math.min(i.maxX-n.offsetWidth,s)),typeof i.minY=="number"&&(l=Math.max(i.minY,l)),typeof i.maxY=="number"&&(l=Math.min(i.maxY-n.offsetHeight,l)),i.lockX?b.setTranslateY(n,l):i.lockY?b.setTranslateX(n,s):b.setTranslateXY(n,s,l);let o;if(t.type==="touchmove"){const a=t.changedTouches[0];o=b.elementFromPoint(a.clientX,a.clientY)}else o=t.target;r.targetElement=o}moveNextTo(t,i){const{context:r}=this,n=r.dragging,s=t.parentElement;if(t!==n){const l=O.from(t).center.x;this.isRTL&&i.pageX>l||!this.isRTL&&i.pageX<l?(s.insertBefore(n,t),r.insertBefore=t):t.nextElementSibling?t.nextElementSibling!==n?(r.insertBefore=t.nextElementSibling,s.insertBefore(n,t.nextElementSibling)):!r.insertBefore&&n.parentElement.lastElementChild!==n&&(r.insertBefore=t.nextElementSibling):(s.appendChild(n),r.insertBefore=null),r.draggedTo=s}}revertPosition(){const{context:t}=this,{dragging:i}=t,{parent:r,next:n}=t.originalPosition;n?n.previousSibling===i||!n&&i===r.lastChild||r.insertBefore(i,n):r.appendChild(i),t.draggedTo=null}};const zg={pageXOffset:0,pageYOffset:0};var Wg=u=>class extends Se(u||$){static get $name(){return"DragHelperTranslate"}static get configurable(){return{positioning:null,skipUpdatingElement:null}}initTranslateDrag(){const t=this;!t.isElementDraggable&&t.targetSelector&&(t.isElementDraggable=i=>i.closest(t.targetSelector))}grabTranslateDrag(t){const i=this.getTarget(t);return i?(this.context={valid:!0,element:i,startPageX:t.pageX,startPageY:t.pageY,startClientX:t.clientX,startClientY:t.clientY},!0):!1}getTarget(t){return t.target.closest(this.targetSelector)}getX(t){return this.positioning==="absolute"?parseFloat(t.style.left,10):b.getTranslateX(t)}getY(t){return this.positioning==="absolute"?parseFloat(t.style.top,10):b.getTranslateY(t)}getXY(t){return this.positioning==="absolute"?[t.offsetLeft,t.offsetTop]:b.getTranslateXY(t)}setXY(t,i,r){this.skipUpdatingElement||(this.positioning==="absolute"?(t.style.left=i+"px",t.style.top=r+"px"):b.setTranslateXY(t,i,r))}startTranslateDrag(t){const i=this,{context:r,outerElement:n,proxySelector:s}=i,l=i.dragWithin=i.dragWithin||i.cloneTarget&&document.body;let o=r.dragProxy||r.element;const a=o,d=o.parentElement;if(i.cloneTarget){const c=s?o.querySelector(s):o,{width:h,height:g,x:f,y:m}=O.from(c,l);o=i.createProxy(o);let p=f,v=m;if(i.autoSizeClonedTarget&&(o.style.width=`${h}px`,o.style.height=`${g}px`),o.classList.add(i.dragProxyCls,i.draggingCls),o.classList.remove("b-hover","b-selected","b-focused"),l.appendChild(o),!i.autoSizeClonedTarget||s){const y=o.getBoundingClientRect(),{x:C,y:w}=l.getBoundingClientRect(),S=t.clientX-C,D=t.clientY-w+(l!==document.body?document.body.getBoundingClientRect().y:0);p=S-y.width/2,v=D-y.height/2,r.startPageX=t.pageX,r.startPageY=t.pageY}i.setXY(o,p,v),a.classList.add("b-drag-original"),i.hideOriginalElement&&a.classList.add("b-hidden")}o.classList.add(i.draggingCls),Object.assign(r,{element:o,grabbed:a,grabbedParent:d,grabbedNextSibling:o.nextElementSibling,elementStartX:i.getX(o),elementStartY:i.getY(o),elementX:b.getOffsetX(o,l||n),elementY:b.getOffsetY(o,l||n),scrollX:0,scrollY:0,scrollManagerElementContainsDragProxy:!i.cloneTarget||l===n}),l&&(r.parentElement=o.parentElement,l!==o.parentElement&&l.appendChild(o),i.updateTranslateProxy(t))}onDragStarted(){var t;const i=this,{context:r}=i;let{relatedElements:n}=r;if(i.unifiedProxy&&r.element.classList.add("b-drag-main","b-drag-unified-proxy"),((t=n)===null||t===void 0?void 0:t.length)>0){r.relatedElStartPos=[],r.relatedElDragFromPos=[];const{proxySelector:s}=i;let[l,o]=[r.elementStartX,r.elementStartY];r.originalRelatedElements=n,n=r.relatedElements=n.map((a,d)=>{const c=s?a.querySelector(s):a,{x:h,y:g,width:f,height:m}=O.from(c,i.dragWithin),p=i.cloneTarget?i.createProxy(a):a;return p.classList.add(i.draggingCls),p.classList.remove("b-hover","b-selected","b-focused"),i.cloneTarget&&(i.setXY(p,h,g),i.dragWithin.appendChild(p),p.classList.add(i.dragProxyCls),i.autoSizeClonedTarget&&(p.style.width=`${f}px`,p.style.height=`${m}px`),i.hideOriginalElement&&a.classList.add("b-hidden"),a.classList.add("b-drag-original")),r.relatedElStartPos[d]=r.relatedElDragFromPos[d]=i.getXY(p),i.unifiedProxy&&(p.classList.add("b-drag-unified-animation","b-drag-unified-proxy"),l+=i.unifiedOffset,o+=i.unifiedOffset,i.setXY(p,l,o),r.relatedElDragFromPos[d]=[l,o],p.style.zIndex=100-d),p}),i.unifiedProxy&&n&&n.length>0&&A.onTransitionEnd({element:n[0],property:"transform",handler(){n.forEach(a=>a.classList.remove("b-drag-unified-animation"))},thisObj:i,once:!0})}}applyConstraints(t,i,r){const n=this,{constrain:s,dragWithin:l}=n,{pageXOffset:o,pageYOffset:a}=l===document.body?globalThis:zg;return l&&s&&(i<0&&(i=0),i+t.offsetWidth>l.scrollWidth&&(i=l.scrollWidth-t.offsetWidth),r<0&&(r=0),r+t.offsetHeight>l.scrollHeight&&(r=l.scrollHeight-t.offsetHeight)),typeof n.minX=="number"&&(i=Math.max(n.minX+o,i)),typeof n.maxX=="number"&&(i=Math.min(n.maxX+o,i)),typeof n.minY=="number"&&(r=Math.max(n.minY+a,r)),typeof n.maxY=="number"&&(r=Math.min(n.maxY+a,r)),{constrainedX:i,constrainedY:r}}updateTranslateProxy(t,i){const r=this,{lockX:n,lockY:s,context:l}=r,o=l.dragProxy||l.element,{relatedElements:a,relatedElDragFromPos:d}=l;l.scrollManagerElementContainsDragProxy&&i&&(l.scrollX=i.getRelativeLeftScroll(o),l.scrollY=i.getRelativeTopScroll(o)),l.pageX=t.pageX,l.pageY=t.pageY,l.clientX=t.clientX,l.clientY=t.clientY;let c=l.elementStartX+t.pageX-l.startPageX+l.scrollX,h=l.elementStartY+t.pageY-l.startPageY+l.scrollY;if(r.snapCoordinates){const m=r.snapCoordinates({element:o,newX:c,newY:h});c=m.x,h=m.y}const{constrainedX:g,constrainedY:f}=r.applyConstraints(o,c,h);if((l.started||g!==c||f!==h)&&r.setXY(o,n?void 0:g,s?void 0:f),a){const m=n?0:g-l.elementStartX,p=s?0:f-l.elementStartY;a.forEach((v,y)=>{const[C,w]=d[y];r.setXY(v,C+m,w+p)})}l.newX=g,l.newY=f}async finishTranslateDrag(t){const i=this,r=i.context,{target:n}=t,s=!i.lockX&&Math.round(r.newX)!==Math.round(r.elementStartX),l=!i.lockY&&Math.round(r.newY)!==Math.round(r.elementStartY),o=r.dragProxy||r.element,{relatedElements:a}=r;if(!i.ignoreSamePositionDrop||s||l)if(r.valid===!1)await i.abortTranslateDrag(!0,t);else{const d=!i.allowDropOutside&&O.from(i.dragWithin||i.outerElement);d&&(typeof i.minX!="number"&&i.minX!==!0&&t.pageX<d.left||typeof i.maxX!="number"&&i.maxX!==!0&&t.pageX>d.right||typeof i.minY!="number"&&i.minY!==!0&&t.pageY<d.top||typeof i.maxY!="number"&&i.maxY!==!0&&t.pageY>d.bottom)?(r.valid=!1,await i.abortTranslateDrag(!0,t)):(r.finalize=async(c=r.valid)=>{if(r.finalized){console.warn("DragHelper: Finalizing already finalized drag");return}r.finalized=!0,!c&&i.context&&await i.abortTranslateDrag(!0,null,!0),i.isDestroyed||(i.trigger("dropFinalized",{context:r,event:t,target:n}),i.reset()),!i.cloneTarget&&o.parentElement!==r.grabbedParent&&[o,...a||[]].forEach(h=>h.style.transform="")},r.async=!1,await i.trigger("drop",{context:r,event:t,target:n}),r.async||await r.finalize())}else i.abortTranslateDrag(!1,t)}async abortTranslateDrag(t=!1,i=null,r=!1){var n,s;const l=this,{cloneTarget:o,context:a,proxySelector:d,dragWithin:c,draggingCls:h}=l,{relatedElements:g,relatedElStartPos:f,grabbed:m}=a,p=a.dragProxy||a.element;if((n=l.scrollManager)===null||n===void 0||n.stopMonitoring(),a.aborted){console.warn("DragHelper: Aborting already aborted drag");return}let{elementStartX:v,elementStartY:y}=a;if(p&&a.started){if(!o&&c&&c!==a.grabbedParent&&a.grabbedParent.insertBefore(p,a.grabbedNextSibling),o&&d){const C=m.querySelector(d)||m,{x:w,y:S}=O.from(C);v=w,y=S}p.classList.add("b-aborting"),l.setXY(p,v,y),g?.forEach((C,w)=>{C.classList.remove(h),C.classList.add("b-aborting"),l.setXY(C,f[w][0],f[w][1])}),r||l.trigger(t?"drop":"abort",{context:a,event:i}),!b.isOrphaned(p)&&!l.isDestroying&&await A.waitForTransitionEnd({element:p,property:b.getPropertyTransitionDuration(p,"transform")?"transform":"all",thisObj:l,once:!0,runOnDestroy:!0}),l.isDestroyed||l.trigger("abortFinalized",{context:a,event:i})}(s=l.context)!==null&&s!==void 0&&s.started&&l.reset()}cleanUp(){const t=this,{context:i,cloneTarget:r,draggingCls:n,dragProxyCls:s}=t,l=i.dragProxy||i.element,{relatedElements:o,originalRelatedElements:a,grabbed:d}=i,c=r&&(t.removeProxyAfterDrop||!i.valid),h=[n,"b-aborting",s,"b-drag-main","b-drag-unified-proxy"];l.classList.remove(...h),c&&l.remove(),o?.forEach(g=>{c?g.remove():g.classList.remove(...h)}),d.classList.remove("b-drag-original","b-hidden"),a?.forEach(g=>g.classList.remove("b-hidden","b-drag-original"))}};const ei={move:"onMouseMove",up:"onMouseUp",docclick:"onDocumentClick",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",keydown:"onKeyDown"};class Ks extends $.mixin(Me,Vg,Wg){static get defaultConfig(){return{dragProxyCls:"b-drag-proxy",invalidCls:"b-drag-invalid",draggingCls:"b-dragging",dropPlaceholderCls:"b-drop-placeholder",dragThreshold:5,outerElement:document.body,dragWithin:null,unifiedProxy:null,monitoringConfig:null,constrain:!0,minX:null,maxX:null,minY:null,maxY:null,mode:"translateXY",isElementDraggable:null,targetSelector:null,dropTargetSelector:null,dropTargetCls:null,proxySelector:null,cloneTarget:!1,autoSizeClonedTarget:!0,hideOriginalElement:!1,containers:null,ignoreSelector:null,startEvent:null,lockX:!1,lockY:!1,touchStartDelay:300,scrollManager:null,snapCoordinates:null,unifiedOffset:5,removeProxyAfterDrop:!0,clickSwallowDuration:50,ignoreSamePositionDrop:!0,allowDropOutside:null,floatRootOwner:null,mouseMoveListenerElement:document,testConfig:{transitionDuration:10,clickSwallowDuration:50,touchStartDelay:100},rtlSource:null,createProxy:null}}construct(e){const t=this;super.construct(e),t.initListeners(),t.isContainerDrag?t.initContainerDrag():t.initTranslateDrag(),t.onScrollManagerScrollCallback=t.onScrollManagerScrollCallback.bind(t)}doDestroy(){this.reset(!0),super.doDestroy()}initListeners(){const e=this,{outerElement:t}=e,i={element:t,pointerdown:"onPointerDown",thisObj:e};e.mouseMoveListenerElement=e.getMouseMoveListenerTarget(t),A.on(i)}getMouseMoveListenerTarget(e){const t=e.getRootNode();let i=this.mouseMoveListenerElement;return t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&t.mode==="closed"&&(i=e.closest(".b-outer")||i),i}get isRTL(){var e;return Boolean((e=this.rtlSource)===null||e===void 0?void 0:e.rtl)}onPointerDown(e){const t=this;if(e.button!==0||!b.isVisible(e.target)||t.context||t.isElementDraggable&&!t.isElementDraggable(e.target,e))return;if(t.startEvent=e,t.isContainerDrag?t.grabContainerDrag(e):t.grabTranslateDrag(e)){t.blurDetacher=A.on({element:globalThis,blur:t.onWindowBlur,thisObj:t});const r={element:t.mouseMoveListenerElement,thisObj:t,capture:!0,keydown:ei.keydown};if(e.pointerType==="touch"?(t.touchStartTimer=t.setTimeout(()=>t.touchStartTimer=null,t.touchStartDelay,"touchStartDelay"),r.touchmove={handler:ei.touchmove,passive:!1},r.touchend=r.pointerup=ei.touchend):(r.pointermove=ei.move,r.pointerup=ei.up),t.dragListenersDetacher=A.on(r),t.dragWithin&&t.dragWithin!==t.outerElement&&t.outerElement.contains(t.dragWithin)){const n=O.from(t.dragWithin,t.outerElement);t.minY=n.top,t.maxY=n.bottom,t.minX=n.left,t.maxX=n.right}}}internalMove(e){var t;if(e.scrollInitiated)return;const i=this,{context:r}=i,n=A.getDistanceBetween(i.startEvent,e);if(i.touchStartTimer&&n>i.dragThreshold){i.abort(!0);return}if(!i.touchStartTimer&&r!==null&&r!==void 0&&r.element&&(r.started||n>=i.dragThreshold)&&((t=e.target)===null||t===void 0?void 0:t.nodeType)===Node.ELEMENT_NODE){if(!r.started){var l,o;if(i.trigger("beforeDragStart",{context:r,event:e})===!1)return i.abort();i.isContainerDrag?i.startContainerDrag(e):i.startTranslateDrag(e),r.started=!0,(l=i.scrollManager)===null||l===void 0||l.startMonitoring(x.merge({scrollables:[{element:i.dragWithin||i.outerElement}],callback:i.onScrollManagerScrollCallback},i.monitoringConfig)),r.outermostEl=b.getOutermostElement(e.target),r.outermostEl.classList.add("b-draghelper-active"),i.dropTargetSelector&&i.dropTargetCls&&b.getRootElement(i.outerElement).querySelectorAll(i.dropTargetSelector).forEach(a=>a.classList.add(i.dropTargetCls)),i.trigger("dragStart",{context:r,event:e}),(o=i.onDragStarted)===null||o===void 0||o.call(i),i.trigger("afterDragStart",{context:r,event:e})}i.update(e),e.type==="touchmove"&&(e.preventDefault(),e.stopImmediatePropagation())}}onScrollManagerScrollCallback(e){var t;const{lastMouseMoveEvent:i}=this;(t=this.context)!==null&&t!==void 0&&t.element&&i&&(i.isScroll=!0,this.update(i,e))}onTouchMove(e){this.internalMove(e)}onMouseMove(e){this.internalMove(e)}update(e,t){const i=this,{context:r}=i,n=document.scrollingElement||document.body;let s=i.getMouseMoveEventTarget(e);if(e.type==="touchmove"){const a=e.changedTouches[0];s=b.elementFromPoint(a.clientX+n.scrollLeft,a.clientY+n.scrollTop)}r.target=s;let l=i.allowDropOutside||!i.dragWithin||i.dragWithin.contains(e.target);if(l&&i.dropTargetSelector){var o;l=l&&Boolean((o=s)===null||o===void 0?void 0:o.closest(i.dropTargetSelector))}i.isContainerDrag?i.updateContainerProxy(e,t):i.updateTranslateProxy(e,t),r.valid=l,i.trigger("drag",{context:r,event:e}),i.isContainerDrag&&i.updateContainerDrag(e,t),r.valid=r.valid&&l;for(const a of i.draggedElements)a.classList.toggle(i.invalidCls,!r.valid);e&&(i.lastMouseMoveEvent=e)}get draggedElements(){var e;const{context:t}=this;return[t.dragProxy||t.element,...(e=t.relatedElements)!==null&&e!==void 0?e:[]]}async abort(e=!1){var t,i;const r=this,{context:n}=r;(t=r.scrollManager)===null||t===void 0||(i=t.stopMonitoring)===null||i===void 0||i.call(t),r.removeListeners(),n!=null&&n.started&&!n.aborted?(n.element.getBoundingClientRect(),n.valid=!1,r.isContainerDrag?r.abortContainerDrag(void 0,void 0,e):r.abortTranslateDrag(void 0,void 0,e),n.aborted=!0):r.reset(!0)}removeListeners(){var e,t;(e=this.dragListenersDetacher)===null||e===void 0||e.call(this),(t=this.blurDetacher)===null||t===void 0||t.call(this)}reset(e){const t=this,{context:i}=t;if(i!=null&&i.started){for(const r of t.draggedElements)r.classList.remove(t.invalidCls);i.outermostEl.classList.remove("b-draghelper-active"),t.isContainerDrag?i.dragProxy.remove():t.cleanUp(),t.dropTargetSelector&&t.dropTargetCls&&b.getRootElement(t.outerElement).querySelectorAll(t.dropTargetSelector).forEach(r=>r.classList.remove(t.dropTargetCls))}t.removeListeners(),e||t.trigger("reset"),t.context=t.lastMouseMoveEvent=null}onTouchEnd(e){this.onMouseUp(e)}onDocumentClick(e){e.stopPropagation()}onMouseUp(e){const t=this,{context:i}=t;if(t.removeListeners(),i){var r;(r=t.scrollManager)===null||r===void 0||r.stopMonitoring(),i.started?(e.stopPropagation(),i.finalizing=!0,t.isContainerDrag?t.finishContainerDrag(e):t.finishTranslateDrag(e),A.on({element:document,thisObj:t,click:ei.docclick,capture:!0,expires:t.clickSwallowDuration,once:!0})):t.reset(!0)}}onKeyDown(e){var t;(t=this.context)!==null&&t!==void 0&&t.started&&e.key==="Escape"&&(e.stopImmediatePropagation(),this.abort())}onWindowBlur(){this.context&&!this.context.finalizing&&this.abort()}createProxy(e){this.proxySelector&&(e=e.querySelector(this.proxySelector)||e);const t=e.cloneNode(!0);return t.removeAttribute("id"),t}get isContainerDrag(){return this.mode==="container"}async animateProxyTo(e,t={align:"c-c"}){const{context:i,draggedElements:r}=this,{element:n}=i,s=e.isRectangle?e:O.from(e);r.forEach(l=>{l.classList.add("b-drag-final-transition"),b.alignTo(l,s,t)}),await A.waitForTransitionEnd({element:n,property:"all",thisObj:this,once:!0}),r.forEach(l=>l.classList.remove("b-drag-final-transition"))}get isDragging(){var e;return Boolean((e=this.context)===null||e===void 0?void 0:e.started)}getMouseMoveEventTarget(e){return e.isScroll?b.elementFromPoint(e.clientX,e.clientY):e.target}}Ks._$name="DragHelper";const ht={down:"onMouseDown",move:"onMouseMove",up:"onMouseUp",docclick:"onDocumentClick",touchstart:{handler:"onTouchStart",passive:!1},touchmove:"onTouchMove",touchend:"onTouchEnd",keydown:"onKeyDown"};class Xs extends Me($){static get defaultConfig(){return{resizingCls:"b-resizing",dragThreshold:5,handleSize:10,dynamicHandleSize:null,reservedSpace:10,touchHandleSize:30,minWidth:1,maxWidth:0,minHeight:1,maxHeight:0,outerElement:document.body,scroller:null,allowResize:null,dragWithin:null,isElementResizable:null,targetSelector:null,leftHandle:!0,rightHandle:!0,topHandle:!0,bottomHandle:!0,handleSelector:null,handleContainerSelector:null,startEvent:null,grab:null,invalidCls:"b-resize-invalid",handleVisibilityThreshold:null,skipTranslate:!1,direction:"horizontal",clickSwallowDuration:50,rtlSource:null}}construct(e){const t=this;super.construct(e),!t.handleSelector&&!W.isHoverableDevice&&(t.handleSize=t.touchHandleSize),t.handleVisibilityThreshold=t.handleVisibilityThreshold||2*t.handleSize,t.initListeners(),t.initResize()}doDestroy(){this.abort(!0),super.doDestroy()}updateSkipUpdatingElement(e){e&&(this.skipTranslate=!0)}initResize(){const e=this;if(!e.isElementResizable&&e.targetSelector&&(e.isElementResizable=t=>t.closest(e.targetSelector)),e.grab){const{edge:t,element:i,event:r}=e.grab;e.startEvent=r;const n=e.getCursorOffsetToElementEdge(r,i,t);e.context={element:i,edge:t,valid:!0,async:!1,elementStartX:b.getTranslateX(i)||i.offsetLeft,elementStartY:b.getTranslateY(i)||i.offsetTop,newX:b.getTranslateX(i)||i.offsetLeft,newY:b.getTranslateY(i)||i.offsetTop,elementWidth:i.offsetWidth,elementHeight:i.offsetHeight,cursorOffset:n,startX:r.clientX+n.x+e.scrollLeft,startY:r.clientY+n.y+e.scrollTop,finalize:()=>{var s;return(s=e.reset)===null||s===void 0?void 0:s.call(e)}},i.classList.add(e.resizingCls),e.internalStartResize(e.isTouch)}}initListeners(){const e=this,t={element:e.outerElement,mousedown:ht.down,touchstart:ht.touchstart,thisObj:e};!e.handleSelector&&W.isHoverableDevice&&(t.mousemove={handler:ht.move,delegate:e.targetSelector},t.mouseleave={handler:"onMouseLeaveTarget",delegate:e.targetSelector,capture:!0}),A.on(t)}get isRTL(){var e;return Boolean((e=this.rtlSource)===null||e===void 0?void 0:e.rtl)}get scrollLeft(){return this.scroller?this.scroller.x:this.outerElement.scrollLeft}get scrollTop(){return this.scroller?this.scroller.y:this.outerElement.scrollTop}internalStartResize(e){const t={element:document,keydown:ht.keydown,thisObj:this};e?(t.touchmove=ht.touchmove,t.touchend=t.pointerup=ht.touchend):(t.mousemove=ht.move,t.mouseup=ht.up),this.removeDragListeners=A.on(t)}removeDragListeners(){}reset(){var e;(e=this.removeDragListeners)===null||e===void 0||e.call(this),this.context=null,this.trigger("reset")}canResize(e,t){return!this.isElementResizable||this.isElementResizable(e,t)}onPointerDown(e,t){const i=this;i.startEvent=t,i.canResize(t.target,t)&&i.grabResizeHandle(e,t)&&(t.stopImmediatePropagation(),t.type==="touchstart"&&t.preventDefault(),i.internalStartResize(e))}onTouchStart(e){e.touches.length>1||this.onPointerDown(!0,e)}onMouseDown(e){e.button===0&&this.onPointerDown(!1,e)}internalMove(e,t){const i=this,{context:r,direction:n}=i;if(r!=null&&r.element&&(r.started||A.getDistanceBetween(i.startEvent,t)>=i.dragThreshold)){if(!r.started){var s;(s=i.scrollManager)===null||s===void 0||s.startMonitoring(x.merge({scrollables:[{element:i.dragWithin||i.outerElement,direction:n}],callback:l=>{var o;return((o=i.context)===null||o===void 0?void 0:o.element)&&i.lastMouseMoveEvent&&i.update(i.lastMouseMoveEvent,l)}},i.monitoringConfig)),i.trigger("resizeStart",{context:r,event:t}),r.started=!0}i.update(t)}else!e&&!i.handleSelector&&i.checkResizeHandles(t)}onTouchMove(e){this.internalMove(!0,e)}onMouseMove(e){this.internalMove(!1,e)}onPointerUp(e,t){var i;const r=this,n=r.context;if((i=r.removeDragListeners)===null||i===void 0||i.call(r),n){var s;(s=r.scrollManager)===null||s===void 0||s.stopMonitoring(),n.started&&A.on({element:document,thisObj:r,click:ht.docclick,expires:r.clickSwallowDuration,capture:!0,once:!0}),r.finishResize(t)}else{var l;(l=r.reset)===null||l===void 0||l.call(r)}}onTouchEnd(e){this.onPointerUp(!0,e)}onMouseUp(e){this.onPointerUp(!1,e)}onDocumentClick(e){e.stopPropagation()}onKeyDown(e){e.key==="Escape"&&this.abort()}update(e){const t=this,i=t.context,r=O.from(t.outerElement);i.currentX=Math.max(Math.min(e.clientX+i.cursorOffset.x,r.right),r.x)+t.scrollLeft,i.currentY=Math.max(Math.min(e.clientY+i.cursorOffset.y,r.bottom),r.y)+t.scrollTop,e&&(t.updateResize(e)&&(t.trigger("resizing",{context:i,event:e}),i.element.classList.toggle(t.invalidCls,i.valid===!1)),t.lastMouseMoveEvent=e)}abort(e=!1){var t,i;const r=this;(t=r.scrollManager)===null||t===void 0||(i=t.stopMonitoring)===null||i===void 0||i.call(t),r.context?r.abortResize(null,e):r.isDestroyed||r.reset()}grabResizeHandle(e,t){const i=this;if(i.allowResize&&!i.allowResize(t.target,t))return!1;const r=i.handleSelector,n=t.type==="touchstart"?t.changedTouches[0]:t,s=n.clientX,l=n.clientY,o=i.targetSelector?t.target.closest(i.targetSelector):t.target;if(o){let a;if(r)if(t.target.matches(r))i.direction==="horizontal"?t.pageX<b.getPageX(o)+o.offsetWidth/2?a=i.isRTL?"right":"left":a=i.isRTL?"left":"right":t.pageY<b.getPageY(o)+o.offsetHeight/2?a="top":a="bottom";else return!1;else if(i.direction==="horizontal"?i.overLeftHandle(t,o)?a=i.isRTL?"right":"left":i.overRightHandle(t,o)&&(a=i.isRTL?"left":"right"):i.overTopHandle(t,o)?a="top":i.overBottomHandle(t,o)&&(a="bottom"),!a)return i.context=null,!1;t.type==="touchstart"&&t.preventDefault();const d=i.getCursorOffsetToElementEdge(n,o,a);if(i.trigger("beforeResizeStart",{element:o,event:t})!==!1)return i.context={element:o,edge:a,isTouch:e,valid:!0,async:!1,direction:i.direction,elementStartX:b.getTranslateX(o)||o.offsetLeft,elementStartY:b.getTranslateY(o)||o.offsetTop,newX:b.getTranslateX(o)||o.offsetLeft,newY:b.getTranslateY(o)||o.offsetTop,elementWidth:o.offsetWidth,elementHeight:o.offsetHeight,cursorOffset:d,startX:s+d.x+i.scrollLeft,startY:l+d.y+i.scrollTop,finalize:()=>{var c;return(c=i.reset)===null||c===void 0?void 0:c.call(i)}},o.classList.add(i.resizingCls),!0}return!1}getCursorOffsetToElementEdge(e,t,i){const r=O.from(t);let n=0,s=0;switch(i){case"left":n=r.x-(this.isRTL?r.width:0)-e.clientX;break;case"right":n=r.x+(this.isRTL?0:r.width)-e.clientX;break;case"top":s=r.y-e.clientY;break;case"bottom":s=r.y+r.height-e.clientY;break}return{x:n,y:s}}checkResizeHandles(e){const t=this,i=t.targetSelector?e.target.closest(t.targetSelector):e.target;if(i&&(!t.allowResize||t.allowResize(e.target,e))){if(t.currentElement=t.handleContainerSelector?e.target.closest(t.handleContainerSelector):e.target,t.currentElement){let r;t.direction==="horizontal"?r=t.overLeftHandle(e,i)||t.overRightHandle(e,i):r=t.overTopHandle(e,i)||t.overBottomHandle(e,i),r?t.highlightHandle():t.unHighlightHandle()}}else t.currentElement&&t.unHighlightHandle()}onMouseLeaveTarget(e){const t=this;t.currentElement=t.handleContainerSelector?e.target.closest(t.handleContainerSelector):e.target,t.currentElement&&t.unHighlightHandle()}updateResize(e){const t=this,{context:i,allowEdgeSwitch:r,skipTranslate:n,skipUpdatingElement:s}=t;let l;r&&(t.direction==="horizontal"?i.edge=i.currentX>i.startX?"right":"left":i.edge=i.currentY>i.startY?"bottom":"top");const{element:o,elementStartX:a,elementStartY:d,elementWidth:c,elementHeight:h,edge:g}=i,{style:f}=o,m=i.currentX-i.startX,p=i.currentY-i.startY,v=b.getExtremalSizePX(o,"minWidth")||t.minWidth,y=b.getExtremalSizePX(o,"maxWidth")||t.maxWidth,C=b.getExtremalSizePX(o,"minHeight")||t.minHeight,w=b.getExtremalSizePX(o,"maxHeight")||t.maxHeight,S=g==="right"&&!t.isRTL||g==="bottom"?1:-1,D=c+m*S,I=h+p*S;let R=Math.max(v,D),H=Math.max(C,I);if(y>0&&(R=Math.min(R,y)),w>0&&(H=Math.min(H,w)),f.flex&&(f.flex=""),t.direction==="horizontal"&&c!==R){if(s||(f.width=Math.abs(R)+"px"),i.newWidth=R,g==="left"||R<0){const L=Math.max(Math.min(a+c-t.minWidth,a+m),0);n||b.setTranslateX(o,Math.round(L)),i.newX=L}else g==="right"&&r&&!n&&b.setTranslateX(o,a);l=!0}else t.direction==="vertical"&&h!==I&&(s||(f.height=Math.abs(H)+"px"),i.newHeight=H,g==="top"||H<0?(i.newY=Math.max(Math.min(d+h-t.minHeight,d+p),0),n||b.setTranslateY(o,i.newY)):g==="bottom"&&r&&!n&&b.setTranslateY(o,d),l=!0);return l}finishResize(e){const t=this,i=t.context,r={context:i,event:e};if(i.element.classList.remove(t.resizingCls),i.started){let s=!1;t.direction==="horizontal"?s=i.newWidth&&i.newWidth!==i.elementWidth:s=i.newHeight&&i.newHeight!==i.elementHeight,t.trigger(s?"resize":"cancel",r),i.async||i.finalize()}else{var n;(n=t.reset)===null||n===void 0||n.call(t)}}abortResize(e=null,t=!1){const i=this,r=i.context;r.element.classList.remove(i.resizingCls),i.direction==="horizontal"?((r.edge==="left"||r.allowEdgeSwitch&&!r.skipTranslate)&&b.setTranslateX(r.element,r.elementStartX),r.element.style.width=r.elementWidth+"px"):(b.setTranslateY(r.element,r.elementStartY),r.element.style.height=r.elementHeight+"px"),!t&&i.trigger("cancel",{context:r,event:e}),i.isDestroyed||i.reset()}highlightHandle(){const e=this,t=e.targetSelector?e.currentElement.closest(e.targetSelector):e.currentElement;e.currentElement.classList.add("b-resize-handle"),t.classList.add("b-over-resize-handle")}unHighlightHandle(){const e=this,t=e.targetSelector?e.currentElement.closest(e.targetSelector):e.currentElement;t&&t.classList.remove("b-over-resize-handle"),e.currentElement.classList.remove("b-resize-handle"),e.currentElement=null}overAnyHandle(e,t){return this.overStartHandle(e,t)||this.overEndHandle(e,t)}overStartHandle(e,t){return this.direction==="horizontal"?this.overLeftHandle(e,t):this.overTopHandle(e,t)}overEndHandle(e,t){return this.direction==="horizontal"?this.overRightHandle(e,t):this.overBottomHandle(e,t)}getDynamicHandleSize(e,t){const i=e?2:1,{handleSize:r}=this;return this.dynamicHandleSize&&r*i>t-this.reservedSpace?Math.max(Math.floor((t-this.reservedSpace)/i),0):r}overLeftHandle(e,t){const i=this,{offsetWidth:r}=t;if(i.leftHandle&&i.canResize(t,e)&&(r>=i.handleVisibilityThreshold||i.dynamicHandleSize)){const n=O.from(t);return n.width=i.getDynamicHandleSize(i.rightHandle,r),n.width>0&&n.contains(A.getPagePoint(e))}return!1}overRightHandle(e,t){const i=this,{offsetWidth:r}=t;if(i.rightHandle&&i.canResize(t,e)&&(r>=i.handleVisibilityThreshold||i.dynamicHandleSize)){const n=O.from(t);return n.x=n.right-i.getDynamicHandleSize(i.leftHandle,r),n.width>0&&n.contains(A.getPagePoint(e))}return!1}overTopHandle(e,t){const i=this,{offsetHeight:r}=t;if(i.topHandle&&i.canResize(t,e)&&(r>=i.handleVisibilityThreshold||i.dynamicHandleSize)){const n=O.from(t);return n.height=i.getDynamicHandleSize(i.bottomHandle,r),n.height>0&&n.contains(A.getPagePoint(e))}return!1}overBottomHandle(e,t){const i=this,{offsetHeight:r}=t;if(i.bottomHandle&&i.canResize(t,e)&&(r>=i.handleVisibilityThreshold||i.dynamicHandleSize)){const n=O.from(t);return n.y=n.bottom-i.getDynamicHandleSize(i.bottomHandle,r),n.height>0&&n.contains(A.getPagePoint(e))}return!1}}T(Xs,"configurable",{skipUpdatingElement:null});Xs._$name="ResizeHelper";const ka=/>[ \t\r\n]+</g,jg=/\s\s+/g;class Xe{static tpl(e,...t){let i=0,r=t.map((n,s)=>{let l=e[s];return Array.isArray(n)?l+=n.reduce((o,a)=>o+=(typeof a=="string"?a.trim():a)+`
`,""):(n===void 0&&(n=""),l+=typeof n=="string"?n.trim():n),i++,l}).join("");return i<=e.length&&(r+=e[e.length-1]),r.replace(ka,"><").replace(jg," ").trim()}static docsTpl(e,...t){let i=0,r=t.map((n,s)=>{let l=e[s];return Array.isArray(n)?l+=n.reduce((o,a)=>o+=(typeof a=="string"?a.trim():a)+`
`,""):(n===void 0&&(n=""),l+=typeof n=="string"?n.trim():n),i++,l}).join("");return i<=e.length&&(r+=e[e.length-1]),r.replace(ka,"><").trim()}static repeat(e){return function(...t){return Xe.tpl(...t).repeat(e)}}static loop(e){}}Xe._$name="TemplateHelper";class Gg extends Array{constructor(e,t){super(),this.timeZone=e,this.year=t}}class Ug{constructor(e,t){this.asString=e,this.timeZone=t,this.asArray=qg(e)}get asLocalDate(){return this._asLocalDate||(this._asLocalDate=new Date(...this.asArray)),this._asLocalDate}get asTicksUtc(){return this._asTicksUtc||(this._asTicksUtc=new Date(Date.UTC(...this.asArray)).getTime()),this._asTicksUtc}}const zd=(u,e)=>{const t=u.toLocaleString("sv-SE",{timeZone:e});return new Ug(t,e)},Yg=(u,e)=>{const{asTicksUtc:t,asString:i}=zd(new Date(u),e);return{offset:(u-t)/6e4,tzTicksUtc:t,tzString:i}},qg=u=>{const e=u.split(/[\s-:]/).map(t=>t*1);return e[1]-=1,e},Kg=-6e4,Xg=36e5,La=-864e5,_i=2592e6,Jg=(u,e)=>{const t=Pa.get(u,e);if(t)return t;const i=new Gg(u,e),r=new Date(Date.UTC(e,0,1)).getTime();let n=r,s=_i,l=0,o=[],a=null,d,c,h,g;for(;!g;)({offset:h,tzTicksUtc:d,tzString:c}=Yg(n,u)),a==null?(a=h,i.push({offset:h})):s>0&&h!==a?s=s===_i?La:Kg:s<0&&h===a&&(s===La?s=Xg:(i.length===1?(i.push(o),a=o.offset):(i[0].startTicks=o.startTicks,i[0].startDateString=o.startDateString,g=!0),s=_i)),o={offset:h,startDateString:c,startTicks:d},s===_i&&(n=r,n+=l*_i,l+=1),n+=s,l>11&&(g=!0);return Pa.set(i),i},Pa={_cache:{},get(u,e){var t;return(t=this._cache[u])===null||t===void 0?void 0:t[e]},set(u){const{timeZone:e}=u,{_cache:t}=this;t[e]||(t[e]={}),t[e][u.year]=u}};class Wd{static get $name(){return"TimeZoneHelper"}static toTimeZone(e,t){if(typeof t=="number")return this.toUtcOffset(e,t);const i=zd(e,t);return i.asArray[3]!==i.asLocalDate.getHours()&&console.error("Incorrect transformation due to local dst"),i.asLocalDate}static fromTimeZone(e,t){if(typeof t=="number")return this.fromUtcOffset(e,t);const i=this.dateAsArray(e),r=Jg(t,e.getUTCFullYear());let n=r[0].offset;if(r.length===2){const s=Date.UTC(...i);s>=r[1].startTicks&&s<r[0].startTicks&&(n=r[1].offset)}return i[4]+=n,new Date(Date.UTC(...i))}static toUtcOffset(e,t){const i=e.getTimezoneOffset()+t;return new Date(e.getTime()+i*60*1e3)}static fromUtcOffset(e,t){const i=-e.getTimezoneOffset()-t;return new Date(e.getTime()+i*60*1e3)}static dateAsArray(e){return[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]}}Wd._$name="TimeZoneHelper";class je extends k{static get $name(){return"Toast"}static get type(){return"toast"}static get configurable(){return{testConfig:{destroyTimeout:1,timeout:100},floating:!0,timeout:2500,autoDestroy:null,destroyTimeout:200,showProgress:!0,color:null,bottomMargin:20}}compose(){const{appendTo:e,color:t,html:i,showProgress:r,style:n,timeout:s}=this;return{parent:e||this.floatRoot,class:F(F({},q.normalize(t,"object")),{},{"b-toast-hide":1}),html:i,style:n,children:{progressElement:r&&{style:`animation-duration:${s/1e3}s;`,class:{"b-toast-progress":1}}},listeners:{click:"hide"}}}doDestroy(){this.untoast(),super.doDestroy()}get nextBottom(){const{bottomMargin:e,element:t}=this;return parseInt(t.style.bottom,10)+t.offsetHeight+e}async show(){await super.show(...arguments);const e=this,{element:t}=e,{toasts:i}=je;if(!i.includes(e)){var r,n;t.style.bottom=((r=(n=i[0])===null||n===void 0?void 0:n.nextBottom)!==null&&r!==void 0?r:e.bottomMargin)+"px",i.unshift(e),t.getBoundingClientRect(),t.classList.remove("b-toast-hide"),e.timeout>0&&(e.hideTimeout=e.setTimeout("hide",e.timeout))}}async hide(){const e=this;e.untoast(),e.element.classList.add("b-toast-hide"),e.autoDestroy&&!e.destroyTimer&&(e.destroyTimer=e.setTimeout("destroy",e.destroyTimeout))}untoast(){const{toasts:e}=je;e.includes(this)&&e.splice(e.indexOf(this),1)}static hideAll(){je.toasts.slice().reverse().forEach(e=>e.hide())}static show(e){const t=je.new({autoDestroy:!0,rootElement:document.body},typeof e=="string"?{html:e}:e);return t.show(),t}}je.toasts=[];je.initClass();je._$name="Toast";class lr{static getById(e){return k.getById(e)}static fromElement(e,t,i){return k.fromElement(e,t,i)}static createWidget(e={}){return e.isWidget?e:k.create(e)}static append(e,t){if(e=Array.isArray(e)&&e||[e],(t instanceof HTMLElement||typeof t=="string")&&(t={appendTo:t}),t.insertFirst){const i=typeof t.insertFirst=="string"?document.getElementById(t.insertFirst):t.insertFirst;i.firstChild?t.insertBefore=i.firstChild:t.appendTo=i}return e.map(i=>k.create(x.assign({},t||{},i)))}static openPopup(e,t){return k.create(x.assign({forElement:e},typeof t=="string"?{html:t}:t),"popup")}static showContextMenu(e,t){const i=this;return i.currentContextMenu&&i.currentContextMenu.destroy(),e instanceof HTMLElement?t.forElement=e:Array.isArray(e)?t.forElement={target:new pt(...e)}:e instanceof pt&&(t.forElement={target:e}),i.currentContextMenu=k.create(t,"menu"),i.currentContextMenu.ion({destroy:()=>{i.currentContextMenu=null}}),i.currentContextMenu}static attachTooltip(e,t){return k.attachTooltip(e,t)}static hasTooltipAttached(e){return k.resolveType("tooltip").hasTooltipAttached(e)}static destroyTooltipAttached(e){return k.resolveType("tooltip").destroyTooltipAttached(e)}static mask(e,t="Loading"){if(e)return e instanceof HTMLElement&&(e={target:e,text:t}),Pe.mask(e,e.target)}static unmask(e,t=!0){e.mask&&(t?e.mask.close():e.mask.hide())}static toast(e){return je.show(e)}}lr._$name="WidgetHelper";class Wi{constructor(){this.random100=[46,2,36,46,54,59,18,20,71,55,88,98,13,61,61,40,2,15,3,32,51,45,64,25,81,85,54,13,57,49,64,22,81,94,0,62,17,7,11,2,33,99,85,26,83,83,96,26,20,89,91,38,26,13,11,79,32,30,5,51,70,7,5,56,58,77,37,89,40,80,78,59,26,36,8,51,60,23,86,5,11,96,64,94,87,64,4,78,17,85,35,0,90,86,23,55,53,9,35,59,29,2,64,42,8,49,43,73,6,53,38,9,39,31,32,40,49,13,78,68,20,99,24,78,35,91,73,46,67,76,89,69,30,69,25,3,4,55,1,65,66,76,83,19,67,1,95,24,54,45,56,40,67,92,72,4,69,8,47,50,27,2,38,9,14,83,12,14,62,95,22,47,35,18,38,14,86,64,68,61,52,69,39,93,20,73,32,52,74,6,56,68,99,29,24,92,40,67,6,72,31,41,91,53,80,55,33,97,97,99,18,20,5,27,82,84,61,78,27,67,7,42,75,95,91,25,63,21,70,36,46,0,1,45,84,6,86,15,10,62,96,94,10,23,93,83,94,47,5,29,29,52,51,37,77,96,43,72,43,14,54,14,72,52,4,39,15,26,68,28,25,76,60,50,22,40,72,74,68,58,8,48,40,62,52,24,9,26,47,44,49,96,7,77,90,45,76,47,5,86,1,36,18,42,19,90,34,23,70,32,69,79,0,99,57,80,72,21,19,72,85,68,4,40,86,62,0,63,4,11,69,31,78,31,21,78,29,84,13,53,57,10,26,50,24,30,90,42,51,96,93,21,99,23,81,0,89,43,86,63,93,19,54,71,92,36,4,95,37,99,60,29,23,50,68,95,57,95,77,53,99,78,75,12,92,47,23,14,0,41,98,11,34,64,26,90,50,23,38,31,74,76,16,76,66,23,22,72,48,50,20,36,37,58,5,43,49,64,81,30,8,21,98,75,60,17,50,42,27,38,90,74,45,68,67,27,31,15,58,76,41,99,23,98,53,98,56,19,79,2,4,38,96,24,65,51,43,42,41,60,46,7,90,65,3,27,63,99,51,44,86,1,54,40,15,74,3,81,51,63,87,79,84,72,22,38,96,95,33,41,21,99,21,69,7,49,40,52,41,6,91,19,76,40,54,17,33,11,11,0,1,32,94,33,13,18,45,7,85,61,42,54,45,72,78,96,17,9,80,87,41,96,66,0,8,59,18,21,2,28,64,75,97,32,80,86,97,97,55,2,73,75,11,89,67,58,70,76,12,46,64,17,22,97,25,35,93,57,82,46,57,61,31,74,27,4,32,85,53,86,53,53,42,5,28,50,65,63,70,61,73,37,13,80,7,34,22,3,26,6,62,78,12,56,87,41,58,64,31,27,45,35,18,66,62,43,89,69,94,93,33,74,2,43,85,37,82,41,74,9,15,44,33,42,65,19,1,49,78,12,29,9,78,7,55,12,45,40,33,16,86,14,52,16,73,76,0,98,75,91,78,46,99,95,90,69,78,45,62,55,37,88,49,77,27,83,38,73,39,1,75,40,65,83,54,95,7,73,4,30,26,36,89,21,5,95,11,14,87,45,36,21,77,55,5,66,51,98,48,62,74,58,23,82,30,28,19,53,89,76,98,8,34,70,28,54,16,52,35,93,54,54,72,49,18,93,72,90,71,73,15,60,38,80,76,53,70,39,69,25,5,31,61,46,6,54,34,31,52,33,36,79,76,44,29,28,38,1,66,2,90,91,1,76,78,31,55,37,71,2,3,38,85,0,95,42,2,39,57,87,61,77,98,2,24,80,48,27,47,71,15,7,49,60,86,3,2,29,38,54,36,59,83,27,47,9,36,42,8,73,85,9,16,73,60,39,12,43,25,23,29,28,47,40,77,20,89,22,30,41,59,96,19,56,20,76,73,39,46,72,40,47,37,52,29,79,37,39,50,41,87,66,17,75,31,45,26,88,70,11,90,40,74,9,32,65,72,61,6,93,54,15,84,22,99,47,10,96,4,84,19,85,73,45,25,16,8,94,99,39,28,26,68,87,48,1,65,86,46,86,7,60,82,45,75,38,56,41,35,30,86,91,97,85,45,5,14,69,85,96,37,18,26,16,38,16,1,44,94,85,58,60,20,5,47,52,41,50,71,43,42,67,64,38,65,83,99,78,96,33,20,98,24,6,2,25,16,16,44,63,24,68,56,49,91,15,59,99,27,43,34,28,36,45,1,10,19,54,26,75,17,88,96,63,24,71,93,72,97,66,87,18,86],this.randomCache={},this.rndIndex=0}nextRandom(e){const{randomCache:t}=this;let i;return t[e]?i=t[e]:(i=this.random100.filter(r=>r<e),t[e]=i),i[this.rndIndex++%i.length]}reset(){this.rndIndex=0}fromArray(e){return e[this.nextRandom(e.length)]}randomArray(e,t){const i=[],r=this.nextRandom(t+1),n={};for(let s=0,l=this.nextRandom(e.length);s<r;s++){for(;n[l];)l=this.nextRandom(e.length);n[l]=!0,i.push(e[l])}return i}}Wi._$name="RandomGenerator";const Qg=["Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.","Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.","Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.","Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.","Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.","Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui atione voluptatem sequi nesciunt.","Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.","Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur?","Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?"];class ai{static reset(){this.rnd.reset(),this.rndTime.reset(),this.rndRating.reset()}static*generate(e,t=!1,i=1){let r,n;if(typeof e=="object"){var s;t=e.randomHeight,i=(s=e.initialId)!==null&&s!==void 0?s:1,r=e.addSkills,n=e.rowCallback,e=e.count}const l=this,{rnd:o,rndTime:a,rndRating:d,rndText:c,firstNames:h,surNames:g,teams:f,foods:m,colors:p,cities:v,skills:y}=l;for(let w=0;w<e;w++){var C;const S=o.fromArray(h),D=o.fromArray(g),I=`${S} ${String.fromCharCode(65+w%25)} ${D}`,R=o.nextRandom(60)+1,H=new Date(2019,0,R),L=new Date(2019,0,R+o.nextRandom(30)+2),V={id:i>-1?w+i:void 0,title:"Row "+w,name:I,firstName:S,surName:D,city:o.fromArray(v),team:o.fromArray(v)+" "+o.fromArray(f),age:10+o.nextRandom(80),food:o.fromArray(m),color:o.fromArray(p),score:o.nextRandom(100)*10,rank:o.nextRandom(100)+1,start:H,finish:L,time:E.getTime(a.nextRandom(24),a.nextRandom(12)*5),percent:o.nextRandom(100),done:o.nextRandom(100)<50,rating:d.nextRandom(5),relatedTo:Math.min(e-1,w+i+o.nextRandom(10)),notes:Qg[c.nextRandom(7)+1]};r&&(V.skills=o.randomArray(y,7));const U=(C=n)===null||C===void 0?void 0:C(V);U&&Object.assign(V,U),t&&(V.rowHeight=o.nextRandom(t===!0?20:t)*5+20),yield V}}static generateData(e,t=!1,i=1,r=!0){let n=e;typeof e!="object"&&(n={count:e,randomHeight:t,initialId:i,reset:r}),n.reset!==!1&&this.reset(),ai.overrideRowCount&&(n.count=ai.overrideRowCount);const s=[],l=this.generate(n);for(let o=0;o<n.count;o++)s.push(l.next().value);return s}static generateEvents({viewStartDate:e,viewEndDate:t,nbrResources:i=50,nbrEvents:r=5,dependencies:n,tickUnit:s="days",minDuration:l=2,maxDuration:o=10}){const a=this.generateData(i),d=[];n=[];for(let c=0;c<i;c++)for(let h=0;h<r;h++){const g=E.getDurationInUnit(e,t,s),f=E.add(e,Math.round(Math.random()*.9*g),s),m=Math.round(Math.random()*(o-l))+l,p=E.add(f,m,"days"),v=d.length+1;d.push({id:v,name:this.tasks[(c+h)%(this.tasks.length-1)],startDate:f,duration:m,endDate:p,resourceId:c}),n&&c>0&&n.push({id:n.length+1,from:v-1,to:v})}return{resources:a,events:d,dependencies:n}}static generateRow(){return ai.generateData(1,!1,-1,!1)[0]}}Object.assign(ai,{rnd:new Wi,rndTime:new Wi,rndRating:new Wi,rndText:new Wi,cities:["Stockholm","Barcelona","Paris","Dubai","New York","San Francisco","Washington","Moscow"],firstNames:["Mike","Linda","Don","Karen","Doug","Jenny","Daniel","Melissa","John","Jane","Theo","Lisa","Adam","Mary","Barbara","James","David"],surNames:["McGregor","Ewans","Scott","Smith","Johnson","Adams","Williams","Brown","Jones","Miller","Davis","More","Wilson","Taylor","Anderson","Thomas","Jackson"],teams:["Lions","Eagles","Tigers","Horses","Dogs","Cats","Panthers","Rats","Ducks","Cougars","Hens","Roosters"],foods:["Pancake","Burger","Fish n chips","Carbonara","Taco","Salad","Bolognese","Mac n cheese","Waffles"],colors:["Blue","Green","Red","Yellow","Pink","Purple","Orange","Teal","Black"],skills:["JavaScript","CSS","TypeScript","React","Vue","Angular","Java","PHP","Python","C#","C++","BASIC","COBOL","FORTRAN","PASCAL","SQL"],tasks:["Meetings","Documentation","Email communication","Project management","Budgeting","Marketing and advertising","Customer service","Research and analysis","Data entry","IT support","Employee management","Sales and business development","Event planning","Graphic design","Writing and editing","Presentation","Travel arrangements and expense management","Training and development","Quality assurance","Customer support","Technical writing","Social media management","Translation","Legal research","Data analysis and visualization","Video editing and production","Network admin","Content creation","Market research","Public relations","Teaching and training","Recruiting","Product development"]});ai._$name="DataGenerator";const Zg=["action","target","to","deltaX","deltaY","x","y","text"];class em extends Me(Se()){static get defaultConfig(){return{repeat:!0,outerElement:document.body,callOnFunctions:!0}}construct(e){super.construct(e);const t=this;t.widget&&(t.outerElement=t.widget.element,t.widget.playingDemo=!0),A.playingDemo=!0,Object.assign(t,{prevTarget:null,currentStep:0,mouse:b.createElement({parent:t.outerElement,tag:"div",className:"simulated-mouse"}),timeoutId:null,innerIntervalId:null,mouseOutElements:[]}),t.intervalId=t.setInterval(t.nextStep.bind(t),1e3),t.outerElement.classList.add("b-playing-demo"),t.outerElement.addEventListener("click",i=>{i.isTrusted&&t.abort()})}doDestroy(){this.abort()}abort(e=!1){const t=this;t.mouse.style.top="-100px",t.clearInterval(t.intervalId),t.timeoutId&&t.clearTimeout(t.timeoutId),t.innerIntervalId&&t.clearInterval(t.innerIntervalId),t.outerElement.classList.remove("b-playing-demo"),t.widget&&(t.widget.playingDemo=!1),A.playingDemo=!1,t.trigger(e?"done":"abort")}triggerEvent(e,t,i){if(!e)return null;let r;if(t.startsWith("mouse")){const n=this.mouse.getBoundingClientRect();r=new MouseEvent(t,Object.assign({view:globalThis,bubbles:!0,cancelable:!0,clientX:n.left,clientY:n.top},i||{}))}else r=document.createEvent("Event"),r.initEvent(t,!0,!1);return e.dispatchEvent(r),r}handleMouseMove(e,t){const i=this,r=i.mouse;r.classList.add("quick"),i.mouseDown&&r.classList.add("drag");const n=O.from(r,i.outerElement),s=n.x,l=n.y;let o=0,a=0;if(e.to)if(typeof e.to=="string"){const c=i.outerElement.querySelector(e.to);if(c){const h=O.from(c,i.outerElement),g=h.x+h.width/2,f=h.y+h.height/2;o=(g-s)/10,a=(f-l)/10}}else e.to.x?o=(e.to.x-s)/10:(o=e.to[0]/10,a=e.to[1]/10);else e.deltaX?o=e.deltaX/10:e.x&&(o=(e.x-s)/10);e.deltaY&&(a=e.deltaY/10);let d=0;i.innerIntervalId=i.setInterval(()=>{if(i.shouldPause)return;d++===9&&(clearInterval(i.innerIntervalId),e.then&&e.then());const c=s+o*d,h=l+a*d;r.style.left=c+"px",r.style.top=h+"px";const g=r.getBoundingClientRect(),f=g.left,m=g.top,p=b.elementFromPoint(f,m);p!==i.prevTarget&&(i.prevTarget&&(i.mouseOutElements.push(i.prevTarget),b.isDescendant(i.mouseOutElements[0],p)||(i.mouseOutElements.forEach(v=>i.triggerEvent(v,"mouseout")),i.mouseOutElements.length=0)),i.prevTarget=p,i.triggerEvent(p,"mouseover")),i.triggerEvent(p,e.action,{clientX:f,clientY:m})},50)}getTarget(e){const t=this,i=e.target;return i?typeof i=="function"?i(e):document.querySelector(i):t.prevTarget||t.outerElement}normalizeStep(e){if(e.action)return typeof e.action=="function"?e.action(e):e;if(typeof e=="function")return e(),e;for(const t in e)Object.hasOwnProperty.call(e,t)&&!Zg.includes(t)&&(e.action=t.toLowerCase(),e.to=e[t]);return!e.target&&(typeof e.to=="string"||typeof e.to=="function")&&(e.target=e.to),e}get isScrolling(){const e=this,t=e.outerElement.getBoundingClientRect(),i=e.lastTop&&t.top!==e.lastTop;return e.lastTop=t.top,i}get isInView(){const e=this.outerElement.getBoundingClientRect();return e.top<globalThis.innerHeight&&e.bottom>0}get shouldPause(){return!this.isInView||this.isScrolling||document.hidden||!document.hasFocus()}nextStep(){const e=this;if(e.shouldPause)return;if(e.currentStep===e.steps.length)if(e.repeat)e.currentStep=0;else return e.abort(!0);e.currentStep===0&&e.trigger("initialize");const t=e.mouse,i=e.normalizeStep(e.steps[e.currentStep++]),r=e.getTarget(i),n=i.action;if(r&&n)if(t.className="simulated-mouse",n==="mousemove")e.handleMouseMove(i,r);else{if(r!==e.prevTarget){const s=O.from(r,e.outerElement);t.style.left=s.x+s.width/2+"px",t.style.top=s.y+s.height/2+"px"}n==="mousedown"&&(e.mouseDown=!0),n==="mouseup"&&(e.mouseDown=!1),e.timeoutId=e.setTimeout(()=>{if(e.prevTarget=r,t.classList.add(n),n==="type"){const s=k.fromElement(r),l=i.text.split("|");s.value=l[l.length===1||s.value!=l[0]?0:1]}else e.triggerEvent(r,n)},n==="type"?100:550)}}}em._$name="DemoBot";const Oa=Object.prototype.hasOwnProperty;let fs=null;function tm(u,e){return Object.defineProperty(u,"parser",{value:e}),e}class im{constructor(e){this.formatter=e}format(e){return this.formatter.defaultFormat(e)}parse(e,t){return this.formatter.defaultParse(e,t)}resolvedOptions(){return null}}class Js{static get(e){if(e==null)return this.NULL;if(e instanceof this)return e;const t=typeof e=="string"?e:JSON.stringify(e),i=this.cache;let r=i.get(t);return r||(fs=t,r=new this(e),i.set(t,r)),r}static get cache(){return Oa.call(this,"_cache")&&this._cache||(this._cache=new Map)}static get NULL(){return Oa.call(this,"_null")?this._null:this._null=new this(null)}constructor(e){const t=this;if(t.cacheKey=fs,fs=null,t.initialize(),e===null)t.formatter=new im(t);else{t.configure(e);for(const[i,r]of Object.entries(t.resolvedOptions()))r!=null&&i in t.defaults&&(t[i]=r)}}get parser(){return tm(this,new this.constructor.Parser(this))}defaultFormat(e){return e==null?e:String(e)}defaultParse(e){return e}format(e){return e==null?e:this.formatter.format(e)}parse(e,t){return e==null?e:this.parser.parse(e,t)}parseStrict(e){return this.parse(e,!0)}resolvedOptions(){return this.formatter.resolvedOptions()}}Js._$name="Formatter";class Qi extends $.mixin(Me,hi){static get $name(){return"Navigator"}static get type(){return"navigator"}static get configurable(){return{ownerCmp:null,itemsTabbable:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,activeItem:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,disabled:null,datasetIdProperty:"id",testConfig:{scrollDuration:1}}}static get factoryable(){return{defaultType:"navigator"}}get activeItem(){const{_activeItem:e}=this;if(this.target.contains(e))return e;this._activeItem=null}updateOwnerCmp(e){this.itemSelector||(this.itemSelector=`.${this.ownerCmp.itemCls}`),b.setAttributes(this.keyEventTarget,{"aria-activedescendant":`${this.owner.id}-active-descendant`})}set navigationEvent(e){const{owner:t}=this;this._navigationEvent=t.navigationEvent=e,e&&Promise.resolve(1).then(()=>this.navigationEvent=null)}get navigationEvent(){return this._navigationEvent}static getComposedKeyName(e){const t=(e.key||"").trim()||e.code;return`${e.ctrlKey?"CTRL+":""}${e.shiftKey?"SHIFT+":""}${e.altKey?"ALT+":""}${t}`}onKeyDown(e){const t=this,{ownerCmp:i,itemSelector:r,activeItem:n,itemsTabbable:s}=t,{target:l}=e,o=t.target.querySelector(r),a=(e.key||"").trim()||e.code,d=t.constructor.getComposedKeyName(e),c=l.matches(r)||l===t.keyEventTarget;if(!t.disabled&&t.processEvent&&(e=t.processEvent.call(i,e)),e&&!t.disabled&&o&&t.target.offsetParent&&c){if(!s){if(t.inlineFlow==null){const g=o.parentNode,f=b.getStyleValue(o,"position"),m=b.getStyleValue(o,"display"),p=b.getStyleValue(o,"float");t.inlineFlow=f==="absolute"||m==="inline"||m==="inline-block"||p==="left"||p==="right"||b.getStyleValue(g,"display")==="flex"&&b.getStyleValue(g,"flex-direction")==="row"}t.prevKey||(t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown"))}if(t.navigationEvent=e,n)switch(a){case t.prevKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey||e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigatePrevious(e);break;case t.nextKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey||e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigateNext(e);break;default:{var h;const g=(h=t.keys)===null||h===void 0?void 0:h[d];if(g&&!t.disabled){if(t.callback(g,t.thisObj||i,[e])===!1)return}else i.onInternalKeyDown&&i.onInternalKeyDown(e);if(b.getActiveElement(l)!==l&&e.preventDefault(),s)return}}else{if(s)return;(a===t.nextKey||a===t.prevKey)&&(t.activeItem=t.getDefaultNavigationItem(e))}t.activeItem!==n&&t.triggerNavigate(e)}}getDefaultNavigationItem(e){const{target:t,itemSelector:i,prevKey:r,nextKey:n}=this;if(t.compareDocumentPosition(e.target)&4&&e.key===r)return t.querySelector(`${i}:last-of-type`);if(t.compareDocumentPosition(e.target)&2&&e.key===n)return t.querySelector(`${i}`)}navigatePrevious(e){const t=this,i=t.previous;e.preventDefault(),i&&t.ownerCmp.scrollable.scrollIntoView(i,{animate:t.scrollDuration}).then(()=>{t.activeItem=i,t.triggerNavigate(e)})}navigateNext(e){const t=this,i=t.next;e.preventDefault(),i&&t.ownerCmp.scrollable.scrollIntoView(i,{animate:t.scrollDuration}).then(()=>{t.activeItem=i,t.triggerNavigate(e)})}get owner(){return this.ownerCmp}get previous(){return this.getAdjacent(-1)}get next(){return this.getAdjacent(1)}getAdjacent(e=1,t=this.activeItem){const i=this.treeWalker;if(i.currentNode=t,i[e<0?"previousNode":"nextNode"](),i.currentNode!==this.activeItem)return i.currentNode}onTargetFocusIn(e){const t=this,{target:i,relatedTarget:r}=e,{owner:n,itemsTabbable:s,skipScrollIntoView:l,previousActiveItem:o}=t;if(!i.matches(".b-focus-trap")){if(i.matches(t.itemSelector))t.skipScrollIntoView=!0,t.activeItem=i,t.skipScrollIntoView=l,t.activeItem&&s&&t.triggerNavigate(e);else if(i===t.target)if((r?i.compareDocumentPosition(r):0)&Node.DOCUMENT_POSITION_CONTAINED_BY){var a;(a=n.previousSibling)===null||a===void 0||a.focus()}else t.activeItem=o&&t.target.contains(o)?o:0}}onTargetFocusOut(e){const t=this,{relatedTarget:i}=e;i!=null&&i.matches(".b-focus-trap")||(!i||!t.target.contains(i)||!i.matches(t.itemSelector))&&t.activeItem&&(t.activeItem=null,t.itemsTabbable&&t.triggerNavigate(e))}onTargetMouseDown(e){const t=this,i=e.target.closest(t.itemSelector);t.navigationEvent=e,t.itemsTabbable?i===t.activeItem&&t.triggerNavigate(e):t.ownerCmp.itemsFocusable===!1?t.onFocusGesture(e):i&&(e.preventDefault(),b.focusWithoutScrolling(i))}onTargetClick(e){var t;const i=this,{skipScrollIntoView:r}=i;if(i.skipNextClick||(t=i.navigationEvent)!==null&&t!==void 0&&t.ignoreNavigation){i.skipNextClick=!1;return}i.disabled||(i.skipScrollIntoView=!0,i.processEvent&&(e=i.processEvent.call(i.ownerCmp,e)),e&&(i.activeItem=e.target.closest(i.itemSelector),i.triggerNavigate(e)),i.skipScrollIntoView=r)}onFocusGesture(e){(e.target===this.ownerCmp.contentElement||e.target.closest(this.itemSelector)&&this.ownerCmp.itemsFocusable===!1)&&e.preventDefault()}acceptNode(e){return e.offsetParent&&e.matches&&e.matches(this.itemSelector)?b.NodeFilter.FILTER_ACCEPT:b.NodeFilter.FILTER_SKIP}changeActiveItem(e){return e!=null&&this.ownerCmp.getItem&&(e=this.ownerCmp.getItem(e)),e}updateActiveItem(e,t){const i=this,{ownerCmp:r}=i,n=t&&i.target.contains(t),s=e&&b.isFocusable(e)&&e!==b.getActiveElement(e);if(n&&(i.previousActiveItem=t),t&&(t.classList.remove(i.focusCls),t.removeAttribute("id")),e!=null){if(i.skipScrollIntoView)s&&b.focusWithoutScrolling(e);else{var l;(l=r.scrollable)===null||l===void 0||l.scrollIntoView(e,{block:"nearest",focus:s,silent:i.scrollSilently})}if(e===t&&n)return;e.classList.add(i.focusCls),e.id=`${i.owner.id}-active-descendant`,i._activeItem=e}else i._activeItem=null,t===b.getActiveElement(t)&&r.revertFocus()}updateTarget(e,t){const i=this,r={element:e,thisObj:i,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut",mousedown:{handler:"onTargetMouseDown",delegate:i.itemSelector}};!i.itemsTabbable&&!i.itemsFocusable&&(r.click="onTargetClick"),Object.prototype.hasOwnProperty.call(i,"acceptNode")||(i.acceptNode=i.acceptNode.bind(i),i.acceptNode.acceptNode=i.acceptNode),A.on(r),i.treeWalker=i.setupTreeWalker(e,b.NodeFilter.SHOW_ELEMENT,i.acceptNode),i.keyEventTarget||(i.keyEventTarget=e),(i.targetMutationMonitor=new MutationObserver(i.onTargetChildListChange.bind(i))).observe(e,{childList:!0,subtree:!0})}setupTreeWalker(e,t,i){return document.createTreeWalker(e,t,i)}onTargetChildListChange(){const e=this,{activeItem:t,datasetIdProperty:i}=e;if(t)if(e.target.contains(t))t.classList.contains(e.focusCls)||t.classList.add(e.focusCls);else{var r;e.activeItem=e.target.querySelector(`${e.itemSelector}.${e.focusCls}[data-${_.hyphenate(i)}="${t.dataset[i]}"]`)||((r=e.target.querySelector(`${e.itemSelector}.${e.focusCls}`))===null||r===void 0?void 0:r[t.dataset.index])||null}}changeKeyEventTarget(e){this._keyEventTarget=e,A.on({element:e,keydown:"onKeyDown",thisObj:this})}triggerNavigate(e,t=this.activeItem){var i;const r={event:e,item:t,oldItem:this.previousActiveItem};this.trigger("navigate",r),(i=this.ownerCmp)===null||i===void 0||i.trigger("navigate",r)}}Qi._$name="Navigator";const Or=_.escapeRegExp,Aa=/[\d+-]/g,Ur=(u,e)=>new Intl.NumberFormat(u||void 0,e),rm=/^(?:([$])\s*)?(?:(\d+)>)?\d+(,\d+)?(?:\.((\d*)(?:#*)|[*]))?(?:\s*([%])?)?$/,nm="\u2212";class sm{constructor(e){const t=this,i=e.locale,r=Ur(i,{maximumFractionDigits:3}),n=e.is.currency?t._decodeStyle(i,{style:"currency",currency:e.currency,currencyDisplay:e.currencyDisplay}):null,s=e.is.percent?t._decodeStyle(i,{style:"percent"}):null,l=r.format(1.2).replace(Aa,"")[0],o=r.format(1e9).replace(Aa,"")[0]||"";Object.assign(t,{currency:n,decimal:l,formatter:e,grouper:o,percent:s}),t.decimal=l,t.decimalRe=Or(l,"g"),t.grouper=o,t.stripRe=new RegExp(`(?:\\s+|${Or(o)})`+(n?`|(?:${Or(n.text)})`:"")+(s?`|(?:${Or(s.text)})`:""),"g")}decimalPlaces(e){e=e.replace(this.stripRe,"");const t=e.indexOf(this.decimal)+1;return t&&e.length-t}parse(e,t){return typeof e=="string"&&(e=e.replace(this.stripRe,"").replace(this.decimalRe,".").replace(nm,"-"),e=t?Number(e):parseFloat(e),this.formatter.is.percent&&(e/=100)),e}_decodeStyle(e,t){const i=Ur(e,t),r=Ur(e,Object.assign(i.resolvedOptions(),{style:"decimal"})),n=i.format(0),s=r.format(0);return{suffix:n.startsWith(s),text:n.replace(s,"").trim()}}}class dt extends Js{static get $name(){return"NumberFormat"}initialize(){this._as={},this.is={decimal:!1,currency:!1,percent:!1,null:!0,from:null}}get truncator(){const e=this.maximumFractionDigits;return e==null?null:this.as({style:"decimal",maximumFractionDigits:Math.min(20,e+1)},"truncator")}configure(e){const t=this;typeof e!="string"?Object.assign(t,e):t.template=e;const i={},r=t.locale?Te.locales[t.locale]:Te.locale,n=r&&r.NumberFormat,s=t.template;if(n)for(const l in n)t[l]==null&&typeof n[l]!="function"&&(t[l]=n[l]);if(s){const l=rm.exec(s),o=l[2],a=l[4];t.useGrouping=!!l[3],t.style=l[1]?"currency":l[6]?"percent":"decimal",o&&(t.integer=+o),a==="*"?t.fraction=[0,20]:a!=null&&(t.fraction=[l[5].length,a.length])}t._minMax("fraction",!0,!0),t._minMax("integer",!0,!1),t._minMax("significant",!1,!0);for(const l in t.defaults)t[l]!=null&&(i[l]=t[l]);t.is.from=t.from&&t.from.is,t.is[t.style]=!(t.is.null=!1),t.formatter=Ur(t.locale,i)}as(e,t=null){const i=this.resolvedOptions()||{template:"9.*"},r=this._as;let n=t&&r[t];return n||(typeof e=="string"?i.style=e:Object.assign(i,e),i.from=this,n=new dt(i)),t&&(r[t]=n),n}defaultParse(e,t){return e==null?e:t?Number(e):parseFloat(e)}format(e){if(typeof e=="string"){const t=Number(e);e=isNaN(t)?this.parse(e):t}return super.format(e)}round(e){return this.parse(this.format(e))}truncate(e){const t=this,i=t.maximumFractionDigits,{truncator:r}=t;let n=t.parse(e),s;return r&&(n=r.format(n),s=n.indexOf(r.parser.decimal),s>-1&&n.length-s-1>i&&(n=n.substr(0,s+i+1)),n=r.parse(n)),n}resolvedOptions(){const e=super.resolvedOptions();for(const t in e)e[t]===void 0&&(e[t]=this[t]);return e}_minMax(e,t,i){const r=this,n=r[e];if(n!=null){const s=_.capitalize(e),l=`maximum${s}Digits`,o=`minimum${s}Digits`;typeof n=="number"?(t&&(r[o]=n),i&&(r[l]=n)):(r[o]=n[0],r[l]=n[1])}}}dt.Parser=sm;Object.assign(dt.prototype,{defaults:{style:"decimal",currency:null,currencyDisplay:"symbol",locale:null,maximumFractionDigits:null,minimumFractionDigits:null,minimumIntegerDigits:null,maximumSignificantDigits:null,minimumSignificantDigits:null,useGrouping:!0},fraction:null,from:null,integer:null,significant:null,template:null});Object.assign(dt.prototype,dt.prototype.defaults);Js.number=(u,e)=>dt.format(u,e);dt._$name="NumberFormat";class Qs extends Me($){construct(e={}){const t=this;super.construct(e),t.onWsOpen=t.onWsOpen.bind(t),t.onWsClose=t.onWsClose.bind(t),t.onWsMessage=t.onWsMessage.bind(t),t.onWsError=t.onWsError.bind(t),t.autoConnect&&t.address&&t.open()}doDestroy(){const e=this;e.connector&&(e.detachSocketListeners(e.connector),e.connector.close(),e.connector=null),super.doDestroy()}get isConnecting(){var e;return((e=this.connector)===null||e===void 0?void 0:e.readyState)===this.constructor.webSocketImplementation.CONNECTING}get isOpened(){var e;return((e=this.connector)===null||e===void 0?void 0:e.readyState)===this.constructor.webSocketImplementation.OPEN}get isClosing(){var e;return((e=this.connector)===null||e===void 0?void 0:e.readyState)===this.constructor.webSocketImplementation.CLOSING}get isClosed(){var e;return((e=this.connector)===null||e===void 0?void 0:e.readyState)===this.constructor.webSocketImplementation.CLOSED}createWebSocketConnector(){const e=this.connector=new this.constructor.webSocketImplementation(this.address);this.attachSocketListeners(e)}destroyWebSocketConnector(){this.detachSocketListeners(this.connector),this.connector.close(),this.connector=null}attachSocketListeners(e){const t=this;e.addEventListener("open",t.onWsOpen),e.addEventListener("close",t.onWsClose),e.addEventListener("message",t.onWsMessage),e.addEventListener("error",t.onWsError)}detachSocketListeners(e){const t=this;e.removeEventListener("open",t.onWsOpen),e.removeEventListener("close",t.onWsClose),e.removeEventListener("message",t.onWsMessage),e.removeEventListener("error",t.onWsError)}async open(){const e=this;if(e._openPromise)return e._openPromise;if(!e.address){console.warn("Server me.address cannot be empty");return}if(e.isOpened)return!0;e.createWebSocketConnector();let t;return e._openPromise=new Promise(i=>{t=e.ion({open(){i(!0)},error(){i(!1)}})}).then(i=>(t(),e._openPromise=null,i||e.destroyWebSocketConnector(),i)).catch(()=>{e._openPromise=null,e.destroyWebSocketConnector()}),e._openPromise}close(){this.connector&&(this.destroyWebSocketConnector(),this.trigger("close"))}send(e,t={}){var i;(i=this.connector)===null||i===void 0||i.send(JSON.stringify(F({command:e},t)))}onWsOpen(e){this.trigger("open",{event:e})}onWsClose(e){this.trigger("close",{event:e})}onWsMessage(e){try{const t=JSON.parse(e.data);this.trigger("message",{data:t})}catch(t){this.trigger("error",{error:t})}}onWsError(e){this.trigger("error",{error:e})}}T(Qs,"webSocketImplementation",typeof WebSocket>"u"?null:WebSocket);T(Qs,"configurable",{address:"",userName:"User",autoConnect:!0});Qs._$name="WebSocketManager";var lm=u=>class extends(u||$){static get $name(){return"Finalizable"}construct(...t){super.construct(...t),this.finalizer=null,this.finalizing=null,this.isFinalized=!1,this.isFinalizing=!1}doFinalize(){this.destroy()}finalize(){const t=this;let i=t.finalizing;return!i&&!t.isFinalized&&(t.isFinalizing=!0,t.finalizing=i=t._awaitFinalizer()),i}async _awaitFinalizer(){const t=this;try{await t.finalizer}finally{t.finalizing=null,t.isFinalized=!0,t.doFinalize()}}};const $s=Symbol("dragAbort"),Yr=Symbol("dragInit"),jd=Symbol("dragDrag"),_s=Symbol("dragDrop"),om={x:"horizontal",y:"vertical"};class en extends $.mixin(lm,Se,ir){static get configurable(){return{itemElement:null,scrollManager:null,monitoringConfig:null,source:null,target:null,targetElement:null,threshold:5,touchStartDelay:300}}static get identifiable(){return{}}construct(...e){super.construct(...e);const t=this,{event:i}=t;Object.assign(t,{altKey:null,cleaners:[],ctrlKey:null,data:new Map,element:i.target,endEvent:null,lastMoveEvent:null,metaKey:null,previousTarget:null,scrollerAction:null,shiftKey:null,state:Yr,startEvent:i,touchStartTimer:null,_valid:!0}),"touches"in i&&t.touchStartDelay&&(t.touchStartTimer=t.setTimeout(()=>t.touchStartTimer=null,t.touchStartDelay,"touchStartDelay")),A.on({element:globalThis,blur:"onWindowBlur",thisObj:t})}doDestroy(){const e=this,{source:t,target:i}=e;e.cleanup(),i?.dropping===e&&(i.dropping=null),t?.dragging===e&&(t.dragging=null),super.doDestroy()}onWindowBlur(){this.started&&this.abort()}get aborted(){return this.state===$s}get completed(){return this.isDestroying||this.aborted||this.endEvent!==null}get pending(){return this.state===Yr}get started(){return this.state!==Yr&&!this.aborted}get valid(){return this.started&&this.targetElement!=null&&this._valid}set valid(e){this._valid=e}async get(e){if(this.aborted)throw new Error("Data is not available on aborted drag");if(!this.completed)throw new Error("Data is not available until drag completion");if(Array.isArray(e))return Promise.all(e.map(i=>this.get(i)));let t=this.data.get(e);return typeof t=="function"&&(t=await t(),this.data.set(e,t)),t}has(e){return this.data.has(e)}peek(e){if(this.aborted)throw new Error("Data is not available on aborted drag");if(Array.isArray(e))return e.map(i=>this.peek(i));let t=this.data.get(e);return typeof t=="function"&&(t=!0),t}set(e,t){this.data.set(e,t)}changeTarget(e,t){if(e!==t){const i=this;i._target=e,i.previousTarget=t,t&&(t.dropping=null),e&&(e.dropping=i,e.dropping!==i&&(e=null,i.valid=!1)),i._target=t}return e}updateTarget(e,t){const i=this;t&&i.source.dragLeaveTarget(i,t),e&&(i.valid=!0,e.dragMove(i),i.source.dragEnterTarget(i))}updateTargetElement(e){let t,i,r,n,s;for(s=e;s;s=s.parentElement)if(i=Ae.get(s,"droppables"),i){for(n=0;n<i.length;++n)if(t=i[n],t.dropRootElement.contains(e)&&(r=t.droppableSelector,(!r||e.closest(`#${b.getId(t.dropRootElement)} ${r}`))&&(this.target=t,this.target===t)))return}}abort(){const e=this,{element:t,source:i}=e;t?.getBoundingClientRect(),e.state!==_s&&(e.state=$s,e.cleanup()),i?.endDrag(e)}begin(){const e=this,{source:t}=e,i=t.beforeDrag(e);return i!==!1&&(t.dragging=e),i}cleanup(){let e;for(;e=this.cleaners.pop();)e()}end(e){const t=this,{lastMoveEvent:i,target:r}=t,{dragSwallowClickTime:n}=t.source;t.event=t.endEvent=e,t.syncFlags(),t.started&&((i?.clientX!==e.clientX||i?.clientY!==e.clientY||i?.target!==e.target)&&t.track(),n&&A.on({element:document,capture:!0,expires:n,once:!0,click(s){s.stopPropagation()}}),t.state=_s,r!==t.source&&r?.dragDrop(t))}fakeKey(e,t){const i=this,{lastMoveEvent:r}=i;if(r&&i.element){let n;r.isKey=!0,e.key==="Alt"?i.altKey!==t&&(i.altKey=t,n=!0):e.key==="Control"&&i.ctrlKey!==t&&(i.ctrlKey=t,n=!0),n&&(i.event=r,i.track())}}keyDown(e){this.completed||(e.key==="Escape"?this.abort():this.isDragToggleKey(e.key)&&this.fakeKey(e,!0))}keyUp(e){!this.completed&&this.isDragToggleKey(e.key)&&this.fakeKey(e,!1)}getDistance(e){return A.getDistanceBetween(this.startEvent,e)}isDragToggleKey(e){return e==="Control"||e==="Alt"}move(e){const t=this,{target:i}=e,r=t.getDistance(e),n=r>=t.threshold;if(t.syncFlags(),t.touchStartTimer){n&&t.abort();return}if(i&&i.nodeType===Node.ELEMENT_NODE){if(n&&!t.started&&(t.event=e,t.start()===!1)){t.abort();return}t.started&&!t.completed&&(t.lastMoveEvent=t.event=e,e.type==="touchmove"&&(e.preventDefault(),e.stopImmediatePropagation()),t.track())}}start(){const e=this,{scrollManager:t,monitoringConfig:i,source:r}=e,{draggingBodyCls:n,dragLock:s}=r,l=r.dragRootElement;if(e.state=jd,t){const a=t.startMonitoring(N.merge({scrollables:[{element:l}],direction:om[s]||s||"both",callback(d){const{lastMoveEvent:c}=e;c&&e.element&&(c.isScroll=!0,e.event=c,e.scrollerAction=d,e.track(),e.scrollerAction=null)}},i));e.cleaners.push(a)}const o=r.dragRootElement.closest(".b-outer")||document.body;if(o.classList.add(n),e.cleaners.push(()=>o.classList.remove(n)),r.startDrag(e)===!1)return e.cleanup(),!1}syncFlags(){const e=this,{event:t}=e;e.altKey=t.altKey,e.ctrlKey=t.ctrlKey||t.metaKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey}track(){const e=this,{event:t,source:i,target:r}=e;let n=t.target,s;t.type==="touchmove"&&(s=t.changedTouches[0],n=b.elementFromPoint(s.clientX,s.clientY)),e.targetElement=n,r===e.target&&r?.dragMove(e),i.trackDrag(e)}}T(en,"$name","DragContext");en.prototype.STATE=en.STATE=Object.freeze({ABORTED:$s,INIT:Yr,DRAGGING:jd,DROPPED:_s});en._$name="DragContext";class or extends $.mixin(hi){static get type(){return"default"}static get configurable(){return{dragging:null}}static get factoryable(){return{defaultType:or}}updateDragging(e,t){t&&this.close(t),e&&this.open(e)}close(e){}open(e){}dragStart(e){this.dragging=e}dragMove(e){}dragEnd(e){this.dragging=null}}or.initClass();or._$name="DragProxy";var am=u=>class extends u{static get $name(){return"LoadMaskable"}static get configurable(){return{loadMaskDefaults:{useTransition:!0,showDelay:1e3},loadMaskError:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},loadMask:{text:"L{GridBase.loadMask}"},syncMask:{text:"L{GridBase.syncMask}"},localizableProperties:["loadMask.text","syncMask.text"],testConfig:{loadMaskError:{icon:"b-icon b-icon-warning",autoClose:500,showDelay:0}}}}applyLoadMask(){const t=this,{loadMask:i}=t;return i&&(t.masked=Pe.mergeConfigs(t.loadMaskDefaults,i)),t.masked}applyMaskError(t){const{loadMaskError:i,masked:r}=this;return i===!1?r.hide():r&&(x.assign(r.errorDefaults,i),r.error=t),r}get widgetClass(){}};const tn=60*1e3,$t=60*tn,ft=24*$t,dm=/(\d+)?:?(\d*)/;class $e{static format(e){const t=Math.floor(e/$t),i=Math.floor(e/tn)%60;return`${t}:${i<10?"0":""}${i}`}static parse(e){const t=typeof e;if(t==="string"){const i=dm.exec(e);e=Number(i[1]||0)*$t+Number(i[2]||0)*tn}else t!=="number"?e=E.getTimeOfDay(e):e<=24&&(e*=$t);return Math.min(Math.max(Math.floor(e),0),ft)}constructor(e){let t=0,i,r;e!=null&&e.isDayView?(t=e.dayStartShift,i=e.dayStartTime,r=e.dayEndTime):typeof e=="number"?t=i=r=e:e&&(t=e.startShift,i=e.timeStart,r=e.timeEnd),this.startShift=t=$e.parse(t||0),this.timeEnd=(r==null?(t+ft)%ft:$e.parse(r))||ft,this.timeStart=i==null?t:$e.parse(i)}get startHour(){return Math.floor(this.timeStart/$t)}get endHour(){return Math.floor(this.timeEnd/$t)}get startTimeOffsetMs(){const{startShift:e,timeStart:t}=this;return t<e?ft-e+t:t-e}get today(){return this.startOfDay(new Date)}ceil(e){const t=this.startOfDay(e);return t<e&&t.setDate(t.getDate()+1),t}contains(e){return!this.outside(e)}dateKey(e){return e=this.shiftDate(e,-1),E.makeKey(e)}dayOfDate(e){return this.shiftDate(E.clearTime(e))}dayOfWeek(e){return e=this.shiftDate(e,-1),e.getDay()}delta(e,t="ms"){const{timeStart:i}=this,r=$e.parse(e),n=(this.startShift&&r<i?r+ft:r)-i;return t==="ms"?n:E.as(t,n,"ms")}duration(e="ms"){const{timeStart:t,timeEnd:i}=this,r=t<i?i-t:ft-t+i;return e==="ms"?r:E.as(e,r,"ms")}equals(e){return this.startShift===e?.startShift&&this.timeStart===e.timeStart&&this.timeEnd===e.timeEnd}intersects(e,t){const i=this,{timeStart:r,timeEnd:n}=i,[s,l]=i._dateRangeArgs(e,t),[o,a]=i.timeRange(s,l);return r<n?o<a?o<n&&r<=a:o<n||r<=a:!(o<a)||o<n||r<=a}isIntraDay(e,t){const i=this,[r,n]=i._dateRangeArgs(e,t),s=i.startOfDay(r),l=ft-E.diff(s,n,"ms");return l<0?!1:l>0||s<r}isInterDay(e){return e.allDay||!this.isIntraDay(...arguments)}outside(e){const{startShift:t,timeStart:i,timeEnd:r}=this,n=$e.parse(e);return i<r?n<i?n<t?1:-1:n<r?0:n<t?-1:1:n<r||n>=i?0:n<t?1:-1}parseKey(e){return this.dayOfDate(E.parseKey(e))}shiftDate(e,t=1){const{startShift:i}=this,r=typeof e;return e=r==="number"?new Date(e):r==="string"?E.parse(e):new Date(e.getTime()),t&&i&&e.setMilliseconds(t>0?i:-i),e}sortEvents(e,t){const i=this.startOfDay(e);return t?.sort((r,n)=>{r=r.eventRecord||r,n=n.eventRecord||n;let{startDate:s}=r,{startDate:l}=n;return s?l?(s=s<i?i:s,l=l<i?i:l,s-l||n.endDate-l-(r.endDate-s)):1:-1})}startOfDay(e){return e=this.shiftDate(e,-1),e=E.clearTime(e),e=this.shiftDate(e),e}timeRange(e,t){const[i,r]=this._dateRangeArgs(e,t);return[E.getTimeOfDay(i),E.getTimeOfDay(r)]}toString(){const{startShift:e,timeEnd:t,timeStart:i}=this,r=e?`@${$e.format(e)}`:"",n=$e.format(i);return i===t?e?r:n:`${n}-${$e.format(t)}${r}`}_dateRangeArgs(e,t){return e.isModel?[e.startDate,e.endingDate]:[e,t]}}$e.MIDNIGHT=new $e({startShift:0,timeStart:0,timeEnd:24});$e.MILLIS_PER_MINUTE=tn;$e.MILLIS_PER_HOUR=$t;$e.MILLIS_PER_DAY=ft;$e._$name="DayTime";class Bt extends Me($){static get configurable(){return{date:{$config:{equal:"date"},value:E.clearTime(new Date)},month:null,year:null,weekStartDay:null,hideNonWorkingDays:null,nonWorkingDays:null,sixWeeks:null}}configure(e){super.configure(e),this.updateDayNumbers(),e.date&&(this.date=e.date),this.generation=0}changeDate(e){if(!this.isConfiguring){if(e=typeof e=="string"?E.parse(e,"YYYY-MM-DD"):new Date(e),isNaN(e))throw new Error("Month date ingestion must be passed a Date, or a valid YYYY-MM-DD date string");return e}}updateDate(e,t){const i=this,{dayColumnIndex:r,weekCount:n}=i,s=E.getFirstDateOfMonth(e),l=E.getLastDateOfMonth(s),o=r[s.getDay()],a=r[l.getDay()],d=!t||e.getFullYear()!==t.getFullYear(),c=!t||e.getMonth()!==t.getMonth(),h=i.eventListeners&&(t?e.getDate()!==t.getDate()|(i.getWeekId(e)!==i.getWeekId(t))<<1|c<<2|d<<3:15);if(i._year=e.getFullYear(),i._month=e.getMonth(),i.startDayOfMonth=1-o,i.endDayOfMonth=l.getDate()+(6-a),i.sixWeeks&&(i.endDayOfMonth+=(6-i.weekCount)*7),(!i.weekBase||d)&&i.calculateWeekBase(),(c||d)&&i.generation++,h){const g={newDate:e,oldDate:t,changes:{d:!0,w:Boolean(h&2),m:Boolean(h&12),y:Boolean(h&8),r:i.weekCount!==n}};i.trigger("dateChange",g),h&2&&i.trigger("weekChange",g),h&12&&i.trigger("monthChange",g),h&8&&i.trigger("yearChange",g)}}calculateWeekBase(){const e=this,{dayColumnIndex:t}=e,i=new Date(e.year,0,1),r=new Date(e.year,11,31),n=e.month?e.getOtherMonth(i):e;e.dayColumnIndex[i.getDay()]>3?e.weekBase=n.startDate:e.weekBase=new Date(e.year,0,n.startDayOfMonth-7);const s=Math.floor(E.diff(e.weekBase,r,"day")/7);e.has53weeks=s===53&&t[r.getDay()]>2}getWeekStart(e){if(typeof e=="number")return E.add(this.weekBase,Math.max(e,1)*7,"day");const t=this,[i,r]=e;return i===t.year?t.getWeekStart(r):t.getOtherMonth(new Date(i,0,1)).getWeekStart(r)}getOtherMonth(e){const t=this,i=t===$a?new Bt(null):$a;return i.configure({weekBase:null,weekStartDay:t.weekStartDay,nonWorkingDays:t.nonWorkingDays,hideNonWorkingDays:t.hideNonWorkingDays,sixWeeks:t.sixWeeks,date:new Date(e.getFullYear(),0,1)}),i.date=e,i.updateDate(i.date,i.date),i}changeYear(e){const t=new Date(this.date);t.setFullYear(e),this.date=t}changeMonth(e){const t=new Date(this.date);t.setMonth(e),this.date=t}get weekStartDay(){return typeof this._weekStartDay=="number"?this._weekStartDay:E.weekStartDay}updateWeekStartDay(){const e=this;e.updateDayNumbers(),!e.isConfiguring&&e.date&&(e.weekBase=null,e.updateDate(e.date,e.date))}get nonWorkingDays(){return this._nonWorkingDays||E.nonWorkingDays}changeNonWorkingDays(e){return x.assign({},e)}updateNonWorkingDays(){this.updateDayNumbers()}updateHideNonWorkingDays(){this.updateDayNumbers()}updateSixWeeks(){this.isConfiguring||this.updateDate(this.date,this.date)}get dayCount(){return this.endDayOfMonth+1-this.startDayOfMonth}get weekCount(){return this.dayCount/7}get startDate(){const e=this;if(e.year!=null&&e.month!=null&&e.startDayOfMonth!=null)return new Date(e.year,e.month,e.startDayOfMonth)}get endDate(){const e=this;if(e.year!=null&&e.month!=null&&e.startDayOfMonth!=null)return new Date(e.year,e.month,e.endDayOfMonth)}eachDay(e){for(let t=this.startDayOfMonth;t<=this.endDayOfMonth;t++)e(new Date(this.year,this.month,t))}eachWeek(e){const t=this,{weekCount:i}=t;for(let r=t.startDayOfMonth,n=0;n<i;n++){const s=[],l=t.getWeekNumber(new Date(t.year,t.month,r));for(let o=0;o<7;o++,r++)s.push(new Date(t.year,t.month,r));e(l,s)}}getWeekNumber(e){const t=this;if(e=E.clearTime(e),e.getFullYear()!==t.year)return t.getOtherMonth(new Date(e.getFullYear(),0,1)).getWeekNumber(e);let i=Math.floor(E.diff(t.weekBase,e,"day")/7),r=e.getFullYear();if(i)i===53&&!t.has53weeks?(i=1,r++):i>53&&(i=i%52);else return t.getOtherMonth(new Date(t.year-1,0,1)).getWeekNumber(new Date(t.year,0,0));return[r,i]}getWeekId(e){const t=this.getWeekNumber(e);return t[0]*100+t[1]}getCellData(e,t,i=$e.MIDNIGHT){const r=this,n=e.getDay(),s=r.visibleDayColumnIndex[n],l=r.nonWorkingDays[n],o=r.hideNonWorkingDays&&l;return(e<r.startDate||e>r.endDate)&&(r.month=e.getMonth()),{day:n,dayTime:i,visibleColumnIndex:s,isNonWorking:l,week:r.getOtherMonth(e).getWeekNumber(e),key:E.format(e,"YYYY-MM-DD"),columnIndex:r.dayColumnIndex[n],date:new Date(e),dayEnd:i.duration("s"),tomorrow:i.dayOfDate(E.add(e,1,"day")),isOtherMonth:Math.sign(e.getMonth()+e.getFullYear()*12-(t.month+t.year*12)),visible:!o&&e>=t.startDate&&e<E.add(t.endDate,1,"day"),isRowStart:s===0,isRowEnd:s===r.visibleColumnCount-1}}updateDayNumbers(){const e=this,{weekStartDay:t,nonWorkingDays:i,hideNonWorkingDays:r}=e,n=e.dayColumnIndex=[],s=e.canonicalDayNumbers=[],l=e.visibleDayColumnIndex=[];let o=0;for(let a=0;a<7;a++){const d=(t+a)%7;s[a]=d,n[d]=a,(!r||!i[d])&&(l[d]=o++)}e.visibleColumnCount=o,e.weekLength=r?7-x.keys(i).length:7}}T(Bt,"$name","Month");const $a=new Bt(null);Bt._$name="Month";class Zs extends Se($){static get configurable(){return{element:null,zoneWidth:50,scrollSpeed:5,direction:"both",startScrollDelay:500,stopScrollWhenPointerOut:!1,testConfig:{scrollSpeed:2,startScrollDelay:100},activeScroll:{$config:["lazy"],value:{}},monitoring:{$config:["lazy","nullify"],value:!0},owner:null}}changeMonitoring(e,t){return t?.clear(),new Map}doDestroy(){this.stopMonitoring(),super.doDestroy()}get isScrolling(){return Object.keys(this.activeScroll).length!==0}get rtl(){var e;return(e=this.owner)===null||e===void 0?void 0:e.rtl}startMonitoring(e={}){const t=this,{element:i,direction:r}=t,{scrollables:n=[],direction:s=r,callback:l}=e,o=[];return n.length||n.push({element:i}),n.forEach(a=>{const d=a.element;typeof d=="string"?b.forEachSelector(i,d,c=>{t.createMonitor(c,a.direction||s,a.callback||l),o.push(c)}):(t.createMonitor(d,a.direction||s,a.callback||l),o.push(d))}),function(){var d;(d=t.stopMonitoring)===null||d===void 0||d.call(t,o)}}createMonitor(e,t,i){const{monitoring:r}=this;r.has(e)||r.set(e,new cm({scrollManager:this,element:e,direction:t,callback:i}))}stopMonitoring(e){const t=this,{monitoring:i}=t;if(e=B.asArray(e),i){if(!e){i.forEach(r=>t.stopMonitoring(r.element));return}e.forEach(r=>{const n=i.get(r);r.classList.remove("b-scrolling"),n&&(n.destroy(),i.delete(r))})}}requestScroll(e,t){const{activeScroll:i}=this;return e in i&&i[e]!==t?!1:(i[e]=t,!0)}releaseScroll(e){const{activeScroll:t={}}=this;Object.keys(t).forEach(i=>{t[i]===e&&delete t[i]})}getRelativeScroll(e,t="left"){let i=0;return this.monitoring.forEach((r,n)=>{b.isDescendant(n,e)&&(i+=t==="left"?r.scrollRelativeLeft:r.scrollRelativeTop)}),i}}class cm extends ${construct(e){const t=this,{element:i}=e,r=i.scrollLeft,n=i.scrollTop;Object.assign(e,{startScrollLeft:r,startScrollTop:n}),super.construct(e),A.on({element:i,scroll:"onElementScroll",mousemove:"onMouseMove",touchmove:"onMouseMove",capture:!0,thisObj:t}),A.on({element:i,pointerleave:"onPointerLeave",thisObj:t})}doDestroy(){this.stopScroll(),super.doDestroy()}startScroll(){this.scrolling=!0,this.performScroll()}stopScroll(){const e=this;e.scrolling=!1,e.scrollRequested&&(e.scrollManager.cancelAnimationFrame(e.frameId),e.scrollRequested=!1),e.scrollManager.clearTimeout(e.scrollTimeout),e.scrollManager.releaseScroll(e),e.scrollTimeout=null}onPointerLeave(){this.scrollManager.stopScrollWhenPointerOut&&this.stopScroll()}onMouseMove(e){const t=this,{scrollManager:i}=t,r=t.element.getBoundingClientRect(),n=i.zoneWidth,s=i.scrollSpeed;if(t.scrollDeltaX=t.scrollDeltaY=0,t.direction!=="vertical"){const{scrollLeft:l,scrollWidth:o,clientWidth:a}=t.element;i.rtl?e.clientX<r.left+n&&o+l-a>=1?t.scrollDeltaX=-Math.round((n+(r.left-e.clientX))/s)-1:e.clientX>r.right-n&&l<0&&(t.scrollDeltaX=Math.round((n-(r.right-e.clientX))/s)+1):e.clientX>r.right-n&&o-l-a>=1?t.scrollDeltaX=Math.round((n-(r.right-e.clientX))/s)+1:e.clientX<r.left+n&&l>0&&(t.scrollDeltaX=-Math.round((n+(r.left-e.clientX))/s)-1)}if(t.direction!=="horizontal"){const{scrollTop:l,scrollHeight:o,clientHeight:a}=t.element;e.clientY>r.bottom-n&&o-l-a>=1?t.scrollDeltaY=Math.round((n-(r.bottom-e.clientY))/s)+1:e.clientY<r.top+n&&l>0&&(t.scrollDeltaY=-Math.round((n+(r.top-e.clientY))/s)-1)}t.scrollDeltaX!==0&&!i.requestScroll("horizontal",t)&&(t.scrollDeltaX=0),t.scrollDeltaY!==0&&!i.requestScroll("vertical",t)&&(t.scrollDeltaY=0),t.scrollDeltaX===0&&t.scrollDeltaY===0?t.stopScroll():t.scrollTimeout||(t.scrollTimeout=i.setTimeout(()=>t.startScroll(),i.startScrollDelay))}performScroll(){const e=this,{element:t}=e;if(e.scrolling&&!e.scrollRequested){if(e.scrollDeltaX!==0){const i=t.scrollLeft,r=Math.min(i+e.scrollDeltaX,t.scrollWidth-t.clientWidth);r!==i&&(t.scrollLeft=r)}if(e.scrollDeltaY!==0){const i=t.scrollTop,r=Math.min(i+e.scrollDeltaY,t.scrollHeight-t.clientHeight);r!==i&&(t.scrollTop=r)}e.scrollRequested=!0,e.frameId=e.scrollManager.requestAnimationFrame(()=>{e.scrollRequested=!1,e.performScroll(e)})}}onElementScroll(){var e,t;(e=this.config)===null||e===void 0||(t=e.callback)===null||t===void 0||t.call(this.thisObj||this.scrollManager,this)}get scrollLeft(){return this.element.scrollLeft}get scrollTop(){return this.verticalElement?this.verticalElement.scrollTop:this.element.scrollTop}get scrollRelativeLeft(){return this.scrollLeft-this.startScrollLeft}get scrollRelativeTop(){return this.scrollTop-this.startScrollTop}getRelativeLeftScroll(e){return this.scrollManager.getRelativeScroll(e,"left")}getRelativeTopScroll(e){return this.scrollManager.getRelativeScroll(e,"top")}}Zs._$name="ScrollManager";const um={left:!0,right:!0,top:!0,bottom:!0,transform:!0},hm={true:1,false:1},fm=Promise.resolve();class me extends ze{static get $name(){return"Tooltip"}static get type(){return"tooltip"}static get configurable(){return{mouseOffsetX:15,mouseOffsetY:15,html:{$config:{equals:()=>!1}},getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:!1,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:null,anchor:!0,align:{align:"b-t",minHeight:300},axisLock:!0,activeTarget:null,testConfig:{hideDelay:100,hoverDelay:100,showAnimation:null,hideAnimation:null}}}afterConfigure(){const e=this,{forSelector:t}=e;t&&(e.showOnHover=!0,e.forElement||(e.anchorToTarget||(e.trackMouse=!0),e.forElement=e.rootElement.host||e.rootElement)),super.afterConfigure(),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=A.on({element:e.forElement,pointerover:"internalOnPointerOver",pointerout:"internalOnPointerOut",thisObj:e}))}doDestroy(){var e;(e=this.pointerOverOutDetacher)===null||e===void 0||e.call(this),super.doDestroy()}set focusOnToFront(e){super.focusOnToFront=e}get focusOnToFront(){return super.focusOnToFront&&b.usingKeyboard}get focusElement(){const e=super.focusElement;if(e!==this.element)return e}get anchorToTarget(){return this._anchorToTarget&&!this.trackMouse}get anchor(){return super.anchor&&!this.trackMouse}set anchor(e){super.anchor=e}onDocumentMouseDown({event:e}){const t=this,{triggeredByEvent:i}=t;i&&b.isTouchEvent&&e.pageX===i.pageX&&e.pageY===i.pageY&&t.activeTarget.contains(e.target)&&performance.now()-i.timeStamp<500||(t.abortDelayedShow(),super.onDocumentMouseDown({event:e}))}internalOnPointerOver(e){const t=this,{target:i,relatedTarget:r}=e,{forElement:n,forSelector:s,activeTarget:l}=t;let o;if(!(t.disabled||t.owner&&!t.owner.showTooltipWhenDisabled&&t.owner.disabled)&&!(t.allowOver&&t.element.contains(i))){if(s){if(o=i.closest(s),l!=null&&l.contains(i)&&l.contains(r)&&o===l||o&&r?.closest(s)===o)return}else if(!n.contains(r))o=n;else return;o?t.handleForElementOver(e,o):l&&t.handleForElementOut()}}onTransitionEnd(e){const t=this,{currentOverElement:i}=me;if(um[e.propertyName]){var r;if(t.allowOver&&t.element.contains(i))return;(r=t.activeTarget)!==null&&r!==void 0&&r.contains(i)&&!t.trackMouse&&t.realign()}}async handleForElementOver(e,t){const i=this,{activeTarget:r,hideOnDelegateChange:n,anchorToTarget:s}=i,l=t!==r,o=l&&n;if(i.trigger("pointerOver",{event:e,target:t})===!1)i.internalOnPointerOut(e);else{if(i.triggeredByEvent=e,i.hasTimeout("hide")&&(i.abortDelayedHide(),!l))return;if(!n&&i.element.classList.contains("b-hiding")&&i.cancelHideShowAnimation(),!i._hidden&&o&&i.hide(!1),i.activeTarget=t,i.isVisible){const a=i.updateContent();if(N.isPromise(a)&&!i.loadingMsg&&await a,i.trigger("beforeShow")===!1)return i.hide();i.alignTo({[s?"target":"position"]:s?t:"mouse",overlap:!(s&&i.anchor)}),i.trigger("show"),i.afterShowByTarget()}else i.delayShow(t)}}async delayShow(e){var t;const i=this;if((t=i.currentAnimation)!==null&&t!==void 0&&t.showing&&i.cancelHideShowAnimation(),!i.isVisible&&!i.hasTimeout("show"))if(!i.hoverDelay||i.forSelector&&Date.now()-i.lastHidden<i.quickShowInterval){const r=i.updateContent();N.isPromise(r)&&!i.loadingMsg&&await r,i.showByTarget(e)}else i.addDocumentMouseDownListener(),!i.listeningForMouseMove&&!i.anchorToTarget&&(i.mouseMoveRemover=A.on({element:i.rootElement,mousemove:"onMouseMove",thisObj:i})),i.setTimeout(async()=>{if(!b.isOrphaned(e)){const r=i.updateContent();N.isPromise(r)&&!i.loadingMsg&&await r,i.showByTarget(e)}},!i.triggeredByEvent||i.triggeredByEvent.type==="pointerover"?i.hoverDelay:0,"show");else i.isVisible&&i.showByTarget(e)}changeAllowOver(e){return this.inAfterShow||(this.configuredAllowOver=e),e}updateAllowOver(e){const t=this,{element:i}=t;if(i.classList.toggle("b-allow-over",Boolean(e)),e)t.allowOverlisteners=A.on({element:i,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:t});else{var r;(r=t.allowOverlisteners)===null||r===void 0||r.call(t)}}updateContent(){const e=this;if(e.getHtml){const t=e.callback(e.getHtml,e,[{tip:e,element:e.element,activeTarget:e.activeTarget,event:e.triggeredByEvent}]);return e.html=t,t}}get hasContent(){return Boolean(b.isReactElement(this._html)||this._html!==""&&typeof this.html=="string"&&this.html.length||this.items.length)}internalBeforeShow(){return(this.updateContentOnMouseMove||this.hasContent)&&!this.disabled}showAsyncMessage(e=this.optionalL(this.loadingMsg)){e&&(this.html=`
                <div class="b-tooltip-loading">
                    <i class="b-icon b-icon-spinner"></i>
                    ${e}
                </div>
            `)}beforeAlignTo(e){super.beforeAlignTo(e);const t=this;!t.anchorToTarget&&e.position==="mouse"&&(e.position=new pt(t.triggeredByEvent.pageX-globalThis.pageXOffset+t.mouseOffsetX*(t.rtl?-1:1),t.triggeredByEvent.pageY-globalThis.pageYOffset+t.mouseOffsetY))}showByTarget(e){var t;const i=this,{anchorToTarget:r}=i;i.mouseMoveRemover=(t=i.mouseMoveRemover)===null||t===void 0?void 0:t.call(i),i.showBy({[r?"target":"position"]:r?e:"mouse",overlap:!(r&&i.anchor)})}afterShowByTarget(){const e=this,{dismissDelay:t}=e;e.abortDelayedShow(),t&&e.setTimeout("hide",t),e.toFront(),!e.mouseMoveRemover&&(e.trackMouse||e.updateContentOnMouseMove)&&(e.mouseMoveRemover=A.on({element:e.rootElement,pointermove:"onMouseMove",thisObj:e})),e.inAfterShow=!0,e.allowOver=e.allowOver||e.configuredAllowOver!=!1&&e.childItems.some(i=>i.isVisible&&!i.disabled&&i.focusElement),e.inAfterShow=!1}updateActiveTarget(e,t){e&&!this.isConfiguring&&this.trigger("overTarget",{newTarget:e,lastTarget:t})}internalOnPointerOut(e){var t;const i=this,r=e.relatedTarget;i.allowOver&&i.element.contains(r)||i.element.contains(e.target)&&(t=i.activeTarget)!==null&&t!==void 0&&t.contains(r)||i.activeTarget&&!i.activeTarget.contains(r)&&i.handleForElementOut()}handleForElementOut(){const e=this,{hideDelay:t}=e;if(e.trigger("pointerOut")===!1){e.activeTarget=null;return}e.abortDelayedShow(),e.isVisible&&t!==!1&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())}show(e){const t=this;!e&&t.forElement&&t.anchorToTarget&&!t.forSelector?t.showByTarget(t.forElement):super.show(...arguments),t.afterShowByTarget(),t.forElement&&!t.transitionEndDetacher&&!t._hidden&&(t.transitionEndDetacher=A.on({element:t.forElement,transitionend:"onTransitionEnd",thisObj:t}))}hide(){const e=this;if(e.abortDelayedShow(),e._hidden)return fm;{var t,i;e.abortDelayedHide();const r=super.hide(...arguments);return e.lastHidden=Date.now(),e.activeTarget=null,(t=e.mouseMoveRemover)===null||t===void 0||t.call(e),e.mouseMoveRemover=null,(i=e.transitionEndDetacher)===null||i===void 0||i.call(e),e.transitionEndDetacher=null,r}}abortDelayedShow(){const e=this;if(e.hasTimeout("show")){var t,i,r;(t=e.mouseDownRemover)===null||t===void 0||t.call(e),e.mouseDownRemover=null,e.clearTimeout("show"),(i=e.mouseMoveRemover)===null||i===void 0||i.call(e),e.mouseMoveRemover=null,(r=e.transitionEndDetacher)===null||r===void 0||r.call(e),e.transitionEndDetacher=null}}abortDelayedHide(){this.clearTimeout("hide")}realign(){const e=this,t=e.lastAlignSpec;!e.isConfiguring&&!e.isVisible&&t!==null&&t!==void 0&&t.targetOutOfView&&(t.allowTargetOut||b.isInView(t.target,!1,e))&&(e.show(),t.targetOutOfView=!1),super.realign()}alignTo(e){const t=this;!t.isVisible||(e&&!(t.triggeredByEvent&&t.element.contains(t.triggeredByEvent.target))&&e.nodeType===Node.ELEMENT_NODE&&(e={target:e}),super.alignTo(e))}changeHtml(e){const t=this;if(N.isPromise(e)){t.showAsyncMessage(),e.target=t.activeTarget,e.then(i=>{e.target===t.activeTarget&&(t.html=i)});return}return typeof e!="object"&&(e=e!=null?t.optionalL(String(e)):""),e}updateHtml(e,t){const i=this;let r=e==="";r||(super.updateHtml(e,t),i.hasContent?(i.isVisible&&i.realign(),N.isPromise(e)||i.trigger("innerHtmlUpdate",{value:e})):r=!0),r&&i.hide()}onMouseMove(e){const t=this,{forElement:i,activeTarget:r}=t,n=t.hasTimeout("hide"),s=e.target;if(t.triggeredByEvent=e,!t._hidden){let l;const o=r?.contains(s),a=!o&&t.forSelector&&r&&!n&&s.nodeType===Node.ELEMENT_NODE&&!s.matches(t.forSelector)&&!(t.allowOver&&t.element.contains(s)),d=i!=null&&i.document?i.document.documentElement:i,c=d&&(d.contains?d.contains(s):d.compareDocumentPosition(s)&16);if(a&&(l=t.handleForElementOut()),l||!n||c){if(t.dismissDelay&&!n&&t.setTimeout("hide",t.dismissDelay),t.updateContentOnMouseMove&&t.getHtml&&(t.html=t.callback(t.getHtml,t,[{tip:t,element:t.element,forElement:r,event:e}]),!t.html)){t.hide();return}t.trackMouse&&t.alignTo({position:"mouse",ignorePageScroll:!0})}}}onOwnElementMouseEnter(e){this.abortDelayedHide()}static getSharedTooltip(e,t){var i,r;let n=(i=e.bryntum)===null||i===void 0||(r=i.tooltip)===null||r===void 0?void 0:r.get(me);if(!n&&!t){var s;(s=e.bryntum)!==null&&s!==void 0&&s.tooltip||x.setPath(e,"bryntum.tooltip",new Map);const l=e.bryntum.tooltip;l.set(me,!0),n=new me({forElement:e,rootElement:e,forSelector:"[data-btip]",resetCfg:{},isShared:!0,cls:"b-tooltip-shared",internalListeners:{pointerOver({source:o,target:a}){for(const h in o.resetCfg)h==="listeners"?o.un(o.resetCfg[h].set):h!=="html"&&(o[h]=o.resetCfg[h].was);o.resetCfg={};const d=k.getById(a.id),c=d?.tipConfig||o.gatherDataConfigs(a.dataset);if(d&&d.element!==a||!d&&a.matches(".b-widget")||d!=null&&d.disabled&&!d.showTooltipWhenDisabled)return!1;o.owner=d;for(const h in c)o.resetCfg[h]={set:c[h],was:o[h]},h==="listeners"?o.ion(c[h]):o[h]=c[h]},hide({source:o}){o.owner=null}},gatherDataConfigs(o){const a=this,d={};for(const c in o)if(c.startsWith("btip"))if(c.length>4){const h=_.uncapitalize(c.substr(4));if(h in a.getDefaultConfiguration()){const g=o[c];d[h]=hm[g]?g==="true":isNaN(g)?g:parseInt(g,10)}}else d.html=o[c];return d}}),A.on({element:e,mouseenter:o=>me.currentOverElement=o.target,keydown:o=>me.currentOverElement=o.target,capture:!0,thisObj:n}),l.set(me,n)}return n}static encodeConfig(e){const t={};if(typeof e=="string")t.btip=e;else for(const i in e)t[`btip${i==="html"?"":_.capitalize(i)}`]=e[i];return t}}me.initClass();Object.defineProperty(k,"tooltip",{get(){return me.getSharedTooltip(document.body)}});k.Tooltip=me;me._$name="Tooltip";class Gd extends or{static get type(){return"tip"}static get configurable(){return{align:"t10-b50",offset:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip"}}}}open(){this.getConfig("tooltip")}close(){var e;(e=this.tooltip)===null||e===void 0||e.hide()}dragMove(e){const{offset:t,tooltip:i}=this,{event:r}=e;i&&(i.isVisible||i.show(),i.alignTo({align:this.align,target:new O(r.clientX-t,r.clientY-t,t*2,t*2)}))}changeTooltip(e,t){return k.reconfigure(t,e,this)}}Gd.initClass();Gd._$name="DragTipProxy";var Ud=u=>class extends(u||$){static get $name(){return"Labelable"}static get configurable(){return{label:null,labelPosition:"before",labelCls:null,labelWidth:{value:null,$config:{localeKey:"L{labelWidth}"}}}}get hasLabel(){return Boolean(this.label)}compose(){const{hasLabel:t,labelPosition:i}=this;return{class:{[`b-label-${i}`]:t,"b-has-label":t}}}changeLabel(t){return t||""}setupLabel(t){return x.assign({tag:"label",for:`${this.id}-input`,class:`b-label b-align-${t.align||"start"}`},t)}updateLabelWidth(t){this.labelElement&&(this.labelElement.style.flex=`0 0 ${b.setLength(t)}`,this.inputWrap.style.flexBasis=t==null?"":"auto")}get widgetClass(){}};class Yd extends Je{static get $name(){return"FieldContainer"}static get type(){return"fieldcontainer"}static get configurable(){return{animation:{duration:300},collapsed:null,collapser:{value:null,$config:"nullify"},syncableConfigs:null,syncConfigTriggers:{$config:{merge:"classList"},value:null},testConfig:{animation:{duration:10}}}}static get delayable(){return{syncChildConfigs:"raf"}}get inline(){var e;return(e=this.owner.inline)!==null&&e!==void 0?e:this.ensureItems().count===1}changeCollapsed(e){if(this.togglingCollapse)return this.togglingCollapse=!1,e;this.toggleCollapse(Boolean(e))}updateCollapsed(e){var t;this.collapser=(t=this.collapser)===null||t===void 0?void 0:t.destroy(),this.setCollapsedCls(e)}updateCollapser(e,t){t&&t.completed==null&&(!t.reverting||!e)&&t.destroy(),this.setOwnerCls("b-collapsing",e)}get collapsing(){const{collapser:e}=this;return e!=null&&e.collapsed}get collapsingExpanding(){return this.collapser!=null}get expanding(){const{collapser:e}=this;return e!=null&&!e.collapsed}collapse(e){this.toggleCollapse(!0,e)}expand(e){this.toggleCollapse(!1,e)}setCollapsedCls(e){this.setOwnerCls("b-collapsed",e)}setOwnerCls(e,t){var i,r;(i=this.owner)===null||i===void 0||(r=i.element)===null||r===void 0||r.classList[t?"add":"remove"](e)}syncChildConfigs(){const e=this,{owner:t,syncableConfigs:i}=e;if(i){let r,n;for(r in i)n=i[r](t),e.eachWidget(s=>{s[r]=n},!1)}t.afterSyncChildConfigs(e)}syncContainer(){const{inline:e,layout:t}=this;this.autoLayout&&(t.horizontal=e,t.justify=e?"center":"stretch")}toggleCollapse(e,t){const i=this,{animation:r,collapser:n,inline:s}=i,{containerWrapElement:l}=i.owner,o=a=>{a&&(i.element.style.height="",i.togglingCollapse=!0,i.collapsed=e,i.collapser=null)};if(e==null&&(e=!i.collapsed),t!==!1&&t!==null&&(!l||!i.isVisible?t=null:(t===!0?t={}:typeof t=="number"&&(t={duration:t}),t=r||t?x.merge({},r,t):null)),!t)i.togglingCollapse=!0,i.collapsed=e;else if(n&&e!==n.collapsed)i.collapser=n.revert({finalize:o}),i.collapser.collapsed=e;else if(!n&&e!==i.collapsed){!e&&i.setCollapsedCls(!1);const{element:a}=i,{height:d}=a.getBoundingClientRect(),c=s?1:d;!e&&i.setCollapsedCls(!0),a.style.height=`${d}px`,i.collapser=he.run(x.merge({finalize:o,element:l,[s?"opacity":"height"]:{from:e?c:0,to:e?0:c}},t)),i.collapser.collapsed=e}}}Yd.initClass();Yd._$name="FieldContainer";const gm=(u,e)=>(u.weight||0)-(e.weight||0),mm=(u,e)=>(e.weight||0)-(u.weight||0),gs=[],pm={align:!0,weight:!0};class xe extends k.mixin(Bd,Ud){static get $name(){return"Field"}static get type(){return"field"}static get configurable(){return{defaultBindProperty:"value",placeholder:null,value:"",name:null,labels:null,required:null,clearable:null,revertOnEscape:null,hint:null,hintHtml:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder","labelWidth"],autoSelect:!1,autoComplete:"off",spellCheck:null,validateOnInput:!0,inputAttributes:null,inputType:"text",inputAlign:null,attributes:{value:["placeholder","autoComplete","spellCheck","minLength","maxLength","pattern","tabIndex","min","max"],$config:{merge:"distinct"}},nullValue:{$config:null,value:null,default:null},updatedClsDuration:500,inputReadOnly:!1,ariaElement:"input",container:{$config:"nullify",value:null},containerDefaults:{type:"fieldcontainer",syncableConfigs:{disabled:e=>e.disabled},syncConfigTriggers:{disabled:1}},containValues:null,inline:null,testConfig:{updatedClsDuration:10},keyMap:{}}}static get delayable(){return{highlightChanged:"raf"}}doDestroy(){var e,t,i;const r=this,{triggers:n}=r,s=r.isPainted&&xe.getSharedErrorTooltip(r.rootElement,!0);if((e=r.inputListenerRemover)===null||e===void 0||e.call(r),(t=r.keyListenerRemover)===null||t===void 0||t.call(r),(i=r.container)===null||i===void 0||i.destroy(),super.doDestroy(),n)for(const l of Object.values(n))l.destroy();s?.field===r&&s.hide()}get childItems(){const{container:e,triggers:t}=this,i=t?Object.values(t):[];return e?[...i,...e.childItems]:i}get invalidValueError(){return"L{invalidValue}"}get errorTip(){return this.constructor.getSharedErrorTooltip(this.rootElement)}static getSharedErrorTooltip(e,t){var i;let r=(i=e.bryntum)===null||i===void 0?void 0:i.errorTooltip;return!r&&!t&&(e.bryntum=e.bryntum||{},r=new me({cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:{align:"l-r",monitorTargetMutation:!0},scrollAction:"realign",trapFocus:!1,rootElement:e,onBeforeShow(){const n=this,s=k.fromElement(n.activeTarget);if(s){const l=s.getErrors();if(l)return n.html=l.join("<br>"),n.field=s,!0}return!1}}),e.bryntum.errorTooltip=r),r}static get errorTip(){return this.getSharedErrorTooltip(document.body)}construct(e){super.construct(e);const t=this;t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}changeKeyMap(e){const t=this;let i={};e&&(t._fieldKeyMap?x.assign(i,t._fieldKeyMap):(t._fieldKeyMap=e,x.assign(i,e)));for(const n in t.triggers){var r;(r=t.triggers[n])!==null&&r!==void 0&&r.keyMap&&(i=t.mergeKeyMaps(i,t.triggers[n].keyMap,n))}return i}get keyMapSubComponents(){return this.triggers}onFocusIn(e){const t=this;t.valueOnFocus=x.clone(t.value),t.validOnFocus=!(t.errors&&Object.keys(t.errors).length),super.onFocusIn(e),t.focusing=!0,t.syncInvalid(),t.focusing=!1}onFocusOut(e){super.onFocusOut(e),this.syncRequired(),this.onEditComplete()}onEditComplete(){}get rootUiClass(){return xe}compose(){this.getConfig("clearable");const e=this,{container:t,innerElements:i,label:r,labels:n,labelCls:s,readOnly:l,triggers:o}=e,a=x.values(o,(f,m)=>!m),d=a.filter(f=>f.align==="start").sort(gm),c=a.filter(f=>f.align!=="start").sort(mm),h=e.setupLabel.bind(e),g=[...d.map(f=>f.element),...i,...c.map(f=>f.element)];return{class:{"b-has-start-trigger":d.length,"b-no-input":!i.length,"b-readonly":l,"b-field-container":Boolean(t),"b-field-container-inline":t?.inline},children:[...(n||gs).filter(f=>f&&f.align!=="end").map(h),(r||null)&&h({reference:"labelElement",class:`b-label b-align-start ${s||""}`,html:r}),g.length?{class:"b-field-inner",reference:"inputWrap",children:g}:null,...(n||gs).filter(f=>f?.align==="end").map(h),...t?[{reference:"containerWrapElement",children:[t.element],class:{"b-field-container-wrap":1}}]:gs]}}updateElement(e,t){var i;const r=this,n=r.initialConfig.value,{input:s}=r;super.updateElement(e,t),n!=null&&(r.value=n),r.syncEmpty(),r.updateInputReadOnly(r.inputReadOnly),r.syncInvalid();const l=s||r.focusElement;(i=r.keyListenerRemover)===null||i===void 0||i.call(r),r.keyListenerRemover=l&&A.on({element:l,thisObj:r,keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}get innerElements(){return[this.inputElement]}get inputElement(){const{attributes:e,inputAttributes:t,id:i,inputCls:r,inputType:n,name:s}=this,l=x.assign({reference:"input",tag:"input",type:n,name:s||i,id:`${i}-input`,retainElement:!0},t);r&&(l.class=r);for(let o,a,d=e.length;d-- >0;)o=e[d],a=this[o],a!=null&&(l[o]=a);return l}get caretPos(){return this.textSelection[0]}set caretPos(e){this.textSelection=e}get focusElement(){return this.input}get textSelection(){const e=this.input;let t;try{t=[e.selectionStart,e.selectionEnd,e.selectionDirection]}catch{var i;t=((i=e.value)===null||i===void 0?void 0:i.length)||0,t=[t,t]}return t}set textSelection(e){typeof e=="number"?this.select(e,e):this.select(...e)}get hasTextSelection(){const[e,t]=this.textSelection;return e&&t-e>0}getAfterValue(e){const[t,i]=this.textSelection,r=this.input.value;return`${r.substr(0,t)}${e}${r.substr(i||t)}`}select(e,t){const i=this.focusElement;if(i.value.length){if(arguments.length===0){this.selectAll();return}if(!this.supportsTextSelection)return;i.setSelectionRange(e,t)}}moveCaretToEnd(){const e=this.input;if(e.createTextRange){const t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}selectAll(){this.focusElement.select()}syncEmpty(){var e;const{isEmptyInput:t,isEmpty:i,element:r}=this,n=(e=this.triggers)===null||e===void 0?void 0:e.clear,s=t&&i;r&&(n&&n[s?"hide":"show"](),r.classList.toggle("b-empty",s))}updateHint(){this.syncHint()}updateHintHtml(){this.syncHint()}syncHint(){const e=this,{input:t,hint:i,hintHtml:r}=e,n=t?.parentElement;if(t){let s=r||i;const l=e.hintElement||s&&(e.hintElement=b.createElement({parent:n,className:"b-field-hint",nextSibling:t.nextSibling,children:[{className:"b-field-hint-content"}]}));l&&(typeof s=="function"&&(s=s({source:e,value:e.value})),l.firstChild[r?"innerHTML":"textContent"]=s||""),e.element.classList[s?"remove":"add"]("b-field-no-hint")}}syncInvalid(){const e=this,{isPainted:t}=e;if(e.updatingInvalid=!0,t){const{isValid:i,element:r,inputWrap:n}=e;if(r.classList[i?"remove":"add"]("b-invalid"),i){const s=e.constructor.getSharedErrorTooltip(e.rootElement,!0);s!=null&&s.isVisible&&s.field===e&&s.hide()}else{const s=e.errorTip;s&&(e.containsFocus||e.isVisible&&n.contains(me.currentOverElement))&&(s.activeTarget===n&&s.isVisible?s.onBeforeShow():(s.activeTarget=n,s.showBy(n)))}}e.updatingInvalid=!1}updateEditable(){this.syncInputReadOnly()}syncInputReadOnly(){this.getConfig("readOnly"),this.inputReadOnly=this._readOnly||this.editable===!1}updateInputReadOnly(e){const t=this,{input:i,inputListenerRemover:r}=t;i&&(i.readOnly=e?"readOnly":null,e?t.inputListenerRemover=r?.():r||(t.inputListenerRemover=A.on({element:i,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"})))}changeReadOnly(e){return Boolean(e)}updateReadOnly(e){this.syncInputReadOnly()}updateClearable(e){const t=this;t.getConfig("triggers"),t.triggers={clear:e&&x.assign({cls:"b-icon-remove",weight:1e3,key:"Shift+backspace",handler(){t._isUserAction=!0,t.clear(...arguments),t._isUserAction=!1}},e)||null}}changeTriggers(e,t){const i=this,r=i.$triggers||(i.$triggers=new nr({configName:"triggers",factory:xe.Trigger,inferType:!1,owner:i,created(n){pe.after(n,"onConfigChange",(s,{name:l})=>{pm[l]&&i.onConfigChange({name:"triggers",value:r.target})})},setup(n,s){n.reference=n.ref=s,n.parent=i}}));if(i.stepTriggers===!1&&(e.back||e.forward)&&(e=x.assign({},e),delete e.back,delete e.forward),r.update(e),i.element&&(i.keyMap=i.keyMap),!t)return r.target}updateInputWidth(e){this.input.style.width=b.setLength(e),this.element.classList.add("b-has-width")}updateInputAlign(e){this.input.style.textAlign=e}get isValid(){const e=this;if(!e.disabled){if(e.syncRequired(),e.errors&&Object.keys(e.errors).length)return!1;const t=e.validity;if(t)return t.valid}return!0}get isEmpty(){return this.value==null||this.value===""}get isEmptyInput(){return!this.input||this.input.value==null||this.input.value===""}get validity(){const e=this.input;return e?.validity}changeValue(e,t){return e==null&&(e=this.nullValue),this.hasChanged(t,e)?e:(e===""&&this.syncRequired(),t)}updateValue(e,t){const i=this;i.isConfiguring||(i.syncRequired(),i.inputting||i.triggerChange()),i.inputting||(i._lastValue=e),i.syncInputFieldValue(),i.overflowTwin&&!i._overflowTwinSync&&(i._overflowTwinSync=!0,i.overflowTwin.value=e,i._overflowTwinSync=!1)}hasChanged(e,t){return t!==e}syncInputFieldValue(e=!1){const t=this,{input:i,parent:r,inputValueAttr:n,inputValue:s}=t;if(i&&!t.inputting&&i[n]!==s&&(i[n]=s,!t.isConfiguring&&!t.containsFocus&&t.highlightExternalChange)){if(i.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),r){const{assigningValues:l}=r;(l===!0||l?.highlight===!1)&&(e=!0)}e||t.highlightChanged()}t.syncEmpty(),t.syncInvalid()}highlightChanged(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}removeUpdatedCls(){this.input.classList.remove("b-field-updated")}get inputValue(){return this.value==null?"":this.value}get inputValueAttr(){return"value"}get supportsTextSelection(){const e=this.focusElement;return e&&(e.tagName.toLowerCase()==="textarea"||e.type&&/text|search|password|tel|url/.test(e.type))}internalOnInputFocus(){this.autoSelect&&this.selectAll()}internalOnChange(e){const t=this;t.hasChanged(t._lastValue,t.value)&&t.isValid&&(t.triggerChange(e,!0),t._lastValue=t.value)}triggerChange(e,t=Boolean(this._isUserAction)){const i=this,{value:r,_lastValue:n,isValid:s}=i;i.syncHint(),i.triggerFieldChange({value:r,oldValue:n,event:e,userAction:t,valid:s}),i.defaultAction==="change"&&i.trigger("action",{value:r,oldValue:n,event:e,userAction:t,valid:s})}fetchInputValue(){this.value=this.input[this.inputValueAttr]}internalOnInput(e){var t;const i=this;i.validateOnInput||i.errorTip.hide(),i.inputting=!0,i.fetchInputValue(),i.inputting=!1,i.trigger("input",{value:i.value,event:e}),(t=i.changeOnKeyStroke)===null||t===void 0||t.call(i,e)}get needsInputSync(){var e;return this.input[this.inputValueAttr]!==String((e=this.inputValue)!==null&&e!==void 0?e:"")}internalOnKeyEvent(e){const t=this,{value:i}=t;let r=!1;if(e.type==="keydown"&&e.key==="Escape"&&!(t.readOnly||t.disabled)){const n=t.isValid,s="initialValue"in t?t.initialValue:t.valueOnFocus,l=t.hasChanged(s,i),{needsInputSync:o}=t;t.revertOnEscape&&(!n||l||o)&&(l&&(t.value=s),o&&t.syncInputFieldValue(!0),t.clearError(),r=(l||o)&&t.isValid||n!==t.validOnFocus)}t.isDestroyed||(r&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}clear(e){const t=this,{value:i}=t;(i!==t.nullValue||t.input.value.length>0)&&(t.value=t.nullValue,t.clearError(),t.syncInvalid(),t.trigger("clear",{event:e}))}onDisabled(){this.syncInvalid()}syncRequired(){var e;const t=this;!t.isConfiguring&&!t.focusing&&t.required&&t.isEmpty&&!((e=t.parent)!==null&&e!==void 0&&e.isSettingValues)?t.setError("L{fieldRequired}",t.updatingInvalid):t.clearError("L{fieldRequired}",t.updatingInvalid)}setError(e,t,i){const r=this;if((r.errors||(r.errors={}))[r.optionalL(e)]=1,t||r.syncInvalid(),i){const n=()=>{r.clearError(e),s()},s=r.ion({keydown:n,focusOut:n})}}clearError(e,t){const i=this;i.errors&&(e?delete this.errors[this.optionalL(e)]:i.errors={}),t||i.syncInvalid()}getErrors(){const e=this;if(!e.isValid){var t;const i=e.validity,r=x.keys(i).find(l=>l!=="valid"&&l!=="customError"&&i[l]),n=e.errors&&Object.keys(e.errors);let s;if(n!=null&&n.length?s=n:i.customError?s=[e.input.validationMessage]:r?s=[e.L(r,{min:e.min,max:e.max})]:s=[e.L(e.invalidValueError)],((t=s)===null||t===void 0?void 0:t.length)>0)return s}}createOverflowTwin(e){const t=this,i=super.createOverflowTwin(e);return i.ion({change({value:r}){t._overflowTwinSync=!0,t.value=r,t._overflowTwinSync=!1}}),i}get containerCollapsed(){var e;return(e=this.container)===null||e===void 0?void 0:e.collapsed}set containerCollapsed(e){const{container:t}=this;t&&(t.collapsed=e)}afterSyncChildConfigs(e){}changeContainer(e,t){e&&(Array.isArray(e)||!("type"in e||"items"in e))&&(e={items:e});const i=this,r=e&&x.merge({owner:i,layout:"box"},i.containerDefaults),n=k.reconfigure(t,e,{owner:i,defaults:r});if(n&&(n.autoLayout=r?.layout==="box",n===t)){n.syncContainer();return}return n}onConfigChange(e){var t,i;super.onConfigChange(e),(t=this.container)!==null&&t!==void 0&&(i=t.syncConfigTriggers)!==null&&i!==void 0&&i[e.name]&&this.container.syncChildConfigs()}assignValue(e,t){const i=this,{container:r,containValues:n}=i,s=i.getValueName(t),l=e&&s in e;r&&n!==!1?e&&n==="nested"?l&&(e=x.clone(e[s]),super.assignValue({[s]:e&&!("value"in e)||e.value},t),e&&delete e.value,r.assignValue(e,t)):(super.assignValue(e,t),r.assignValue(e,t)):super.assignValue(e,t)}gatherValue(e){super.gatherValue(e),this.gatherValues(e)}gatherValues(e,t){var i;const r=this,{container:n,containValues:s,valueName:l}=r,o=typeof s;t=(i=t)!==null&&i!==void 0?i:l in e,n&&s!==!1&&(s==="nested"?t&&(e[l]=F({value:e[l]},n.values)):(s===!0||s==null&&t||o==="string"&&r[s]||o==="function"&&s(r))&&n.gatherValues(e))}updateContainer(e,t){t&&this.detachListeners(t.id),e&&(e.rendered||e.render(),e.syncContainer(),e.syncChildConfigs())}}xe.Trigger=class extends k{static get $name(){return"FieldTrigger"}static get factoryable(){return{defaultType:xe.Trigger,extends:null}}static get type(){return"trigger"}static get configurable(){return{align:null,weight:null,role:void 0}}get field(){return this.parent}construct(){super.construct(...arguments),this.key&&(this.keyMap={[this.key]:"onClick"})}compose(){return{"aria-hidden":!0,class:{[`b-align-${this.align||"end"}`]:1,"b-icon":1},listeners:{click:"onClick",mousedown:"onMousedown"}}}changeAlign(e){return e}onClick(e){const t=this,{field:i}=t;i.disabled||i.readOnly||(e.key&&e.preventDefault(),i.trigger("trigger",{trigger:t})!==!1&&t.handler&&i.callback(t.handler,i,[e,t]))}onMousedown(e){const t=this.field;!("key"in e)&&b.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout(()=>t.editable=!0,500)),e.preventDefault(),b.getActiveElement(t.input)!==t.input&&t.focus()}};xe.SpinTrigger=class extends xe.Trigger{static get $name(){return"SpinTrigger"}static get type(){return"spintrigger"}static get configurable(){return{repeat:{$config:["nullify"],value:!0}}}compose(){return{children:{upButton:{class:{"b-icon":1,"b-spin-up":1}},downButton:{class:{"b-icon":1,"b-spin-down":1}}}}}updateRepeat(e){var t;(t=this.clickRepeater)===null||t===void 0||t.destroy(),this.clickRepeater=e?Gs.new({element:this.element},e):null}onClick(e){const t=this,{field:i}=t;i.disabled||i.readOnly||(e.target===t.upButton?i.doSpinUp(e.shiftKey):e.target===t.downButton&&i.doSpinDown(e.shiftKey))}};xe.Trigger.initClass();xe.SpinTrigger.initClass();k.register(xe.Trigger,"trigger");k.register(xe.SpinTrigger,"spintrigger");xe._$name="Field";class pi extends xe{static get type(){return"textfield"}static get alias(){return"text"}static get configurable(){return{nullValue:""}}static get $name(){return"TextField"}construct(e){e?.inputType==="hidden"&&(e.hidden=!0),super.construct(...arguments)}}pi.initClass();pi._$name="TextField";class ar extends pi{static get $name(){return"PickerField"}static get type(){return"pickerfield"}static get configurable(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:{value:{floating:!0},$config:["lazy","nullify"]},inputType:"text",monitorResize:!0,nullValue:null}}doDestroy(){var e;(e=this.globalTapListener)===null||e===void 0||e.call(this),super.doDestroy()}updateEditable(e){const t=this,{element:i,ariaElement:r}=t;if(super.updateEditable(...arguments),e===!1){var n;r.removeAttribute("aria-autocomplete"),(n=t.globalTapListener)===null||n===void 0||n.call(t),i.classList.add("b-not-editable"),A.on({element:t.nonEditableClickTarget,click:s=>{const l=document.elementFromPoint(s.clientX,s.clientY);s.target===t.nonEditableClickTarget&&l===t.nonEditableClickTarget&&t.onTriggerClick(s)},thisObj:t})}else r.setAttribute("aria-autocomplete","list"),t.globalTapListener=te.ion({globaltap:"showKeyboard",thisObj:t})}get nonEditableClickTarget(){return this.input}updateElement(e,t){var i;const r=super.updateElement(e,t),n=this.peekConfig("picker"),s=n?n.isWidget?n.role:(i=this.constructor.resolveType(n.type))===null||i===void 0?void 0:i.$meta.config.role:!1;return this.ariaHasPopup=s,r}changePicker(e,t){throw new Error("changePicker(oldPicker, newPicker) must be implemented in PickerField subclass implementations")}get childItems(){const e=super.childItems;return this._picker&&e.push(this.picker),e}onEditComplete(){super.onEditComplete(),this.autoClosePicker()}onElementResize(e){const t=this;t.pickerVisible&&t.picker.requestAnimationFrame(t.picker.realign,null,t.picker),super.onElementResize(e)}internalOnKeyEvent(e){const t=this;let i=!0;if(e.type==="keydown"&&!t.disabled&&!e.shiftKey&&!e.ctrlKey)if(t.pickerVisible){const{picker:r}=t;e.key==="Escape"?(e.preventDefault(),e.stopImmediatePropagation(),t.hidePicker(),i=!1):r.onInternalKeyDown?r.onInternalKeyDown(e):e.key==="ArrowDown"&&r.focusable&&r.focus()}else e.key==="ArrowDown"&&(e.stopImmediatePropagation(),e.preventDefault(),t.onTriggerClick(e));i&&super.internalOnKeyEvent(e)}onFocusIn(e){const t=this;super.onFocusIn(e),t.autoExpand&&(t.minChars=0,t.onTriggerClick(e),t.ignoreTriggerClick=!0,t.setTimeout(()=>t.ignoreTriggerClick=!1,100))}onTriggerClick(e){this.disabled||this.togglePicker("key"in e)}showKeyboard({event:e}){const t=this.input;b.isTouchEvent&&b.getActiveElement(t)===t&&e.target===t&&(te.suspendFocusEvents(),t.blur(),t.focus(),te.resumeFocusEvents())}togglePicker(e){this.pickerVisible?this.hidePicker():this.showPicker(e)}showPicker(e){const t=this,{picker:i}=t;t.pickerHideShowListenersAdded||(i.ion({show:"onPickerShow",hide:"onPickerHide",thisObj:t}),t.pickerHideShowListenersAdded=!0),b.setAttributes(t.ariaElement,{"aria-controls":i.id,"aria-expanded":!0}),i.autoClose=t.autoClose,i.show(),i.isVisible&&e&&t.focusPicker()}onPickerShow(){const e=this;e.pickerVisible=!0,e.element.classList.add("b-open"),e.trigger("togglePicker",{show:!0}),e.pickerTapOutRemover=te.ion({globaltap:"onPickerTapOut",thisObj:e}),e.pickerKeyDownRemover=A.on({element:e.picker.element,keydown:"onPickerKeyDown",thisObj:e})}onPickerHide(){var e,t;const i=this;i.ariaElement.setAttribute("aria-expanded",!1),i.pickerVisible=!1,i.element.classList.remove("b-open"),i.trigger("togglePicker",{show:!1}),(e=i.pickerTapOutRemover)===null||e===void 0||e.call(i),(t=i.pickerKeyDownRemover)===null||t===void 0||t.call(i)}onPickerTapOut({event:e}){!this.containsFocus&&!this.owns(e.target)&&this.autoClosePicker()}onPickerKeyDown(e){if(e.key==="Tab"&&!this.picker.trapFocus){const t=b.getActiveElement(this.input),i=new KeyboardEvent("keydown",e);this.input.dispatchEvent(i),i.defaultPrevented&&e.preventDefault(),b.getActiveElement(this.input)===t?this.input.focus():e.preventDefault(),this.isDestroyed||this.hidePicker()}}autoClosePicker(){this.autoClose&&this.hidePicker()}hidePicker(){this.pickerVisible&&this.picker.hide()}focusPicker(){}focus(){const e=this.input;b.isTouchEvent&&this.editable&&(e.readOnly=!0,this.setTimeout(()=>e.readOnly=!1,500)),super.focus()}}ar._$name="PickerField";const St=document.createRange();class di extends k{static get $name(){return"List"}static get type(){return"list"}static get configurable(){return{itemCls:"b-list-item",selectedCls:"b-selected",selectIconCls:"b-icon-check",tag:"ul",items:null,displayField:"text",store:null,navigator:!0,scrollable:{overflowX:!1,overflowY:!0},itemsFocusable:!0,multiSelect:!1,toggleAllIfCtrlPressed:!1,selectAllItem:!1,itemTpl(e){let t=_.encodeHtml(e[this.displayField]);return(t==null||t==="")&&(t="&nbsp;"),t},getItemStyle:null,getItemCls:null,groupHeaderTpl:(e,t)=>{let i=_.encodeHtml(t);return(i==null||i==="")&&(i="&nbsp;"),i},allowGroupSelect:!0,selected:{$config:"nullify",value:{}},activateOnMouseover:null,role:"listbox",keyMap:{"Ctrl+a":"selectAll"}}}construct(e,...t){var i;const r=this;Array.isArray(e)&&(e={items:e}),super.construct(e,...t);const{element:n}=r,{classList:s}=n;r.multiSelect&&s.add("b-multiselect"),(i=r.store)!==null&&i!==void 0&&i.count?r.refresh():s.add("b-empty"),A.on({element:n,delegate:r.itemSelector,mouseover:"onMouseOver",click:"onClick",thisObj:r})}doDestroy(){var e;this.detachListeners("store"),(e=this.navigator)===null||e===void 0||e.destroy(),super.doDestroy()}onFocusIn(e){var t;this.restoreActiveItem((t=e._target)===null||t===void 0?void 0:t.closest(this.itemSelector)),super.onFocusIn(e)}contentTpl(){const e=this,t=e.store.records.map((i,r)=>e.itemWrapperTpl(i,r));return e.multiSelect&&e.selectAllItem!==!1&&t.unshift(e.selectAllItemTpl()),Xe.tpl`${t}`}itemWrapperTpl(e,t){const{selected:i,getItemStyle:r}=this,n=r?`style="${this.callback(r,this,[e])}"`:"";return Xe.tpl`<li ${n} class="${this.getItemClasses(e,t)}" role="option" aria-selected="${i.includes(e)}" data-index="${t}" data-id="${_.encodeHtml(e.id)}" ${this.itemsFocusable?'tabindex="-1"':""}>${this.itemContentTpl(e,t)}</li>`}itemContentTpl(e,t){return"groupRowFor"in e.meta?this.groupHeaderTpl(e,_.capitalize(e.groupChildren[0][e.meta.groupField])):`${this.itemIconTpl(e,t)}${this.itemTpl(e,t)}`}itemIconTpl(e,t){return this.multiSelect?`<i class="b-selected-icon b-icon ${this.selectIconCls}"></i>`:""}selectAllItemTpl(){const e=this.allSelected?"b-selected":"";return`<li class="${this.itemCls} b-select-all-item ${e}" data-noselect data-select-all data-id="select-all">${this.itemIconTpl({})}<div>${this.optionalL("Select All")}</div></li>`}getItemClasses(e){var t;const i=this,{getItemCls:r}=i,n=(t=i._navigator)===null||t===void 0?void 0:t.activeItem,s=n?.dataset.id==e.id,l="groupRowFor"in e.meta?"b-list-item-group-header":"",o=i.selected.includes(e),a=r?this.callback(r,this,[e]):"";return`${i.itemCls} ${e.cls||""} ${a} ${o?i.selectedCls:""} ${s?i.navigator.focusCls:""} ${l}`}onBeforeStoreLoad(){this.mask(this.L("L{loading}"))}onAfterStoreRequest(){this.unmask()}onStoreChange({source:e,action:t,records:i,record:r,changes:n}){const s=this,{selected:l}=s;switch(t){case"dataset":{l.match(e.storage,!s._externallyOwnedSelection);break}case"remove":l.remove(i);break;case"clear":s.deselectAll();break;case"update":{const{id:o}=n;o&&b.setAttributes(s.contentElement.querySelector(_.encodeAttributeSelector("data-id",o.oldValue)),{"data-id":o.value}),s.refreshItem(r);return}}s.refresh()}onStoreRefresh(){this.refresh()}refresh(){const e=this;if(e.isVisible){var t;const i=(t=e.navigator)===null||t===void 0?void 0:t.activeItem;e.paintListener=null;const r=b.createElementFromTemplate(e.contentTpl(),{fragment:!0});e.clearItems().insertNode(r),i&&e.restoreActiveItem(i),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty"),e.updateSelectAllState()}else e.paintListener||(e.paintListener=e.ion({paint:"refresh",thisObj:e,once:!0}))}clearItems(){const e=this,t=e.contentElement.querySelector(e.itemSelector),i=e.contentElement.lastChild;if(t){const r=e.contentElement.querySelectorAll(`${e.itemSelector}:not(.b-mask)`);St.setStartBefore(t),St.setEndAfter(r[r.length-1]),St.deleteContents()}else i?(St.setStartAfter(i),St.setEndAfter(i)):(St.setStart(e.contentElement,0),St.setEnd(e.contentElement,0));return St}refreshItem(...e){for(const t of e){const i=this.getItem(t);if(i){const r=this.store.indexOf(t),n=b.createElementFromTemplate(this.itemWrapperTpl(t,r));b.sync(n,i)}}}getItem(e){if(e!=null){var t;return typeof e=="number"?this.contentElement.querySelector(`[data-index="${e<0?this.store.count+e:e}"]`):(e.nodeType===Element.ELEMENT_NODE&&(e=e.dataset.id),((t=e)===null||t===void 0?void 0:t.id)!=null&&(e=e.id),this.contentElement.querySelector(_.encodeAttributeSelector("data-id",e)))}}getRecordFromElement(e){return e.target&&(e=e.target),e=e.closest(this.itemSelector),this.store.getAt(parseInt(e.dataset.index))}updateItems(e){const t=this;t.store&&t.store.autoCreated&&t.store.destroy(),t.store=ue.getStore(e)}updateDisabled(e){super.updateDisabled(...arguments),this.navigator&&(this.navigator.disabled=e)}changeSelected(e,t){if(e){let i;e.isCollection?this._externallyOwnedSelection=!0:(Array.isArray(e)?(i=e,e={}):e.values&&(i=e.values,e=F(F({},e),{},{values:[]})),e=new at(e)),e.ion({change:"onSelectionChange",thisObj:this}),this.initialSelection=i}else t?.destroy();return e}get itemSelector(){return`.${this.itemCls}`}get selected(){return this._selected}get store(){return this.getConfig("items"),this._store}changeStore(e){const t=this;if(e instanceof ue||(Array.isArray(e)&&(e={data:e}),e=new ue(e)),t.detachListeners("store"),e){const i={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:t};e.readUrl&&(i.beforeLoad="onBeforeStoreLoad",i.afterRequest="onAfterStoreRequest"),e.isGrouped&&(t.element.classList.add("b-grouped"),i.groupchange="onStoreRefresh"),e.ion(i)}return e}updateStore(e){const{initialSelection:t}=this;t!=null&&t.length&&(e.count?this.select(t):e.ion({refresh:()=>this.select(t),once:!0})),this.refresh()}changeNavigator(e,t){const i=this,{element:r}=i;if(r){var n;e=Qi.reconfigure(t,e?Qi.mergeConfigs({ownerCmp:i,disabled:i.disabled,target:r,keyEventTarget:r},e):null,i),((n=e)===null||n===void 0?void 0:n.keyEventTarget)===r&&!i.itemsTabbable&&(r.tabIndex=0)}return e}get minAlignHeight(){const e=this.element.lastElementChild,t=this.minHeight;if(t!=null)return e?Math.min(e.offsetTop+e.offsetHeight,t):0}alignTo(...e){super.minHeight=this.minAlignHeight,super.alignTo(...e)}hide(...e){return this.navigator&&(this.navigator.activeItem=null),super.hide(...e)}show(){const{refreshCount:e}=this,{previousActiveItem:t}=this.navigator;super.minHeight=this._minHeight;const i=super.show(...arguments);return this.refreshCount===e&&this.restoreActiveItem(t,!0),i}restoreActiveItem(e=this.navigator.previousActiveItem,t="nearest"){const i=this,{navigator:r,lastAlignSpec:n}=i;if(e!=null){if(typeof t!="string"){const s=n?n.zone:1;t=s&1?"nearest":s?"start":"end"}e=i.getItem(e),e&&!i.disabled&&(i.scrollable.scrollIntoView(e,{block:t}),r.activeItem=e)}}onMouseOver(e){const t=this,i=e.currentTarget;!b.isTouchEvent&&i&&t.navigator&&t.activateOnMouseover&&t.setTimeout({fn:"handleMouseOver",delay:30,args:[i],cancelOutstanding:!0})}handleMouseOver(e){this.navigator.activeItem=e}onClick(e){const t=e.target.closest(this.itemSelector);t&&this.onItemClick(t,e)}onInternalKeyDown(e){const t=this,i=t.navigator.activeItem;if(!t.disabled)switch(e.key){case" ":if(e.target.nodeName.toUpperCase()==="INPUT"&&!e.target.readOnly)break;case"Enter":i&&(this.onItemClick(i,e),e.stopImmediatePropagation(),e.preventDefault())}}onItemClick(e,t){const i=this,r=parseInt(e.dataset.index);let n=i.store.getAt(r);if(!(i.disabled||i.trigger("beforeItem",{item:e,record:n,index:r,event:t,userAction:!0})===!1)){if(i._isUserAction=!0,i.allowGroupSelect||n&&!n.isSpecialRow)if(e.contains(t.target.closest("[data-noselect]")))e.contains(t.target.closest("[data-select-all]"))&&i.onSelectAllClick(e,t);else{const s=i.selected;let l=s.includes(n);i.multiSelect?(i.toggleAllIfCtrlPressed&&t.ctrlKey?n=i.store.records:i.allowGroupSelect&&n.isSpecialRow&&(l=!n.groupChildren.some(o=>!s.includes(o)),n=n.groupChildren),s[l?"remove":"add"](n)):s.splice(0,s.count,n)}i.lastClicked=n,i.trigger("item",{item:e,record:n,index:r,event:t,userAction:!0}),i._isUserAction=!1}}onSelectionChange({action:e,removed:t,added:i,replaced:r}){const n=this,{selectedCls:s,unselectedCls:l}=n;let o,a;if(e==="clear")for(a of n.element.querySelectorAll(`.${s}`))a.classList.remove(s),a.setAttribute("aria-selected",!1),l&&a.classList.remove(l);else if(e!=="replaceValues"){for(o of t)a=n.getItem(o),a&&(a.classList.remove(s),a.setAttribute("aria-selected",!1));for(o of i)a=n.getItem(o),a&&(a.classList.add(s),a.setAttribute("aria-selected",!0))}n.selectAllItem&&n.updateSelectAllState()}onSelectAllClick(e){e.classList.contains(this.selectedCls)?this.deselectAll():this.selectAll()}updateSelectAllState(){var e;(e=this.element.querySelector(".b-select-all-item"))===null||e===void 0||e.classList.toggle(this.selectedCls,this.allSelected)}get allSelected(){const{selected:e,store:t}=this;return e.count&&(t.isFiltered?t.records.every(i=>e.includes(i)):t.count===e.count)}selectAll(e){const t=this;(t.multiSelect||!e)&&(t.selected.add(t.store.records),e&&!t.navigator.activeItem&&(t.navigator.activeItem=t.getItem(-1)))}deselectAll(){this.selected.clear()}select(e){const{store:t}=this,{modelClass:i}=t;e=B.asArray(e).reduce((r,n)=>(n=t.getById(i.asId(n)),n&&r.push(n),r),[]),this.selected.add(e)}deselect(e){const{modelClass:t}=this.store;e=B.asArray(e).reduce((i,r)=>(r=this.selected.get(t.asId(r)),r&&i.push(r),i),[]),this.selected.remove(e)}}di.initClass();di.prototype.navigatorClass=Qi;di._$name="List";class el extends di{static get $name(){return"ChipView"}static get type(){return"chipview"}static get configurable(){return{itemCls:"b-chip",multiSelect:!1,closable:!0,iconTpl:null,closeHandler:null}}itemContentTpl(e,t){const i=this;return Xe.tpl`${i.iconTpl?this.iconTpl(e):""}
            ${i.itemTpl(e,t)}
            ${i.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':""}`}onInternalKeyDown(e){const t=this;t.closable&&t.selected.count&&(e.key==="Delete"||e.key==="Backspace")?t.callback(t.closeHandler,t.owner,[t.selected.values,{isKeyEvent:!0}]):super.onInternalKeyDown(e)}updateClosable(e){this.element.classList[e?"add":"remove"]("b-chips-closable"),this.navigator&&(this.navigator.disabled=!e),this.isConfiguring||this.refresh()}onClick(e){const t=this,i=e.target.closest(`.${t.itemCls}`);if(t.closable&&e.target.classList.contains("b-close-icon")){const r=t.store.getAt(parseInt(i.dataset.index));t.callback(t.closeHandler,t.owner,[[r]])}else super.onClick(e)}}el.initClass();el._$name="ChipView";const ms="L{Field.fieldRequired}",ti="L{Field.validateFilter}",vm="L{Combo.recordNotCommitted}";class kt extends ar{static get $name(){return"Combo"}static get type(){return"combo"}static get alias(){return"combobox,dropdown"}static get configurable(){return{primaryFilter:{},picker:{type:"list",floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},multiSelect:null,items:null,store:null,valueField:void 0,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:e=>e.map(t=>t.value),filterOnEnter:!1,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:"all",filterOperator:"startsWith",caseSensitive:!1,hidePickerOnSelect:null,chipView:{$config:["lazy","nullify"],value:{type:"combochipview"}},chipStore:{$config:["lazy","nullify"],value:{}},filterSelected:null,emptyText:null,value:null,valueCollection:{$config:["nullify","lazy"],value:{}},validateFilter:!0,clearTextOnPickerHide:!0,destroyStore:!1,multiValueSeparator:",",createOnUnmatched:null,role:"combobox",inlinePicker:null,testConfig:{keyStrokeFilterDelay:0},localizeDisplayFields:!1,buildItems:null}}static get queryLast(){return"last"}construct(e){super.construct(...arguments),this.store||(this.items=[]),this.filterOnEnter&&(this.hideTrigger=!0)}startConfigure(e){this.usingRecordAsValue=e.valueField===null,super.startConfigure(...arguments)}afterConfigure(){super.afterConfigure();const e=this;x.hasOwn(e,"_value")||(e._value=e.valueField===e.displayField?"":null,e._lastValue=e._lastValue||e._value)}get childItems(){const{_chipView:e,_picker:t}=this,i=super.childItems;return e&&i.push(e),t&&i.push(t),i}get innerElements(){var e;const t=(e=this._chipView)===null||e===void 0?void 0:e.element,{input:i,inputElement:r}=this;return t&&J.sync({targetElement:i,domConfig:r}),[t||r]}updateInlinePicker(e){e&&(this.element.classList.add("b-inline-picker"),this.getConfig("picker"),this.triggers.expand=null,this.pickerVisible=!0)}hidePicker(){if(!this.inlinePicker)return super.hidePicker(...arguments)}changeChipStore(e){return e&&!(e instanceof ue)&&(e=new ue(ue.mergeConfigs({storage:this.valueCollection},e))),e}updateChipStore(e,t){t?.destroy()}changeChipView(e,t){const i=this;if(i.element.classList[e?"add":"remove"]("b-uses-chipview"),e){const{input:r}=i;return i.chipStore||(i.chipStore={}),qd.reconfigure(t,e,{defaults:{parent:i,insertBefore:r,store:i.chipStore,closable:!i.readOnly,navigator:{type:"combochipnavigator",keyEventTarget:r}}})}t?.destroy()}updateChipView(e){var t;const i=this;i._chipViewEventDetacher=(t=i._chipViewEventDetacher)===null||t===void 0?void 0:t.call(i),i.chipStore=e?.store,e&&(e.element.appendChild(i.input),i._chipViewEventDetacher=A.on({element:e.element,mousedown:"onChipViewMousedown",thisObj:i}))}updateMultiSelect(e,t){const i=this,{input:r,element:n}=i,s=!i.isConfiguring;let{value:l}=i;if(n.classList[e?"add":"remove"]("b-multiselect"),e){const{chipView:a}=i,{parentNode:d}=r,c=a?.element;c&&c!==d&&(d.insertBefore(c,r),c.appendChild(r),i.chipView.refresh()),r.value="",s&&(l=B.asArray(l))}else{const a=i._chipView,{parentNode:d}=r,c=a?.element;if(c===d&&(c.parentNode.insertBefore(r,c),c.remove(),n.classList.remove("b-uses-chipview")),s&&typeof l!="string"){var o;l=(o=l)!==null&&o!==void 0&&o.length?l[0]:null}}s&&(i.value=l)}onChipViewMousedown(e){e.preventDefault(),this.containsFocus||this.focus()}onChipClose(e,t={}){(t.isKeyEvent&&this.input.value===""||!t.isKeyEvent)&&(this._isUserAction=!0,this.valueCollection.remove(e),this._isUserAction=!1)}updateFilterParamName(e){this.hideTrigger!==!1&&(this.hideTrigger=Boolean(e))}updateHideTrigger(e){this.element.classList[e?"add":"remove"]("b-hide-trigger")}updateKeyStrokeFilterDelay(e){this.filterOnInput.delay=e}updateReadOnly(e){super.updateReadOnly(...arguments),this._chipView&&(this._chipView.closable=!e)}updateDisabled(e){super.updateDisabled(...arguments),this._chipView&&(this._chipView.closable=!e)}updateFilterOperator(e){this.primaryFilter&&(this.primaryFilter.operator=e)}get minChars(){const e=this._minChars;return e??(this.remoteFilter?4:1)}get validateFilter(){return this._validateFilter&&!this.createOnUnmatched}get items(){return this.store.allRecords}updateBuildItems(e){e&&(this.items=e.call(this))}changeItems(e){var t;const i=this;if(e==null){if(i.store&&!i.store.isItemStore)return;e=[]}if(i.buildItems&&!((t=e)!==null&&t!==void 0&&t.length)&&(e=i.buildItems()),e instanceof ue){i.store=e;return}const r=i.displayField;let n,s=i.valueField,l;if(Array.isArray(e)?l=e.map(o=>{let a=o;return o instanceof fe?(n=o.constructor,s||(i.valueField=s=n.idField)):typeof o=="string"||typeof o=="number"?(s||(i.valueField=s=i.displayField),a={[s]:o,[r]:o}):(s||(i.valueField=s="value"),Array.isArray(o)&&(a={[s]:o[0],[r]:o[1]})),o.selected&&(i.value=a),a}):(s||(i.valueField=s="value"),l=[],Object.entries(e).forEach(([o,a])=>{l.push({[s]:o,[r]:a})})),i.store)i.store.data=l;else{const o=s===r?{name:"value",dataSource:r}:s;i.store=new ue({isItemStore:!0,data:l,idField:s,verifyNoGeneratedIds:!1,modelClass:n||class extends fe{static get idField(){return i.valueField}static set idField(a){super.idField=a}static get fields(){return[o,r]}}})}}get value(){const e=this,{valueCollection:t,valueField:i}=e;if(i==null)return e.multiSelect?t.values.slice():t.first;let r;return e.multiSelect?r=t.count?t.map(n=>n[i]):e._lastValue||[]:r=t.count?t.first[i]:e._lastValue,r}set value(e){super.value=e}get needsInputSync(){return this.usesChipView?!1:!this.editable}changeValue(e,t){var i;const r=this;if(e===t){r.syncInputFieldValue(!0);return}if(!r.multiSelect&&Array.isArray(e)&&e.length>1)throw new Error("Multiple values cannot be set to a non-multiSelect Combo");if(r.triggerConfig("items"),!r.inputting){var n;(n=r._chipView)===null||n===void 0||n.selected.clear()}r.store||(r.items=[]);const{valueField:s,displayField:l,store:o,valueCollection:a,_picker:d}=r,{storage:c}=o,h=(i=r.hidePickerOnSelect)!==null&&i!==void 0?i:!r.multiSelect,g=r._isUserAction||d?._isUserAction||h&&r.pickerVisible||!1;if(!r.remoteFilter&&o.isAjaxStore&&!o.count){o.ion({load:()=>r.value=e,once:!0,thisObj:r}),r._lastValue=e;return}if(r.remoteFilter){if(e!=null){if(x.isObject(e)||e.isModel)r.store.data=[e],r.valueCollection.splice(0,r.valueCollection.count,r.store.first);else{const m=r.isConfiguring;r.primaryFilter.setConfig({value:e,disabled:!1}),o.performFilter(!0).then(()=>{if(r.isDestroyed)return;const{isConfiguring:p}=r;r.isConfiguring=m,a.splice(0,a.count,o.allRecords),r.isConfiguring=p})}return}}else o.filtered&&(r.primaryFilter.disabled=!0,o.filter());let f;if(e!=null){const m=Array.isArray(e),p=m?e.slice():[e];for(let C=0,w=p.length;C<w;C++){let S=p[C];if(S instanceof fe)c.includes(S,!0)||o.add(S);else{const D=x.isObject(S);D&&(S=S[o.modelClass.fieldMap[s].dataSource]),f=c.getBy(l,S)||c.getBy(s,S)||a.getBy(l,S)||a.getBy(s,S),f instanceof Set&&(f=[...f][0]),f?(D&&f.set(p[C]),p[C]=f):(p.splice(C,1),w--,C--)}}const v=!p.length,y=a.generation;a.splice(0,a.count,p),v&&(r._value=m&&e.length===0?null:e,r._lastValue=r._value),(v||a.generation===y)&&r.syncInputFieldValue(),r.syncEmpty(),v&&!r.isConfiguring&&r.triggerFieldChange({value:e,oldValue:t,userAction:g,valid:r.isValid})}else if(a.count)a.clear();else{const m=r._value;r._value=null,r.syncInputFieldValue(),r.syncEmpty(),r.isConfiguring||r.triggerFieldChange({value:e,oldValue:m,userAction:g,valid:r.isValid})}r._lastValue=r._value}hasChanged(e,t){return this.multiSelect?!x.isEqual(e,t):super.hasChanged(...arguments)}onComboStoreChange({action:e}){e!=="filter"&&this.syncInputFieldValue(!0)}syncInputFieldValue(e){if(this.usesChipView){var t;(t=this.chipView)===null||t===void 0||t.refresh()}else super.syncInputFieldValue(e)}get usesChipView(){return Boolean(this.multiSelect&&this._chipView)}get isEmpty(){return this.valueCollection.count===0}get inputValue(){const e=this;let t=e.selected?e.selected[e.displayField]:e.value;return e.displayValueRenderer&&(t=e.callback(e.displayValueRenderer,e,[e.selected,e])),t??""}get nonEditableClickTarget(){var e;return this.multiSelect&&((e=this.chipView)===null||e===void 0?void 0:e.element)||super.nonEditableClickTarget}changeValueCollection(e,t){if(t?.destroy(),e)return e.isCollection||(e=new at({internalListeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),e}changePrimaryFilter(e){return e.isCollectionFilter?e.setConfig({disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive}):(typeof e=="function"&&(e={filterBy:e}),e=new ye(F({id:"primary",disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive},e))),e}changeStore(e){const t=this,i=[],{valueCollection:r,keyStrokeFilterDelay:n,filterParamName:s}=t;if(Array.isArray(e)){t.items=e;return}let l;if(e){if(e.isStore){const o=e.filters.get("primary");t.remoteFilter&&(e.filterParamName=s),l=e.remoteFilter||e.restfulFilter,o?t.primaryFilter=o:i.push(t.primaryFilter)}else typeof e=="string"?e=ue.getStore(e):(e=new(e.readUrl?cn:ue)(e),t.destroyStore=!0),l=t.remoteFilter||e.restfulFilter,l&&s&&(e.filterParamName=s,t.encodeFilterParams&&(e.encodeFilterParams=t.encodeFilterParams)),i.push(t.primaryFilter);if(!t.valueField&&!t.usingRecordAsValue&&(t.valueField=e.modelClass.idField),t.filterSelected){const o=a=>!t.containsFocus||!r.includes(a);l?(e.storage.autoFilter=!0,e.storage.addFilter({id:`${t.id}-selected-filter`,filterBy:o})):(i.push(o),e.reapplyFilterOnAdd=!0)}r.addIndex({property:t.displayField,unique:!1}),r.addIndex({property:t.valueField,unique:!0}),i.forEach(o=>e.addFilter(o,!0)),l?t.keyStrokeFilterDelay=Math.max(300,n||0):t.keyStrokeFilterDelay=n??10}return e}updateStore(e,t){const i=this,{_picker:r}=i;let n;i.destroyStore&&t&&t.destroy(),r&&(r.store=e),e.storage.addIndex({property:i.displayField,unique:!1}),e.storage.addIndex({property:i.valueField,unique:!0}),n={filter:"onStoreFilter"},i.displayValueRenderer&&((n||(n={})).change="onComboStoreChange"),i.detachListeners("store"),e?.storage&&i.valueCollection.match(e.storage),i.syncInputFieldValue(),n&&(n.name="store",n.thisObj=i,e.ion(n))}get remoteFilter(){var e;return Boolean(this.filterParamName||((e=this._store)===null||e===void 0?void 0:e.restfulFilter))}get record(){return this.selected}get records(){return this.valueCollection.values.slice()}get selected(){const{store:e}=this;return this.multiSelect?this.valueCollection.values.slice().sort((t,i)=>e.indexOf(t)-e.indexOf(i))[0]:this.valueCollection.first}onEditComplete(){const e=this,t=e.valueCollection.count;super.onEditComplete(),t&&(e.clearError(ti),e.syncInputFieldValue()),e.required&&!t&&e.setError(ms)}onTriggerClick(e){const t=this,i="key"in e;if(!(t.ignoreTriggerClick||t.remoteFilter&&t.filterOnEnter)){if(t.pickerVisible)t.hidePicker();else if(!t.readOnly&&!t.disabled){var r;switch((r=t.triggerAction)===null||r===void 0?void 0:r.toLowerCase()){case"all":t.doFilter(null,i);break;case"last":t.doFilter(t.lastQuery,i);break;default:t.doFilter(t.input.value,i)}}}}internalOnInput(e){const t=this;t.syncEmpty(),t.syncInputWidth(),t.filterOnInput(e),t.trigger("input",{value:t.input.value,event:e})}filterOnInput(e){const t=this,i=e.target.value,r=i.length;t.inputting=!0,t.inlinePicker||r>=t.minChars&&(!t.filterOnEnter||e.key==="Enter")?t.doFilter(i):(t.validateFilter&&!t.remoteFilter&&t[r?"setError":"clearError"](ti),t.hidePicker()),t.inputting=!1}syncInputWidth(){const e=this;if(e.usesChipView){const t=e.input,i=e._inputPadding||(e._inputPadding=b.getEdgeSize(t,"padding","lr")),r=t.value||"",n=b.measureText(r+"W",t,!1,e.element)+i.width;t.style.flex=`1 1 ${Math.ceil(n)}px`}}doFilter(e,t){var i;const r=this,{store:n,picker:s}=r,l=e==null||e==="";r.lastQuery=e,r.primaryFilter.setConfig({value:e,disabled:l}),r.remoteFilter&&n.clear(!0);const o=()=>{const{navigator:a,isVisible:d}=s;n.count?!l&&a&&(a.activeItem=0):!r.remoteFilter&&!l&&(a&&(a.activeItem=null),r.validateFilter&&r.setError(ti)),d&&s.realign()};(i=r.filterPromise=n.filter())===null||i===void 0||i.then(()=>{r.filterPromise=null,o()}),r.inlinePicker||(s!=null&&s.isVisible?s.lastAlignSpec.zone===0&&s.realign():r.showPicker(t)),r.filterPromise||o()}onStoreFilter({source:e}){const t=this,i=t._picker,r=i?.element.dataset,{count:n}=e;t.remoteFilter&&(n?i&&(i.navigator.activeItem=0):t.validateFilter&&t.setError(ti),t.filterSelected&&t.valueCollection.count&&(e.storage.onFiltersChanged({action:"splice",oldCount:1}),i&&i.refresh())),r&&(t.createOnUnmatched&&!n?r.addNewValue=t.L("L{addNewValue}")(t.primaryFilter.value):r==null||delete r.addNewValue)}onValueCollectionChange({source:e}){var t;const i=this,{multiSelect:r,_picker:n}=i,s=(t=i.hidePickerOnSelect)!==null&&t!==void 0?t:!r,l=r?e.values.slice():e.first,o=e.values.slice(),a=i._isUserAction||n?._isUserAction||s&&i.pickerVisible||!1,d=i._value;s&&i.hidePicker(),!e.count&&i.required?i.setError(ms):(i.clearError(ms),i.clearError(ti)),i.validateFilter&&l&&i.clearError(ti),i.filterSelected&&(i.remoteFilter?(i.store.storage.onFiltersChanged({action:"splice",oldCount:1}),i._picker&&i._picker.refresh()):i.store.filter()),i._value=null,i._lastValue=null;const c=i.cacheCurrentValue(i.value);i.syncInputFieldValue(),i.syncEmpty(),i.isConfiguring||(i.triggerFieldChange({value:c,oldValue:d,userAction:a,valid:i.isValid}),i.trigger("select",{record:l,records:o,userAction:a}),i.defaultAction==="select"&&i.trigger("action",{value:c,record:l,records:o,userAction:a}))}cacheCurrentValue(e){return this._value=e}onValueCollectionNoChange({toAdd:e}){!this.inlinePicker&&!this.multiSelect&&e.length&&this.pickerVisible&&this.picker.hide()}showPicker(){const e=this,{picker:t}=e;if(!(e.readOnly||e.inlinePicker)){if(t.multiSelect=e.multiSelect,super.showPicker(...arguments),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),t.restoreActiveItem)if(e.multiSelect){var i;t.restoreActiveItem(((i=t.navigator)===null||i===void 0?void 0:i.previousActiveItem)||e.selected||0,!0)}else t.restoreActiveItem(e.selected||0,!0);e.input.focus()}}changePicker(e,t){var i;const r=this,n=r.pickerWidth||((i=e)===null||i===void 0?void 0:i.width),s=di.mergeConfigs({owner:r,store:r.store,selected:r.valueCollection,multiSelect:r.multiSelect,cls:r.listCls,displayField:r.displayField,forElement:r[r.pickerAlignElement],align:{matchSize:n==null,anchor:r.overlayAnchor,target:r[r.pickerAlignElement],minHeight:r.inlinePicker?null:Math.min(3,r.store.count)*40},[r.listItemTpl?"itemTpl":void 0]:r.listItemTpl,width:n,navigator:{keyEventTarget:r.input}},e);return r.inlinePicker&&Object.assign(s,{floating:!1,align:null,activateOnMouseover:!1,maxHeight:null,appendTo:r.element}),e=di.reconfigure(t,e?s:null,r),e&&(e.element.classList.add("b-combo-picker"),e.element.dataset.emptyText=r.emptyText?r.L(r.emptyText):r.L("L{noResults}"),e.ion({navigate:"onPickerNavigate",thisObj:r})),e}onPickerNavigate({event:e}){e.target.matches("[data-add-new-value]")&&this.addNewRecord(this.primaryFilter.value)}onPickerHide(){const e=this;super.onPickerHide(),e.multiSelect&&e.clearTextOnPickerHide&&(e.input.value="")}async internalOnKeyEvent(e){const t=this,i=t.input[t.inputValueAttr],r=i.length,{key:n}=e,{store:s,_picker:l,multiSelect:o}=t;if(e.type==="keydown"&&l!==null&&l!==void 0&&l.isVisible&&l.navigator){const{activeItem:a}=l.navigator;if(a&&o&&n===t.multiValueSeparator){t.input.value="",t.primaryFilter.setConfig({value:"",disabled:!0}),s.filter(),l.onItemClick(a,e),l.hide(),e.preventDefault();return}if(!a&&t.createOnUnmatched&&(o&&n===t.multiValueSeparator||n==="Enter")){e.preventDefault(),await t.addNewRecord(i);return}}super.internalOnKeyEvent(...arguments),e.type==="keydown"&&n==="Enter"&&t.filterOnEnter&&r>=t.minChars&&(e.stopPropagation(),t.filterOnInput.now(e))}async addNewRecord(e){const t=this,{store:i,_picker:r,valueCollection:n,multiSelect:s,primaryFilter:l}=t,o=i.remoteFilter&&i.autoCommit;t.filterPromise&&await t.filterPromise,o||(l.setConfig({value:"",disabled:!0}),i.filter());const[a]=i.add(t.callback(t.createOnUnmatched,t,[e,t]));if(i.isCommitting){let h;try{await i.commitPromise}catch(g){var d,c;h=(d=g.response)===null||d===void 0||(c=d.parsedJson)===null||c===void 0?void 0:c.error}a.isPhantom&&(t.clearError(),t.setError(h||vm,!1,!0),i.remove(a),i.removed.remove(a))}o&&(l.setConfig({value:"",disabled:!0}),i.filter()),t.input.value="",i.includes(a)&&n.splice(s?n.count:0,s?0:n.count,a),r?.hide()}changeCreateOnUnmatched(e){return e===!0&&(e=this.defaultRecordCreater),e}defaultRecordCreater(e){return this.store.createRecord({[this.displayField]:e})}updateLocalization(){super.updateLocalization();const e=this,{displayField:t}=e;let{localizedDisplayFieldsMap:i}=e;if(e.localizeDisplayFields===!0){i||(e.localizedDisplayFieldsMap=i=new Map),!e.store&&e.buildItems&&(e.items=e.buildItems());for(const n of e.items)if(n.id){var r;let s=i.get(n.id);!s&&(r=n[t])!==null&&r!==void 0&&r.startsWith("L{")&&(s=n[t],i.set(n.id,s)),s&&(n[t]=e.L(s))}e.syncInputFieldValue()}}}T(kt,"delayable",{filterOnInput:0});class qd extends el{static get $name(){return"ComboChipView"}static get type(){return"combochipview"}static get defaultConfig(){return{closeHandler:"up.onChipClose",itemsFocusable:!1,multiSelect:!0,itemTpl(e){return _.encodeHtml(e[this.owner.displayField])},scrollable:{overflowY:"auto"}}}}class bm extends Qi{static get $name(){return"ComboChipNavigator"}static get type(){return"combochipnavigator"}static get configurable(){return{allowShiftKey:!0}}onTargetClick(e){const t=this,i=e.target.closest(t.itemSelector);i&&!e.target.classList.contains("b-close-icon")&&(!e.shiftKey&&!i.contains(e.target.closest("[data-noselect]"))&&t.ownerCmp.selected.clear(),t.inClickHandler=!0,t.activeItem=i,t.inClickHandler=!1)}onKeyDown(e){e.key!=="Enter"&&super.onKeyDown(e)}updateActiveItem(e,t){const i=this.ownerCmp;super.updateActiveItem(e,t),e&&!this.inClickHandler&&i.selected.add(i.getRecordFromElement(e))}navigatePrevious(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.previous?super.navigatePrevious(e):this.activeItem=null}navigateNext(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.next?super.navigateNext(e):this.activeItem=null}}kt.initClass();qd.initClass();bm.initClass();kt._$name="Combo";class ym extends Je{static get $name(){return"UndoRedoBase"}static get type(){return"undoredobase"}static get configurable(){return{project:null,stm:null,text:null,color:null,showZeroActionBadge:null,cls:"b-undo-controls b-toolbar",layoutStyle:{alignItems:"stretch",flexFlow:"row nowrap",overflow:"visible"},items:{undoBtn:{type:"button",icon:"b-icon-undo",tooltip:"L{UndoRedo.UndoLastAction}",onAction:"up.onUndo"},transactionsCombo:{type:"combo",valueField:"idx",editable:!1,store:{},emptyText:"L{UndoRedo.NoActions}",onAction:"up.onTransactionSelected",displayValueRenderer:"up.transactionsDisplayValueRenderer"},redoBtn:{type:"button",icon:"b-icon-redo",tooltip:"L{UndoRedo.RedoLastAction}",onAction:"up.onRedo"}}}}afterConstruct(){this.updateUndoRedoControls()}updateStm(e){this.detachListeners("undoredo"),e?.ion({name:"undoredo",recordingstop:"updateUndoRedoControls",restoringstop:"updateUndoRedoControls",queueReset:"updateUndoRedoControls",disabled:"updateUndoRedoControls",thisObj:this})}changeItems(e){const{undoBtn:t,redoBtn:i}=e;return this.color&&(t&&(t.color=this.color),i&&(i.color=this.color)),this.text&&(t&&(t.text="L{UndoRedo.Undo}"),i&&(i.text="L{UndoRedo.Redo}")),super.changeItems(e)}updateProject(e){this.stm=e.stm}fillUndoRedoCombo(){const{transactionsCombo:e}=this.widgetMap;e&&(e.items=this.stm.queue.map((t,i)=>[i,t||`Transaction ${i}`]))}updateUndoRedoControls(){const{stm:e,showZeroActionBadge:t}=this,{undoBtn:i,redoBtn:r}=this.widgetMap;i.badge=e.position||(t?"0":""),r.badge=e.length-e.position||(t?"0":""),i.disabled=!e.canUndo,r.disabled=!e.canRedo,this.fillUndoRedoCombo()}transactionsDisplayValueRenderer(e,t){var i;const r=((i=this.stm)===null||i===void 0?void 0:i.position)||0;return`${r} undo actions / ${t.store.count-r} redo actions`}onUndo(){this.stm.canUndo&&this.stm.undo()}onRedo(){this.stm.canRedo&&this.stm.redo()}onTransactionSelected(e){const t=this.stm,i=e.value;i>=0&&(t.canUndo&&i<t.position?t.undo(t.position-i):t.canRedo&&i>=t.position&&t.redo(i-t.position+1))}}ym._$name="UndoRedoBase";class Kd extends kt{static get $name(){return"BooleanCombo"}static get type(){return"booleancombo"}static get configurable(){return{positiveValue:!0,positiveText:null,negativeValue:!1,negativeText:null,store:{value:[],$config:"lazy"},value:!1}}changeStore(e,t){const i=this;return super.changeStore(new ue({data:[{id:i.positiveValue,text:i.positiveText||i.L("L{Object.Yes}")},{id:i.negativeValue,text:i.negativeText||i.L("L{Object.No}")}]}),t)}}Kd.initClass();Kd._$name="BooleanCombo";class jt extends Je.mixin(Us){onChildAdd(e){super.onChildAdd(e),e.ion({click:"resetValueCache",toggle:"onItemToggle",thisObj:this,prio:1e4})}onChildRemove(e){e.un({toggle:"resetValueCache",click:"resetValueCache",thisObj:this}),super.onChildRemove(e)}onItemToggle(e){const t=this;t.resetValueCache(),!t.isSettingValue&&(!t.toggleGroup||e.pressed)&&t.triggerFieldChange({value:t.value,userAction:!0,event:e})}resetValueCache(){this._value=null}createWidget(e){const t=this;return t.constructor.resolveType(e.type||"button").isButton&&(t.color&&!e.color&&(e.color=t.color),t.toggleGroup&&!e.toggleGroup&&(typeof t.toggleGroup=="boolean"&&(t.toggleGroup=jt.generateId("toggleGroup")),e.toggleGroup=t.toggleGroup)),t.columns&&(e.width=`${100/t.columns}%`),e=super.createWidget(e),t.relayEvents(e,["click","action","toggle"]),e}updateRotate(e){this.eachWidget(t=>{t.rotate!==!1&&(t.rotate=e)})}get value(){if(!this._value){const e=[];this.items.forEach(t=>{t.pressed&&t.value!==void 0&&e.push(t.value)}),this._value=e.join(this.valueSeparator)}return this._value}set value(e){const t=this,i=t.value;Array.isArray(e)||(e==null?e=[]:typeof e=="string"?e=e.split(t.valueSeparator):e=[e]),t._value=e.join(t.valueSeparator),t.isSettingValue=!0,t.items.forEach(r=>{r.value!==void 0&&(r.pressed=e.includes(r.value))}),t.isSettingValue=!1,!t.isConfiguring&&i!==t.value&&t.triggerFieldChange({value:t.value,userAction:!1})}updateDisabled(e){this.items.forEach(t=>t.disabled=e||!t.ignoreParentReadOnly&&this.readOnly)}updateReadOnly(e){super.updateReadOnly(e),this.updateDisabled(this.disabled)}get widgetClassList(){const e=super.widgetClassList;return this.columns&&e.push("b-columned"),e}}T(jt,"$name","ButtonGroup");T(jt,"type","buttongroup");T(jt,"configurable",{defaultType:"button",cls:null,items:null,color:null,toggleGroup:null,valueSeparator:",",columns:null,hideWhenEmpty:!0,defaultBindProperty:"value"});jt.initClass();jt._$name="ButtonGroup";class qi extends Ke{static get $name(){return"CalendarPanel"}static get type(){return"calendarpanel"}static get configurable(){return{textContent:!1,date:{$config:{equal:"date"},value:null},month:{},year:null,weekStartDay:null,sixWeeks:!0,showWeekNumber:null,showWeekColumn:null,disabledDates:null,headerRenderer:null,weekRenderer:null,cellRenderer:null,disableWeekends:null,hideNonWorkingDays:null,hideNonWorkingDaysCls:"b-hide-nonworking-days",nonWorkingDays:null,tip:null,dayCellCls:"b-calendar-cell",dayHeaderCls:"b-calendar-day-header",disabledCls:"b-disabled-date",otherMonthCls:"b-other-month",weekendCls:"b-weekend",todayCls:"b-today",nonWorkingDayCls:"b-nonworking-day",dayNameFormat:"ddd",minRowHeight:{$config:["lazy"],value:null},minColumnWidth:{$config:["lazy"],value:null},disableOtherMonthCells:null,disableOtherMonthCellsCls:"b-disable-othermonth-cells",hideOtherMonthCells:null,hideOtherMonthCellsCls:"b-hide-othermonth-cells",animateTimeShift:!0}}construct(e){super.construct(e),this.refreshCount||this.refresh()}onPaint({firstPaint:e}){var t;(t=super.onPaint)===null||t===void 0||t.call(this,...arguments),e&&(this.refreshCount||this.refresh(),this.getConfig("minColumnWidth"),this.getConfig("minRowHeight"))}get overflowElement(){return this.weeksElement}doDestroy(){var e;(e=this.tip)===null||e===void 0||e.destroy(),super.doDestroy()}changeMinRowHeight(e){const t=parseInt(b.getStyleValue(this.element,"--min-row-height"),10)||75;return isNaN(e)?e:Math.max(parseInt(e)||0,t)}updateMinRowHeight(e){this.weekElements.forEach(t=>b.setLength(t,"minHeight",e)),this.scrollable={overflowY:e?"auto":!1}}changeMinColumnWidth(e){const t=parseInt(b.getStyleValue(this.element,"--min-column-width"),10)||75;return e==null?e:Math.max(parseInt(e)||0,t)}updateMinColumnWidth(e){const t=this;t.weekdayCells.forEach(i=>b.setLength(i,"minWidth",e)),t.cellElements.forEach(i=>i.matches(`.${t.dayCellCls}`)&&b.setLength(i,"minWidth",e)),t.scrollable={overflowX:e?"auto":!1},t.overflowElement.classList[e?"add":"remove"]("b-min-columnwidth")}getDateFromDomEvent(e){const t=(e.nodeType===Element.ELEMENT_NODE?e:e.target).closest(`#${this.id} [data-date]`);if(t)return E.parseKey(t.dataset.date)}changeTip(e,t){const i=this;return me.reconfigure(t,e,{owner:i,defaults:{type:"tooltip",owner:i,id:`${i.id}-cell-tip`,forElement:i.bodyElement,forSelector:`.${i.dayCellCls}`}})}updateTip(e){this.detachListeners("tip"),e?.ion({pointerOver:"onTipOverCell",name:"tip",thisObj:this})}updateElement(e,t){const i=this;super.updateElement(e,t),i.updateHideNonWorkingDays(i.hideNonWorkingDays),i.weekdayCells=Array.from(e.querySelectorAll(".b-calendar-day-header")),i.weekElements=Array.from(e.querySelectorAll(".b-calendar-week")),i.weekDayElements=Array.from(e.querySelectorAll(".b-calendar-days")),i.cellElements=[];for(let r=0,{length:n}=i.weekDayElements;r<n;r++)i.cellElements.push(i.weekDayElements[r].previousSibling,...i.weekDayElements[r].children)}changeDate(e){if(e=typeof e=="string"?E.parse(e):new Date(e),isNaN(e))throw new Error("CalendarPanel date ingestion must be passed a Date, or a YYYY-MM-DD date string");return E.clearTime(e)}updateDate(e){this.month.date=e}updateDayNameFormat(){const e=new Date("2000-06-04T12:00:00");this.shortDayNames=[];for(let t=4;t<11;t++)e.setDate(t),this.shortDayNames.push(E.format(e,this.dayNameFormat))}get weekStartDay(){return typeof this._weekStartDay=="number"?this._weekStartDay:E.weekStartDay}updateWeekStartDay(e){const t=this;if(t._month){t.month.weekStartDay=e,t.dayNames=[];for(let i=0;i<7;i++)t.dayNames[i]=t.shortDayNames[t.canonicalDayNumbers[i]];t.refreshCount&&t.refresh()}}updateHideNonWorkingDays(e){var t;this.contentElement.classList.toggle(this.hideNonWorkingDaysCls,Boolean(e)),(t=this.scrollable)===null||t===void 0||t.syncOverflowState(),this._month&&(this.month.hideNonWorkingDays=e),this.isConfiguring||this.refresh()}updateHideOtherMonthCells(e){var t;this.element.classList.toggle(this.hideOtherMonthCellsCls,Boolean(e)),(t=this.scrollable)===null||t===void 0||t.syncOverflowState()}updateDisableOtherMonthCells(e){var t;this.element.classList.toggle(this.disableOtherMonthCellsCls,Boolean(e)),(t=this.scrollable)===null||t===void 0||t.syncOverflowState()}get nonWorkingDays(){return this._nonWorkingDays||this._localeNonWorkingDays||(this._localeNonWorkingDays=E.nonWorkingDays)}get weekends(){return this._localeWeekends||(this._localeWeekends=E.weekends)}changeNonWorkingDays(e){return x.assign({},e)}updateNonWorkingDays(e){if(this._month){var t;this.month.nonWorkingDays=e,this.refresh(),(t=this.scrollable)===null||t===void 0||t.syncOverflowState()}}get visibleDayColumnIndex(){return this.month.visibleDayColumnIndex}get dayColumnIndex(){return this.month.dayColumnIndex}get canonicalDayNumbers(){return this.month.canonicalDayNumbers}get visibleColumnCount(){return this.month.visibleColumnCount}get weekLength(){return this.month.weekLength}get startDate(){return this.month.startDate}get duration(){return E.diff(this.month.startDate,this.month.endDate,"day")+1}get endDate(){const{endDate:e}=this.month;if(e)return E.add(e,1,"day")}changeMonth(e,t){const i=this;if(!(e instanceof Bt)){if(typeof e=="number"){if(t){t.month=e;return}const r=i.date||E.clearTime(new Date);r.setMonth(e),e={date:r}}e=Bt.new({weekStartDay:i.weekStartDay,nonWorkingDays:i.nonWorkingDays,hideNonWorkingDays:i.hideNonWorkingDays,sixWeeks:i.sixWeeks},e)}return e.ion({dateChange:"onMonthDateChange",thisObj:i}),e}onMonthDateChange({source:e,newDate:t,oldDate:i,changes:r}){const n=this;n.year=e.year,n.isConfiguring||((!n.getCell(t)||r.m||r.y)&&(n.refresh(),n.animateTimeShift&&n.isVisible&&b.slideIn(n.contentElement,t>i?1:-1)),n.trigger("dateChange",{changes:r,value:t,oldValue:i}))}updateYear(e){this.month.year=e}updateShowWeekNumber(e){this.updateShowWeekColumn(e)}updateShowWeekColumn(e){const t=this;t.element.classList[e?"add":"remove"]("b-show-week-column"),t.floating&&(t.isAligning||t.realign())}updateSixWeeks(e){this.month&&(this.month.sixWeeks=e,this.refresh())}refresh(){this.doRefresh()}doRefresh(){var e;this.getConfig("element");const t=this,i=t.timeZone!=null?t.timeZone:(e=t.project)===null||e===void 0?void 0:e.timeZone,r=i!=null?Wd.toTimeZone(new Date,i):new Date,{weekElements:n,weekDayElements:s,date:l,month:o,dayCellCls:a,dayHeaderCls:d,disabledCls:c,otherMonthCls:h,weekendCls:g,todayCls:f,nonWorkingDayCls:m,nonWorkingDays:p,canonicalDayNumbers:v,sixWeeks:y}=t;if(r.setHours(0,0,0,0),!l){t.date=r;return}t.trigger("beforeRefresh"),t.getConfig("dayNameFormat");for(let D=0;D<7;D++){const I=t.weekdayCells[D],R=t.canonicalDayNumbers[D],H={[d]:1,[g]:E.weekends[R],[m]:p[R]};t.headerRenderer?(I.innerHTML="",t.callback(t.headerRenderer,t,[I,D,R])):b.setInnerText(I,t.shortDayNames[R]),b.syncClassList(I,H),I.dataset.columnIndex=D,I.dataset.cellDay=R}let C=0,w=0,S=6;for(let D=6;D>=0;D--)if(!p[v[D]]){S=D;break}n[4].classList.toggle("b-hide-display",o.weekCount<5&&!y),n[5].classList.toggle("b-hide-display",o.weekCount<6&&!y),o.eachWeek((D,I)=>{const R=s[C],H=[R.previousSibling,...R.children];n[C].dataset.week=`${D[0]},${D[1]}`,t.weekRenderer?t.callback(t.weekRenderer,t,[H[0],D]):H[0].innerText=D[1];for(let L=0;L<7;L++){const V=I[L],U=V.getDay(),Y=p[U],j=H[L+1],z={[a]:1,[c]:t.isDisabledDate(V),[h]:V.getMonth()!==o.month,[g]:E.weekends[U],[f]:V.getTime()===r.getTime(),[m]:Y,"b-last-working-day":L===S,"b-first-visible-cell":!(V-(t.firstVisibleDate||-1)),"b-last-visible-cell":!(V-(t.lastVisibleDate||-1)),[`b-day-of-week-${U}`]:1};b.syncClassList(j,z),j.dataset.date=E.makeKey(V),j.dataset.cellIndex=w,j.dataset.columnIndex=L,j.lastDomConfig&&(delete j.lastDomConfig.class,delete j.lastDomConfig.className),t.cellRenderer?t.callback(t.cellRenderer,t,[{cell:j,date:V,day:U,row:n[C],rowIndex:C,cellIndex:w,columnIndex:L,visibleColumnIndex:t.visibleDayColumnIndex[U],week:D}]):j.innerHTML=V.getDate(),w++}C++}),t.visibleWeekCount=C,t.floating&&(t.isAligning||t.realign()),t.refreshCount=(t.refreshCount||0)+1,t.trigger("refresh")}isDisabledDate(e){const t=e.getDay(),{disabledDates:i,nonWorkingDays:r}=this;if(this.disableWeekends&&r[t])return!0;if(i)return Array.isArray(i)?(e=E.clearTime(e,!0),i.some(n=>!(E.clearTime(n,!0)-e))):this.callback(this.disabledDates,this,[e])}get bodyConfig(){const e=super.bodyConfig,t=[];e.children=[{tag:"div",className:"b-calendar-row b-calendar-weekdays",reference:"weekdaysHeader",children:[{class:"b-week-number-cell"},...B.fill(7,{class:this.dayHeaderCls}),b.scrollBarPadElement]},{className:"b-weeks-container notranslate",reference:"weeksElement",children:t}];for(let i=0;i<6;i++){const r={className:"b-calendar-row b-calendar-week",dataset:{rowIndex:i},children:[{className:"b-week-number-cell"},{className:"b-calendar-days",children:[{},{},{},{},{},{},{}],syncOptions:{ignoreRefs:!0,strict:!1}}]};t.push(r)}return e}get firstVisibleDate(){if(this.hideOtherMonthCells){const{year:e,month:t}=this.month;return new Date(e,t,1)}for(const e=this,t=e.month.startDate;;t.setDate(t.getDate()+1))if(!e.hideNonWorkingDays||!e.nonWorkingDays[t.getDay()])return t}get lastVisibleDate(){const e=E.add(this.endDate,-1,"d");if(this.hideOtherMonthCells)return e;for(const t=this,i=e;;i.setDate(i.getDate()-1))if(!t.hideNonWorkingDays||!t.nonWorkingDays[i.getDay()])return i}getCell(e,t){typeof e!="string"&&(e=E.makeKey(e));const i=this.weeksElement.querySelector(`[data-date="${e}"]`);if(i&&(!t||!i.classList.contains(this.otherMonthCls)))return i}onTipOverCell({source:e,target:t}){e.date=E.parseKey(t.dataset.date)}updateLocalization(){this._localeNonWorkingDays=this._localeWeekends=null,this.updateDayNameFormat(),this.updateWeekStartDay(this.weekStartDay),super.updateLocalization()}}qi.initClass();qi._$name="CalendarPanel";const Cm=u=>!u.value;class vi extends xe{static get $name(){return"Checkbox"}static get type(){return"checkbox"}static get alias(){return"check"}static get configurable(){return{inputType:"checkbox",autoCollapse:null,containerDefaults:{syncableConfigs:{disabled:e=>e.disabled||!e.value},syncConfigTriggers:{autoCollapse:1,value:1}},text:"",checkedValue:!0,uncheckedValue:!1,color:null,value:"",toggleGroup:null,localizableProperties:["label","text"]}}construct(e){"checked"in e&&(e=x.assign({},e),e.value=e.checked,delete e.checked),super.construct(e),this.syncHasText()}get textLabelCls(){return"b-checkbox-label"}get innerElements(){return[this.inputElement,{tag:"label",class:this.textLabelCls,for:`${this.id}-input`,reference:"textLabel",html:this.text||""}]}get inputElement(){const e=super.inputElement;return this.toggleGroup&&(e.dataset={group:this.toggleGroup}),e.listeners={click:"internalOnClick",change:"internalOnChange",input:"internalOnInput"},e}get checked(){return this.value}set checked(e){this.value=e}syncHasText(){this.element.classList[this.text?"add":"remove"]("b-text")}updateText(e){this.textLabel&&(this.syncHasText(),this.textLabel.innerHTML=e)}afterSyncChildConfigs(e){super.afterSyncChildConfigs(e);let{autoCollapse:t}=this;t&&(t=t===!0?Cm:t,e.collapsed=t(this))}assignFieldValue(e,t,i){this.value=i===this.checkedValue||(i===this.uncheckedValue?!1:null)}fetchInputValue(){this.readOnly||(this.value=this.input.checked)}gatherValue(e){var t;const i=this,r=i.value?i.checkedValue:i.uncheckedValue,n=r!==void 0,{valueName:s}=i;n&&(e[s]=r),i.gatherValues(e,n),r===!0&&((t=e[s])===null||t===void 0?void 0:t.value)===r&&delete e[s].value}changeValue(e){return e==="false"?!1:Boolean(e)}updateValue(e){var t;const i=this,r=i.input.checked!==e;i.input.checked=e,(t=i.container)===null||t===void 0||t.syncChildConfigs(),r&&!i.inputting&&!i.isConfiguring&&(i.uncheckToggleGroupMembers(),i.triggerChange(!1))}get inputValueAttr(){return"checked"}updateColor(e,t){const i=this.element.classList;t&&i.remove(t),e&&i.add(e)}getToggleGroupMembers(){const e=this,{checked:t,toggleGroup:i,input:r,type:n}=e,s=[];return t&&i&&b.forEachSelector(e.rootElement,`input[type=${n}][data-group=${i}]`,l=>{if(l!==r){const o=k.fromElement(l);o&&s.push(o)}}),s}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach(e=>e.checked=!1)}check(){this.checked=!0}uncheck(){this.checked=!1}toggle(){this.checked=!this.checked}internalOnClick(e){return this.readOnly?(e.preventDefault(),!1):this.trigger("click",{event:e})}internalOnChange(e){const t=this;if(t.readOnly&&t.value!==t.input.checked){t.input.checked=t.value;return}t.value=t.input.checked,t.inputting||(t.inputting=!0,t.triggerChange(!0),t.inputting=!1)}updateInputReadOnly(e){}triggerChange(e){const t=this,{checked:i}=t.input,r={checked:i,value:i,userAction:e,valid:!0};if(!i&&e&&t.toggleGroup&&t.getToggleGroupMembers().filter(s=>s.isVisible&&!s.disabled).length||t.trigger("beforeChange",r)===!1)t.input.checked=t._value=!i;else return t.triggerFieldChange(r,!1),e&&t.uncheckToggleGroupMembers(),t.trigger("action",r),t.trigger("change",r),!0}}vi.initClass();vi._$name="Checkbox";class Vt extends Ke{construct(e){super.construct(F({year:new Date().getFullYear()},e)),A.on({element:this.contentElement,click:"onYearClick",delegate:".b-yearpicker-year",thisObj:this})}get focusElement(){return this.getYearButton(this.year)||this.getYearButton(this.startYear)}getYearButton(e){return this.contentElement.querySelector(`.b-yearpicker-year[data-year="${e}"]`)}get value(){return this.year}set value(e){this.year=e}onYearClick({target:e}){const t=Math.min(Math.max(parseInt(e.innerText),this.minYear||1),this.maxYear||9999);this.year===t?this.trigger("select",{oldValue:t,value:t}):this.year=t}handleTitleClick(e){this.trigger("titleClick",e)}previous(){this.startYear=this.startYear-this.yearButtonCount}next(){this.startYear=this.endYear+1}ingestYear(e){if(!isNaN(e))return x.isDate(e)?e.getFullYear():e}changeYear(e){if(e=this.ingestYear(e))return Math.min(Math.max(e,this.minYear||1),this.maxYear||9999)}updateYear(e,t){const i=this;!i.startYear||e>i.endYear?i.startYear=e:e<i.startYear&&(i.startYear=e-(i.yearButtonCount-1)),i.isConfiguring||i.trigger("select",{oldValue:t,value:e})}get endYear(){return this.startYear+this.yearButtonCount-1}changeStartYear(e){if(e=this.ingestYear(e))return e=this.minYear?Math.max(e,this.minYear):e,this.maxYear?Math.min(e,this.maxYear-(this.yearButtonCount-1)):e}async updateStartYear(e,t){this.isVisible&&b.slideIn(this.contentElement,Math.sign(e-t))}composeBody(){this.getConfig("year");const{startYear:e}=this,t=super.composeBody(),i=t.children[this.tbar?1:0].children=[];this.widgetMap.title.text=`${`000${e}`.slice(-4)} - ${`000${this.endYear}`.slice(-4)}`;for(let r=0,n=e;r<this.yearButtonCount;r++,n++)i.push({tag:"button",dataset:{year:n},class:{"b-yearpicker-year":1,"b-selected":n===this.year},text:`000${n}`.slice(-4)});return t}}T(Vt,"$name","YearPicker");T(Vt,"type","yearpicker");T(Vt,"configurable",{textContent:!1,tbar:{overflow:null,items:{previous:{type:"tool",cls:"b-icon b-icon-previous",onAction:"up.previous",weight:100},title:{type:"button",cls:"b-yearpicker-title",weight:200,onAction:"up.handleTitleClick"},next:{type:"tool",cls:"b-icon b-icon-next",onAction:"up.next",weight:300}}},itemCls:"b-year-container",yearButtonCount:12,year:null,minYear:null,maxYear:null,startYear:null});Vt.initClass();Vt._$name="YearPicker";class Xd extends pi{static get $name(){return"DisplayField"}static get type(){return"displayfield"}static get alias(){return"display"}static get configurable(){return{readOnly:!0,editable:!1,cls:"b-display-field",template:null,ariaElement:"displayElement"}}get focusElement(){}changeReadOnly(){return!0}changeEditable(){return!1}get inputElement(){return{tag:"span",id:`${this.id}-input`,reference:"displayElement",html:this.template?this.template(this.value):_.encodeHtml(this.value)}}}Xd.initClass();Xd._$name="DisplayField";const _a=()=>E.getMonthNames().map((u,e)=>[e,u]),Ha=(u,e)=>u.valueOf()-e.valueOf(),wm=Object.freeze([]);class xm extends kt{static get $name(){return"ReadOnlyCombo"}static get type(){return"readonlycombo"}static get configurable(){return{editable:!1,inputAttributes:{tag:"div",tabIndex:-1},inputValueAttr:"innerHTML",highlightExternalChange:!1,monitorResize:!1,triggers:{expand:!1},picker:{align:{align:"t-b",axisLock:!0,matchSize:!1},cls:"b-readonly-combo-list",scrollable:{overflowX:!1}}}}}xm.initClass();class tl extends qi{static get $name(){return"DatePicker"}static get type(){return"datepicker"}static get delayable(){return{refresh:"raf"}}static get configurable(){return{activeDate:{value:new Date,$config:{equal:"date"}},focusable:!0,textContent:!1,tbar:{overflow:null,items:{prevYear:{cls:"b-icon b-icon-first",onAction:"up.gotoPrevYear",tooltip:"L{DatePicker.gotoPrevYear}"},prevMonth:{cls:"b-icon b-icon-previous",onAction:"up.gotoPrevMonth",tooltip:"L{DatePicker.gotoPrevMonth}"},fields:{type:"container",cls:"b-datepicker-title",items:{monthField:{type:"readonlycombo",cls:"b-datepicker-monthfield",items:_a(),internalListeners:{select:"up.onMonthPicked"}},yearButton:{type:"button",cls:"b-datepicker-yearbutton",internalListeners:{click:"up.onYearPickerRequested"}}}},nextMonth:{cls:"b-icon b-icon-next",onAction:"up.gotoNextMonth",tooltip:"L{DatePicker.gotoNextMonth}"},nextYear:{cls:"b-icon b-icon-last",onAction:"up.gotoNextYear",tooltip:"L{DatePicker.gotoNextYear}"}}},yearPicker:{value:{type:"YearPicker",yearButtonCount:16,trapFocus:!0,positioned:!0,hidden:!0,internalListeners:{titleClick:"up.onYearPickerTitleClick",select:"up.onYearPicked"}},$config:"lazy"},date:null,minDate:{value:null,$config:{equal:"date"}},maxDate:{value:null,$config:{equal:"date"}},focusDisabledDates:null,multiSelect:!1,selection:{$config:{equal:(e,t)=>e&&e.equals(t)},value:null},editMonth:!0,dayNameFormat:"dd",trapFocus:!0,role:"grid",focusDescendant:!0,alwaysRefreshOnMonthChange:null}}static get prototypeProperties(){return{outOfRangeCls:"b-out-of-range",activeCls:"b-active-date",selectedCls:"b-selected-date"}}construct(e){const t=this;super.construct(e),t.externalCellRenderer=t.cellRenderer,t.cellRenderer=t.internalCellRenderer,t.element.setAttribute("aria-activedescendant",`${t.id}-active-day`),t.weeksElement.setAttribute("role","grid"),t.weekElements.forEach(i=>i.setAttribute("role","row")),t.element.setAttribute("ariaLabelledBy",t.widgetMap.fields.id),A.on({element:t.weeksElement,click:{handler:"onCellClick",delegate:`.${t.dayCellCls}:not(.${t.disabledCls}):not(.${t.outOfRangeCls})`},mousedown:{handler:"onCellMousedown",delegate:`.${t.dayCellCls}`},thisObj:t}),t.widgetMap.monthField.readOnly=t.widgetMap.yearButton.disabled=!t.editMonth,t.refresh.flush()}afterHide(){var e;(e=this._yearPicker)===null||e===void 0||e.hide(),super.afterHide(...arguments)}doDestroy(){var e,t;(e=this.yearButton)===null||e===void 0||e.destroy(),(t=this.monthField)===null||t===void 0||t.destroy(),super.doDestroy()}get focusElement(){return this.weeksElement.querySelector(`.${this.dayCellCls}[tabIndex="0"]`)}doRefresh(){const e=this,t=e.focusElement,i=E.betweenLesser(e.activeDate,e.month.startDate,e.month.endDate)?e.activeDate:e._activeDate=e.date;super.doRefresh(...arguments);const r=E.parseKey(t?.dataset.date);i-r&&e.syncActiveDate(i,r)}internalCellRenderer({cell:e,date:t}){const i=this,{activeCls:r,selectedCls:n,externalCellRenderer:s}=i,l=i.isSelectedDate(t),o={[r]:r&&i.isActiveDate(t),[n]:l,[i.outOfRangeCls]:i.minDate&&t<i.minDate||i.maxDate&&t>i.maxDate};if(l&&i.multiSelect){const a=!i.isSelectedDate(E.add(t,-1,"d")),d=!i.isSelectedDate(E.add(t,1,"d"));o["b-range-start"]=a,o["b-range-end"]=d,o["b-in-range"]=!a&&!d}b.updateClassList(e,o),e.innerHTML=`<div class="b-datepicker-cell-inner">${t.getDate()}</div>`,e.setAttribute("role","gridcell"),e.setAttribute("aria-label",E.format(t,"MMMM D, YYYY")),i.isActiveDate(t)?e.id=`${i.id}-active-day`:e.removeAttribute("id"),s&&(arguments[0].cell=e.firstChild,i.callback(s,this,arguments))}onCellMousedown(e){const t=e.target.closest("[data-date]");e.preventDefault(),t.focus(),this.activeDate=E.parseKey(t.dataset.date)}onCellClick(e){const t=e.target.closest("[data-date]");this.onUIDateSelect(E.parseKey(t.dataset.date),e)}onMonthDateChange({newDate:e,changes:t}){this.getConfig("tbar"),super.onMonthDateChange(...arguments),(t.m||t.y)&&(this.widgetMap.monthField.value=e.getMonth(),this.widgetMap.yearButton.text=e.getFullYear())}onUIDateSelect(e,t){const i=this,{lastClickedDate:r,multiSelect:n}=i;i.lastClickedDate=e,i.isDisabledDate(e)||(i.activatingEvent=t,n?i.handleMultiSelect(r,e,t):(i.selection=e,i.floating&&i.hide()),i.activatingEvent=null)}handleMultiSelect(e,t,i){const r=this,{multiSelect:n,_selection:s}=r,l=s.dates,o=n==="range",{size:a,generation:d}=s,c=a&&{[E.makeKey(E.add(l[0],-1,"d"))]:1,[E.makeKey(l[0])]:1,[E.makeKey(l[l.length-1])]:1,[E.makeKey(E.add(l[l.length-1],1,"d"))]:1},h=s.has(t),g=h?"delete":"add",f=o&&c?.[E.makeKey(t)];if(i.ctrlKey)(n===!0||!a||f)&&(s[g](t),o&&!s.has(r.rangeStartDate)&&r.rangeStartDate.setDate(r.rangeStartDate.getDate()+(t<l[1]?1:-1)));else if(i.shiftKey&&a){const[p,v]=[new Date(o?r.rangeStartDate||(r.rangeStartDate=l[0]):e),t].sort(Ha);o&&s.clear();for(const y=p;y<=v;y.setDate(y.getDate()+1))s.add(y)}else s.has(t)&&s.size===1||(s.clear(),s.add(t));const m=s.size;m===1?r.rangeStartDate=t:m||(r.rangeStartDate=null),s.generation!==d&&r.updateSelection(s)}changeSelection(e){const t=this;let i,r;if(e)if(e.forEach||(e=[e]),e.forEach((n,s)=>e[s]=t.changeDate(n)),r=e[0],e.sort(Ha),t.multiSelect==="range"&&e.length===2){i=new Ki;for(const n=new Date(e[0]);n<=e[1];n.setDate(n.getDate()+1))i.add(n)}else r=e[0],i=new Ki(e);else i=new Ki;return r&&(t.activeDate=t.rangeStartDate=E.clearTime(r)),i}updateSelection(e){const t=this,{dates:i}=e,r=t.multiSelect==="range"?[i[0],i[i.length-1]]:i;i.length&&(t.date=i[0]),t.isConfiguring||(t.refresh.now(),t.trigger("selectionChange",{selection:r,userAction:Boolean(t.activatingEvent)}))}get selection(){const{_selection:e}=this,t=e?e.dates:wm;return this.multiSelect==="range"&&t.length?[t[0],t[t.length-1]]:t}onInternalKeyDown(e){const t=this,i=e.key.trim()||e.code,r=t.activeDate;let n=new Date(r);if(i==="Escape"&&t.floating)return t.hide();if(r&&t.weeksElement.contains(e.target)){do switch(i){case"ArrowLeft":e.preventDefault(),e.ctrlKey?n=t.gotoPrevMonth():n.setDate(n.getDate()-1);break;case"ArrowUp":e.preventDefault(),n.setDate(n.getDate()-7);break;case"ArrowRight":e.preventDefault(),e.ctrlKey?n=t.gotoNextMonth():n.setDate(n.getDate()+1);break;case"ArrowDown":e.preventDefault(),n.setDate(n.getDate()+7);break;case"Enter":return t.onUIDateSelect(r,e)}while(t.isDisabledDate(n)&&!t.focusDisabledDates);if(t.minDate&&n<t.minDate||t.maxDate&&n>t.maxDate)return;t.activeDate=n}}changeMinDate(e){return e&&qi.prototype.changeDate.apply(this,arguments)}updateMinDate(e){this._yearpicker&&(this._yearpicker.minYear=e?.getFullYear()),this.refresh()}changeMaxDate(e){return e&&qi.prototype.changeDate.apply(this,arguments)}updateMaxDate(e){this._yearpicker&&(this._yearpicker.maxYear=e?.getFullYear()),this.refresh()}changeDate(e){return E.clamp(super.changeDate(e),this.minDate,this.maxDate)}updateDate(e){const t=this;t.isConfiguring&&!t.initializingActiveDate&&(t.selection=e),(!t.month.date||e.getMonth()===t.month.month||!t.getCell(e)||t.alwaysRefreshOnMonthChange||t.isNavigating)&&super.updateDate(e)}changeActiveDate(e,t){if(this.trigger("beforeActiveDateChange",{activeDate:e,oldActiveDate:t})!==!1){if(e=e?this.changeDate(e):this.date||(this.date=E.clearTime(new Date)),isNaN(e))throw new Error("DatePicker date ingestion must be passed a Date, or a YYYY-MM-DD date string");return E.clamp(e,this.minDate,this.maxDate)}}updateActiveDate(e,t){const i=this,{isConfiguring:r}=i;(r||!i.getCell(e))&&(i.initializingActiveDate=r,i.date=e,i.initializingActiveDate=!1),!r&&!i.refresh.isPending&&i.syncActiveDate(e,t)}syncActiveDate(e,t){const i=this,{activeCls:r}=i,n=i.getCell(e),s=t&&i.getCell(t),l=b.getActiveElement(i.element);n.setAttribute("tabIndex",0),r&&n.classList.add(r),n.id=`${i.id}-active-day`,i.weeksElement.contains(l)&&n.focus(),s&&s!==n&&(s.removeAttribute("tabIndex"),r&&s.classList.remove(r),s.removeAttribute("id"))}set value(e){const t=this;e?(e=t.changeDate(e,t.value),e!==void 0&&(t.selection=e)):(t.date=new Date,t.selection=null)}get value(){return this.selection[this.selection.length-1]}gotoPrevYear(){return this.goto(-1,"year")}gotoPrevMonth(){return this.goto(-1,"month")}gotoNextMonth(){return this.goto(1,"month")}gotoNextYear(){return this.goto(1,"year")}goto(e,t){const i=this,{activeDate:r}=i,n=r&&i.getCell(r);let s;t==="month"&&n&&r?.getMonth()===i.month.month+e?s=r:s=E.add(n?r:i.date,e,t);const l=new Date(s);l.setDate(1);const o=E.add(E.add(l,1,"month"),-1,"day");if(i.minDate&&e<0&&o<i.minDate||i.maxDate&&e>0&&l>i.maxDate)return;i.isNavigating=!0;const a=i.date=s;return n&&(i.activeDate=s),i.isNavigating=!1,a}isActiveDate(e){return!(e-this.activeDate)}isSelectedDate(e){var t;return(t=this._selection)===null||t===void 0?void 0:t.has(e)}onMonthPicked({record:e,userAction:t}){if(t){var i;this.activeDate=E.add(this.activeDate,e.value-this.activeDate.getMonth(),"month"),(i=this.focusElement)===null||i===void 0||i.focus()}}onYearPickerRequested(){const{yearPicker:e}=this;e.isVisible?e.hide():(e.year=e.startYear=this.activeDate.getFullYear(),e.show(),e.focus())}onYearPickerTitleClick(){this.yearPicker.hide()}onYearPicked({value:e,source:t}){const i=new Date(this.activeDate);i.setFullYear(e),this.activeDate=i,this.focusElement&&b.focusWithoutScrolling(this.focusElement),t.hide()}changeYearPicker(e,t){var i,r;return Vt.reconfigure(t,e?Vt.mergeConfigs({owner:this,appendTo:this.element,minYear:(i=this.minDate)===null||i===void 0?void 0:i.getFullYear(),maxYear:(r=this.maxDate)===null||r===void 0?void 0:r.getFullYear()},e):null,this)}get childItems(){const{_yearPicker:e}=this,t=super.childItems;return e&&t.push(e),t}updateLocalization(){const{monthField:e}=this.widgetMap,t=_a();!this.isConfiguring&&!t.every((i,r)=>i[1]===e.store.getAt(r).text)&&(t[e.value].selected=!0,e.items=t),super.updateLocalization()}}class Ki extends Set{add(e){return e=E.makeKey(e),this.has(e)||(this.generation=(this.generation||0)+1),super.add(e)}delete(e){return e=E.makeKey(e),this.has(e)&&this.generation++,super.delete(e)}has(e){return super.has(E.makeKey(e))}clear(){return this.size&&this.generation++,super.clear()}equals(e){return Array.isArray(e)&&(e=new Ki(e)),e.size===this.size&&[...this].every(t=>e.has(t))}get dates(){return[...this].sort().map(e=>E.parseKey(e))}}tl.initClass();tl._$name="DatePicker";class Jd extends ar{static get $name(){return"DateField"}static get type(){return"datefield"}static get alias(){return"date"}static get configurable(){return{format:"L",strictParsing:!1,fallbackFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss:SSS",keepTime:!1,pickerFormat:null,validateDateOnly:null,triggers:{expand:{cls:"b-icon-calendar",handler:"onTriggerClick",weight:200},back:{cls:"b-icon b-icon-angle-left b-step-trigger",key:"Shift+ArrowDown",handler:"onBackClick",align:"start",weight:100},forward:{cls:"b-icon b-icon-angle-right b-step-trigger",key:"Shift+ArrowUp",handler:"onForwardClick",align:"end",weight:100}},calendarContainerCls:"",min:null,max:null,step:!1,stepTriggers:null,weekStartDay:null,picker:{type:"datepicker",role:"dialog",floating:!0,scrollAction:"realign",align:{align:"t0-b0",axisLock:!0}},value:null}}changePicker(e,t){const i=this,r={owner:i,forElement:i[i.pickerAlignElement],minDate:i.min,maxDate:i.max,weekStartDay:i._weekStartDay,align:{anchor:i.overlayAnchor,target:i[i.pickerAlignElement]},onSelectionChange:({selection:s,source:l})=>{l.isVisible&&(i._isUserAction=i._isPickerInput=!0,i.value=s[0],i._isPickerInput=i._isUserAction=!1,l.hide())}};i.calendarContainerCls&&(r.cls=i.calendarContainerCls),i.value?r.value=i.value:r.activeDate=new Date;const n=tl.reconfigure(t,e,{owner:i,defaults:r});return n?.refresh.flush(),n}get backShiftDate(){return E.add(this.value,-1*this._step.magnitude,this._step.unit)}onBackClick(){const e=this,{min:t}=e;if(!e.readOnly&&e.value){const i=e.backShiftDate;(!t||t.getTime()<=i)&&(e._isUserAction=!0,e.value=i,e._isUserAction=!1)}}get forwardShiftDate(){return E.add(this.value,this._step.magnitude,this._step.unit)}onForwardClick(){const e=this,{max:t}=e;if(!e.readOnly&&e.value){const i=e.forwardShiftDate;(!t||t.getTime()>=i)&&(e._isUserAction=!0,e.value=i,e._isUserAction=!1)}}showPicker(e){if(this.readOnly)return;const t=this,{_picker:i}=t;if(i){const r={minDate:t.min,maxDate:t.max};t.value?r.value=t.value:r.activeDate=new Date,i.setConfig(r)}super.showPicker(e)}focusPicker(){this.picker.focus()}get isValid(){const e=this;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);let t=e.value;if(t){const{min:i,max:r,validateDateOnly:n}=e;if(n&&(t=E.clearTime(t,!1)),i&&t<i)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(r&&t>r)return e.setError("L{Field.maximumValueViolation}",!0),!1}return super.isValid}transformDateValue(e){const t=this;return e!=null&&(E.isDate(e)||(typeof e=="string"?e=E.parse(e,t.format,t.strictParsing)||E.parse(e,t.fallbackFormat,t.strictParsing):e=new Date(e)),E.isValidDate(e))?(!t.min||e-t.min>-E.MS_PER_DAY)&&(!t.max||e<=t.max)?t.transformTimeValue(e):e:null}transformTimeValue(e){const t=this,{keepTime:i}=t;if(e=E.clone(e),!i)E.clearTime(e,!1);else if(i!=="entered"){const r=E.parse(i,t.timeFormat);E.isValidDate(r)?E.copyTimeValues(e,r):E.isValidDate(t.value)&&E.copyTimeValues(e,t.value)}else t._isPickerInput&&E.isValidDate(t.value)&&E.copyTimeValues(e,t.value);return e}changeMin(e){return this.transformDateValue(e)}updateMin(e){const{input:t,_picker:i}=this;t&&(e==null?t.removeAttribute("min"):t.min=e),i&&(i.minDate=e),this.syncInvalid()}changeMax(e){return this.transformDateValue(e)}updateMax(e){const{input:t,_picker:i}=this;t&&(e==null?t.removeAttribute("max"):t.max=e),i&&(i.maxDate=e),this.syncInvalid()}get weekStartDay(){return typeof this._weekStartDay=="number"?this._weekStartDay:E.weekStartDay}updateWeekStartDay(e){this._picker&&(this._picker.weekStartDay=e)}changeValue(e,t){const i=this,r=i.transformDateValue(e);if(e&&!r){i.setError("L{invalidDate}");return}if(i.clearError("L{invalidDate}"),i.hasChanged(t,r))return super.changeValue(r,t);i.inputting||i.syncInputFieldValue()}updateValue(e,t){const i=this._picker;i&&!this.inputting&&(i.value=e),super.updateValue(e,t)}changeStep(e,t){const i=typeof e;if(!e)return null;if(i==="number"?e={magnitude:Math.abs(e),unit:t?t.unit:"day"}:i==="string"&&(e=E.parseDuration(e)),e&&e.unit&&e.magnitude)return e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e}updateStep(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}hasChanged(e,t){return e!=null&&e.getTime&&t!==null&&t!==void 0&&t.getTime&&this.keepTime!=="entered"?!E.isEqual(E.clearTime(e),E.clearTime(t)):super.hasChanged(e&&e.getTime(),t&&t.getTime())}get inputValue(){const e=this.value;return e?E.format(e,this.format):""}updateFormat(){this.isConfiguring||this.syncInputFieldValue(!0)}updateLocalization(){super.updateLocalization(),this.syncInputFieldValue(!0)}internalOnKeyEvent(e){super.internalOnKeyEvent(e),e.key==="Enter"&&this.isValid&&this.picker.hide()}}Jd.initClass();Jd._$name="DateField";class Qd extends xe{static get $name(){return"NumberField"}static get type(){return"numberfield"}static get alias(){return"number"}static get configurable(){return{min:null,max:null,step:1,largeStep:0,value:null,format:"",decimalPrecision:null,leadingZeroes:null,triggers:{spin:{type:"spintrigger"}},changeOnSpin:!0,inputType:null}}construct(e){super.construct(e);const t=this;t.input.addEventListener("dblclick",()=>{t.select()}),typeof t.changeOnSpin=="number"&&(t.bufferedSpinChange=t.buffer(t.triggerChange,t.changeOnSpin))}acceptValue(e,t){let i=!isNaN(e);if(i&&!this.hasTextSelection){i=!1;const r=this.input.value,n=parseFloat(r);r!==t&&(i=!this.acceptValue(n,r))}return i}okMax(e){return isNaN(this.max)||e<=this.max}okMin(e){return isNaN(this.min)||e>=this.min}internalOnKeyEvent(e){if(e.type==="keydown"){const t=this,i=e.key;let r;if(i==="ArrowUp")t.doSpinUp(e.shiftKey),r=!0;else if(i==="ArrowDown")t.doSpinDown(e.shiftKey),r=!0;else if(!e.altKey&&!e.ctrlKey&&i&&i.length===1){const n=t.getAfterValue(i),s=t.formatter.parseStrict(n);r=!(s===t.value||n==="-"&&(isNaN(t.min)||t.min<0))&&!t.acceptValue(s,n)}i==="Enter"&&t._changedBySilentSpin&&(t.triggerChange(e,!0),t._changedBySilentSpin=!1),r&&e.preventDefault()}super.internalOnKeyEvent(e)}doSpinUp(e=!1){const t=this;if(t.readOnly)return;let i=(t.value||0)+(e?t.largeStep:t.step);t.okMin(i)||(i=t.min),t.okMax(i)&&t.applySpinChange(i)}doSpinDown(e=!1){const t=this;if(t.readOnly)return;let i=(t.value||0)-(e?t.largeStep:t.step);t.okMax(i)||(i=t.max),t.okMin(i)&&t.applySpinChange(i)}applySpinChange(e){const t=this;t._isUserAction=!0,t.changeOnSpin!==!0&&(t._changedBySilentSpin=!0,t.silenceChange=!0,t.bufferedSpinChange&&t.bufferedSpinChange(null,!0)),t.value=e,t._isUserAction=!1,t.silenceChange=!1}triggerChange(){this.silenceChange||super.triggerChange(...arguments)}onFocusOut(e){var t,i,r;super.onFocusOut(...arguments);const n=this,{input:s}=n,l=s.value,o=n.formatter.truncate(l),a=isNaN(o)?l:n.formatValue(o);(t=n.triggers)===null||t===void 0||(i=t.spin)===null||i===void 0||(r=i.clickRepeater)===null||r===void 0||r.cancel(),l!==a&&(s.value=a),n._changedBySilentSpin&&(n.triggerChange(e,!0),n._changedBySilentSpin=!1)}internalOnInput(e){const t=this,{formatter:i,input:r}=t,{parser:n}=i,s=r.value,l=n.decimalPlaces(s);if(i.truncator&&l){let o=s;const a=i.truncate(s);if(!isNaN(a)&&(o=t.formatValue(a),n.decimalPlaces(o)<l)){const d=s.length-t.caretPos;r.value=o,t.caretPos=o.length-d}}super.internalOnInput(e)}formatValue(e){return this.formatter.format(e)}changeFormat(e){const t=this;if(e===""){const{leadingZeroes:i,decimalPrecision:r}=t;e=i?`${i}>9`:null,r!=null?e=`${e||""}9.${"#".repeat(r)}`:e&&(e+=".*")}return e}get formatter(){const e=this,t=e.format;let i=e._formatter;return(!i||e._lastFormat!==t)&&(i=dt.get(e._lastFormat=t),e._formatter=i),i}updateStep(e){this.element.classList[e?"remove":"add"]("b-hide-spinner"),this._step=e}changeLargeStep(e){return e||this.step*10}get validity(){const e=this.value,t={};return e!=null&&(t.rangeUnderflow=!this.okMin(e),t.rangeOverflow=!this.okMax(e)),t.valid=!t.rangeUnderflow&&!t.rangeOverflow,t}changeValue(e,t){const i=this;if(e||e===0){let r;typeof e!="number"&&(e=typeof e=="string"?i.formatter.parse(e):Number(e),r=isNaN(e),r&&(e="")),!r&&i.format&&(e=i.formatter.round(e))}else e=void 0;return super.changeValue(e,t)}get inputValue(){let e=this.value;return e!=null&&this.format&&(e=this.formatValue(e)),e}}Qd.initClass();Qd._$name="NumberField";class hn extends Je{static get $name(){return"TimePicker"}static get type(){return"timepicker"}construct(e){super.construct(e),this.refresh()}updateSeconds(e){this.widgetMap.second[e?"show":"hide"]()}onFieldChange(){!this.isConfiguring&&!this.isRefreshing&&(this.value=this.pickerToTime())}onAmPmButtonClick({source:e}){this._pm=e.ref==="pmButton",this._value&&(this.value=this.pickerToTime())}onInternalKeyDown(e){var t;const i=this;switch(e.key){case"Escape":i.triggerTimeChange(i._initialValue),i.hide(),e.preventDefault();return;case"Enter":i.value=i.pickerToTime(),i.hide(),e.preventDefault();return}(t=super.onInternalKeyDown)===null||t===void 0||t.call(this,e)}pickerToTime(){const e=this,t=e._pm,{hour:i,minute:r,second:n}=e.widgetMap;i.format=e._is24Hour?"2>9":null;let s=i.value,l=new Date(e.value);return e._is24Hour||(t&&s<12&&(s=s+12),!t&&s===12&&(s=0)),l.setHours(s),l.setMinutes(r.value),e.seconds&&l.setSeconds(n.value),e._min&&(l=E.max(e._min,l)),e._max&&(l=E.min(e._max,l)),l}triggerTimeChange(e){this.trigger("timeChange",{time:e})}updateInitialValue(e){this.value=e}changeValue(e){var t;return e&&(e=typeof e=="string"?E.parse(e,this.format):e),this.isVisible||(this._initialValue=e),(t=e)!==null&&t!==void 0?t:E.getTime(0)}updateValue(e){this.isVisible&&this.triggerTimeChange(e),this.refresh()}updateFormat(e){this._is24Hour=E.is24HourFormat(e),this.refresh()}changeMin(e){return typeof e=="string"?E.parse(e,this.format):e}changeMax(e){return typeof e=="string"?E.parse(e,this.format):e}refresh(){const e=this;if(!e.isConfiguring&&e.value){e.isRefreshing=!0;const{hour:t,minute:i,second:r,amButton:n,pmButton:s}=e.widgetMap,l=e.value,o=e._is24Hour,a=l.getHours(),d=e._pm=a>=12;e.element.classList[o?"add":"remove"]("b-24h"),t.min=o?0:1,t.max=o?23:12,t.value=o?a:a%12||12,i.value=l.getMinutes(),r.value=l.getSeconds(),n.pressed=!d,s.pressed=d,n.hidden=s.hidden=o,e.isRefreshing=!1}}}T(hn,"configurable",{floating:!0,items:{hour:{label:"L{TimePicker.hour}",type:"number",min:0,max:23,highlightExternalChange:!1,format:"2>9"},minute:{label:"L{TimePicker.minute}",type:"number",min:0,max:59,highlightExternalChange:!1,format:"2>9"},second:{hidden:!0,label:"L{TimePicker.second}",type:"number",min:0,max:59,highlightExternalChange:!1,format:"2>9"},amButton:{type:"button",text:"AM",toggleGroup:"am-pm",cls:"b-blue",onClick:"up.onAmPmButtonClick"},pmButton:{type:"button",text:"PM",toggleGroup:"am-pm",cls:"b-blue",onClick:"up.onAmPmButtonClick"}},autoShow:!1,trapFocus:!0,seconds:null,value:{$config:{equal:"date"},value:null},format:null,max:null,min:null,initialValue:null});hn.initClass();hn._$name="TimePicker";class rn extends ar{static get $name(){return"TimeField"}static get type(){return"timefield"}static get alias(){return"time"}static get configurable(){return{picker:{type:"timepicker",align:{align:"t0-b0",axisLock:!0}},format:"LT",triggers:{expand:{align:"end",handler:"onTriggerClick",compose:()=>({children:[{class:{"b-icon-clock-live":1}}]})},back:{align:"start",cls:"b-icon b-icon-angle-left b-step-trigger",key:"Shift+ArrowDown",handler:"onBackClick"},forward:{align:"end",cls:"b-icon b-icon-angle-right b-step-trigger",key:"Shift+ArrowUp",handler:"onForwardClick"}},min:null,max:null,step:"5m",stepTriggers:null,value:null,keepDate:!1}}changePicker(e,t){const i=this;return hn.reconfigure(t,e,{owner:i,defaults:{value:i.value,forElement:i[i.pickerAlignElement],owner:i,align:{anchor:i.overlayAnchor,target:i[i.pickerAlignElement]},onTimeChange({time:r}){i._isUserAction=!0,i.value=r,i._isUserAction=!1}}})}onBackClick(){const e=this,{min:t}=e;if(!e.readOnly&&e.value){const i=E.add(e.value,-1*e.step.magnitude,e.step.unit);(!t||t.getTime()<=i)&&(e._isUserAction=!0,e.value=i,e._isUserAction=!1)}}onForwardClick(){const e=this,{max:t}=e;if(!e.readOnly&&e.value){const i=E.add(e.value,e.step.magnitude,e.step.unit);(!t||t.getTime()>=i)&&(e._isUserAction=!0,e.value=i,e._isUserAction=!1)}}get isValid(){const e=this;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);let t=e.value;if(t){if(t=t.getTime(),e._min&&e._min.getTime()>t)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(e._max&&e._max.getTime()<t)return e.setError("L{Field.maximumValueViolation}",!0),!1}return super.isValid}hasChanged(e,t){return e!=null&&e.getTime&&t!==null&&t!==void 0&&t.getTime?e.getHours()!==t.getHours()||e.getMinutes()!==t.getMinutes()||e.getSeconds()!==t.getSeconds()||e.getMilliseconds()!==t.getMilliseconds():super.hasChanged(e,t)}showPicker(){const e=this,{picker:t,value:i}=e;e.readOnly||(t.value=i,t.format=e.format,t.maxTime=e.max,t.minTime=e.min,i||(e.value=t.value),super.showPicker(!0))}onPickerShow(){var e;super.onPickerShow(),this.pickerKeyDownRemover=(e=this.pickerKeyDownRemover)===null||e===void 0?void 0:e.call(this)}focusPicker(){this.picker.focus()}transformTimeValue(e){return e!=null&&(typeof e=="string"?(e=E.parse(e,this.format),this.keepDate&&(e=E.copyTimeValues(new Date(this.value),e))):e=new Date(e),E.isValidDate(e))?this.keepDate?e:E.getTime(e):null}changeMin(e){return this.transformTimeValue(e)}updateMin(e){const{input:t}=this;t&&(e==null?t.removeAttribute("min"):t.min=e),this.syncInvalid()}changeMax(e){return this.transformTimeValue(e)}updateMax(e){const{input:t}=this;t&&(e==null?t.removeAttribute("max"):t.max=e),this.syncInvalid()}changeValue(e,t){const i=this,r=i.transformTimeValue(e);if(e&&!r||i.isRequired&&e===""){i.setError("L{invalidTime}");return}if(i.clearError("L{invalidTime}"),i.hasChanged(t,r))return super.changeValue(r,t);i.inputting||i.syncInputFieldValue(!0)}updateValue(e,t){const{expand:i}=this.triggers;i&&e&&(i.element.firstElementChild.style.animationDelay=-((e.getHours()*60+e.getMinutes())/10)+"s"),super.updateValue(e,t)}changeStep(e,t){var i,r;const n=typeof e;if(!e)return null;if(n==="number"?e={magnitude:Math.abs(e),unit:t?t.unit:"hour"}:n==="string"&&(e=E.parseDuration(e)),(i=e)!==null&&i!==void 0&&i.unit&&(r=e)!==null&&r!==void 0&&r.magnitude)return e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e}updateStep(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}updateFormat(){this.syncInputFieldValue(!0)}get inputValue(){return E.format(this.value,this.format)}updateLocalization(){super.updateLocalization(),this.syncInputFieldValue(!0)}}rn.initClass();rn._$name="TimeField";class bi extends xe{doDestroy(){this.dateField.destroy(),this.timeField.destroy(),super.doDestroy()}get focusElement(){return this.dateField.input}get innerElements(){return[this.dateField.element,this.timeField.element]}internalOnKeyEvent(){}updateRevertOnEscape(e){this.timeField.revertOnEscape=e,this.dateField.revertOnEscape=e}changeTimeField(e){const t=this,i=rn.new({revertOnEscape:t.revertOnEscape,syncInvalid(...r){const n=t.updatingInvalid;rn.prototype.syncInvalid.apply(this,r),t.timeField&&!n&&t.syncInvalid()}},e);return A.on({element:i.element,keydown:"onTimeFieldKeyDown",thisObj:t}),t.readOnly&&(i.readOnly=!0),i}updateTimeField(e){const t=this;e.ion({change({userAction:i,value:r}){if(i&&!t.$settingValue){const n=t.dateField.value;t._isUserAction=!0,t.value=n?E.copyTimeValues(n,r):null,t._isUserAction=!1}},thisObj:t})}changeDateField(e){const t=this,i=e?.type||"datefield",r=k.resolveType(e.type||"datefield"),n=k.create(x.assign({type:i,revertOnEscape:t.revertOnEscape,syncInvalid(...s){const l=t.updatingInvalid;r.prototype.syncInvalid.apply(this,s),t.dateField&&!l&&t.syncInvalid()}},e));return A.on({element:n.element,keydown:"onDateFieldKeyDown",thisObj:t}),t.readOnly&&(n.readOnly=!0),n.ion({keydown:({event:s})=>{var l;s.key==="Tab"&&!s.shiftKey&&(l=this.timeField)!==null&&l!==void 0&&l.isVisible&&(s.stopPropagation(),s.cancelBubble=!0)}}),n}get childItems(){return[this.dateField,this.timeField]}updateDateField(e){const t=this;e.ion({change({userAction:i,value:r}){i&&!t.$isInternalChange&&(t._isUserAction=!0,t.timeField.value?r&&E.copyTimeValues(r,t.timeField.value):t.timeField.value=r,t.value=r,t._isUserAction=!1)},thisObj:t})}updateWeekStartDay(e){this.dateField&&(this.dateField.weekStartDay=e)}changeWeekStartDay(e){var t,i;return typeof e=="number"?e:(t=(i=this.dateField)===null||i===void 0?void 0:i.weekStartDay)!==null&&t!==void 0?t:E.weekStartDay}syncInputFieldValue(e=this.isConfiguring){super.syncInputFieldValue(!0);const t=this,{dateField:i,timeField:r}=t,n=i.highlightExternalChange,s=r.highlightExternalChange;!e&&!t.highlightExternalChange&&(e=!0),t.$isInternalChange=!0,i.highlightExternalChange=!1,i.value=null,i.highlightExternalChange=n,e&&(r.highlightExternalChange=i.highlightExternalChange=!1),r.value=i.value=t.inputValue,i.highlightExternalChange=n,r.highlightExternalChange=s,t.$isInternalChange=!1,t.syncInvalid()}onTimeFieldKeyDown(e){const t=this;if(e.key==="Enter"||e.key==="Tab"){const i=t.dateField.value;t._isUserAction=!0,t.value=i?E.copyTimeValues(i,t.timeField.value):null,t._isUserAction=!1}}onDateFieldKeyDown(e){const t=this;e.key==="Tab"&&!e.shiftKey?(e.stopPropagation(),e.preventDefault(),t.timeField.focus()):e.key==="Enter"&&(t.value=t.dateField.value)}updateRequired(e,t){this.timeField.required=this.dateField.required=e}updateReadOnly(e,t){super.updateReadOnly(e,t),this.isConfiguring||(this.timeField.readOnly=this.dateField.readOnly=e)}onDisabled(e){this.timeField.disabled=this.dateField.disabled=e}focus(){this.dateField.focus()}hasChanged(e,t){return!E.isEqual(e,t)}get isValid(){return this.timeField.isValid&&this.dateField.isValid}setError(e,t){[this.dateField,this.timeField].forEach(i=>i.setError(e,t))}getErrors(){const e=[...this.dateField.getErrors()||[],...this.timeField.getErrors()||[]];return e.length?e:null}clearError(e,t){[this.dateField,this.timeField].forEach(i=>i.clearError(e,t))}updateInvalid(){this.updatingInvalid=!0,[this.dateField,this.timeField].forEach(e=>e.updateInvalid()),this.updatingInvalid=!1}}T(bi,"configurable",{timeField:{},dateField:{keepTime:!0,step:"1 d"},weekStartDay:null,inputTemplate:()=>"",ariaElement:"element"});T(bi,"$name","DateTimeField");T(bi,"type","datetimefield");T(bi,"alias","datetime");bi.initClass();bi._$name="DateTimeField";class fn extends pi{static get $name(){return"DurationField"}static get type(){return"durationfield"}static get alias(){return"duration"}static get defaultConfig(){return{value:null,step:1,unit:null,defaultUnit:"day",magnitude:null,useAbbreviation:!1,allowNegative:!1,decimalPrecision:null,triggers:{spin:{type:"spintrigger"}},nullValue:null}}static get configurable(){return{min:null,max:null,allowedUnits:null}}changeMin(e){return typeof e=="string"?new st(e):e}changeMax(e){return typeof e=="string"?new st(e):e}changeAllowedUnits(e){return typeof e=="string"&&(e=e.split(",")),e}updateAllowedUnits(e){this.allowedUnitsRe=new RegExp(`(${e.join("|")})`,"i")}get inputValue(){return this.value==null?"":this.calcValue(!0).toString(this.useAbbreviation)}set unit(e){this._unit=e,this.value=this.calcValue()}get unit(){return this._unit}get unitWithDefault(){return this._unit||fn.defaultConfig.defaultUnit}set magnitude(e){this.clearError("L{invalidUnit}"),this._magnitude=e,super.value=this.calcValue()}get magnitude(){return this._magnitude}roundMagnitude(e){return e&&this.decimalPrecision!=null?x.round(e,this.decimalPrecision):e}get allowDecimals(){return this.decimalPrecision!==0}get isValid(){const e=this,t=e.value==null||e.value&&e.value.magnitude==null;return super.isValid&&(t&&!e.required||!t&&(e.allowNegative||e.value.magnitude>=0))}internalOnChange(e){const t=this,i=t.value,r=t._lastValue;t.hasChanged(r,i)&&(t._lastValue=i,t.triggerFieldChange({value:i,event:e,userAction:!0,valid:t.isValid}))}onFocusOut(e){var t,i,r;return this.syncInputFieldValue(!0),(t=this.triggers)===null||t===void 0||(i=t.spin)===null||i===void 0||(r=i.clickRepeater)===null||r===void 0||r.cancel(),super.onFocusOut(e)}set value(e){const t=this;let i,r;if(this.clearError("L{invalidUnit}"),typeof e=="number")i=e,r=t._unit;else if(typeof e=="string")if(/^\s*$/.test(e))i=null;else{const n=E.parseDuration(e,t.allowDecimals,t.unitWithDefault);n&&(!t.allowedUnitsRe||t.allowedUnitsRe.test(n.unit)?(r=n.unit,i=n.magnitude):t.setError("L{invalidUnit}"))}else e&&"unit"in e&&"magnitude"in e?(r=e.unit,i=e.magnitude):(r=null,i=null);(t._magnitude!==i||t._unit!=r)&&(t._magnitude=i,r&&(t._unit=r),super.value=t.calcValue())}okMax(e){return typeof e=="number"&&(e=new st({unit:this.unitWithDefault,magnitude:e})),this.max==null||e<=this.max}okMin(e){return typeof e=="number"&&(e=new st({unit:this.unitWithDefault,magnitude:e})),this.min==null||e>=this.min}get validity(){const e=this.value,t={};return e!=null&&(t.rangeUnderflow=!this.okMin(e),t.rangeOverflow=!this.okMax(e)),t.valid=!t.rangeUnderflow&&!t.rangeOverflow,t}get value(){return super.value}calcValue(e=!1){const t=this;return(!t._unit||t._magnitude==null)&&t.clearable?null:new st(e?this.roundMagnitude(t._magnitude):this._magnitude,t.unitWithDefault)}hasChanged(e,t){return t&&!e||!t&&e||t&&e&&!e.isEqual(t)}get milliseconds(){return this.value?this.value.milliseconds:0}onInternalKeyDown(e){e.key==="ArrowUp"?this.doSpinUp():e.key==="ArrowDown"&&this.doSpinDown()}doSpinUp(){const e=this;if(e.readOnly)return;let t=(e.magnitude||0)+e.step;e._isUserAction=!0,e.okMin(t)||(t=e.min),e.okMax(t)&&(e.value=t),e._isUserAction=!1}doSpinDown(){const e=this;if(e.readOnly)return;let t=(e.magnitude||0)-e.step;e.okMax(t)||(t=e.max),e.okMin(t)&&(e.allowNegative||(e.magnitude||0)>0)&&(e._isUserAction=!0,e.value=t,e._isUserAction=!1)}}fn.initClass();fn._$name="DurationField";class dr extends vt{}T(dr,"$name","Fit");T(dr,"type","fit");T(dr,"configurable",{containerCls:"b-fit-container",itemCls:"b-fit-item"});dr.initClass();dr._$name="Fit";class Gt extends Je{afterConfigure(){const e=this;super.afterConfigure(),e.onTargetSizeChange=e.onTargetSizeChange.bind(e),A.on({element:e.element,keydown:"onKeyDown",contextmenu:"stopMouseEvents",mousedown:"stopMouseEvents",mouseover:"stopMouseEvents",mouseout:"stopMouseEvents",mouseup:"stopMouseEvents",click:"stopMouseEvents",dblclick:"stopMouseEvents",thisObj:e}),e.ion({beforeHide:"beforeEditorHide",hide:"afterEditorHide",thisObj:e}),Te.ion({locale:"onLocaleChange",thisObj:e})}onLocaleChange(){const{inputField:e}=this;e&&!e.isDestroyed&&e.syncInputFieldValue&&e.syncInputFieldValue(!0)}render(e){const t=this.element.parentNode,[i]=this.getRenderContext(this,e);i.classList.add("b-editing"),super.render(...arguments),t!=null&&t.classList&&i!==t&&t.classList.remove("b-editing")}async startEdit(e){const t=this;if(e=x.assignIf(e,{align:t.align,hideTarget:t.hideTarget,matchSize:t.matchSize,matchFont:t.matchFont,fitTargetContent:t.fitTargetContent,focus:!0}),t.trigger("beforeStart",e)!==!1){var i,r,n;const{target:s,hideTarget:l,matchSize:o,matchFont:a,fitTargetContent:d,record:c,field:h=t.inputField.name,focus:g}=e,{inputField:f}=t,{input:m}=f,p=b.getStyleValue(s,"font-size"),v=b.getStyleValue(s,"font-family");let{value:y,align:C}=e;if(c&&h&&(t.record=c,t.dataField=h,y===void 0&&(y=c[h])),o&&(s instanceof HTMLElement&&t.updateSize(s,o),s instanceof HTMLElement&&Le.addResizeListener(s,t.onTargetSizeChange)),m&&(a?(m.style.fontSize=p,m.style.fontFamily=v):m.style.fontSize=m.style.fontFamily=""),t.assigningValues=!0,(i=f.clearError)===null||i===void 0||i.call(f),f.value=y,t.assigningValues=!1,typeof C=="string"&&(C={align:C}),await t.showBy(F({target:s,allowTargetOut:!0},C)),d){const w=m.scrollWidth-m.clientWidth;w>0&&(t.width+=w+b.scrollBarWidth)}return g&&((r=f.focus)===null||r===void 0||r.call(f)),s.nodeType===Element.ELEMENT_NODE&&l&&s.classList.add("b-hide-visibility"),t.editing=!0,t.trigger("start",{value:f.value}),Array.isArray(f.value)&&f.editingRecords&&(n=f.value[0])!==null&&n!==void 0&&n.isModel?t.oldValue=f.value.map(w=>w.copy(w.id)):(t.oldValue=f.value,Array.isArray(t.oldValue)&&(t.oldValue=t.oldValue.slice())),f.initialValue=t.oldValue,!0}return!1}refreshEdit(){if(this.isVisible){const{record:e,dataField:t,inputField:i}=this;if(e&&t){const r=e[t];x.isEqual(i.value,r)||(i.value=r)}}}finishEdit(){const{target:e,aligningToElement:t}=this.lastAlignSpec;t&&(e.classList.remove("b-editing"),e.classList.remove("b-hide-visibility")),this.editing=!1,this.trigger("finishEdit")}onKeyDown(e){var t;const i=this;switch(e.key){case i.completeKey:i.completeEdit(null,e),e.stopImmediatePropagation();break;case i.cancelKey:i.cancelEdit(e),e.stopImmediatePropagation();break}(t=i.trigger)===null||t===void 0||t.call(i,"keydown",{event:e})}stopMouseEvents(e){this.allowMouseEvents||e.stopPropagation()}onFocusOut(e){super.onFocusOut(e);const t=this;if(!t.isFinishing&&t.editing)switch(t.blurAction){case"cancel":t.cancelEdit(e);break;case"complete":t.completeEdit(null,e)}}async completeEdit(e,t){const i=this,{inputField:r,oldValue:n,record:s}=i,l=r.invalidAction||(r.allowInvalid===!1?"block":i.invalidAction),{value:o}=r;if(!!i.isVisible){if(!r.isValid&&l!=="allow"){if(l==="block"){var a;return(a=r.focus)===null||a===void 0||a.call(r),!1}else if(l==="revert")return i.cancelEdit(t),!0}else{if(x.isEqual(o,n))return i.cancelEdit(t),!0;{const g={inputField:r,record:s,value:o,oldValue:n};if(i.trigger("beforeComplete",g)===!1){var d;(d=r.focus)===null||d===void 0||d.call(r)}else{if(!e){var c;e=g.finalize||((c=g.editorContext)===null||c===void 0?void 0:c.finalize)}if(e){let f=await e(g);if(f===!0)i.onEditComplete();else{if(r.setError){const m=f||r.invalidValueError,p=()=>{v(),r.clearError(m)},v=r.ion({change:p,input:p});r.setError(m)}if(l==="block"){var h;(h=r.focus)===null||h===void 0||h.call(r)}else l==="revert"&&(r.value=n,f=!0);f=!1}return f}else return i.onEditComplete(),!0}}}return!1}}cancelEdit(e){const t=this,{inputField:i,oldValue:r}=t,{value:n}=i;t.editing&&!t.isFinishing&&t.trigger("beforeCancel",{value:n,oldValue:r,event:e})!==!1&&(t.isFinishing=!0,t.hide(),t.trigger("cancel",{value:n,oldValue:r,event:e}),t.finishEdit(),t.isFinishing=!1)}onEditComplete(){const e=this,{record:t,dataField:i,inputField:r,oldValue:n}=e,{value:s}=r;if(!e.isFinishing){if(e.isFinishing=!0,e.hide(),t){const l=`set${_.capitalize(i)}`;t[l]?t[l](s):i.includes(".")?t.set(i,s):t[i]=s}e.trigger("complete",{value:s,oldValue:n}),e.finishEdit(),e.isFinishing=!1}}doDestroy(){this.createdInputField&&this.inputField.destroy(),super.doDestroy()}set owner(e){this._owner=e}get owner(){return this._owner||k.fromElement(this.element.parentNode)}changeInputField(e,t){const i=this;return t&&t.destroy(),typeof e=="string"&&(e={type:e}),e instanceof k||(e=k.create(e),i.createdInputField=!0),i.completeOnChange&&e.ion({change:"onInputFieldChange",thisObj:i}),e.parent=i,e}updateInputField(e){this.removeAll(),this.add(e)}get inputField(){return this.items[0]}onInputFieldChange(){this.containsFocus&&this.completeEdit()}onTargetSizeChange(e,t,i){t&&i&&this.updateSize(e)}updateSize(e,t=this.lastMatchSize){const i=this,r=O.inner(e);i.width=t.width===!1?"auto":r.width-i.align.offset[0],i.height=t.height===!1?"auto":r.height,i.lastMatchSize=t}beforeEditorHide(){if(this.editing&&!this.isFinishing)return this.cancelEdit(),!1}afterEditorHide(){this.positioned&&this.element.remove(),Le.removeResizeListener(this.lastAlignSpec.target,this.onTargetSizeChange)}}T(Gt,"$name","Editor");T(Gt,"type","editor");T(Gt,"configurable",{positioned:!0,hidden:!0,layout:"fit",align:{align:"t0-t0",offset:[0,0]},hideTarget:!1,matchSize:!0,matchFont:!0,fitTargetContent:!1,inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",invalidAction:"block",completeOnChange:null,isolateFields:!0});Gt.initClass();Gt._$name="Editor";const Zd=["number","boolean","string","date","duration"],Hs=u=>{var e;return((e=u.column)===null||e===void 0?void 0:e.type)==="duration"},Na="";class G extends Je{static get $name(){return"FieldFilterPicker"}static get type(){return"fieldfilterpicker"}static get defaultValueFieldPlaceholders(){return{string:"L{enterAValue}",number:"L{enterANumber}",date:"L{selectADate}",list:"L{selectOneOrMoreValues}",duration:"L{enterAValue}"}}afterConstruct(){const e=this;if(!e._fields)throw new Error(`${G.name} requires 'fields' to be configured.`);if(!e._filter)throw new Error(`${G.name} requires 'filter' to be configured.`);super.afterConstruct();const{widgetMap:{propertyPicker:t,operatorPicker:i,caseSensitive:r}}=e;t.ion({select:"onPropertySelect",thisObj:e}),i.ion({select:"onOperatorSelect",thisObj:e}),r.ion({change:"onCaseSensitiveChange",thisObj:e}),e.propertyFieldConfig&&t.setConfig(e.propertyFieldConfig),e.operatorFieldConfig&&i.setConfig(e.operatorFieldConfig),t.cls=e.allPropertyPickerClasses,i.cls=e.allOperatorPickerClasses,e.populateUIFromFilter()}changeDateFormat(e){return this.L(e)}get allChildInputs(){const{propertyPicker:e,operatorPicker:t,caseSensitive:i}=this.widgetMap;return[e,t,...this.valueFields,i]}updateDisabled(e){this.allChildInputs.forEach(t=>t.disabled=e)}updateReadOnly(e){const{propertyPicker:t,operatorPicker:i}=this.widgetMap;this.allChildInputs.forEach(r=>r.readOnly=e),t.readOnly=t.readOnly||e,i.readOnly=i.readOnly||e}updatePropertyLocked(e){this.widgetMap.propertyPicker.readOnly=e||this.readOnly,this.widgetMap.propertyPicker.cls=this.allPropertyPickerClasses}updateOperatorLocked(e){this.widgetMap.operatorPicker.readOnly=e||this.readOnly,this.widgetMap.operatorPicker.cls=this.allOperatorPickerClasses}changeOperators(e){const t=e??G.defaultOperators;return Object.keys(t).reduce((i,r)=>F(F({},i),{},{[r]:t[r].map(n=>F(F({},n),{},{text:this.L(n.text)}))}),{})}changeFields(e){let t=e;return Array.isArray(e)&&(re.deprecate("Core","6.0.0","FieldOption[] deprecated, use Object<String, FieldOption> keyed by field name instead"),t=B.keyBy(t,"name")),t}get isMultiSelectValueField(){var e;return["isIncludedIn","isNotIncludedIn"].includes((e=this._filter)===null||e===void 0?void 0:e.operator)}get allPropertyPickerClasses(){var e;return new q(`b-${G.type}-property`,(e=this.propertyFieldConfig)===null||e===void 0?void 0:e.cls,{[`b-${G.type}-combo-locked`]:this.propertyLocked})}get allOperatorPickerClasses(){var e;return new q(`b-${G.type}-operator`,(e=this.operatorFieldConfig)===null||e===void 0?void 0:e.cls,{[`b-${G.type}-combo-locked`]:this.operatorLocked})}getValueFieldConfigs(){const e=this,{valueFieldCls:t,fieldType:i,_filter:{operator:r},onValueChange:n,filterValues:s,isMultiSelectValueField:l,operatorArgCount:o,getValueFieldConfig:a}=e,d=x.merge({},G.defaultValueFieldPlaceholders,e.valueFieldPlaceholders);if(!i||!r||o===0)return[];let c={type:"textfield",listeners:{change:n,input:n,thisObj:e},cls:t,dataset:{type:i},placeholder:e.L(d[l?"list":i])};return l?c=F(F({},c),{},{type:"combo",multiSelect:!0,createOnUnmatched:!0,items:this.getUniqueDataValues(s),value:s??[]}):["number","date","boolean"].includes(i)?c.type=`${i}field`:i==="duration"&&(c.type="durationfield"),a&&(c=e.callback(a,e,[e.filter,c])),l?[c]:B.populate(o,h=>[{type:"widget",tag:"div",cls:`b-${G.type}-value-separator`,content:e.L("L{FieldFilterPicker.and}")},F(F({},c),{},{value:s[h]})]).flat().slice(1)}getUniqueDataValues(e=[]){var t;const i=this,{fieldType:r}=i;if(!i.store||!((t=i._filter)!==null&&t!==void 0&&t.property))return[];const{relatedDisplayField:n}=i.selectedField;let s,l;if(i.fieldIsRelation){const{foreignStore:o}=i.currentPropertyRelationConfig;n?(s=o.allRecords.reduce((a,d)=>(d.id!=null&&a.push({text:d[n],value:d.id}),a),[]),l=s.sort((a,d)=>i.sortStrings(a.text,d.text))):s=o.allRecords.map(a=>a.id)}else s=i.store.allRecords.map(o=>o[i._filter.property]);if(!l){s.push(...e);const o=B.unique(s.reduce((a,d)=>(d!=null&&String(d).trim()!==""&&(r==="date"?a.push(d.valueOf()):r==="duration"?a.push(d.toString()):a.push(d)),a),[]));r==="string"?l=o.sort(i.sortStrings):r==="duration"?l=o.map(a=>new st(a)).filter(a=>a.isValid).sort(i.sortDurations):l=o.sort(i.sortNumerics),r==="date"?l=l.map(a=>{const d=new Date(a);return{text:E.format(d,i.dateFormat),value:a}}):r==="duration"&&(l=l.map(a=>a.toString()))}return l}sortStrings(e,t){return(e??Na).localeCompare(t??Na)}sortNumerics(e,t){return e-t}sortDurations(e,t){return e.valueOf()-t.valueOf()}get fieldType(){var e;return(e=this.selectedField)===null||e===void 0?void 0:e.type}get selectedField(){var e,t;return(e=this.fields)===null||e===void 0?void 0:e[(t=this._filter)===null||t===void 0?void 0:t.property]}get propertyOptions(){var e;return Object.entries((e=this.fields)!==null&&e!==void 0?e:{}).filter(([,t])=>Zd.includes(t.type)||Hs(t)).map(([t,{title:i}])=>({value:t,text:i??t})).sort((t,i)=>t.text.localeCompare(i.text))}get operatorOptions(){return this.operators[this.fieldIsRelation?"relation":this.fieldType]}get fieldIsRelation(){return Boolean(this.currentPropertyRelationConfig)}get currentPropertyRelationConfig(){var e,t;return(e=this.store)===null||e===void 0||(t=e.modelRelations)===null||t===void 0?void 0:t.find(({foreignKey:i})=>{var r;return i===((r=this._filter)===null||r===void 0?void 0:r.property)})}updateOperators(){delete this._operatorArgCountLookup}get operatorArgCountLookup(){return this._operatorArgCountLookup||(this._operatorArgCountLookup=G.buildOperatorArgCountLookup(this.operators))}updateFilter(){this._filter&&this.onFilterChange()}updateStore(e){var t;(t=this._store)===null||t===void 0||t.un(this),e?.ion({refresh:"onStoreRefresh",thisObj:this})}onStoreRefresh({action:e}){this.isMultiSelectValueField&&["dataset","create","update","delete"].includes(e)&&(this.valueFields[0].items=this.getUniqueDataValues(this.filterValues))}refreshValueFields(){const e=this,{valueFieldRow:t}=e.widgetMap;t.removeAll(),t.add(e.getValueFieldConfigs()),delete e._valueFields,e.refreshCaseSensitive()}refreshCaseSensitive(){var e,t;const i=this,{fieldType:r,operatorArgCount:n,isMultiSelectValueField:s}=i,l=(e=i._filter)===null||e===void 0?void 0:e.operator,{caseSensitive:o}=i.widgetMap;o.hidden=r!=="string"||!l||s||n===0,o.checked=((t=i._filter)===null||t===void 0?void 0:t.caseSensitive)!==!1}onPropertySelect(e){var t;const i=this,{_filter:r}=i;r.property=((t=e.record)===null||t===void 0?void 0:t.data.value)||null,i.fieldType!==i._fieldType&&(r.operator=null,r.value=null),i._fieldType=r.type=i.fieldType,i.refreshOperatorPicker(),i.refreshValueFields(),i.triggerChange()}onCaseSensitiveChange({checked:e}){this._filter.caseSensitive=e,this.triggerChange()}onOperatorSelect(e){var t;const i=this,r=i.isMultiSelectValueField,n=this.operatorArgCount;i._filter.operator=((t=e.record)===null||t===void 0?void 0:t.data.value)||null,i.operatorArgCount!==n&&(i._filter.value=null),i.isMultiSelectValueField&&!r&&(i._filter.value=[]),i.refreshValueFields(),i.triggerChange()}triggerChange(){const{filter:e,isValid:t}=this;this.trigger("change",{filter:e,isValid:t})}onValueChange(){const e=this,{isMultiSelectValueField:t,fieldType:i,_filter:r}=e,n=this.valueFields.map(s=>s.value);t&&i==="date"?r.value=n[0].map(s=>new Date(s)):t&&i==="duration"?r.value=n[0].map(s=>new st(s)):(i==="date"&&r.operator==="between"&&E.isValidDate(n[1])&&n[1].setHours(23,59,59,999),r.value=n.length===1?n[0]:n),e.triggerChange()}refreshOperatorPicker(){const{operatorPicker:e}=this.widgetMap,{_filter:{operator:t,property:i},operatorOptions:r}=this;e.items=r,e.value=t,e.hidden=i===null}populateUIFromFilter(e=!1){const t=this,{filterValues:i,widgetMap:{propertyPicker:r,operatorPicker:n},_filter:{property:s,operator:l,disabled:o},propertyOptions:a,operatorOptions:d,isMultiSelectValueField:c}=t;r.items=a,n.items=d,n.hidden=s===null;let h=e;r.value!==s&&(r.value=s,t.refreshOperatorPicker(),h=!0),n.value!==l&&(l===null?n.clear():n.value=l,h=!0),h&&t.refreshValueFields(),t.refreshCaseSensitive(),t.valueFields.forEach((g,f)=>{c&&(g.value.length>0||i.length>0)?t.fieldType==="date"?g.value=i.map(m=>m?.valueOf()):t.fieldType==="duration"?g.value=i.map(m=>m?.toString()):g.value=i:f>=i.length?g.clear():g.value=i[f]}),t.allChildInputs.forEach(g=>g.disabled=t.disabled||o)}get valueFields(){return this._valueFields||(this._valueFields=this.widgetMap.valueFieldRow.queryAll(e=>["textfield","datefield","numberfield","durationfield","combo"].includes(e.type)))}get filterValues(){var e;return((e=this._filter)===null||e===void 0?void 0:e.value)==null?[]:B.asArray(this._filter.value)}onFilterChange(){const e=this,t=e.fieldType,i=t!==e._fieldType;e._fieldType=e._filter.type=t,e.populateUIFromFilter(i)}get operatorArgCount(){const{fieldType:e,filter:{operator:t},operatorArgCountLookup:i}=this;return e&&t?i[e][t]:1}get isValid(){const e=this,{filter:t,fieldType:i,filterValues:r,isMultiSelectValueField:n,operatorArgCount:s}=e,{operator:l}=t,o=s>0&&t?.value==null;return i&&l&&!o&&(n&&r.length>0||r.length===s)&&r.every(a=>a!=null&&(i!=="duration"||a.isValid))}}T(G,"operators",{empty:{value:"empty",text:"L{isEmpty}",argCount:0},notEmpty:{value:"notEmpty",text:"L{isNotEmpty}",argCount:0},"=":{value:"=",text:"L{equals}"},"!=":{value:"!=",text:"L{doesNotEqual}"},">":{value:">",text:"L{isGreaterThan}"},"<":{value:"<",text:"L{isLessThan}"},">=":{value:">=",text:"L{isGreaterThanOrEqualTo}"},"<=":{value:"<=",text:"L{isLessThanOrEqualTo}"},between:{value:"between",text:"L{isBetween}",argCount:2},notBetween:{value:"notBetween",text:"L{isNotBetween}",argCount:2},isIncludedIn:{value:"isIncludedIn",text:"L{isOneOf}"},isNotIncludedIn:{value:"isNotIncludedIn",text:"L{isNotOneOf}"}});T(G,"defaultOperators",{string:[G.operators.empty,G.operators.notEmpty,G.operators["="],G.operators["!="],{value:"includes",text:"L{contains}"},{value:"doesNotInclude",text:"L{doesNotContain}"},{value:"startsWith",text:"L{startsWith}"},{value:"endsWith",text:"L{endsWith}"},G.operators.isIncludedIn,G.operators.isNotIncludedIn],number:[G.operators.empty,G.operators.notEmpty,G.operators["="],G.operators["!="],G.operators[">"],G.operators["<"],G.operators[">="],G.operators["<="],G.operators.between,G.operators.notBetween,G.operators.isIncludedIn,G.operators.isNotIncludedIn],date:[G.operators.empty,G.operators.notEmpty,G.operators["="],G.operators["!="],{value:"<",text:"L{isBefore}"},{value:">",text:"L{isAfter}"},G.operators.between,{value:"isToday",text:"L{isToday}",argCount:0},{value:"isTomorrow",text:"L{isTomorrow}",argCount:0},{value:"isYesterday",text:"L{isYesterday}",argCount:0},{value:"isThisWeek",text:"L{isThisWeek}",argCount:0},{value:"isNextWeek",text:"L{isNextWeek}",argCount:0},{value:"isLastWeek",text:"L{isLastWeek}",argCount:0},{value:"isThisMonth",text:"L{isThisMonth}",argCount:0},{value:"isNextMonth",text:"L{isNextMonth}",argCount:0},{value:"isLastMonth",text:"L{isLastMonth}",argCount:0},{value:"isThisYear",text:"L{isThisYear}",argCount:0},{value:"isNextYear",text:"L{isNextYear}",argCount:0},{value:"isLastYear",text:"L{isLastYear}",argCount:0},{value:"isYearToDate",text:"L{isYearToDate}",argCount:0},G.operators.isIncludedIn,G.operators.isNotIncludedIn],boolean:[{value:"isTrue",text:"L{isTrue}",argCount:0},{value:"isFalse",text:"L{isFalse}",argCount:0}],duration:[G.operators.empty,G.operators.notEmpty,G.operators["="],G.operators["!="],G.operators[">"],G.operators["<"],G.operators[">="],G.operators["<="],G.operators.between,G.operators.notBetween,G.operators.isIncludedIn,G.operators.isNotIncludedIn],relation:[G.operators.isIncludedIn,G.operators.isNotIncludedIn]});T(G,"configurable",{fields:null,disabled:!1,readOnly:!1,layout:"vbox",propertyLocked:!1,operatorLocked:!1,filter:null,propertyFieldConfig:null,operatorFieldConfig:null,valueFieldCls:null,items:{propertyAndOperator:{type:"container",layout:"box",items:{propertyPicker:{type:"combo",items:{},cls:`b-${G.type}-property`,placeholder:"L{FieldFilterPicker.selectAProperty}"},operatorPicker:{type:"combo",items:{},cls:`b-${G.type}-operator`,placeholder:"L{FieldFilterPicker.selectAnOperator}"}}},valueFieldRow:{type:"container",cls:`b-${G.type}-values`,items:{}},caseSensitive:{type:"checkbox",text:"L{FieldFilterPicker.caseSensitive}",cls:`b-${G.type}-case-sensitive`}},operators:G.defaultOperators,dateFormat:"L{FieldFilterPicker.dateFormat}",store:null,valueFieldPlaceholders:null,getValueFieldConfig:null});T(G,"buildOperatorArgCountLookup",u=>B.keyBy(Object.entries(u),([e])=>e,([,e])=>B.keyBy(e,({value:t})=>t,({argCount:t})=>t===void 0?1:t)));G.initClass();G._$name="FieldFilterPicker";class cr extends k{compose(){const{text:e,html:t}=this;return{tag:"label",text:e,html:t}}}T(cr,"$name","Label");T(cr,"type","label");T(cr,"configurable",{text:null,localizableProperties:["text"]});cr.initClass();cr._$name="Label";class Ge extends Je{static get $name(){return"FieldFilterPickerGroup"}static get type(){return"fieldfilterpickergroup"}afterConstruct(){const e=this;e.validateConfig();const{addFilterButton:t}=e.widgetMap;t.ion({click:"addFilter",thisObj:e}),t.text=e.L(t.text),e.store&&e.updateStore(e.store),super.afterConstruct()}changeDateFormat(e){return this.L(e)}validateConfig(){if(!this.fields&&!this.store)throw new Error("FieldFilterPickerGroup requires either a 'fields' or 'store' config property.")}get someFiltersNotShown(){return this.store&&this.store.filters.count>this.filters.length}updateFields(e){this.widgetMap.pickers.childItems.forEach(t=>t.fields=e)}updateFilters(e,t){const i=this;t&&t.filter(r=>!e.find(n=>n.id===r.id)).forEach(r=>{var n;return(n=i.store)===null||n===void 0?void 0:n.removeFilter(r.id)}),e.forEach(r=>r.id=r.id||i.nextFilterId),i.widgetMap.pickers.items=e?.map(r=>i.getPickerRowConfig(r))||[]}changeFilters(e){const{canManageFilter:t}=this;return e&&t?e.filter(i=>this.callback(t,this,[i])):e}updateStore(e){const t=this;t.detachListeners("store"),e&&(t.widgetMap.pickers.childItems.forEach(({widgetMap:{filterPicker:{filter:i,isValid:r}}})=>{e.removeFilter(i.id,!0),r&&e.addFilter(i,!0)}),e.filter(),t.appendFiltersFromStore(),e.ion({name:"store",filter:"onStoreFilter",thisObj:t})),t.widgetMap.pickers.childItems.forEach(i=>i.store=e)}updateShowAddFilterButton(e){this.widgetMap.addFilterButton.hidden=!e}updateAddFilterButtonText(e){this.widgetMap.addFilterButton.text=e??Ge.addFilterButtonDefaultText}appendFiltersFromStore(){const e=this;e.store.filters.forEach(t=>{var i;const r=e.canManage(t),{property:n,operator:s,value:l,id:o,disabled:a=!1,caseSensitive:d}=t;r&&n&&s&&!((i=e.filters)!==null&&i!==void 0&&i.find(c=>c.id===o))&&e.appendFilter({id:o,property:n,operator:s,value:l,disabled:a,caseSensitive:d})})}canManage(e){const t=this;return!t.canManageFilter||t.callback(t.canManageFilter,t,[e])===!0}getFilterPickerConfig(e){const t=this,{fields:i,store:r,disabled:n,readOnly:s,valueFieldCls:l,operators:o,limitToProperty:a,dateFormat:d,getFieldFilterPickerConfig:c}=t;return F({type:t.constructor.childPickerType,fields:i??t.getFieldsFromStore(r),filter:e,store:r,disabled:n,readOnly:s,propertyLocked:Boolean(a),valueFieldCls:l,operators:o,dateFormat:d,internalListeners:{change:"onFilterPickerChange",thisObj:t},flex:1},c?t.callback(c,t,[e]):void 0)}getFieldsFromStore(e){var t,i;return Object.fromEntries((t=(i=e.fields)===null||i===void 0?void 0:i.map(({name:r,type:n})=>[r,{type:n}]))!==null&&t!==void 0?t:[])}getPickerRowConfig(e){const t=this,{disabled:i,readOnly:r,canDeleteFilter:n}=t;return{type:"container",layout:"box",layoutStyle:{alignItems:"start"},cls:`b-${Ge.type}-row`,dataset:{separatorText:t.L("L{FieldFilterPicker.and}")},items:{activeCheckbox:{type:"checkbox",disabled:i,readOnly:r,checked:!Boolean(e.disabled),listeners:{change:"onFilterActiveChange",thisObj:t},cls:`b-${Ge.type}-filter-active`},filterPicker:t.getFilterPickerConfig(e),removeButton:{type:"button",ref:"removeButton",disabled:i,readOnly:r,hidden:n&&t.callback(n,t,[e])===!1,cls:`b-transparent b-${Ge.type}-remove`,icon:"b-fa-trash",internalListeners:{click:"removeFilter",thisObj:t}}}}}get allInputs(){const e=[this.constructor.childPickerType,"button","checkbox"];return this.queryAll(t=>e.includes(t.type))}updateDisabled(e){this.allInputs.forEach(t=>t.disabled=e)}updateReadOnly(e){this.allInputs.forEach(t=>t.readOnly=e)}onFilterActiveChange({source:e,checked:t}){const i=this,r=i.getFilterIndex(e),n=i.filters[r],s=i.getFilterPicker(r);n.disabled=!t,s.onFilterChange(),i.store&&s.isValid&&i.store.addFilter(n,!0),i.updateStoreFilter(),i.triggerChange()}onFilterPickerChange({source:e,filter:t,isValid:i}){const r=this,{store:n}=r,s=r.getFilterIndex(e);n&&(n.removeFilter(t.id,!0),i&&n.addFilter(t,!0),r.updateStoreFilter()),Object.assign(r.filters[s],t),r.triggerChange()}getFilterIndex(e){return this.widgetMap.pickers.childItems.indexOf(e.containingWidget)}getPickerRow(e){return this.widgetMap.pickers.childItems[e]}getFilterPicker(e){return this.getPickerRow(e).widgetMap.filterPicker}get nextFilterId(){return this._nextId=(this._nextId||0)+1,`${this.id}-filter-${this._nextId}`}removeFilter({source:e}){const t=this,i=t.getFilterIndex(e),r=t.filters[i],n=t.getPickerRow(i),s=t.query(l=>l.isFocusable&&l.type!=="container"&&!n.contains(l));s&&s.focus(),t.removeFilterAt(i),t.store&&(t.store.removeFilter(r.id,!0),t.updateStoreFilter()),t.trigger("remove",{filter:r}),t.triggerChange()}addFilter({property:e=null,operator:t=null,value:i=null}={}){const r=this,{filters:n}=r,s={property:r.limitToProperty||e,operator:t,value:i,disabled:!1,id:r.nextFilterId,caseSensitive:!1};if(r.appendFilter(s),r.getFilterPicker(n.length-1).isValid){var l;(l=r.store)===null||l===void 0||l.addFilter(s,!0),r.store&&r.updateStoreFilter()}r.trigger("add",{filter:s}),r.triggerChange()}appendFilter(e){const t=this;(!t.limitToProperty||e.property===t.limitToProperty)&&(t.filters.push(e),t.widgetMap.pickers.add(t.getPickerRowConfig(e,t.filters.length-1)))}onStoreFilter(e){const t=this;if(t._isUpdatingStore)return;const{filters:i}=e,r=i.values.reduce((n,s)=>F(F({},n),{},{[s.id]:s}),{});for(let n=t.filters.length-1;n>=0;n--){const s=t.filters[n],l=r[s.id],o=t.getPickerRow(n);if(o){const{filterPicker:a,activeCheckbox:d}=o.widgetMap;if(!l&&a.isValid)t.removeFilterAt(n);else if(l!==void 0){const{operator:c,value:h,property:g,disabled:f,caseSensitive:m}=l;s!==l&&Object.assign(s,{operator:c,value:h,property:g,disabled:f,caseSensitive:m}),a.filter=s,a.onFilterChange(),d.checked=!f}}}t.appendFiltersFromStore(),t.triggerChange()}removeFilterAt(e){const{widgetMap:{pickers:t},filters:i}=this;t.remove(t.childItems[e]),i.splice(e,1),this.triggerChange()}updateStoreFilter(){this._isUpdatingStore=!0,this.store.filter(),this._isUpdatingStore=!1}get value(){return this.filters}triggerChange(){this.trigger("change",{filters:this.value})}activateAll(){this.setAllActiveStatus(!0)}deactivateAll(){this.setAllActiveStatus(!1)}setAllActiveStatus(e){const t=this,{_filters:i,store:r}=t;i.forEach((n,s)=>{if(e===n.disabled){const{filterPicker:l,activeCheckbox:o}=t.getPickerRow(s).widgetMap;n.disabled=!e,l.onFilterChange(),o.checked=e,e&&r&&l.isValid&&r.addFilter(n,!0)}}),t.updateStoreFilter()}}T(Ge,"addFilterButtonDefaultText","L{FieldFilterPickerGroup.addFilter}");T(Ge,"configurable",{filters:[],fields:null,disabled:!1,readOnly:!1,layout:"vbox",store:null,limitToProperty:null,valueFieldCls:null,showAddFilterButton:!0,canDeleteFilter:null,getFieldFilterPickerConfig:null,canManageFilter:null,addFilterButtonText:null,items:{pickers:{type:"container",layout:"vbox",scrollable:!0,items:{}},addFilterButton:{type:"button",text:Ge.addFilterButtonDefaultText,cls:`b-${Ge.type}-add-button`,hidden:!0}},operators:null,dateFormat:"L{FieldFilterPicker.dateFormat}"});T(Ge,"childPickerType","fieldfilterpicker");Ge.initClass();Ge._$name="FieldFilterPickerGroup";class il extends Ke.mixin(Ud){static get $name(){return"FieldSet"}static get type(){return"fieldset"}static get configurable(){return{bodyTag:"fieldset",focusable:!1,inline:null,inlineInternal:null,layout:{type:"box",horizontal:!1}}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}get bodyConfig(){const e=super.bodyConfig,{className:t}=e,{inlineInternal:i,hasLabel:r,title:n}=this;return delete e.html,t["b-inline"]=i,t["b-fieldset-has-label"]=r,n&&(e.children={legendElement:{tag:"legend",text:n,class:{"b-fieldset-legend":1}}}),e}compose(){const{inlineInternal:e,label:t,labelCls:i,labelWidth:r}=this;return{class:{"b-field":t,"b-vbox":!e},children:{"labelElement > headerElement":(t||null)&&{tag:"label",html:t,class:{"b-label":1,"b-align-start":1,[i]:i},style:{width:b.unitize("width",r)[1]}}}}}syncInlineInternal(){var e;this.inlineInternal=(e=this.inline)!==null&&e!==void 0?e:this.label!=null&&this.labelPosition==="before"}updateDisabled(e,t){super.updateDisabled(e,t),this.eachWidget(i=>{i.disabled=e},!1)}updateInline(){this.syncInlineInternal()}updateInlineInternal(e){this.layout.horizontal=e}updateLabel(){this.syncInlineInternal()}updateLabelPosition(){this.syncInlineInternal()}}il.initClass();il._$name="FieldSet";class ec extends xe{static get $name(){return"FileField"}static get type(){return"filefield"}static get configurable(){return{multiple:null,accept:null,inputType:"file",attributes:["multiple","accept"]}}get files(){return this.input.files}pickFile(){this.input.click()}get multiple(){return this._multiple?"":null}clear(){this.input.value=null}triggerChange(e){this.triggerFieldChange({event:e,value:this.input.value,oldValue:this._lastValue,userAction:!0,valid:!0})}}ec.initClass();ec._$name="FileField";class tc extends Je{static get $name(){return"FilePicker"}static get type(){return"filepicker"}static get defaultConfig(){return{defaultBindProperty:"value",buttonConfig:null,fileFieldConfig:null}}construct(e={}){const t=this;e.items=[Object.assign({type:"button",ref:"fileButton",text:"L{FilePicker.file}",localeClass:this},e.buttonConfig),Object.assign({type:"filefield",ref:"fileField",style:"display: none"},e.fileFieldConfig)].concat(e.items||[]),super.construct(e),t.button.ion({click:t.onButtonClick,thisObj:t}),t.fileField.ion({change:t.onFileFieldChange,thisObj:t}),t._thisIsAUsedExpression(t.fileTip)}get button(){return this.widgetMap.fileButton}get fileField(){return this.widgetMap.fileField}get files(){return this.fileField.files}get fileTip(){const e=this;return e._fileTip||(e._fileTip=new me({cls:"b-file-tip",forElement:e.button.element,showOnHover:!0,align:"b-t",scrollAction:"realign",internalListeners:{beforeshow(){const t=this,i=e.files;return i&&i.length?(t.html=`${Array.from(i).map(r=>r.name).join("<br>")}`,!0):!1}}}))}clear(){const e=this;e.fileField.clear(),e.button.badge="",e.trigger("clear")}onButtonClick({event:e}){this.fileField.pickFile(),e.preventDefault()}onFileFieldChange({valid:e}){const t=this;t.button.badge=t.files.length||"",t.triggerFieldChange({files:t.files,valid:e})}}tc.initClass();tc._$name="FilePicker";class ic extends pi{static get $name(){return"FilterField"}static get type(){return"filterfield"}static get configurable(){return{field:null,store:null,filterFunction:null,clearable:!0,keyStrokeChangeDelay:100,onChange({value:e}){const{store:t,field:i,filterFunction:r}=this;if(t){const n=`${i||this.id}-Filter`;if(e.length===0)t.removeFilter(n);else{let s;r?s=l=>r(l,e):(e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=l=>l.get(i).match(new RegExp(e,"i"))),t.filter({id:n,filterBy:s})}}}}}updateValue(e,t){super.updateValue(e,t),e&&this.isConfiguring&&this.onChange({value:e})}}ic.initClass();ic._$name="FilterField";const rc=[{ref:"cancelButton",cls:"b-messagedialog-cancelbutton b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelClick"},{ref:"okButton",cls:"b-messagedialog-okbutton b-raised b-blue",text:"L{Object.Ok}",onClick:"up.onOkClick"}];W.isWindows&&rc.reverse();class gn extends ze{static get $name(){return"MessageDialog"}static get type(){return"messagedialog"}static get configurable(){return{centered:!0,modal:!0,hidden:!0,autoShow:!1,closeAction:"hide",title:"\xA0",lazyItems:{$config:["lazy"],value:[{cls:"b-messagedialog-message",ref:"message"},{type:"textfield",cls:"b-messagedialog-input",ref:"input"}]},showClass:null,bbar:{overflow:null,items:rc}}}construct(){this.okButton=this.yesButton=1,this.cancelButton=3,super.construct(...arguments)}destroy(){}async confirm(){return this.showDialog("confirm",...arguments)}async alert(){return this.showDialog("alert",...arguments)}async prompt({textField:e}){const t=this.widgetMap.input;return k.reconfigure(t,e),t.value="",this.showDialog("prompt",...arguments)}showDialog(e,{message:t="",title:i="\xA0",cancelButton:r,okButton:n,rootElement:s=document.body}){const l=this;return l.rootElement=s,l.getConfig("lazyItems"),l.title=l.optionalL(i),l.widgetMap.message.html=l.optionalL(t),l.showClass=`b-messagedialog-${e}`,n&&(n=typeof n=="string"?{text:n}:n),r&&(r=typeof r=="string"?{text:r}:r),n=Object.assign({},l.widgetMap.okButton.initialConfig,n),r=Object.assign({},l.widgetMap.cancelButton.initialConfig,r),n.text=l.optionalL(n.text),r.text=l.optionalL(r.text),k.reconfigure(l.widgetMap.okButton,n),k.reconfigure(l.widgetMap.cancelButton,r),l.show(),l.promise=new Promise(o=>{l.resolve=o})}show(){const e=b.getActiveElement(this.element);return this.owner=this.element.contains(e)?null:gn.fromElement(document.activeElement),super.show(...arguments)}updateShowClass(e,t){const{classList:i}=this.element;t&&i.remove(t),e&&i.add(e)}doResolve(e){const t=this,{resolve:i}=t;if(i){const r=t.showClass==="b-messagedialog-prompt";if(r&&e===t.okButton&&!t.widgetMap.input.isValid)return;t.resolve=t.reject=t.promise=null,i(r?{button:e,text:t.widgetMap.input.value}:e),t.hide()}}onInternalKeyDown(e){e.key==="Escape"&&(e.stopImmediatePropagation(),this.onCancelClick()),e.key==="Enter"&&(e.stopImmediatePropagation(),e.preventDefault(),this.onOkClick()),super.onInternalKeyDown(e)}onOkClick(){this.doResolve(li.okButton)}onCancelClick(){this.doResolve(li.cancelButton)}}gn.initClass();const li=new Proxy({},{get(u,e){const t=u.instance||(u.instance=new gn({rootElement:document.body})),i=t[e];return typeof i=="function"?i.bind(t):i}});class nc extends mi{static get $name(){return"PagingToolbar"}static get type(){return"pagingtoolbar"}static get defaultConfig(){return{store:null,defaults:{localeClass:this},items:{firstPageButton:{onClick:"up.onFirstPageClick",icon:"b-icon-first",weight:100,tooltip:"L{PagingToolbar.firstPage}"},previousPageButton:{onClick:"up.onPreviousPageClick",icon:"b-icon-previous",weight:110,tooltip:"L{PagingToolbar.prevPage}"},pageNumber:{type:"numberfield",label:"L{page}",min:1,max:1,triggers:null,onChange:"up.onPageNumberChange",highlightExternalChange:!1,weight:120},pageCount:{type:"widget",cls:"b-pagecount b-toolbar-text",weight:130},nextPageButton:{onClick:"up.onNextPageClick",icon:"b-icon-next",weight:140,tooltip:"L{PagingToolbar.nextPage}"},lastPageButton:{onClick:"up.onLastPageClick",icon:"b-icon-last",weight:150,tooltip:"L{PagingToolbar.lastPage}"},separator:{type:"widget",cls:"b-toolbar-separator",weight:151},reloadButton:{onClick:"up.onReloadClick",icon:"b-icon-reload",weight:160,tooltip:"L{PagingToolbar.reload}"},spacer:{type:"widget",cls:"b-toolbar-fill",weight:161},dataSummary:{type:"widget",cls:"b-toolbar-text",weight:170}}}}set parent(e){super.parent=e,this.store||(this.store=e.store)}get parent(){return super.parent}set store(e){const t=this;t.detachListeners("store"),t._store=e,e&&(e.ion({name:"store",beforerequest:"onStoreBeforeRequest",afterrequest:"onStoreChange",change:"onStoreChange",thisObj:t}),e.isLoading&&t.onStoreBeforeRequest())}get store(){return this._store}onStoreBeforeRequest(){this.eachWidget(e=>e.disable())}updateLocalization(){this.updateSummary(),super.updateLocalization()}updateSummary(){const e=this,{pageCount:t,dataSummary:i}=e.widgetMap;let r=0,n=0,s=0,l=0,o=0;if(e.store){const{store:a}=e,{pageSize:d,currentPage:c}=a;r=a.count,n=a.lastPage,o=a.allCount,s=Math.max(0,(c-1)*d+1),l=Math.min(o,s+d-1)}t.html=e.L("L{pageCountTemplate}")({lastPage:n}),i.html=r?e.L("L{summaryTemplate}")({start:s,end:l,allCount:o}):e.L("L{noRecords}")}onStoreChange(){const e=this,{widgetMap:t,store:i}=e,{count:r,lastPage:n,currentPage:s}=i,{pageNumber:l,pageCount:o,firstPageButton:a,previousPageButton:d,nextPageButton:c,lastPageButton:h,dataSummary:g}=t;e.eachWidget(f=>f.enable()),l.value=s,l.max=n,g.disabled=l.disabled=o.disabled=!r,a.disabled=d.disabled=s<=1||!r,c.disabled=h.disabled=s>=n||!r,e.updateSummary()}onPageNumberChange({value:e}){this.store.currentPage!==e&&this.store.loadPage(e)}onFirstPageClick(){this.store.loadPage(1)}onPreviousPageClick(){this.store.previousPage()}onNextPageClick(){this.store.nextPage()}onLastPageClick(){this.store.loadPage(this.store.lastPage)}onReloadClick(){this.store.loadPage(this.store.currentPage)}}nc.initClass();nc._$name="PagingToolbar";const{dockIsHorz:Sm}=gi.maps,Em={top:0,down:0,left:1,bottom:2,up:2,right:3},Tm={},ps={up:{from:"translate(0,0)",to:"translate(0,-100%)"},down:{from:"translate(0,0)",to:"translate(0,100%)"},left:{from:"translate(0,0)",to:"translate(-100%,0)"},right:{from:"translate(0,0)",to:"translate(100%,0)"}};class sc extends gi.mixin(Se){static get $name(){return"PanelCollapserOverlay"}static get type(){return"overlay"}static get configurable(){return{autoCloseDelay:1e3,autoClose:!0,revealing:{value:null,$config:null,default:!1},recollapseTool:{type:"collapsetool",cls:"b-recollapse",collapsify:"overlay",handler(){var e;(e=this.collapsible)===null||e===void 0||e.toggleReveal()}}}}static get delayable(){return{doAutoClose:0}}doAutoClose(){this.toggleReveal(!1)}updateAutoCloseDelay(e){const{doAutoClose:t}=this;(t.suspended=e==null||e<0)||(t.delay=e,t.immediate=!e)}changeRecollapseTool(e){const t=this,{panel:i}=t;if(t.isConfiguring||t.isDestroying||!i||i.isDestroying)return e;i.tools={recollapse:e}}beforeCollapse(e){if(super.beforeCollapse(e)===!1)return!1;this.panel.revealed&&(e.animation=null)}applyHeaderDock(e,t=!0){var i;(i=this.panel)===null||i===void 0||i.recompose(),super.applyHeaderDock(e,t)}collapseBegin(e){const t=this,{collapseDir:i,innerElement:r}=t,{animation:n}=e,{collapseTool:s,panel:l}=t;t.configuredWidth=l._lastWidth,t.configuredHeight=l._lastHeight,t.applyHeaderDock(!0),t.lockInnerSize(),s?.element.classList.add("b-collapsed"),n&&(l.element.classList.add("b-collapsing"),n.element=r,n.transform=ps[i],e.animation=he.run(n))}onComplete(e){var t,i;super.onComplete(e);const r=this,{panel:n}=r,{element:s}=n;r.autoCloseLeaveDetacher=(t=r.autoCloseLeaveDetacher)===null||t===void 0?void 0:t.call(r),r.autoCloseClickDetacher=(i=r.autoCloseClickDetacher)===null||i===void 0?void 0:i.call(r),r.doAutoClose.cancel(),e==="reveal"&&r.autoClose&&(n.containsFocus&&(r.autoCloseLeaveDetacher=A.on({element:s,mouseenter:l=>{r.doAutoClose.cancel()},mouseleave:l=>{r.doAutoClose()}})),r.autoCloseClickDetacher=A.on({element:document.body,thisObj:n,mousedown:l=>{if(l.target!==s&&!s.contains(l.target)&&r.autoCloseDelay!=null){var o;const a=n.containsFocus&&((o=n.focusInEvent)===null||o===void 0?void 0:o.relatedTarget)||b.getActiveElement(s);a!=null&&a.contains(l.target)||r.doAutoClose.now()}}}))}expandBegin(e){const t=this,{animation:i}=e,{collapseDir:r,collapseTool:n,innerElement:s,panel:l}=t,{element:o}=l;o.classList.remove("b-collapsed","b-collapsing"),t.restoreConfiguredSize(),t.lockInnerSize(!1),t.lockInnerSize(),n?.element.classList.remove("b-collapsed"),i&&(o.classList.add("b-collapsed","b-expanding"),i.element=s,i.transform={from:ps[r].to,to:ps[r].from},e.animation=he.run(i))}expandEnd(e){super.expandEnd(e);const{panel:t}=this;e.completed&&(t.revealed=!1),t.element.classList.remove("b-expanding")}expandRevert(e){super.expandRevert(e),this.panel.element.classList.add("b-expanding")}get innerElement(){return this.panel.overlayElement}get innerSizeElement(){return this.panel.element}get toolsConfig(){const e=this,{direction:t}=e,i=super.toolsConfig,r=e.recollapseTool;return r?F(F({},i),{},{recollapse:r&&x.assign({direction:t.toLowerCase()},r)}):i}lockInnerSize(e=!0){const t=this,{panel:i}=t,r=e&&i.rectangle(),n=e?[0,0,0,0]:"",s=super.lockInnerSize(e);return e&&(n[Em[t.collapseDir]]=`-${r[t.collapseDim]+10}px`),i.element.style.clipPath=e?`inset(${n.join(" ")})`:"",s}onOverlayTransitionDone(e){const t=this,{panel:i}=t;e.srcElement===i.overlayElement&&t.revealing&&(t.revealing=!1,t.onComplete(i.revealed?"reveal":"unreveal"))}onRevealerClick(){this.toggleReveal()}splitHeaderItems({as:e,dock:t}=Tm){var i;return(i=this.panel)===null||i===void 0?void 0:i.splitHeaderItems({as:e,dock:t,overlay:!0})}toggleReveal(e){const{panel:t}=this,{element:i}=t;t.collapsed&&(e==null&&(e=!t.revealed),t.revealed!==e&&t.trigger("beforeToggleReveal",{reveal:e})!==!1&&(!e&&i.contains(b.getActiveElement(i))&&t.revertFocus(!0),this.revealing=!0,t.revealed=e))}updateRevealing(e){const t=this,i=/left|right/i,{panel:r}=t,n=i.test(t.collapseDir)?"height":"width";r&&(t.innerElement.style[n]="0px",t.innerElement.style[`min-${n}`]="100%",r.element.classList[e?"add":"remove"]("b-panel-overlay-revealing"))}wrapCollapser(e,t){var i;const r=this,{collapseDir:n,panel:s}=r,{expandedHeaderDock:l,header:o,uiClassList:a}=s,d=(i=s.tools)===null||i===void 0?void 0:i.recollapse,[c,h]=r.splitHeaderItems({dock:r.collapseDock,as:"element"}),g=Sm[l],f=s.hasHeader?s.title||o?.title||"\xA0":null;return d&&(d.direction=n),["overlayElement",{class:F(F({},a),{},{[`b-panel-overlay-header-${l}`]:1,[`b-panel-overlay-${n}`]:1,[`b-${g?"h":"v"}box`]:1,"b-panel-overlay":1,"b-box-center":1}),listeners:{transitionend:m=>r.onOverlayTransitionDone(m)},children:{overlayHeaderElement:f&&{tag:"header",class:new q(F(F({},a),{},{[`b-dock-${l}`]:1,"b-panel-header":1,"b-panel-overlay-header":1}),o?.cls),children:[...c,{reference:"overlayTitleElement",html:f,class:F(F({},a),{},{[`b-align-${o?.titleAlign||"start"}`]:1,"b-header-title":1})},...h]},[e]:t}}]}}sc.initClass();sc._$name="PanelCollapserOverlay";class lc extends xe{static get type(){return"passwordfield"}static get alias(){return"password"}static get $name(){return"PasswordField"}construct(e={}){e.inputType="password",super.construct(...arguments),this.element.classList.add("b-textfield")}}lc.initClass();lc._$name="PasswordField";class oc extends vi{static get $name(){return"Radio"}static get type(){return"radio"}static get alias(){return"radiobutton"}static get configurable(){return{inputType:"radio",clearable:null,uncheckedValue:void 0}}get textLabelCls(){return super.textLabelCls+" b-radio-label"}internalOnClick(e){super.internalOnClick(e)!==!1&&this.checked&&this.clearable&&(this.checked=!1)}updateName(e){this.toggleGroup=e}updateClearable(){}}oc.initClass();oc._$name="Radio";class ac extends il{static get $name(){return"RadioGroup"}static get type(){return"radiogroup"}static get configurable(){return{defaultType:"radio",clearable:null,name:null,options:{value:null,$config:{merge:"items"}},defaultBindProperty:"value"}}get existingOptions(){const{name:e}=this;return this.ensureItems().filter(t=>t.name===e)}get refPrefix(){return`${this.name||this.ref||this.id}_`}get selected(){return this.existingOptions.filter(e=>e.input.checked)[0]||null}get value(){const{selected:e}=this;return e?e.checkedValue:null}set value(e){this.existingOptions.forEach(t=>{t.isConfiguring=this.isConfiguring,t.checked=t.checkedValue===e,t.isConfiguring=!1})}ensureItems(){return this.getConfig("options"),super.ensureItems()}changeOptions(e,t){if(!(e&&t&&x.isDeeplyEqual(t,e)))return e}convertOption(e,t,i){const r=this,{name:n}=r,s={name:n,type:"radio",value:e===r.value,ref:`${r.refPrefix}${e}`,checkedValue:e};return typeof t=="string"?s.text=t:x.assign(s,t),i?k.reconfigure(i,s):s}isOurRadio(e){return e.isRadio&&e.name===this.name}isolateFieldChange(e){return this.isOurRadio(e)}onChildAdd(e){super.onChildAdd(e),this.isOurRadio(e)&&e.ion({name:e.id,beforeChange:"onRadioItemBeforeChange",change:"onRadioItemChange",click:"onRadioClick",thisObj:this})}onChildRemove(e){this.isOurRadio(e)&&this.detachListeners(e.id),super.onChildRemove(e)}onRadioClick(e){const{source:t}=e;t.checked&&this.clearable&&t.clearable==null&&(t.checked=!1)}onRadioItemBeforeChange(e){if(e.checked){const t=this,{lastValue:i}=t;if(!t.reverting&&t.trigger("beforeChange",t.wrapRadioEvent(e))===!1&&i!=null&&i!==t.value)return t.reverting=!0,e.source.uncheckToggleGroupMembers(),t.value=i,t.lastValue=i,t.reverting=!1,!1}}onRadioItemChange(e){const t=this;e.checked&&!t.reverting&&(t.triggerFieldChange(t.wrapRadioEvent(e)),t.lastValue=t.value)}wrapRadioEvent(e){return{from:e,item:e.source,userAction:e.userAction,lastValue:this.lastValue,value:this.value}}updateOptions(){const e=this,{options:t,refPrefix:i}=e,r=e.existingOptions.reduce((a,d)=>(a[d.ref.substring(i.length)]=d,a),{});let n=0,s,l;if(t)for(s in t)l=e.convertOption(s,t[s],r[s]),delete r[s],e.insert(l,n++);const o=Object.values(r);o!=null&&o.length&&(e.remove(o),o.forEach(a=>a.destroy()))}}ac.initClass();ac._$name="RadioGroup";const Rm={ArrowUp:1,ArrowDown:1,ArrowLeft:1,ArrowRight:1};class dc extends k{static get $name(){return"Slider"}static get type(){return"slider"}static get configurable(){return{text:null,showValue:!0,showTooltip:!1,min:0,max:100,step:1,value:50,unit:null,thumbSize:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip",align:"b-t",anchor:!1,axisLock:!0}},localizableProperties:["text"],triggerChangeOnInput:null,defaultBindProperty:"value"}}compose(){const{id:e,min:t,max:i,showValue:r,step:n,text:s,value:l,unit:o="",disabled:a}=this,d=`${e}-input`,c=Boolean(s||r);return{class:{"b-has-label":c,"b-text":c,"b-disabled":a},children:{input:{tag:"input",type:"range",id:d,reference:"input",disabled:a,min:t,max:i,step:n,value:l,listeners:{input:"onInternalInput",change:"onInternalChange",mouseover:"onInternalMouseOver",mouseout:"onInternalMouseOut"}},label:{tag:"label",for:d,html:r?s?`${s} (${l}${o})`:l+o:s}}}}get focusElement(){return this.input}get percentProgress(){return(this.value-this.min)/(this.max-this.min)*100}onInternalKeyDown(e){!this.readOnly&&Rm[e.key]&&e.stopImmediatePropagation()}onInternalChange(){this.updateUI(),this.triggerChange(!0),this.trigger("action",{value:this.value})}onInternalInput(){const e=this;if(e.readOnly){e.input.value=e.value;return}e.value=parseInt(e.input.value,10),e.trigger("input",{value:e.value}),e.triggerChangeOnInput&&e.triggerChange(e)}onInternalMouseOver(){var e;const t=this,i=t.rtl?100-t.percentProgress:t.percentProgress;(e=t.tooltip)===null||e===void 0||e.showBy({target:O.from(t.input).inflate(t.thumbSize/2,-t.thumbSize/2),align:`b-t${Math.round(i)}`})}onInternalMouseOut(){var e;(e=this.tooltip)===null||e===void 0||e.hide()}triggerChange(e){this.triggerFieldChange({value:this.value,valid:!0,userAction:e})}updateMax(e){const t=this;t.input&&t._value>e&&(t.value=e,t.trigger("input",{value:t.value}))}updateMin(e){const t=this;t.input&&t._value<e&&(t.value=e,t.trigger("input",{value:t.value}))}changeTooltip(e,t){var i;return e&&(e.owner=this),this.showTooltip?me.reconfigure(t,e,{owner:this,defaults:{forElement:this.input,html:String(this.value)+((i=this.unit)!==null&&i!==void 0?i:"")}}):null}changeValue(e){const t=this,{min:i,step:r}=t;return e=Math.min(Math.max(e,i),t.max),e>i?i+x.roundTo(e-i,r):x.roundTo(e,r)}updateValue(e){const t=this,{input:i,_tooltip:r}=t;if(r){var n;r.html=t.value+((n=t.unit)!==null&&n!==void 0?n:"")}i&&i.value!==String(e)&&(i.value=e,t.triggerChange(!1)),t.updateUI()}updateUI(){var e,t;const i=this;!((e=i._tooltip)===null||e===void 0)&&e.isVisible&&((t=i._tooltip)===null||t===void 0||t.alignTo({target:O.from(i.input).inflate(i.thumbSize/2,-i.thumbSize/2),align:`b-t${Math.round(i.percentProgress)}`}))}}dc.initClass();dc._$name="Slider";class cc extends vi{static get $name(){return"SlideToggle"}static get type(){return"slidetoggle"}static get properties(){return{toggledCls:"b-slidetoggle-checked"}}construct(e){e!=null&&e.checked&&(e.cls=(e.cls||"")+" "+this.constructor.properties.toggledCls),super.construct(e)}get innerElements(){const e=super.innerElements;return e.splice(1,0,this.toggleElement),this.text?e[e.length-1].class="b-slidetoggle-label":e.pop(),e}get toggleElement(){return{class:"b-slidetoggle-toggle",reference:"slideToggle",children:[{class:"b-slidetoggle-thumb",reference:"slideThumb"}]}}internalOnChange(){super.internalOnChange(),this.element.classList[this.value?"add":"remove"](this.toggledCls)}}cc.initClass();cc._$name="SlideToggle";const Ba=["b-horizontal","b-vertical"],vs=u=>b.getStyleValue(u.parentElement,"display")==="flex"&&(parseInt(b.getStyleValue(u,"flex-basis"),10)||parseInt(b.getStyleValue(u,"flex-grow"),10)),Dm={horizontal:!1,vertical:!0};class uc extends k{static get $name(){return"Splitter"}static get type(){return"splitter"}static get configurable(){return{orientation:"auto",vertical:null,containerElement:{$config:"nullify",value:null},nextNeighbor:{$config:"nullify",value:null},previousNeighbor:{$config:"nullify",value:null}}}static get delayable(){return{syncState:"raf"}}doDestroy(){var e;(e=this.mouseDetacher)===null||e===void 0||e.call(this),super.doDestroy()}compose(){return{class:{"b-splitter":1},listeners:F({pointerdown:"onMouseDown",mouseenter:"syncState"},!W.supportsPointerEvents&&{mousedown:"onMouseDown",touchstart:"onMouseDown"})}}get currentOrientation(){return this.vertical?"vertical":"horizontal"}get nextWidget(){return k.fromElement(this.element.nextElementSibling,1)}get previousWidget(){return k.fromElement(this.element.previousElementSibling,1)}updateContainerElement(e){var t;const i=this;i.stateDetector=(t=i.stateDetector)===null||t===void 0?void 0:t.disconnect(),e&&(i.stateDetector=new MutationObserver(()=>i.syncState()),i.stateDetector.observe(e,{attributes:!0,childList:!0}))}updateNextNeighbor(e){this.watchNeighbor(e,"next")}updatePreviousNeighbor(e){this.watchNeighbor(e,"previous")}watchNeighbor(e,t){this.detachListeners(t),e?.ion({name:t,thisObj:this,collapse:"syncState",expand:"syncState",hide:"syncState",show:"syncState"})}updateOrientation(){this.syncState.now()}updateVertical(e){var t;const i=(t=this.element)===null||t===void 0?void 0:t.classList;i?.add(Ba[e?1:0]),i?.remove(Ba[e?0:1])}syncState(){var e;const t=this,{element:i,nextWidget:r,previousWidget:n}=t;let s=(e=Dm[t.orientation])!==null&&e!==void 0?e:null;if(t.nextNeighbor=r,t.previousNeighbor=n,t.disabled=r&&(r.collapsible&&r.collapsed||r.hidden)||n&&(n.collapsible&&n.collapsed||n.hidden),s!==null&&r&&n)t.containerElement=null;else if(t.containerElement=i.parentElement,t.rendered&&i.offsetParent){const l=b.getStyleValue(i.parentElement,"flex-direction");if(l)s=!l.startsWith("column");else{const o=i.previousElementSibling,a=i.nextElementSibling;if(!o||!a)return;const d=o.getBoundingClientRect(),c=a.getBoundingClientRect(),h=d.top<c.top?d:c,g=h===c?d:c;s=h.top===g.top}}t.vertical=s}onMouseDown(e){var t;e.preventDefault(),e.touches&&(e=e.touches[0]);const i=this,{element:r}=i,n=r.previousElementSibling,s=r.nextElementSibling,l=vs(n),o=vs(s),a=[];(t=i.mouseDetacher)===null||t===void 0||t.call(i);for(const c of r.parentElement.children)vs(c)&&c!==r&&a.push({element:c,width:c.offsetWidth,height:c.offsetHeight});i.context={startX:e.pageX,startY:e.pageY,prevWidth:n.offsetWidth,prevHeight:n.offsetHeight,nextWidth:s.offsetWidth,nextHeight:s.offsetHeight,prevHasFlex:l,nextHasFlex:o,flexed:a,prev:n,next:s};const d={element:document,pointermove:"onMouseMove",pointerup:"onMouseUp",thisObj:i};W.supportsPointerEvents||(d.mousemove=d.touchmove="onMouseMove",d.mouseup=d.touchend="onMouseUp"),r.classList.add("b-moving"),i.mouseDetacher=A.on(d)}onMouseMove(e){const t=this,{context:i,nextWidget:r,previousWidget:n}=t,s=i.prev.style,l=i.next.style,o=(e.pageX-i.startX)*(t.rtl?-1:1),a=e.pageY-i.startY;if(e.preventDefault(),Object.assign(i,{deltaX:o,deltaY:a}),i.started||(i.started=!0,t.trigger("dragStart",{context:i,event:e}),i.flexed.forEach(d=>{d.element.style.flexGrow=t.vertical?d.width:d.height,d.element.style.flexBasis="0"})),t.vertical){const d=i.prevWidth+o,c=i.nextWidth-o;i.prevHasFlex?s.flexGrow=d:n?n.width=d:s.width=`${d}px`,i.nextHasFlex?l.flexGrow=c:r?r.width=c:l.width=`${c}px`}else{const d=i.prevHeight+a,c=i.nextHeight-a;i.prevHasFlex?s.flexGrow=d:n?n.height=d:s.height=`${d}px`,i.nextHasFlex?l.flexGrow=c:r?r.height=c:l.height=`${c}px`}t.trigger("drag",{context:i,event:e})}onMouseUp(e){var t;const i=this;(t=i.mouseDetacher)===null||t===void 0||t.call(i),i.mouseDetacher=null,i.element.classList.remove("b-moving"),i.context.started&&i.trigger("drop",{context:i.context,event:e}),i.context=null}render(){super.render(...arguments),this.syncState.now(),this.vertical===null&&this.syncState()}}uc.initClass();uc._$name="Splitter";class rl extends Ys{static get $name(){return"Tab"}static get type(){return"tab"}static get configurable(){return{active:null,index:null,isFirst:null,isLast:null,item:{value:null,$config:"nullify"},itemCls:null,tabPanel:null,titleProperty:"text",titleSource:"title",role:"tab"}}compose(){const{active:e,cls:t,index:i,isFirst:r,isLast:n}=this,s=this.owner.visibleChildCount;return{tabindex:0,"aria-selected":e,"aria-setsize":s,"aria-posinset":i+1,class:F({"b-tabpanel-tab":1,"b-active":e,"b-tab-first":r,"b-tab-last":n},t),dataset:{index:i}}}updateIndex(e){this.isFirst=!e}updateItem(e,t){var i,r;const n=this;t?.tab===n&&(t.tab=null),e&&(e.tab=n,n[n.titleProperty]=e[n.titleSource],n.itemCls=e.cls,n.ariaElement.setAttribute("aria-controls",e.id),e.role="tabpanel"),(i=n.itemChangeDetacher)===null||i===void 0||i.call(n),n.itemChangeDetacher=e&&pe.after(e,"onConfigChange","onItemConfigChange",n,{return:!1}),(r=n.itemHideDetacher)===null||r===void 0||r.call(n),n.itemHideDetacher=e?.ion({beforeChangeHidden:"onItemBeforeChangeHidden",beforeHide:"onItemBeforeHide",beforeUpdateDisabled:"onItemBeforeUpdateDisabled",thisObj:n,prio:1e3}),n.syncMinMax()}updateItemCls(e,t){const{element:i}=this,r=i&&q.from(i?.classList,!0);i&&(r.remove(t).add(e),i.className=r.value)}updateRotate(e,t){!e!=!t&&this.syncMinMax()}syncMinMax(){const e=this,{rotate:t,tabPanel:i}=e;let{_minWidth:r,_minHeight:n,_maxWidth:s,_maxHeight:l}=e;if(i){const{tabMinWidth:o,tabMaxWidth:a}=i;o!=null&&(t?(r===o&&(r=null),n=o):(n===o&&(n=null),r=o)),a!=null&&(t?(s===a&&(s=null),l=a):(l===a&&(l=null),s=a)),e.minWidth=r,e.minHeight=n,e.maxWidth=s,e.maxHeight=l}}onItemBeforeChangeHidden({source:e,hidden:t}){if(!e.$isDeactivating&&!e.$isActivating){const{tabPanel:i}=this;this.hidden=t,t&&e===i.activeItem&&i.activateAvailableTab(e)}}onItemBeforeHide(){this.item.$isDeactivating||this.hide()}onItemBeforeUpdateDisabled({source:e,disabled:t}){const{tabPanel:i}=this;this.disabled=t,e===i.activeItem&&i.activateAvailableTab(e)}onItemConfigChange({name:e,value:t}){e===this.titleSource&&(this[this.titleProperty]=t)}}rl.initClass();rl._$name="Tab";const Ar=u=>u.isTab;class hc extends mi{static get $name(){return"TabBar"}static get type(){return"tabbar"}static get configurable(){return{defaultType:"tab",overflow:"scroll",role:"tablist",ignoreParentReadOnly:!0}}get firstTab(){return this.tabAt(0)}get lastTab(){return this.tabAt(-1)}get tabCount(){return this._items.countOf(Ar)}get tabs(){return B.from(this._items,Ar)}compose(){return{children:{toolbarContent:{class:{"b-tabpanel-tabs":1}}}}}indexOfTab(e){return this._items.indexOf(e,Ar)}onChildAdd(e){super.onChildAdd(e),e.index==null&&this.syncTabs()}onChildRemove(e){super.onChildRemove(e),this.syncTabs()}onFocusIn(){const{activeIndex:e}=this.owner;isNaN(e)||this.tabs[e].focus()}syncTabs(){const{tabs:e}=this;for(let t=0,i=e.length;t<i;++t)e[t].index=t,e[t].isFirst=!t,e[t].isLast=t===i-1}tabAt(e){return this._items.find(Ar,e)||null}}hc.initClass();hc._$name="TabBar";const $r=["b-slide-out-left","b-slide-out-right","b-slide-in-left","b-slide-in-right"];class ur extends vt{onChildAdd(e){super.onChildAdd(e);const t=this,{activeItem:i,owner:r}=t,n=r.activeIndex!=null?r.activeIndex:t.activeIndex||0,s=r.items.indexOf(e),l=i!=null?e===i:s===n;e.ion({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:t}),l?(t._activeIndex=s,t._activeItem=e,e.show()):(e.$isDeactivating=!0,e.hide(),e.$isDeactivating=!1)}onChildRemove(e){super.onChildRemove(e);const t=this;t._activeItem===e&&t.activateSiblingOf(e),t._activeIndex=t.owner.items.indexOf(t._activeItem),e.un({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:t})}onBeforeChildShow({source:e}){if(!this.owner.isConfiguring&&!e.$isActivating)return this.activeItem=e,!1}onBeforeChildHide({source:e}){if(!this.owner.isConfiguring&&!e.$isDeactivating)return this.activateSiblingOf(e),!1}activateSiblingOf(e){const{owner:t}=this,i=t.items.slice(),r=i.indexOf(e);i.splice(r,1),this.activeIndex=Math.min(r,i.length-1)}setActiveItem(e,t=this.activeIndex,i){const r=this,{owner:n}=r,{items:s}=n,l=e instanceof k,o=s[t],a=n.items[e=l?s.indexOf(e):parseInt(e,10)],d=i?.animation!==!1,c=!(i!=null&&i.silent),h={prevActiveIndex:t,prevActiveItem:o};if(a&&!a.$isActivating&&a!==o){var g;const f=o&&o.element,m=a&&a.element;if(r.animateDetacher){const v=r.animateDetacher.event;if(v.activeItem===a)return v.promise;r.animateDetacher(),v.prevActiveItem.element.classList.remove(...$r),v.activeItem.element.classList.remove(...$r),r.animateDetacher=null}if(h.activeIndex=e,h.activeItem=a,c&&n.trigger("beforeActiveItemChange",h)===!1)return null;const p=r._activeIndex!==h.activeIndex;p&&(r._activeIndex=h.activeIndex),c&&((g=n.onBeginActiveItemChange)===null||g===void 0||g.call(n,h)),p&&(r._activeIndex=h.prevActiveIndex),d&&f&&n.isVisible&&r.animateCardChange?h.promise=r.cardChangeAnimation=new Promise((v,y)=>{const C=o.monitorResize;o.monitorResize=!1,r.contentElement.style.overflowX="hidden",o._hidden=!0,a.$isActivating=!0,a.show(),a.$isActivating=!1,f.classList.add(e>t?"b-slide-out-left":"b-slide-out-right"),m.classList.add(e<t?"b-slide-in-left":"b-slide-in-right"),n.isAnimating=!0,r.animateDetacher=A.onTransitionEnd({mode:"animation",element:m,thisObj:o,handler(){if(n.isAnimating=r.cardChangeAnimation=!1,!r.animateDetacher){r.setActiveItem(e,t,i);return}r.animateDetacher=null,m.classList.remove(...$r),f&&(f.classList.remove(...$r),o.$isDeactivating=!0,o._hidden=!1,o.hide(),o.monitorResize=C,o.$isDeactivating=!1),r.contentElement.style.overflowX="",r.onActiveItemChange(h,v,!c)}}),r.animateDetacher.reject=y,r.animateDetacher.event=h}):(a.$isActivating=!0,a.show(),a.focus(),a.$isActivating=!1,o&&(o.$isDeactivating=!0,o.hide(),o.$isDeactivating=!1),r.onActiveItemChange(h,null,!c))}return h}onActiveItemChange(e,t,i){const r=this;r._activeItem=e.activeItem,r._activeIndex=e.activeIndex,!i&&r.owner.trigger("activeItemChange",e),e.activeItem.focus(),t?.(e)}renderChildren(){const{owner:e}=this;e.contentElement.classList.toggle(this.hideChildHeaderCls,e.suppressChildHeaders),super.renderChildren()}changeActiveIndex(e){const{owner:t}=this;return t.isConfiguring&&!t._items?e:Math.min(e,t.items.length-1)}updateActiveIndex(e,t){this.owner.isConfiguring||this.setActiveItem(e,t)}updateActiveItem(e){this.owner.isConfiguring||this.setActiveItem(e,this.activeIndex)}get isChangingCard(){return Boolean(this.animateDetacher)}}T(ur,"$name","Card");T(ur,"type","card");T(ur,"configurable",{containerCls:"b-card-container",itemCls:"b-card-item",hideChildHeaderCls:"b-hide-child-headers",animateCardChange:!0,activeItem:null,activeIndex:null});ur.initClass();ur._$name="Card";class fc extends Ke{static get $name(){return"TabPanel"}static get type(){return"tabpanel"}static get alias(){return"tabs"}static get configurable(){return{activeTab:0,animateTabChange:!0,autoHeight:!1,defaultType:"container",focusable:!1,itemCls:"b-tabpanel-item",layout:{type:"card"},suppressChildHeaders:!0,tabBar:{type:"tabbar",weight:-2e3},tabMinWidth:null,tabMaxWidth:null}}get activeIndex(){return this.layout.activeIndex}get activeItem(){return this.layout.activeItem}get activeTabItemIndex(){var e;const{activeTab:t,items:i,tabBar:r}=this;return i.indexOf((e=r.tabs[t])===null||e===void 0?void 0:e.item)}get bodyConfig(){return x.merge({className:{"b-tabpanel-body":1}},super.bodyConfig)}get focusElement(){var e;const t=this.items[this.activeTab||0];return t?.focusElement||(t==null||(e=t.tab)===null||e===void 0?void 0:e.focusElement)}get tabPanelBody(){return this.bodyElement}finalizeInit(){super.finalizeInit();const e=this,{activeTab:t,layout:i}=e,{activeIndex:r}=i,{tabs:n}=e.tabBar,s=t>=0&&t<n.length&&e.items.indexOf(n[t].item);if(n.length>0&&(s===!1||s<0))throw new Error(`Invalid activeTab ${t} (${n.length} tabs)`);s!==r&&i.setActiveItem(s,r,{animation:!1,silent:!0}),i.animateCardChange=e.animateTabChange}onChildAdd(e){if(super.onChildAdd(e),!this.initialItems){const t=this,{tabBar:i}=t,r=t.makeTabConfig(e),n=r&&i?.firstTab,s=n&&i._items,l=n&&B.from(t._items,a=>a.tab||a===e),o=n?l.indexOf(e)+s.indexOf(n):0;r&&i&&(n&&e.weight==null&&o<s.count-1?i.insert(r,o):i.add(r))}}onChildRemove(e){const{tab:t}=e,{items:i}=this;t&&(this.tabBar.remove(t),t.destroy()),e===this.activeItem&&(this._activeTab=null,i.length&&(this.activeTab=i[Math.min(this.activeIndex,i.length-1)])),super.onChildRemove(e)}isDisabledOrHiddenTab(e){const{tabs:t}=this.tabBar,i=t?.[e];return i&&(i.disabled||i.hidden)}findAvailableTab(e,t=1){const{tabs:i}=this.tabBar,r=i.length,n=Math.max(0,i.indexOf(e.tab));n&&(t=-t);let s;for(let l=1;l<=r&&(s=(n+(t<0?r:0)+l*t)%r,!!this.isDisabledOrHiddenTab(s));++l);return s}activateAvailableTab(e,t=1){this.activeTab=this.findAvailableTab(e,t)}changeActiveTab(e,t){const i=this,{tabBar:r,layout:n}=i,{tabCount:s}=r;if(e.isWidget||x.isObject(e)?(i.items.indexOf(e)===-1&&(e=i.add(e)),e=r.indexOfTab(e.tab)):e=parseInt(e,10),!i.initialItems&&s>0&&(e<-1||e>=s))throw new Error(`Invalid activeTab ${e} (${s} tabs)`);if(i.isDisabledOrHiddenTab(e)&&(e=i.findAvailableTab(e)),n.animateCardChange&&n.cardChangeAnimation)n.cardChangeAnimation.then(l=>{l?.activeIndex!==e&&(i._activeTab=e,i.updateActiveTab(e,t))});else return e}async updateActiveTab(){if(!this.initialItems){const{activeTabItemIndex:t,layout:i}=this;if(t>-1){var e;i.animateCardChange&&await this.tabSelectionPromise,this.tabSelectionPromise=(e=i.setActiveItem(this.items[t]))===null||e===void 0?void 0:e.promise}}}changeTabBar(e){return this.getConfig("strips"),this.strips={tabBar:e},this.strips.tabBar}makeTabConfig(e){const{tab:t}=e,i={item:e,type:"tab",tabPanel:this,disabled:Boolean(e.disabled),hidden:e.initialConfig.hidden,weight:e.weight||0,internalListeners:{click:"onTabClick",thisObj:this},localizableProperties:{text:!1}};return t===!1?null:x.isObject(t)?rl.mergeConfigs(i,t):i}updateItems(e,t){const i=this,{activeTab:r,initialItems:n}=i;let s=0,l;super.updateItems(e,t),n&&(l=Array.from(e,o=>i.makeTabConfig(o)).filter(o=>{if(o)return o.index=s++,!0}),s&&(l[0].isFirst=!0,l[s-1].isLast=!0,l[r].active=!0,i.tabBar.add(l),i.activeTab=r))}updateTabMinWidth(e){var t;(t=this.tabBar)===null||t===void 0||t.items.forEach(i=>{i.isTab&&(i.minWidth=e)})}updateTabMaxWidth(e){var t;(t=this.tabBar)===null||t===void 0||t.items.forEach(i=>{i.isTab&&(i.maxWidth=e)})}updateAutoHeight(e){this.detachListeners("themeAutoHeight"),e&&te.ion({name:"themeAutoHeight",theme:"internalOnThemeChange",thisObj:this}),this.$measureHeight=e}applyAutoHeight(){const e=this,{layout:t,activeTab:i,element:r}=e,{animateCardChange:n}=t;t.animateCardChange=!1,e.height=null,e.height=Math.max(...e.items.map(s=>(e.activeTab=s,r.clientHeight)))+1,e.activeTab=i,t.animateCardChange=n,e.$measureHeight=!1}internalOnThemeChange(){this.isVisible?this.applyAutoHeight():this.$measureHeight=!0}onBeginActiveItemChange(e){const t=this.tabBar.tabs,{activeItem:i,prevActiveItem:r}=e;this.activeTab=t.indexOf(i?.tab),r!=null&&r.tab&&(r.tab.active=!1),i!=null&&i.tab&&(i.tab.active=!0,i.tab.show())}onBeforeActiveItemChange(e){return this.trigger("beforeTabChange",e)}onActiveItemChange(e){this.trigger("tabChange",e)}onTabClick(e){this.activeTab=e.source.item}onPaint(){super.onPaint(...arguments),this.$measureHeight&&this.applyAutoHeight()}}fc.initClass();fc._$name="TabPanel";class gc extends xe{static get $name(){return"TextAreaField"}static get type(){return"textareafield"}static get alias(){return"textarea"}static get configurable(){return{resize:"none",inputAttributes:{tag:"textarea"}}}updateResize(e){this.input.style.resize=e}}gc.initClass();gc._$name="TextAreaField";class mn extends ar{static get $name(){return"TextAreaPickerField"}static get type(){return"textareapickerfield"}static get configurable(){return{picker:{type:"widget",tag:"textarea",cls:"b-textareapickerfield-picker",scrollAction:"realign",align:{align:"t-b",axisLock:!0},autoShow:!1},triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},resize:"none",inputType:null}}startConfigure(e){typeof e.inline=="boolean"&&re.deprecate("Core","6.0.0","TextAreaPickerField.inline config is no longer supported"),super.startConfigure(e)}get inputElement(){const e=super.inputElement;return e.readOnly="readonly",e.reference="displayElement",this.ariaElement="displayElement",e}get focusElement(){var e;return(e=this._picker)!==null&&e!==void 0&&e.isVisible?this.input:this.displayElement}get needsInputSync(){var e;return this.displayElement[this.inputValueAttr]!==String((e=this.inputValue)!==null&&e!==void 0?e:"")}showPicker(){const e=this,{picker:t}=e;e.inline||(t.width=e.pickerWidth||e[e.pickerAlignElement].offsetWidth,super.showPicker(!0))}focusPicker(){this.input.focus()}onPickerKeyDown(e){const t=this,i=t.input;switch(e.key.trim()||e.code){case"Escape":t.picker.hide();return;case"Enter":e.ctrlKey&&(t.syncInputFieldValue(),t.picker.hide());break}t.input=t.displayElement;const r=super.onPickerKeyDown(e);return t.input=i,r}syncInputFieldValue(e){this.displayElement&&(this.displayElement.value=this.inputValue),super.syncInputFieldValue(e)}changeValue(e){return e??""}changePicker(e,t){var i,r;const n=this,s=n.pickerWidth||((i=e)===null||i===void 0?void 0:i.width);if(e=mn.reconfigure(t,e?N.merge({owner:n,forElement:n[n.pickerAlignElement],align:{matchSize:s==null,anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},id:n.id+"-input",style:{resize:n.resize},html:(r=n.value)!==null&&r!==void 0?r:""},e):null,n),e){const l=n.input=e.element;n.inputListenerRemover=A.on({element:l,thisObj:n,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput",keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}return e}}mn.initClass();mn._$name="TextAreaPickerField";const ii="http://www.w3.org/2000/svg",Mm={bar:1,outline:2,text:3},Im=(u,e)=>parseInt(u.dataset.order,10)-parseInt(e.dataset.order,10),Fm=u=>u.field,km=()=>!1;class mc extends k{static get type(){return"histogram"}static get $name(){return"Histogram"}static get defaultConfig(){return{data:null,values:null,series:null,topValue:null,element:{children:[{ns:ii,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:ii,tag:"g",reference:"scaledSvgGroup"},{ns:ii,tag:"g",reference:"unscaledSvgGroup"}]}]},omitZeroHeightBars:null,monitorResize:!0,getRectClass:null,getBarTip:null,getBarText:null,getBarTextRenderData:null,getBarTextTip:null}}construct(e){super.construct(e),this.scheduleRefresh=this.createOnFrame(this.refresh,[],this,!0),this.refresh()}set tip(e){var t;const i=this;(t=i.tip)===null||t===void 0||t.destroy(),e?i._tip=me.new({owner:i,forElement:i.svgElement,forSelector:"rect",internalListeners:{beforeShow:"up.onBeforeTipShow"}},e):i._tip=null}onElementResize(){super.onElementResize(...arguments);const e=this.svgElement.getBoundingClientRect();this.scaledSvgGroup.setAttribute("transform",`scale(${e.width} ${e.height})`)}onBeforeTipShow({source:e}){const t=parseInt(e.activeTarget.dataset.index);e.html=e.contentTemplate({histogram:this,index:t})}set series(e){const t=this,i=t._series={};for(const r in e)if(e[r]!==!1){const n=i[r]=Object.assign({},e[r]);!n.type&&e[r].type&&(n.type=e[r].type),!n.field&&e[r].field&&(n.field=e[r].field),"order"in i||(n.order=Mm[n.type]),n.id=r}t.scheduleRefresh()}get series(){return this._series}set data(e){const t=this;if(t._data=e,!t.topValue){const i=Object.values(t.series).map(Fm);for(let r=0,{length:n}=e;r<n;r++)for(let s=0,{length:l}=i;s<l;s++)t.topValue=Math.max(t.topValue||0,e[r][i[s]])}t.scheduleRefresh()}get data(){return this._data}set topValue(e){this._topValue=e,this.scheduleRefresh()}get topValue(){return this._topValue}scheduleRefresh(){}refresh(){const e=this,{series:t,_tip:i}=e,r=[];for(const n in t){const s=t[n],l=e[`draw${_.capitalize(s.type)}`](s);Array.isArray(l)?r.push.apply(r,l):r.push(l)}r.sort(Im),J.syncChildren({domConfig:{children:r},configEquality:km},e.scaledSvgGroup),J.syncChildren({domConfig:{children:e.drawText()}},e.unscaledSvgGroup),i&&i.isVisible&&e.onBeforeTipShow({source:i})}drawBar(e){const t=this,{topValue:i,data:r,omitZeroHeightBars:n,barStyle:s}=t,{field:l,order:o}=e,a=1/r.length,d=[];let c;for(let h=0,g=0,{length:f}=r;h<f;h++,g+=c){const m=r[h],p=m[l],v=m.height||(p>i?i:p)/i,y=1-v,C=m.rectConfig={ns:ii,tag:"rect",dataset:{}},w=t.callback("getBarTip",t,[e,C,m,h]);c=m.width||a,s?C.style=s:delete C.style,Object.assign(C.dataset,{index:h,order:o}),Object.assign(C,{x:g,y,width:c,height:v,class:t.callback("getRectClass",t,[e,C,m,h])}),w?C.dataset.btip=w:delete C.dataset.btip,(v||!n)&&d.push(C)}return d}drawOutline(e){const t=this,{topValue:i,data:r}=t,{field:n,order:s}=e,l=1/r.length,o=["M 0,1"],a=e.outlineElement||(e.outlineElement={ns:ii,tag:"path",dataset:{order:s}});let d,c="M",h="L";for(let g=0,f=0,{length:m}=r;g<m;g++){const p=1-r[g][n]/i;d=r[g].width||l,o.push(`${c} ${f},${p} ${h} ${f+=d},${p}`),c=h=""}return a.d=o.join(" "),a}drawText(){const e=this,{data:t}=e,i=1/t.length,r="100%",n=[];for(let s=0,l,o=0,{length:a}=t;s<a;s++,o+=l){l=t[s].width||i;const d=e.callback("getBarText",e,[t[s],s]);if(d){const c=e.callback("getBarTextRenderData",e,[{ns:ii,tag:"text",className:"b-bar-legend",html:d,x:`${(o+l/2)*100}%`,y:t[s].y!==void 0?t[s].y:r,dataset:{index:s}},t[s],s]),h=e.callback("getBarTextTip",e,[c,t[s],s]);h?c.dataset.btip=h:delete c.dataset.btip,n.push(c)}}return n}getBarText(e,t){return""}getBarTextRenderData(e,t,i){return e}getBarTip(e,t,i,r){}getBarTextTip(e,t,i){}getRectClass(e,t,i,r){return""}}mc.initClass();mc._$name="Histogram";const Hi="http://www.w3.org/2000/svg";class pc extends k{static get type(){return"scale"}static get $name(){return"Scale"}static get configurable(){return{scalePoints:null,scaleMaxPadding:.1,horizontal:!1,align:{value:!1,$config:{merge:"replace"}},element:{children:[{ns:Hi,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:Hi,tag:"g",reference:"scaledSvgGroup",children:[{ns:Hi,tag:"path",reference:"pathElement"}]},{ns:Hi,tag:"g",reference:"unscaledSvgGroup"}]}]},monitorResize:!0}}construct(e){super.construct(e),this.scheduleRefresh=this.createOnFrame(this.refresh,[],this,!0),this.refresh()}changeAlign(e){return e||(e=this.horizontal?"bottom":"right"),e}updateAlign(e,t){this.element.classList.remove(`b-align-${t}`),this.element.classList.add(`b-align-${e}`)}updateHorizontal(e,t){this.element.classList.remove(`b-scale-${t?"horizontal":"vertical"}`),this.element.classList.add(`b-scale-${e?"horizontal":"vertical"}`)}onElementResize(){super.onElementResize(...arguments),this.scheduleRefresh()}scheduleRefresh(){}refresh(){const e=this,{horizontal:t,width:i,height:r,align:n,scalePoints:s,scaleMaxPadding:l}=e,o=s[s.length-1].value,a=[],d=[],c=1/(o+l*o);e.scaledSvgGroup.setAttribute("transform",`scale(${t?i:1} ${t?1:r})`);for(const h of s){const g=Boolean(h.text),f=c*h.value;if(g){const m={ns:Hi,tag:"text",className:"b-scale-tick-label",html:h.text,dataset:{tick:h.value}};t?(m.x=`${f*100}%`,m.y=n==="top"?"1.6em":r-12):(m.x=n==="left"?"12":`${i-12}`,m.y=`${(1-f)*100}%`),d.push(m)}t?n==="top"?a.push(`M${f},0 L${f},${g?10:5}`):a.push(`M${f},${r} L${f},${r-(g?10:5)}`):n==="left"?a.push(`M0,${1-f} L${g?10:5},${1-f}`):a.push(`M${i},${1-f} L${i-(g?10:5)},${1-f}`)}e.pathElement.setAttribute("d",a.join("")),J.syncChildren({domConfig:{children:d}},e.unscaledSvgGroup)}}pc.initClass();pc._$name="Scale";class nn extends ${static get $name(){return"AvatarRendering"}static get configurable(){return{element:null,colorPrefix:"b-sch-",tooltip:null,size:null}}doDestroy(){var e;(e=this.tooltip)===null||e===void 0||e.destroy(),super.doDestroy()}updateElement(e){A.on({element:e,delegate:".b-resource-image",error:"onImageErrorEvent",thisObj:this,capture:!0})}changeTooltip(e){return me.new({forElement:this.element,forSelector:".b-resource-avatar",cls:"b-resource-avatar-tooltip"},e)}static get failedUrls(){return this._failedUrls||(this._failedUrls=new Set),this._failedUrls}getResourceAvatar({initials:e,color:t,iconCls:i,imageUrl:r,defaultImageUrl:n,dataset:s={},resourceRecord:l,alt:o=_.encodeHtml(l?.name)}){return this.getImageConfig(e,t,r,n,s,o)||this.getIconConfig(i,s)||this.getResourceInitialsConfig(e,t,s)}getImageConfig(e,t,i,r,n,s){const{size:l}=this;if(i=nn.failedUrls.has(i)?r:i||r,i)return F(F({tag:"img",draggable:"false",loading:"lazy",class:{"b-resource-avatar":1,"b-resource-image":1}},l?{style:{height:l+"px",width:l+"px"}}:void 0),{},{alt:s,elementData:{defaultImageUrl:r,imageUrl:i,initials:e,color:t,dataset:n},src:i,dataset:n})}getIconConfig(e,t){if(e)return e&&{tag:"i",class:{"b-resource-avatar":1,"b-resource-icon":1,[e]:1},dataset:t}}getResourceInitialsConfig(e,t,i){const{size:r}=this,n=b.isNamedColor(t)&&t,s=!n&&t;return{tag:"div",class:{"b-resource-avatar":1,"b-resource-initials":1,[`${this.colorPrefix}${n}`]:n},style:F({backgroundColor:s||null},r?{height:r+"px",width:r+"px"}:void 0),children:[e],dataset:i}}onImageErrorEvent({target:e}){if(!e.matches(".b-resource-avatar"))return;const{defaultImageUrl:t,initials:i,color:r,imageUrl:n,dataset:s}=e.elementData;if(t&&!e.src.endsWith(t.replace(/^[./]*/gm,"")))e.src=t;else{const l=b.createElement(this.getResourceInitialsConfig(i,r,s));l.elementData=e.elementData,e.parentElement.replaceChild(l,e)}nn.failedUrls.add(n)}}nn._$name="AvatarRendering";window&&!window.bryntum&&(window.bryntum={});class K{constructor(e){if(e){if(e.isLocation)return e;if(e.nodeType===Node.ELEMENT_NODE){const t=k.fromElement(e,"gridbase"),i=t&&e.closest(t.focusableSelector);if(i){const{dataset:r}=i.parentNode;this.init({grid:t,rowIndex:t.store.includes(r.id)?t.store.indexOf(r.id):r.index||-1,columnId:i.dataset.columnId}),this.initialTarget=e}}else this.init(e)}}init(e){var t;const i=this,r=i.grid=e.grid,{store:n,columns:s}=r,{visibleColumns:l}=s;if(e.target&&(i.actionTargets=[i._target=e.target]),e.record)i._id=e.record.id;else if("id"in e)i._id=e.id,e.id==null&&(i._rowIndex=-1);else{var o;const a=isNaN(e.row)?isNaN(e.rowIndex)?NaN:e.rowIndex:e.row;i._rowIndex=Math.max(Math.min(Number(a),n.count-1),r.hideHeaders?0:-1),i._id=(o=n.getAt(i._rowIndex))===null||o===void 0?void 0:o.id}if("_rowIndex"in i||(i._rowIndex=n.indexOf(i.id)),i.isSpecialRow=(t=i.record)===null||t===void 0?void 0:t.isSpecialRow,"columnId"in e)i._column=s.getById(e.columnId);else if("field"in e)i._column=s.get(e.field);else{const a=isNaN(e.column)?isNaN(e.columnIndex)?NaN:e.columnIndex:e.column;isNaN(a)?i._column="column"in e?isNaN(e.column)?e.column:l[e.column]:l[0]:(i._columnIndex=Math.min(Number(a),l.length-1),i._column=l[i._columnIndex])}"_columnIndex"in i||(i._columnIndex=l.indexOf(i._column))}get isLocation(){return!0}equals(e,t=!1){const i=this;return e?.isLocation&&e.grid===i.grid&&(t?i.id===e.id&&i._column===e._column:e.record===i.record&&e.column===i.column&&e.target===i.target)}get rowIndex(){const{_id:e}=this,{store:t}=this.grid;return t.includes(e)?t.indexOf(e):Math.min(this._rowIndex,t.count-1)}get visibleRowIndex(){const{rowManager:e}=this.grid,{rowIndex:t}=this;return t===-1?t:Math.max(Math.min(t,e.lastFullyVisibleTow.dataIndex),e.firstFullyVisibleTow.dataIndex)}get isSelectable(){return this.grid.store.includes(this._id)&&!this.isSpecialRow}get record(){if(this._rowIndex>-1){const{store:e}=this.grid;return e.includes(this._id)?e.getById(this._id):e.getAt(this._rowIndex)}}get id(){return this._id}get column(){const{visibleColumns:e}=this.grid.columns;return e!=null&&e.includes(this._column)?this._column:e?.[this.columnIndex]}get columnId(){var e;return(e=this.column)===null||e===void 0?void 0:e.id}get columnIndex(){var e;return Math.min(this._columnIndex,((e=this.grid.columns.visibleColumns)===null||e===void 0?void 0:e.length)-1)}move(e){const t=this,{record:i,column:r,grid:n}=t,{store:s}=n,l=n.columns.visibleColumns,o=new K;let a=s.includes(i)?s.indexOf(i):t.rowIndex,d=l.includes(r)?l.indexOf(r):t.columnIndex;const c=n.hideHeaders?0:-1,h=s.count-1,g=l.length-1,f=a===c,m=a===h,p=d===0,v=d===g;switch(e){case K.PREV_CELL:p?f||(d=g,a--):d--;break;case K.NEXT_CELL:v?m||(d=0,a++):d++;break;case K.UP:f||a--;break;case K.DOWN:m||(a===-1?a=n.rowManager.firstFullyVisibleRow.dataIndex:a++);break;case K.FIRST_COLUMN:d=0;break;case K.LAST_COLUMN:d=g;break;case K.FIRST_CELL:a=c,d=0;break;case K.LAST_CELL:a=h,d=g;break;case K.PREV_PAGE:a=Math.max(c,a-Math.floor(n.scrollable.clientHeight/n.rowHeight));break;case K.NEXT_PAGE:a=Math.min(h,a+Math.floor(n.scrollable.clientHeight/n.rowHeight));break}return o.init({grid:n,rowIndex:a,columnIndex:d}),o}get cell(){const e=this,{grid:t,id:i,_cell:r}=e;if(r)return r;if(i==null){var n;return(n=t.columns.getById(e.columnId))===null||n===void 0?void 0:n.element}else{const{row:l}=e;if(l){var s;return l.getCell(e.columnId)||l.getCell((s=t.columns.getAt(e.columnIndex))===null||s===void 0?void 0:s.id)}}}get row(){return this.grid.getRowById(this.id)||this.grid.getRow(this.rowIndex)}get target(){const{cell:e,_target:t}=this,{focusableFinder:i}=this.grid;if(e)return t||(i.currentNode=this.grid.focusableFinderCell=e,i.nextNode()||e)}get isActionable(){const{cell:e,_target:t}=this,i=e?.compareDocumentPosition(b.getActiveElement(e))&Node.DOCUMENT_POSITION_CONTAINED_BY;return Boolean(i||t&&t!==this.cell)}get isColumnHeader(){return this.cell&&this.rowIndex===-1}get isCell(){return this.cell&&this.record}}K.UP=1;K.NEXT_CELL=2;K.DOWN=3;K.PREV_CELL=4;K.FIRST_COLUMN=5;K.LAST_COLUMN=6;K.FIRST_CELL=7;K.LAST_CELL=8;K.PREV_PAGE=9;K.NEXT_PAGE=10;K._$name="Location";const Va=u=>typeof u=="number"||u?.endsWith("px");class se extends fe.mixin(Me,zt){static get $name(){return"Column"}static get type(){return"column"}static get fields(){return["type","text","field","renderer","width","flex","autoWidth","autoHeight",{name:"fitMode",defaultValue:"exact"},{name:"editor",defaultValue:{}},"cellEditor","finalizeCellEdit",{name:"revertOnEscape",defaultValue:!0},{name:"invalidAction",defaultValue:"block"},{name:"sortable",defaultValue:!0,convert(e,t){if(!e)return!1;if(e===!0)return!0;const i={};return typeof e=="function"?(i.originalSortFn=e,i.sortFn=e.bind(t)):typeof e=="object"&&(Object.assign(i,e),i.fn&&(i.sortFn=i.fn,delete i.fn)),i}},{name:"searchable",defaultValue:!0},{name:"collapsible",defaultValue:!1},{name:"collapsed",defaultValue:!1},{name:"collapseMode"},{name:"filterable",defaultValue:!0,convert(e){if(!e)return!1;if(e===!0)return!0;const t={columnOwned:!0};return typeof e=="function"?t.filterFn=e:typeof e=="object"&&Object.assign(t,e),t}},{name:"sealed"},{name:"hideable",defaultValue:!0},{name:"draggable",defaultValue:!0},{name:"groupable",defaultValue:!0},{name:"resizable",defaultValue:!0},"groupRenderer","headerRenderer","tooltip","tooltipRenderer","cellCls","cls","icon","align",{name:"minWidth",defaultValue:60},"maxWidth",{name:"hidden",defaultValue:!1},{name:"locked"},{name:"region"},{name:"mergeCells",type:"boolean"},{name:"mergeable",type:"boolean",defaultValue:!0},"mergedRenderer",{name:"showColumnPicker",defaultValue:!0},{name:"enableHeaderContextMenu",defaultValue:!0},{name:"enableCellContextMenu",defaultValue:!0},"headerMenuItems","cellMenuItems","sum","summaries","summaryRenderer","responsiveLevels","tags","touchConfig","tree","filterType",{name:"htmlEncode",defaultValue:!0},{name:"htmlEncodeHeaderText",defaultValue:!0},{name:"autoSyncHtml",defaultValue:!1},{name:"alwaysClearCell",defaultValue:!1},{name:"headerWidgets"},{name:"instantUpdate",defaultValue:!1},{name:"repaintOnResize",defaultValue:!1},"editTargetSelector",{name:"exportable",defaultValue:!0},{name:"exportedType"},{name:"ariaLabel",defaultValue:"L{Column.columnLabel}"},{name:"cellAriaLabel",defaultValue:"L{cellLabel}"}]}static get autoExposeFields(){return!1}construct(e,t){var i;const r=this;r.masterStore=t,t&&(r._grid=Array.isArray(t)?t[0].grid:t.grid),r.localizableProperties=de.mergeMethods.distinct(e.localizableProperties,["text","ariaLabel","cellAriaLabel"]),e.localeClass&&(r.localeClass=e.localeClass),super.construct(...arguments),r.isLeaf&&!("field"in r.data)&&(r.field="_"+(r.type||"")+ ++se.emptyCount,r.noFieldSpecified=!0),r.hasComplexMapping=(i=r.field)===null||i===void 0?void 0:i.includes("."),!r.width&&!r.flex&&!r.children&&r.set({width:se.defaultWidth,flex:null},null,!0),r.headerWidgets&&r.initHeaderWidgets(r.headerWidgets),r.isParent&&(r.meta.visibleChildren=new Set,r.collapsible&&(r.collapsible=!0))}get isCollapsible(){var e;return((e=this.children)===null||e===void 0?void 0:e.length)>1&&this.collapsible}get collapsed(){return this.get("collapsed")}set collapsed(e){this.set("collapsed",e,!0),this.onCollapseChange(!e),this.trigger("toggleCollapse",{collapsed:e})}onCellFocus(e){this.location=e,this.updateHeaderAriaLabel(this.localizeProperty("ariaLabel")),e.rowIndex!==-1&&this.updateCellAriaLabel(this.localizeProperty("cellAriaLabel"))}updateHeaderAriaLabel(e){b.setAttributes(this.element,{"aria-label":e})}updateCellAriaLabel(e){var t,i;if(!((t=this.location)!==null&&t!==void 0&&t.isSpecialRow)&&(i=this.location)!==null&&i!==void 0&&i.cell){var r;(r=e)!==null&&r!==void 0&&r.length||(e=this.location.column.text),b.setAttributes(this.location.cell,{"aria-label":e})}}doDestroy(){var e,t,i;(e=this.data)===null||e===void 0||(t=e.editor)===null||t===void 0||(i=t.destroy)===null||i===void 0||i.call(t),this.destroyHeaderWidgets(),super.doDestroy()}set headerWidgets(e){this.initHeaderWidgets(e),this.set("headerWidgets",e)}get headerWidgets(){return this.get("headerWidgets")}initHeaderWidgets(e){this.destroyHeaderWidgets();const t=this.headerWidgetMap={};for(const i of e){const r=k.create(F({owner:this},i));t[r.ref||r.id]=r}}destroyHeaderWidgets(){for(const t of Object.values(this.headerWidgetMap||{})){var e;(e=t.destroy)===null||e===void 0||e.call(t)}}static generateAutoCls(){let e="";for(let t=this;t!==se;t=t.superclass)t.type&&(e+=`b-${t.type.toLowerCase()}-cell `);return(se.autoClsMap||(se.autoClsMap=new Map)).set(this,e),e}getCellClass(e){var t,i;const{record:r,column:n}=e,{cellCls:s,internalCellCls:l,grid:o,constructor:a,align:d}=n,c=((t=se.autoClsMap)===null||t===void 0?void 0:t.get(a))||a.generateAutoCls(),h=e.cell.classList.contains("b-editing"),g={[o.cellCls]:o.cellCls,[c]:c,[s]:s,[l]:l,"b-cell-dirty":r.isFieldModified(n.field)&&(n.compositeField||((i=r.fieldMap[n.field])===null||i===void 0?void 0:i.persist)!==!1),[`b-grid-cell-align-${d}`]:d,"b-selected":o.selectionMode.cell&&o.isCellSelected(e),"b-focused":o.isFocused(e),"b-auto-height":n.autoHeight,"b-editing":h};return r.isSpecialRow&&g["b-checkbox-selection"]&&(g["b-checkbox-selection"]=!1),g}get locked(){return this.data.region==="locked"}set locked(e){this.region=e?"locked":"normal"}get region(){return this.parent.isRoot?this.get("region"):this.parent.region}set region(e){this.set("region",e)}get sortable(){return this.isLeaf&&this.data.sortable}set sortable(e){this.set("sortable",e)}get groupable(){return this.isLeaf&&this.data.groupable}set groupable(e){this.set("groupable",e)}get editor(){const e=this;let{editor:t}=e.data;if(t&&!t.isWidget){const i=e.grid.processCellEditor({editor:t,field:e.field});i?t=e.data.editor=i.editor:(typeof t=="string"&&(t={type:t}),t=e.data.editor=k.create(x.merge(e.defaultEditor,{owner:e.grid,label:_.encodeHtml(e.text)},t)))}return t}set editor(e){this.data.editor=e}get defaultEditor(){return{type:"textfield",name:this.field}}getFilterableValue(e){return this.getRawValue(e)}get owner(){return this._owner||this.subGrid}set owner(e){this._owner=e}get grid(){var e;return this._grid||((e=this.parent)===null||e===void 0?void 0:e.grid)}set subGrid(e){this._subGrid=e}get subGrid(){var e;return this._subGrid||((e=this.grid)===null||e===void 0?void 0:e.getSubGridFromColumn(this))}get subGridElement(){return this.subGrid.element}get element(){return this.grid.getHeaderElement(this)}get nextVisibleSibling(){const e=this.region;let t=this.nextSibling;for(;t&&(t.hidden||t.region!==e);)t=t.nextSibling;return t}get isLastInSubGrid(){return!this.nextVisibleSibling&&(this.parent.isRoot||this.parent.isLastInSubGrid)}get textWrapper(){return b.getChild(this.element,".b-grid-header-text")}get textElement(){return b.down(this.element,".b-grid-header-text-content")}get contentElement(){return b.down(this.element,".b-grid-header-children")}get isSorted(){return this.grid.store.sorters.some(e=>e.field===this.field)}get isFocusable(){return this.isLeaf}static get text(){return this.$meta.fields.defaults.text}get headerText(){return this.htmlEncodeHeaderText?_.encodeHtml(this.text):this.text}get isVisible(){return!this.hidden&&(!this.parent||this.parent.isVisible)}hide(e=!1,t=!1){const i=this,{parent:r}=i;i.hidden||(i.hidden=!0,r&&!r.isRoot&&!r.isTogglingAll&&!r.children.some(s=>s.hidden!==!0)&&!r.hidden&&(e=!0,r.hide()),i.isParent?i.children.forEach(n=>n.hide(!0,!0)):r.isRoot||r.meta.visibleChildren[t?"add":"delete"](i),e||i.stores.forEach(n=>n.trigger("columnHide",{column:i})))}show(e=!1){const t=this,{parent:i}=t;if(t.hidden){if(t.hidden=!1,i!=null&&i.hidden&&i.show(),t.isParent){var r;(r=t.meta.visibleChildren)===null||r===void 0||r.forEach(n=>n.show(!0))}e||t.stores.forEach(n=>n.trigger("columnShow",{column:t}))}}toggle(e){if(this.hidden&&e===void 0||e===!0)return this.show();if(!this.hidden&&e===void 0||e===!1)return this.hide()}toggleChildren(e=this.children,t=void 0){var i,r;const n=this;(i=n.grid.columns)===null||i===void 0||i.beginBatch(),n.isTogglingAll=!0,e.forEach(s=>s.toggle(t)),n.isTogglingAll=!1,(r=n.grid.columns)===null||r===void 0||r.endBatch()}onCollapseChange(e=void 0){const t=this;if(t.collapseMode==="toggleAll")t.toggleChildren();else{var i,r;const{firstChild:n}=t;n.flex!=null&&t.collapsed?(n.oldFlex=n.flex,n.width=n.element.offsetWidth):!t.collapsed&&n.oldFlex&&(n.flex=n.oldFlex,n.oldFlex=null),(i=t.grid.columns)===null||i===void 0||i.beginBatch(),t.isTogglingAll=!0,t.children.slice(1).forEach(s=>s.toggle(e)),t.isTogglingAll=!1,(r=t.grid.columns)===null||r===void 0||r.endBatch()}}set collapsible(e){const t=this;if(t.set("collapsible",e),t.isParent){const{headerWidgets:i=[]}=t;if(e)i.push({type:"button",ref:"collapseExpand",toggleable:!0,pressed:t.collapsed,icon:`b-icon-collapse-${t.grid.rtl?"right":"left"}`,pressedIcon:`b-icon-collapse-${t.grid.rtl?"left":"right"}`,cls:"b-grid-header-collapse-button b-transparent",onToggle:({pressed:r})=>t.collapsed=r});else{const r=i.findIndex(n=>n.ref==="collapseExpand");r>-1&&i.splice(r,1)}t.headerWidgets=i,t.collapsed&&t.onCollapseChange(!1)}}get collapsible(){return this.get("collapsible")}generateId(){return se.generatedIdIndex||(se.generatedIdIndex=0),(this.field?this.field.replace(/\./g,"-"):"col")+ ++se.generatedIdIndex}get allIndex(){return this.masterStore.indexOf(this)}measureSize(e){var t;return b.measureSize(e,(t=this.subGrid)===null||t===void 0?void 0:t.element)}get calcMinWidth(){const{width:e,minWidth:t}=this.data;return Va(e)&&Va(t)?Math.max(parseInt(e)||0,parseInt(t)||0):e}get width(){return this.data.width}set width(e){const t={width:e};e&&"flex"in this.data&&(t.flex=null),this.set(t)}set flex(e){const t={flex:e};e&&"width"in this.data&&(t.width=null),this.set(t)}get flex(){return this.data.flex}calculateMinWidth(){const e=this,t=e.measureSize(e.width),i=e.measureSize(e.minWidth);let r=0;return e.children&&(r=e.children.reduce((n,s)=>n+s.calculateMinWidth(),0)),Math.max(t,i,r)}resizeToFitContent(e,t,i=!1){const r=this,{grid:n,element:s,fitMode:l}=r,{rowManager:o,store:a}=n,{count:d}=a;if(d<=0||r.fitMode==="none"||!r.fitMode)return;const[c]=o.rows,{rowElement:h,cellElement:g}=n.beginGridMeasuring(),f=new K({grid:n,column:r,id:null});let m=0,p,v,y,C,w,S,D={length:0,record:null};if(g._domData={columnId:r.id,row:c,rowElement:h},f._cell=g,f.updatingSingleRow=!0,f.isMeasuring=!0,g.innerHTML="",n.resizeToFitIncludesHeader){if(!n.$headerPadding){const R=globalThis.getComputedStyle(s);n.$headerPadding=parseInt(R.paddingLeft)}const I=s.querySelector(".b-grid-header-text-content");I.style.cssText="flex: none; width: auto",m=I.offsetWidth+n.$headerPadding*2+2,I.style.cssText=""}for(d>1e3?(p=Math.max(Math.min(o.topIndex+Math.round(o.rowCount/2)-500,d-1e3),0),v=p+1e3):(p=0,v=d),y=p;y<v;y++){if(C=a.getAt(y),w=r.getRawValue(C),l==="value")S=String(w).length;else if(f._record=D.record,f._id=C.id,f._rowIndex=y,c.renderCell(f),l==="textContent")S=g.textContent.length;else{const I=g.offsetWidth;I>m&&(m=I)}S>D.length&&(D={record:C,length:S,rowIndex:y})}return D.length>0&&(l==="value"||l==="textContent")&&(f._record=D.record,f._id=D.record.id,f._rowIndex=D.rowIndex,c.renderCell(f),m=Math.max(m,g.offsetWidth)),Array.isArray(e)&&([e,t]=e),m=Math.max(m,e||0),m=Math.min(m,t||1e6),i||n.endGridMeasuring(),r.width=r.maxWidth?m=Math.min(m,r.maxWidth):m,m}getState(){const e=this,t={id:e.id,hidden:e.hidden,region:e.region,locked:e.locked};return e.children||(t[e.flex?"flex":"width"]=e.flex||e.width),e.isCollapsible&&(t.collapsed=e.collapsed),t}applyState(e){const t=this;t.beginBatch(),"locked"in e&&(t.locked=e.locked),"width"in e&&(t.width=e.width),"flex"in e&&(t.flex=e.flex),"width"in e&&t.flex?t.flex=void 0:"flex"in e&&t.width&&(t.width=void 0),"region"in e&&(t.region=e.region),t.endBatch(),"hidden"in e&&t.toggle(e.hidden!==!0),"collapsed"in e&&(t.collapsed=e.collapsed)}remove(){const{subGrid:e,grid:t}=this,i=e&&t?.focusedCell;i?.columnId===this.id&&(t.owns(b.getActiveElement(t))?t.navigateRight():t._focusedCell=new K({grid:t,rowIndex:i.rowIndex,column:e.columns.getAdjacentVisibleLeafColumn(this.id,!0,!0)})),super.remove()}getRawValue(e){return this.hasComplexMapping?x.getPath(e,this.field):e[this.field]}refreshCell(e){this.grid.rowManager.refreshCell(e,this.id)}clearCell(e){e.innerHTML="",delete e._content}canEdit(e){if(e.isEditable){const t=e.isEditable(this.field);if(t!==void 0)return t}return!0}insertChild(e,t=null,i=!1){return e=Array.isArray(e)?e:[e],e.forEach(r=>{const{parent:n}=r;n!=null&&n.collapsed&&r===n.firstChild&&n.children.length>1&&n.children.filter(s=>!s.hidden).length===1&&(r.nextSibling.hidden=!1)}),this.sealed&&!this.inProcessChildren?null:super.insertChild(...arguments)}canFillValue(){return!0}getCurrentConfig(e){var t;const i=super.getCurrentConfig(e);return(t=this.sortable)!==null&&t!==void 0&&t.originalSortFn&&(i.sortable=this.sortable.originalSortFn),i.renderer===this.internalRenderer&&delete i.renderer,i.headerRenderer===this.internalHeaderRenderer&&delete i.headerRenderer,delete i.ariaLabel,delete i.cellAriaLabel,i}}se.emptyCount=0;se.defaultWidth=100;se.exposeProperties();se._$name="Column";const Lm={boolean:{type:"check"},date:{type:"date"},integer:{type:"number",format:{maximumFractionDigits:0}},number:{type:"number"}},Pm=[{field:"region"}];class Ce extends zt(ue){static get defaultConfig(){return{modelClass:se,tree:!0,autoAddField:!1,sorters:Pm}}construct(e){const t=this;e.grid&&(e.grid._columnStore=t,t.id=`${e.grid.id}-columns`,e.grid.ion({subGridCollapse:"clearSubGridCaches",subGridExpand:"clearSubGridCaches",thisObj:t})),super.construct(e),t.ion({change:t.onStoreChange,sort:()=>t.updateChainedStores(),thisObj:t,prio:1})}get modelClass(){return this._modelClass}set modelClass(e){this._modelClass=e}doDestroy(){const e=[];this.isChained||this.traverse(t=>e.push(t)),super.doDestroy(),this.isChained||e.forEach(t=>t.destroy())}getById(e){return super.getById(e)||this.idRegister[e]}forEach(e,t=this){this.traverseWhile((i,r)=>e.call(t,i,r),!0)}get totalFixedWidth(){let e=0;for(const t of this)t.hidden||(t.children?t.children.forEach(i=>e+=this.calculateFixedWidth(i)):e+=this.calculateFixedWidth(t));return e}get hasFlex(){return this.visibleColumns.some(e=>e.flex)}calculateFixedWidth(e){return e.flex?e.measureSize(se.defaultWidth):Math.max(e.measureSize(e.width),e.measureSize(e.minWidth))}get topColumns(){return this.isChained?this.masterStore.rootNode.children.filter(this.chainedFilterFn):this.rootNode.children}get visibleColumns(){const e=this;return e._visibleColumns||(e._visibleColumns=e.leaves.filter(t=>t.isVisible&&(!t.subGrid||!t.subGrid.collapsed))),e._visibleColumns}onStoreChange({action:e,changes:t}){e==="update"&&!("hidden"in t)||this.clearCaches()}clearSubGridCaches({subGrid:e}){e.columns.clearCaches(),this.clearCaches()}clearCaches(){var e;this._visibleColumns=null,(e=this.masterStore)===null||e===void 0||e.clearCaches()}onMasterDataChanged(e){super.onMasterDataChanged(e),(e.action!=="update"||"hidden"in e.changes)&&this.clearCaches()}getAdjacentVisibleLeafColumn(e,t=!0,i=!1){const r=this.visibleColumns,n=e instanceof se?e:this.getById(e);let s=r.indexOf(n)+(t?1:-1);if(!r[s])if(i)s=t?0:r.length-1;else return null;return r[s]}get bottomColumns(){return this.leaves}get(e){return this.findRecord("field",e,!0)}createRecord(e){var t,i;const{grid:r={}}=this,{store:n}=r,s=n==null||(t=n.modelClass)===null||t===void 0||(i=t.fieldMap)===null||i===void 0?void 0:i[e.field];let l=this.modelClass;if(s!=null&&s.column&&(e=N.merge({},s.column,e)),e.type&&(l=Ce.getColumnClass(e.type),!l))throw new Error(`Column type '${e.type}' not registered`);e.locked&&(e.region="locked",delete e.locked);const o=new l(e,this);if(o.data.region||(o.data.region=r.defaultRegion||"normal"),this.autoAddField&&!o.noFieldSpecified&&n&&!s){let a=o.field;o.constructor.fieldType&&(a={name:o.field,type:o.constructor.fieldType}),n.modelClass.addField(a)}return o}indexOf(e){if(e==null)return-1;const t=super.indexOf(e);return t>-1?t:this.records.findIndex(i=>i.field===e)}get usesAutoHeight(){return this.find(e=>e.autoHeight)}get usesFlexAutoHeight(){return this.find(e=>e.autoHeight&&e.flex!=null)}static registerColumnType(e,t=!1){e.simpleRenderer=t,(Ce.columnTypes||(Ce.columnTypes={}))[e.type]=e}static getColumnClass(e){return Ce.columnTypes&&Ce.columnTypes[e]}generateColumnForField(e,t){if(typeof e=="string"&&this.grid){var i;e=(i=this.grid.store)===null||i===void 0?void 0:i.modelClass.fieldMap[e]}let r=e.column||Lm[e.type]||{};return typeof r=="string"&&(r={type:r}),r=Object.assign({text:e.text||_.separate(e.name),field:e.name},t,r),e.precision!=null&&(r.format.maximumFractionDigits=e.precision),e.columnType&&(r.type=e.columnType),this.createRecord(r)}}const Om=(u,e)=>({update:({store:t,record:i,changes:r})=>{let n=!0;return("width"in r||"minWidth"in r||"maxWidth"in r||"flex"in r)&&(n=u.call(e,{store:t,record:i,changes:r})),n}});Ce.registerColumnType(se,!0);Ce._$name="ColumnStore";class yi extends se{get groupHeaderReserved(){return!0}construct(e,t){const i=this;super.construct(...arguments),!e.width&&!e.flex&&i.grid.ion({paint:"updateAutoWidth",thisObj:i}),i.disableIfGridReadOnly&&i.grid.element.classList.add("b-actioncolumn-readonly"),i.externalRenderer=i.renderer,i.renderer=i.internalRenderer}internalRenderer({grid:e,column:t,record:i,callExternalRenderer:r=!0}){var n;const s=i&&"groupRowFor"in i.meta,{subGrid:l}=t;if(r){var o;(o=this.externalRenderer)===null||o===void 0||o.call(this,...arguments)}return{className:{"b-action-ct":1},children:(n=t.actions)===null||n===void 0?void 0:n.map((a,d)=>{var c;if("visible"in a&&(typeof a.visible=="function"&&a.visible({record:i})===!1||a.visible===!1)||s&&!a.showForGroup||!s&&a.showForGroup)return"";const{tooltip:h,renderer:g}=a,f=typeof h=="function"||h!=null&&(c=h.startsWith)!==null&&c!==void 0&&c.call(h,"up.")?l.callback(h,l,[{record:i}]):h||"";if(g){const m=l.callback(g,l,[{index:d,record:i,column:t,tooltip:f,action:a}]);return typeof m=="string"?{tag:"span",dataset:F(F({},me.encodeConfig(f)),{},{index:d}),html:m}:(m.dataset=m.dataset||{},m.dataset.index=d,m)}else return{tag:"button",dataset:F(F({},me.encodeConfig(f)),{},{index:d}),"aria-label":f,className:{"b-tool":1,"b-action-item":1,[a.cls]:a.cls}}})}}onCellClick({grid:e,column:t,record:i,target:r}){var n;if(t!==this||!r.classList.contains("b-action-item"))return;let s=r.dataset.index;s||(s=r.parentElement.dataset&&r.parentElement.dataset.index);const l=(n=t.actions)===null||n===void 0?void 0:n[s],o=l&&l.onClick;o&&this.callback(o,t,[{record:i,action:l,target:r}])}updateAutoWidth(){const e=this,t=[],{actions:i}=e;if(!e.element)return;const r=e.actions=[];i?.forEach(s=>{const l=F({},s);delete l.visible,l.showForGroup?(delete l.showForGroup,t.push(l)):r.push(l)}),t.length>r.length&&(e._actions=t);const n=b.createElement(e.internalRenderer({column:e,callExternalRenderer:!1})).outerHTML;e.width=b.measureText(n,e.element,!0,e.element.parentElement),e.actions=i}}T(yi,"type","action");T(yi,"fields",[{name:"actions",type:"array"},{name:"disableIfGridReadOnly",defaultValue:!1}]);T(yi,"defaults",{filterable:!1,groupable:!1,sortable:!1,editor:!1,searchable:!1,htmlEncode:!1,resizable:!1,minWidth:30});Ce.registerColumnType(yi);yi.exposeProperties();yi._$name="ActionColumn";class bt extends se{static get defaults(){return{filterType:"number",format:""}}get defaultEditor(){const{format:e,name:t,max:i,min:r,step:n,largeStep:s,align:l}=this;return x.cleanupProperties({type:"numberfield",format:e,name:t,max:i,min:r,step:n,largeStep:s,textAlign:l})}get formatter(){const e=this,{format:t}=e;let i=e._formatter;return(!i||e._lastFormat!==t)&&(e._formatter=i=dt.get(e._lastFormat=t)),i}formatValue(e){var t;return e!=null&&(e=this.formatter.format(e),this.unit&&(e=`${e}${this.unit}`)),(t=e)!==null&&t!==void 0?t:""}defaultRenderer({value:e}){return this.formatValue(e)}}T(bt,"type","number");T(bt,"fieldType","number");T(bt,"fields",["format","min","max","step","largeStep","unit"]);Ce.registerColumnType(bt,!0);bt.exposeProperties();bt._$name="NumberColumn";class hr extends bt{static get defaults(){return{function:"sum",includeParentInChangeSet:!1}}construct(e,t){this.configuredAlign="align"in e,this.configuredEditor="editor"in e,super.construct(...arguments);const{grid:i}=t;this.function==="sum"&&(this.function="sumChildren"),i&&(this.store=i.store)}set store(e){const t=this,i={update:"onRecordUpdate",thisObj:t,prio:1e3},r=t._store;if(e!==r){r&&r.un(i),t._store=e;const{modelClass:n}=e,s=n.fieldMap[t.field];s&&s.type==="number"&&(t.configuredAlign||(t.align="end"),t.configuredEditor||(t.editor="number")),e.ion(i)}}canEdit(e){return e.isLeaf}get store(){return this._store}sumChildren(...e){let t=0;for(let i=0,{length:r}=e;i<r;i++)t+=parseFloat(e[i]||0,10);return t}avg(...e){let t=0;const{length:i}=e;for(let r=0;r<i;r++)t+=parseFloat(e[r]||0,10);return t/i}onRecordUpdate({record:e,changes:t}){const i=this,{rowManager:r}=i.grid;i.field in t&&e.isLeaf&&e.bubble(n=>{const s=r.getRowFor(n);if(s){const l=s.getCell(i.field);l&&s.renderCell(l)}},!0)}getRawValue(e){var t;let i=0;if((t=e.children)!==null&&t!==void 0&&t.length){const r=this,n=r.function,s=typeof n=="string"&&typeof Math[n]=="function",{handler:l,thisObj:o}=s?{handler:Math[n],thisObj:Math}:r.resolveCallback(n);i=l.apply(o,e.children.map(a=>r.getRawValue(a))),r.includeParentInChangeSet?e.set(r.field,i,!0):e.setData(r.field,i)}else i=e[this.field];return i}canFillValue(){return!1}}T(hr,"type","aggregate");T(hr,"fields",["function","includeParentInChangeSet"]);Ce.registerColumnType(hr,!0);hr.exposeProperties();hr._$name="AggregateColumn";class Ci extends se{static get defaults(){return{filterable:!1,sortable:!1,editor:!1,searchable:!1,fitMode:!1,alwaysClearCell:!1}}construct(e,t){const i=this;i.widgetMap={},super.construct(...arguments),i.externalRenderer=i.renderer,i.renderer=i.internalRenderer}doDestroy(){for(const e of Object.values(this.widgetMap))e.destroy&&e.destroy();super.doDestroy()}updateReadOnly(e){for(const t of Object.values(this.widgetMap))t.cellInfo.record.readOnly||(t.readOnly=e)}internalRenderer(e){var t;const i=this,{cellElement:r,column:n,record:s,isExport:l}=e,{widgets:o}=n;return!l&&o&&(r.widgets||i.clearCell(r),r.widgets=e.widgets=o.map((a,d)=>{var c,h;let g,f;if(r.widgets&&(g=r.widgets[d],f=g.element.nextElementSibling,a.recreate&&g&&(delete i.widgetMap[g.id],g.destroy(),r.widgets[d]=null)),g||(i.onBeforeWidgetCreate(a,e),a.recomposeAsync=!1,g=lr.append(a,f?{insertBefore:f}:r)[0],i.widgetMap[g.id]=g,i.onAfterWidgetCreate(g,e),g.name&&g.ion({change:({value:m})=>{g.cellInfo.record[g.name]=m}})),g.cellInfo={record:s,column:n},i.grid&&!i.meta.isSelectionColumn&&(g.readOnly=i.grid.readOnly||s.readOnly),((c=i.onBeforeWidgetSetValue)===null||c===void 0?void 0:c.call(i,g,e))!==!1){const m=a.valueProperty||"value"in g&&"value"||g.defaultBindProperty;if(m){const p=g.name?s[g.name]:e.value;g[m]=p}}return(h=i.onAfterWidgetSetValue)===null||h===void 0||h.call(i,g,e),g})),l?null:(t=this.externalRenderer)===null||t===void 0?void 0:t.call(this,e)}onBeforeWidgetCreate(e,t){}onAfterWidgetCreate(e,t){}clearCell(e){e.widgets&&(e.widgets.forEach(t=>{delete this.widgetMap[t.id],t.destroy()}),e.widgets=null),super.clearCell(e)}resizeToFitContent(){}}T(Ci,"type","widget");T(Ci,"fields",["widgets"]);Ce.registerColumnType(Ci);Ci.exposeProperties();Ci._$name="WidgetColumn";class wi extends Ci{construct(e,t){super.construct(...arguments);const i=this;if(Object.assign(i,{externalHeaderRenderer:i.headerRenderer,externalOnBeforeWidgetSetValue:i.onBeforeWidgetSetValue,externalOnAfterWidgetSetValue:i.onAfterWidgetSetValue,onBeforeWidgetSetValue:i.internalOnBeforeWidgetSetValue,onAfterWidgetSetValue:i.internalOnAfterWidgetSetValue,headerRenderer:i.internalHeaderRenderer}),!i.meta.isSelectionColumn){var r;const n=(r=i.grid)===null||r===void 0?void 0:r.store.modelClass;i.field?n&&!n.fieldMap[i.field]&&!i.constructor.suppressNoModelFieldWarning&&(console.warn(i.$$name+" is configured with a field, but this is not part of your Model `fields` collection."),n.addField({name:i.field,type:"boolean"})):console.warn("CheckColumn MUST be configured with a field, otherwise the checked state will not be persistent. Widgets are recycled and reused")}}doDestroy(){var e;(e=this.headerCheckbox)===null||e===void 0||e.destroy(),super.doDestroy()}internalHeaderRenderer({headerElement:e,column:t}){let i;return e.classList.add("b-check-header"),t.showCheckAll?(e.classList.add("b-check-header-with-checkbox"),t.headerCheckbox?e.appendChild(t.headerCheckbox.element):t.headerCheckbox=new vi({appendTo:e,owner:this.grid,ariaLabel:"L{Checkbox.toggleSelection}",internalListeners:{change:"onCheckAllChange",thisObj:t}})):i=t.headerText,i=t.externalHeaderRenderer?t.externalHeaderRenderer.call(this,...arguments):i,t.showCheckAll?void 0:i}updateCheckAllState(e){this.headerCheckbox&&(this.suspendEvents(),this.headerCheckbox.checked=e,this.resumeEvents())}onCheckAllChange({checked:e}){const t=this;if(t.field){const{store:i}=t.grid;i.beginBatch(),i.forEach(r=>t.updateRecord(r,t.field,e)),i.endBatch()}t.trigger("toggleAll",{checked:e})}internalRenderer({value:e,isExport:t,record:i,cellElement:r}){if(t)return e??"";const n=super.internalRenderer(...arguments);return i.readOnly&&!this.meta.isSelectionColumn&&(r.widgets[0].readOnly=!0),n}onBeforeWidgetCreate(e,t){e.cls=this.checkCls}onAfterWidgetCreate(e,t){t.cellElement.widget=e,e.ion({beforeChange:"onBeforeCheckboxChange",change:"onCheckboxChange",thisObj:this})}internalOnBeforeWidgetSetValue(e){var t;e.record=e.cellInfo.record,this.isInitialSet=!0,(t=this.externalOnBeforeWidgetSetValue)===null||t===void 0||t.call(this,...arguments)}internalOnAfterWidgetSetValue(e){var t;this.isInitialSet=!1,(t=this.externalOnAfterWidgetSetValue)===null||t===void 0||t.call(this,...arguments)}onBeforeCheckboxChange({source:e,checked:t,userAction:i}){const r=this,{grid:n}=r,{record:s}=e.cellInfo;if(i&&r.field&&(!n.features.cellEdit||n.features.cellEdit.disabled)||r.meta.isSelectionColumn&&!n.isSelectable(s)&&t)return!1;if(!r.isInitialSet)return r.trigger("beforeToggle",{record:s,checked:t})}onCheckboxChange({source:e,checked:t}){if(!this.isInitialSet){const i=this,{record:r}=e.cellInfo,{field:n}=i;n&&(i.updateRecord(r,n,t),t?i.updateCheckAllState(i.grid.store.every(s=>s[n],null,!0)):i.updateCheckAllState(!1)),i.trigger("toggle",{record:r,checked:t})}}updateRecord(e,t,i){const r=`set${_.capitalize(t)}`;e[r]?e[r](i):e.set(t,i)}onCellKeyDown({event:e,cellElement:t}){if(e.key===" "){const i=t.widget;i?.toggle(),e.preventDefault(),e.handled=!0}}getCurrentConfig(e){const t=super.getCurrentConfig(e);return delete t.onBeforeWidgetSetValue,delete t.onAfterWidgetSetValue,this.externalOnBeforeWidgetSetValue&&(t.onBeforeWidgetSetValue=this.externalOnBeforeWidgetSetValue),this.externalOnAfterWidgetSetValue&&(t.onAfterWidgetSetValue=this.externalOnAfterWidgetSetValue),t}}T(wi,"$name","CheckColumn");T(wi,"type","check");T(wi,"fields",["checkCls","showCheckAll","onAfterWidgetSetValue","onBeforeWidgetSetValue","callOnFunctions","onBeforeToggle","onToggle","onToggleAll"]);T(wi,"defaults",{align:"center",checkCls:null,showCheckAll:!1,sortable:!0,filterable:!0,widgets:[{type:"checkbox",valueProperty:"checked"}]});Ce.registerColumnType(wi,!0);wi._$name="CheckColumn";class Ut extends se{static get defaults(){return{format:"L",step:1,minWidth:85,filterType:"date"}}defaultRenderer({value:e}){return e?this.formatValue(e):""}groupRenderer({cellElement:e,groupRowFor:t}){e.innerHTML=this.formatValue(t)}formatValue(e){return typeof e=="string"&&(e=E.parse(e,this.format||void 0)),E.format(e,this.format||void 0)}set format(e){const{editor:t}=this.data;this.set("format",e),t&&(t.format=e)}get format(){return this.get("format")}get defaultEditor(){const e=this,{min:t,max:i,step:r,format:n}=e;return{name:e.field,type:"date",calendarContainerCls:"b-grid-cell-editor-related",weekStartDay:e.grid.weekStartDay,format:n,max:i,min:t,step:r}}}T(Ut,"$name","DateColumn");T(Ut,"type","date");T(Ut,"fieldType","date");T(Ut,"fields",["format","pickerFormat","step","min","max"]);Ce.registerColumnType(Ut,!0);Ut.exposeProperties();Ut._$name="DateColumn";class xi extends bt{static get defaults(){return{min:0,max:100,showValue:!1,lowThreshold:20,htmlEncode:!1,searchable:!1,summaryRenderer:e=>`${e}%`,fitMode:!1}}constructor(e,t){super(...arguments),this.internalCellCls="b-percent-bar-cell"}defaultRenderer({value:e}){return e=e||0,{className:"b-percent-bar-outer",role:"progressbar","aria-Valuemin":0,"aria-Valuemax":100,"aria-Valuenow":e,tabIndex:0,children:[{tag:"div",className:{"b-percent-bar":1,"b-zero":e===0,"b-low":e<this.lowThreshold},style:{width:e+"%"},children:[this.showValue?{tag:"span",text:e+"%"}:void 0]}]}}resizeToFitContent(){}}T(xi,"type","percent");T(xi,"fieldType","number");T(xi,"fields",["showValue","lowThreshold"]);xi.sum="average";Ce.registerColumnType(xi,!0);xi._$name="PercentColumn";class Yt extends bt{static get defaults(){return{min:0,max:5,emptyIcon:"b-icon b-icon-star",filledIcon:"b-icon b-icon-star",editable:!0,filterType:"number",searchable:!1,width:"11.2em",htmlEncode:!1,minWidth:"11.2em",editor:!1,fitMode:"value"}}renderer({value:e}){return{className:{"b-rating-cell-inner":1,"b-not-editable":!this.editable},children:B.populate(this.max,t=>{const i=t<e;return{tag:"i",className:{"b-rating-icon":!0,"b-filled":i,"b-empty":!i,[i?this.filledIcon:this.emptyIcon]:!0}}})}}onCellClick({grid:e,column:t,record:i,target:r,event:n}){if(r.classList.contains("b-rating-icon")&&!e.readOnly&&t.editable){let s=[].indexOf.call(r.parentNode.childNodes,r);r.classList.contains("b-filled")&&(n.metaKey||n.shiftKey)&&(s=s-1),i.get(t.field)===1&&s===0&&(s=-1),i.set(t.field,s+1)}}}T(Yt,"$name","RatingColumn");T(Yt,"type","rating");T(Yt,"fieldType","number");T(Yt,"fields",["emptyIcon","filledIcon","editable"]);Ce.registerColumnType(Yt,!0);Yt.exposeProperties();Yt._$name="RatingColumn";class pn extends se{static get defaults(){return{groupable:!1,sortable:!1,filterable:!1,searchable:!1,resizable:!1,draggable:!1,minWidth:50,width:50,align:"center",text:"#",editor:!1}}construct(e){super.construct(...arguments);const t=this,{grid:i}=t;t.internalCellCls="b-row-number-cell",t.externalHeaderRenderer=t.headerRenderer,t.headerRenderer=t.internalHeaderRenderer,i&&(i.ion({bindStore:"bindStore",thisObj:t}),t.bindStore({store:i.store,initial:!0}),i.store.count&&!i.rendered&&i.ion({paint:"resizeToFitContent",thisObj:t,once:!0}))}get groupHeaderReserved(){return!0}bindStore({store:e,initial:t}){const i=this;i.detachListeners("grid"),e.ion({name:"grid",[`change${i.grid.asyncEventSuffix}`]:"onStoreChange",thisObj:i}),t||i.resizeToFitContent()}onStoreChange({action:e}){(e==="dataset"||e==="add"||e==="remove"||e==="removeall")&&this.resizeToFitContent()}renderer({record:e,grid:t}){return e.isSpecialRow?"":t.store.indexOf(e,!0)+1}resizeToFitContent(){const{grid:e}=this,{store:t}=e,{count:i}=t;if(i&&!this.hidden){const r=e.element.querySelector(`.b-grid-cell[data-column-id="${this.id}"]`);if(r){const n=parseInt(b.getStyleValue(r,"padding-left")),s=b.measureText(i,r);this.width=Math.max(this.minWidth,s+2*n)}}}set flex(e){}internalHeaderRenderer({headerElement:e,column:t}){var i;return e.classList.add("b-rownumber-header"),((i=t.externalHeaderRenderer)===null||i===void 0?void 0:i.call(this,...arguments))||t.headerText}}T(pn,"$name","RowNumberColumn");T(pn,"type","rownumber");Ce.registerColumnType(pn,!0);pn._$name="RowNumberColumn";class fr extends se{static get defaults(){return{htmlEncode:!1}}constructor(e,t){super(...arguments);const i=this;if(!i.template)throw new Error("TemplateColumn needs a template");if(typeof i.template!="function")throw new Error("TemplateColumn.template must be a function")}renderer(e){if(!e.record.isSpecialRow)return this.template({value:e.value,record:e.record,field:e.column.field})}}T(fr,"type","template");T(fr,"fields",["template"]);Ce.registerColumnType(fr,!0);fr.exposeProperties();fr._$name="TemplateColumn";class Si extends se{static get defaults(){return{format:"LT",minWidth:140,filterType:"time"}}defaultRenderer({value:e}){return e?this.formatValue(e):""}groupRenderer({cellElement:e,groupRowFor:t}){e.innerHTML=this.formatValue(t)}formatValue(e){return typeof e=="string"&&(e=E.parse(e,this.format)),E.format(e,this.format)}set format(e){const{editor:t}=this;this.set("format",e),t&&(t.format=e)}get format(){return this.get("format")}get defaultEditor(){return{name:this.field,type:"time",format:this.format}}}T(Si,"type","time");T(Si,"fieldType","date");T(Si,"fields",["format"]);Ce.registerColumnType(Si,!0);Si.exposeProperties();Si._$name="TimeColumn";let za=!1;class Ei extends se{static get defaults(){return{tree:!0,hideable:!1,minWidth:150}}static get fields(){return[{name:"expandIconCls",defaultValue:"b-icon b-icon-tree-expand"},{name:"collapseIconCls",defaultValue:"b-icon b-icon-tree-collapse"},{name:"collapsedFolderIconCls"},{name:"expandedFolderIconCls"},{name:"indentSize",defaultValue:1.7},{name:"leafIconCls",defaultValue:"b-icon b-icon-tree-leaf"},{name:"editTargetSelector",defaultValue:".b-tree-cell-value"},"renderer"]}constructor(e,t){super(...arguments);const i=this;i.shouldHtmlEncode=i.htmlEncode,i.setData("htmlEncode",!1),i.renderer&&(i.originalRenderer=i.renderer),i.renderer=i.treeRenderer.bind(i)}treeRenderer(e){const t=this,{grid:i,column:r,cellElement:n,row:s,record:l,isExport:o}=e,a=l.instanceMeta(i.store),d=!l.isLeaf&&a.collapsed,c={className:"b-tree-cell-value"},h=[c],g={className:"b-tree-cell-inner",tag:l.href?"a":"div",href:l.href,target:l.target,children:h},f={"b-tree-parent-row":0,"b-tree-collapsed":0,"b-tree-expanded":0,"b-loading-children":0};let m,p,{value:v}=e;if(t.originalRenderer){var y;const R=t.originalRenderer(e),H=(y=i.hasFrameworkRenderer)===null||y===void 0?void 0:y.call(i,{cellContent:R,column:r});m=typeof R=="object"&&!H,v=H?"":R===!1?n.innerHTML:R,e.rendererHtml=R}if(!m){var C;v=String((C=v)!==null&&C!==void 0?C:"")}if(o)return v;if(l.isLeaf)n.classList.add("b-tree-leaf-cell"),p=e.iconCls||l.iconCls||t.leafIconCls;else{var w;const R=!l.isExpanded(i.store),H=R?t.expandIconCls:t.collapseIconCls,L=R?t.collapsedFolderIconCls:t.expandedFolderIconCls;f["b-tree-parent-row"]=1,f["b-tree-collapsed"]=R,f["b-tree-expanded"]=!R,f["b-loading-children"]=a.isLoadingChildren,n.classList.add("b-tree-parent-cell"),h.unshift({tag:"i",className:{"b-tree-expander":1,[H]:1,"b-empty-parent":!a.isLoadingChildren&&l.children!==!0&&!((w=l.children)!==null&&w!==void 0&&w.length)}}),za=p=e.iconCls||l.iconCls||L}if(p&&h.splice(h.length-1,0,{tag:"i",className:{"b-tree-icon":1,[p]:1}}),s.isRow&&(s.assignCls(f),!l.isLeaf))if(s.setAttribute("aria-expanded",!d),d)s.removeAttribute("aria-owns");else for(const R in i.subGrids){var S,D;const H=s.elements[R];b.setAttributes(H,{"aria-owns":(S=l.children)!==null&&S!==void 0&&S.length?(D=l.children)===null||D===void 0?void 0:D.map(L=>`${i.id}-${R}-${L.id}`).join(" "):null})}m||t.shouldHtmlEncode||!v.includes("<")?(m&&Object.assign(c,v),c.children=c.children||[],c.children.unshift(m?null:v)):c.html=v;const I=l.childLevel*t.indentSize+(l.isLeaf?za?2:p?.5:.4:0);return g.style=`padding-inline-start:${I}em`,g}getCurrentConfig(e){const t=super.getCurrentConfig(e);return t.renderer=this.originalRenderer,t}}T(Ei,"$name","TreeColumn");T(Ei,"type","tree");Ce.registerColumnType(Ei,!0);Ei.exposeProperties();Ei._$name="TreeColumn";class sn extends fe{static get fields(){return[{name:"iconCls",internal:!0},{name:"expanded",internal:!0},{name:"cls",internal:!0},{name:"rowHeight",internal:!0},{name:"href",internal:!0},{name:"target",internal:!0}]}}sn.exposeProperties();sn._$name="GridRowModel";const Ni=new Map,ri=new Map,_r="Grid",Hr={Grid:"GridBase",Scheduler:"SchedulerBase",SchedulerPro:"SchedulerProBase",Gantt:"GanttBase"},Am=/\$\d+$/;class Q{static registerFeature(e,t=!1,i=null,r=null){r=_.uncapitalize(r||Object.prototype.hasOwnProperty.call(e,"$name")&&e.$$name||e.name),r=r.replace(Am,""),Array.isArray(i)||(i=[i||_r]),i.forEach(n=>{const s=Hr[n]||n,l=Ni.get(s)||new Map,o=ri.get(s)||new Map;l.set(r,e),o.set(e,t),Ni.set(s,l),ri.set(s,o)})}static getTypeNameFeatures(e=_r){const t=Hr[e]||e,i=Ni.get(t),r={};return i&&i.forEach((n,s)=>r[s]=n),r}static getTypeNameDefaultFeatures(e=_r){const t=Hr[e]||e,i=Ni.get(t),r=ri.get(t),n={};return i&&r&&i.forEach((s,l)=>{r.get(s)&&(n[l]=s)}),n}static getInstanceFeatures(e){return e.$meta.names.reduce((t,i)=>Object.assign(t,this.getTypeNameFeatures(i)),{})}static getInstanceDefaultFeatures(e){return e.$meta.names.reduce((t,i)=>Object.entries(this.getTypeNameFeatures(i)).reduce((r,[n,s])=>(this.isDefaultFeatureForTypeName(s,i)?r[n]=s:delete r[n],r),t),{})}static isDefaultFeatureForTypeName(e,t=_r){const i=Hr[t]||t,r=ri.get(i);return r&&r.get(e)||!1}static isDefaultFeatureForInstance(e,t){const i=t.$meta.names.slice().reverse();let r=null;for(let n=0,s=i.length;n<s&&r===null;++n){const l=ri.get(i[n]);l&&l.has(e)&&(r=l.get(e))}return r||!1}static reset(){Ni.clear(),ri.clear()}}class gr extends ee{constructor(...e){super(...e),T(this,"entityName","cell")}afterConstruct(){super.afterConstruct(),this.afterSelectionModeChange()}afterSelectionModeChange(){const e=this;e.client.selectionMode.cell?e._disabledBySelectionMode&&(e.disabled=!1,delete e._disabledBySelectionMode):e.disabled=!0}get copyOnly(){var e;return this._copyOnly||!((e=this.client.features.cellEdit)!==null&&e!==void 0&&e.enabled)}get canCopy(){return!this.disabled&&!this.client.selectedRecords.length&&this.client.selectedCells.length}get canCutPaste(){var e;return this.canCopy&&!this.copyOnly&&!((e=this.client.features.cellEdit)!==null&&e!==void 0&&e.isEditing)&&!this.client.readOnly}isActionAvailable(e,t){return this.canCopy&&(t==="copy"||this.canCutPaste)}async sendToClipboard(e){const t=this;let i=0,r=0,n="";e.sort((a,d)=>a.rowIndex===d.rowIndex?a.columnIndex-d.columnIndex:a.rowIndex-d.rowIndex);for(const a of e){var s,l;const{record:d,column:c,rowIndex:h,columnIndex:g}=a;h>i?(n.length>0&&(n+=`
`.repeat(h-i)),i=h,r=g):g>r&&(n.length>0&&(n+="	".repeat(g-r)),r=g);let f=(s=c.toClipboardString)===null||s===void 0?void 0:s.call(c,a);if(f===void 0){var o;f=(o=d.get(c.field))===null||o===void 0?void 0:o.toString()}t.toCopyString&&(f=t.toCopyString({currentValue:f,column:c,record:d})),f=(l=f)===null||l===void 0?void 0:l.replace(/[\n\t]/," "),n+=f||t.emptyValueChar}return await W.writeToClipboard(n,this.useNativeClipboard),n}async cut(){await this.copy(!0)}async copy(e){const t=this,{client:i,entityName:r}=t,n=typeof e=="boolean"?e:!1,s=n?i.selectedCells.filter(l=>{var o;return!((o=l.record)!==null&&o!==void 0&&o.readOnly)}):i.selectedCells;if(s){if((n?!t.canCutPaste:!t.canCopy)||i.trigger("beforeCopy",{cells:s,isCut:n,entityName:r})===!1)return;const l=await t.sendToClipboard(s);if(n===!0)for(const o of s)o.column.readOnly||o.record.set(o.column.field,null);i.trigger("copy",{cells:s,copiedDataString:l,isCut:n,entityName:r})}}async paste(){const e=this,{client:t,entityName:i}=e,r=await W.readFromClipboard(e.useNativeClipboard),n=t.selectedCells[0];if(!e.canCutPaste||!(r!=null&&r.length)||!n||t.trigger("beforePaste",{clipboardData:r,targetCell:n,entityName:i})===!1)return;const s=new Set,l=e.stringAs2dArray(r),o=[],{_shiftSelectRange:a}=t;if(!!(l!=null&&l.length)){if(a!=null&&a.some(d=>d.equals(n))){const d=e.cellSelectorsAs2dArray(a);if(d?.length%l.length===0&&d.columnCount%l.columnCount===0)for(let c=0;c<d.length;c+=l.length)for(let h=0;h<d.columnCount;h+=l.columnCount)o.push(d[c][h])}o.length||o.push(n);for(const d of o)for(let c=0;c<l.length;c++){const h=l[c],g=t.store.getAt(d.rowIndex+c);if(g&&!g.readOnly)for(let f=0;f<h.length;f++){const m=t.columns.getAt(d.columnIndex+f),p=m?.field;let v=h[f];p&&v&&!m.readOnly&&(v===e.emptyValueChar&&(v=null),m.fromClipboardString&&(v=m.fromClipboardString({string:v,record:g})),e.toPasteValue&&(v=e.toPasteValue({currentValue:v,record:g,column:m,field:p})),g.set(p,v,!1,!1,!1,!0),s.add(g))}}t.trigger("paste",{clipboardData:r,targetCell:n,modifiedRecords:[...s],entityName:i})}}cellSelectorsAs2dArray(e){const t=[];let i=null,r;for(const n of e)n.id!==i&&(i=n.id,r=[],t.push(r)),r.push(n);return t.columnCount=t[0].length,t.some(n=>n.length!==t.columnCount)?!1:t}stringAs2dArray(e){const t=[],i=e.split(/\r\n|(?!\r\n)[\n-\r\x85\u2028\u2029]/);for(const r of i){const n=r.split("	");if(t.columnCount&&n.length!==t.columnCount)return!1;t.columnCount=n.length,t.push(n)}return t}populateCellMenu({record:e,items:t}){const i=this;i.canCopy&&(t.cutCell={text:i.cutText,localeClass:i,icon:"b-icon b-icon-cut",weight:115,disabled:e.readOnly||!i.canCutPaste,onItem:()=>i.cut()},t.pasteCell={text:i.pasteText,localeClass:i,icon:"b-icon b-icon-paste",weight:120,disabled:e.readOnly||!i.canCutPaste,onItem:()=>i.paste()},t.copyCell={text:i.copyText,localeClass:i,cls:"b-separator",icon:"b-icon b-icon-copy",weight:110,onItem:()=>i.copy()})}}T(gr,"$name","CellCopyPaste");T(gr,"pluginConfig",{chain:["populateCellMenu","afterSelectionModeChange"]});T(gr,"configurable",{copyOnly:null,emptyValueChar:" ",keyMap:{"Ctrl+C":"copy","Ctrl+X":"cut","Ctrl+V":"paste"},useNativeClipboard:!re.isTestEnv,toCopyString:null,toPasteValue:null,copyText:"L{copy}",cutText:"L{cut}",pasteText:"L{paste}"});gr._$name="CellCopyPaste";Q.registerFeature(gr);const $m={finishAndEditNextRow:1,finishAndEditPrevRow:1,finishEditing:1,cancelEditing:1,finishAndEditNextCell:1,finishAndEditPrevCell:1};class nl extends Se(ee){static get defaultConfig(){return{autoSelect:!0,blurAction:"complete",continueEditingOnCellClick:!0,addNewAtEnd:null,autoEdit:null,editNextOnEnterPress:!0,editorClass:Gt,triggerEvent:"celldblclick",touchEditDelay:300,focusCellAnimationDuration:!1,multiEdit:!0,keyMap:{Enter:["startEditing","finishAndEditNextRow"],"Ctrl+Enter":["finishAllSelected","finishEditing"],"Shift+Enter":"finishAndEditPrevRow","Alt+Enter":"finishEditing",F2:["startEditing","finishEditing"],Escape:"cancelEditing",Tab:"finishAndEditNextCell","Shift+Tab":"finishAndEditPrevCell"}}}static get pluginConfig(){return{assign:["startEditing","finishEditing","cancelEditing"],before:["onElementKeyDown","onElementPointerUp"],chain:["onElementClick","bindStore"]}}construct(e,t){super.construct(e,t);const i=this,r={renderRows:"onGridRefreshed",cellClick:"onCellClick",thisObj:i};i.grid=e,i.triggerEvent!=="cellclick"&&(r[i.triggerEvent]="onTriggerEditEvent"),i.autoEdit&&!("editNextOnEnterPress"in t)&&(i.editNextOnEnterPress=!1),e.ion(r),e.rowManager.ion({changeTotalHeight:"onGridRefreshed",thisObj:i}),i.bindStore(e.store)}bindStore(e){this.detachListeners("store"),e.ion({name:"store",update:"onStoreUpdate",beforeSort:"onStoreBeforeSort",thisObj:this})}async confirm(e){let t=!0;return this.editorContext&&(li.owner=this.editorContext.editor.inputField,e.rootElement=this.grid.rootElement,t=await li.confirm(e),li.owner=null),t===li.yesButton}doDestroy(){this.grid.columns.allRecords.forEach(e=>{var t;(t=e._cellEditor)===null||t===void 0||t.destroy()}),super.doDestroy()}doDisable(e){e&&!this.isConfiguring&&this.cancelEditing(!0),super.doDisable(e)}set disabled(e){super.disabled=e}get disabled(){const{grid:e}=this;return Boolean(super.disabled||e.disabled||e.readOnly)}get isEditing(){return Boolean(this.editorContext)}get activeRecord(){var e;return((e=this.editorContext)===null||e===void 0?void 0:e.record)||null}getEditorForCell({id:e,cell:t,column:i,columnId:r,editor:n}){var s;const l=this,{grid:o,editorClass:a}=l;let d=i.cellEditor,c=0;return i.editTargetSelector&&(c=t.querySelector(i.editTargetSelector).offsetLeft),n.autoSelect=l.autoSelect,(s=d)!==null&&s!==void 0&&s.isEditor||(d=i.data.cellEditor=a.create(a.mergeConfigs({type:a.type,constrainTo:null,cls:"b-cell-editor",inputField:n,blurAction:"none",invalidAction:i.invalidAction,completeKey:!1,cancelKey:!1,owner:o,align:{align:"t0-t0",offset:[c,0]},internalListeners:l.getEditorListeners(),onInternalKeyDown:l.onEditorKeydown.bind(l),allowMouseEvents:n.allowMouseEvents},d))),d.minHeight=o.rowHeight,d.inputField!==n&&(d.remove(d.items[0]),d.add(n)),d.align.offset[0]=c,i.instantUpdate&&!n.cellEditValueSetter&&(x.wrapProperty(n,"value",null,h=>{const{editorContext:g}=l,f=g?.editor.inputField;g!=null&&g.editor.isValid&&!x.isEqual(g.record[g.column.field],h)&&(!(f!=null&&f.isDateField)||f._isPickerInput)&&(g.record[g.column.field]=h)}),n.cellEditValueSetter=!0),Object.assign(d.element.dataset,{rowId:e,columnId:r,field:i.field}),d.inputField.revertOnEscape=i.revertOnEscape,l.editor=d}getEditorListeners(){return{focusOut:"onEditorFocusOut",focusIn:"onEditorFocusIn",start:"onEditorStart",beforeComplete:"onEditorBeforeComplete",complete:"onEditorComplete",beforeCancel:"onEditorBeforeCancel",cancel:"onEditorCancel",beforeHide:"onBeforeEditorHide",finishEdit:"onEditorFinishEdit",thisObj:this}}onEditorStart({source:e}){const t=this,i=t.editorContext=e.cellEditorContext;if(i){var r;const{grid:n}=t;t.triggerEvent!=="cellclick"&&(t.detachListeners("cellClickWhileEditing"),n.ion({name:"cellClickWhileEditing",cellclick:"onCellClickWhileEditing",thisObj:t})),(r=t.removeEditingListeners)===null||r===void 0||r.call(t),t.removeEditingListeners=te.addListener({globaltap:"onTapOut",thisObj:t}),n.trigger("startCellEdit",{grid:n,editorContext:i})}}onEditorBeforeComplete(e){const{grid:t}=this,i=e.source,r=i.cellEditorContext;return e.grid=t,e.editorContext=r,t.trigger("beforeFinishCellEdit",e)}onEditorComplete({source:e}){const{grid:t}=this,i=e.cellEditorContext;i.value=e.inputField.value,t.trigger("finishCellEdit",{grid:t,editorContext:i})}onEditorBeforeCancel(){const{editorContext:e}=this;return this.grid.trigger("beforeCancelCellEdit",{editorContext:e})}onEditorCancel({event:e}){const{editorContext:t,muteEvents:i,grid:r}=this;i||r.trigger("cancelCellEdit",{grid:r,editorContext:t,event:e})}onBeforeEditorHide({source:e}){const t=this,{row:i,cell:r}=e.cellEditorContext;r?.classList.remove("b-editing"),i?.removeCls("b-editing"),t.detachListeners("cellClickWhileEditing"),t.removeEditingListeners()}onEditorFinishEdit({source:e}){e.cellEditorContext=this.editorContext=null}getAdjacentEditableCell(e,t){const{grid:i}=this,{store:r,columns:n}=i,{visibleColumns:s}=n;let l=e.id,o=n.getAdjacentVisibleLeafColumn(e.columnId,t);for(;l;)if(o){if(o.editor&&o.canEdit(r.getById(l)))return{id:l,columnId:o.id};o=n.getAdjacentVisibleLeafColumn(o,t)}else{const a=r.getAdjacent(e.id,t,!1,!0);l=a?.id,a&&(o=t?s[0]:s[s.length-1])}return null}doAddNewAtEnd(){const e=typeof this.addNewAtEnd=="object"?x.clone(this.addNewAtEnd):{},{grid:t}=this,i=t.store.add(e)[0];return t.rowManager.getRowFor(i)||t.rowManager.displayRecordAtBottom(),i}getEditingContext(e){e=this.grid.normalizeCellContext(e);const{column:t,record:i}=e;if(t!=null&&t.isVisible&&t.editor&&i&&!i.isSpecialRow&&!i.readOnly&&t.canEdit(i)){const r=i&&t.getRawValue(i);return Object.assign(e,{value:r===void 0?null:r,editor:t.editor}),e}else return!1}async startEditing(e={}){const t=this;if(!t.disabled){var i,r,n;const{grid:l}=t;if((i=e)!==null&&i!==void 0&&i.fromKeyMap&&(e=t.grid.focusedCell),x.isEmpty(e)&&(e.id=l.firstVisibleRow.id),l.store.isTree&&l.features.tree){var s;const g=e.id?l.store.getById(e.id):(s=e.record)!==null&&s!==void 0?s:l.store.getAt(e.row);if(g)await l.expandTo(g);else return!1}const o=t.getEditingContext(e);if(!o||(t.editorContext&&t.cancelEditing(),(r=l.focusedCell)!==null&&r!==void 0&&r.equals(o)||l.focusCell(o),l.trigger("beforeCellEditStart",{grid:l,editorContext:o})===!1))return!1;const a=o.editor=t.getEditorForCell(o),{row:d,cell:c,record:h}=o;return a.inputField.highlightExternalChange=!1,a.cellEditorContext=o,a.render(c),c.classList.add("b-editing"),d.addCls("b-editing"),await a.startEdit({target:c,field:a.inputField.name||o.column.field,value:o.value,record:h})||(c.classList.remove("b-editing"),d.removeCls("b-editing")),(n=t.onCellEditStart)===null||n===void 0||n.call(t),!0}return!1}cancelEditing(e=!1,t){var i;const r=this,{editorContext:n,editor:s}=r;e.fromKeyMap&&(t=e,e=!1),n&&(r.muteEvents=e,s.cancelEdit(t),r.muteEvents=!1),r.finishEditingPromise=!1,(i=r.afterCellEdit)===null||i===void 0||i.call(r)}async finishEditing(){const e=this,{editorContext:t,grid:i}=e;let r=!1;if(e.finishEditingPromise)return e.finishEditingPromise;if(t){var n;const{column:s}=t;e.finishEditingPromise=t.editor.completeEdit(s.bindCallback(s.finalizeCellEdit)),r=await e.finishEditingPromise,await i.waitForAnimations(),e.finishEditingPromise=null,(n=e.afterCellEdit)===null||n===void 0||n.call(e)}return r}async onCellClickWhileEditing({event:e,cellSelector:t}){const i=this;if(b.isTouchEvent){await i.finishEditing();return}i.finishEditingPromise||i.editorContext&&!i.editorContext.editor.owns(e.target)&&(i.getEditingContext(t)?await i.finishEditing()?i.continueEditingOnCellClick&&await i.startEditing(t):(i.grid.focusCell(i.editorContext),i.editor.inputField.focus()):await i.finishEditing())}async onCellClick({source:e,cellSelector:t,target:i,event:r,column:n}){if(n.onCellClick)return;const s=this,{focusedCell:l}=s.client;if(i.closest(".b-tree-expander"))return!1;b.isTouchEvent&&s._lastCellClicked===l?.cell&&r.timeStamp-s.touchEditDelay>s._lastCellClickedTime?await s.startEditing(t):this.triggerEvent==="cellclick"&&await s.onTriggerEditEvent({cellSelector:t,target:i}),s._lastCellClicked=l?.cell,s._lastCellClickedTime=r.timeStamp}onElementPointerUp(e){e.target.closest(".b-tree-expander")&&this.cancelEditing(void 0,e)}async onTriggerEditEvent({cellSelector:e,target:t,event:i}){var r;const{editorContext:n,client:s}=this;t.closest(".b-tree-expander")||b.isTouchEvent&&i.type==="dblclick"||i&&((r=s.features.cellMenu)===null||r===void 0?void 0:r.triggerEvent)===i.type||n&&(n.equals(this.grid.normalizeCellContext(e))||!await this.finishEditing())||await this.startEditing(e)}onStoreUpdate({changes:e,record:t}){const{editorContext:i}=this;i!=null&&i.editor.isVisible&&t===i.record&&i.editor.dataField in e&&i.editor.refreshEdit()}onStoreBeforeSort(){var e;const t=(e=this.editorContext)===null||e===void 0?void 0:e.editor;this.isEditing&&!(t!=null&&t.isFinishing)&&!t.isValid&&this.cancelEditing()}onGridRefreshed(){const e=this,{grid:t,editorContext:i}=e;if(i&&t.isVisible&&t.focusedCell){const r=t.getCell(t.focusedCell),{editor:n}=i;r&&b.isInView(r)&&!n.isFinishing?(i._cell=r,te.suspendFocusEvents(),n.render(r),n.showBy(r),n.focus(),te.resumeFocusEvents()):e.cancelEditing()}}get gridSelection(){return[...this.grid.selectedRecords,...this.grid.selectedCells]}isActionAvailable(e,t,i){const r=this;if(t=t.replace("cellEdit.",""),!r.disabled&&!i.target.closest(".b-grid-header")){if(r.isEditing){if(t==="finishAllSelected")return r.multiEdit&&r.gridSelection.length>1;if($m[t])return!0}else if(t==="startEditing")return r.grid.focusedCell.cell===i.target}return!1}async finishAllSelected(){const e=this,{dataField:t,record:i}=e.editor;if(await e.finishEditing()&&!e.isDestroyed)for(const r of e.gridSelection)r.isModel?r!==i&&(r[t]=i[t]):r.record.set(r.column.field,i[t])}async finishAndEditNextRow(e,t=!1){const i=this,{grid:r}=i,{record:n}=i.editorContext;let s;if(await i.finishEditing()){if(i.isDestroyed)return;i.isEditing||(t?s=r.internalNextPrevRow(!1,!0,e,!1):(i.addNewAtEnd&&n===r.store.last&&await i.doAddNewAtEnd(),i.isDestroyed||(s=r.internalNextPrevRow(!0,!0,e))),s&&i.editNextOnEnterPress&&!r.touch&&i.startEditing(s))}}finishAndEditPrevRow(e){this.finishAndEditNextRow(e,!0)}async finishAndEditNextCell(e,t=!1){const i=this,{focusedCell:r}=i.grid;if(r){let n=i.getAdjacentEditableCell(r,!t);if(!n&&!t&&i.addNewAtEnd&&await i.finishEditing()===!0&&(await this.doAddNewAtEnd(),n=!i.isDestroyed&&i.getAdjacentEditableCell(r,!t)),n){let s=!0;i.isEditing&&(s=await i.finishEditing()),!i.isDestroyed&&s&&(i.grid.focusCell(n,{animate:i.focusCellAnimationDuration}),await i.startEditing(n)||await i.finishAndEditNextCell(e,t))}}}finishAndEditPrevCell(e){this.finishAndEditNextCell(e,!0)}async onElementKeyDown(e){const t=this,{grid:i}=t,{focusedCell:r}=i,{key:n}=e;if(!(e.handled||!t.autoEdit||t.isEditing||!r||r.isActionable||e.ctrlKey)){if(n.length<=1&&await t.startEditing(r)){const{inputField:s}=t.editor,{input:l}=s;l&&(s.internalOnKeyEvent(e),e.defaultPrevented||(l.value=n,s.internalOnInput(e))),e.preventDefault()}else if(e.key==="Delete"||e.key==="Backspace"){const{gridSelection:s}=t;if(t.multiEdit&&s.length>1)for(const l of s)l.isModel?i.visibleColumns.forEach(o=>{l.set(o.field,null)}):l.record.set(l.column.field,null);else r.record.set(r.column.field,null)}}}onEditorKeydown(e){if(e.key.startsWith("Arrow"))return e.handled=!0,e.stopPropagation(),!1}async onEditorFocusOut(e){const t=this,{grid:i,editor:r,editorContext:n}=t,s=new K(e.relatedTarget),l=s.grid===i&&t.getEditingContext(s);n&&!r.isFinishing&&r.owns(e._target)&&(t.blurAction==="cancel"?t.cancelEditing(void 0,e):!t.finishEditingPromise&&(t.triggerEvent==="cellclick"||t.triggerEvent!=="cellclick"&&!l)&&await t.finishEditing())}onEditorFocusIn(e){const t=e.toWidget;t===this.editor.inputField&&this.autoSelect&&t.selectAll&&!t.readOnly&&!t.disabled&&t.selectAll()}async onTapOut({event:e}){const t=this;(!t.grid.bodyContainer.contains(e.target)||e.button)&&(t.editor.owns(e.target)||(t.editingStoppedByTapOutside=!0,t.blurAction==="cancel"?t.cancelEditing(void 0,e):await t.finishEditing(),delete t.editingStoppedByTapOutside))}async onElementClick(e){e.target.classList.contains("b-grid-body-container")&&this.editorContext&&await this.finishEditing()}}T(nl,"$name","CellEdit");nl._$name="CellEdit";Q.registerFeature(nl,!0);class vn extends qs{static get $name(){return"CellMenu"}static get defaultConfig(){return{processItems:null,items:null,type:"cell"}}static get pluginConfig(){const e=super.pluginConfig;return e.chain.push("populateCellMenu"),e}showContextMenu(e){const t=this,{cellSelector:i,event:r}=e;t.client.focusCell(i,{doSelect:!t.client.isSelected(i),event:r}),super.showContextMenu(e)}shouldShowMenu({column:e}){return e&&e.enableCellContextMenu!==!1}getDataFromEvent(e){const t=this.client.getCellDataFromEvent(e);if(t)return x.assign(super.getDataFromEvent(e),t)}beforeContextMenuShow({record:e,items:t,column:i}){if(i.cellMenuItems===!1)return!1;(!e||e.isSpecialRow)&&(t.removeRow=!1)}populateCellMenu({items:e,column:t,record:i}){const{client:r}=this;t!=null&&t.cellMenuItems&&x.merge(e,t.cellMenuItems),r.readOnly||(e.removeRow={text:"L{removeRow}",localeClass:this,icon:"b-fw-icon b-icon-trash",cls:"b-separator",weight:100,disabled:i.readOnly,onItem:()=>r.store.remove(r.selectedRecords.filter(n=>!n.readOnly))})}get showMenu(){return!0}}vn.featureClass="";vn._$name="CellMenu";Q.registerFeature(vn,!0,["Grid","Scheduler"]);Q.registerFeature(vn,!1,["Gantt"]);class bn extends ee{construct(e,t){super.construct(e,this.processConfig(t))}initTip(){const e=this;e.tip=me.new({forElement:e.client.element,forSelector:".b-grid-row:not(.b-group-row) .b-grid-cell, .b-grid-merged-cells",hoverDelay:1e3,trackMouse:!1,cls:"b-celltooltip-tip",getHtml:e.getTooltipContent.bind(e),internalListeners:{pointerOver:"onPointerOver",thisObj:e},listeners:e.configuredListeners},e.initialConfig),e.relayEvents(e.tip,["beforeShow","show"])}onPointerOver({target:e}){const t=this.client.getColumnFromElement(e);return t.tooltipRenderer!==!1&&Boolean(t.tooltipRenderer||this.tooltipRenderer)}processConfig(e){return typeof e=="function"?{tooltipRenderer:e}:e}setConfig(e){super.setConfig(this.processConfig(e))}doDestroy(){this.tip&&this.tip.destroy(),super.doDestroy()}doDisable(e){e?this.tip&&(this.tip.destroy(),this.tip=null):this.initTip(),super.doDisable(e)}getTooltipContent({tip:e,activeTarget:t,event:i}){const r=this,n=r.client.getRecordFromElement(t),s=r.client.getColumnFromElement(t),l={cellElement:t,record:n,column:s,event:i,tip:e,cellTooltip:r};let o;return!r.forSelector&&n===r.lastRecord&&n.generation===r.lastRecordGeneration&&s===r.lastColumn?r.tip._html:(r.lastRecord=n,r.lastRecordGeneration=n.generation,r.lastColumn=s,s.tooltipRenderer?o=s.tooltipRenderer(l):r.tooltipRenderer&&s.tooltipRenderer!==!1&&(o=r.tooltipRenderer(l)),N.isPromise(o)&&(r.lastRecord=r.lastRecordGeneration=r.lastColumn=null),o)}}T(bn,"$name","CellTooltip");T(bn,"configurable",{tooltipRenderer:null});bn._$name="CellTooltip";Q.registerFeature(bn);const Wa="store";class sl extends Se(ee){static get $name(){return"ColumnAutoWidth"}static get configurable(){return{default:null,delay:0}}static get pluginConfig(){return{after:{bindStore:"bindStore",unbindStore:"unbindStore",renderRows:"syncAutoWidthColumns",onInternalResize:"onInternalResize"},assign:["columnAutoWidthPending","syncAutoWidthColumns"]}}construct(e){super.construct(e);const{store:t}=this.client;t&&this.bindStore(t)}doDestroy(){this.unbindStore(),super.doDestroy()}bindStore(e){this.lastSync=null,e.ion({name:Wa,[`change${this.client.asyncEventSuffix}`]:"onStoreChange",thisObj:this})}unbindStore(){this.detachListeners(Wa)}get columnAutoWidthPending(){return this.lastSync===null||this.hasTimeout("syncAutoWidthColumns")}onStoreChange({action:e}){if(e!=="move"){const t=this,{cellEdit:i}=t.client.features;++t.storeGeneration,i!=null&&i.isEditing&&!i.editingStoppedByTapOutside?t.syncAutoWidthColumns():t.hasTimeout("syncAutoWidthColumns")||t.setTimeout("syncAutoWidthColumns",t.delay)}}onInternalResize(e,t,i,r){r===0&&(this.lastSync=null,this.syncAutoWidthColumns())}syncAutoWidthColumns(){const e=this,t=e.client,i=e.storeGeneration;if(e.lastSync!==i){e.lastSync=i;let r,n;for(const s of t.columns.visibleColumns)r=s.autoWidth,r&&(r===!0&&(r=e.default),t.resizingColumns=n=!0,s.resizeToFitContent(r));n&&(t.resizingColumns=!1,t.afterColumnsResized())}e.hasTimeout("syncAutoWidthColumns")&&e.clearTimeout("syncAutoWidthColumns")}}sl.prototype.storeGeneration=0;sl._$name="ColumnAutoWidth";Q.registerFeature(sl,!0);class ll extends Se(ee){static get $name(){return"ColumnDragToolbar"}static get pluginConfig(){return{after:["render"]}}construct(e,t){var i;(i=e.features.columnReorder)===null||i===void 0||i.ion({beforeDestroy:"onColumnReorderBeforeDestroy",thisObj:this}),this.grid=e,super.construct(e,t)}doDestroy(){const e=this;e.grid.features.columnReorder&&!e.grid.features.columnReorder.isDestroyed&&e.detachFromColumnReorder(),e.element&&e.element.remove(),e.element=null,super.doDestroy()}doDisable(e){this.initialized&&(e?this.detachFromColumnReorder():this.init()),super.doDisable(e)}init(){const e=this,t=e.grid;!t.features.columnReorder||(e.reorderDetacher=t.features.columnReorder.ion({gridheaderdragstart({context:i}){const r=t.columns.getById(i.element.dataset.columnId);e.showToolbar(r)},gridheaderdrag:({context:i})=>e.onDrag(i),gridheaderabort:()=>{e.hideToolbar()},gridheaderdrop:({context:i})=>{i.valid?e.hideToolbar():e.onDrop(i)},thisObj:e}),e.initialized=!0)}onColumnReorderBeforeDestroy(){this.detachFromColumnReorder()}detachFromColumnReorder(){const e=this;e.grid.features.columnReorder.un("beforedestroy",e.onColumnReorderBeforeDestroy,e),e.reorderDetacher&&e.reorderDetacher(),e.reorderDetacher=null}render(){this.initialized||this.init()}showToolbar(e){const t=this,i=t.grid.getColumnDragToolbarItems(e,[]),r=[];t.clearTimeout(t.buttonHideTimer),i.forEach(n=>{n.text=n.localeClass.L(n.text);let s=r.find(l=>l.text===n.group);s||(s={text:n.localeClass.L(n.group),buttons:[]},r.push(s)),s.buttons.push(n)}),t.element=b.append(t.grid.element,t.template(r)),t.groups=r,t.buttons=i,t.column=e}async hideToolbar(){const e=this,t=e.element;t&&(t.classList.add("b-remove"),await A.waitForTransitionEnd({element:t,mode:"animation",thisObj:e.client}),t.remove(),e.element=null)}onDrag(e){var t;const i=this;if(e.dragProxy.getBoundingClientRect().top-i.grid.element.getBoundingClientRect().top>100?i.element.classList.add("b-closer"):i.element.classList.remove("b-closer"),i.hoveringButton&&(i.hoveringButton.classList.remove("b-hover"),i.hoveringButton=null),(t=e.targetElement)!==null&&t!==void 0&&t.closest(".b-columndragtoolbar")){i.element.classList.add("b-hover");const r=e.targetElement.closest(".b-columndragtoolbar  .b-target-button:not([data-disabled=true])");r&&(r.classList.add("b-hover"),i.hoveringButton=r)}else i.element.classList.remove("b-hover")}onDrop(e){const t=this;if(e.targetElement&&e.targetElement.matches(".b-columndragtoolbar .b-target-button:not([data-disabled=true])")){const i=e.targetElement,r=t.buttons.find(n=>n.ref===i.dataset.ref);r&&(i.classList.add("b-activate"),t.buttonHideTimer=t.setTimeout(()=>{t.hideToolbar(),r.onDrop({column:t.column})},100))}else t.hideToolbar()}template(e){return Xe.tpl`
            <div class="b-columndragtoolbar">     
            <div class="b-title"></div>          
            ${e.map(t=>Xe.tpl`
                <div class="b-group">
                    <div class="b-buttons">
                    ${t.buttons.map(i=>Xe.tpl`
                        <div class="b-target-button" data-ref="${i.ref}" data-disabled="${i.disabled}">
                            <i class="${i.icon}"></i>
                            ${i.text}
                        </div>
                    `)}
                    </div>
                    <div class="b-title">${t.text}</div>
                </div>
            `)}
            </div>`}}ll.featureClass="b-hascolumndragtoolbar";ll._$name="ColumnDragToolbar";Q.registerFeature(ll,W.isTouchDevice);class yn extends ee{static get pluginConfig(){return{chain:["populateHeaderMenu","getColumnDragToolbarItems"]}}get grid(){return this.client}getColumnPickerItems(e){const t=this,{createColumnsFromModel:i}=t;let r;if(t.groupByRegion)r=t.grid.regions.map(n=>{const s=t.grid.getSubGrid(n).columns.topColumns;return{text:_.capitalize(n),menu:t.buildColumnMenu(s),disabled:s.length===0,region:n}}),i&&r.push({text:t.L("L{newColumns}"),menu:t.createAutoColumnItems()});else if(t.groupByTag){const n={};e.topColumns.forEach(s=>{s.tags&&Array.isArray(s.tags)&&s.hideable!==!1&&s.tags.forEach(l=>{n[l]||(n[l]=1)})}),r=Object.keys(n).sort().map(s=>({text:_.capitalize(s),menu:t.buildColumnMenu(t.getColumnsForTag(s)),tag:s,onBeforeSubMenu:({item:l,itemEl:o})=>{t.refreshTagMenu(l,o)}})),i&&r.push({text:t.L("L{newColumns}"),menu:t.createAutoColumnItems()})}else r=t.buildColumnMenu(e.topColumns),i&&r.items.push(...x.transformNamedObjectToArray(t.createAutoColumnItems()));return r}createAutoColumnItems(){const e=this,{grid:t}=e,{columns:i,store:r}=t,{modelClass:n}=r,{allFields:s}=n,l={};for(let o=0,{length:a}=s;o<a;o++){const d=s[o],c=d.name;i.get(c)||d.internal||(l[c]={text:d.text||_.separate(d.name),checked:!1,onToggle:h=>{const g=i.get(c);g?g[h.checked?"show":"hide"]():i.add(i.generateColumnForField(d,{region:e.forColumn.region})),h.bubbles=!1}})}return l}getColumnsForTag(e){return this.grid.columns.records.filter(t=>t.tags&&Array.isArray(t.tags)&&t.tags.includes(e)&&t.hideable!==!1)}refreshTagMenu(e,t){this.getColumnsForTag(e.tag).forEach(r=>{const n=e.items.find(s=>s.column===r);n&&(n.checked=r.hidden!==!0)})}buildColumnMenu(e){let t=e.length>0&&e[0].region;const{grid:i}=this,r=e.reduce((n,s)=>{const l=i.columns.visibleColumns.filter(o=>o.region===s.region);if(s.hideable!==!1){const o={grid:i,column:s,text:s.headerText,checked:s.hidden!==!0,disabled:s.hidden!==!0&&l.length===1,cls:s.region!==t?"b-separator":""};t=s.region,s.children&&!s.isCollapsible&&(o.menu=this.buildColumnMenu(s.children)),n.push(o)}return n},[]);return{cls:this.menuCls,items:r}}populateHeaderMenu({column:e,items:t}){const i=this,{columns:r}=i.grid;if(i.forColumn=e,e.showColumnPicker!==!1&&r.some(n=>n.hideable)&&(t.columnPicker={text:"L{columnsMenu}",localeClass:i,icon:"b-fw-icon b-icon-columns",cls:"b-separator",weight:200,menu:i.getColumnPickerItems(r),onToggle:i.onColumnToggle,disabled:i.disabled}),e.hideable!==!1&&!e.parent.isCollapsible){const n=r.visibleColumns.filter(s=>s.region===e.region);t.hideColumn={text:"L{hideColumn}",localeClass:i,icon:"b-fw-icon b-icon-hide-column",weight:210,disabled:n.length===1||i.disabled,onItem:()=>e.hide()}}}onColumnToggle({menu:e,item:t,checked:i}){if(Boolean(t.column.hidden)!==!i){var r,n;t.column[i?"show":"hide"]();const{grid:s,column:l}=t,{columns:o,features:a}=s,d=e.items,c=o.visibleColumns.filter(f=>f.region===t.column.region),h=((r=a.headerMenu)===null||r===void 0?void 0:r.enabled)&&a.headerMenu.menu.widgetMap.hideColumn;if(c.length===1){const f=d.find(m=>m.column===c[0]);f&&(f.disabled=!0),h&&l.region===t.column.region&&(h.disabled=!0)}else c.forEach(f=>{const m=d.find(p=>p.column===f);m&&(m.disabled=!1)}),h&&l.region===t.column.region&&(h.disabled=!1);(n=t.menu)===null||n===void 0||n.eachWidget(f=>{f.checked=i});const g=e.owner;g&&g.column===l.parent&&(g.checked=d.some(f=>f.checked===!0))}}getColumnDragToolbarItems(e,t){const i=this.grid.columns.visibleColumns.filter(r=>r.region===e.region);return e.hideable!==!1&&i.length>1&&t.push({text:"L{hideColumnShort}",ref:"hideColumn",group:"L{column}",localeClass:this,icon:"b-fw-icon b-icon-hide-column",weight:101,onDrop:({column:r})=>r.hide()}),t}}T(yn,"$name","ColumnPicker");T(yn,"configurable",{groupByRegion:!1,groupByTag:!1,createColumnsFromModel:!1,menuCls:"b-column-picker-menu b-sub-menu"});yn._$name="ColumnPicker";Q.registerFeature(yn,!0);class Cn extends ee{doDestroy(){var e;(e=this.editor)===null||e===void 0||e.destroy(),super.doDestroy()}static get pluginConfig(){return{after:["populateHeaderMenu"]}}populateHeaderMenu({items:e,column:t}){e.rename={weight:215,icon:"b-fw-icon b-icon-edit",text:this.L("L{rename}"),disabled:t.readOnly,onItem:()=>this.startEdit(t)}}startEdit(e){if(e instanceof Event){var t;e=(t=this.client.getHeaderDataFromEvent(e))===null||t===void 0?void 0:t.column}if(e){if(e.readOnly)return!1;const{textWrapper:i}=e;let{editor:r}=this;r||(this.editor=r=new Gt({owner:this.client,align:{align:"t0-t0"}})),r.render(i),r.startEdit({target:i,record:e,field:"text"})}}}T(Cn,"$name","ColumnRename");T(Cn,"configurable",{keyMap:{F2:"startEdit"}});Cn._$name="ColumnRename";Q.registerFeature(Cn,!1);class wn extends Se(ee){constructor(...e){super(...e),T(this,"ignoreSelectors",[".b-grid-header-resize-handle",".b-field"])}doDestroy(){var e,t;(e=this.dragHelper)===null||e===void 0||e.scrollManager.destroy(),(t=this.dragHelper)===null||t===void 0||t.destroy(),super.doDestroy()}get grid(){return this.client}init(){const e=this,{grid:t}=e,i=t.element,r=b.children(i,".b-grid-headers");r.push(...b.children(i,".b-grid-header-children")),e.dragHelper?e.dragHelper.containers=r:(e.dragHelper=new Ks({name:"columnReorder",mode:"container",dragThreshold:10,targetSelector:".b-grid-header",floatRootOwner:t,rtlSource:t,outerElement:t.headerContainer,monitoringConfig:{scrollables:[{element:".b-grid-headers"}]},scrollManager:Zs.new({direction:"horizontal",element:t.headerContainer}),containers:r,isElementDraggable(n){if(Boolean(n.closest(e.ignoreSelectors.join(",")))||e.disabled)return!1;const l=n.closest(this.targetSelector),o=l&&t.columns.getById(l.dataset.columnId),a=o?.childLevel===0&&t.subGrids[o.region].columns.count===1;return Boolean(o)&&o.draggable!==!1&&!a},ignoreSelector:".b-filter-icon,.b-grid-header-resize-handle",internalListeners:{beforeDragStart:e.onBeforeDragStart,dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,thisObj:e}}),e.relayEvents(e.dragHelper,["dragStart","drag","drop","abort"],"gridHeader"))}static get pluginConfig(){return{after:["onPaint","renderContents"]}}onDrag({context:e,event:t}){const i=this,r=k.fromElement(t.target,"gridheader");if(r!=null&&r.subGrid.sealedColumns){e.valid=!1;return}i.grid.features.columnDragToolbar||(e.valid=Boolean(t.target.closest(".b-grid-headers")))}onBeforeDragStart({context:e,event:t}){const{element:i}=e,r=e.column=this.client.columns.getById(i.dataset.columnId);return this.client.trigger("beforeColumnDragStart",{column:r,event:t})}onDragStart({context:e,event:t}){const i=this,{grid:r}=i,{column:n}=e;if(!r.features.columnDragToolbar){const s=r.element.querySelector(".b-grid-header-container").getBoundingClientRect();i.dragHelper.minY=s.top,i.dragHelper.maxY=s.bottom}r.headerContainer.classList.add("b-dragging-header"),e.dragProxy.style.fontSize=b.getStyleValue(e.element,"fontSize"),r.trigger("columnDragStart",{column:n,event:t})}onDrop({context:e,event:t}){if(!e.valid)return this.onInvalidDrop({context:e});const i=this,{grid:r}=i,n=e.dragging,s=e.target.closest(".b-grid-header"),l=e.draggedTo.dataset.region,o=s?r.columns.get(s.dataset.column):r.subGrids[l].columns.last,a=l||o.region,d=e.insertBefore,c=r.columns.getById(n.dataset.columnId),h=c.parent,g=d?r.columns.getById(d.dataset.columnId):r.subGrids[a].columns.last.nextSibling;let f;if(g)f=g.parent;else{const p=s?.parentElement.closest(".b-grid-header");p?f=r.columns.getById(p.dataset.columnId):f=r.columns.rootNode}r.headerContainer.classList.remove("b-dragging-header"),n.remove();let m=a===c.region&&h===f&&(o===c.previousSibling||g===c.nextSibling);m=m||r.trigger("beforeColumnDropFinalize",{column:c,newParent:f,insertBefore:g,event:t})===!1,m||(m=!f.insertChild(c,g)),e.valid=!m,m||(c.region=a,h.children.length===0&&h.parent.removeChild(h)),r.trigger("columnDrop",{column:c,newParent:f,insertBefore:g,valid:e.valid,event:t})}onInvalidDrop(){this.grid.headerContainer.classList.remove("b-dragging-header")}renderContents(){this.init()}onPaint(){this.init()}}T(wn,"$name","ColumnReorder");wn.featureClass="b-column-reorder";wn._$name="ColumnReorder";Q.registerFeature(wn,!0);class vc extends ee{static get $name(){return"ColumnResize"}static get configurable(){return{liveResize:"auto"}}construct(e,t){const i=this;i.grid=e,super.construct(e,t),i.resizer=new Xs({name:"columnResize",targetSelector:".b-grid-header",handleSelector:".b-grid-header-resize-handle",outerElement:e.element,rtlSource:e,internalListeners:{beforeresizestart:i.onBeforeResizeStart,resizestart:i.onResizeStart,resizing:i.onResizing,resize:i.onResize,cancel:i.onCancel,thisObj:i}})}doDestroy(){var e;(e=this.resizer)===null||e===void 0||e.destroy(),super.doDestroy()}changeLiveResize(e){return e==="auto"?!W.isMobileSafari:e}onBeforeResizeStart(){return!this.disabled}onResizeStart({context:e}){const{grid:t,resizer:i}=this,r=e.column=t.columns.getById(e.element.dataset.columnId);i.minWidth=r.minWidth,t.element.classList.add("b-column-resizing")}onResizing({context:e}){e.valid&&this.liveResize&&(this.grid.resizingColumns=!0,e.column.width=e.newWidth)}onResize({context:e}){const{grid:t}=this,{column:i}=e;t.element.classList.remove("b-column-resizing"),e.valid&&(this.liveResize?(t.resizingColumns=!1,t.afterColumnsResized(i)):i.width=e.newWidth)}onCancel({context:e}){const{grid:t}=this;t.element.classList.remove("b-column-resizing"),e.column.width=e.elementWidth,t.resizingColumns=!1}}vc._$name="ColumnResize";Q.registerFeature(vc,!0);class mr extends ee.mixin(Se){constructor(...e){super(...e),T(this,"delayable",{handleSelection:"raf"})}afterConstruct(){super.afterConstruct(),this.client.selectionMode.cell||(this.disabled=!0),this._fillListeners={}}onContentChange(){this.handleSelection()}afterColumnsChange(){this.handleSelection()}fixElementHeights(){this.handleSelection()}getCellDataFromEvent(e,t){return t&&(t=!e.target.classList.contains("b-fill-handle")),this.overridden.getCellDataFromEvent(e,t)}findPatternsIn2dRange(e,t,i){const r={};for(const n of e){const s=t?n.id:n.columnId;let l=n.record[n.column.field];l&&typeof l=="string"&&!isNaN(l)&&(l=parseFloat(l)),r[s]||(r[s]=[]),r[s].push(l)}for(const n in r)r[n].pattern=this.findPatternsIn1dRange(r[n],i);return r}findPatternsIn1dRange(e,t){const i=e[t?0:e.length-1],r={next:()=>i,lastValue:i};if(e.every(n=>typeof n=="number")||e.every(n=>n instanceof Date)){const n=e.map((s,l)=>s-e[l-1]);n.shift(),new Set(n).size===1&&(r.increaseBy=n[0]*(t?-1:1),r.next=()=>(r.lastValue instanceof Date?r.lastValue=new Date(r.lastValue.getTime()+r.increaseBy):r.lastValue+=r.increaseBy,r.lastValue))}else e.length>1&&(r.stringPattern=[...e],r.next=()=>(r.currentIndex===void 0?r.currentIndex=0:(r.currentIndex+=1,r.currentIndex>=r.stringPattern.length&&(r.currentIndex=0)),r.stringPattern[r.currentIndex]));return r}afterSelectionChange(){const e=this;te.isMouseDown()?(e.client.delayUntilMouseUp(()=>e.handleSelection(!0)),e.removeElements()):e.handleSelection(!0)}handleSelection(){if(!this._isExtending){const e=this.rangeSelection;e?this.drawFillHandleAndBorder(e[0],e[e.length-1]):this.removeElements()}}onMouseDown(e){this._fillListeners.mouseMoveOrUp=A.on({element:globalThis,mouseover:"onMouseOver",mouseup:"onMouseUp",thisObj:this}),e.stopImmediatePropagation(),e.handled=!0}onMouseUp(){const e=this,{client:t,currentRange:i,_isCropping:r}=e,n=e.rangeSelection,s=n&&i&&t.internalSelectRange(i.from,i.to),l=s?.selectedCells||[],o=r?e.croppingCells:l.filter(c=>!n.some(h=>h.equals(c,!0)));if(delete e._isCropping,e._isExtending&&(t.disableScrollingCloseToEdges(t.items),delete e._isExtending),!(o!=null&&o.length)){e.handleSelection();return}if(t.suspendRefresh(),r)o.forEach(c=>c.record.set(c.column.field,null,!1,!1,!1,!0));else{const[c]=o,h=n.some(p=>p.record===c.record),g=h?c.columnIndex<n[0].columnIndex:c.rowIndex<n[0].rowIndex,f=e.findPatternsIn2dRange(n,h,g),m=new Map;g&&o.reverse();for(const p of o){const{column:v,record:y}=p;if(v.canFillValue({range:n,record:y,cell:p})){var a,d;let C=(a=e.calculateFillValue)===null||a===void 0?void 0:a.call(e,{range:n,column:v,record:y,cell:p}),w=m.get(y);w||(w={},m.set(y,w)),C===void 0&&(C=f[h?p.id:p.columnId].pattern.next()),w[v.field]=((d=v.calculateFillValue)===null||d===void 0?void 0:d.call(v,{value:C,record:y,range:n}))||C}}for(const[p,v]of m)p.set(v,null,null,null,null,!0)}t.resumeRefresh(!0),t.performSelection(s),delete e.currentRange,e.handleSelection()}onMouseOver(e){var t,i;const r=this,{client:n,rangeSelection:s}=r,l=s[0],o=s[s.length-1],a=n.getCellDataFromEvent(e,!0);let d=a&&n.normalizeCellContext(a.cellSelector);if(((t=d)===null||t===void 0||(i=t._column)===null||i===void 0?void 0:i.region)===l._column.region){const c=s.some(m=>m.equals(d,!0));let h;r._isExtending||n.enableScrollingCloseToEdges(n.items),c?r._isCropping=r.allowCropping&&(d.rowIndex<o.rowIndex||d.columnIndex<o.columnIndex):d.rowIndex>=l.rowIndex&&d.rowIndex<=o.rowIndex?(h=l.columnIndex>d.columnIndex,d=new K({grid:n,record:h?l.record:o.record,column:d.column})):(h=l.rowIndex>d.rowIndex,d=new K({grid:n,record:d.record,column:h?l.column:o.column}));const g=h?d:l,f=h||c&&!r._isCropping?o:d;r.currentRange={from:g,to:f},r._isExtending=!0,r.drawFillHandleAndBorder(g,f,!0)}}drawFillHandleAndBorder(e,t,i=!1){var r;const n=this,{client:s,currentRange:l,_fillListeners:o}=n,a=s.subGrids[e.column.region].element,{x:d}=O.from(e.cell||e.column.element,a),{right:c}=O.from(t.cell||t.column.element,a),{y:h}=s.getRecordCoords(e.record,!0),g=s.getRecordCoords(t.record,!0).bottom-1;let{borderElement:f,handleElement:m}=n;if(n.removeElements(i),f||(n.borderElement=f=b.createElement({className:"b-fill-selection-border"}),n.handleElement=m=b.createElement({className:"b-fill-handle"})),b.setRect(f,{y:h,x:d,width:c-d,height:g-h}),a.appendChild(f),b.setTopLeft(m,g,c>=a.scrollWidth?d:c),a.appendChild(m),n.toggleCroppingCls(!1),delete n.croppingCells,n._isCropping&&(r=n.rangeSelection)!==null&&r!==void 0&&r.length){const p=s.getRange(l.from,l.to);n.croppingCells=n.rangeSelection.filter(v=>!p.some(y=>y.equals(v,!0))),n.toggleCroppingCls()}o.handleClick||(o.handleClick=A.on({element:globalThis,delegate:".b-fill-handle",mousedown:"onMouseDown",thisObj:n})),n.hasFillElements=!0}toggleCroppingCls(e=!0){var t;(t=this.croppingCells)===null||t===void 0||t.forEach(i=>{var r;return(r=this.client.getCell(i))===null||r===void 0?void 0:r.classList.toggle("b-indicate-crop",e)})}removeElements(e=!1){var t,i;const r=this;(t=r.handleElement)===null||t===void 0||t.remove(),(i=r.borderElement)===null||i===void 0||i.remove(),e||r.removeListeners(),r.hasFillElements=!1}removeListeners(){const e=this;for(const t in e._fillListeners)e._fillListeners[t]();e._fillListeners={}}get rangeSelection(){var e;const{client:t}=this,{selectedCells:i}=t,r=(e=t._shiftSelectRange)!==null&&e!==void 0?e:i.length===1&&i;return!t.selectedRecords.length&&r!==null&&r!==void 0&&r.length&&r.length===i.length&&r.every(n=>i.some(s=>n.equals(s,!0))&&n._column.parent&&n._column.region===r[0]._column.region&&t.store.isAvailable(n.id))?r:null}}T(mr,"$name","FillHandle");T(mr,"configurable",{calculateFillValue:null,allowCropping:!1});T(mr,"pluginConfig",{chain:["afterSelectionChange","onContentChange","afterColumnsChange","fixElementHeights"],override:["getCellDataFromEvent"]});mr._$name="FillHandle";Q.registerFeature(mr);class ci extends G{static get $name(){return"GridFieldFilterPicker"}static get type(){return"gridfieldfilterpicker"}afterConstruct(){var e;const t=this;if(!t.grid)throw new Error(`${t.constructor.$name} requires 'grid' to be configured.`);t.fields=(e=t.fields)!==null&&e!==void 0?e:{},super.afterConstruct()}updateGrid(e){var t;if(!((t=e.store)!==null&&t!==void 0&&t.modelClass))throw new Error("Grid does not have a store with a modelClass defined.");if(!e.columns)throw new Error("Grid does not have a column store.")}static getModelClassFields(e){const t=new Set(e.fields.map(({name:i})=>i));return e?.allFields.filter(i=>!i.internal&&(Zd.includes(i.type)||Hs(i))&&(i.definedBy!==fe||t.has(i.name)))||[]}static getColumnFields(e,t,i){var r;const n=B.keyBy(ci.getModelClassFields(t),"name"),s=i&&new Set(i);return Object.fromEntries((r=e?.records.filter(({field:l})=>l&&n[l]&&(!s||s.has(l))).map(({field:l,text:o})=>[l,{title:o||l,type:Hs(n[l])?"duration":n[l].type}]))!==null&&r!==void 0?r:[])}changeFields(e){var t;let i=e;return Array.isArray(e)&&(re.deprecate("Core","6.0.0","FieldOption[] deprecated, use Object<String, FieldOption[]> keyed by field name instead"),i=B.keyBy(i,"name")),x.merge({},ci.getColumnFields(this.grid.columns,(t=this.grid.store)===null||t===void 0?void 0:t.modelClass,this.allowedFieldNames),i)}}T(ci,"configurable",{grid:null,allowedFieldNames:null});ci.initClass();ci._$name="GridFieldFilterPicker";class xn extends Ge{static get $name(){return"GridFieldFilterPickerGroup"}static get type(){return"gridfieldfilterpickergroup"}validateConfig(){if(!this.grid)throw new Error(`${this.constructor.$name} requires the 'grid' config property.`)}getFilterPickerConfig(e){const{grid:t,allowedFieldNames:i}=this;return F(F({},super.getFilterPickerConfig(e)),{},{grid:t,allowedFieldNames:i})}updateGrid(e){this.store=this.grid.store}canManage(e){const t=this;return super.canManage(e)&&(!t.allowedFieldNames||t.allowedFieldNames.includes(e.property))}}T(xn,"configurable",{grid:null,allowedFieldNames:null});T(xn,"childPickerType","gridfieldfilterpicker");xn.initClass();xn._$name="GridFieldFilterPickerGroup";const bs={date:"date",int:"number",integer:"number",number:"number",string:"text",duration:"duration"};class bc extends ee{static get $name(){return"Filter"}static get configurable(){return{prioritizeColumns:!1,keyMap:{f:"showFilterEditorByKey"},isMulti:!1}}construct(e,t){if(e.features.filterBar)throw new Error("Grid.feature.Filter feature may not be used together with Grid.feature.FilterBar. These features are mutually exclusive.");const i=this;if(i.grid=e,i.closeFilterEditor=i.closeFilterEditor.bind(i),super.construct(e,t),i.bindStore(e.store),t&&typeof t=="object"){const r=x.clone(t);delete r.prioritizeColumns,delete r.isMulti,delete r.dateFormat,x.isEmpty(r)||e.store.filter(r,null,e.isConfiguring)}}doDestroy(){var e,t;(e=this.filterTip)===null||e===void 0||e.destroy(),(t=this.filterEditorPopup)===null||t===void 0||t.destroy(),super.doDestroy()}get store(){return this.grid.store}bindStore(e){this.detachListeners("store"),e.ion({name:"store",beforeFilter:"onStoreBeforeFilter",filter:"onStoreFilter",thisObj:this})}static get pluginConfig(){return{chain:["renderHeader","populateCellMenu","populateHeaderMenu","onElementClick","bindStore"]}}refreshHeaders(e){const t=this,i=t.grid,r=i.headerContainer;r&&(b.children(r,".b-filter-icon.b-latest").forEach(n=>n.classList.remove("b-latest")),t.filterTip||(t.filterTip=new me({forElement:r,forSelector:".b-filter-icon",getHtml({activeTarget:n}){return n.dataset.filterText}})),i.store.isFiltered||t.filterTip.hide(),i.columns.visibleColumns.forEach(n=>{if(n.filterable!==!1){const s=t.store.filters.allValues.filter(({property:a,disabled:d,internal:c})=>a===n.field&&!d&&!c),l=s.length>0,o=n.element;if(o){const a=n.textWrapper;let d=a?.querySelector(".b-filter-icon"),c;if(l){const h="&#x2022 ";c=`${t.L("L{filter}")}: `+(s.length>1?"<br/><br/>":"")+s.map(g=>{var f,m,p;let v=(f=g.value)!==null&&f!==void 0?f:"";const y=Array.isArray(v),C=(m=t.store)===null||m===void 0||(p=m.modelRelations)===null||p===void 0?void 0:p.find(({foreignKey:S})=>S===g.property);if(g.displayValue)v=g.displayValue;else{if(t.isMulti&&C){var w;const{relatedDisplayField:S}=(w=t.isMulti.fields)===null||w===void 0?void 0:w[g.property];S&&(y?v=v[S].sort((I,R)=>(I??"").localeCompare(R??"")):v=(I=>{var R;return(R=C.foreignStore.getById(I))===null||R===void 0?void 0:R[S]})(v))}else n.formatValue&&v&&(v=y?v.map(S=>n.formatValue(S)):n.formatValue(v));y&&(v=`[ ${v.join(", ")} ]`)}return(s.length>1?h:"")+(typeof g=="string"?g:`${g.operator} ${v}`)}).join("<br/><br/>")}else c=t.L("L{applyFilter}");d?d.dataset.filterText=c:d=b.createElement({parent:a,tag:"div",className:"b-filter-icon",dataset:{filterText:c}}),n.field===t.store.latestFilterField&&d.classList.add("b-latest"),o.classList.add("b-filterable"),o.classList.toggle("b-filter",l)}n.meta.isFiltered=l}}),e&&i.refreshRows())}applyFilter(e,t){const{store:i}=this,{filterFn:r}=e.filterable;e.$filter=i.addFilter(F(F(F({},e.filterable),t),{},{property:e.field,[r?"filterBy":"_"]:function(n){return r({value:this.value,record:n,operator:this.operator,property:this.property,column:e})}}),!0),i.filter()}removeFilter(e){if(this.isMulti)for(const t of this.getCurrentMultiFilters(e))this.store.removeFilter(t);else this.store.removeFilter(e.field)}disableFilter(e){for(const t of this.getCurrentMultiFilters(e))t.disabled=!0,this.store.filter(t);this.store.filter()}getCurrentMultiFilters(e){return this.store.filters.values.filter(t=>t.property===e.field)}getPopupDateItems(e,t,i,r,n,s,l,o){const a=this,d=s;function c(){a.removeFilter(e)}function h({event:f}){f.key==="Enter"&&s()}function g({source:f,value:m}){m==null?c():(a.clearSiblingsFields(f),a.applyFilter(e,{operator:f.operator,value:m,displayValue:f._value,type:"date"}))}return[x.assign({type:"date",ref:"on",placeholder:"L{on}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:i?.operator==="sameDay"?i.value:r,operator:"sameDay",onKeydown:h,onChange:g,onClose:d,onClear:c},o),x.assign({type:"date",ref:"before",placeholder:"L{before}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-before"></i>',value:i?.operator==="<"?i.value:null,operator:"<",onKeydown:h,onChange:g,onClose:d,onClear:c},o),x.assign({type:"date",ref:"after",cls:"b-last-row",placeholder:"L{after}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-after"></i>',value:i?.operator===">"?i.value:null,operator:">",onKeydown:h,onChange:g,onClose:d,onClear:c},o)]}getPopupNumberItems(e,t,i,r,n,s,l,o){const a=this,d=s;function c(){a.removeFilter(e)}function h({event:f}){f.key==="Enter"&&s()}function g({source:f,value:m}){m==null?c():(a.clearSiblingsFields(f),a.applyFilter(e,{operator:f.operator,value:m}))}return[x.assign({type:"number",placeholder:"L{Filter.equals}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:i?.operator==="="?i.value:r,operator:"=",onKeydown:h,onChange:g,onEsc:d,onClear:c},o),x.assign({type:"number",placeholder:"L{lessThan}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:i?.operator==="<"?i.value:null,operator:"<",onKeydown:h,onChange:g,onEsc:d,onClear:c},o),x.assign({type:"number",cls:"b-last-row",placeholder:"L{moreThan}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:i?.operator===">"?i.value:null,operator:">",onKeydown:h,onChange:g,onEsc:d,onClear:c},o)]}clearSiblingsFields(e){var t;(t=this.filterEditorPopup)===null||t===void 0||t.items.forEach(i=>{i!==e&&i?.clear()})}getPopupDurationItems(e,t,i,r,n,s,l,o){const a=this,d=s,c=()=>a.removeFilter(e);a.removeFilter(e);function h({source:g,value:f}){a.clearSiblingsFields(g),a.applyFilter(e,{operator:g.operator,value:f})}return[x.assign({type:"duration",placeholder:"L{Filter.equals}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:i?.operator==="="?i.value:r,operator:"=",onChange:h,onEsc:d,onClear:c},o),x.assign({type:"duration",placeholder:"L{lessThan}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:i?.operator==="<"?i.value:null,operator:"<",onChange:h,onEsc:d,onClear:c},o),x.assign({type:"duration",cls:"b-last-row",placeholder:"L{moreThan}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:i?.operator===">"?i.value:null,operator:">",onChange:h,onEsc:d,onClear:c},o)]}getPopupStringItems(e,t,i,r,n,s,l,o){const a=this;return[x.assign({type:t,cls:"b-last-row",placeholder:"L{filter}",localeClass:a,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:i?i.value||i:r,operator:"*",onChange({source:d,value:c}){c===""?l():(a.applyFilter(e,{operator:d.operator,value:c,displayValue:d.displayField&&d.records?d.records.map(h=>h[d.displayField]).join(", "):void 0}),d.multiSelect||s())},onClose:s,onClear:l},o)]}getPopupItems(e,t,i,r,n,s,l,o){const a=this;if(a.isMulti)return a.getMultiFilterPopupItems(...arguments);switch(t){case"date":return a.getPopupDateItems(...arguments);case"number":return a.getPopupNumberItems(...arguments);case"duration":return a.getPopupDurationItems(...arguments);default:return a.getPopupStringItems(...arguments)}}getMultiFilterPopupItems(e){var t;const{grid:i,isMulti:r}=this,n=(t=i.store)===null||t===void 0?void 0:t.filters.find(s=>s.property===e.field);return[F(F({},typeof r=="object"?r:void 0),{},{type:"gridfieldfilterpickergroup",ref:"pickerGroup",limitToProperty:e.field,grid:i,filters:n?[]:[{property:e.field}],propertyFieldCls:"b-transparent property-field",operatorFieldCls:"b-transparent operator-field",valueFieldCls:"b-transparent value-field",width:"400px"})]}showFilterEditor(e,t){e=this.grid.columns.getById(e);const i=this,{store:r,isMulti:n}=i,s=e.element,l=r.filters.getBy("property",e.field),o=i.getFilterType(e);if(e.filterable===!1)return;i.closeFilterEditor();const a=i.getPopupItems(e,o,l!=null&&l.internal?null:l,t,r,i.closeFilterEditor,()=>{i.removeFilter(e),i.closeFilterEditor()},e.filterable.filterField,n);a.forEach(d=>d.placeholder=d.placeholder?this.L(d.placeholder):d.placeholder),i.filterEditorPopup=lr.openPopup(s,{owner:i.grid,cls:"b-filter-popup",scrollAction:"realign",layout:{type:"vbox",align:"stretch"},items:a})}closeFilterEditor(){var e;(e=this.filterEditorPopup)===null||e===void 0||e.setTimeout(this.filterEditorPopup.destroy),this.filterEditorPopup=null}getFilterType(e){const t=e.field,i=this.client.store.modelClass.getFieldDefinition(t),r=e.filterType;return r?bs[r]:bs[e.type]||i&&bs[i.type]||"text"}populateCellMenuWithDateItems({column:e,record:t,items:i}){const r=e.field;if(this.getFilterType(e)==="date"){const s=this,l=t[r],o=a=>{s.applyFilter(e,{operator:a,value:l,displayValue:e.formatValue?e.formatValue(l):l,type:"date"})};i.filterDateEquals={text:"L{on}",localeClass:s,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",weight:300,disabled:s.disabled,onItem:()=>o("=")},i.filterDateBefore={text:"L{before}",localeClass:s,icon:"b-fw-icon b-icon-filter-before",weight:310,disabled:s.disabled,onItem:()=>o("<")},i.filterDateAfter={text:"L{after}",localeClass:s,icon:"b-fw-icon b-icon-filter-after",weight:320,disabled:s.disabled,onItem:()=>o(">")}}}populateCellMenuWithNumberItems({column:e,record:t,items:i}){const r=e.field;if(this.getFilterType(e)==="number"){const s=this,l=t[r],o=a=>{s.applyFilter(e,{operator:a,value:l})};i.filterNumberEquals={text:"L{equals}",localeClass:s,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",weight:300,disabled:s.disabled,onItem:()=>o("=")},i.filterNumberLess={text:"L{lessThan}",localeClass:s,icon:"b-fw-icon b-icon-filter-less",weight:310,disabled:s.disabled,onItem:()=>o("<")},i.filterNumberMore={text:"L{moreThan}",localeClass:s,icon:"b-fw-icon b-icon-filter-more",weight:320,disabled:s.disabled,onItem:()=>o(">")}}}populateCellMenuWithDurationItems({column:e,record:t,items:i}){const r=e.field;if(this.getFilterType(e)==="duration"){const s=this,l=t[r],o=a=>{s.applyFilter(e,{operator:a,value:l})};i.filterDurationEquals={text:"L{equals}",localeClass:s,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",weight:300,disabled:s.disabled,onItem:()=>o("=")},i.filterDurationLess={text:"L{lessThan}",localeClass:s,icon:"b-fw-icon b-icon-filter-less",weight:310,disabled:s.disabled,onItem:()=>o("<")},i.filterDurationMore={text:"L{moreThan}",localeClass:s,icon:"b-fw-icon b-icon-filter-more",weight:320,disabled:s.disabled,onItem:()=>o(">")}}}populateCellMenuWithStringItems({column:e,record:t,items:i}){const r=this.getFilterType(e);if(!/(date|number|duration)/.test(r)){var n,s;const l=this,o=e.getFilterableValue(t),a=(n=(s=e.filterable.filterField)===null||s===void 0?void 0:s.operator)!==null&&n!==void 0?n:"*";i.filterStringEquals={text:"L{equals}",localeClass:l,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",weight:300,disabled:l.disabled,onItem:()=>l.applyFilter(e,{value:o,operator:a})}}}populateCellMenu({column:e,record:t,items:i}){const r=this;e.filterable!==!1&&!t.isSpecialRow&&(r.populateCellMenuWithDateItems(...arguments),r.populateCellMenuWithNumberItems(...arguments),r.populateCellMenuWithDurationItems(...arguments),r.populateCellMenuWithStringItems(...arguments),e.meta.isFiltered&&(i.filterRemove={text:"L{removeFilter}",localeClass:r,icon:"b-fw-icon b-icon-remove",cls:"b-separator",weight:400,disabled:r.disabled||r.isMulti&&!r.columnHasRemovableFilters(e),onItem:()=>r.removeFilter(e)}),r.isMulti&&(i.filterDisable={text:"L{disableFilter}",localeClass:r,icon:"b-fw-icon b-icon-filter-disable",cls:"b-separator",weight:400,disabled:r.disabled||!r.columnHasEnabledFilters(e),onItem:()=>r.disableFilter(e)}))}columnHasRemovableFilters(e){const t=this;return Boolean(t.getCurrentMultiFilters(e).find(i=>!t.canDeleteFilter||t.callback(t.canDeleteFilter,t,[i])!==!1))}columnHasEnabledFilters(e){return Boolean(this.getCurrentMultiFilters(e).find(t=>!t.disabled))}populateHeaderMenu({column:e,items:t}){const i=this;e.meta.isFiltered?(t.editFilter={text:"L{editFilter}",localeClass:i,weight:100,icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:i.disabled,onItem:()=>i.showFilterEditor(e)},t.removeFilter={text:"L{removeFilter}",localeClass:i,weight:110,icon:"b-fw-icon b-icon-remove",disabled:i.disabled||i.isMulti&&!i.columnHasRemovableFilters(e),onItem:()=>i.removeFilter(e)},i.isMulti&&(t.disableFilter={text:"L{disableFilter}",localeClass:i,icon:"b-fw-icon b-icon-filter-disable",weight:115,disabled:i.disabled||!i.columnHasEnabledFilters(e),onItem:()=>i.disableFilter(e)})):e.filterable!==!1&&(t.filter={text:"L{filter}",localeClass:i,weight:100,icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:i.disabled,onItem:()=>i.showFilterEditor(e)})}onStoreBeforeFilter({filters:e}){const{columns:t}=this.client;for(let r=0;r<e.count;r++){const n=e.getAt(r);if(!n.internal){var i;const s=(n.columnOwned||this.prioritizeColumns)&&t.find(l=>l.filterable!==!1&&l.field===n.property);s!=null&&(i=s.filterable)!==null&&i!==void 0&&i.filterFn&&(s.$filter||(s.$filter=new ye({columnOwned:!0,property:n.property,operator:n.operator,value:n.value,filterBy(l){return s.filterable.filterFn({value:this.value,record:l,operator:this.operator,property:this.property,column:s})}})),s.$filter.value=n.value,s.$filter.displayValue=n.displayValue,s.$filter.operator=n.operator,e.splice(r,1,s.$filter))}}}onStoreFilter(){this.refreshHeaders(!1)}renderHeader(){this.refreshHeaders(!1)}onElementClick({target:e}){if(this.filterEditorPopup&&this.closeFilterEditor(),e.classList.contains("b-filter-icon")){const t=e.closest(".b-grid-header");return this.showFilterEditor(t.dataset.columnId),!1}}showFilterEditorByKey({target:e}){const t=e.matches(".b-grid-header")&&e;return t&&this.showFilterEditor(t.dataset.columnId),Boolean(t)}isActionAvailable(e,t,i){const r=i.target.closest(".b-grid-header"),n=r&&this.client.columns.find(s=>s.id===r.dataset.columnId);return Boolean(n?.filterable)}}bc._$name="Filter";Q.registerFeature(bc);const _m={"*":null,isIncludedIn:null,startsWith:null,endsWidth:null};class ol extends ee{static get $name(){return"FilterBar"}static get configurable(){return{prioritizeColumns:!1,keyStrokeFilterDelay:300,compactMode:!1,clearStoreFiltersOnHide:!0,keyMap:{ArrowUp:{handler:"disableGridNavigation",preventDefault:!1},ArrowRight:{handler:"disableGridNavigation",preventDefault:!1},ArrowDown:{handler:"disableGridNavigation",preventDefault:!1},ArrowLeft:{handler:"disableGridNavigation",preventDefault:!1},Enter:{handler:"disableGridNavigation",preventDefault:!1}}}}static get pluginConfig(){return{before:["renderContents"],chain:["afterColumnsChange","renderHeader","populateHeaderMenu","bindStore"]}}static get properties(){return{filterFieldCls:"b-filter-bar-field",filterFieldInputCls:"b-filter-bar-field-input",filterableColumnCls:"b-filter-bar-enabled",filterFieldInputSelector:".b-filter-bar-field-input",filterableColumnSelector:".b-filter-bar-enabled",filterParseRegExp:/^\s*([<>=*])?(.*)$/,storeTrackingSuspended:0}}construct(e,t){if(e.features.filter)throw new Error("Grid.feature.FilterBar feature may not be used together with Grid.feature.Filter, These features are mutually exclusive.");const i=this;i.grid=e,i.onColumnFilterFieldChange=i.onColumnFilterFieldChange.bind(i),super.construct(e,Array.isArray(t)?{filter:t}:t),i.bindStore(e.store),i.filter&&e.store.filter(i.filter),i.gridDetacher=e.ion({beforeElementClick:"onBeforeElementClick",thisObj:i})}bindStore(e){this.detachListeners("store"),e.ion({name:"store",beforeFilter:"onStoreBeforeFilter",filter:"onStoreFilter",thisObj:this})}doDestroy(){var e;this.destroyFilterBar(),(e=this.gridDetacher)===null||e===void 0||e.call(this),super.doDestroy()}doDisable(e){const{columns:t}=this.grid;t?.forEach(i=>{const r=this.getColumnFilterField(i);r&&(r.disabled=e)}),super.doDisable(e)}updateCompactMode(e){this.client.headerContainer.classList[e?"add":"remove"]("b-filter-bar-compact");for(const t in this._columnFilters){const i=this._columnFilters[t];i.placeholder=e?i.column.headerText:null}}destroyFilterBar(){var e;(e=this.grid.columns)===null||e===void 0||e.forEach(this.destroyColumnFilterField,this)}hideFilterBar(){var e;const t=this;t.clearStoreFiltersOnHide&&t.suspendStoreTracking(),(e=t.grid.columns)===null||e===void 0||e.forEach(i=>t.hideColumnFilterField(i,!0)),t.grid.store.filter(),t.clearStoreFiltersOnHide&&t.resumeStoreTracking(),t.hidden=!0}showFilterBar(){this.suspendStoreTracking(),this.renderFilterBar(),this.resumeStoreTracking(),this.hidden=!1}toggleFilterBar(){this.hidden?this.showFilterBar():this.hideFilterBar()}renderFilterBar(){this.grid.hideHeaders||(this.grid.columns.visibleColumns.forEach(e=>this.renderColumnFilterField(e)),this.rendered=!0)}renderColumnFilterField(e){const t=this,{grid:i}=t,r=t.getColumnFilterable(e);if(r&&e.isVisible){const n=e.element,s=i.store.filters.get(e.id)||i.store.filters.getBy("property",e.field);let l=t.getColumnFilterField(e);if(l)t.onColumnFilterFieldChange({source:l,value:l.value}),l.render(n),l.show();else{const o=`${e.filterType||"text"}field`,{filterField:a}=r,d=a?.cls;d&&delete r.filterField.cls,l=lr.append(x.assign({type:o,cls:{[t.filterFieldCls]:1,[d]:d},dataset:{column:e.field},column:e,owner:i,clearable:!0,name:e.field,value:s&&!s._filterBy&&!s.internal?t.buildFilterValue(s):"",inputCls:t.filterFieldInputCls,keyStrokeChangeDelay:t.keyStrokeFilterDelay,onChange:t.onColumnFilterFieldChange,onClear:t.onColumnFilterFieldChange,disabled:t.disabled,placeholder:t.compactMode?e.headerText:null,format:e.format},a),n)[0],a!=null&&a.hasOwnProperty("min")||Object.defineProperty(l,"min",{get:()=>{var h;return(h=e.editor)===null||h===void 0?void 0:h.min},set:()=>null}),a!=null&&a.hasOwnProperty("max")||Object.defineProperty(l,"max",{get:()=>{var h;return(h=e.editor)===null||h===void 0?void 0:h.max},set:()=>null}),a!=null&&a.hasOwnProperty("strictParsing")||Object.defineProperty(l,"strictParsing",{get:()=>{var h;return(h=e.editor)===null||h===void 0?void 0:h.strictParsing},set:()=>null}),l.element.retainElement=!0,t.setColumnFilterField(e,l);const c=a?.store&&(a.store.readUrl||a.store.data||a.store.isChained);if(l.isCombo&&!c&&l.store.count===0){const h=l.value,g=()=>{l.store.readUrl||l.store.isChained||(l.store.data=i.store.getDistinctValues(e.field,!0).map(f=>i.store.modelClass.new({id:f,[e.field]:f})))};l.value=null,l.store.isSorted||l.store.sort({field:e.field,ascending:!0}),l.picker.ion({beforeShow:g}),g(),l.value=h}!t.filter&&l.value&&i.store.autoLoad!==!1&&t.onColumnFilterFieldChange({source:l,value:l.value})}n.classList.add(t.filterableColumnCls)}}updateColumnFilterFields(){const e=this,{columns:t,store:i}=e.grid;let r,n;e._updatingFields=!0;for(const s of t.visibleColumns)r=e.getColumnFilterField(s),r&&(n=i.filters.get(s.id)||i.filters.getBy("property",s.field),n&&!n.internal?n._filterBy?r.value=n.value:r.value=e.buildFilterValue(n):r.value="");e._updatingFields=!1}getColumnFilterable(e){if(!e.isRoot&&e.filterable!==!1&&e.field&&e.isLeaf)return typeof e.filterable=="function"&&(e.filterable={filterFn:e.filterable}),e.filterable}destroyColumnFilterField(e){const t=this.getColumnFilterField(e);t&&(this.hideColumnFilterField(e,!0),t.destroy(),this.setColumnFilterField(e,void 0))}hideColumnFilterField(e,t){const i=this,{store:r}=i.grid,n=e.element,s=i.getColumnFilterField(e);if(s){i.isDestroying||s.hide();const{$filter:l}=e;!r.isDestroyed&&i.clearStoreFiltersOnHide&&l&&r.removeFilter(l,t),n?.classList.remove(i.filterableColumnCls)}}getColumnFilterField(e){var t;return(t=this._columnFilters)===null||t===void 0?void 0:t[e.id]}setColumnFilterField(e,t){this._columnFilters=this._columnFilters||{},this._columnFilters[e.data.id]=t}parseFilterValue(e,t,i){var r;if(Array.isArray(t))return{value:t};if(x.isDate(t))return{operator:i.isDateField?"sameDay":i.isTimeField?"sameTime":"=",value:t};const n=String(t).match(this.filterParseRegExp);return{operator:n[1]||((r=e.filterable)===null||r===void 0?void 0:r.operator)||"*",value:n[2]}}buildFilterValue({operator:e,value:t}){return t instanceof Date||Array.isArray(t)?t:(e in _m?"":e)+t}onStoreBeforeFilter({filters:e}){const{columns:t}=this.client;for(let r=0;r<e.count;r++){var i;const n=e.getAt(r),s=(n.columnOwned||this.prioritizeColumns)&&t.find(l=>l.filterable!==!1&&l.field===n.property);s!=null&&(i=s.filterable)!==null&&i!==void 0&&i.filterFn&&(s.$filter||(s.$filter=new ye({columnOwned:!0,property:n.property,id:s.id,filterBy(l){return s.filterable.filterFn({value:this.value,record:l,property:this.property,column:s})}})),s.$filter.value=n.value,e.splice(r,1,s.$filter))}}onStoreFilter(){!this.storeTrackingSuspended&&this.rendered&&this.updateColumnFilterFields()}afterColumnsChange({changes:e,column:t}){!this.hidden&&e!==null&&e!==void 0&&e.hidden&&(e.hidden.value?this.destroyColumnFilterField(t):this.renderColumnFilterField(t))}suspendStoreTracking(){this.storeTrackingSuspended++}resumeStoreTracking(){this.storeTrackingSuspended--}renderHeader(){this.hidden||this.renderFilterBar()}renderContents(){if(this._columnFilters)for(const e of Object.values(this._columnFilters))e?.element.remove()}disableGridNavigation(e){return!!e.target.matches(this.filterFieldInputSelector)}onBeforeElementClick({event:e}){if(e.target.closest(`.${this.filterFieldCls}`))return!1}onColumnFilterFieldChange({source:e,value:t}){const i=this,{column:r}=e,{filterFn:n}=r.filterable,{store:s}=i.grid,l=r.$filter||s.filters.find(c=>(c.id===r.id||c.property===r.field)&&!c.internal);if(i._updatingFields)return;const o=t==null||t===""||Array.isArray(t)&&t.length===0;if(s.removeFilter(l,!0),r.$filter=null,o){if(!l)return}else{var a,d;r.$filter=s.addFilter(F(F({property:e.name},i.parseFilterValue(r,t,e)),{},{[typeof((a=r.filterable)===null||a===void 0?void 0:a.caseSensitive)=="boolean"?"caseSensitive":void 0]:(d=r.filterable)===null||d===void 0?void 0:d.caseSensitive,[n?"filterBy":"_"]:function(c){return n({value:this.value,record:c,operator:this.operator,property:this.property,column:r})}}),!0)}s.filter()}populateHeaderMenu({items:e}){e.toggleFilterBar={text:this.hidden?"L{enableFilterBar}":"L{disableFilterBar}",localeClass:this,weight:120,icon:"b-fw-icon b-icon-filter",cls:"b-separator",onItem:()=>this.toggleFilterBar()}}}ol.featureClass="b-filter-bar";ol._$name="FilterBar";Q.registerFeature(ol);class al extends ee{static get $name(){return"Group"}static get configurable(){return{field:null,groupSortFn:null,renderer:null,keyMap:{" ":"toggleGroup"}}}construct(e,t){const i=this;e.features.tree||(i._thisIsAUsedExpression(e.features.groupSummary),t=i.processConfig(t),i.grid=e,super.construct(e,t),i.bindStore(e.store),e.rowManager.ion({beforeRenderRow:"onBeforeRenderRow",renderCell:"renderCell",prio:1100,thisObj:i}))}processConfig(e){return typeof e=="string"?{field:e,ascending:null}:e}setConfig(e){e===null?this.store.clearGroupers():super.setConfig(this.processConfig(e))}bindStore(e){this.detachListeners("store"),e.ion({name:"store",group:"onStoreGroup",change:"onStoreChange",thisObj:this})}updateRenderer(e){this.groupRenderer=e}updateField(e){this.store.group({field:e,ascending:this.ascending,fn:this.groupSortFn})}updateGroupSortFn(e){this.isConfiguring||this.store.group({field:this.field,ascending:this.ascending,fn:e})}doDestroy(){super.doDestroy()}doDisable(e){const{store:t}=this;if(e&&t.isGrouped){const{sorters:i}=t;i.unshift(...t.groupers),t.clearGroupers(),t.sort(i)}super.doDisable(e)}get store(){return this.grid.store}static get pluginConfig(){return{assign:["collapseAll","expandAll"],chain:["renderHeader","populateHeaderMenu","getColumnDragToolbarItems","onElementTouchStart","onElementClick","bindStore"]}}toggleCollapse(e,t){this.internalToggleCollapse(e,t)}internalToggleCollapse(e,t,i=!1){const r=this,{store:n,grid:s}=r,l=n.getById(e);!l.isGroupHeader||(t=t===void 0?!l.meta.collapsed:t,s.trigger("beforeToggleGroup",{groupRecord:l,collapse:t})!==!1&&(t?n.collapse(l):n.expand(l),i||(s.rowManager.rowCount>s.store.count?s.rowManager.renderFromRow():s.rowManager.renderFromRecord(l)),s.trigger("toggleGroup",{groupRecord:l,collapse:t}),s.afterToggleGroup()))}collapseAll(){const e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach(t=>e.internalToggleCollapse(t,!0,!0)),e.grid.refreshRows(!0))}expandAll(){const e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach(t=>e.internalToggleCollapse(t,!1,!0)),e.grid.refreshRows())}onBeforeRenderRow({row:e}){const t=e.grid.store.getById(e.id);e.forceInnerHTML=e.forceInnerHTML||t?.isGroupHeader}renderCell(e){const t=this,{cellElement:i,row:r,column:n}=e,{meta:s}=e.record,l={"b-group-row":0,"b-grid-group-collapsed":0};if(!t.disabled&&t.store.isGrouped&&"groupRowFor"in s){if(n.type==="action")return;n.clearCell(i),l["b-grid-group-collapsed"]=s.collapsed,l["b-group-row"]=1,n===t.groupHeaderColumn&&(i.classList.add("b-group-title"),i.$groupHeader=!0),t.buildGroupHeader(e)}else i.$groupHeader&&(i.classList.remove("b-group-title"),i.$groupHeader=!1);r.assignCls(l)}buildGroupHeader(e){const t=this,{record:i,cellElement:r,column:n,persist:s}=e,{grid:l}=t,o=i.meta,{groupRowFor:a}=o,{groupSummary:d}=l.features,c=o.childCount-(d&&d.target!=="header"?1:0);let h=null,g=!0;if(s||n){const f=l.columns.get(o.groupField),m=e.isFirstColumn=n===t.groupHeaderColumn;f!=null&&f.groupRenderer?m&&(h=f.groupRenderer(F(F({},e),{},{groupRowFor:a,groupRecords:i.groupChildren,groupColumn:f,count:c})),g=!1):t.groupRenderer&&(h=t.groupRenderer(F(F({},e),{},{groupRowFor:a,groupRecords:i.groupChildren,groupColumn:f,count:c,isFirstColumn:m}))),m&&h==null&&g&&b.getChildElementCount(r)===0&&(h=_.encodeHtml(`${a==="__novalue__"?"":a} (${c})`))}else t.groupRenderer&&(h=t.groupRenderer(e));return typeof h=="string"?r.innerHTML=h:typeof h=="object"&&J.sync({targetElement:r,domConfig:{onlyChildren:!0,children:B.asArray(h)}}),b.getChildElementCount(r)>0&&(r._hasHtml=!0),r.innerHTML}get groupHeaderColumn(){return this.grid.columns.visibleColumns.find(e=>!e.groupHeaderReserved)}renderHeader(e){const{store:t,grid:i}=this;if(t.isGrouped)for(const r of t.groupers){const n=i.columns.get(r.field),s=n&&i.getHeaderElement(n.id);s?.classList.add("b-group",r.ascending?"b-asc":"b-desc")}}populateHeaderMenu({column:e,items:t}){const i=this;e.groupable!==!1&&(t.groupAsc={text:"L{groupAscending}",localeClass:i,icon:"b-fw-icon b-icon-group-asc",cls:"b-separator",weight:400,disabled:i.disabled,onItem:()=>i.store.group(e.field,!0)},t.groupDesc={text:"L{groupDescending}",localeClass:i,icon:"b-fw-icon b-icon-group-desc",weight:410,disabled:i.disabled,onItem:()=>i.store.group(e.field,!1)}),i.store.isGrouped&&(t.groupRemove={text:"L{stopGrouping}",localeClass:i,icon:"b-fw-icon b-icon-clear",cls:e.groupable?"":"b-separator",weight:420,disabled:i.disabled,onItem:()=>i.store.clearGroupers()})}getColumnDragToolbarItems(e,t){var i;const r=this,{store:n,disabled:s}=r;t.push({text:"L{groupAscendingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-group-asc",ref:"groupAsc",cls:"b-separator",weight:110,disabled:s,onDrop:({column:o})=>n.group(o.field,!0)}),t.push({text:"L{groupDescendingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-group-desc",ref:"groupDesc",weight:110,disabled:s,onDrop:({column:o})=>n.group(o.field,!1)});const l=((i=n.groupers)===null||i===void 0?void 0:i.some(o=>o.field===e.field))&&!s;return t.push({text:"L{stopGroupingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-clear",ref:"groupRemove",disabled:!l,weight:110,onDrop:({column:o})=>n.removeGrouper(o.field)}),t}onStoreGroup({groupers:e}){const{grid:t}=this,{element:i}=t,r=i&&b.children(i,".b-grid-header.b-group");if(i){for(const n of r)n.classList.remove("b-group","b-asc","b-desc");if(e)for(const n of e){const s=t.getHeaderElementByField(n.field);s&&s.classList.add("b-group",n.ascending?"b-asc":"b-desc")}}}onStoreChange({action:e,records:t}){const{client:i}=this,{rowManager:r,store:n}=i;if(n.isGrouped&&e==="move"){const{field:s}=n.groupers[0],l=Math.min(...t.reduce((o,a)=>{if(o.push(n.indexOf(a.instanceMeta(n).groupParent)),s in a.meta.modified){const d=n.groupRecords.find(c=>c.meta.groupRowFor===a.meta.modified[s]);d&&o.push(n.indexOf(d))}return o},[]));r.renderFromRow(r.getRow(l))}}onElementTouchStart(e){const t=this,{target:i}=e,r=i.closest(".b-grid-header"),n=r&&t.grid.getColumnFromElement(r);e.touches.length>1&&n&&n.groupable!==!1&&!t.disabled&&t.store.group(n.field)}onElementClick(e){const t=this,{store:i}=t,{target:r}=e,n=r.closest(".b-group-row"),s=r.closest(".b-grid-header"),l=s?.dataset.column;if(!(r.classList.contains("b-resizer")||t.disabled||r.classList.contains("b-action-item")||e.handled)){if(s&&l){var o;const a=(o=i.groupers)===null||o===void 0?void 0:o.find(d=>d.field===l);if(a&&!e.shiftKey)return i.group(l,!a.ascending),!1;e.shiftKey&&t.grid.columns.get(l).groupable!==!1&&(e.altKey?i.removeGrouper(l):i.group(l))}if(n)return t.internalToggleCollapse(Ae.get(n).id),!1}}toggleGroup(e){var t;const{grid:i}=this,{focusedCell:r}=i;return!this.disabled&&!r.isActionable&&(t=r.record)!==null&&t!==void 0&&t.isGroupHeader?(this.internalToggleCollapse(r.id),!0):!1}}al._$name="Group";Q.registerFeature(al,!0,["Grid","Scheduler"]);Q.registerFeature(al,!1,["TreeGrid"]);var yc=u=>class extends(u||$){static get $name(){return"SummaryFormatter"}generateHtml(t,i,r,n,s,l){const o=this.store,a=t.summaries||(t.sum?[{sum:t.sum,renderer:t.summaryRenderer}]:[]);let d=`<table class="${r}">`;return a.forEach(c=>{let h=c.sum,g=null;switch(h===!0&&(h="sum"),h){case"sum":case"add":g=o.sum(t.field,i);break;case"max":g=o.max(t.field,i);break;case"min":g=o.min(t.field,i);break;case"average":case"avg":g=o.average(t.field,i);break;case"count":g=i.length;break;case"countNotEmpty":g=i.reduce((f,m)=>{const p=m[t.field];return f+(p!=null?1:0)},0);break}if(typeof h=="function"&&(g=i.reduce(h,"seed"in c?c.seed:0)),g!==null){const f="b-grid-summary-value",m=c.label?`<td class="b-grid-summary-label">${c.label}</td>`:"";let p=c.renderer?c.renderer({config:c,sum:g}):g,v;p==null&&(p=""),String(p).includes("<td>")?v=p:v=m?`${m}<td class="${f}">${p}</td>`:`<td colspan="2" class="${f}">${p}</td>`,d+=`<tr>${v}</tr>`}}),d+"</table>"}};class dl extends yc(ee){static get $name(){return"GroupSummary"}static get configurable(){return{collapseToHeader:null,target:"footer"}}construct(e,t){if(this.grid=e,super.construct(e,t),!e.features.group)throw new Error("Requires Group feature to work, please enable");this.bindStore(e.store),e.rowManager.ion({beforeRenderRow:"onBeforeRenderRow",renderCell:"renderCell",prio:1e3,thisObj:this})}bindStore(e){this.detachListeners("store"),e.ion({name:"store",update:"onStoreUpdate",prio:1,thisObj:this})}get store(){return this.grid.store}doDisable(e){this.updateTarget(this.target),super.doDisable(e)}changeTarget(e){return x.assertString(e,"target"),e}updateTarget(e){this.store.useGroupFooters=!this.disabled&&e==="footer",this.isConfiguring||this.store.group()}changeCollapseToHeader(e){return x.assertBoolean(e,"collapseToHeader"),e}updateCollapseToHeader(){this.isConfiguring||this.store.group()}static get pluginConfig(){return{chain:["bindStore"]}}onBeforeRenderRow({row:e,record:t}){e.isGroupFooter&&!("groupFooterFor"in t.meta)?(e.isGroupFooter=!1,e.forceInnerHTML=!0):e.isGroupHeader&&!t.meta.collapsed&&e.eachElement(this.removeSummaryElements)}removeSummaryElements(e){}renderCell({column:e,cellElement:t,row:i,record:r,size:n,isFirstColumn:s}){const l=this,{meta:o}=r,{rowHeight:a}=l.grid,d="groupRowFor"in o,c="groupFooterFor"in o,h=l.target==="header",g={"b-group-footer":0,"b-header-summary":0},f=d&&(h||l.collapseToHeader&&o.collapsed)&&!s||c&&!h;if((d||c)&&(n.height=a),l.store.isGrouped&&f&&!l.disabled){e.clearCell(t);const m=d?r:o.groupRecord;i.isGroupFooter=c,i.isGroupHeader=d,c?g["b-group-footer"]=1:g["b-header-summary"]=1;const p=l.updateSummaryHtml(t,e,m),v=typeof p=="number"?p:p.count;v>1&&(n.height+=o.collapsed&&!h?0:v*a*.1),p.height&&(n.height+=p.height)}i.assignCls(g)}updateSummaryHtml(e,t,i){const r=i.groupChildren.slice();r[r.length-1].isGroupFooter&&r.pop();const n=this.generateHtml(t,r,"b-grid-group-summary",i,i.meta.groupField,i.meta.groupRowFor);return e.children.length?b.sync(n,e.firstElementChild):e.innerHTML=n,t.summaries?t.summaries.length:t.sum?1:0}onStoreUpdate({source:e,changes:t}){if(!this.disabled&&e.isGrouped){if(t&&e.groupers.find(r=>r.field in t))return;Object.keys(t).some(r=>{const n=this.grid.columns.get(r);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))})&&(this.grid.forceFullRefresh=!0)}}refresh(){this.grid.columns.visibleColumns.forEach(e=>{this.hasSummary(e)&&this.grid.refreshColumn(e)})}hasSummary(e){return e.sum||e.summaries}}dl.featureClass="b-group-summary";dl._$name="GroupSummary";Q.registerFeature(dl);class cl extends qs{static get $name(){return"HeaderMenu"}static get configurable(){return{type:"header",items:null,moveColumns:null}}static get defaultConfig(){return{processItems:null}}static get pluginConfig(){const e=super.pluginConfig;return e.chain.push("populateHeaderMenu"),e}shouldShowMenu(e){const{column:t}=e;return t&&t.enableHeaderContextMenu!==!1&&t!==this.client.timeAxisColumn}getDataFromEvent(e){return x.assign(super.getDataFromEvent(e),this.client.getHeaderDataFromEvent(e))}populateHeaderMenu({items:e,column:t}){const i=this;if(t){if(t.headerMenuItems&&x.merge(e,t.headerMenuItems),t.isCollapsible){const{collapsed:r}=t,n=r?i.client.rtl?"left":"right":i.client.rtl?"right":"left";e.toggleCollapse={weight:215,icon:`b-fw-icon b-icon-collapse-${n}`,text:i.L(r?"L{expandColumn}":"L{collapseColumn}"),onItem:()=>t.collapsed=!r}}if(i.moveColumns){const r=i.getColumnToMoveBefore(t),n=i.getColumnToMoveAfter(t);r&&(e.movePrev={weight:220,icon:"b-fw-icon b-icon-column-move-left",text:i.L("L{moveBefore}",_.encodeHtml(r.text)),onItem:()=>{const{parent:s}=t;if(r.parent.insertChild(t,r)){var l;t.region=r.region,(l=s.children)!==null&&l!==void 0&&l.length||s.remove()}}}),n&&(e.moveNext={weight:230,icon:"b-fw-icon b-icon-column-move-right",text:i.L("L{moveAfter}",_.encodeHtml(n.text)),onItem:()=>{const{parent:s}=t;if(n.parent.insertChild(t,n.nextSibling)){var l;t.region=n.region,(l=s.children)!==null&&l!==void 0&&l.length||s.remove()}}})}}return e}getColumnToMoveBefore(e){const{previousSibling:t,parent:i}=e;if(t)return t.children&&!e.children?t.children[t.children.length-1]:t;if(!i.isRoot)return i}getColumnToMoveAfter(e){const{nextSibling:t,parent:i}=e;if(t)return t;if(!i.isRoot)return i}}cl.featureClass="";cl._$name="HeaderMenu";Q.registerFeature(cl,!0);const Hm={mousedown:"mouseDown",mousemove:"mouseMove",mouseup:"mouseUp",touchdown:"touchDown",touchmove:"touchMove",touchup:"touchUp",mouseover:"mouseOver",mouseout:"mouseOut",dblclick:"dblClick",keydown:"keyDown",keypress:"keyPress",keyup:"keyUp",contextmenu:"contextMenu"};class Sn extends ee{constructor(...e){super(...e),T(this,"mergedRanges",[]),T(this,"mergedMap",{})}static get pluginConfig(){return{chain:["beforeRenderCell","afterRenderRow","bindStore","afterColumnsChange","afterRemove","afterToggleGroup","afterToggleSubGrid","handleEvent","populateHeaderMenu","afterSelectionChange"],before:["onInternalResize"],override:["getColumnFromElement","getRecordFromElement"]}}afterConstruct(){const e=this,{client:t}=e;t.eachSubGrid(i=>e.setupSubGrid(i)),t.rowManager.ion({renderDone:"onRenderDone",thisObj:e}),e.bindStore(t.store)}setupSubGrid(e){e.$mergedCellsElement=b.createElement({parent:e.element,className:{"b-grid-merged-cells-container":1}})}doDisable(e){this.isConfiguring||(this.isDisabling=!0,this.reset(),this.isDisabling=!1),super.doDisable(e)}updatePassthrough(e){this.client.element.classList.toggle("b-mergecells-passthrough",e)}bindStore(e){this.detachListeners("store"),e.ion({name:"store",change:"onStoreChange",refresh:{prio:1,fn:"onStoreRefresh"},thisObj:this})}onInternalResize(){this.refreshBounds()}beforeRenderCell(e){const{column:t,record:i,cellElement:r}=e,n=this.client.subGrids[t.region];if(!this.disabled&&t.mergeCells&&t.isSorted&&!i.isSpecialRow&&!n.collapsed){const s=this.getMergeRange(i,t);s!=null&&s.use&&(r.classList.add("b-merged-cell"),r.innerHTML="",e.cellElement=s.cellElement)}}afterRenderRow({row:e,oldId:t,oldHeight:i}){t===e.id&&i!==e.height&&(this.heightChanged=!0)}afterColumnsChange({action:e,changes:t,column:i}){if(!this.disabled){if(e==="update"&&t.mergeCells&&!i.mergeCells){for(const r of this.mergedRanges.slice())r.column===i&&this.removeRange(r);this.syncDom();return}this.refreshBounds()}}afterRemove(){!this.disabled&&this.reset()}afterToggleGroup(){!this.disabled&&this.reset()}afterToggleSubGrid(){!this.disabled&&this.reset()}afterSelectionChange(){if(!this.passthrough){const{client:e}=this,t=e.selectedRecords.map(r=>e.store.indexOf(r));let i=!1;for(const r of this.mergedRanges){let n=!0;for(let s=r.fromIndex;s<=r.toIndex&&n;s++)n=t.includes(s);r.isSelected!==n&&(r.isSelected=n,i=!0)}i&&this.syncDom()}}getRecordFromElement(e){var t;return(t=e.elementData)!==null&&t!==void 0&&t.range?this.client.store.getAt(e.elementData.range.fromIndex):this.overridden.getRecordFromElement(e)}getColumnFromElement(e){var t;return(t=e.elementData)!==null&&t!==void 0&&t.range?e.elementData.range.column:this.overridden.getColumnFromElement(e)}populateHeaderMenu({column:e,items:t}){e.mergeable!==!1&&(t.mergeCells={text:"L{MergeCells.mergeCells}",icon:`b-fw-icon ${e.mergeCells?"b-icon-checked":"b-icon-unchecked"}`,tooltip:"L{MergeCells.menuTooltip}",cls:"b-separator",weight:500,disabled:this.disabled,onItem:()=>e.mergeCells=!e.mergeCells})}async handleEvent(e){if(!this.passthrough){const i=e.target.closest(".b-grid-merged-cells");if(i){var t;const{client:r}=this,{range:n}=i.elementData,{cellEdit:s}=r.features,{column:l}=n,o=_.capitalize((t=Hm[e.type])!==null&&t!==void 0?t:e.type),a={grid:r,records:[],column:l,cellElement:i.firstElementChild,target:e.target,event:e};for(let d=n.fromIndex;d<=n.toIndex;d++)a.records.push(r.store.getAt(d));if(r.trigger(`mergedCell${o}`,a),s?.triggerEvent.toLowerCase()===`cell${o}`.toLowerCase()){const d=r.rowManager.getRowAt(e.clientY);await s.startEditing({id:d.id,columnId:l.id})}else e.type==="click"&&this.onRangeClick({range:n})}}}onRangeClick({range:e}){const t=[];for(let i=e.fromIndex;i<=e.toIndex;i++)t.push(this.client.store.getAt(i));this.client.selectedRecords=t}onStoreChange(){!this.disabled&&this.reset()}onStoreRefresh({action:e}){e!=="filter"&&e!=="dataset"&&!this.disabled&&this.reset(!1)}createRangeElement(e){var t,i,r;const n=this.client.getSubGridFromColumn(e.column).$mergedCellsElement,s=`${e.fromIndex}-@-${e.column.id}`;let l=(t=(i=n.syncIdMap)===null||i===void 0?void 0:i[s])!==null&&t!==void 0?t:(r=n.releasedIdMap)===null||r===void 0?void 0:r[s];return n.releasedIdMap&&delete n.releasedIdMap[s],l||(l=b.createElement(this.createRangeDomConfig(e))),J.addChild(n,l,s),e.element=l,e.cellElement=l.firstElementChild,l}createRangeDomConfig(e){var t;const{column:i,fromIndex:r,toIndex:n,top:s,left:l,width:o,height:a}=e,{type:d}=i,c=this.client.store.getAt(r),h={className:{"b-grid-merged-cells":1,"b-selected":e.isSelected},elementData:{range:e},style:{top:s,left:l,height:a,width:o},dataset:{syncId:`${r}-@-${i.id}`,fromIndex:r,toIndex:n,column:i.field,columnId:i.id},children:[{className:new q(this.client.cellCls).assign({[`b-${d?.toLowerCase()}-cell`]:d,[i.cellCls]:i.cellCls,[i.internalCellCls]:i.internalCellCls}).assign(i.autoCls),keepChildren:!0,elementData:{range:e},dataset:{column:i.field,columnId:i.id},style:{height:this.client.rowManager.rowHeight}}]};return(t=i.mergedRenderer)===null||t===void 0||t.call(i,{domConfig:h,value:i.getRawValue(c),record:c,column:i,fromIndex:r,toIndex:n}),h}buildMergedCellsConfig(e,t,i){var r,n,s,l;const o=this,{client:a}=o,{rowManager:d}=a;e=(r=e)!==null&&r!==void 0?r:(n=d.topRow)===null||n===void 0?void 0:n.dataIndex,t=(s=t)!==null&&s!==void 0?s:(l=d.bottomRow)===null||l===void 0?void 0:l.dataIndex;const c=a.regions.reduce((h,g)=>(h[g]={className:{"b-grid-merged-cells-container":1},children:[]},h),{});for(const h of o.mergedRanges)h.use&&h.fromIndex<=t&&h.toIndex>=e&&(o.updateRange(h,o.heightChanged,i),c[h.column.region].children.push(o.createRangeDomConfig(h)));return c}syncDom(e=!1){const t=this,{client:i}=t,{rowManager:r}=i;if(!e&&!r.topRow||t.disabled&&!t.isDisabling)return;const n=this.buildMergedCellsConfig();i.eachSubGrid(s=>{J.sync({targetElement:s.$mergedCellsElement,syncIdField:"syncId",domConfig:n[s.region]})}),t.heightChanged=!1}onRenderDone(){this.syncDom()}removeRange(e){B.remove(this.mergedRanges,e);for(let t=e.fromIndex;t<=e.toIndex;t++)delete this.mergedMap[`${t}-@-${e.column.id}`]}reset(e=!0){const t=this,i=t.client.columns.visibleColumns.filter(n=>n.mergeCells&&n.isSorted,!0),r=t.mergedRanges.length;if(t.mergedRanges=[],t.mergedMap={},e&&!t.client.refreshSuspended){for(const n of t.client.rowManager.rows)for(const s of i)n.renderCell(n.getCell(s.id));t.syncDom(r&&!t.client.rowManager.rowCount)}}refreshBounds(){const{mergedRanges:e}=this,t=new Map;for(const i of e.slice()){const{column:r}=i,{element:n}=r;if(n){let s=t.get(r);s||t.set(r,s=O.from(n,n.parentElement)),i.left=s.left,i.width=s.width}else this.removeRange(i)}this.syncDom()}updateRange(e,t,i=null){const{store:r,rowManager:n}=this.client,{topRendered:s,bottomRendered:l}=e,{rowOffsetHeight:o}=n;let{fromIndex:a,toIndex:d}=e,c,h;if(t=i?i.length>0:t,!(!t&&s&&l)){if(!s||t){if(i){const f=i.findIndex(m=>m.dataIndex>=a);c=i[f],a=c.dataIndex}else do c=n.getRowById(r.getAt(a));while(!c&&a++<d);e.topRendered=a===e.fromIndex;const g=a-e.fromIndex;e.top=c.top-g*(i?c.offsetHeight:o)}if(!l||t){if(i){const f=i.findIndex(m=>m.dataIndex===d);h=i[f===-1?i.length-1:f],a=h.dataIndex}else do h=n.getRowById(r.getAt(d));while(!h&&d-- >a);e.bottomRendered=d===e.toIndex;const g=e.toIndex-d;e.bottom=h.bottom+g*(i?h.offsetHeight:o)}e.height=e.bottom-e.top}}getMergeRange(e,t){if(e.isSpecialRow)return;const i=this,{mergedMap:r}=i,{store:n}=i.client,s=t.id,l=n.indexOf(e),o=`${l}-@-${s}`;let a=r[o];if(!a){const d=t.getRawValue(e);a=r[o]={column:t},i.mergedRanges.push(a);let c,h,g=l;do c=n.getAt(--g),h=c&&t.getRawValue(c),h===d&&(r[`${g}-@-${s}`]=a);while(c&&h===d);let f,m,p=l;do f=n.getAt(++p),m=f&&t.getRawValue(f),m===d&&(r[`${p}-@-${s}`]=a);while(f&&m===d);if(a.fromIndex=g+1,a.toIndex=p-1,a.toIndex-a.fromIndex>0){const v=O.from(t.element,t.element.parentElement);a.left=v.left,a.width=v.width,a.use=!0}}return!a.element&&a.use&&i.createRangeElement(a),a}}T(Sn,"$name","MergeCells");T(Sn,"configurable",{passthrough:!0});Sn._$name="MergeCells";Q.registerFeature(Sn);class ul extends ee{static get $name(){return"QuickFind"}static get pluginConfig(){return{chain:["onElementKeyPress","onCellNavigate"]}}static get properties(){return{hitCls:"b-quick-hit",hitCellCls:"b-quick-hit-cell",hitCellBadgeCls:"b-quick-hit-cell-badge",hitTextCls:"b-quick-hit-text"}}construct(e,t){super.construct(e,t),Object.assign(this,{grid:e,treeWalker:e.setupTreeWalker(e.element,b.NodeFilter.SHOW_TEXT,()=>b.NodeFilter.FILTER_ACCEPT)})}isActionAvailable(){const{focusedCell:e}=this.grid;return!this.disabled&&e?.record&&!e.isActionable&&this.find.length>0}doDisable(e){e&&this.clear(),super.doDisable(e)}get store(){return this.grid.store}showQuickFind(){const e=this,t=e.grid.getHeaderElement(e.columnId);if(t){if(!e.headerField){const[i,r,n]=b.createElement({tag:"div",className:"b-quick-hit-header",children:[{tag:"div",className:"b-quick-hit-field"},{tag:"div",className:"b-quick-hit-badge"}]},{returnAll:!0});e.mode==="header"?t.appendChild(i):(i.className+=" b-quick-hit-mode-grid",e.grid.element.appendChild(i)),e.headerField={header:i,field:r,badge:n,colHeader:t}}e.headerField.field.innerHTML=e.find,e.headerField.badge.innerHTML=e.found.length,t.classList.add("b-quick-find-header"),e.renderListenerInitialized||(e.grid.rowManager.ion({rendercell:e.renderCell,thisObj:e}),e.renderListenerInitialized=!0)}}hideQuickFind(){const e=this,{grid:t,headerField:i}=e;for(const r of e.prevFound||e.found){const n=t.getRowById(r.id);if(n){n.forceInnerHTML=!0;const s=n.getCell(e.columnId);s._content=null,n.renderCell(s),n.forceInnerHTML=!1}}i&&(i.header.parentNode.removeChild(i.header),i.colHeader.classList.remove("b-quick-find-header"),e.headerField=null),e.renderListenerInitialized&&(t.rowManager.un({rendercell:e.renderCell},e),e.renderListenerInitialized=!1),t.trigger("hideQuickFind")}search(e,t=this.columnId){const i=this,{grid:r}=i,n=r.columns.getById(t)||r.columns.get(t),s=i.store.findByField(n.field,e,n.mergeCells&&n.isSorted);let l=1;Object.assign(i,{foundMap:{},prevFound:i.found,found:s,find:e,columnId:n.id,findRe:new RegExp(`(\\s+)?(${_.escapeRegExp(String(e))})(\\s+)?`,"ig")}),e?i.showQuickFind():i.hideQuickFind();for(const o of b.children(r.element,`.${i.hitCls}`))o.classList.remove(i.hitCls,i.hitCellCls),o._originalContent&&(o.innerHTML=o._originalContent,o._originalContent=null);if(!!s){s.length>0&&i.gotoClosestHit(r.focusedCell,s);for(const o of s){i.foundMap[o.id]=l++;const a=r.getRowById(o.data.id);if(a?.renderCell(a.getCell(n.id)),l>1e3)break}r.trigger("quickFind",{find:e,found:s})}}clear(){var e;(this.find||(e=this.found)!==null&&e!==void 0&&e.length)&&this.search("")}get foundCount(){var e,t;return(e=(t=this.found)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0}gotoHit(e){const t=this.found[e];return t&&this.grid.focusCell({columnId:this.columnId,id:t.id},{doSelect:!0}),!!t}gotoClosestHit(e,t){const i=e?this.grid.store.indexOf(e.id):0,r=t.slice().sort((n,s)=>Math.abs(n.index-i)-Math.abs(s.index-i));this.gotoHit(t.indexOf(r[0]))}gotoFirstHit(){this.gotoHit(0)}gotoLastHit(){this.gotoHit(this.found.length-1)}gotoNextHit(){var e,t,i;const r=this,{grid:n}=r,s=(e=(t=n._focusedCell)===null||t===void 0?void 0:t.id)!==null&&e!==void 0?e:(i=n.lastFocusedCell)===null||i===void 0?void 0:i.id,l=n.store.indexOf(s)||0,o=r.found.find(a=>a.index>l);o?n.focusCell({columnId:r.columnId,id:o.id},{doSelect:!0}):r.gotoFirstHit()}gotoPrevHit(){var e,t,i;const r=this,{grid:n,found:s}=r,l=(e=(t=n._focusedCell)===null||t===void 0?void 0:t.id)!==null&&e!==void 0?e:(i=n.lastFocusedCell)===null||i===void 0?void 0:i.id,o=n.store.indexOf(l)||0;let a;if(!!s.length){for(let d=s.length-1;d--;d>=0)if(s[d].index<o){a=s[d];break}a?n.focusCell({columnId:r.columnId,id:a.id},{doSelect:!0}):r.gotoLastHit()}}renderCell({cellElement:e,column:t,record:i}){var r;const n=this,{classList:s}=e,{treeWalker:l,findRe:o,hitTextCls:a}=n,d=n.columnId===t.id&&((r=n.foundMap)===null||r===void 0?void 0:r[i.id]);if(d){s.add(n.hitCls),e.isQuickHit=!0,e._originalContent=e.innerHTML;const c=l.currentNode=b.down(e,".b-grid-cell-value,.b-tree-cell-value")||e;for(let h=l.nextNode();h&&c.contains(h);){const g=h,f=h.nodeValue,m=["<span>"];h=l.nextNode();let p=o.lastIndex;for(let v=o.exec(f);v;v=o.exec(f)){const y=f.substring(p,v.index),C=v[1]?"\xA0":"",w=v[2],S=v[3]?"\xA0":"";m.push(`${_.encodeHtml(y)}${C}<span class="${a}">${w}</span>${S}`),p=o.lastIndex}m.push(_.encodeHtml(f.substring(p)),"</span>"),g.parentNode.insertBefore(b.createElementFromTemplate(m.join(""),{fragment:!0}),g),g.remove()}b.createElement({parent:e,className:n.hitCellBadgeCls,text:d})}}onBackspace(e){const t=this;return t.find?(t.find=t.find.substr(0,t.find.length-1),t.search(t.find),!0):!1}clearSearch(){return this.find?(this.find="",this.search(this.find),!0):!1}showFilterEditor(){const e=this,{filter:t}=e.client.features;t&&e.columnId&&e.foundCount&&(e.clear(),t.showFilterEditor(e.client.columns.getById(e.columnId),e.find))}onElementKeyPress(e){var t;const i=this,{grid:r}=i,{focusedCell:n}=r;if(!e.handled&&!i.disabled&&n!==null&&n!==void 0&&n.record&&!n.isActionable&&((t=e.key)===null||t===void 0?void 0:t.length)===1){const s=r.columns.getById(r._focusedCell.columnId);s&&s.searchable!==!1&&(i.columnId=r._focusedCell.columnId,i.find+=e.key,i.search(i.find))}}onCellNavigate(e,t,i){const r=this;r.find&&(!i||i.columnId!==r.columnId)&&r.clear()}}T(ul,"configurable",{mode:"header",find:"",keyMap:{F3:"gotoNextHit","Shift+F3":"gotoPrevHit","Ctrl+g":"gotoNextHit","Ctrl+Shift+g":"gotoPrevHit","Ctrl+Shift+f":"showFilterEditor",Escape:"clearSearch",Backspace:"onBackspace"}});ul._$name="QuickFind";Q.registerFeature(ul);class En extends ee{static get pluginConfig(){return{chain:["onElementPointerDown","onElementDblClick","onElementTouchMove","onSubGridCollapse","onSubGridExpand","render"]}}onElementDblClick(e){const t=this,{client:i}=t,r=e.target.closest(".b-grid-splitter-collapsed");if(r&&!t.expanding){t.expanding=!0;let n=r.dataset.region,s=i.getSubGrid(n);s.collapsed||(n=i.getLastRegions()[1],s=i.getSubGrid(n)),s.expand().then(()=>t.expanding=!1)}}startMove(e,t){const i=this,{client:r}=i,n=e.dataset.region,s=r.element,l=r.regions[r.regions.indexOf(n)+1],o=r.getSubGrid(l),a=r.getSubGrid(n);let d=a,c=1;if(d.flex!=null&&o.flex==null&&(d=o,c=-1),r.rtl&&(c*=-1),e.classList.contains("b-grid-splitter-collapsed"))return;const h=d.element.offsetWidth+o.element.offsetWidth;i.dragContext={element:e,headerEl:d.header.element,subGridEl:d.element,subGrid:d,splitterSubGrid:a,originalWidth:d.element.offsetWidth,originalX:t,minWidth:d.minWidth||0,maxWidth:Math.min(h,d.maxWidth||h),flip:c},s.classList.add("b-moving-splitter"),a.toggleSplitterCls("b-moving"),i.pointerDetacher=A.on({element:document,pointermove:"onPointerMove",pointerup:"onPointerUp",thisObj:i})}endMove(){const e=this,{dragContext:t}=e;t&&(e.pointerDetacher(),e.client.element.classList.remove("b-moving-splitter"),t.splitterSubGrid.toggleSplitterCls("b-moving",!1),e.dragContext=null)}onCollapseClick(e,t){const i=this,{client:r}=i,n=t.dataset.region,s=r.getLastRegions();if(s[0]===n){const l=r.getSubGrid(s[1]);if(l.collapsed){l.expand();return}}e.collapse()}onExpandClick(e,t){const i=this,{client:r}=i,n=t.dataset.region,s=r.getLastRegions();if(s[0]===n&&!e.collapsed){r.getSubGrid(s[1]).collapse();return}e.expand()}updateMove(e){const{dragContext:t}=this;if(t){const i=e-t.originalX,r=Math.max(Math.min(t.maxWidth,t.originalWidth+i*t.flip),0);t.subGrid.width=Math.max(r,t.minWidth)}}onElementPointerDown(e){const t=this,{target:i}=e,r=e.button===0&&i.closest(":not(.b-row-reordering):not(.b-dragging-event):not(.b-dragging-task):not(.b-dragging-header):not(.b-dragselecting) .b-grid-splitter"),n=r&&t.client.getSubGrid(r.dataset.region);let s;r&&(i.closest(".b-grid-splitter-button-collapse")?t.onCollapseClick(n,r):i.closest(".b-grid-splitter-button-expand")?t.onExpandClick(n,r):(t.startMove(r,e.clientX),s=r)),e.pointerType==="touch"&&t.toggleTouchSplitter(s)}onPointerMove(e){this.dragContext&&(this.updateMove(e.clientX),e.preventDefault())}onElementTouchMove(e){this.dragContext&&e.preventDefault()}onPointerUp(e){this.dragContext&&(this.endMove(),e.preventDefault())}onSubGridCollapse({subGrid:e}){const t=this.client.resolveSplitter(e);this.client.getLastRegions()[1]===e.region&&t.classList.add("b-grid-splitter-allow-collapse")}onSubGridExpand({subGrid:e}){this.client.resolveSplitter(e).classList.remove("b-grid-splitter-allow-collapse")}toggleTouchSplitter(e){const t=this,{touchedSplitter:i}=t;e&&i&&e.dataset.region!==i.dataset.region&&t.toggleTouchSplitter();const r=t.client.getSubGrid(e?e.dataset.region:i?.dataset.region);r&&(r.toggleSplitterCls("b-touching",Boolean(e)),e?r.startSplitterButtonSyncing():r.stopSplitterButtonSyncing()),t.touchedSplitter=e}render(){const{regions:e,subGrids:t}=this.client;e.length>2&&(t[e[0]].splitterElement.classList.add("b-left-only"),t[e[1]].splitterElement.classList.add("b-right-only"))}}T(En,"$name","RegionResize");En.featureClass="b-split";En._$name="RegionResize";Q.registerFeature(En);class it extends ee{constructor(...e){super(...e),T(this,"entityName","row")}construct(e,t){super.construct(e,t),e.rowManager.ion({beforeRenderRow:"onBeforeRenderRow",thisObj:this}),this.grid=e}onBeforeRenderRow({row:e,record:t}){e.cls["b-cut-row"]=this._isCut&&this.clipboardRecords.includes(t)}isActionAvailable(e,t,i){var r;const{grid:n}=this,{cellEdit:s}=n.features,{target:l}=i;return!this.disabled&&globalThis.getSelection().toString().length===0&&(!s||!s.isEditing)&&((r=n.selectedRecords)===null||r===void 0?void 0:r.length)>0&&(!l||Boolean(l.closest(".b-gridbase:not(.b-schedulerbase) .b-grid-subgrid,.b-grid-subgrid:not(.b-timeaxissubgrid)")))}copy(){this.copyRows()}cut(){this.copyRows(!0)}paste(e){this.pasteRows(e!=null&&e.isModel?e:null)}copyRows(e=!1){const t=this,{client:i,entityName:r}=t,n=t.selectedRecords.filter(s=>!s.readOnly||!e);!n.length||i.readOnly||i.trigger("beforeCopy",{records:n,isCut:e,entityName:r})===!1||(t._isCut=e,t.clipboardRecords.forEach(s=>{var l;return(l=i.rowManager.getRowById(s))===null||l===void 0?void 0:l.removeCls("b-cut-row")}),t.clipboardRecords=n.slice(),i.store.forEach(s=>{s.meta.isCut=t._isCut&&t.clipboardRecords.includes(s)}),n.forEach(s=>this.onRowCutOrCopy(s,e)),i.trigger("copy",{records:n,isCut:e,entityName:r}))}onRowCutOrCopy(e,t){var i;(i=this.client.rowManager.getRowById(e))===null||i===void 0||i.toggleCls("b-cut-row",t)}pasteRows(e){var t,i;const r=this,n=r.clipboardRecords,{client:s,entityName:l}=r,{store:o}=s,a=e||s.selectedRecord;if(s.readOnly||s.isTreeGrouped||!n.length||o.tree&&r._isCut&&n.some(h=>h.contains(a,!0))||s.trigger("beforePaste",{records:n,referenceRecord:a,isCut:r._isCut,entityName:l})===!1)return[];r.sortByIndex(n);const d={},c=r.extractParents(n,d);return r.insertCopiedRecords(c,a),r._isCut?r.clearClipboard():s.selectedRecords=c,s.trigger("paste",{records:c,originalRecords:n,isCut:r._isCut,referenceRecord:a,entityName:l}),(t=s.getRowFor(c[c.length-1]))===null||t===void 0||(i=t.cells)===null||i===void 0||i[0].focus(),c}clearClipboard(){this._isCut&&this.clipboardRecords.forEach(e=>{var t;return(t=this.client.rowManager.getRowById(e))===null||t===void 0?void 0:t.removeCls("b-cut-row")}),this._isCut=!1,this.clipboardRecords=[]}generateNewName(e){const t=e[this.nameField];let i=2;for(;this.client.store.findRecord(this.nameField,`${t} - ${i}`);)i++;return`${t} - ${i}`}insertCopiedRecords(e,t){const{store:i}=this.client,r=i.indexOf(t)+1;if(i.tree)return t.parent.insertChild(e,t.nextSibling,!1,{orderedBeforeNode:t.nextOrderedSibling});if(this._isCut)i.move(e,i.getAt(r));else return i.insert(r,e)}get selectedRecords(){const e=[...this.client.selectedRecords];return this.client.selectedCells.forEach(t=>{e.includes(t.record)||e.push(t.record)}),e}getMenuItemText(e){var t;const i=this;let r=i[e+"RecordText"];return((t=i.client.features.cellCopyPaste)===null||t===void 0?void 0:t.enabled)===!0&&i.client.selectedCells.length&&(r+=` (${i.selectedRecords.length>1?i.rowSpecifierTextPlural:i.rowSpecifierText})`),r}populateCellMenu({record:e,items:t}){const i=this,{client:r}=i;!r.readOnly&&!r.isTreeGrouped&&e?.isSpecialRow===!1&&i.selectedRecords.length&&(t.cut={text:i.getMenuItemText("cut"),localeClass:i,icon:"b-icon b-icon-cut",weight:135,disabled:e.readOnly,onItem:()=>i.cut()},t.copy={text:i.getMenuItemText("copy"),localeClass:i,cls:"b-separator",icon:"b-icon b-icon-copy",weight:120,onItem:()=>i.copy()},t.paste={text:i.getMenuItemText("paste"),localeClass:i,icon:"b-icon b-icon-paste",weight:140,disabled:!i.clipboardRecords.length,onItem:()=>i.paste(e)})}sortByIndex(e){const{store:t}=this.client;return e.sort((i,r)=>{const n=i.indexPath,s=r.indexPath;if(!e.includes(i.parent)&&!e.includes(r.parent))return t.indexOf(i)-t.indexOf(r);if(n.length===s.length){for(let l=0;l<n.length;l++){if(n[l]<s[l])return-1;if(n[l]>s[l])return 1}return 0}else return n.length-s.length})}extractParents(e,t){const i=this,{client:r,_isCut:n}=i;r.store.tree&&e.forEach(l=>{l.traverse(o=>{const a=o.getTopParent(!0);!e.includes(o)&&(!n||!e.some(d=>a.includes(d)))&&e.push(o)})});const s=e.reduce((l,o)=>{let a;const d=o.parentId||o.meta.modified;return n?(a=o,a.meta.isCut=!1):(a=o.copy(),a[i.nameField]=i.generateNewName(a),o.expanded&&(a.data.expanded=o.expanded)),t[o.id]=a,o.parent===r.store.rootNode?l.push(a):d in t?t[d].appendChild(a):l.push(a),l},[]);return s.forEach(l=>{l.sortOrderedChildren(!0,!0)}),s}}T(it,"$name","RowCopyPaste");T(it,"type","rowCopyPaste");T(it,"pluginConfig",{assign:["copyRows","pasteRows"],chain:["populateCellMenu"]});T(it,"properties",{clipboardRecords:[]});T(it,"configurable",{nameField:"name",keyMap:{"Ctrl+C":"copy","Ctrl+X":"cut","Ctrl+V":"paste"},copyRecordText:"L{copyRecord}",cutRecordText:"L{cutRecord}",pasteRecordText:"L{pasteRecord}",rowSpecifierText:"L{row}",rowSpecifierTextPlural:"L{rows}",localizableProperties:["copyRecordText","cutRecordText","pasteRecordText","rowSpecifierText","rowSpecifierTextPlural"]});it.featureClass="b-row-copypaste";it._$name="RowCopyPaste";Q.registerFeature(it,!0,"Grid");Q.registerFeature(it,!1,"Gantt");Q.registerFeature(it,!1,"SchedulerPro");Q.registerFeature(it,!1,"ResourceHistogram");const Nm={remove:1,filter:1,dataset:1,replace:1};class Tn extends ee{static get properties(){return{expanderBodyClass:"b-rowexpander-body",expandedRowClass:"b-rowexpander-row-expanded",recordStateMap:new Map,collapsingRecords:new Set}}static get pluginConfig(){return{chain:["afterColumnsChange","beforeRenderRow","processRowHeight","bindStore"],override:["onGridBodyFocusIn"]}}afterConstruct(){const e=this,{client:t}=e;if(!e.renderer){console.warn("RowExpander requires implementing the renderer function.");return}t.isGanttBase&&t.fixedRowHeight!==!1&&console.warn("When using RowExpander on a Gantt, the Gantt`s fixedRowHeight config must be set to false."),e.bindStore(t.store),e.triggerEvent&&t.ion({[e.triggerEvent]:"onTriggerEvent",thisObj:e}),e.addColumn()}bindStore(e){const t=this;t.recordStateMap.clear(),t.collapsingRecords.clear(),t.detachListeners("clientStoreChange"),e.ion({name:"clientStoreChange",change:t.onStoreChange,thisObj:t})}doDisable(e){const{client:t}=this;e&&(this.recordStateMap.clear(),this.collapsingRecords.clear()),t.isConfiguring||t.rowManager.renderFromRow(),super.doDisable(e)}changeLoadingIndicatorText(e){return e&&this.L(e)}onGridBodyFocusIn(e){var t,i;(t=this.client.lastMousedownEvent)!==null&&t!==void 0&&(i=t.target)!==null&&i!==void 0&&i.closest(".b-rowexpander-body")||this.overridden.onGridBodyFocusIn(e)}get isAnimating(){return this.client.isAnimating}set isAnimating(e){const{client:t}=this,i=t.isAnimating;t.isAnimating=e,t.isAnimating!==i&&t.element.classList.toggle("b-rowexpander-animating")}afterColumnsChange(){this.addColumn()}changeColumn(e){return e==null?e:F(F({type:"action",actions:[{cls:"b-icon b-icon-collapse-down",tooltip:({record:t})=>this.L(this.recordStateMap.has(t)?"L{RowExpander.collapse}":"L{RowExpander.expand}"),onClick:({record:t})=>this.toggleExpand(t)}],width:40,hideable:!1,align:"center",region:this.client.regions[0]},e),{},{field:"expanderActionColumn"})}addColumn(){const e=this,{column:t}=e,{columns:i}=e.client;!e._isAddingExpanderColumn&&t&&(!e._expander||!i.includes(e._expander))&&(e._isAddingExpanderColumn=!0,e.columnPosition==="last"?[e._expander]=i.add(t):[e._expander]=i.insert(0,t),e._isAddingExpanderColumn=!1)}onTriggerEvent({target:e}){this.disabled||e!=null&&e.closest(".b-action-cell")||!e.closest(".b-grid-cell")||this.toggleExpand(this.client.getRecordFromElement(e))}toggleExpand(e){e&&(this.recordStateMap.has(e)?this.collapse(e):this.expand(e))}onStoreChange({action:e,source:t,records:i}){const r=this,{recordStateMap:n,collapsingRecords:s}=r;if(!r.disabled){if(e==="removeAll")n.clear(),s.clear();else if(Nm[e])for(const[l]of n)t.includes(l)||(n.delete(l),s.delete(l));else if(r.refreshOnRecordChange&&i!==null&&i!==void 0&&i.length){if(e==="update"){const l=n.get(i[0]);l!=null&&l.isCreated&&(l.isCreated=!1,r.client.rowManager.renderFromRecord(i[0]))}else if(e==="updatemultiple"){let l,o;for(const a of i){const d=n.get(a);if(d!=null&&d.isCreated){d.isCreated=!1;const c=t.records.indexOf(a);(!o||l>c)&&(l=c,o=a)}}o&&r.client.rowManager.renderFromRecord(o)}}}}processRowHeight(e,t){var i;const r=this.recordStateMap.get(e);if(r){if(!r.isCreated&&r.isRenderingAsync)return this.loadingIndicatorHeight+t;if(!r.expanderBodyHeight)for(const n of this.client.regions){const s=r.expandElements[n].offsetHeight;s>r.expanderBodyHeight&&(r.expanderBodyHeight=s)}}return((i=r?.expanderBodyHeight)!==null&&i!==void 0?i:0)+t}beforeRenderRow({row:e,record:t}){const i=this,{regions:r}=i.client,{expandedRowClass:n}=i;e.cls.toggle("b-rowexpander-disabled",i.disabled),e.cls[n]?i.enableAnimations&&i.isAnimating&&i.collapsingRecords.has(t)?i.waitForTransition(e,()=>{i.collapsingRecords.has(t)&&i.removeExpander(e)}):i.removeExpander(e):i.collapsingRecords.delete(t);const s=i.recordStateMap.get(t);if(!i.disabled&&s){s.isCreated||i.renderExpander(t,e,s),e.cls.add(n);for(const l of r){const o=e.getElement(l);s.isCreated?o.appendChild(s.expandElements[l]):i.renderLoadingIndicator(o,s),i.lockCellHeight(o,s.cellHeight,!1)}i._shouldScrollIntoView&&(i._shouldScrollIntoView=!1,b.isInView(s.expandElements[r[0]],!0)||i.client.rowManager.ion({once:!0,thisObj:i,renderDone:()=>i.scrollRowIntoView(e,t)}))}}scrollRowIntoView(e,t){this.isAnimating?this.waitForTransition(e,()=>this.client.scrollRowIntoView(t)):this.client.scrollRowIntoView(t)}waitForTransition(e,t){A.onTransitionEnd({element:e.element,property:"height",handler:t,thisObj:this})}removeExpander(e){e.cls.remove(this.expandedRowClass);for(const t of this.client.regions){const i=e.getElement(t);i.classList.remove(this.expandedRowClass),b.removeEachSelector(i,"."+this.expanderBodyClass),this.lockCellHeight(i,null,!1)}}renderLoadingIndicator(e,t){b.createElement({parent:e,className:this.expanderBodyClass+" b-rowexpander-loading",style:{top:t.cellHeight,height:this.loadingIndicatorHeight},children:[{tag:"i",className:"b-icon b-icon-spinner"},this.loadingIndicatorText]})}renderExpander(e,t,i){var r;const n=this,s=(r=t.cells[0])===null||r===void 0?void 0:r.offsetHeight,l={},o=[],a=(d,c,h)=>{d!=null&&(typeof d=="string"?c.innerHTML=d:(d=b.createElement(d),c.appendChild(d))),l[h]=c};if(!i.isRenderingAsync){Object.assign(i,{cellHeight:s,expandElements:l,expanderBodyHeight:0});for(const d of n.client.regions){const c=t.getElement(d);t.addCls(n.expandedRowClass);const h=b.createElement({parent:c,className:n.expanderBodyClass,style:{top:s+"px"}}),g=n.renderer({record:e,expanderElement:h,rowElement:c,region:d});N.isPromise(g)?o.push(g.then(f=>a(f,h,d))):a(g,h,d)}o.length?(i.isRenderingAsync=!0,Promise.all(o).then(()=>{var d;i.isCreated=!0,(d=n.renderRowsWithAnimation)===null||d===void 0||d.call(n,e),i.isRenderingAsync=!1})):i.isCreated=!0}}renderRowsWithAnimation(e){const t=this;if(t.enableAnimations){const i=t.client.rowManager.getRowById(e);i&&(t.isAnimating=!0,t.collapsingRecords.has(e)&&i.addCls("b-row-is-collapsing"),t.waitForTransition(i,()=>{if(t.isAnimating=!1,!i.isDestroyed){var r;(r=i.removeCls)===null||r===void 0||r.call(i,"b-row-is-collapsing")}}))}t.client.rowManager.renderFromRecord(e)}lockCellHeight(e,t,i){for(let r=0;r<e.children.length;r++){const n=e.children[r];n.classList.contains(this.expanderBodyClass)||(n.style.height=i?"":t+"px")}}async expand(e){const t=this;t.disabled||await t.trigger("beforeExpand",{record:e})!==!1&&(t.recordStateMap.set(e,{isCreated:!1}),t.collapsingRecords.delete(e),t._shouldScrollIntoView=!0,t.renderRowsWithAnimation(e))}async collapse(e){const t=this;t.disabled||await t.trigger("beforeCollapse",{record:e})!==!1&&(t.recordStateMap.delete(e),t.collapsingRecords.add(e),t.renderRowsWithAnimation(e))}}T(Tn,"$name","RowExpander");T(Tn,"configurable",{renderer:null,triggerEvent:null,column:{},columnPosition:"first",refreshOnRecordChange:!1,loadingIndicatorHeight:100,loadingIndicatorText:"L{loading}",enableAnimations:!0});Tn._$name="RowExpander";Q.registerFeature(Tn);class qt extends Se(ee){construct(e,t){this.grid=e,super.construct(...arguments)}doDestroy(){var e;(e=this.dragHelper)===null||e===void 0||e.destroy(),super.doDestroy()}init(){const e=this,{grid:t}=e;e.dragHelper=Ks.new({name:"rowReorder",cloneTarget:!0,dragThreshold:10,proxyTopOffset:10,targetSelector:".b-grid-row",lockX:!0,dragWithin:t.bodyContainer,allowDropOutside:!0,scrollManager:t.scrollManager,outerElement:e.targetSubGridElement,touchStartDelay:e.touchStartDelay,isElementDraggable:e.isElementDraggable.bind(e),monitoringConfig:{scrollables:[{element:t.scrollable.element,direction:"vertical"}]},setXY(i,r,n){const{context:s}=this;if(!s.started){const l=O.from(s.element,this.dragWithin),o=s.startPageY-window.pageYOffset-s.element.getBoundingClientRect().top;n=l.top+o+this.proxyTopOffset}b.setTranslateXY(i,r,n)},ignoreSamePositionDrop:!1,createProxy(i){const r=i.cloneNode(!0),n=document.createElement("div");if(n.classList.add("b-row-reorder-proxy"),r.removeAttribute("id"),r.style.transform="",n.appendChild(r),t.selectedRecords.length>1){const s=r.cloneNode(!0);s.classList.add("b-row-dragging-multiple"),n.appendChild(s)}return b.removeClsGlobally(n,"b-selected","b-hover","b-focused"),n},internalListeners:{beforedragstart:"onBeforeDragStart",dragstart:"onDragStart",drag:"onDrag",drop:"onDrop",reset:"onReset",prio:1e4,thisObj:e}},e.dragHelperConfig),e.relayEvents(e.dragHelper,["beforeDragStart","dragStart","drag","abort"],"gridRow"),e.dropIndicator=b.createElement({className:"b-row-drop-indicator"}),e.dropOverTargetCls=["b-row-reordering-target","b-hover"]}get targetSubGridElement(){const e=this.grid.regions[0];return this.grid.subGrids[e].element}isElementDraggable(e,t){if(!e.closest(".b-grid-cell .b-widget"))if(this.gripOnly){const i=e.closest(".b-grid-cell:first-child");if(i){const r=getComputedStyle(i,":before"),n=this.grid.rtl?i.getBoundingClientRect().width-t.borderOffsetX:t.borderOffsetX;return b.roundPx(n)<=b.roundPx(parseFloat(r.width))}}else return!0}onBeforeDragStart({event:e,source:t,context:i}){const r=this,{grid:n}=r,s=r.targetSubGridElement;if(r.disabled||n.readOnly||n.isTreeGrouped||!s.contains(i.element))return!1;const l=i.startRecord=n.getRecordFromElement(i.element);if(l.readOnly||l.isSpecialRow)return!1;i.originalRowTop=n.rowManager.getRowFor(l).top,n.selectionMode.checkboxOnly||(t.startEvent.pointerType==="touch"?n.isSelected(l)||n.selectRow({record:l,addToSelection:!1}):!n.isSelected(l)&&!e.shiftKey&&!e.ctrlKey&&n.selectRow({record:l}));const o=n.selectedRecords.filter(a=>!a.readOnly);return i.records=[l],o.includes(l)&&(i.records.push(...o.filter(a=>a!==l)),i.records.sort((a,d)=>n.store.indexOf(a)-n.store.indexOf(d))),!0}onDragStart({context:e}){var t,i;const r=this,{grid:n}=r,{cellEdit:s,cellMenu:l,headerMenu:o}=n.features;s&&(r.cellEditDisabledState=s.disabled,s.disabled=!0),l==null||(t=l.hideContextMenu)===null||t===void 0||t.call(l,!1),o==null||(i=o.hideContextMenu)===null||i===void 0||i.call(o,!1),n.element.classList.add("b-row-reordering");const a=e.element.querySelector(".b-focused");a?.classList.remove("b-focused"),e.element.firstElementChild.classList.remove("b-selected","b-hover"),n.bodyContainer.appendChild(r.dropIndicator)}onDrag({context:e,event:t}){const i=this,{grid:r}=i,{store:n,rowManager:s}=r,{clientY:l}=t;let o=!0,a=s.getRowAt(l),d,c,h,g,f;if(a){const p=a.top+r._bodyRectangle.y-r.scrollable.y,v=a.height/4,y=p+v,C=p+a.height/2,w=p+v*3;c=a.dataIndex,d=n.getAt(c),n.tree?g=(d.isParent||i.dropOnLeaf)&&l>y&&l<w:n.isGrouped&&(g=d.isGroupHeader&&d.meta.collapsed),h=!g&&t.clientY>=C}else t.pageY<r._bodyRectangle.y?(c=0,d=n.first,h=!1):(c=n.count-1,d=n.last,h=!0),a=r.rowManager.getRow(c);if(d===i.overRecord&&i.after===h&&i.over===g){e.valid=i.reorderValid;return}if(i.overRecord!==d){var m;(m=s.getRowById(i.overRecord))===null||m===void 0||m.removeCls(i.dropOverTargetCls)}i.overRecord=d,i.after=h,i.over=g,(d===e.startRecord||!h&&!g&&c===0&&n.isGrouped||h&&d.isGroupHeader&&d.meta.collapsed&&n.indexOf(d)===n.count-1)&&(o=!1),n.tree?(f=h?d.nextSibling:d,e.records.some(p=>p.contains(d))&&(o=!1),e.parent=o&&g?d:d.parent,i.clearTimeout(i.hoverTimer),d&&d.isParent&&!d.isExpanded(n)&&(i.hoverTimer=i.setTimeout(()=>r.expand(d),i.hoverExpandTimeout))):f=h?n.getAt(c+1):d,a.toggleCls(i.dropOverTargetCls,o&&g),!g&&c===n.indexOf(e.startRecord)+(h?-1:1)&&e.parent&&e.startRecord.parent===e.parent&&(o=!1),a&&b.setTranslateY(i.dropIndicator,Math.max(a.top+(h?a.element.getBoundingClientRect().height:0),1)),i.dropIndicator.style.visibility=g?"hidden":"visible",i.dropIndicator.classList.toggle("b-drag-invalid",!o),e.insertBefore=f,e.valid=i.reorderValid=o}async onDrop(e){const t=this,{context:i}=e;i.valid=i.valid&&t.reorderValid,i.valid&&(i.async=!0,t.client.store.tree&&(i.oldPositionContext=i.records.map(n=>{var s;return{record:n,parentId:(s=n.parent)===null||s===void 0?void 0:s.id,parentIndex:n.parentIndex}})),await t.trigger("gridRowBeforeDropFinalize",e)===!1&&(i.valid=!1),await t.dragHelper.animateProxyTo(t.dropIndicator,{align:"l0-l0"}),await t.finalizeReorder(i)),t.clearTimeout(t.hoverTimer),t.overRecord=t.after=t.over=null,t.trigger("gridRowDrop",e)}async finalizeReorder(e){const t=this,{grid:i}=t,{store:r,focusedCell:n}=i;let{records:s}=e;if(e.valid=e.valid&&!s.some(a=>!r.includes(a)),e.valid){let a;if(r.tree){var l,o;s=s.filter(d=>!d.parent||d.bubbleWhile(c=>!s.includes(c),!0)),a=await e.parent.tryInsertChild(s,t.over?(l=e.parent.children)===null||l===void 0?void 0:l[0]:e.insertBefore),i.rowManager.forEach(d=>d.removeCls(t.dropOverTargetCls)),!e.parent.isExpanded()&&(o=e.parent.children)!==null&&o!==void 0&&o.length&&i.expand(e.parent),e.valid=a!==!1}else r.isGrouped&&t.over?r.move(s,r.getAt(r.indexOf(e.insertBefore)+1)):r.move(s,e.insertBefore);n?._rowIndex>=0&&(i._focusedCell=null,i.focusCell({grid:i,record:n.record,columnId:n.columnId})),r.clearSorters()}e.finalize(e.valid),i.element.classList.remove("b-row-reordering")}onReset(){const e=this,{grid:t}=e,i=t.features.cellEdit;t.element.classList.remove("b-row-reordering"),i&&(i.disabled=e.cellEditDisabledState),e.dropIndicator.remove(),b.removeClsGlobally(t.element,...e.dropOverTargetCls)}onPaint({firstPaint:e}){e&&this.init()}updateShowGrip(e){this.grid.element.classList.toggle("b-row-reorder-with-grip",e)}}T(qt,"$name","RowReorder");T(qt,"configurable",{showGrip:null,gripOnly:null,hoverExpandTimeout:1e3,touchStartDelay:300,dropOnLeaf:!1,dragHelperConfig:null});T(qt,"pluginConfig",{after:["onPaint"]});qt.featureClass="";qt._$name="RowReorder";Q.registerFeature(qt,!1);Q.registerFeature(qt,!0,"Gantt");class hl extends Se(ee){static get $name(){return"Search"}static get configurable(){return{limit:1e3,showHitIndex:!0,keyMap:{F3:"gotoNextHit","Ctrl+g":"gotoNextHit","Shift+F3":"gotoPrevHit","Ctrl+Shift+g":"gotoPrevHit"}}}static get properties(){return{hitCls:"b-search-hit",hitCellCls:"b-search-hit-cell",hitCellBadgeCls:"b-search-hit-cell-badge",hitTextCls:"b-search-hit-text"}}construct(e,t){const i=this;super.construct(e,t),Object.assign(i,{grid:e,text:"",hitEls:[],treeWalker:e.setupTreeWalker(e.element,b.NodeFilter.SHOW_TEXT,()=>b.NodeFilter.FILTER_ACCEPT)}),e.ion({expandNode:"onTreeNodeExpand",thisObj:i})}isActionAvailable(){return Boolean(this.text)}onTreeNodeExpand(){this.text&&this.requestAnimationFrame(this.search,[this.text,!1,!0])}doDestroy(){this.clear(!0),super.doDestroy()}doDisable(e){e&&this.clear(),super.doDisable(e)}get store(){return this.grid.store}static get pluginConfig(){return{chain:["populateCellMenu"]}}async search(e,t=!0,i=!1,r){const n=this;if(!e)return n.clear();if(!i&&e===n.text||n.disabled)return;const{grid:s,store:l}=n,o=s.columns.visibleColumns.filter(h=>h.searchable!==!1),a=[];r=r||o.map(h=>{var g;return a.push((g=h.formatValue)===null||g===void 0?void 0:g.bind(h)),h.field});const d=l.search(e,r,a);l.isTree&&d.length&&await s.expandTo(d.map(h=>h.id));for(const h of o)if(h.mergeCells&&h.isSorted){let g=null,f=null;for(const m of d)if(m.field===h.field){const p=m.data[m.field];p===g&&(m.belongsTo=f),g=p,f=`${m.field}-${m.id}`}}let c=1;if(Object.assign(n,{foundMap:{},prevFound:n.found,found:d,text:e,findRe:new RegExp(`(\\s+)?(${_.escapeRegExp(String(e))})(\\s+)?`,"ig")}),n.clearHits(),!!d){for(const h of d)if(n.foundMap[`${h.field}-${h.id}`]=h.belongsTo?n.foundMap[h.belongsTo]:c++,c>n.limit)break;return n.listenersInitialized||(s.rowManager.ion({name:"renderCell",renderCell:"renderCell",thisObj:n}),l.ion({name:"storeRefresh",[`refresh${s.asyncEventSuffix}`]:"onStoreRefresh",thisObj:n}),n.listenersInitialized=!0),s.refreshRows(),s.trigger("search",{grid:s,find:e,found:d}),t&&!n.isHitFocused&&n.gotoNextHit(!0),d}}clearHits(){for(const e of b.children(this.grid.element,"."+this.hitCls)){e.classList.remove(this.hitCls,this.hitCellCls);const t=Ae.get(e).row;t&&(t.forceInnerHTML=!0,t.renderCell(e),t.forceInnerHTML=!1)}}clear(e=!1){const t=this,{grid:i}=t;t.foundMap&&delete t.foundMap,t.text=null,t.clearHits(),t.listenersInitialized&&(this.detachListeners("renderCell"),this.detachListeners("storeRefresh"),t.listenersInitialized=!1),e||i.trigger("clearSearch",{grid:i})}get foundCount(){var e,t;return(e=(t=this.found)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0}get isHitFocused(){var e;const t=this,{grid:i}=t,{focusedCell:r}=i;if(r!=null&&(e=r.cell)!==null&&e!==void 0&&e.contains(b.getActiveElement(i.element))){const{rowIndex:n,column:s}=r;return n!==-1&&t.found.some(l=>l.index===n&&s&&l.field===s.field)}}gotoNextHit(e=!1){var t;const i=this;if(!((t=i.found)!==null&&t!==void 0&&t.length))return;const{grid:r,store:n}=i,s=r.focusedCell||r.lastFocusedCell,l=s&&e!==!0?n.indexOf(s.record,void 0,!0):-1,o=i.found.findIndex(a=>a.index>l);o!==-1&&i.gotoHit(o)}gotoPrevHit(){var e;const t=this,{store:i}=t;if(!((e=t.found)!==null&&e!==void 0&&e.length))return;const{grid:r,found:n}=t,s=r.focusedCell||r.lastFocusedCell,l=s?i.indexOf(s.record,void 0,!0):0;for(let o=n.length-1;o--;o>=0)if(n[o].index<l){t.gotoHit(o);break}}gotoHit(e){const{grid:t}=this,i=this.found[e];return i&&t.focusCell({field:i.field,id:i.id}),Boolean(i)}gotoFirstHit(){this.gotoHit(0)}gotoLastHit(){this.gotoHit(this.found.length-1)}renderCell({cellElement:e,column:t,record:i,value:r}){var n;const s=this,{treeWalker:l,findRe:o,hitTextCls:a,showHitIndex:d}=s,c=(n=s.foundMap)===null||n===void 0?void 0:n[t.field+"-"+i.id];if(c){var h;e.classList.add(s.hitCls),d&&((h=e.querySelector(`.${s.hitCellBadgeCls}`))===null||h===void 0||h.remove());const g=b.down(e,".b-grid-cell-value,.b-tree-cell-value")||e;if(String(r).toLowerCase()===String(s.text).toLowerCase())g.innerHTML=`<span class="${s.hitTextCls}">${g.innerHTML}</span>${d?`<div class="${s.hitCellBadgeCls}">${c}</div>`:""}`;else{l.currentNode=g;for(let f=l.nextNode();f&&g.contains(f);){const m=f,p=f.nodeValue,v=["<span>"];f=l.nextNode();let y=o.lastIndex;for(let C=o.exec(p);C;C=o.exec(p)){const w=p.substring(y,C.index),S=C[1]?"\xA0":"",D=C[2],I=C[3]?"\xA0":"";v.push(`${_.encodeHtml(w)}${S}<span class="${a}">${D}</span>${I}`),y=o.lastIndex}v.push(_.encodeHtml(p.substring(y)),"<span>"),m.parentNode.insertBefore(b.createElementFromTemplate(v.join(""),{fragment:!0}),m),m.remove()}d&&b.createElement({parent:e,className:s.hitCellBadgeCls,text:c})}s.hitEls.push(e)}}populateCellMenu({column:e,record:t,items:i,cellElement:r}){const n=this;e.searchable&&(i.search={text:"L{searchForValue}",localeClass:n,icon:"b-fw-icon b-icon-search",cls:"b-separator",weight:200,disabled:n.disabled,onItem:()=>{let s=globalThis.getSelection().toString();s||(s=r.innerText),n.search(s)}})}onStoreRefresh(){this.search(this.text,!1,!0)}}hl.featureClass="b-search";hl._$name="Search";Q.registerFeature(hl);class fl extends ee{static get $name(){return"Sort"}static get configurable(){return{multiSort:!0,prioritizeColumns:!1}}static get properties(){return{ignoreRe:new RegExp(["b-grid-header-resize-handle","b-filter-icon"].join("|")),sortableCls:"b-sortable",sortedCls:"b-sort",sortedAscCls:"b-asc",sortedDescCls:"b-desc"}}construct(e,t){t=this.processConfig(t),this.grid=e,this.bindStore(this.store),super.construct(e,t)}processConfig(e){return typeof e=="string"||Array.isArray(e)?{field:e,ascending:null}:e}setConfig(e){super.setConfig(this.processConfig(e))}bindStore(e){this.detachListeners("store"),e.ion({name:"store",beforeSort:"onStoreBeforeSort",sort:"syncHeaderSortState",thisObj:this})}set field(e){const t=this.grid.columns.get(e);t&&typeof t.sortable=="object"&&(t.sortable.field=t.sortable.property||e,e=t.sortable),this.store.sort(e,this.ascending)}get store(){return this.grid[this.grid.sortFeatureStore]}static get pluginConfig(){return{chain:["onElementClick","populateHeaderMenu","getColumnDragToolbarItems","renderHeader","onPaint","bindStore"]}}syncHeaderSortState(){const e=this,{grid:t}=e;if(!t.hideHeaders&&t.isPainted){const r=e.store.sorters,n=r.length,s=new q;let l;for(const o of t.columns.visibleColumns){var i;const a=o.element,d=(i=o.textWrapper)===null||i===void 0?void 0:i.dataset;let c="none";d?.sortIndex&&delete d.sortIndex,s.value=a.classList,o.sortable!==!1?(s.add(e.sortableCls),l=r.find(h=>h.field===o.field||h.sortFn&&h.sortFn===o.sortable.sortFn),l?(n>1&&d&&(d.sortIndex=r.indexOf(l)+1),s.add(e.sortedCls),l.ascending?(s.add(e.sortedAscCls),s.remove(e.sortedDescCls),c="ascending"):(s.add(e.sortedDescCls),s.remove(e.sortedAscCls),c="descending")):(s.remove(e.sortedCls),s["b-group"]||(s.remove(e.sortedAscCls),s.remove(e.sortedDescCls)))):s.remove(e.sortableCls),b.syncClassList(a,s),b.setAttributes(a,{"aria-sort":c})}}}populateHeaderMenu({column:e,items:t}){const i=this,{store:r}=i,n=F(F({},e.sortable),{},{field:e.field,columnOwned:!0});if(e.sortable!==!1&&(t.sortAsc={text:"L{sortAscending}",localeClass:i,icon:"b-fw-icon b-icon-sort-asc",cls:"b-separator",weight:300,disabled:i.disabled,onItem:()=>r.sort(n,!0)},t.sortDesc={text:"L{sortDescending}",localeClass:i,icon:"b-fw-icon b-icon-sort-desc",weight:310,disabled:i.disabled,onItem:()=>r.sort(n,!1)},i.multiSort&&i.grid.columns.records.some(s=>s.sortable))){const s=r.sorters.find(l=>l.field===e.field||e.sortable.sortFn&&e.sortable.sortFn===l.sortFn);t.multiSort={text:"L{multiSort}",localeClass:i,icon:"b-fw-icon b-icon-sort",weight:320,disabled:i.disabled,menu:{addSortAsc:{text:s?"L{toggleSortAscending}":"L{addSortAscending}",localeClass:i,icon:"b-fw-icon b-icon-sort-asc",disabled:s&&s?.ascending,weight:330,onItem:()=>r.addSorter(n,!0)},addSortDesc:{text:s?"L{toggleSortDescending}":"L{addSortDescending}",localeClass:i,icon:"b-fw-icon b-icon-sort-desc",disabled:s&&!s.ascending,weight:340,onItem:()=>r.addSorter(n,!1)},removeSorter:{text:"L{removeSorter}",localeClass:i,icon:"b-fw-icon b-icon-remove",weight:350,disabled:!s,onItem:()=>{r.removeSorter(n.field)}}}}}}getColumnDragToolbarItems(e,t){const i=this,{store:r,disabled:n}=i;if(e.sortable!==!1){const s=r.sorters.find(l=>l.field===e.field);t.push({text:"L{sortAscendingShort}",group:"L{sort}",localeClass:i,icon:"b-icon b-icon-sort-asc",ref:"sortAsc",cls:"b-separator",weight:105,disabled:n,onDrop:({column:l})=>r.sort(l.field,!0)},{text:"L{sortDescendingShort}",group:"L{sort}",localeClass:i,icon:"b-icon b-icon-sort-desc",ref:"sortDesc",weight:105,disabled:n,onDrop:({column:l})=>r.sort(l.field,!1)},{text:"L{addSortAscendingShort}",group:"L{multiSort}",localeClass:i,icon:"b-icon b-icon-sort-asc",ref:"multisortAddAsc",disabled:n||s&&s.ascending,weight:105,onDrop:({column:l})=>r.addSorter(l.field,!0)},{text:"L{addSortDescendingShort}",group:"L{multiSort}",localeClass:i,icon:"b-icon b-icon-sort-desc",ref:"multisortAddDesc",disabled:n||s&&!s.ascending,weight:105,onDrop:({column:l})=>r.addSorter(l.field,!1)},{text:"L{removeSorterShort}",group:"L{multiSort}",localeClass:i,icon:"b-icon b-icon-remove",ref:"multisortRemove",weight:105,disabled:n||!s,onDrop:({column:l})=>r.removeSorter(l.field)})}return t}onStoreBeforeSort({sorters:e}){const{columns:t}=this.client;for(let r=0;r<e.length;r++){var i;const n=e[r],s=(n.columnOwned||this.prioritizeColumns)&&t.get(n.field);s!=null&&(i=s.sortable)!==null&&i!==void 0&&i.sortFn&&(e[r]=F(F(F({},n),s.sortable),{},{columnOwned:!0}))}}onElementClick(e){const t=this,{store:i}=t,{target:r}=e,n=r.closest(".b-grid-header.b-sortable"),s=n?.dataset.column;if(!(t.ignoreRe.test(r.className)||t.disabled||e.handled)&&n&&s){const l=t.grid.columns.getById(n.dataset.columnId);if(i.isGrouped&&i.groupers.find(a=>a.field===s)&&!e.shiftKey)return;if(l.sortable&&!e.shiftKey)if(e.ctrlKey&&e.altKey)i.removeSorter(l.field);else{const a={columnOwned:!0,field:l.field};typeof l.sortable=="object"&&x.assign(a,l.sortable),i.sort(a,null,e.ctrlKey)}}}renderHeader(){this.syncHeaderSortState()}onPaint(){this.syncHeaderSortState()}}fl.featureClass="b-sort";fl._$name="Sort";Q.registerFeature(fl,!0);class Cc extends ee{static get $name(){return"StickyCells"}static get defaultConfig(){return{contentSelector:null,currentTopRowCls:"b-sticky-cells-current-top-row"}}static get pluginConfig(){return{before:["renderRows"]}}construct(e,t){super.construct(e,t),e.ion({scroll:"onGridScroll",thisObj:this}),Object.assign(this,b.createElement({reference:"element",parent:e.element,className:"b-grid-sticky-row",children:[{reference:"contentElement",className:"b-grid-cell"}]})),this.removeClasses={"b-focused":!1,"b-hover":!1,"b-selected":!1,[this.currentTopRowCls]:!1}}renderRows(){this.element.classList.add("b-hide-visibility")}onGridScroll(){const e=this,{client:t,element:i,contentElement:r}=e,n=O.client(t.bodyContainer).roundPx(),s=t.rowManager.getRowAt(n.y),l=s!==e.currentTopRow;if(s){l&&(e.currentTopRow&&(e.currentTopRow.removeCls(e.currentTopRowCls),e.currentTopRow.removeCls("b-not-enough-height")),e.currentTopRow=s,s.addCls(e.currentTopRowCls),r.innerHTML="",r.appendChild(e.updateStickyContent()));const o=e.currentTopRow.bottom-e.client.scrollable.y<=e.stickyContentHeight;e.element.classList[o?"add":"remove"]("b-hide-visibility"),e.currentTopRow[o?"addCls":"removeCls"]("b-not-enough-height"),n.y+=e.stickyContentTop,b.alignTo(i,e.stickyEls[0],{align:"t0-t0",constrainTo:n},!0)}e.lastProcessedTopRow=s}updateStickyContent(){const e=this,{currentTopRow:t,removeClasses:i}=e,r={"b-grid-sticky-row":1},n={},s=e.stickyContent||(e.stickyContent=document.createDocumentFragment()),l=e.stickyEls||(e.stickyEls=[]);for(l.forEach(o=>{o.classList.remove("b-sticky-content-el")}),l.length=0,t.eachElement(o=>{l.push(...o.querySelectorAll(e.contentSelector))});s.firstChild;)s.remove(s.firstChild);return e.stickyContentHeight=0,e.stickyContentTop=0,l.map(o=>{o.closest(".b-grid-cell").classList.forEach(c=>n[c]=1),o.closest(".b-grid-row").classList.forEach(c=>r[c]=1),Object.assign(n,i),Object.assign(r,i);const a=o.offsetTop;e.stickyContentTop=Math.max(e.stickyContentTop,a),o.style.alignSelf="flex-end",e.stickyContentHeight=Math.max(e.stickyContentHeight,e.currentTopRow.height-o.offsetTop+a),o.style.alignSelf="";const d=o.cloneNode(!0);return o.classList.add("b-sticky-content-el"),s.appendChild(d),d}),n["b-focused"]=!1,b.syncClassList(e.contentElement,n),b.syncClassList(e.element,r),s}}Cc._$name="StickyCells";Q.registerFeature(Cc,!1);class wc extends ee{static get $name(){return"Stripe"}construct(e,t){super.construct(e,t),e.ion({renderrow:"onRenderRow",thisObj:this})}doDisable(e){this.isConfiguring||this.client.refreshRows(),super.doDisable(e)}onRenderRow({row:e}){const{disabled:t}=this,i=e.dataIndex%2===0;e.assignCls({"b-even":!t&&i,"b-odd":!t&&!i})}}wc._$name="Stripe";Q.registerFeature(wc);class gl extends yc(ee){static get configurable(){return{selectedOnly:null,hideFooters:!1}}static get pluginConfig(){return{chain:["renderRows","bindStore"]}}static get $name(){return"Summary"}construct(e,t){this.grid=e,super.construct(e,t),this.bindStore(e.store),e.hideFooters=this.hideFooters}bindStore(e){this.detachListeners("store"),e.ion({name:"store",change:"onStoreChange",thisObj:this})}get store(){return this.grid.store}doDestroy(){super.doDestroy()}doDisable(e){super.doDisable(e);const{client:t}=this;e?t.element.classList.add("b-summary-disabled"):(this.updateSummaries(),t.element.classList.remove("b-summary-disabled"),t.eachSubGrid(i=>i.scrollable.syncPartners()))}renderRows(){this.updateSummaries()}updateSummaries(){const e=this,{grid:t,store:i}=e,r=b.children(t.element,".b-grid-footer"),n=e.selectedOnly&&t.selectedRecords.length>0,s=(i.isFiltered?i.storage.values:i.allRecords).filter(l=>!l.isSpecialRow&&(!n||t.isSelected(l)));t.columns.forEach(l=>{var o;(o=l.summaries)===null||o===void 0||o.forEach(a=>{"seed"in a&&("initialSeed"in a||(a.initialSeed=a.seed),["number","string","date"].includes(typeof a.initialSeed)?a.seed=a.initialSeed:a.seed=Object.assign({},a.initialSeed))})}),r.forEach(l=>{if(!l.dataset.column)return;const o=t.columns.get(l.dataset.column),a=e.generateHtml(o,s,"b-grid-footer-summary");(o.summaries?o.summaries.length:o.sum?1:0)&&(l.children.length?b.sync(a,l.firstElementChild):l.innerHTML=a)})}onStoreChange({action:e,changes:t}){let i=!0;this.disabled||(e==="update"&&(i=Object.keys(t).some(r=>{const n=this.grid.columns.get(r);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))})),i&&this.updateSummaries())}updateSelectedOnly(e){const t=this;t.detachListeners("selectionChange"),e&&t.grid.ion({name:"selectionChange",selectionChange:t.refresh,thisObj:t}),t.refresh()}refresh(){this.updateSummaries()}}gl.featureClass="b-summary";gl._$name="Summary";Q.registerFeature(gl);const Bm=Promise.resolve();class Ti extends ee.mixin(Se){static get pluginConfig(){return{assign:["collapseAll","expandAll","collapse","expand","expandTo","toggleCollapse"],chain:["onElementPointerUp","onElementClick","bindStore"]}}construct(e,t){super.construct(e,t),this.treeColumn||console.info("To use the tree feature, one column should be configured with `type: 'tree'`"),e.store&&this.bindStore(e.store)}doDisable(e){if(e)throw new Error("Tree feature cannot be disabled")}get store(){return this.client.store}get treeColumn(){const e=this,{columns:t}=e.client;return(!e._treeColumn||!t.includes(e._treeColumn))&&(e._treeColumn=t.find(i=>i.isTreeColumn)),e._treeColumn}bindStore(e){this.detachListeners("store"),e.ion({name:"store",beforeLoadChildren:"onBeforeLoadChildren",loadChildren:"onLoadChildren",loadChildrenException:"onLoadChildrenException",beforeToggleNode:"onBeforeToggleNode",thisObj:this})}async toggleCollapse(e,t,i=!1){if(e==null)throw new Error("Tree#toggleCollapse must be passed a record");const r=this,{store:n,client:s}=r,{rowManager:l}=s,o=n.getById(e),a=o.instanceMeta(n);if(await n.toggleCollapse(o,t)){const d=l.getRowFor(o);if(d&&o.ancestorsExpanded()){const c=r.treeColumn&&!r.treeColumn.subGrid.collapsed&&d.getCell(r.treeColumn.id);c&&d.renderCell(c)}r.isTogglingNode||(s.element.classList.add("b-toggling-node"),r.isTogglingNode=!0,r.requestAnimationFrame(()=>{s.element.classList.remove("b-toggling-node"),r.isTogglingNode=!1})),s.trigger(a.collapsed?"collapseNode":"expandNode",{record:o}),s.trigger("toggleNode",{record:o,collapse:a.collapsed})}}async collapse(e){return this.toggleCollapse(e,!0)}async expand(e){return this.toggleCollapse(e,!1)}onBeforeToggleNode({record:e,collapse:t}){this.client.trigger("beforeToggleNode",{record:e,collapse:t})}onBeforeLoadChildren({source:e,params:t}){const i=e.getById(t[e.modelClass.idField]),r=this.client.rowManager.getRowFor(i);r?.addCls("b-loading-children")}onLoadChildren({source:e,params:t}){const i=e.getById(t[e.modelClass.idField]),r=this.client.rowManager.getRowFor(i);r?.removeCls("b-loading-children")}onLoadChildrenException({record:e}){const t=this.client.rowManager.getRowFor(e);t?.removeCls("b-loading-children")}async expandOrCollapseAll(e=!0,t=this.store.rootNode){const{client:i,store:r}=this,n=[],s=[];return i.trigger("beforeToggleAllNodes",{collapse:e}),r.suspendEvents(),r.traverse(l=>{const o=l.instanceMeta(r);l.isLeaf||(e&&!o.collapsed?(this.toggleCollapse(l,!0,!0),s.push(...l.children)):!e&&o.collapsed&&(Array.isArray(l.children)&&s.push(...l.children),n.push(this.toggleCollapse(l,!1,!0))))},t,t===r.rootNode),r.resumeEvents(),(e?Bm:Promise.all(n)).then(()=>{i.refreshRows(e),s.length&&(e?r.trigger("remove",{records:s,isCollapse:!0,isCollapseAll:!0}):r.trigger("add",{records:s,isExpand:!0,isExpandAll:!0})),i.trigger("toggleAllNodes",{collapse:e})})}async collapseAll(){return this.expandOrCollapseAll(!0)}async expandAll(){return this.expandOrCollapseAll(!1)}async expandTo(e,t=!0){const i=this,{store:r,client:n}=i;if(Array.isArray(e)){if(e.length>0){n.suspendRefresh();for(let d=e.length-1;d>=0;d--){var s;const c=r.getById(e[d]);if(d===0){var l;(l=n.resumeRefresh)===null||l===void 0||l.call(n),n.rowManager.refresh()}await((s=i.expandTo)===null||s===void 0?void 0:s.call(i,c,d===0))}}return}const o=r.getById(e);if(o.instanceMeta(i.store).hiddenByCollapse!==!1){if(!o.ancestorsExpanded()){var a;const d=[];for(let c=o.parent;c&&!c.isRoot;c=c.parent)c.isExpanded(r)||d.unshift(c);for(const c of d)i.isDestroyed||await i.toggleCollapse(c,!1,!0);(a=n.refreshRows)===null||a===void 0||a.call(n)}!i.isDestroyed&&t&&await n.scrollRowIntoView(o)}}onElementPointerUp(e){const t=this,i=e.target,r=t.client.getCellDataFromEvent(e);(i.closest(".b-tree-expander")||t.expandOnCellClick&&r!==null&&r!==void 0&&r.record.isParent)&&t.toggleCollapse(r.record)}onElementClick(e){e.target.closest(".b-tree-expander")&&e.preventDefault()}toggleCollapseByKey(){const{focusedCell:e}=this.client;return e?.rowIndex>-1&&!e.isActionable?(this.toggleCollapse(e.id),!0):!1}expandIfSingleColumn(){return this.client.columns.count===1?this.expandByKey():!1}expandByKey(){const e=this,{client:t}=e,{focusedCell:i}=t,r=i?.record;return i!=null&&i.column.tree&&r.isParent&&r.instanceMeta(t.store).collapsed?(e.expand(r),!0):!1}collapseIfSingleColumn(){return this.client.columns.count===1?this.collapseByKey():!1}collapseByKey(){const e=this,{client:t}=e,{focusedCell:i}=t,r=i?.record;if(i!=null&&i.column.tree){if(r.isParent&&!r.instanceMeta(t.store).collapsed)return e.collapse(r),!0;if(r.parent&&!r.parent.isRoot)return t.deselectAll(),t.focusCell({record:r.parent,column:i.column}),!0}return!1}}T(Ti,"$name","Tree");T(Ti,"configurable",{expandOnCellClick:!1,keyMap:{" ":"toggleCollapseByKey",ArrowRight:"expandIfSingleColumn","Shift+ArrowRight":"expandByKey",ArrowLeft:"collapseIfSingleColumn","Shift+ArrowLeft":"collapseByKey"}});Ti.featureClass="b-tree";Ti._$name="Tree";Q.registerFeature(Ti,!1,"Grid");Q.registerFeature(Ti,!0,"TreeGrid");class Ri extends ee{construct(e,t){if(super.construct(e,t),!e.hasFeature("tree"))throw new Error("The TreeGroup feature requires the Tree feature to be enabled")}processParentData(e){this.parentCls&&(e.cls=this.parentCls)}processTransformedData(e){}async waitForReadiness(){if(this.originalStore.isLoading&&(await this.originalStore.await("load",!1),this.isDestroyed))return;const{crudManager:e}=this.client;if(e){if(e.isLoadingOrSyncing&&(await e.await("requestDone"),this.isDestroyed))return;await this.client.project.commitAsync()}}async applyLevels(e){const t=this,{client:i}=t,r=i.columns.find(l=>l instanceof Ei);let{store:n}=i,s=null;if(t._levels=e,t.isApplying++,i.suspendRefresh(),e&&!t.originalStore&&(t.originalStore=n,n=new n.constructor({tree:!0,modelClass:n.modelClass}),i.store=n),await t.waitForReadiness(),!t.isDestroyed)return e?(n.data=t.originalStore.allRecords.flatMap(l=>l.isLeaf?[l.link()]:[]),s=n.treeify(e,l=>{x.setPath(l,n.modelClass.getFieldDataSource(r.field),l.key),t.processParentData(l)}),t.processTransformedData(s),n.data=s.children):(i.store=t.originalStore,t.originalStore=null),t.isApplying--,i.resumeRefresh(),i.rowManager.reinitialize(),s}updateLevels(e){(e||!this.isConfiguring)&&this.applyLevels(e)}async group(e){x.assertArray(e,"group()"),await this.applyLevels(e)}async clearGroups(){this.isGrouped&&await this.applyLevels(null)}get isGrouped(){return Boolean(this._levels)}}T(Ri,"$name","TreeGroup");T(Ri,"configurable",{levels:null,parentCls:"b-generated-parent"});T(Ri,"pluginConfig",{assign:["group","clearGroups"]});T(Ri,"properties",{isApplying:0,originalStore:null});Ri._$name="TreeGroup";Q.registerFeature(Ri);const _e={all:"all",visible:"visible"},Rn={A6:{width:4.11,height:5.81},A5:{width:5.81,height:8.25},A4:{width:8.25,height:11.69},A3:{width:11.69,height:16.49},Legal:{width:8.5,height:14},Letter:{width:8.5,height:11}},Zi={portrait:"portrait",landscape:"landscape"},ys={pdf:"pdf",png:"png"},Vm={pdf:"application/pdf",png:"image/png"};class xc extends kt{static get $name(){return"ExportRowsCombo"}static get type(){return"exportrowscombo"}static get defaultConfig(){return{editable:!1}}buildItems(){const e=this;return[{id:_e.all,text:e.L("L{all}")},{id:_e.visible,text:e.L("L{visible}")}]}}xc.initClass();xc._$name="ExportRowsCombo";class Sc extends kt{static get $name(){return"ExportOrientationCombo"}static get type(){return"exportorientationcombo"}static get defaultConfig(){return{editable:!1}}buildItems(){const e=this;return[{id:Zi.portrait,text:e.L("L{portrait}")},{id:Zi.landscape,text:e.L("L{landscape}")}]}}Sc.initClass();Sc._$name="ExportOrientationCombo";function ja(u,e=t=>t){return Object.keys(u).map(t=>({id:t,text:e(t)}))}class ml extends ze{static get $name(){return"ExportDialog"}static get type(){return"exportdialog"}static get configurable(){return{autoShow:!1,autoClose:!1,closable:!0,centered:!0,client:null,autoSelectVisibleColumns:!0,hidePNGMultipageOption:!0,title:"L{exportSettings}",maxHeight:"80%",scrollable:{overflowY:!0},defaults:{localeClass:this},items:{columnsField:{type:"combo",label:"L{ExportDialog.columns}",store:{},valueField:"id",displayField:"text",multiSelect:!0,weight:100,maxHeight:100},rowsRangeField:{type:"exportrowscombo",label:"L{ExportDialog.rows}",value:"all",weight:200},exporterTypeField:{type:"combo",label:"L{ExportDialog.exporterType}",editable:!1,value:"singlepage",displayField:"text",buildItems(){const e=this.parent;return e.exporters.map(t=>({id:t.type,text:e.optionalL(t.title,this)}))},onChange({value:e}){this.owner.widgetMap.alignRowsField.hidden=e==="singlepage",this.owner.widgetMap.repeatHeaderField.hidden=e!=="multipagevertical"},weight:300},alignRowsField:{type:"checkbox",label:"L{ExportDialog.alignRows}",checked:!1,hidden:!0,weight:400},repeatHeaderField:{type:"checkbox",label:"L{ExportDialog.repeatHeader}",localeClass:this,hidden:!0,weight:500},fileFormatField:{type:"combo",label:"L{ExportDialog.fileFormat}",localeClass:this,editable:!1,value:"pdf",items:[],onChange({value:e,oldValue:t}){const i=this.parent;if(i.hidePNGMultipageOption){const r=i.widgetMap.exporterTypeField,n=r.store.find(s=>s.id==="singlepage");e===ys.png&&n?(this._previousDisabled=r.disabled,r.disabled=!0,this._previousValue=r.value,r.value="singlepage"):t===ys.png&&this._previousValue&&(r.disabled=this._previousDisabled,r.value=this._previousValue)}},weight:600},paperFormatField:{type:"combo",label:"L{ExportDialog.paperFormat}",editable:!1,value:"A4",items:[],weight:700},orientationField:{type:"exportorientationcombo",label:"L{ExportDialog.orientation}",value:"portrait",weight:800}},bbar:{defaults:{localeClass:this},items:{exportButton:{color:"b-green",text:"L{ExportDialog.export}",weight:100,onClick:"up.onExportClick"},cancelButton:{color:"b-gray",text:"L{ExportDialog.cancel}",weight:200,onClick:"up.onCancelClick"}}}}}construct(e={}){const t=this,{client:i}=e;if(!i)throw new Error("`client` config is required");t.columnsStore=i.columns.chain(r=>r.isLeaf&&r.exportable,null,{excludeCollapsedRecords:!1}),t.applyInitialValues(e),super.construct(e),Te.ion({locale:"onLocaleChange",prio:-1,thisObj:t})}applyInitialValues(e){const t=this,i=e.items=e.items||{};e.width=e.width||t.L("L{width}"),e.defaults=e.defaults||{},e.defaults.labelWidth=e.defaults.labelWidth||t.L("L{ExportDialog.labelWidth}"),i.columnsField=i.columnsField||{},i.fileFormatField=i.fileFormatField||{},i.paperFormatField=i.paperFormatField||{},i.fileFormatField.items=ja(ys,r=>r.toUpperCase()),i.paperFormatField.items=ja(Rn),i.columnsField.store=t.columnsStore}onBeforeShow(){var e;const{columnsField:t,alignRowsField:i,exporterTypeField:r,repeatHeaderField:n}=this.widgetMap;this.autoSelectVisibleColumns&&(t.value=this.columnsStore.query(s=>!s.hidden)),i.hidden=r.value==="singlepage",n.hidden=r.value!=="multipagevertical",(e=super.onBeforeShow)===null||e===void 0||e.call(this,...arguments)}onLocaleChange(){const e=this.L("L{labelWidth}");this.width=this.L("L{width}"),this.eachWidget(t=>{t instanceof xe&&(t.labelWidth=e)})}onExportClick(){const e=this.values;this.trigger("export",{values:e})}onCancelClick(){this.trigger("cancel"),this.hide()}get values(){const e=/field/i,t={};return this.eachWidget(i=>{e.test(i.ref)&&(t[i.ref.replace(e,"")]=i instanceof vi?i.checked:i.value)}),t}}ml.initClass();ml._$name="ExportDialog";const Cs=document.createRange();class pr extends ${static get configurable(){return{cls:{$config:{equal:(e,t)=>e?.isDomClassList&&t?.isDomClassList&&e.isEqual(t)}}}}construct(e){Object.assign(this,{_elements:{},_elementsArray:[],_cells:{},_allCells:[],_regions:[],lastHeight:0,lastTop:-1,_dataIndex:0,_top:0,_height:0,_id:null,forceInnerHTML:!1,isGroupFooter:!1,cellContext:new K({grid:e.grid,id:null,columnIndex:0})}),super.construct(e),this.grid.positionMode==="position"&&(this.translateElements=this.positionElements)}doDestroy(){const e=this;e.rowManager.isDestroying||(e.removeElements(),e.rowManager.idMap[e.id]===e&&delete e.rowManager.idMap[e.id]),super.doDestroy()}get index(){return this._index}set index(e){this._index=e}get dataIndex(){return this._dataIndex}set dataIndex(e){this._dataIndex!==e&&(this._dataIndex=e,this.eachElement(t=>{t.dataset.index=e,t.ariaRowIndex=this.grid.hideHeaders?e+1:e+2}))}get id(){return this._id}set id(e){const t=this,i={id:e},r=t.rowManager.idMap;(t._id!==e||r[e]!==t)&&(r[t._id]===t&&delete r[t._id],r[e]=t,t._id=e,t.eachElement(n=>{Ae.assign(n,i),n.dataset.id=e}),t.eachCell(n=>Ae.assign(n,i)))}addElement(e,t){const i=this;let r=t.firstElementChild;for(i._elements[e]=t,i._elementsArray.push(t),i._regions.push(e),Ae.assign(t,{index:i.index}),i._cells[e]=[];r;)i._cells[e].push(r),i._allCells.push(r),Ae.set(r,{column:r.dataset.column,columnId:r.dataset.columnId,rowElement:r.parentNode,row:i}),r=r.nextElementSibling;t.dataset.index=i.index,t.ariaRowIndex=i.grid.hideHeaders?i.index+1:i.index+2}getElement(e){return this._elements[e]}getRectangle(e){return O.from(this.getElement(e))}eachElement(e){this._elementsArray.forEach(e)}eachCell(e){this._allCells.forEach(e)}get elements(){return this._elements}get element(){const e=Object.keys(this._elements)[0];return this._elements[e]}get cells(){return this._allCells}getCells(e){return this._cells[e]}getCell(e){return this._allCells.find(t=>{const i=Ae.get(t);return i.columnId==e||i.column==e})}removeElements(e=!1){const t=this;t.rowManager.trigger("removeRow",{row:t}),e||t.eachElement(i=>i.remove()),t._elements={},t._cells={},t._elementsArray.length=t._regions.length=t._allCells.length=t.lastHeight=t.height=0,t.lastTop=-1}get height(){return this._height}set height(e){this._height=e}get offsetHeight(){return this.height+this.grid._rowBorderHeight}updateElementsHeight(e){const t=this;e||t.rowManager.storeKnownHeight(t.id,t.height),t.lastHeight!==t.height&&(this.eachElement(i=>i.style.height=`${t.offsetHeight}px`),t.lastHeight=t.height)}addCls(e){this.updateCls(this.cls.add(e))}removeCls(e){this.updateCls(this.cls.remove(e))}toggleCls(e,t){this.updateCls(this.cls[t?"add":"remove"](e))}assignCls(e){this.updateCls(this.cls.assign(e))}changeCls(e){return e!=null&&e.isDomClassList?e:new q(e)}updateCls(e){this.eachElement(t=>b.syncClassList(t,e))}setAttribute(e,t){this.eachElement(i=>i.setAttribute(e,t))}removeAttribute(e){this.eachElement(t=>t.removeAttribute(e))}get isFirst(){return this.dataIndex===0}get top(){return this._top}get bottom(){return this._top+this._height+this.grid._rowBorderHeight}setTop(e,t){this._top!==e&&(this._top=e,this.translateElements(t))}setBottom(e,t){this.setTop(e-this.offsetHeight,t)}translate(e,t=!1){return this.setTop(e,t),e+this.offsetHeight}translateElements(e){const t=this,{top:i,_elementsArray:r}=t;if(t.lastTop!==i){for(let n=0,{length:s}=r;n<s;n++)r[n].style.transform=`translate(0,${i}px)`;!e&&t.rowManager.trigger("translateRow",{row:t}),t.lastTop=i}}positionElements(e){const t=this,{top:i,_elementsArray:r}=t;if(t.lastTop!==i){for(let n=0,{length:s}=r;n<s;n++)r[n].style.top=`${i}px`;!e&&t.rowManager.trigger("translateRow",{row:t}),t.lastTop=i}}offset(e){let t=this._top+e;return t<0&&(e-=t,t=0),this.setTop(t),e}render(e,t,i=!0,r=!1,n=!1){var s,l,o,a;const d=this,{cellContext:c,cls:h,elements:g,cells:f,grid:m,rowManager:p,height:v,_id:y}=d,C=Ae.get(d._elementsArray[0]),w=p._rowHeight,{store:S}=m,{isTree:D}=S;let I=0,R;if(!t&&t!==!1&&(t=m.store.getById(C.id),e=m.store.indexOf(t)),!t)return;const H=(s=t)===null||s===void 0?void 0:s.cls,L=H?H.isDomClassList?H:new q(H):null;h.assign({"b-grid-row-updating":i&&m.transitionDuration&&!n,"b-selected":m.isSelected((l=t)===null||l===void 0?void 0:l.id),"b-readonly":t.readOnly,"b-linked":t.isLinked,"b-original":t.hasLinks}),d.lastRecordCls&&h.remove(d.lastRecordCls),L?(h.add(L),d.lastRecordCls=Object.assign({},L)):d.lastRecordCls=null,p.trigger("beforeRenderRow",{row:d,record:t,recordIndex:e,oldId:y}),m.beforeRenderRow({row:d,record:t,recordIndex:e,oldId:y}),d.updateCls(h),i&&m.transitionDuration&&!n&&m.setTimeout(()=>{d.isDestroyed||(h.remove("b-grid-row-updating"),d.updateCls(h))},m.transitionDuration),d.id=t.id,d.dataIndex=e;const V=!m.fixedRowHeight&&m.getRowHeight(t)||w;let U=d.maxRequestedHeight=null;if(D)for(const Z in g){const ne=g[Z];if(ne.id=`${m.id}-${Z}-${d.id}`,b.setAttributes(ne,{"aria-level":t.childLevel+1,"aria-setsize":t.parent.children.length,"aria-posinset":t.parentIndex+1}),t.isExpanded(S)){var Y,j;b.setAttributes(ne,{"aria-expanded":!0,"aria-owns":(Y=t.children)!==null&&Y!==void 0&&Y.length?(j=t.children)===null||j===void 0?void 0:j.map(X=>`${m.id}-${Z}-${X.id}`).join(" "):null})}else t.isLeaf?ne.removeAttribute("aria-expanded"):ne.setAttribute("aria-expanded",!1),ne.removeAttribute("aria-owns")}for(c._record=t,c._id=t.id,c._rowIndex=e,I=0;I<f.length;I++)c._columnId=f[I].dataset.columnId,c._column=m.columns.getById(c._columnId),c._columnIndex=I,c._cell=f[I],c.height=V,c.maxRequestedHeight=U,c.updatingSingleRow=i,R=d.renderCell(c),p.fixedRowHeight||R.height!=null&&(U=Math.max(U,R.height),R.transient||(d.maxRequestedHeight=U));const z=(o=U)!==null&&o!==void 0?o:V;d.height=(a=m.processRowHeight(t,z))!==null&&a!==void 0?a:z,d.updateElementsHeight(n),i&&!n&&(v!==d.height&&p.translateFromRow(d,r),p.trigger("updateRow",{row:d,record:t,recordIndex:e,oldId:y}),p.trigger("renderDone")),m.afterRenderRow({row:d,record:t,recordIndex:e,oldId:y,oldHeight:v,isExport:n}),p.trigger("renderRow",{row:d,record:t,recordIndex:e,oldId:y,isExport:n}),v&&d.height!==v&&p.trigger("rowRowHeight",{row:d,record:t,height:d.height,oldHeight:v}),d.forceInnerHTML=!1}renderCell(e){var t,i;e.isLocation||(e=new K(e));let{cell:r,record:n}=e;const s=this,{grid:l,column:o,height:a,maxRequestedHeight:d,updatingSingleRow:c=!0,isMeasuring:h=!1}=e,g=(t=l.features)===null||t===void 0?void 0:t.cellEdit,f=Ae.get(r),m=f.rowElement,p=Ae.get(m);if(!n&&(n=e.record=l.store.getById(p.id),!n))return;let v=o.getRawValue(n);const y=n.fieldMap[o.field],C={configuredHeight:a,height:null,maxRequestedHeight:d},w=o.getCellClass(e),S={cellElement:r,dataField:y,rowElement:m,value:v,record:n,column:o,size:C,grid:l,row:f.row,updatingSingleRow:c,isMeasuring:h},D=o.renderer||o.defaultRenderer;l.beforeRenderCell(S),S.cellElement!==r&&(r=S.cellElement),b.syncClassList(r,w);let I=!0;D?(v=D.call(o,S),v===void 0&&o.alwaysClearCell===!1&&(I=!1)):y&&(v=y.print(v));const R=(i=l.hasFrameworkRenderer)===null||i===void 0?void 0:i.call(l,{cellContent:v,column:o});R&&n.isSpecialRow&&(v="");const H=R&&!o.data.tree&&!n.isSpecialRow;if(I&&!H){var L;let U=r;g!=null&&(L=g.editorContext)!==null&&L!==void 0&&L.equals(e)&&!g.editor.isFinishing&&(U=s.moveContentFromCell(r,g.editor.element));const Y=v!=null&&typeof v=="object",j=typeof v=="string",z=Y||v==null?"":String(v);if(s.forceInnerHTML&&(U.innerHTML="",delete U._content,r.lastDomConfig=null),!Y&&o.htmlEncode&&!o.disableHtmlEncode?r._hasHtml?(U.innerText=z,r._hasHtml=!1):b.setInnerText(U,z):o.autoSyncHtml&&(!j||b.getChildElementCount(U))?j?b.sync(z,U.firstElementChild):Y&&J.sync({domConfig:v,targetElement:U}):Y?J.sync({targetElement:U,domConfig:{onlyChildren:!0,children:B.asArray(v)}}):U._content!==z&&(U.innerHTML=U._content=z),U!==r){const{firstChild:Z}=r;for(const ne of U.childNodes)r.insertBefore(ne,Z)}}if(!n.isSpecialRow){var V;(V=l.processCellContent)===null||V===void 0||V.call(l,{cellElementData:f,rendererData:S,rendererHtml:S.rendererHtml||v})}return o.autoHeight&&C.height==null&&(r.classList.add("b-measuring-auto-height"),C.height=Math.max(r.offsetHeight,l.rowHeight),r.classList.remove("b-measuring-auto-height")),h||s.rowManager.trigger("renderCell",S),C}moveContentFromCell(e,t){Cs.setStart(e,0),Cs.setEndBefore(t);const i=document.createElement("div");return i.appendChild(Cs.extractContents()),i}}T(pr,"$name","Row");pr.initClass();pr._$name="Row";class vr extends Se(Me(zt($))){static get defaultConfig(){return{translateURLsToAbsolute:!0,keepPathName:!0,filterStyles:e=>e}}pageTpl(e){const{title:t,header:i,footer:r,styles:n,htmlClasses:s,bodyStyle:l,bodyClasses:o=[],paperHeight:a,paperWidth:d,html:c}=e;return o.push(`b-${this.constructor.type}`),b.scrollBarWidth?o.push("b-visible-scrollbar"):o.push("b-overlay-scrollbar"),W.isChrome?o.push("b-chrome"):W.isSafari?o.push("b-safari"):W.isFirefox&&o.push("b-firefox"),Xe.tpl`
            <!DOCTYPE html>
            <html class="${s}" style="width: ${d}in; height: ${a}in;">
                <head>
                    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
                    <title>${t}</title>
                    ${n.join("")}
                </head>
                <body class="b-export ${o.join(" ")}" style="width: ${d}in; height: ${a}in; ${l}">
                    <div class="b-export-content">
                        ${i&&`<div class="b-export-header" style="width: 100%">${i}</div>`}
                        <div class="b-export-body"><div class="b-export-viewport">${c}</div></div>
                        ${r&&`<div class="b-export-footer" style="width: 100%">${r}</div>`}
                    </div>
                </body>
            </html>`}get stylesheets(){const e=this;if(e._stylesheets)return e._stylesheets;const t=e.translateURLsToAbsolute,i=globalThis.origin,r=Array.from(document.querySelectorAll('link[rel="stylesheet"], style')),n=[];return r.forEach(s=>{if(s=s.cloneNode(!0),t&&s.href){let o;t===!0?o=s.href:this.keepPathName?o=s.href.replace(i,t):o=new URL(s.getAttribute("href"),t),s.setAttribute("href",o)}let l=s.outerHTML;if(t&&/style/i.test(s.tagName)){const o=e.getStyleTagURLConverter(t);l=l.replace(/url\(['"]?(.+?)['"]?\)/g,o)}n.push(l)}),n.push(`<style>
                body, html {
                    overflow: auto;
                }
                body {
                    position: relative;
                    margin: 0;
                }
            </style>`),e._stylesheets=e.filterStyles(n)}set stylesheets(e){this._stylesheets=e&&this.filterStyles(e)}getStyleTagURLConverter(e){return function(t,i){let r;try{let n;/^#/.test(i)?r=t:(e===!0?n=globalThis.location.href:this.keepPathName?n=globalThis.location.href.replace(globalThis.location.origin,e):n=e,r=`url('${new URL(i,n).href}')`)}catch{r=t}return r}.bind(this)}saveState({client:e}){this.state=e.state}async restoreState({client:e}){const t=[],i=new Set;i.add(e.scrollable.ion({scroll(){t.push(e.scrollable.await("scrollEnd"))}})),e.eachSubGrid(({header:r,scrollable:n})=>{i.add(n.ion({scroll(){t.push(n.await("scrollEnd"))}})),i.add(r.scrollable.ion({scroll(){t.push(r.scrollable.await("scrollEnd"))}}))}),e.state=this.state,await Promise.all(t),i.forEach(r=>r())}beforeExport(){this.element=document.createElement("div")}cloneElement(e,t=this.element,i=!0){i&&(t.innerHTML=""),t.appendChild(e.cloneNode(!0)),b.removeEachSelector(t,".b-grid-row,.b-grid-merged-cells-container");const r=t.querySelector(".b-gridbase > .b-mask");r&&r.remove()}createPlaceholder(e,t=!0,i={}){return t&&(e.innerHTML=""),b.createElement(Object.assign({parent:e,id:dn.generateId("export")},i))}prepareElement({client:e}){const{tbar:t,bbar:i}=e;t&&this.element.querySelector(`#${t.id}`).remove(),i&&this.element.querySelector(`#${i.id}`).remove()}measureElement(e=""){e instanceof HTMLElement&&(e=e.outerHTML);const t=b.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:`<div style="height: 1px"></div>${e}<div style="height: 1px"></div>`}),i=t.offsetHeight-2;return t.remove(),i}prepareHTML(e){e instanceof HTMLElement&&(e=e.outerHTML);const t=b.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:e}),i=t.querySelectorAll("img");for(let n=0,s=i.length;n<s;n++)i[n].setAttribute("src",i[n].src);const r=t.innerHTML;return t.remove(),r}getVirtualScrollerHeight(e){let t=0;return e.eachSubGrid(i=>{i.overflowingHorizontally&&(t=b.scrollBarWidth)}),t===0?t:t+1}inchToPx(e){return e*96}getScaleValue(e,t){return Math.floor(e*1e4/t)/1e4}getVisibleRowsCount(e){const t=e.rowManager,i=t.rows.indexOf(t.firstVisibleRow),r=t.rows.indexOf(t.lastVisibleRow);let n;return i!==-1?r===-1?n=e.store.count-i:n=r-i+1:n=e.store.count,n}async export(e){const t=this;let i;t.beforeExport(),t.saveState(e),await t.prepareComponent(e);try{i=await t.getPages(e)}finally{await t.restoreComponent(e),t.stylesheets=null,await new Promise(r=>t.requestAnimationFrame(r)),await t.restoreState(e)}return i}async getPages(e){const t=this.pagesExtractor(e),i=[];let r;for(;(r=await t.next())&&!r.done;)i.push(r.value);return i}adjustRowBuffer(e){const{contentHeight:t}=this.exportMeta,{rowManager:i}=e;this.oldRowManagerConfig={prependRowBuffer:i.prependRowBuffer,appendRowBuffer:i.appendRowBuffer};const r=Math.ceil(t/i.rowOffsetHeight);i.prependRowBuffer=r,i.appendRowBuffer=r,e.renderRows(),e.rowManager.jumpToPosition(e.scrollable.y)}restoreRowBuffer(e){e.rowManager.prependRowBuffer=this.oldRowManagerConfig.prependRowBuffer,e.rowManager.appendRowBuffer=this.oldRowManagerConfig.appendRowBuffer}async prepareComponent(e){const t=this,{client:i,columns:r,rowsRange:n,keepRegionSizes:s,enableDirectRendering:l}=e,{rowManager:o}=i,a=t.exportMeta={enableDirectRendering:l,totalWidth:0,totalHeight:0-(l?0:t.getVirtualScrollerHeight(i)),subGrids:{}};i.columns.forEach(h=>{r.includes(h.id)?h.show():h.hide()}),await new Promise(h=>i.requestAnimationFrame(h)),i.rowManager.rowCount>0&&(n===_e.all?a.firstVisibleDataIndex=o.rows[0].dataIndex:(a.firstVisibleDataIndex=o.firstVisibleRow.dataIndex,e.alignRows=!0),l||await i.scrollRowIntoView(i.store.getAt(a.firstVisibleDataIndex),{block:"start"}));const{element:d}=t;t.cloneElement(i.element),t.prepareElement(e);let c;l&&(a.fakeRow=c=new pr({cls:i.rowCls,rowManager:i.rowManager,grid:i,index:-10,dataIndex:-10})),i.eachSubGrid(h=>{var g,f,m;c&&(h.onAddRow({rows:[c],isExport:!0}),c.element.dataset.ownerCmp=i.id);const p=t.createPlaceholder(d.querySelector(`[id="${h.id}"]`),!1);let v;s!=null&&s[h.region]?v=h.element.offsetWidth:v=h.columns.visibleColumns.reduce((C,w)=>(typeof w.width=="number"?C+=w.width:C+=(i.hideHeaders?i.rowManager.rows[0].getCell(w.id):w.element).offsetWidth,C),0),a.totalWidth+=v;const y=((g=h.splitterElement)===null||g===void 0?void 0:g.offsetWidth)||0;a.totalWidth+=y,a.subGrids[h.region]={id:h.id,headerId:((f=h.header)===null||f===void 0?void 0:f.id)||null,footerId:((m=h.footer)===null||m===void 0?void 0:m.id)||null,rows:[],splitterWidth:y,placeHolder:p,width:v}})}prepareExportElement(){const e=this,{element:t,exportMeta:i}=e;return Object.values(i.subGrids).forEach(({width:r,id:n,headerId:s,footerId:l})=>{[n,s,l].forEach(o=>{if(o){const a=t.querySelector(`[id="${o}"]`);a&&(a.style.width=`${r}px`,a.style.flex="")}})}),t.innerHTML}async restoreComponent(e){this.exportMeta.fakeRow&&(this.exportMeta.fakeRow.destroy(),delete this.exportMeta.fakeRow)}async scrollRowIntoView(e,t){await e.scrollRowIntoView(e.store.getAt(t),{block:"start"}),await new Promise(i=>this.requestAnimationFrame(i))}collectRow(e){const t=this.exportMeta.subGrids,i=/data-owner-cmp=".+?"/;Object.entries(e.elements).forEach(([r,n])=>{t[r].rows.push([n.outerHTML.replace(i,""),e.top,e.offsetHeight,new Map])})}renderMergedCells(e,t,i,r){const n=this,{client:s}=e,{subGrids:l}=n.exportMeta,o=s.features.mergeCells.buildMergedCellsConfig(t,i,r);for(const a in l){const d=l[a],c=document.createElement("div");J.sync({targetElement:c,domConfig:{children:o[a].children}}),c.childNodes.length&&(c.childNodes.forEach(h=>{const{syncId:g}=h.dataset,f=s.features.mergeCells.mergedRanges.find(m=>{var p;return((p=m.cellElement)===null||p===void 0?void 0:p.parentNode.dataset.syncId)===g});f&&(h.innerHTML=f.cellElement.outerHTML)}),d.mergedCellsHtml=[c.innerHTML])}}}vr.prototype.pagesExtractor=async function*(){throw new Error("Implement this method in a subclass")};vr._$name="Exporter";class ln extends vr{static get $name(){return"MultiPageExporter"}static get type(){return"multipage"}static get title(){return this.L("L{multipage}")}static get exportingPageText(){return"L{exportingPage}"}async stateNextPage({client:e,rowsRange:t,enableDirectRendering:i}){const{exportMeta:r}=this;++r.currentPage,++r.verticalPosition,delete r.lastExportedRowBottom,r.verticalPosition>=r.verticalPages&&(Object.assign(r,{verticalPosition:0,horizontalPosition:r.horizontalPosition+1,currentPageTopMargin:0,lastTop:0,lastRowIndex:t===_e.visible?e.rowManager.firstVisibleRow.dataIndex:0}),delete r.lastRowDataIndex,i||await this.scrollRowIntoView(e,r.firstVisibleDataIndex,{block:"start"}))}async prepareComponent(e){await super.prepareComponent(e);const t=this,{exportMeta:i}=t,{client:r,headerTpl:n,footerTpl:s,alignRows:l,rowsRange:o,enableDirectRendering:a}=e,d=Rn[e.paperFormat],c=e.orientation===Zi.portrait,h=c?d.width:d.height,g=c?d.height:d.width,f=t.inchToPx(h),m=t.inchToPx(g),p=o===_e.visible,v=Math.ceil(i.totalWidth/f);let y=m;n&&(y-=t.measureElement(n({totalWidth:i.totalWidth,totalPages:-1,currentPage:-1}))),s&&(y-=t.measureElement(s({totalWidth:i.totalWidth,totalPages:-1,currentPage:-1})));let C,w,S=r.store.count;if(p?(S=t.getVisibleRowsCount(r),C=i.totalHeight+r.headerHeight+r.footerHeight+r.bodyHeight):C=i.totalHeight+r.headerHeight+r.footerHeight+r.scrollable.scrollHeight,l&&!p){const D=r.rowManager.rowOffsetHeight,I=Math.floor((y-r.headerHeight)/D),R=Math.floor(y/D),H=S-I;w=1+Math.ceil(H/R)}else w=Math.ceil(C/y);Object.assign(i,{paperWidth:h,paperHeight:g,pageWidth:f,pageHeight:m,horizontalPages:v,verticalPages:w,totalHeight:C,contentHeight:y,totalRows:S,totalPages:v*w,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0,lastTop:0,lastRowIndex:p?r.rowManager.firstVisibleRow.dataIndex:0}),a||this.adjustRowBuffer(r)}async restoreComponent(e){await super.restoreComponent(e),e.enableDirectRendering||this.restoreRowBuffer(e.client)}async collectRows(e){const t=this,{exportMeta:i}=t,{client:r,alignRows:n,rowsRange:s}=e,{subGrids:l,currentPageTopMargin:o,verticalPosition:a,contentHeight:d,totalRows:c,lastRowDataIndex:h}=i,{rowManager:g}=r,{rows:f}=g,m=s===_e.visible,p=r.hasActiveFeature("mergeCells");let v,y;m&&h!=null?h===f[f.length-1].dataIndex?y=f.length-1:y=f.findIndex(R=>R.dataIndex===h):y=m?f.findIndex(R=>R.bottom>Math.ceil(r.scrollable.y)):f.findIndex(R=>R.bottom+o+r.headerHeight>0);const C=y,w=m||a===0?0:f[y].top+o+r.headerHeight;v=d-w,a===0&&(v-=r.headerHeight);let S,D=0;for(;v>0;){const R=f[y];n&&v<R.offsetHeight?(D=-v,v=0,t.exportMeta.lastExportedRowBottom=f[y-1].bottom):(t.collectRow(R),v-=R.offsetHeight,S=R.dataIndex,(++y===f.length&&v>0||m&&y-C===c)&&(v=0))}if(p)for(const R in l){const H=l[R],L=r.subGrids[R].element.querySelectorAll(".b-grid-merged-cells");H.mergedCellsHtml=[];for(const V of L)H.mergedCellsHtml.push(V.outerHTML)}const I=f[y-1];if(I&&(i.exactGridHeight=I.bottom+r.footerContainer.offsetHeight+r.headerContainer.offsetHeight,i.lastRowDataIndex=I.dataIndex+1),await t.onRowsCollected(f.slice(C,y),e),m)i.exactGridHeight-=i.scrollableTopMargin=r.scrollable.y;else{const R=g.ion({offsetRows:({offset:H})=>D+=H});await t.scrollRowIntoView(r,S+1),R()}return D}async renderRows(e){const t=this,{exportMeta:i}=t,{client:r,alignRows:n,rowsRange:s}=e,{currentPageTopMargin:l,verticalPosition:o,contentHeight:a,totalRows:d,lastRowIndex:c,fakeRow:h}=i,{store:g}=r,f=r.hasActiveFeature("mergeCells"),m=s===_e.visible;let p=c,{lastTop:v}=i,y;const C=p,w=m||o===0?0:v+l+r.headerHeight,S=[];y=a-w,o===0&&(y-=r.headerHeight);let D,I,R=0;for(;y>0;)h.render(p,g.getAt(p),!0,!1,!0),n&&y<h.offsetHeight?(R=-y,y=0,t.exportMeta.lastExportedRowBottom=v):(I=v,D=p,v=h.translate(v),y-=h.offsetHeight,t.collectRow(h),S.push({top:h.top,bottom:h.bottom,offsetHeight:h.offsetHeight,dataIndex:h.dataIndex}),(++p===g.count&&y>0||m&&p-C===d)&&(y=0));return f&&t.renderMergedCells(e,C,p,S),i.lastRowIndex=n?p:D,i.lastTop=n?v:I,h&&(i.exactGridHeight=h.bottom+r.footerContainer.offsetHeight+r.headerContainer.offsetHeight),await t.onRowsCollected(S,e),R}async buildPage(e){const t=this,{exportMeta:i}=t,{client:r,headerTpl:n,footerTpl:s,enableDirectRendering:l}=e,{totalWidth:o,totalPages:a,currentPage:d,subGrids:c}=i;Object.values(c).forEach(p=>p.rows=[]),e.rowsRange===_e.all&&(i.totalHeight=r.height-r.bodyHeight+r.scrollable.scrollHeight-t.getVirtualScrollerHeight(r));let h,g;n&&(h=t.prepareHTML(n({totalWidth:o,totalPages:a,currentPage:d}))),s&&(g=t.prepareHTML(s({totalWidth:o,totalPages:a,currentPage:d})));let f;return l?f=await t.renderRows(e):f=await t.collectRows(e),{html:t.buildPageHtml(e),header:h,footer:g,offset:f}}async onRowsCollected(){}buildPageHtml(){const e=this,{subGrids:t}=e.exportMeta;let i=e.prepareExportElement();return Object.values(t).forEach(({placeHolder:r,rows:n,mergedCellsHtml:s})=>{const l=r.outerHTML;let o=n.reduce((a,d)=>(a+=d[0],a),"");s!=null&&s.length&&(o+=`<div class="b-grid-merged-cells-container">${s.join("")}</div>`),i=i.replace(l,o)}),i}prepareExportElement(){const e=this,{element:t,exportMeta:i}=e;return i.scrollableTopMargin&&(t.querySelector(".b-grid-vertical-scroller").style.marginTop=`-${i.scrollableTopMargin}px`),super.prepareExportElement()}}ln.prototype.pagesExtractor=async function*(e){const t=this,{exportMeta:i,stylesheets:r}=t,{totalWidth:n,totalPages:s,paperWidth:l,paperHeight:o,contentHeight:a}=i;let d;for(;(d=i.currentPage)<s;){t.trigger("exportStep",{text:t.L(ln.exportingPageText,{currentPage:d,totalPages:s}),progress:Math.round((d+1)/s*90)});const{html:c,header:h,footer:g,offset:f}=await t.buildPage(e),m=[...r,`
                <style>
                    #${e.client.id} {
                        height: ${i.exactGridHeight}px !important;
                        width: ${n}px !important;
                    }
                    .b-export-body .b-export-viewport {
                        margin-inline-start : ${-l*i.horizontalPosition}in;
                        margin-top  : ${i.currentPageTopMargin}px;
                    }
                </style>
            `];i.currentPageTopMargin-=a+f,await t.stateNextPage(e),yield{html:t.pageTpl({html:c,header:h,footer:g,styles:m,paperWidth:l,paperHeight:o})}}};ln._$name="MultiPageExporter";class on extends vr{static get $name(){return"MultiPageVerticalExporter"}static get type(){return"multipagevertical"}static get title(){return this.L("L{multipagevertical}")}static get exportingPageText(){return"L{exportingPage}"}async stateNextPage({client:e}){const{exportMeta:t}=this,{totalRows:i,processedRows:r,totalPages:n}=t;++t.currentPage,++t.verticalPosition,t.currentPage===n&&r.size!==i&&(++t.totalPages,++t.verticalPages)}estimateTotalPages(e){const t=this,{exportMeta:i}=t,{client:r,headerTpl:n,footerTpl:s,alignRows:l,rowsRange:o,repeatHeader:a,enableDirectRendering:d}=e,{pageWidth:c,pageHeight:h,totalWidth:g}=i,f=t.getScaleValue(c,g);let m=0-t.getVirtualScrollerHeight(r)+r.height-r.bodyElement.offsetHeight+r.scrollable.scrollHeight,p=h/f,v=r.store.count,y=0,C=m,w;if(n&&(p-=t.measureElement(n({totalWidth:g,totalPages:-1,currentPage:-1}))),s&&(p-=t.measureElement(s({totalWidth:g,totalPages:-1,currentPage:-1}))),a&&(p-=r.headerHeight+r.footerHeight,m-=r.headerHeight+r.footerHeight),o===_e.visible){const S=r.rowManager,D=S.firstVisibleRow,I=S.lastVisibleRow;d||(y=D.top),v=t.getVisibleRowsCount(r),d?(m=r.headerHeight+r.footerHeight+I.bottom-D.top,C=I.bottom-D.top):C=m=m-r.scrollable.scrollHeight+I.bottom-D.top,i.lastRowIndex=D.dataIndex,i.finishRowIndex=I.dataIndex}else i.finishRowIndex=r.store.count-1;if(l&&!a&&o!==_e.visible){const S=r.rowManager.rowOffsetHeight,D=Math.floor((p-r.headerHeight)/S),I=Math.floor(p/S),R=v-D;w=1+Math.ceil(R/I)}else w=Math.ceil(C/p);Object.assign(i,{scale:f,contentHeight:p,totalRows:v,totalHeight:m,verticalPages:w,initialScroll:y,horizontalPages:1,totalPages:w})}async prepareComponent(e){await super.prepareComponent(e);const t=this,{exportMeta:i}=t,{client:r}=e,n=Rn[e.paperFormat],s=e.orientation===Zi.portrait,l=s?n.width:n.height,o=s?n.height:n.width,a=t.inchToPx(l),d=t.inchToPx(o);Object.assign(i,{paperWidth:l,paperHeight:o,pageWidth:a,pageHeight:d,horizontalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0,lastTop:0,lastRowIndex:0,processedRows:new Set}),t.estimateTotalPages(e),e.enableDirectRendering||t.adjustRowBuffer(r)}async restoreComponent(e){await super.restoreComponent(e),e.enableDirectRendering||this.restoreRowBuffer(e.client)}async collectRows(e){const t=this,{exportMeta:i}=t,{client:r,alignRows:n,repeatHeader:s}=e,{subGrids:l,currentPageTopMargin:o,verticalPosition:a,totalRows:d,contentHeight:c}=i,h=s?0:r.headerHeight,{rowManager:g}=r,{rows:f}=g,m=e.rowsRange===_e.visible,p=r.hasActiveFeature("mergeCells");let v=m?f.findIndex(R=>R.bottom>r.scrollable.y):f.findIndex(R=>R.bottom+o+h>0),y;const C=v,w=a===0?0:f[v].top+o+h;y=c-w,a===0&&(y-=h);let S,D=0;for(;y>0;){const R=f[v];n&&y<R.offsetHeight?(D=-y,y=0):(t.collectRow(R),y-=R.offsetHeight,y>0&&i.processedRows.add(R.dataIndex),S=R.dataIndex,(++v===f.length&&y>0||m&&v-C===d)&&(y=0))}if(p)for(const R in l){const H=l[R],L=r.subGrids[R].element.querySelectorAll(".b-grid-merged-cells");H.mergedCellsHtml=[];for(const V of L)H.mergedCellsHtml.push(V.outerHTML)}const I=f[v-1];if(I&&(i.exactGridHeight=I.bottom+r.footerContainer.offsetHeight+r.headerContainer.offsetHeight),await t.onRowsCollected(f.slice(C,v),e),m)i.scrollableTopMargin=r.scrollable.y;else{const R=g.ion({offsetRows:({offset:H})=>D+=H});await t.scrollRowIntoView(r,S+1),R()}return D}async renderRows(e){const t=this,{exportMeta:i}=t,{client:r,alignRows:n,repeatHeader:s}=e,{currentPageTopMargin:l,verticalPosition:o,totalRows:a,contentHeight:d,lastRowIndex:c,finishRowIndex:h,fakeRow:g}=i,f=s?0:r.headerHeight,{store:m}=r,p=r.hasActiveFeature("mergeCells"),v=e.rowsRange===_e.visible;let y=c,{lastTop:C}=i,w;const S=y,D=o===0?0:C+l+f,I=[];w=d-D,o===0&&(w-=f);let R,H,L=0;for(;w>0;)g.render(y,m.getAt(y),!0,!1,!0),n&&w<g.offsetHeight?(L=-w,w=0):(H=C,R=y,C=g.translate(C),w-=g.offsetHeight,t.collectRow(g),I.push({top:g.top,bottom:g.bottom,offsetHeight:g.offsetHeight,dataIndex:g.dataIndex}),w>0&&i.processedRows.add(y),(y===h||++y-S===a&&v)&&(w=0));return p&&t.renderMergedCells(e,S,y,I),i.lastRowIndex=R,i.lastTop=H,g&&(i.exactGridHeight=g.bottom+r.footerContainer.offsetHeight+r.headerContainer.offsetHeight),await t.onRowsCollected(I,e),L}async buildPage(e){const t=this,{exportMeta:i}=t,{client:r,headerTpl:n,footerTpl:s,enableDirectRendering:l}=e,{totalWidth:o,totalPages:a,currentPage:d,subGrids:c}=i;Object.values(c).forEach(p=>p.rows=[]),e.rowsRange===_e.all&&(i.totalHeight=r.headerHeight+r.footerHeight+r.scrollable.scrollHeight,l||(i.totalHeight-=t.getVirtualScrollerHeight(r)));let h,g,f;return n&&(h=t.prepareHTML(n({totalWidth:o,totalPages:a,currentPage:d}))),s&&(g=t.prepareHTML(s({totalWidth:o,totalPages:a,currentPage:d}))),l?f=await t.renderRows(e):f=await t.collectRows(e),{html:t.buildPageHtml(e),header:h,footer:g,offset:f}}async onRowsCollected(){}buildPageHtml(){const e=this,{subGrids:t}=e.exportMeta;let i=e.prepareExportElement();return Object.values(t).forEach(({placeHolder:r,rows:n,mergedCellsHtml:s})=>{const l=r.outerHTML;let o=n.reduce((a,d)=>(a+=d[0],a),"");s!=null&&s.length&&(o+=`<div class="b-grid-merged-cells-container">${s.join("")}</div>`),i=i.replace(l,o)}),i}}on.prototype.pagesExtractor=async function*(e){const t=this,{exportMeta:i,stylesheets:r}=t,{totalWidth:n,paperWidth:s,paperHeight:l,contentHeight:o,scale:a,initialScroll:d}=i;let{totalPages:c}=i,h;for(;(h=i.currentPage)<c;){t.trigger("exportStep",{text:t.L(on.exportingPageText,{currentPage:h,totalPages:c}),progress:Math.round((h+1)/c*90)});const{html:g,header:f,footer:m,offset:p}=await t.buildPage(e),v=[...r,`
                <style>
                    #${e.client.id} {
                        width: ${n}px !important;
                    }
                    .b-export .b-export-content {
                        transform: scale(${a});
                        transform-origin: top left;
                        height: auto;
                    }
                </style>
            `];if(e.repeatHeader){const y=i.exactGridHeight?`${i.exactGridHeight+i.currentPageTopMargin}px`:"100%";v.push(`
                <style>
                    #${e.client.id} {
                        height: ${y} !important;
                    }
                    .b-export .b-export-content {
                        height: ${100/a}%;
                    }
                    .b-export-body {
                        height: 100%;
                        display: flex;
                    }
                    .b-export-viewport {
                        height: 100%;
                    }
                    .b-grid-vertical-scroller {
                        margin-top: ${i.currentPageTopMargin-d}px;
                    }
                </style>
                `)}else{const y=i.exactGridHeight||o-i.currentPageTopMargin;v.push(`
                <style>
                    #${e.client.id} {
                        height: ${y}px !important;
                    }
                    .b-export-body {
                        overflow: hidden;
                    }
                    .b-export .b-export-content {
                        height: ${100/a}%;
                    }
                    .b-export-body .b-export-viewport {
                        margin-top: ${i.currentPageTopMargin}px;
                    }
                    .b-grid-vertical-scroller {
                        margin-top: -${d}px;
                    }
                </style>
                `)}i.currentPageTopMargin-=o+p,await t.stateNextPage(e),{totalPages:c}=i,yield{html:t.pageTpl({html:g,header:f,footer:m,styles:v,paperWidth:s,paperHeight:l})}}};on._$name="MultiPageVerticalExporter";class pl extends vr{static get $name(){return"SinglePageExporter"}static get type(){return"singlepage"}static get title(){return this.localize("L{singlepage}")}static get defaultConfig(){return{centerContentHorizontally:!1}}async prepareComponent(e){await super.prepareComponent(e),Object.assign(this.exportMeta,{verticalPages:1,horizontalPages:1,totalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0})}async onRowsCollected(){}positionRows(e,t){if(t.enableDirectRendering)return e.map(i=>i[0]);{let i=0;return e.map(([r,,n])=>{const s=r.replace(/translate\(\d+px, \d+px\)/,`translate(0px, ${i}px)`);return i+=n,s})}}async collectRows(e){const t=this,{client:i}=e,{rowManager:r,store:n}=i,s=i.hasActiveFeature("mergeCells"),{subGrids:l}=t.exportMeta,o=e.rowsRange===_e.visible&&n.count?t.getVisibleRowsCount(i):n.count;let{totalHeight:a}=t.exportMeta,d=0,c=-1;if(r.rows.length>0){if(e.rowsRange===_e.visible&&(c=r.firstVisibleRow.dataIndex-1),s)for(const h of Object.values(l))h.mergedCellsHtml=[];for(;d<o;){const h=r.rows,g=h[h.length-1],f=d;if(h.forEach(v=>{v.dataIndex>c&&d<o&&(++d,a+=v.offsetHeight,t.collectRow(v))}),s)for(const v in l){const y=l[v],C=i.subGrids[v].element.querySelectorAll(".b-grid-merged-cells");for(const w of C)y.mergedCellsHtml.push(w.outerHTML)}const m=h.findIndex(v=>v.dataIndex===c+1),p=m+(d-f);await t.onRowsCollected(h.slice(m,p),e),d<o&&(c=g.dataIndex,await t.scrollRowIntoView(i,c+1))}}return a}async renderRows(e){const t=this,{client:i,rowsRange:r}=e,{rowManager:n,store:s}=i,l=i.hasActiveFeature("mergeCells"),o=r===_e.visible;let{totalHeight:a}=t.exportMeta;if(s.count){const{fakeRow:d}=t.exportMeta,{firstVisibleRow:c}=n,h=o?c.dataIndex:0,g=o?n.lastVisibleRow.dataIndex:s.count-1,f=[];let m=0;if(d.cells.length){for(let p=h;p<=g;p++)d.render(p,s.getAt(p),!0,!1,!0),m=d.translate(m),t.collectRow(d),f.push({top:d.top,bottom:d.bottom,offsetHeight:d.offsetHeight,dataIndex:d.dataIndex});await t.onRowsCollected(f,e)}a+=m,l&&t.renderMergedCells(e,h,g,f)}return a}buildPageHtml(e){const t=this,{subGrids:i}=t.exportMeta;let r=t.prepareExportElement();return Object.values(i).forEach(({placeHolder:n,rows:s,mergedCellsHtml:l})=>{const o=n.outerHTML;let a=t.positionRows(s,e).join("");l!=null&&l.length&&(a+=`<div class="b-grid-merged-cells-container">${l.join("")}</div>`),r=r.replace(o,a)}),r}}pl.prototype.pagesExtractor=async function*(e){const t=this,{client:i}=e,{totalWidth:r}=t.exportMeta,n=t.stylesheets,s=e.orientation===Zi.portrait,l=Rn[e.paperFormat],o=s?l.width:l.height,a=s?l.height:l.width;let d,c,h;e.enableDirectRendering?(d=await t.renderRows(e),d+=i.headerHeight+i.footerHeight):(d=await t.collectRows(e),d+=i.height-i.bodyHeight);const g=t.buildPageHtml(e),f=d;e.headerTpl&&(c=t.prepareHTML(e.headerTpl({totalWidth:r})),d+=t.measureElement(c)),e.footerTpl&&(h=t.prepareHTML(e.footerTpl({totalWidth:r})),d+=t.measureElement(h));const m=Math.min(1,t.getScaleValue(t.inchToPx(o),r)),p=Math.min(1,t.getScaleValue(t.inchToPx(a),d)),v=Math.min(m,p);n.push(`<style>
                #${i.id} {
                    height: ${f}px !important;
                    width: ${r}px !important;
                }
                .b-export-content {
                    ${t.centerContentHorizontally?"left: 50%;":""}
                    transform: scale(${v}) ${t.centerContentHorizontally?"translateX(-50%)":""};
                    transform-origin: top left;
                    height: ${v===1?"inherit":"auto !important"};
                }
            </style>`),W.isIE11&&n.push(`<style>
                .b-export-body {
                   min-height: ${f}px !important;
                }
         </style>`),yield{html:t.pageTpl({html:g,header:c,footer:h,styles:n,paperWidth:o,paperHeight:a})}};pl._$name="SinglePageExporter";class Ec extends ee{static get $name(){return"PdfExport"}static get configurable(){return{dialogClass:ml,exportServer:void 0,exportDialog:{value:!0,$config:["lazy"]},fileName:null,fileFormat:"pdf",clientURL:null,paperFormat:"A4",orientation:"portrait",rowsRange:"all",alignRows:!1,repeatHeader:!1,keepRegionSizes:null,pagesPerRequest:0,exporterConfig:null,exporterType:"singlepage",exporters:[pl,ln,on],translateURLsToAbsolute:!0,keepPathName:!0,openAfterExport:!0,sendAsBinary:!1,openInNewTab:!1,headerTpl:null,footerTpl:null,fetchOptions:null,exportMask:"L{Generating pages}",exportProgressMask:"L{Waiting for response from server}",showErrorToast:!0,localizableProperties:["exportMask","exportProgressMask"],filterStyles:e=>e,enableDirectRendering:!0}}updateEnableDirectRendering(e){e||re.deprecate("Grid","6.0.0","Indirect rendering is deprecated")}doDestroy(){var e;(e=this.exportDialog)===null||e===void 0||e.destroy(),this.exportersMap.forEach(t=>t.destroy()),super.doDestroy()}get currentExportPromise(){return this._currentExportPromise}set currentExportPromise(e){this._currentExportPromise=e}get exportersMap(){return this._exportersMap||(this._exportersMap=new Map)}getExporter(e={}){const t=this,{exportersMap:i}=t,{type:r}=e;let n;if(i.has(r))n=i.get(r),Object.assign(n,e);else{const s=this.exporters.find(l=>l.type===r);if(!s)throw new Error(`Exporter type ${r} is not found. Make sure you've configured it`);e=x.clone(e),delete e.type,n=new s(e),n.relayAll(t),i.set(r,n)}return n}buildRequest(e,t){return{html:JSON.stringify(e),fileFormat:t.fileFormat,format:t.paperFormat,orientation:t.orientation}}buildExportConfig(e={}){const t=this,{client:i,exportServer:r,clientURL:n,fileFormat:s,fileName:l,paperFormat:o,rowsRange:a,alignRows:d,repeatHeader:c,keepRegionSizes:h,orientation:g,translateURLsToAbsolute:f,keepPathName:m,sendAsBinary:p,headerTpl:v,footerTpl:y,filterStyles:C,enableDirectRendering:w}=t;e.columns||(e.columns=i.columns.visibleColumns.filter(D=>D.exportable).map(D=>D.id));const S=x.assign({client:i,exportServer:r,clientURL:n,fileFormat:s,paperFormat:o,rowsRange:a,alignRows:d,repeatHeader:c,keepRegionSizes:h,orientation:g,translateURLsToAbsolute:f,keepPathName:m,sendAsBinary:p,headerTpl:v,footerTpl:y,enableDirectRendering:w,exporterType:t.exporterType,fileName:l||i.$$name},e);if(S.columns=e.columns.slice(),S.exporterType!=="multipagevertical"&&(S.repeatHeader=!1),!("alignRows"in e)&&e.repeatHeader&&(S.alignRows=!0),!("keepRegionSizes"in e)&&!S.keepRegionSizes){const D=[],I={};i.eachSubGrid(R=>R.collapsed&&D.push(R.region)),D.length&&(i.eachSubGrid(R=>{D.includes(R.region)||(I[R.region]=!0)}),S.keepRegionSizes=I)}return S.exporterConfig=x.assign({type:S.exporterType,translateURLsToAbsolute:S.translateURLsToAbsolute,keepPathName:S.keepPathName,filterStyles:C},S.exporterConfig||{}),delete S.exporterType,delete S.translateURLsToAbsolute,delete S.keepPathName,S}async export(e={}){const t=this,{client:i,pagesPerRequest:r}=t;e=t.buildExportConfig(e);let n;if(i.trigger("beforePdfExport",{config:e})!==!1){i.isExporting=!0,i.mask(t.exportMask);try{const o=t.getExporter(e.exporterConfig);if(r===0){var s;const a=await o.export(e);if(t.isDestroying)return;(s=t.exportDialog)===null||s===void 0||s.close(),i.unmask(),t.trigger("exportStep",{progress:90,text:t.exportProgressMask,contentGenerated:!0});const d=t.receiveExportContent(a,e);t.toast=t.showLoadingToast(d);const c=await d;n={response:c},await t.processExportContent(c,e)}}catch(o){throw o instanceof Response?n={response:o}:n={error:o},o}finally{if(t.toast&&!t.toast.isDestroying&&t.toast.hide(),!t.isDestroying){var l;(l=t.exportDialog)===null||l===void 0||l.close(),i.unmask(),t.showErrorToast&&(n.error?n.error.name!=="AbortError"&&je.show({html:t.L("L{Export failed}"),rootElement:t.rootElement}):n.response.ok||je.show({html:t.L("L{Server error}"),rootElement:t.rootElement})),i.trigger("pdfExport",n),i.isExporting=!1}}}return n}receiveExportContent(e,t){return He.fetch(t.exportServer,Object.assign({method:"POST",credentials:"omit",headers:{"Content-Type":"application/json"},body:JSON.stringify({html:e,orientation:t.orientation,format:t.paperFormat,fileFormat:t.fileFormat,fileName:t.fileName,clientURL:t.clientURL,sendAsBinary:t.sendAsBinary})},this.fetchOptions))}async processExportContent(e,t){const i=this;if(e.ok&&i.openAfterExport){e=e.clone();const r=e.headers.get("content-type");if(r.match(/application\/octet-stream/)){const n=Vm[t.fileFormat],s=await i.responseBlobToObjectURL(e,n);i.getDownloadLink(t.fileName,s).click()}else if(r.match(/application\/json/)){const n=await e.json();n.success?i.getDownloadLink(t.fileName,n.url).click():je.show({html:n.msg,rootElement:this.rootElement})}}}async responseBlobToObjectURL(e,t){const i=await e.blob();return URL.createObjectURL(i.slice(0,i.size,t))}getDownloadLink(e,t){const i=document.createElement("a");return i.download=e,i.href=t,this.openInNewTab&&(i.target="_blank"),i}get defaultExportDialogConfig(){return x.copyProperties({},this,["client","exporters","exporterType","orientation","fileFormat","paperFormat","alignRows","rowsRange","repeatHeader"])}changeExportDialog(e,t){const i=this;if(t?.destroy(),e){const r=i.dialogClass.mergeConfigs({rootElement:i.rootElement,client:i.client,items:{rowsRangeField:{value:i.rowsRange},exporterTypeField:{value:i.exporterType},orientationField:{value:i.orientation},paperFormatField:{value:i.paperFormat},repeatHeaderField:{value:i.repeatHeader},fileFormatField:{value:i.fileFormat},alignRowsField:{checked:i.alignRows}}},i.defaultExportDialogConfig,e);e=i.dialogClass.new(r),e.ion({export:i.onExportButtonClick,thisObj:i})}return e}async showExportDialog(){return this.exportDialog.show()}onExportButtonClick({values:e}){const t=this,i=t.exportDialog.mask({progress:0,maxProgress:100,text:t.exportMask}),r=t.ion({exportstep({progress:n,text:s,contentGenerated:l}){l?(t.exportDialog.unmask(),r()):(i.progress=n,s!=null&&(i.text=s))}});t.currentExportPromise=t.export(e),t.currentExportPromise.catch(()=>{}).finally(()=>{var n;r(),(n=t.exportDialog)===null||n===void 0||n.unmask(),t.currentExportPromise=null})}showLoadingToast(e){const t=je.show({timeout:0,showProgress:!1,rootElement:this.rootElement,html:`
    <span class="b-mask-icon b-icon b-icon-spinner"></span>
    <span>${this.L("L{Waiting for response from server}")}</span>
    <button class="b-button">${this.L("L{Click to abort}")}</button>`});return A.on({element:t.element,click(){var i;(i=e.abort)===null||i===void 0||i.call(e)}}),t}}Ec._$name="PdfExport";Q.registerFeature(Ec,!1,"Grid");class Tc extends ${static get defaultConfig(){return{target:null,defaultColumnWidth:100,exportDateAsInstance:!0,showGroupHeader:!0,columns:null,indent:!0,indentationSymbol:"\xA0\xA0\xA0\xA0"}}export(e={}){const t=this;return e=x.assign({},t.config,e),t.normalizeColumns(e),t.generateExportData(e)}generateExportData(e){const t=this,i=t.generateColumns(e);return{rows:t.generateRows(e),columns:i}}normalizeColumns(e){const t=e.columns||this.target.columns.visibleColumns.filter(i=>i.exportable!==!1);e.columns=t.map(i=>typeof i=="string"?this.target.columns.find(r=>r.field===i)||{field:i}:i)}generateColumns(e){return e.columns.map(t=>this.processColumn(t,e))}generateRows(e){const{columns:t,rows:i}=e;if(t.length===0||i?.length===0)return[];const r=this,{target:n}=r;return(i||n.store).map(s=>r.processRecord(s,t,e)).filter(s=>s?.length)}getColumnType(e,t=this.target.store){let i=e.exportedType||"object";if(e.exportedType===void 0&&e.field){const r=t.modelClass.getFieldDefinition(e.field);r&&r.type!=="auto"&&(i=r.type)}return i}processColumn(e,t){const i=this,{target:r}=i,{defaultColumnWidth:n}=t;let{field:s,text:l,width:o,minWidth:a}=e;if(s in r.store.modelClass.fieldMap||(s=""),!l||!o){const d=r.columns.find(c=>c.field===s);l||(l=d&&d.text||s),o==null&&(o=d&&d.width||n)}return o=Math.max(o||n,a||n),{field:s,value:l,width:o,type:i.getColumnType(e)}}processRecord(e,t,i){const{target:r}=this,{showGroupHeader:n,indent:s,indentationSymbol:l}=i;let o;return e?e.isSpecialRow?n&&e.meta.groupRowFor&&(o=t.map(a=>r.features.group.buildGroupHeader({cellElement:b.createElement(),grid:r,record:e,column:a}))):o=t.map(a=>{var d;let c=(d=a.field)!==null&&d!==void 0&&d.includes(".")?e.get(a.field):e[a.field];const h=a.renderer||a.defaultRenderer;return h&&!(c&&a.isDateColumn&&i.exportDateAsInstance)&&(c=h.call(a,{value:c,record:e,column:a,grid:r,isExport:!0})),s&&a.tree&&(c=`${l.repeat(e.childLevel)}${c}`),c}):o=t.map(()=>""),o}}Tc._$name="TableExporter";class Rc{constructor(e){this._value=e}get value(){return this._value}toString(){return Boolean(this.value)?"\u2713":""}}Rc._$name="BooleanUnicodeSymbol";class Dc extends ee{static get $name(){return"ExcelExporter"}static get defaultConfig(){return{filename:null,dateFormat:"YYYY-MM-DD",exporterClass:Tc,exporterConfig:null,zipcelx:null,convertEmptyValueToEmptyString:!0}}processValue(e){return e==null||Number.isNaN(e)||typeof e=="function"||typeof e=="object"&&String(e)==="[object Object]"?"":e}generateExportData(e){const t=this,{rows:i,columns:r}=t.exporter.export(e.exporterConfig);return{rows:i.map(n=>n.map((s,l)=>{var o;s instanceof Date?s=E.format(s,e.dateFormat):typeof s=="boolean"&&(s=new Rc(s)),t.convertEmptyValueToEmptyString&&(s=t.processValue(s));const a=((o=r[l])===null||o===void 0?void 0:o.type)==="number"?"number":"string";return{value:s,type:a}})),columns:r.map(n=>{let{field:s,value:l,width:o,type:a}=n;return a="string",{field:s,value:l,width:o,type:a}})}}export(e={}){const t=this,i=t.zipcelx||globalThis.zipcelx;if(!i)throw new Error('ExcelExporter: "zipcelx" library is required');if(t.disabled)return;e=x.assign({},t.config,e),e.filename||(e.filename=t.client.$$name);const{filename:r}=e,{rows:n,columns:s}=t.generateExportData(e);return i({filename:r,sheet:{data:[s].concat(n),cols:s}})}construct(e,t){super.construct(e,t),this.zipcelx||typeof zipcelx<"u"&&(this.zipcelx=globalThis.zipcelx)}get exporter(){const e=this;return e._exporter||(e._exporter=e.exporterClass.new({target:e.client},e.exporterConfig))}}Dc._$name="ExcelExporter";Q.registerFeature(Dc,!1,"Grid");class Dn extends k{static get $name(){return"Bar"}static get type(){return"gridbar"}static get defaultConfig(){return{htmlCls:"",scrollable:{overflowX:"hidden-scroll"}}}get columns(){return this._columns||this.subGrid.columns}set columns(e){this._columns=e}fixCellWidths(){const e=this,{hasFlex:t}=e.columns;let i;e.columns.traverse(r=>{const n=e.getBarCellElement(r.id),s=b.setLength(r.width),l=b.setLength(r.minWidth),o=b.setLength(r.maxWidth);if(n){if(i=s,n.style.maxWidth=o,r.isParent&&r.width==null&&r.flex==null){const a=r.children.reduce((d,c)=>d+=!c.hidden&&c.flex||0,0);n.style.flex=a>0?`${a} 0 auto`:"",n.style.minWidth=null,a>0&&r.traverse(d=>d.data.minWidth=null)}else if(parseInt(r.minWidth)>=0&&(n.style.minWidth=l),n.style.flex=n.style.flexBasis=n.style.width="",r.flex)!isNaN(parseInt(r.flex))&&r.children?n.style.flex=`${r.flex} 0 auto`:n.style.flex=r.flex;else if(parseInt(r.width)>=0){const a=r.parent;e.isHeader&&!a.isRoot&&!a.width?n.style.width=s:n.style.flexBasis=i}r.height>=0&&(n.style.height=b.setLength(r.height))}}),e.scrollable.element.classList.toggle("b-has-flex",t)}getLrPadding(e){if(!this.cellLrPadding){const t=e.ownerDocument.defaultView.getComputedStyle(e);this.cellLrPadding=parseInt(t.getPropertyValue("padding-left"))+parseInt(t.getPropertyValue("padding-right"))+parseInt(t.getPropertyValue("border-left-width"))+parseInt(t.getPropertyValue("border-right-width"))}return this.cellLrPadding}getBarCellElement(e){return this.element.querySelector(`[data-column-id="${e}"]`)}}Dn.initClass();Dn._$name="Bar";class vl extends Dn{static get $name(){return"Footer"}static get type(){return"gridfooter"}get subGrid(){return this._subGrid}set subGrid(e){this._subGrid=this.owner=e}refreshContent(){this.element.firstElementChild.innerHTML=this.contentTemplate(),this.fixFooterWidths()}onPaint({firstPaint:e}){e&&this.refreshContent()}template(){const e=this.subGrid.region;return Xe.tpl`
            <div class="b-grid-footer-scroller b-grid-footer-scroller-${e}" role="presentation">
                <div data-reference="footersElement" class="b-grid-footers b-grid-footers-${e}" data-region="${e}" role="presentation"></div>
            </div>
        `}get overflowElement(){return this.footersElement}getFooter(e){return this.getBarCellElement(e)}contentTemplate(){return this.columns.visibleColumns.map(t=>Xe.tpl`
                <div
                    class="b-grid-footer ${t.align?`b-grid-footer-align-${t.align}`:""} ${t.cls||""}"
                    data-column="${t.field||""}" data-column-id="${t.id}" data-all-index="${t.allIndex}"
                    role="presentation">
                    ${t.footerText||""}
                </div>`).join("")}fixFooterWidths(){this.fixCellWidths()}}vl.initClass();vl._$name="Footer";class bl extends ee{static get pluginConfig(){return{chain:["destroy"],assign:["rowHeight","topRow","bottomRow","firstVisibleRow","lastVisibleRow","firstFullyVisibleRow","lastFullyVisibleRow","getRowById","getRecordCoords","getRow","getRowFor","getRowFromElement"]}}static get defaultConfig(){return{prependRowBuffer:5,appendRowBuffer:5,rowHeight:null,fixedRowHeight:null,autoHeight:!1}}static get properties(){return{idMap:{},topIndex:0,lastScrollTop:0,_rows:[],heightMap:new Map,totalKnownHeight:0,_totalHeight:0,averageRowHeight:0,scrollTargetRecordId:null,refreshDetails:{topRowIndex:0,topRowTop:0}}}construct(e){e.grid._rowManager=this,super.construct(e.grid,e)}doDestroy(){this._rows.forEach(e=>e.destroy()),super.doDestroy()}initWithHeight(e,t=!1){const i=this;return i.autoHeight&&(e=i.store.allCount*i.preciseRowOffsetHeight),i.viewHeight=e,i.calculateRowCount(t),e}reinitialize(e=!1){const t=this;t.calculateRowCount(!1,!0,!0),t.topIndex+t.rowCount-1>t.store.count&&(e=!0);const i=t.topRow&&!e?t.topRow.top:0;t.scrollTargetRecordId=null,e&&(t.topIndex=t.lastScrollTop=0);const{topRow:r}=t;r&&(r.dataIndex=t.topIndex,r.setTop(i,!0)),t.estimateTotalHeight(),t.renderFromRow(r)}matchRowCount(e=!1){const t=this,{rows:i,grid:r}=t,n=i.length,s=n-t.rowCount;if(s)if(s<0){const a=[];for(let d=n,c=n?i[n-1].dataIndex+1:0;d<t.rowCount;d++,c++)a.push(new pr({cls:r.rowCls,rowManager:t,grid:r,index:d,dataIndex:c}));i.push.apply(i,a),t.trigger("addRows",{rows:a}),e||t.renderFromRow(i[Math.max(0,n-1)])}else{var l;const{focusedCell:a}=r,d=a?.id!=null&&(a==null||(l=a.cell)===null||l===void 0?void 0:l.contains(b.getActiveElement(r))),c=i.splice(n-s,s);if(d){var o;s===n?r.onFocusedRowDerender():((o=t.getRowFor(a._record))===null||o===void 0?void 0:o.index)>=i.length&&i[i.length-1].cells[a.columnIndex].focus()}t.trigger("removeRows",{rows:c}),c.forEach(h=>h.destroy())}}calculateRowCount(e=!1,t=!0,i=!1){var r;const n=this,{store:s}=n,l=Math.ceil(n.viewHeight/n.minRowOffsetHeight),o=l+n.prependRowBuffer+n.appendRowBuffer;if(!((r=n.grid.columns)!==null&&r!==void 0&&r.count)||isNaN(l))return n.rowCount=0,0;if(o<n.rowCount&&!t)return n.rowCount;if(n.visibleRowCount=l,n.rowCount=Math.min(s.count,o),!e){if(n.rows&&n.rowCount!==n.rows.length){var a;if(n.matchRowCount(i),((a=n.bottomRow)===null||a===void 0?void 0:a.dataIndex)>=s.count&&n.topRow.dataIndex!==0){const d=n.bottomRow.dataIndex-s.count+1;for(const c of n.rows)c.dataIndex-=d;n.topIndex-=d}}else n.rowCount||n.trigger("changeTotalHeight",{totalHeight:n.totalHeight});n.grid.toggleEmptyText()}return n.rowCount}removeAllRows(){const e=this,{topRow:t}=e,i=t?e.refreshDetails={topRowIndex:t.dataIndex,topRowTop:t.top}:e.refreshDetails,r=e.rows.slice();return e.trigger("removeRows",{rows:r}),e.rows.forEach(n=>n.destroy()),e.rows.length=0,e.idMap={},i}setPosition(e){const{topRow:t}=this,{topRowIndex:i,topRowTop:r}=e;t.setTop(r),t.dataIndex=i}get store(){return this.client.store}get rows(){return this._rows}getRow(e){if(this.rowCount)return this.rows[e-this.topIndex]}getRowById(e){return e&&e.isModel&&(e=e.id),this.idMap[e]}getRowFromElement(e){return e=e.closest(".b-grid-row"),e&&this.getRow(e.dataset.index)}getRowAt(e,t=!1){return t||(e-=O.from(this.grid.bodyContainer,null,!0).roundPx(1).top,e+=this.grid.scrollable.y),e=b.roundPx(e),this.rows.find(i=>e>=i.top&&e<i.bottom)}getRowFor(e){return e instanceof HTMLElement?this.getRowFromElement(e):this.getRowById(e)}getNextRow(e){const t=typeof e=="number"?e:e.index;return this.getRow((t+1)%this.rowCount)}get topRow(){return this.rows[0]}get bottomRow(){const e=Math.min(this.rowCount,this.store.count);return this.rows[e-1]}get firstVisibleRow(){return this.rows.find(e=>e.bottom>Math.ceil(this.grid.scrollable.y))}get firstFullyVisibleRow(){return this.rows.find(e=>e.top>=Math.ceil(this.grid.scrollable.y))}get lastVisibleRow(){const{grid:e}=this;return B.findLast(this.rows,t=>t.top<e.scrollable.y+e.bodyHeight)}get lastFullyVisibleRow(){const{grid:e}=this;return B.findLast(this.rows,t=>t.bottom<e.scrollable.y+e.bodyHeight)}offsetRows(e){if(e!==0){const{rows:t}=this,{length:i}=t;for(let r=0;r<i;r++)t[r].offset(e)}this.trigger("offsetRows",{offset:e})}get prependBufferHeight(){return this.prependRowBuffer*this.rowOffsetHeight}get appendBufferHeight(){return this.appendRowBuffer*this.rowOffsetHeight}get rowHeight(){return this._rowHeight}set rowHeight(e){const t=this,{grid:i,fixedRowHeight:r}=t,n=t.rowHeight;if(n!==e){if(x.assertNumber(e,"rowHeight"),e<10&&(e=10),t.trigger("beforeRowHeight",{height:e}),t.minRowHeight=t._rowHeight=e,r&&(t.averageRowHeight=e),t.rows.length){const s=i.scrollable.y,l=t.getRowAt(s,!0),o=l?l.top-s:0;let a,d;r?(a=e,d=n):(d=a=t.averageRowHeight,t.clearKnownHeights(),a*=e/n),t.calculateRowCount(!1,!0,!0),t.topRow.setTop(t.topRow.dataIndex*(a+i._rowBorderHeight),!0),t.refresh(),s*(a/d)!==s&&i.scrollRowIntoView(l.id,{block:"start",edgeOffset:o})}t.trigger("rowHeight",{height:e,oldHeight:n})}}get rowOffsetHeight(){return Math.floor(this.preciseRowOffsetHeight)}get preciseRowOffsetHeight(){return(this.averageRowHeight||this._rowHeight)+this.grid._rowBorderHeight}get minRowOffsetHeight(){return(this.minRowHeight||this._rowHeight)+this.grid._rowBorderHeight}get allHeightsKnown(){return this.fixedRowHeight||this.heightMap.size>=this.store.count}storeKnownHeight(e,t){const i=this,{heightMap:r}=i;i.fixedRowHeight||(r.has(e)&&(i.totalKnownHeight-=r.get(e)),r.set(e,t),i.totalKnownHeight+=t,t<i.minRowHeight&&(i.minRowHeight=t),i.averageRowHeight=i.totalKnownHeight/r.size)}getOffsetHeight(e){const t=this;return(e&&t.heightMap.get(e.id)||e&&t.grid.getRowHeight(e)||t.averageRowHeight||t.rowHeight)+t.grid._rowBorderHeight}invalidateKnownHeight(e){const t=this;if(!t.fixedRowHeight){const{heightMap:i}=t;e=B.asArray(e),e.forEach(r=>{r&&i.has(r.id)&&(t.totalKnownHeight-=i.get(r.id),i.delete(r.id))}),t.averageRowHeight=t.totalKnownHeight/i.size}}clearKnownHeights(){this.heightMap.clear(),this.averageRowHeight=this.totalKnownHeight=0}calculateTop(e){if(this.fixedRowHeight)return e*this.rowOffsetHeight;const{store:t}=this;let i=0;for(let r=0;r<e;r++){const n=t.getAt(r);i+=this.getOffsetHeight(n)}return Math.floor(i)}getRecordCoords(e,t=!1,i=!1){const r=this,n=r.getRowById(e);let s=r.client._bodyRectangle;return t||(s=r.client.refreshBodyRectangle()),n?new O(s.x,Math.round(t?n.top:n.top+s.y-r.client.scrollable.y),s.width,n.offsetHeight):r.getRecordCoordsByIndex(r.store.indexOf(e),t,i)}getRecordCoordsByIndex(e,t=!1,i=!1){const r=this,{topRow:n,bottomRow:s}=r,l=r.client._bodyRectangle,{id:o}=r.store.getAt(e),a=r.preciseRowOffsetHeight,d=n.dataIndex,c=s.dataIndex,h=e>c?{index:e-c-1,y:s.bottom,from:"bottomRow"}:e>d/2?{index:e-d,y:n.top,from:"topRow"}:{index:e,y:0,from:"top"},g=r.allHeightsKnown&&!i?r.calculateTop(e):Math.floor(h.y+h.index*a),f=new O(l.x,t?g:g+l.y-r.client.scrollable.y,l.width,Math.floor(r.heightMap.get(o)||a));return f.virtual=!0,f.block=f.bottom<l.y?"start":f.y>l.bottom?"end":"nearest",f}get totalHeight(){return this._totalHeight}forEach(e){this.rows.forEach(e)}[Symbol.iterator](){return this.rows[Symbol.iterator]()}refreshCell(e,t){const i=new K({grid:this.grid,record:e,columnId:t});return Boolean(i.cell&&i.row.renderCell(i))}returnToTop(){const e=this;e.topIndex=0,e.lastScrollTop=0,e.topRow&&(e.topRow.dataIndex=0,e.topRow.setTop(0,!0)),e.refresh(),e.grid.scrollable.y=0}renderFromRecord(e){const t=this.getRowById(e.id);t&&this.renderFromRow(t)}renderFromRow(e=null){const t=this,{rows:i,store:r}=t,n=r.count;if(t.calculateRowCount(!1,n<i.length,!0)===0){t.estimateTotalHeight(!0);return}const s=e?i.indexOf(e):0;let l=e?e.dataIndex:i[0].dataIndex;const o=n-l-1,a=Math.min(i.length-1,s+o);let d=i.length-a-1,c=s>0?i[s-1].bottom:i[s].top,h;for(let g=s;g<=a;g++)h=i[g],h.dataIndex=l,h.setTop(c,!0),h.render(l,r.getAt(l++),!1),c+=h.offsetHeight;for(;d-- >0;)t.displayRecordAtTop();t.bottomRow.bottom<t.viewHeight&&t.calculateRowCount(),t.estimateTotalHeight(!0),t.trigger("renderDone")}renderRows(e){let t,i=!1;e=Array.from(e),e.sort((r,n)=>r.dataIndex-n.dataIndex);for(const r of e)t=r.height,r.render(null,null,!1),i|=r.height!==t;i&&this.translateFromRow(e[0]),this.trigger("renderDone")}translateFromRow(e,t=!1){const i=this;let r=e.bottom,n,s;for(s=e.dataIndex+1,n=i.getRow(s);n;n=i.getRow(++s))r=n.translate(r);t||i.estimateTotalHeight(!0)}refresh(){const e=this,{topRow:t}=e;!t||e.grid.refreshSuspended||(e.idMap={},e.renderFromRow(t),e.trigger("refresh"))}jumpToPosition(e,t){const i=this,{store:r,heightMap:n}=i,s=r.count;if(i.allHeightsKnown&&!i.fixedRowHeight){const l=e-i.prependBufferHeight,o=i.grid._rowBorderHeight;let a=0,d=0;for(;a<l;){const h=r.getAt(d);a+=n.get(h.id)+o,d++}const c=Math.max(Math.min(d,s-i.rowCount),0);i.lastScrollTop=e,i.topRow.dataIndex=i.topIndex=c,i.topRow.setTop(i.calculateTop(c),!1),i.refresh()}else{const l=i.preciseRowOffsetHeight,o=t==null?Math.floor(e/l)-i.prependRowBuffer:t-Math.floor(i.rowCount/2),a=Math.max(Math.min(o,s-i.rowCount),0),d=i.client.scrollable.y,c=Math.min(i.client._bodyRectangle.height+d+i.appendBufferHeight,i.totalHeight);if(i.lastScrollTop=e,i.topRow.dataIndex=i.topIndex=a,i.topRow.setTop(Math.floor(a*l),!1),i.refresh(),i.bottomRow.bottom<c)for(i.calculateRowCount(!1,!1,!1);i.bottomRow.bottom<c&&i._rows[i.prependRowBuffer].top<d&&i.bottomRow.dataIndex<s-1;)i.displayRecordAtBottom();i.estimateTotalHeight()}if(t!=null){const{scrollable:l}=i.grid,o=i.getRow(t),a=o&&O.from(o._elementsArray[0]).center.y,d=l.viewport.center.y;o&&(l.y=e=Math.floor(l.y+(a-d)))}return e}warpIfNeeded(e){const t=this,i={newScrollTop:e,deltaTop:e-t.lastScrollTop};if(Math.abs(i.deltaTop)>t.rowCount*t.rowOffsetHeight*3){let r;t.scrollTargetRecordId&&(r=t.store.indexOf(t.scrollTargetRecordId)),t.grid.onFocusedRowDerender(),i.newScrollTop=t.jumpToPosition(e,r),i.deltaTop=0}return i}updateRenderedRows(e,t,i=!1){const r=this,n=r.client._bodyRectangle;if(r.rowCount===0)return 0;let s=r.totalHeight;if(t||Math.abs(e-r.lastScrollTop)>=r.rowOffsetHeight||r.topRow.top>e||r.bottomRow.bottom<e+n.height){const l=r.warpIfNeeded(e);r.scrollTargetRecordId=null,r.lastScrollTop=l.newScrollTop,l.deltaTop>0?r.fillBelow(l.newScrollTop):l.deltaTop<0&&r.fillAbove(l.newScrollTop),!r.fixedRowHeight&&!i&&r.correctError(l,n,e),s=r.estimateTotalHeight()}return s}correctError(e,t,i){const r=this;let n=0;(r.allHeightsKnown||e.deltaTop<0&&i<t.height*2||e.deltaTop>0&&i>r.totalHeight-t.height*2-3)&&(n=r.topRow.top-r.calculateTop(r.topRow.dataIndex)),n&&(r.offsetRows(-n),r.grid.scrollable.y=r.lastScrollTop=r.grid.scrollable.y-n)}fillAbove(e){const t=this,i=e-t.topRow.top-t.prependBufferHeight;let r=0;for(;r>i&&t.topIndex>0;)r-=t.displayRecordAtTop();t.trigger("renderDone")}fillBelow(e){const t=this,i=e-t.topRow.top-t.prependBufferHeight,r=t.store.count,n=t.rowCount;let s=0;for(;s<i&&t.topIndex+n<r&&t.topRow.top+t.topRow.offsetHeight<e;)s+=t.displayRecordAtBottom();t.trigger("renderDone")}estimateTotalHeight(e=!1){const t=this;if(t.grid.renderingRows)return;const i=t.store.count,r=i-t.heightMap.size,{bottomRow:n}=t;let s;if(t.fixedRowHeight)s=i*t.rowOffsetHeight;else{if(s=t.totalKnownHeight+t.heightMap.size*t.grid._rowBorderHeight+r*t.preciseRowOffsetHeight,n&&r){const l=n.bottom;(l>s||t.topIndex+t.rowCount>=i&&s>l&&l>0)&&(s=l,n.dataIndex<i-1&&(s+=(i-1-n.dataIndex)*t.preciseRowOffsetHeight))}s=Math.floor(s)}return s!==t.totalHeight&&t.trigger("changeTotalHeight",{totalHeight:s,immediate:e})!==!1&&(t._totalHeight=s),s}displayRecordAtTop(){var e;const t=this,{grid:i}=t,r=t.topIndex-1,n=t.store.getAt(r),s=t.bottomRow,l=s.top;return t.trigger("beforeTranslateRow",{row:s,newRecord:n}),s.dataIndex===((e=i.focusedCell)===null||e===void 0?void 0:e.rowIndex)&&i.onFocusedRowDerender(),s._top=t.topRow.top-t.getOffsetHeight(n),s.estimatedTop=!t.fixedRowHeight,s.render(r,n,!1),s._top=l,s.setBottom(t.topRow.top),s.estimatedTop=!1,t.topIndex--,t._rows.unshift(t._rows.pop()),s.offsetHeight}displayRecordAtBottom(){var e;const t=this,{grid:i}=t,r=t.topIndex+t.rowCount,n=t.store.getAt(r),s=t.topRow;return t.trigger("beforeTranslateRow",{row:s,newRecord:n}),s.dataIndex===((e=i.focusedCell)===null||e===void 0?void 0:e.rowIndex)&&i.onFocusedRowDerender(),s.dataIndex=r,s.setTop(t.bottomRow.bottom),s.render(r,n,!1),t.topIndex++,t._rows.push(t._rows.shift()),s.offsetHeight}}bl.featureClass="";bl._$name="RowManager";const zm={x:1};class Mc extends ot{addScroller(e){(this.xScrollers||(this.xScrollers=[])).push(e)}addPartner(e,t=zm){typeof t=="string"&&(t={[t]:1}),t.x&&(e.owner.initScroll(),this.xScrollers.forEach((i,r)=>i.addPartner(e.xScrollers[r],"x"))),t.y&&super.addPartner(e,"y")}removePartner(e){this.xScrollers.forEach((t,i)=>{t.isDestroyed||t.removePartner(e.xScrollers[i])}),super.removePartner(e)}updateOverflowX(e){var t;const i=e===!1;(t=this.xScrollers)===null||t===void 0||t.forEach(r=>r.overflowX=i?"hidden":"hidden-scroll"),this.widget.virtualScrollers.classList.toggle("b-hide-display",i)}scrollIntoView(e,t){if(e.nodeType===Element.ELEMENT_NODE&&this.element.contains(e)){for(const i of this.xScrollers)if(i.element.contains(e))return i.scrollIntoView(e,t)}else return super.scrollIntoView(e,t)}hasOverflow(e="y"){return e==="y"?this.scrollHeight>this.clientHeight:!1}set x(e){this.xScrollers&&(this.xScrollers[0].x=e)}get x(){return this.xScrollers?this.xScrollers[0].x:0}}Mc._$name="GridScroller";class yl extends Dn{static get $name(){return"Header"}static get type(){return"gridheader"}get subGrid(){return this._subGrid}set subGrid(e){this._subGrid=this.owner=e}get region(){var e;return(e=this.subGrid)===null||e===void 0?void 0:e.region}changeElement(e,t){const{region:i}=this;return this.getConfig("columns"),super.changeElement({className:{"b-grid-header-scroller":1,[`b-grid-header-scroller-${i}`]:i},children:[{reference:"headersElement",className:{"b-grid-headers":1,[`b-grid-headers-${i}`]:i},dataset:{region:i,reference:"headersElement",maxDepth:this.maxDepth}}]},t)}get overflowElement(){return this.headersElement}getColumnConfig(e){const{id:t,align:i,resizable:r,isLeaf:n,isParent:s,isLastInSubGrid:l,cls:o,childLevel:a,field:d,tooltip:c,children:h,isFocusable:g,grid:f}=e,m=f?.focusedCell,p=m?.rowIndex===-1&&m?.column===e;if(e.isVisible)return{className:{"b-grid-header":1,"b-grid-header-parent":s,[`b-level-${a}`]:1,[`b-depth-${e.meta.depth}`]:1,[`b-grid-header-align-${i}`]:i,"b-grid-header-resizable":r&&n,[o]:o,"b-collapsible":e.collapsible,"b-last-parent":s&&l,"b-last-leaf":n&&l},role:g?"columnheader":"presentation","aria-sort":"none","aria-label":e.ariaLabel,[g?"tabIndex":""]:p?0:-1,dataset:F(F({},me.encodeConfig(c)),{},{columnId:t,[d?"column":""]:d}),children:[{className:"b-grid-header-text",children:[{[f&&g?"id":""]:`${f?.id}-column-${e.id}`,className:"b-grid-header-text-content"}]},h?{className:"b-grid-header-children",children:h.map(v=>this.getColumnConfig(v))}:null,{className:"b-grid-header-resize-handle"}]}}calculateMinWidthForSafari(){let e=0;return this.columns.visibleColumns.forEach(t=>{e+=t.calculateMinWidth()}),e}fixHeaderWidths(){this.fixCellWidths()}refreshHeaders(){const e=this;e.columns.traverse(t=>{const i=e.getBarCellElement(t.id);if(i){let r=t.headerText;t.headerRenderer&&(r=t.headerRenderer.call(t.thisObj||e,{column:t,headerElement:i})),t.headerWidgetMap&&Object.values(t.headerWidgetMap).forEach(s=>{s.render(t.textWrapper)}),t.icon&&(r=`<i class="${_.encodeHtml(t.icon)}"></i>`+(r||""));const n=i.querySelector(".b-grid-header-text-content");n&&(n.innerHTML=r||"")}}),e.fixHeaderWidths()}get columns(){const e=this,t=super.columns;return e.columnsDetacher||(e.columnsDetacher=t.ion({change(){e.initDepths()},thisObj:e}),e.initDepths()),t}set columns(e){super.columns=e}initDepths(e=this.columns.topColumns,t=null){const i=this;let r=0;t!=null&&t.meta&&t.meta.depth++;for(const n of e){const{meta:s}=n;s.depth=0,n.children&&(i.initDepths(n.children.filter(i.columns.chainedFilterFn),n),s.depth&&t&&(t.meta.depth+=s.depth)),s.depth>r&&(r=s.depth)}return t||(i.maxDepth=r),r}getHeader(e){return this.getBarCellElement(e)}get contentElement(){return this.element.firstElementChild}refreshContent(){const e=this;J.sync({domConfig:{children:e.columns.topColumns.map(t=>e.getColumnConfig(t)),onlyChildren:!0,strict:!0,syncIdField:"columnId",releaseThreshold:0},targetElement:e.contentElement}),e.refreshHeaders()}onPaint({firstPaint:e}){e&&this.refreshContent()}}yl.initClass();yl._$name="Header";const ws={touchstart:"onElementTouchStart",touchmove:"onElementTouchMove",touchend:"onElementTouchEnd",mouseover:"onElementMouseOver",mouseout:"onElementMouseOut",mousedown:"onElementMouseDown",mousemove:"onElementMouseMove",mouseup:"onElementMouseUp",click:"onHandleElementClick",dblclick:"onElementDblClick",keyup:"onElementKeyUp",keypress:"onElementKeyPress",contextmenu:"onElementContextMenu",pointerdown:"onElementPointerDown",pointerup:"onElementPointerUp"},Ga=["pageX","pageY","clientX","clientY","screenX","screenY"];function ji(u,e=!0){u?.classList.toggle("b-hover",e)}function Nr(u,e,t=!0){e&&u&&ji(e.getCell(u),t)}var Wm=u=>class extends(u||$){static get $name(){return"GridElementEvents"}static get configurable(){return{longPressTime:400,enableUndoRedoKeys:!0,keyMap:{"Ctrl+z":"undoRedoKeyPress","Ctrl+Shift+z":"undoRedoKeyPress"," ":{handler:"clickCellByKey",weight:1e3}}}}initInternalEvents(){const t=Object.keys(ws),i=t.length,r={element:this.bodyElement,thisObj:this};for(let n=0;n<i;n++){const s=t[n];r[s]={handler:"handleEvent"},s.startsWith("touch")&&(r[s].passive=!1)}A.on(r),A.on({focusin:"onGridBodyFocusIn",element:this.bodyElement,thisObj:this,capture:!0})}getCellDataFromEvent(t,i=!1){const r=this,{columns:n}=r,{target:s}=t;let l=s.closest(".b-grid-cell");if(!l&&i&&!s.classList.contains("b-grid-row")&&!s.classList.contains("b-grid-subgrid")){const{top:a,left:d,right:c,bottom:h}=r.bodyContainer.getBoundingClientRect();let g,{x:f,y:m}=t;if(f>=d&&f<=c?m=g=Math.ceil(r[`${m<a?"first":"last"}FullyVisibleRow`].element.getBoundingClientRect().y):m>=a&&m<=h&&(f=g=Math.ceil(n.visibleColumns[f<d?0:n.visibleColumns.length-1].element.getBoundingClientRect().x)),g!==void 0){var o;l=(o=document.elementFromPoint(f,m))===null||o===void 0?void 0:o.closest(".b-grid-cell")}}if(l){const a=Ae.get(l),{id:d,columnId:c}=a,h=r.store.getById(d),g=n.getById(c);return h?{cellElement:l,cellData:a,columnId:c,id:d,record:h,column:g,cellSelector:{id:d,columnId:c}}:null}}getHeaderDataFromEvent(t){const i=t.target.closest(".b-grid-header");if(i){const r=x.assign({},i.dataset),{columnId:n}=r,s=this.columns.getById(n);return s?{headerElement:i,headerData:r,columnId:n,column:s}:null}}handleEvent(t){!this.disabled&&ws[t.type]&&this[ws[t.type]](t)}onElementTouchStart(t){const i=this,r=i.getCellDataFromEvent(t);b.isTouchEvent=!0,t.touches.length===1&&(i.longPressTimeout=i.setTimeout(()=>{i.onElementLongPress(t),t.preventDefault(),i.longPressPerformed=!0},i.longPressTime)),r&&!t.defaultPrevented&&i.onFocusGesture(t)}onElementTouchMove(t){const i=this,{lastTouchTarget:r}=i,n=t.changedTouches[0],{pageX:s,pageY:l}=n,o=document.elementFromPoint(s,l);if(i.longPressTimeout&&(i.clearTimeout(i.longPressTimeout),i.longPressTimeout=null),o!==r){if(r){const a=new MouseEvent("mouseout",x.copyProperties({relatedTarget:o,pointerType:"touch",bubbles:!0},n,Ga));a.preventDefault=()=>t.preventDefault(),r?.dispatchEvent(a)}if(o){const a=new MouseEvent("mouseover",x.copyProperties({relatedTarget:r,pointerType:"touch",bubbles:!0},n,Ga));a.preventDefault=()=>t.preventDefault(),o?.dispatchEvent(a)}}i.lastTouchTarget=o}onElementTouchEnd(t){const i=this;i.longPressPerformed&&(t.cancelable&&t.preventDefault(),i.longPressPerformed=!1),i.longPressTimeout&&(i.clearTimeout(i.longPressTimeout),i.longPressTimeout=null)}onElementLongPress(t){}triggerCellMouseEvent(t,i,r=this.getCellDataFromEvent(i)){const n=this;if(r){const l=n.columns.getById(r.columnId),o={grid:n,record:r.record,column:l,cellSelector:r.cellSelector,cellElement:r.cellElement,target:i.target,event:i};if(n.trigger("cell"+_.capitalize(t),o),t==="click"){var s;(s=l.onCellClick)===null||s===void 0||s.call(l,o)}}}onElementMouseDown(t){const i=this,r=i.getCellDataFromEvent(t);i.skipFocusSelection=!0,i.isScrollbarOrRowBorderOrSplitterClick(t)?t.preventDefault():(i.triggerCellMouseEvent("mousedown",t,r),r&&!t.defaultPrevented&&i.onFocusGesture(t))}isScrollbarOrRowBorderOrSplitterClick({target:t,x:i,y:r}){if(t.closest(".b-grid-splitter")||t.matches(".b-grid-row, .b-virtual-width"))return!0;if(t.matches(".b-vertical-overflow")){const n=t.getBoundingClientRect();return i>n.right-b.scrollBarWidth}else if(t.matches(".b-horizontal-overflow")){const n=t.getBoundingClientRect();return r>n.bottom-b.scrollBarWidth-1}}onElementMouseMove(t){this.mouseMoveEvent=t}onElementMouseUp(t){}onElementPointerDown(t){}onElementPointerUp(t){}onHandleElementClick(t){this.trigger("beforeElementClick",{event:t})!==!1&&this.onElementClick(t)}onElementClick(t){const i=this,r=i.getCellDataFromEvent(t);r&&i.triggerCellMouseEvent("click",t,r)}onFocusGesture(t){const i=this,r=t.button===2,n=!r&&t.target.matches(".b-icon-tree-expand, .b-icon-tree-collapse"),s=!document.hasFocus()&&W.isMac&&r;if(n||s)t.preventDefault();else{var l;i.navigationEvent=t,(r||(l=i.focusedCell)!==null&&l!==void 0&&l.equals(new K(t.target)))&&i.focusCell(new K(t.target))}}onElementDblClick(t){const{target:i}=t;if(this.triggerCellMouseEvent("dblClick",t),i.classList.contains("b-grid-header-resize-handle")){const r=i.closest(".b-grid-header");this.columns.getById(r.dataset.columnId).resizeToFitContent()}}onElementMouseOver(t){if(!this.scrolling){const i=typeof t.buttons!="number"||t.buttons===0,r=t.target.closest(".b-grid-cell");i&&!r&&t.target.classList.contains("b-grid-row")&&this.setHovered(document.elementFromPoint(t.x,t.y-2).closest(".b-grid-cell")),r&&(i&&this.setHovered(r),this.triggerCellMouseEvent("mouseOver",t)),this.trigger("mouseOver",{event:t})}}onElementMouseOut(t){this.setHovered(null),this.scrolling||(t.target.closest(".b-grid-cell")&&this.triggerCellMouseEvent("mouseOut",t),this.trigger("mouseOut",{event:t}))}setHovered(t){var i,r;const n=this,{selectionMode:s}=n,l=s.rowNumber&&((i=n.columns.find(c=>c.type=="rownumber"))===null||i===void 0?void 0:i.id),o=s.checkbox&&((r=n.checkboxSelectionColumn)===null||r===void 0?void 0:r.id);if(n._hoveredCell){ji(n._hoveredCell,!1);const c=Ae.get(n._hoveredCell),{row:h}=c;if(h&&!h.isDestroyed&&(Nr(l,h,!1),Nr(o,h,!1)),c!=null&&c.columnId){var a;ji((a=n.columns.getById(c.columnId))===null||a===void 0?void 0:a.element,!1)}n._hoveredCell=null}if(n._hoveredRow&&!n._hoveredRow.isDestroyed&&n._hoveredRow.removeCls("b-hover"),n._hoveredRow=null,t&&!n.scrolling){const c=Ae.get(t),{row:h}=c;if(h)if(s.cell&&c.columnId!==l&&c.columnId!==o){var d;ji(t),n._hoveredCell=t,Nr(o,h),Nr(l,h),ji((d=n.columns.getById(c.columnId))===null||d===void 0?void 0:d.element)}else n._hoveredRow=h,h.addCls("b-hover")}}keyMapOnKeyDown(t){this.onElementKeyDown(t),super.keyMapOnKeyDown(t)}onElementKeyDown(t){if(t.handled)return;const i=this,r=i.focusedCell;if(r!=null&&r.isCell&&!r.isActionable){var n,s;const l=r.cell;(n=(s=i.columns.getById(l.dataset.columnId)).onCellKeyDown)===null||n===void 0||n.call(s,{event:t,cellElement:l})}}undoRedoKeyPress(t){var i;const{stm:r}=this.store;return r&&this.enableUndoRedoKeys&&!((i=this.features.cellEdit)!==null&&i!==void 0&&i.isEditing)?(r.onUndoKeyPress(t),!0):!1}clickCellByKey(t){const i=this,r=i.focusedCell,n=r?.cell,s=i.columns.getById(n.dataset.columnId);return r!=null&&r.isCell&&!r.isActionable&&s.onCellClick?(s.onCellClick({grid:i,column:s,record:i.store.getById(r.id),cellElement:n,target:t.target,event:t}),!0):!1}onElementKeyPress(t){}onElementKeyUp(t){}onElementContextMenu(t){const i=this,r=i.getCellDataFromEvent(t);r&&(i.triggerCellMouseEvent("contextMenu",t,r),b.isTouchEvent&&i.onFocusGesture(t))}onInternalResize(t,i,r,n,s){const l=this;l._devicePixelRatio&&l._devicePixelRatio!==globalThis.devicePixelRatio&&b.resetScrollBarWidth(),l._devicePixelRatio=globalThis.devicePixelRatio,l._bodyRectangle=O.client(l.bodyContainer),super.onInternalResize(...arguments),r!==s&&(l._bodyHeight=l.bodyContainer.offsetHeight,l.isPainted&&l.rowManager.initWithHeight(l._bodyHeight)),l.refreshVirtualScrollbars(),i!==n&&l.setTimeout(()=>{l.isDestroyed||l.updateResponsive(i,n)},0)}get widgetClass(){}};const jm={string:1,object:1,function:1};var Gm=u=>class extends(u||$){static get $name(){return"GridFeatures"}set features(t){const i=this,r=Q.getInstanceDefaultFeatures(this);t=i._features=x.assign({},t),r&&Object.keys(r).forEach(s=>{s in t||(t[s]=!0)});const n=Q.getInstanceFeatures(this);for(const s of Object.keys(t)){const l=t[s];if(l){const o=!globalThis.__bryntum_code_editor_changed;if(_.uncapitalize(s)!==s){const d=`Invalid feature name '${s}', must start with a lowercase letter`;if(o)throw new Error(d);console.error(d),i._errorDuringConfiguration=d}const a=n[s];if(!a){const d=`Feature '${s}' not available, make sure you have imported it`;if(o)throw new Error(d);console.error(d),i._errorDuringConfiguration=d;return}Reflect.defineProperty(t,s,i.createFeatureInitializer(t,s,a,l))}}}get features(){return this._features}createFeatureInitializer(t,i,r,n){const s=[this],l=r.prototype.construct;return n===!0&&(n={}),jm[typeof n]&&(s[1]=n),{configurable:!0,get(){return delete t[i],r.prototype.construct=function(...o){t[i]=this,l.apply(this,o),r.prototype.construct=l},new r(...s)}}}hasFeature(t){const{features:i}=this;if(i){const r=Object.getOwnPropertyDescriptor(this.features,t);if(r)return Boolean(r.value||r.get)}return!1}hasActiveFeature(t){var i,r;return Boolean(((i=this.features)===null||i===void 0?void 0:i[t])&&!((r=this.features)!==null&&r!==void 0&&r[t].disabled))}getConfigValue(t,i){if(t==="features"){const l={};for(const o in this.features){var r,n,s;const a=(r=this.features[o])===null||r===void 0||(n=(s=r).getCurrentConfig)===null||n===void 0?void 0:n.call(s,i);a?x.isEmpty(a)?Q.isDefaultFeatureForInstance(this.features[o].constructor,this)||(l[o]=!0):l[o]=a:l[o]=!1}return l}return super.getConfigValue(t,i)}get widgetClass(){}};const Um=Object.freeze({}),Ym=Object.freeze({x:!1,y:!1}),qm=function(u){return this.focusableFinderCell.contains(u)?b.isFocusable(u)&&!u.disabled?b.NodeFilter.FILTER_ACCEPT:b.NodeFilter.FILTER_SKIP:b.NodeFilter.FILTER_REJECT};var Km=u=>{var e;return e=class extends(u||$){static get $name(){return"GridNavigation"}onStoreRecordIdChange(i){var r;(r=super.onStoreRecordIdChange)===null||r===void 0||r.call(this,i);const{focusedCell:n}=this,{oldValue:s,value:l}=i;n&&n.id===s&&(n._id=l)}onFocusedRowDerender(){const i=this,{focusedCell:r}=i;if(r?.id!=null&&r.cell){const n=r.cell.contains(b.getActiveElement(i));if(i.hideHeaders)n&&i.revertFocus();else{const s=i.normalizeCellContext({rowIndex:-1,columnIndex:n?r.columnIndex:0});n?i.focusCell(s):s.cell.tabIndex=0}r.cell.tabIndex=-1}}navigateFirstCell(){this.focusCell(K.FIRST_CELL)}navigateFirstColumn(){this.focusCell(K.FIRST_COLUMN)}navigateLastCell(){this.focusCell(K.LAST_CELL)}navigateLastColumn(){this.focusCell(K.LAST_COLUMN)}navigatePrevPage(){this.focusCell(K.PREV_PAGE)}navigateNextPage(){this.focusCell(K.NEXT_PAGE)}activateHeader(i){if(i.target.classList.contains("b-grid-header")&&this.focusedCell.isColumnHeader){var r;const{column:n}=this.focusedCell;(r=n.onKeyDown)===null||r===void 0||r.call(n,i),this.getHeaderElement(n.id).click()}return!1}onEscape(i){const{focusedCell:r}=this;!i.target.closest(".b-dragging")&&r!==null&&r!==void 0&&r.isActionable&&(i.stopImmediatePropagation(),this._focusedCell=null,this.focusCell({rowIndex:r.rowIndex,column:r.column},{disableActionable:!0}))}onTab(i){const{target:r}=i,{focusedCell:n,bodyElement:s}=this,{isActionable:l,actionTargets:o}=n;if(l&&b.isEditable(r)&&!r.readOnly&&r===o[o.length-1])i.preventDefault(),this.navigateRight(i);else if(!l||r===o[o.length-1])return s.style.display="none",this.requestAnimationFrame(()=>s.style.display=""),!1}onShiftTab(i){const r=this,{target:n}=i,{focusedCell:s,bodyElement:l}=r,{cell:o,isActionable:a,actionTargets:d}=s,c=a&&b.isEditable(n)&&!n.readOnly,h=s.columnIndex===0&&s.rowIndex===(r.hideHeaders?0:-1);if(!h&&c&&n===d[0])i.preventDefault(),r.navigateLeft(i);else if(!a||n===d[0]){const g=!h&&!r.hideHeaders&&r.focusCell({rowIndex:-1,column:0},{disableActionable:!0});return g?(g.cell.tabIndex=-1,o.tabIndex=0,r._focusedCell=s):(l.style.display="none",r.requestAnimationFrame(()=>l.style.display="")),!1}}onSpace(i){return this.focusedCell.isActionable||i.preventDefault(),!1}get focusedCell(){return this._focusedCell}get isActionableLocation(){var i;return(i=this._focusedCell)===null||i===void 0?void 0:i.isActionable}set focusedCell(i){this.focusCell(i)}get focusedRecord(){var i;return(i=this._focusedCell)===null||i===void 0?void 0:i.record}get cellCSSSelector(){const i=this._focusedCell;return i?`[data-index=${i.rowIndex}] [data-column-id=${i.columnId}]`:""}afterHide(){super.afterHide(...arguments),this.lastFocusedCell=null}isFocused(i){var r;return Boolean((r=this._focusedCell)===null||r===void 0?void 0:r.equals(this.normalizeCellContext(i)))}get focusElement(){if(!this.isDestroying){let r;if(this.store.count&&this._focusedCell)r=this._focusedCell.target;else{var i;r=this.normalizeCellContext({rowIndex:-1,columnIndex:((i=this._focusedCell)===null||i===void 0?void 0:i.columnIndex)||0}).target}const n=super.focusElement;return n&&(!r||r.compareDocumentPosition(n)===Node.DOCUMENT_POSITION_PRECEDING)?n:r}}onPaint({firstPaint:i}){var r;const n=this;(r=super.onPaint)===null||r===void 0||r.call(this,...arguments);const s=this.normalizeCellContext({rowIndex:n.hideHeaders?0:-1,column:n.hideHeaders?0:n.columns.find(l=>!l.hidden&&l.isFocusable)});if(s.cell){n._focusedCell=s;const{target:l}=s;l===s.cell&&(s.cell.tabIndex=0)}}onGridBodyFocusIn(i){const r=this,{bodyElement:n}=r,s=r.focusedCell,l=s?.initialTarget||s?.target,{target:o,relatedTarget:a}=i,d=o.closest(r.focusableSelector);if(d&&(!te.currentMouseDown||te.isMouseDown(0)||te.isMouseDown(2))){var c;const f=new K(o),{cell:m}=f,p=s?.cell,v=f.actionTargets=r.findFocusables(d),y=(!r._fromFocusCell||r.selectOnFocus)&&(o===m||r._selectActionCell)&&!(o!=null&&o._isRevertingFocus);if(!r.store.getById(d.parentNode.dataset.id)&&m!==d){m.focus({preventScroll:!0});return}if(o.matches(r.focusableSelector)){if(r.disableActionable)f._target=m;else if(v.length){var h;r._selectActionCell=((h=te.currentMouseDown)===null||h===void 0?void 0:h.target)===o,v[0].focus(),delete r._selectActionCell;return}}else{var g;if(s!=null&&s.target&&a&&(!te.isMouseDown()||!n.contains((g=te.currentMouseDown)===null||g===void 0?void 0:g.target))&&!n.contains(a)&&!f.equals(s)){l.focus();return}f._target=o}if(p&&(p.classList.remove("b-focused"),p.tabIndex=-1),m&&(m.classList.add("b-focused"),f.column.onCellFocus(f),m===o&&(m.tabIndex=0),m.contains(i.relatedTarget)&&l===o))return;r._focusedCell=f,(c=r.onCellNavigate)===null||c===void 0||c.call(r,r,s,f,y),r.trigger("navigate",{lastFocusedCell:s,focusedCell:f,event:i})}else l?.focus()}findFocusables(i){const{focusableFinder:r}=this,n=[];r.currentNode=this.focusableFinderCell=i;for(let s=r.nextNode();s;s=r.nextNode())n.push(s);return n}get focusableFinder(){const i=this;return i._focusableFinder||(i._focusableFinder=i.setupTreeWalker(i.bodyElement,b.NodeFilter.SHOW_ELEMENT,{acceptNode:qm.bind(i)})),i._focusableFinder}restoreActiveItem(i=this._focusedCell){if(this.rowManager.count)return isNaN(i)?i.isModel||(i=this.store.getById(i)):i=this.store.getAt(i),this.focusCell(i)}focusCell(i,r=Um){var n,s;const l=this,{_focusedCell:o}=l,{scroll:a,disableActionable:d}=r;if(((n=i)===null||n===void 0?void 0:n.rowIndex)===-1&&l.hideHeaders){l.revertFocus();return}i=typeof i=="number"&&o!==null&&o!==void 0&&o.isLocation?o.move(i):l.normalizeCellContext(i);const c="doSelect"in r?r.doSelect:!i.isActionable||i.initialTarget===i.cell;if(i.equals(o)){var h;return(h=l.onCellNavigate)===null||h===void 0||h.call(l,l,o,i,c),o}const g=l.getSubGridFromColumn(i.columnId),{cell:f}=i,m=f||l.getCell({rowIndex:l.rowManager.topIndex,columnId:i.columnId}),p=O.from(g.element),v=O.from(l.bodyElement),y=O.from(m).moveTo(null,p.y);return a===!1||i.rowIndex===-1?r=Object.assign({},r,Ym):(r=Object.assign({},r,a),y.width>p.width||y.height>v.height?r.x=r.y=!1:r.column=i.columnId,l.scrollRowIntoView(i.id,r)),(l._hoveredRow||l._hoveredCell)&&l.setHovered(),l.disableActionable=d,l.selectOnFocus=c,l._fromFocusCell=!0,(s=i[d?"cell":"target"])===null||s===void 0||s.focus(),l.disableActionable=l.selectOnFocus=!1,delete l._fromFocusCell,i}blurCell(i){const r=this,n=r.getCell(i);n&&n.classList.remove("b-focused")}clearFocus(i){const r=this;r._focusedCell&&(r.lastFocusedCell=i?null:r._focusedCell,r.blurCell(r._focusedCell),r._focusedCell=null)}internalNextPrevCell(i=!0){const r=this,n=r._focusedCell;return n?r.focusCell({id:n.id,columnId:r.columns.getAdjacentVisibleLeafColumn(n.columnId,i,!0).id}):null}navigateRight(){var i;return(i=arguments[0])!==null&&i!==void 0&&i.fromKeyMap?this.focusCell(this.rtl?K.PREV_CELL:K.NEXT_CELL):(arguments[0]&&re.deprecate("Grid","6.0.0","Event argument removed, unused param"),this.internalNextPrevCell(!this.rtl))}navigateLeft(){var i;return(i=arguments[0])!==null&&i!==void 0&&i.fromKeyMap?this.focusCell(this.rtl?K.NEXT_CELL:K.PREV_CELL):(arguments[0]&&re.deprecate("Grid","6.0.0","Event argument removed, unused param"),this.internalNextPrevCell(Boolean(this.rtl)))}internalNextPrevRow(i,r=!0,n=!0){const s=this,l=s._focusedCell;if(!l)return!1;const o=s.store[`get${i?"Next":"Prev"}`](l.id,!1,r);if(o)return s.focusCell({id:o.id,columnId:l.columnId,scroll:{x:!1}});if(!i&&n&&!l.isColumnHeader)return this.clearFocus(),this.getHeaderElement(l.columnId).focus()}navigateDown(){var i;return(i=arguments[0])!==null&&i!==void 0&&i.fromKeyMap?this.focusCell(K.DOWN):(arguments[0]&&re.deprecate("Grid","6.0.0","Event argument removed, unused param"),this.internalNextPrevRow(!0,!1))}navigateUp(){var i;return(i=arguments[0])!==null&&i!==void 0&&i.fromKeyMap?this.focusCell(K.UP):(arguments[0]&&re.deprecate("Grid","6.0.0","Event argument removed, unused param"),this.internalNextPrevRow(!1,!1))}get widgetClass(){}},T(e,"configurable",{focusable:!1,focusableSelector:".b-grid-cell,.b-grid-header.b-depth-0",keyMap:{ArrowUp:{handler:"navigateUp",weight:10},ArrowRight:{handler:"navigateRight",weight:10},ArrowDown:{handler:"navigateDown",weight:10},ArrowLeft:{handler:"navigateLeft",weight:10},"Ctrl+Home":"navigateFirstCell",Home:"navigateFirstColumn","Ctrl+End":"navigateLastCell",End:"navigateLastColumn",PageUp:"navigatePrevPage",PageDown:"navigateNextPage",Enter:"activateHeader",Escape:{handler:"onEscape",weight:10},"Shift+Tab":{handler:"onShiftTab",preventDefault:!1},Tab:{handler:"onTab",preventDefault:!1}," ":{handler:"onSpace",preventDefault:!1}}}),e},Xm=u=>class extends(u||$){static get $name(){return"GridResponsive"}static get defaultConfig(){return{responsiveLevels:Object.freeze({small:400,medium:600,large:"*"})}}getClosestBiggerLevel(t){const i=this,r=Object.keys(x.assign({},i.responsiveLevels));let n=null,s=99995,l=null;return r.forEach(o=>{let a=i.responsiveLevels[o];if(["number","string"].includes(typeof a)||(a=a.levelWidth),a==="*")l=o;else if(t<a){const d=a-t;d<s&&(s=d,n=o)}}),n||l}get responsiveLevel(){return this.getClosestBiggerLevel(this.width)}updateResponsive(t,i){const r=this,n=r.getClosestBiggerLevel(i),s=r.getClosestBiggerLevel(t);if(i===0||n!==s){const l=r.responsiveLevels[s];["number","string"].includes(typeof l)||r.applyState(l),r.columns.forEach(o=>{const a=o.responsiveLevels;a&&(a[s]?o.applyState(a[s]):a["*"]&&o.applyState(a["*"]))}),r.element.classList.remove("b-responsive-"+n),r.element.classList.add("b-responsive-"+s),r.trigger("responsive",{level:s,width:t,oldLevel:n,oldWidth:i})}}get widgetClass(){}};const Jm={string:1,number:1},Qm={dataset:1,batch:1};var Zm=u=>{var e;return e=class extends(u||$){static get $name(){return"GridSelection"}construct(i){this._selectedCells=[],super.construct(i),i!=null&&i.selectedRecords&&(this.selectedRecords=i.selectedRecords)}getDefaultGridSelection(i){if(i.$name==="GridSelection")return i.configurable.selectionMode;if(i.superclass)return this.getDefaultGridSelection(i.superclass)}changeSelectionMode(i){const r=this;return r.selectionMode?(x.assign(r.selectionMode,i),r.selectionMode):(r.$defaultGridSelection=r.getDefaultGridSelection(r.constructor),new Proxy(i,{set(n,s,l){const o=x.assign({},n);return n[s]=l,r.updateSelectionMode(n,o),!0}}))}updateSelectionMode(i,r=this.$defaultGridSelection){const n=this,{columns:s,checkboxSelectionColumn:l}=n,o={},{rowReorder:a}=n.features;for(const h in i)i[h]!=r[h]&&(o[h]=i[h]);if(i.rowCheckboxSelection&&!i.checkboxOnly&&(i.checkboxOnly=!0,delete i.rowCheckboxSelection),o.column&&(i.cell=!0,i.multiSelect=!0),o.cell&&(i.checkboxOnly=!1),o.cell===!1&&(i.column=!1),o.checkboxOnly&&(i.checkbox||(i.checkbox=!0),i.cell=!1),o.checkbox===!1&&(o.checkboxOnly=!1,o.showCheckAll=!1),o.showCheckAll&&(i.checkbox=!0,i.multiSelect=!0),(o.includeChildren||o.includeParents)&&(i.multiSelect=!0),o.multiSelect===!1&&(i.column=i.showCheckAll=i.dragSelect=i.includeChildren=i.includeParents=!1),o.dragSelect&&(a!=null&&a.enabled&&a.gripOnly!==!0&&(a.showGrip=a.gripOnly=!0),i.multiSelect=!0,n._selectionListenersDetachers={}),o.dragSelect===!1&&n._selectionListenersDetachers){var d,c;(d=(c=n._selectionListenersDetachers).selectiondrag)===null||d===void 0||d.call(c),delete n._selectionListenersDetachers.selectiondrag}r&&(o.cell!==void 0||o.deselectFilteredOutRecords!==void 0||o.multiSelect!==void 0)&&n.deselectAll(),o.rowNumber?s.findRecord("type","rownumber")||(s.insert(0,F(F({},typeof i.rowNumber=="object"?i.rowNumber:{}),{},{type:"rownumber"})),n._selectionAddedRowNumberColumn=!0):o.rowNumber===!1&&n._selectionAddedRowNumberColumn&&(s.remove(s.findRecord("type","rownumber")),delete n._selectionAddedRowNumberColumn),(i.checkbox!==r?.checkbox||i.checkbox&&i.showCheckAll!==r?.showCheckAll)&&(r&&n.deselectAll(),n.isConfiguring?n.shouldInitCheckboxSelection=!0:n.initCheckboxSelection()),r&&i.checkbox&&r.checkbox&&i.checkboxIndex!==r.checkboxIndex&&l&&l.parent.insertChild(l,s.getAt(n.checkboxSelectionColumnInsertIndex)),n.trigger("selectionModeChange",x.clone(i)),n.afterSelectionModeChange(i)}afterConfigure(){this.shouldInitCheckboxSelection&&(this.shouldInitCheckboxSelection=!1,this.initCheckboxSelection()),super.afterConfigure()}initCheckboxSelection(){const i=this,{selectionMode:r,columns:n,checkboxSelectionColumn:s}=i,{checkbox:l}=r;if(s&&(i.checkboxSelectionColumn=null,n.remove(s)),l){var o,a;const d=Ce.getColumnClass("check"),c=l===!0?null:l;if(!d)throw new Error("CheckColumn must be imported for checkbox selection mode to work");const h=i.checkboxSelectionColumn=new d(x.assign({id:`${i.id}-selection-column`,width:"4em",minWidth:"4em",field:null,sortable:!1,filterable:!1,cellCls:"b-checkbox-selection",region:(o=i.items)===null||o===void 0||(a=o[0])===null||a===void 0?void 0:a.region,showCheckAll:r.showCheckAll,draggable:!1,resizable:!1,widgets:[{type:"checkbox",valueProperty:"checked",ariaLabel:"L{Checkbox.toggleRowSelect}"}]},c),n,{isSelectionColumn:!0});h.meta.depth=0,h._grid=i;const g=h.renderer;h.renderer=f=>{f.value=i.isSelected(f.record),g.call(h,f)},h.ion({toggle:"onCheckChange",toggleAll:"onCheckAllChange",thisObj:i}),n.insert(i.checkboxSelectionColumnInsertIndex,h)}}get checkboxSelectionColumnInsertIndex(){const{columns:i}=this;let{checkboxIndex:r}=this.selectionMode;return r?typeof r=="string"&&(r=i.indexOf(i.getById(r))):r=i.indexOf(i.findRecord("type","rownumber"))+1,r}afterSelectionChange(){}afterSelectionModeChange(){}changeSelectedRecordCollection(i){return i instanceof at?i:new at(i)}updateSelectedRecordCollection(i){i.ion({change:"onSelectedRecordCollectionChange",thisObj:this})}onSelectedRecordCollectionChange({added:i=[],removed:r}){this.selectedRecordCollection._fromSelection||(i=i.filter(n=>this.isSelectable(n)),this.performSelection({selectedCells:[],deselectedCells:[],selectedRecords:i,deselectedRecords:r}))}changeSelectedRecordCollectionSilent(i){this.selectedRecordCollection._fromSelection=!0;const r=i(this.selectedRecordCollection);return delete this.selectedRecordCollection._fromSelection,r}bindStore(i){var r;this.detachListeners("selectionStoreFilter"),i.ion({name:"selectionStoreFilter",filter:"onStoreFilter",thisObj:this}),(r=super.bindStore)===null||r===void 0||r.call(this,i)}unbindStore(i){this.detachListeners("selectionStoreFilter"),super.unbindStore(i)}onStoreFilter({source:i}){const r=this,n=[];for(const l of r.selectedRecords)i.includes(l)||n.push(l);const s=r.prepareSelection(r.selectionMode.deselectFilteredOutRecords?n:[]);if(r.isCellSelectionMode){const{deselectedCells:l}=r.prepareSelection(r.getSelectedCellsForRecords(n));l!=null&&l.length&&(s.deselectedCells=(s.deselectedCells||[]).concat(l))}(s.deselectedCells.length||s.deselectedRecords.length)&&(r.performSelection(s,!1),r.updateCheckboxHeader())}onStoreRecordIdChange({record:i,oldValue:r}){var n;(n=super.onStoreRecordIdChange)===null||n===void 0||n.call(this,...arguments),this.selectedRecordCollection.get(r)===i&&this.selectedRecordCollection.rebuildIndices()}onStoreRemove(i){var r;if((r=super.onStoreRemove)===null||r===void 0||r.call(this,i),!i.isCollapse){const n=this,s=i.records.filter(l=>this.isSelected(l));if(s.length){const l=n.prepareSelection(s);if(n.isCellSelectionMode){const{deselectedCells:o}=n.prepareSelection(n.getSelectedCellsForRecords(s));o!=null&&o.length&&(l.deselectedCells=(l.deselectedCells||[]).concat(o))}n.performSelection(l)}}}onStoreDataChange({action:i,source:r}){var n;const s=this,{selectionMode:l}=s;let o;if((n=super.onStoreDataChange)===null||n===void 0||n.call(this,...arguments),i==="pageLoad")l.preserveSelectionOnPageChange||(o=s.prepareSelection(null,null,!0)),s.updateCheckboxHeader();else if(Qm[i]){const a=[];if(l.preserveSelectionOnDatasetChange===!1)o=s.prepareSelection(null,null,!0);else{a.push(...s.changeSelectedRecordCollectionSilent(d=>d.match(r.storage)));for(const d of s._selectedCells)r.getById(d.id)||a.push(d);o=s.prepareSelection(a)}}o&&(s.performSelection(o,!1),s.updateCheckboxHeader())}onStoreRemoveAll(){var i;(i=super.onStoreRemoveAll)===null||i===void 0||i.call(this),this.performSelection(this.prepareSelection(null,null,!0),!1)}onCheckChange({checked:i,record:r}){const n=this,s=!n.selectionMode.multiSelect&&i,l=!s&&!i?[r]:null,o=i?[r]:null;i&&!te.shiftKeyDown&&(n._lastSelectionChecked=r),i&&n._lastSelectionChecked&&te.shiftKeyDown?n.performSelection(n.internalSelectRange(n._lastSelectionChecked,r,!0)):n.performSelection(n.prepareSelection(l,o,s,!0))}updateCheckboxHeader(){const{selectionMode:i,checkboxSelectionColumn:r,store:n}=this;if(i.checkbox&&i.showCheckAll&&r!==null&&r!==void 0&&r.headerCheckbox){const s=n.count&&!n.some(l=>!this.isSelected(l));r.headerCheckbox.checked!==s&&(r.suspendEvents(),r.headerCheckbox.checked=s,r.resumeEvents())}}onCheckAllChange({checked:i}){this[i?"selectAll":"deselectAll"](this.store.isPaged&&this.selectionMode.preserveSelectionOnPageChange)}onSelectionDrag(i){const r=this,{_selectionStartCell:n}=r;if(te.isMouseDown()||r.onSelectionEnd(),!n)return;const{items:s,_lastSelectionDragRegion:l}=r,o=r.getCellDataFromEvent(i,!0),a=o?.column.region,d=o?.cellSelector&&r.normalizeCellContext(o.cellSelector);if(d&&!d.equals(r._lastSelectionDragCell,!0)){if(r._isSelectionDragging||r.enableScrollingCloseToEdges(s),r._clearSelectionOnSelectionDrag&&!n.equals(d,!0)&&(r.deselectAll(),delete r._clearSelectionOnSelectionDrag),l&&a!==l){var c,h;const f=r.subGrids[l],m=r.subGrids[a],p=f.scrollable,v=m.scrollable,y=s.indexOf(f)-s.indexOf(m)<0;if(v.x=y?0:v.maxX,y?p.x<p.maxX-1:p.x>1)return;(c=r.scrollManager._activeScroll)===null||c===void 0||(h=c.horizontal)===null||h===void 0||h.stopScroll()}r._lastSelectionDragRegion=a,r._lastSelectionDragCell=d,r._isSelectionDragging=!0;const g=r._lastSelectionDragChange=r.internalSelectRange(n,d,r.isRowNumberSelecting(d)||r.isRowNumberSelecting(n));g.deselectedCells=g.deselectedCells.filter(f=>!r.isCellSelected(f)),g.deselectedRecords=g.deselectedRecords.filter(f=>!r.isSelected(f)),r.refreshGridSelectionUI(g),r.trigger("dragSelecting",g)}}onSelectionEnd(){var i,r;const n=this,s=n._lastSelectionDragChange;n._isSelectionDragging&&!n._selectionStartCell.equals(n._lastSelectionDragCell,!0)&&s&&n.performSelection(s,!1),n.disableScrollingCloseToEdges(n.items),n._isSelectionDragging=!1,n._lastSelectionDragChange=null,n._lastSelectionDragCell=null,(i=(r=n._selectionListenersDetachers).selectiondrag)===null||i===void 0||i.call(r),delete n._selectionListenersDetachers.selectiondrag}onHandleElementClick(i){const r=this;r.selectionMode.rowNumber&&i.target.closest(".b-rownumber-header")?(i.handled=!0,r.store.count&&r.store.some(n=>!r.isSelected(n))?r.selectAll():r.deselectAll()):r.selectionMode.column&&i.target.closest(".b-grid-header")&&(i.handled=!0,r.selectColumn(i,i.ctrlKey)),super.onHandleElementClick(i)}selectColumn(i,r=!1){const n=this,{store:s}=n,{columnId:l}=n.getHeaderDataFromEvent(i);n._shiftSelectRange=null,i.shiftKey||(n._shiftSelectColumn=l);const o=i.shiftKey&&n._shiftSelectColumn||l,a=n.internalSelectRange(n.normalizeCellContext({id:s.first.id,columnId:o}),n.normalizeCellContext({id:s.last.id,columnId:l}));r&&!a.selectedCells.some(d=>!n.isCellSelected(d))&&(a.deselectedCells=a.selectedCells,a.selectedCells=[]),r||(a.deselectedCells=n._selectedCells),n.cleanSelectionChange(a),n.performSelection(a)}isSelected(i){var r;return(r=i)!==null&&r!==void 0&&r.id&&(i=i.id),Jm[typeof i]?Boolean(this.selectedRecordCollection.get(i)):!1}isCellSelected(i,r){return i=this.normalizeCellContext(i),this.isCellSelectionMode&&this._selectedCells.some(n=>i.equals(n,!0))||r&&this.isSelected(i)}isSelectable(i){return this.normalizeCellContext({id:i.id||i}).isSelectable}get selectedRecord(){return this.selectedRecords[this.selectedRecords.length-1]||null}set selectedRecord(i){this.selectRow({record:i})}get selectedRecords(){return this.selectedRecordCollection.values}set selectedRecords(i){this.selectRows(i)}spliceSelectedRecords(i,r,n){const s=this;if(typeof r=="number"){const l=[...s.selectedRecords];l.splice(i,r,...B.asArray(n)),s.performSelection(s.prepareSelection(null,l,!0,!0))}else s.performSelection(s.prepareSelection(r,n,!1,!0))}selectRow(i){(typeof i=="number"||i.isModel||!("record"in i))&&(i={records:[i]}),x.assignIf(i,{scrollIntoView:!0}),this.selectRows(i)}selectRows(i){(!i||Array.isArray(i)||i.isModel||typeof i=="number"||!("records"in i)&&!("record"in i))&&(i={records:B.asArray(i)||[]});const r=this,{store:n}=r,s=[],{records:l=i.record?[i.record]:[],column:o=r.columns.visibleColumns[0],scrollIntoView:a,addToSelection:d=arguments[1]}=i;for(let c of l)c=n.getById(c),c&&s.push(c);d||(r._shiftSelectRange=null),r.performSelection(r.prepareSelection(null,s,!d,!0)),s.length&&a&&r.scrollRowIntoView(s[0].id,{column:o})}selectAll(i=!1){const{store:r}=this,n=(r.isGrouped?r.allRecords:r.records).filter(s=>!s.isSpecialRow);this.performSelection(this.prepareSelection(null,n,!1,!0),!0,i)}deselectAll(i=!1,r=!1){const{store:n}=this,s=i?(n.isGrouped?n.allRecords:n.records).filter(l=>!l.isSpecialRow):null;this.performSelection(this.prepareSelection(s,null,!i),!0,r)}deselectRow(i){this.deselectRows(i)}deselectRows(i){const{store:r}=this,n=B.asArray(i).map(s=>r.getById(s)).filter(s=>s);this.performSelection(this.prepareSelection(n))}selectRange(i,r,n=!1){const s=this,{store:l}=s,o=s.internalSelectRange(l.getById(i),l.getById(r),!0);s._shiftSelectRange=null,s.performSelection(o)}get selectedCell(){return this._selectedCells[this._selectedCells.length-1]}set selectedCell(i){this.selectCells([i])}get selectedCells(){return[...this._selectedCells]}set selectedCells(i){this.selectCells(i)}get selectedCellCSSSelector(){const i=this.selectedCell,r=i&&this.getRowById(i.id);return!i||!r?"":`[data-index=${r.dataIndex}] [data-column-id=${i.columnId}]`}selectCell(i){var r;return"id"in i&&(i={cell:i},i=Object.assign({scrollIntoView:arguments[1],addToSelection:arguments[2],silent:arguments[3]},i)),(r=this.selectCells(i))===null||r===void 0?void 0:r[0]}selectCells(i){Array.isArray(i)&&(i={cells:i});const r=this,{cells:n=i.cell?[i.cell]:[],scrollIntoView:s=!0,addToSelection:l=!1,silent:o=!1}=i,a=r.prepareSelection(null,n,!l);return l||(r._shiftSelectRange=null),r.performSelection(a,!0,o),s&&r.scrollRowIntoView(n[0].id,{column:n[0].columnId}),r.isCellSelectionMode?a.selectedCells:a.selectedRecords}deselectCell(i){var r;return(r=this.deselectCells([i]))===null||r===void 0?void 0:r[0]}deselectCells(i){const r=this.prepareSelection(i);return this.performSelection(r),this.isCellSelectionMode?r.deselectedCells:r.deselectedRecords}toggleSelection(i){const r=this,{_focusedCell:n,selectionMode:s}=r,l=r.isRowNumberSelecting(n),o=r.isCellSelected(n,!0);if(s.selectOnKeyboardNavigation===!0||n.isActionable)return!1;r.performSelection(r.prepareSelection(o?n:null,o?null:n,!s.multiSelect,l)),i.preventDefault()}selectCellRange(i,r){this.performSelection(this.internalSelectRange(i,r))}getSelection(){return this.isRowSelectionMode?this.selectedRecords:this.selectedCells}cleanSelectionChange(i){const{deselectedRecords:r,selectedRecords:n,deselectedCells:s,selectedCells:l}=i;return r!=null&&r.length&&n!==null&&n!==void 0&&n.length&&(i.deselectedRecords=r.filter(o=>!n.some(a=>o===a))),s!=null&&s.length&&l!==null&&l!==void 0&&l.length&&(i.deselectedCells=s.filter(o=>!l.some(a=>o.equals(a,!0)))),i}getSelectedCellsForRecords(i){return this._selectedCells.filter(r=>r.id&&i.some(n=>n.id===r.id))}delayUntilMouseUp(i){const r=A.on({element:globalThis,blur:n=>i(n,r),mouseup:n=>i(n,r),thisObj:this,once:!0})}get isRowSelectionMode(){return!this.isCellSelectionMode}get isCellSelectionMode(){return this.selectionMode.cell===!0}isRowNumberSelecting(...i){return this.selectionMode.rowNumber&&!i.some(r=>r.column.type!=="rownumber")}extendSelectionLeft(){this.extendSelection("Left")}extendSelectionRight(){this.extendSelection("Right")}extendSelectionUp(){this.extendSelection("Up")}extendSelectionDown(){this.extendSelection("Down")}extendSelection(i){this._isKeyboardRangeSelecting=!0,this["navigate"+i](),this._isKeyboardRangeSelecting=!1}onCellNavigate(i,r,n,s){var l;const{selectionMode:o,_selectionListenersDetachers:a}=i,{rowReorder:d}=i.features,{multiSelect:c,deselectOnClick:h,dragSelect:g}=o,{ctrlKeyDown:f,shiftKeyDown:m}=te,p=te.isMouseDown(),v=te.isMouseDown(2),y=te.currentMouseDown||te.currentKeyDown,C=y?.target;if(n=i.normalizeCellContext(n),!s||n.rowIndex===-1||(l=n.record)!==null&&l!==void 0&&l.isGroupHeader||y!=null&&y.fromKeyMap&&!o.selectOnKeyboardNavigation||i.columns.getById(n.columnId)===i.checkboxSelectionColumn||o.checkboxOnly||C&&d!==null&&d!==void 0&&d.gripOnly&&d.isElementDraggable(C,y)||y?.handled===!0)return;m||(i._isAddingToSelection=f&&c,i._selectionStartCell=n),c&&g&&p&&!a.selectiondrag&&(a.selectiondrag=A.on({name:"selectiondrag",element:globalThis,blur:"onSelectionEnd",mouseup:"onSelectionEnd",mousemove:"onSelectionDrag",thisObj:i}));const w=i._selectionStartCell,S=i._isAddingToSelection;if((m&&p||i._isKeyboardRangeSelecting)&&w&&c)i.performSelection(i.internalSelectRange(w,n,i.isRowNumberSelecting(w,n)));else{let D=!1,I=!0,R;if(i.isCellSelected(n,!0)){if(v)return;if(S||h)R=h?null:[n],I=!1;else if(i.selectedRecords.length+(i.isCellSelectionMode?i._selectedCells.length:0)<=1)return;D=h||c}!R&&!S&&(R=null,g&&D&&a.selectiondrag&&(i._clearSelectionOnSelectionDrag=!0));const H=(L,V)=>{var U;if(V?.(),(L==null||(U=L.target)===null||U===void 0?void 0:U.nodeType)===Node.ELEMENT_NODE){const Y=new K(L.target);if(Y!=null&&Y.grid&&!Y.equals(n,!0))return}m||(i._shiftSelectRange=null),i.performSelection(i.prepareSelection(R,I&&[n],R===null,I&&i.isRowNumberSelecting(n)))};D?i.delayUntilMouseUp(H):H()}}prepareSelection(i,r,n=!1,s=!1){const l=this,o=l._isSelectionDragging,{includeParents:a}=l.selectionMode,d=[],c=[];let h=[],g=[];if(n)h=l._selectedCells,g=l.selectedRecords;else if(i)for(const p of B.asArray(i)){const v=l.normalizeCellContext(p),y=v?.record||(p.isModel?p:l.store.getById(v.id));if(!v.isSpecialRow&&(h.push(v),y&&!g.some(C=>C.id===y.id))){var f;if((o||l.isSelected(y))&&g.push(y),l.selectionMode.includeChildren&&l.selectionMode.multiSelect&&!y.isLeaf&&(f=y.allChildren)!==null&&f!==void 0&&f.length)for(const C of y.allChildren)!g.some(w=>w.id===C.id)&&(o||l.isSelected(C))&&g.push(C)}}if(r)for(const p of B.asArray(r)){const v=l.normalizeCellContext(p),y=v?.record||(p.isModel?p:l.store.getById(v.id));if(y&&!v.isSpecialRow&&(l.isCellSelectionMode&&!s&&c.push(v),(l.isRowSelectionMode||s)&&!d.some(C=>C.id===y.id))){var m;if(d.push(y),l.selectionMode.includeChildren&&l.selectionMode.multiSelect&&!y.isLeaf&&(m=y.allChildren)!==null&&m!==void 0&&m.length)for(const C of y.allChildren)d.some(w=>w.id===C.id)||d.push(C)}}if(a&&(g.length||d.length)){const p=[...g,...d];B.unique(p.filter(y=>y.parent&&!y.allChildren.some(C=>p.includes(C))).map(y=>y.parent)).forEach(y=>l.toggleParentSelection(y,d,g))}return l.cleanSelectionChange({selectedCells:c,selectedRecords:d,deselectedCells:h,deselectedRecords:g,deselectAll:n,action:d!=null&&d.length||c!=null&&c.length?"select":"deselect"})}toggleParentSelection(i,r,n){if(!i||i.isRoot)return;const s=this.isSelected(i),l=r.includes(i),o=n.includes(i),a=d=>this.isSelected(d)&&!n.includes(d)||r.includes(d);this.selectionMode.includeParents==="some"?i.allChildren.some(a)?(!s||o)&&!l&&r.push(i):s&&!o&&n.push(i):s?!o&&!l&&i.allChildren.some(d=>n.includes(d))&&n.push(i):l||i.allChildren.every(a)&&r.push(i),i.parent&&this.toggleParentSelection(i.parent,r,n)}internalSelectRange(i,r,n=!1){const s=this,l=s.isRowSelectionMode||n,o=s.prepareSelection(s._shiftSelectRange,s.getRange(i,r,l),!1,n);return s._shiftSelectRange=o[`selected${l?"Records":"Cells"}`],o}getRange(i,r,n=!1){const s=this,{store:l}=s,o=s.normalizeCellContext(i),a=s.normalizeCellContext(r),d=Math.min(o.rowIndex,a.rowIndex),c=Math.max(o.rowIndex,a.rowIndex),h=[],g=Math.min(o.columnIndex,a.columnIndex),f=Math.max(o.columnIndex,a.columnIndex);if(d===-1||c===-1)throw new Error("Record not found in selectRange");if(n){const m=l.getRange(d,c+1,!1);a.rowIndex<o.rowIndex&&m.reverse(),h.push(...m)}else for(let m=d;m<=c;m++)for(let p=g;p<=f;p++)h.push({rowIndex:m,columnIndex:p});return h.map(m=>s.normalizeCellContext(m))}performSelection(i,r=!0,n=!1){const s=this,{selectedRecords:l,selectedCells:o,deselectedRecords:a,deselectedCells:d,action:c}=i,h=s.isRowSelectionMode;if(s.trigger("beforeSelectionChange",{mode:h?"row":"cell",action:c,selected:(h?l:o)||[],deselected:(h?a:d)||[],selection:(h?s.selectedRecords:s.selectedCells)||[]})!==!1){if(s._selectedCells===d)s._selectedCells=[];else{const g=[];for(const f of s._selectedCells)d.some(m=>f.equals(m,!0))||g.push(f);s._selectedCells=g}if(i.deselectedRecords=[...i.deselectedRecords],a===s.selectedRecords)s.changeSelectedRecordCollectionSilent(g=>g.clear());else{const g=[];for(const f of s.selectedRecords)a.some(m=>f.id===m.id)||g.push(f);s.changeSelectedRecordCollectionSilent(f=>f.values=g)}if(o.length)for(const g of o)s._selectedCells.some(f=>f.equals(g,!0))||s._selectedCells.push(g);l.length&&s.changeSelectedRecordCollectionSilent(g=>g.add(...l)),r&&s.refreshGridSelectionUI(i),s.afterSelectionChange(i),n||s.triggerSelectionChangeEvent(i)}}refreshGridSelectionUI({selectedRecords:i,selectedCells:r,deselectedRecords:n,deselectedCells:s}){const l=this,{checkboxSelectionColumn:o}=l;o?.suspendEvents(),l.updateGridSelectionRecords(i,!0),l.updateGridSelectionRecords(n,!1),l.updateCheckboxHeader(),o?.resumeEvents(),l.isCellSelectionMode&&(l.updateGridSelectionCells(r,!0),l.selectionMode.column&&l.updateGridSelectionColumns(r)),l.updateGridSelectionCells(s,!1)}updateGridSelectionRecords(i,r){const{checkboxSelectionColumn:n}=this;if(i!=null&&i.length)for(let s=0;s<i.length;s++){const l=this.getRowFor(i[s]);l&&(l.toggleCls("b-selected",r),l.setAttribute("aria-selected",r),n&&!n.hidden&&!i[s].isSpecialRow&&(l.getCell(n.id).widget.checked=r))}}updateGridSelectionCells(i,r){if(i!=null&&i.length)for(let n=0;n<i.length;n++){const s=this.getCell(i[n]);s&&(s.setAttribute("aria-selected",r),s.classList.toggle("b-selected",r))}}updateGridSelectionColumns(i){const{count:r}=this.store;for(const s of this.columns.visibleColumns){var n;(n=s.element)===null||n===void 0||n.classList.toggle("b-selected",i?.filter(l=>l.columnId===s.id).length===r)}}triggerSelectionChangeEvent(i){const r=this.isRowSelectionMode;this.trigger("selectionChange",{mode:r?"row":"cell",action:i.action,selected:(r?i.selectedRecords:i.selectedCells)||[],deselected:(r?i.deselectedRecords:i.deselectedCells)||[],selection:(r?this.selectedRecords:this.selectedCells)||[]})}doDestroy(){var i;(i=this.selectedRecordCollection)===null||i===void 0||i.destroy(),this._selectedCells.length=0;for(const r in this._selectionListenersDetachers)this._selectionListenersDetachers[r]();super.doDestroy()}get widgetClass(){}},T(e,"configurable",{selectionMode:{cell:!1,multiSelect:!0,checkboxOnly:!1,checkbox:!1,checkboxPosition:null,showCheckAll:!1,deselectFilteredOutRecords:!1,includeChildren:!1,includeParents:!1,preserveSelectionOnPageChange:!1,preserveSelectionOnDatasetChange:!0,deselectOnClick:!1,dragSelect:!1,selectOnKeyboardNavigation:!0,column:!1,rowNumber:!1},keyMap:{"Shift+ArrowUp":"extendSelectionUp","Shift+ArrowDown":"extendSelectionDown","Shift+ArrowLeft":"extendSelectionLeft","Shift+ArrowRight":"extendSelectionRight"," ":{handler:"toggleSelection",weight:10}},selectedRecordCollection:{}}),e};const ep=u=>u.columns.suspendEvents(),tp=u=>u.columns.resumeEvents(),ip=u=>{u.columns.clearCaches(),u.columns.fillFromMaster()},xs=(u,e)=>u.stateSortIndex-e.stateSortIndex;var rp=u=>class extends(u||$){static get $name(){return"GridState"}static get configurable(){return{statefulEvents:["subGridCollapse","subGridExpand","horizontalScroll","stateChange"]}}updateStore(t,i){var r;(r=super.updateStore)===null||r===void 0||r.call(this,t,i),this.detachListeners("stateStoreListeners"),t?.ion({name:"stateStoreListeners",filter:"triggerUpdate",group:"triggerUpdate",sort:"triggerUpdate",thisObj:this})}updateColumns(t,i){var r;(r=super.updateColumns)===null||r===void 0||r.call(this,t,i),this.detachListeners("stateColumnListeners"),t.ion({name:"stateColumnListeners",change:"triggerUpdate",thisObj:this})}updateRowManager(t,i){var r;(r=super.updateRowManager)===null||r===void 0||r.call(this,t,i),this.detachListeners("stateRowManagerListeners"),t.ion({name:"stateRowManagerListeners",rowHeight:"triggerUpdate",thisObj:this})}triggerUpdate(){this.trigger("stateChange")}finalizeInit(){super.finalizeInit(),this.ion({selectionChange:"triggerUpdate",thisObj:this})}getState(){const t=this,i=t.element.style.cssText,r={rowHeight:t.rowHeight};if(i&&(r.style=i),t.selectedCell){const{id:n,columnId:s}=t.selectedCell;r.selectedCell={id:n,columnId:s}}return r.selectedRecords=t.selectedRecords.map(n=>n.id),r.columns=t.columns.allRecords.map(n=>n.getState()),r.store=t.store.state,r.scroll=t.storeScroll(),r.subGrids={},t.eachSubGrid(n=>{var s;const l=r.subGrids[n.region]=r.subGrids[n.region]||{};n.isPainted?n.flex==null&&(l.width=n.width):n.config.width!=null?l.width=n.config.width:l.flex=n.config.flex,l.collapsed=(s=n.collapsed)!==null&&s!==void 0?s:!1,l.collapsed&&(l._beforeCollapseState=n._beforeCollapseState)}),r}applyState(t){const i=this;if(i.suspendRefresh(),"columns"in t){let r=!1,n=!1;i.columns.suspendEvents(),i.eachSubGrid(ep),t.columns.forEach((s,l)=>{const o=i.columns.getById(s.id);if(o){const a=o.generation;o.applyState(s),r=r||o.generation!==a,o.stateSortIndex=l,o.allIndex!==l&&(n=r=!0)}}),r&&i.eachSubGrid(ip),n&&(i.eachSubGrid(s=>{s.columns.records.sort(xs),s.columns.allRecords.sort(xs)}),i.columns.sort({fn:xs,ascending:!0})),i.isPainted&&r&&i.renderContents(),i.columns.resumeEvents(),i.eachSubGrid(tp)}"subGrids"in t&&i.eachSubGrid(r=>{if(r.region in t.subGrids){const n=t.subGrids[r.region];"width"in n?r.width=n.width:"flex"in n&&(r.flex=n.flex),"collapsed"in n&&(r.collapsed=n.collapsed,r._beforeCollapseState=n._beforeCollapseState)}r.clearWidthCache()}),"rowHeight"in t&&(i.rowHeight=t.rowHeight),"style"in t&&(i.style=t.style),"selectedCell"in t&&(i.selectedCell=t.selectedCell),"store"in t&&(i.store.state=t.store),"selectedRecords"in t&&(i.selectedRecords=t.selectedRecords),i.resumeRefresh(!0),i.eachSubGrid(r=>r.refreshFakeScroll()),"scroll"in t&&(i.restoreScroll(t.scroll),t.scroll.scrollTop&&i.element.querySelectorAll(".b-resize-monitored").forEach(r=>{const n=lr.fromElement(r);n&&n.onElementResize(r)}))}get widgetClass(){}};const Ss=Promise.resolve(),np={block:"nearest"};class Ic extends ot{static get configurable(){return{propagate:!1,overflowX:"hidden-scroll"}}scrollIntoView(e,t=np){const i=this,{xDelta:r,yDelta:n}=i.getDeltaTo(e,t),s=r||n?i.scrollBy(r,n,t):Ss;return(t.highlight||t.focus)&&s.then(()=>{t.highlight&&(e instanceof O?e.translate(-r,-n).highlight():b.highlight(e)),t.focus&&e.focus&&e.focus()}),s}scrollBy(e,t,i){const r=t&&this.yScroller.scrollBy(0,t,i),n=e&&super.scrollBy(e,0,i);if(n&&n.cancel&&r&&r.cancel){const s=n.cancel,l=r.cancel;return n.cancel=r.cancel=()=>{s(),l()},Promise.all([n,r])}return n||r||Ss}scrollTo(e,t,i){const r=t!=null&&this.yScroller.scrollTo(null,t,i),n=e!=null&&super.scrollTo(e,null,i);if(i&&i.animate||this.syncPartners(),n&&n.cancel&&r&&r.cancel){const s=n.cancel,l=r.cancel;return n.cancel=r.cancel=()=>{s(),l()},Promise.all([n,r])}return n||r||Ss}get viewport(){const e=O.from(this.element);return e.intersect(O.from(this.yScroller.element))||new O(e.x,e.y,e.width,0)}set y(e){this.yScroller&&(this.yScroller.y=e)}get y(){return this.yScroller?this.yScroller.y:0}get maxY(){return this.yScroller?this.yScroller.maxY:0}get scrollHeight(){return this.yScroller?this.yScroller.scrollHeight:0}get clientHeight(){return this.yScroller?this.yScroller.clientHeight:0}}Ic._$name="SubGridScroller";const sp=(u,e)=>u+e.getBoundingClientRect().width;class er extends k{static get $name(){return"SubGrid"}static get type(){return"subgrid"}static get defaultConfig(){return{insertRowsBefore:null,appendTo:null,monitorResize:!0,headerClass:null,footerClass:null,weight:null,collapsed:null,scrollable:{overflowX:"hidden-scroll"},scrollerClass:Ic,hasCalculatedWidth:null,sealedColumns:null}}static get configurable(){return{element:!0,header:{},footer:{},virtualScrollerElement:!0,splitterElement:!0,headerSplitter:!0,scrollerSplitter:!0,footerSplitter:!0,resizable:null,role:"presentation"}}construct(e){const t=this;if(super.construct(e),this.rowManager.ion({addRows:"onAddRow",thisObj:this}),W.isFirefox){const{element:i}=t,r=t.grid.scrollable;let n=0;i.addEventListener("wheel",({ctrlKey:s,deltaY:l,deltaX:o})=>{const a=Math.abs(l)>Math.abs(o);!s&&a&&!t.scrollEndDetacher&&r.y!==n&&(i.style.pointerEvents="none",n=r.y,t.scrollEndDetacher=r.ion({scrollEnd:async()=>{n=r.y,i.style.pointerEvents="",t.scrollEndDetacher=null},once:!0}))})}}doDestroy(){var e;const t=this;t.header.destroy(),t.footer.destroy(),(e=t.fakeScroller)===null||e===void 0||e.destroy(),t.virtualScrollerElement.remove(),t.splitterElements.forEach(i=>i.remove()),super.doDestroy()}get barConfig(){const e=this,{width:t,flex:i}=e.element.style,r={subGrid:e,parent:e,maxWidth:e.maxWidth||void 0,minWidth:e.minWidth||void 0};return i?r.flex=i:t&&(r.width=t),r}changeHeader(e){return new this.headerClass(x.assign({id:this.id+"-header"},this.barConfig,e))}changeFooter(e){return new this.footerClass(x.assign({id:this.id+"-footer"},this.barConfig,e))}get splitterElements(){return[this.splitterElement,this.headerSplitter,this.scrollerSplitter,this.footerSplitter]}toggleSplitterCls(e,t=!0){this.splitterElements.forEach(i=>i?.classList[t?"add":"remove"](e))}hideSplitter(){this.splitterElements.forEach(e=>e.classList.add("b-hide-display")),this.$showingSplitter=!1}showSplitter(){this.splitterElements.forEach(e=>e.classList.remove("b-hide-display")),this.$showingSplitter=!0}changeElement(e,t){const{region:i}=this;return super.changeElement({"aria-label":i,className:{"b-grid-subgrid":1,[`b-grid-subgrid-${i}`]:i,"b-grid-subgrid-collapsed":this.collapsed},dataset:{region:i}},t)}get rowElementConfig(){const{grid:e}=this;return{role:"row",className:e.rowCls,children:this.columns.visibleColumns.map((t,i)=>({role:"gridcell","aria-colindex":i+1,tabIndex:e.cellTabIndex,className:"b-grid-cell",dataset:{column:t.field||"",columnId:t.id}}))}}changeVirtualScrollerElement(){const e=b.createElement({role:"presentation",reference:"virtualScrollerElement",className:"b-virtual-scroller",tabIndex:-1,dataset:{region:this.region},children:[{reference:"virtualScrollerWidth",className:"b-virtual-width"}]});return this.virtualScrollerWidth=e.virtualScrollerWidth,e.virtualScrollerElement}changeSplitterElement(){const e=b.createElement({reference:"splitterElement",className:{"b-grid-splitter":1,"b-grid-splitter-collapsed":this.collapsed,"b-hide-display":1},dataset:{region:this.region},children:[W.isTouchDevice?{className:"b-splitter-touch-area"}:null,{className:"b-grid-splitter-inner b-grid-splitter-main",children:[{className:"b-grid-splitter-buttons",reference:"splitterButtons",children:[{className:"b-grid-splitter-button-collapse",children:[W.isTouchDevice?{className:"b-splitter-button-touch-area"}:null,{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",className:"b-grid-splitter-button-icon b-gridregion-collapse-arrow",viewBox:"0 0 256 512",children:[{tag:"path",d:"M192 448c-8.188 0-16.38-3.125-22.62-9.375l-160-160c-12.5-12.5-12.5-32.75 0-45.25l160-160c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L77.25 256l137.4 137.4c12.5 12.5 12.5 32.75 0 45.25C208.4 444.9 200.2 448 192 448z"}]}]},{className:"b-grid-splitter-button-expand",children:[W.isTouchDevice?{className:"b-splitter-button-touch-area"}:null,{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",className:"b-grid-splitter-button-icon b-gridregion-expand-arrow",viewBox:"0 0 256 512",children:[{tag:"path",d:"M64 448c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L178.8 256L41.38 118.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l160 160c12.5 12.5 12.5 32.75 0 45.25l-160 160C80.38 444.9 72.19 448 64 448z"}]}]}]}]}]});return this.splitterButtons=e.splitterButtons,e.splitterElement}get splitterConfig(){return{className:this.splitterElement.className.trim(),children:[W.isTouchDevice?{className:"b-splitter-touch-area"}:null,{className:"b-grid-splitter-inner"}],dataset:{region:this.region}}}changeHeaderSplitter(){return b.createElement(this.splitterConfig)}changeScrollerSplitter(){return b.createElement(this.splitterConfig)}changeFooterSplitter(){return b.createElement(this.splitterConfig)}render(...e){const t=this;super.render(...e),t.grid&&(t.updateHasFlex(),t.element.parentNode.insertBefore(t.splitterElement,t.element.nextElementSibling),t.splitterElements.forEach(i=>A.on({element:i,mouseenter:"onSplitterMouseEnter",mouseleave:"onSplitterMouseLeave",thisObj:t})),t._collapsed&&t.collapse())}refreshHeader(){this.header.refreshContent()}refreshFooter(){var e;(e=this.footer)===null||e===void 0||e.refreshContent()}eachWidget(e,t=!0){const i=this,r=[i.header,i.footer];for(let n=0;n<r.length;n++){const s=r[n];if(e(s)===!1)return;t&&s.eachWidget&&s.eachWidget(e,t)}}fixCellWidths(e){const{visibleColumns:t}=this.columns;let i=e.firstElementChild,r=0;for(;i;){const n=t[r],{element:s}=n;n.minWidth&&(i.style.minWidth=b.setLength(n.minWidth)),n.maxWidth&&(i.style.maxWidth=b.setLength(n.maxWidth)),n.flex?n.childLevel&&s?(i.style.flex=`0 0 ${s.getBoundingClientRect().width}px`,i.style.width=""):(i.style.flex=n.flex,i.style.width=""):n.width?i.style.width=b.setLength(n.width):i.style.flex=i.style.width=i.style.minWidth="",i=i.nextElementSibling,r++}}get totalFixedWidth(){return this.columns.totalFixedWidth}fixWidths(){const e=this,{element:t,header:i,footer:r}=e;if(!e.collapsed){if(e.flex)i.flex=e.flex,r&&(r.flex=e.flex),t.style.flex=e.flex;else{if(e.hasCalculatedWidth&&!e.columns.some(s=>!s.hidden&&s.flex)&&e.totalFixedWidth!==e.width){e.width=e.totalFixedWidth,e.hasCalculatedWidth=!0;return}let n=e.width;if(!n&&e.hasCalculatedWidth){n=0;for(const s of e.columns)!s.flex&&!s.hidden&&(n+=s.width)}t.style.width=`${n}px`,i.width=n,r&&(r.width=n)}e.syncScrollingPartners(!1)}}fixRowWidthsInSafariEdge(){if(W.isSafari){const e=this,{region:t,header:i}=e,r=i.calculateMinWidthForSafari();e.rowManager.forEach(n=>{const s=n.getElement(t);s&&(s.style.width=`${r}px`)}),i.headersElement.style.width=`${r}px`}}set width(e){const t=this;t.hasCalculatedWidth=!1,super.width=e,t.header.width=e,t.footer.width=e,t.isPainted&&t.onElementResize()}get width(){return super.width}set flex(e){const t=this;t.hasCalculatedWidth=!1,t.header.flex=e,t.footer.flex=e,super.flex=e,t.isPainted&&t.onElementResize()}get flex(){return super.flex}onInternalResize(e,t,i,r,n){const s=this,{grid:l}=s;super.onInternalResize(...arguments),l!=null&&l.isPainted&&(s.syncSplitterButtonPosition(),t!==r&&(l.trigger("horizontalScroll",{grid:l,subGrid:s,scrollLeft:s.scrollable.element.scrollLeft,scrollX:s.scrollable.x}),s.fakeScroller&&s.refreshFakeScroll(),l.syncFlexedSubCols(),s.fixRowWidthsInSafariEdge()),i!==n&&l.onHeightChange(),s.trigger("afterInternalResize",s))}syncParallelSplitters(e){const t=this,{grid:i}=t;if(t.splitterElement&&t.$showingSplitter)t.toggleSplitterCls("b-grid-splitter-collapsed",e);else{const r=i.getSubGrid(i.getPreviousRegion(t.region));r&&r.splitterElement&&r.syncParallelSplitters(e)}}onSplitterMouseEnter(){const e=this,{nextSibling:t}=e;!e.collapsed&&(!t||!t.collapsed)&&e.toggleSplitterCls("b-hover"),e.startSplitterButtonSyncing()}onSplitterMouseLeave(){const e=this,{nextSibling:t}=e;e.toggleSplitterCls("b-hover",!1),!e.collapsed&&(!t||!t.collapsed)&&e.stopSplitterButtonSyncing()}startSplitterButtonSyncing(){const e=this;e.splitterElement&&(e.syncSplitterButtonPosition(),e.splitterSyncScrollListener||(e.splitterSyncScrollListener=e.grid.scrollable.ion({scroll:"syncSplitterButtonPosition",thisObj:e})))}stopSplitterButtonSyncing(){this.splitterSyncScrollListener&&(this.splitterSyncScrollListener(),this.splitterSyncScrollListener=null)}syncSplitterButtonPosition(){const{grid:e}=this;this.splitterButtons.style.top=`${e.scrollable.y+(e.bodyHeight-(this.headerSplitter?e.headerHeight:0))/2}px`}get viewRectangle(){const{scrollable:e}=this;return new O(e.x,e.y,this.width||0,this.rowManager.viewHeight)}updateHasFlex(){this.scrollable.element.classList.toggle("b-has-flex",this.columns.hasFlex)}updateResizable(e){this.splitterElements.forEach(t=>b.toggleClasses(t,["b-disabled"],!e))}resizeColumnsToFitContent(){this.grid.beginGridMeasuring(),this.columns.visibleColumns.forEach(e=>{e.resizeToFitContent(null,null,!0)}),this.grid.endGridMeasuring()}get overflowingHorizontally(){return!this.collapsed&&this.scrollable.hasOverflow("x")}get overflowingVertically(){return!1}refreshFakeScroll(){const e=this,{element:t,virtualScrollerElement:i,virtualScrollerWidth:r,header:n,footer:s,scrollable:l}=e,o=[...n.contentElement.children].reduce(sp,0);l.scrollWidth=o,i.style.width=t.style.width,i.style.flex=t.style.flex,i.style.minWidth=t.style.minWidth,i.style.maxWidth=t.style.maxWidth,n.scrollable.syncOverflowState(),s.scrollable.syncOverflowState(),e.collapsed||(e.overflowingHorizontally?(r.style.width=`${l.scrollWidth||0}px`,e.grid.virtualScrollers.classList.remove("b-hide-display")):r.style.width=0)}initScroll(){const e=this,{scrollable:t,virtualScrollerElement:i}=e;e.syncPartnersOnFrame=e.createOnFrame(e.syncScrollingPartners),W.isFirefox&&t.element.addEventListener("wheel",r=>{r.deltaX&&(t.x+=r.deltaX,r.preventDefault())}),t.yScroller=e.grid.scrollable,t.yScroller.addScroller(t),e.fakeScroller=new ot({element:i,overflowX:!0,widget:e}),t.ion({scroll:"onSubGridScroll",scrollend:"onSubGridScrollEnd",thisObj:e}),t.addPartner(e.fakeScroller,"x"),t.addPartner(e.header.scrollable,"x"),t.addPartner(e.footer.scrollable,"x"),e.refreshFakeScroll()}onSubGridScrollEnd(){const e=this;e.forceScrollUpdate||e.syncScrollingPartners(),e.scrolling=!1,b.scrollBarWidth||(e.grid.virtualScrollers.classList.remove("b-scrolling"),e.hideOverlayScroller())}onSubGridScroll(){this.forceScrollUpdate?(this.syncScrollingPartners(),this.forceScrollUpdate=!1):this.syncPartnersOnFrame()}showOverlayScroller(){this.hideOverlayScroller.cancel(),this.virtualScrollerElement.classList.add("b-show-virtual-scroller")}hideOverlayScroller(){this.virtualScrollerElement.classList.remove("b-show-virtual-scroller")}set scrolling(e){this._scrolling=e}get scrolling(){return this._scrolling}syncScrollingPartners(e=!0){const t=this,{grid:i}=t;!t.scrolling&&e&&(t.scrolling=!0,b.scrollBarWidth||(i.virtualScrollers.classList.add("b-scrolling"),t.showOverlayScroller())),i.trigger("horizontalScroll",{subGrid:t,grid:i,scrollLeft:t.scrollable.element.scrollLeft,scrollX:t.scrollable.x})}scrollColumnIntoView(e,t){const{columns:i,header:r}=this,n=r.scrollable;if(e=e instanceof se?e:i.get(e)||i.getById(e)||i.getAt(e),e){const s=r.getHeader(e.id);if(s)return n.scrollIntoView(O.from(s,null,!0),t)}}onAddRow({rows:e,isExport:t}){const i=this,r=i.rowElementConfig,n=document.createDocumentFragment();e.forEach(s=>{const l=b.createElement(r);n.appendChild(l),s.addElement(i.region,l),i.fixCellWidths(l)}),t||(i.fixRowWidthsInSafariEdge(),i.element.insertBefore(n,i.insertRowsBefore))}get rowElements(){return this.fromCache(".b-grid-row",!0)}clearRows(){this.emptyCache();const e=this.element.querySelectorAll(".b-grid-row"),t=document.createRange();e.length&&(t.setStartBefore(e[0]),t.setEndAfter(e[e.length-1]),t.deleteContents())}addNewRowElement(){const e=b.append(this.element,this.rowElementConfig);return this.fixCellWidths(e),e}get store(){return this.grid.store}get rowManager(){var e;return(e=this.grid)===null||e===void 0?void 0:e.rowManager}toggleTransitionClasses(e=!1){const t=this,i=t.grid,r=i.getSubGrid(i.getNextRegion(t.region)),n=i.resolveSplitter(r);r.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),r.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),n.classList[e?"remove":"add"]("b-grid-splitter-animate")}get collapsed(){return this._collapsed}set collapsed(e){this.isConfiguring?this._collapsed=e:e?this.collapse():this.expand()}async collapse(){const e=this,{grid:t,element:i}=e,r=t.getSubGrid(t.getNextRegion(e.region)),n=e.splitterElement?e:e.previousSibling;let{_beforeCollapseState:s}=e,l=0;if(!(t.rendered&&e._collapsed===!0))return t.eachSubGrid(o=>{o!==e&&!o._collapsed&&++l}),l===0&&await r.expand(),new Promise(o=>{if(s)o();else{s=e._beforeCollapseState={};let a=!1;e.width&&(a=!0,e.ion({afterinternalresize:()=>{o(e)},thisObj:e,once:!0})),s.width=e.width,s.elementWidth=i.style.width,r.element.style.flex===""&&(s.nextRegionWidth=r.width,r.width="",r.flex="1"),i.style.flex!==""&&(s.flex=i.style.flex,e.header.element.style.flex=i.style.flex=""),i.classList.add("b-grid-subgrid-collapsed"),e.virtualScrollerElement.classList.add("b-collapsed"),e.header.element.classList.add("b-collapsed"),e.footer.element.classList.add("b-collapsed"),e._collapsed=!0,e.width="",a||(e.syncParallelSplitters(!0),o(!1))}}).then(o=>{if(!e.isDestroyed){if(o!==!1){var a;t.refreshVirtualScrollbars(),e.syncParallelSplitters(!0),(a=n.startSplitterButtonSyncing)===null||a===void 0||a.call(n)}t.trigger("subGridCollapse",{subGrid:e}),t.afterToggleSubGrid({subGrid:e,collapsed:!0})}})}async expand(){const e=this,{grid:t,_beforeCollapseState:i}=e,r=t.getSubGrid(t.getNextRegion(e.region)),n=e.splitterElement?e:e.previousSibling;if(!(t.rendered&&e._collapsed!==!0))return new Promise(s=>{if(i!=null){let l=!1;e.width!==i.elementWidth&&(l=!0,e.ion({afterinternalresize(){e.setTimeout(()=>s(e),10)},thisObj:e,once:!0})),i.nextRegionWidth&&(r.width=i.nextRegionWidth,r.flex=null),e.element.classList.remove("b-grid-subgrid-collapsed"),e._collapsed=!1,e.virtualScrollerElement.classList.remove("b-collapsed"),e.header.element.classList.remove("b-collapsed"),e.footer.element.classList.remove("b-collapsed"),i.flex?(e.width=i.width,e.header.flex=e.flex=i.flex,e.footer.flex=i.flex,e._width=null):e.width=i.elementWidth,e.element.classList.remove("b-grid-subgrid-collapsed"),e._collapsed=!1,l?(n.stopSplitterButtonSyncing(),e.syncParallelSplitters(!1)):s(!1),delete e._beforeCollapseState}else s()}).then(s=>{s!==!1&&!e.isDestroyed&&(t.trigger("subGridExpand",{subGrid:e}),t.afterToggleSubGrid({subGrid:e,collapsed:!1}))})}}T(er,"delayable",{hideOverlayScroller:1e3});er.initClass();er._$name="SubGrid";var lp=u=>class extends(u||$){static get $name(){return"GridSubGrids"}static get properties(){return{subGrids:{}}}changeSubGridConfigs(t){const i=this,r=new Set;for(const n of i.columns){const{region:s}=n;s&&(t[s]||(t[s]={}),r.add(s))}t.normal&&x.isEmpty(t.normal)&&(t.normal=Mn.defaultConfig.subGridConfigs.normal);for(const n of r)i.createSubGrid(n,t[n]);return i.items=i.subGrids,t}createSubGrid(t,i=null){const r=this,n=r.columns.makeChained(a=>a.region===t,["region"]),s=x.assign({type:"subgrid",id:`${r.id}-${t}Subgrid`,parent:r,grid:r,region:t,headerClass:r.headerClass,footerClass:r.footerClass,columns:n,weight:t},i||r.subGridConfigs[t]);let l=!1;!s.flex&&!s.width&&(s.width=n.totalFixedWidth,l=!0);const o=r.subGrids[t]=er.create(s);return o.hasCalculatedWidth=l,t===r.regions[0]&&(o.isFirstRegion=!0),o}onChildAdd(t){if(t.isSubGrid){const i=this,{items:r,headerContainer:n,virtualScrollers:s,footerContainer:l}=i,o=r.indexOf(t)*2;i.hideHeaders||(b.insertAt(n,t.headerSplitter,o),b.insertAt(n,t.header.element,o)),b.insertAt(s,t.scrollerSplitter,o),b.insertAt(s,t.virtualScrollerElement,o),b.insertAt(l,t.footerSplitter,o),b.insertAt(l,t.footer.element,o),r.forEach((a,d)=>{d<r.length-1&&a.showSplitter()}),o===0&&i.emptyTextEl&&t.element.appendChild(i.emptyTextEl)}return super.onChildAdd(t)}onChildRemove(t){if(super.onChildRemove(t),t.isSubGrid){const{items:i}=this;delete this.subGrids[t.region],B.remove(this.regions,t.region),t.destroy(),i.length&&i[i.length-1].hideSplitter()}}doDestroy(){this.eachSubGrid(t=>t.destroy()),super.doDestroy()}eachSubGrid(t,i=null){this.items.forEach((r,n)=>{r.isSubGrid&&t.call(i||r,r,n++)})}callEachSubGrid(t,...i){let r=null;return this.items.forEach((n,s)=>{if(n.isSubGrid&&n[t]){const l=n[t](...i);s===0&&(r=l)}}),r}get regions(){return this.items.map(t=>t.region)}getLastRegions(){const t=this.regions.slice(-2);return t.length===2?t:[t[0],t[0]]}getNextRegion(t){const i=this.regions;return i[i.indexOf(t)+1]||i[i.length-2]}getPreviousRegion(t){return this.regions[this.regions.indexOf(t)-1]}getSubGrid(t){return this.subGrids[t]}getSubGridFromColumn(t){return t=t instanceof se?t:this.columns.getById(t)||this.columns.get(t),this.getSubGrid(t.region)}resolveSplitter(t){const i=this.getLastRegions();let r=t instanceof er?t.region:t;return i[1]===r&&(r=i[0]),this.subGrids[r].splitterElement}get widgetClass(){}};const op=new String,ap={localeName:"En",localeDesc:"English (US)",localeCode:"en-US",ColumnPicker:{column:"Column",columnsMenu:"Columns",hideColumn:"Hide column",hideColumnShort:"Hide",newColumns:"New columns"},Filter:{applyFilter:"Apply filter",filter:"Filter",editFilter:"Edit filter",on:"On",before:"Before",after:"After",equals:"Equals",lessThan:"Less than",moreThan:"More than",removeFilter:"Remove filter",disableFilter:"Disable filter"},FilterBar:{enableFilterBar:"Show filter bar",disableFilterBar:"Hide filter bar"},Group:{group:"Group",groupAscending:"Group ascending",groupDescending:"Group descending",groupAscendingShort:"Ascending",groupDescendingShort:"Descending",stopGrouping:"Stop grouping",stopGroupingShort:"Stop"},HeaderMenu:{moveBefore:u=>`Move before "${u}"`,moveAfter:u=>`Move after "${u}"`,collapseColumn:"Collapse column",expandColumn:"Expand column"},ColumnRename:{rename:"Rename"},MergeCells:{mergeCells:"Merge cells",menuTooltip:"Merge cells with same value when sorted by this column"},Search:{searchForValue:"Search for value"},Sort:{sort:"Sort",sortAscending:"Sort ascending",sortDescending:"Sort descending",multiSort:"Multi sort",removeSorter:"Remove sorter",addSortAscending:"Add ascending sorter",addSortDescending:"Add descending sorter",toggleSortAscending:"Change to ascending",toggleSortDescending:"Change to descending",sortAscendingShort:"Ascending",sortDescendingShort:"Descending",removeSorterShort:"Remove",addSortAscendingShort:"+ Ascending",addSortDescendingShort:"+ Descending"},Column:{columnLabel:u=>`${u.text?`${u.text} column. `:""}SPACE for context menu${u.sortable?", ENTER to sort":""}`,cellLabel:op},Checkbox:{toggleRowSelect:"Toggle row selection",toggleSelection:"Toggle selection of entire dataset"},RatingColumn:{cellLabel:u=>{var e;return`${u.text?u.text:""} ${(e=u.location)!==null&&e!==void 0&&e.record?`rating : ${u.location.record[u.field]||0}`:""}`}},GridBase:{loadFailedMessage:"Data loading failed!",syncFailedMessage:"Data synchronization failed!",unspecifiedFailure:"Unspecified failure",networkFailure:"Network error",parseFailure:"Failed to parse server response",serverResponse:"Server response:",noRows:"No records to display",moveColumnLeft:"Move to left section",moveColumnRight:"Move to right section",moveColumnTo:u=>`Move column to ${u}`},CellMenu:{removeRow:"Delete"},RowCopyPaste:{copyRecord:"Copy",cutRecord:"Cut",pasteRecord:"Paste",rows:"rows",row:"row"},CellCopyPaste:{copy:"Copy",cut:"Cut",paste:"Paste"},PdfExport:{"Waiting for response from server":"Waiting for response from server...","Export failed":"Export failed","Server error":"Server error","Generating pages":"Generating pages...","Click to abort":"Cancel"},ExportDialog:{width:"40em",labelWidth:"12em",exportSettings:"Export settings",export:"Export",exporterType:"Control pagination",cancel:"Cancel",fileFormat:"File format",rows:"Rows",alignRows:"Align rows",columns:"Columns",paperFormat:"Paper format",orientation:"Orientation",repeatHeader:"Repeat header"},ExportRowsCombo:{all:"All rows",visible:"Visible rows"},ExportOrientationCombo:{portrait:"Portrait",landscape:"Landscape"},SinglePageExporter:{singlepage:"Single page"},MultiPageExporter:{multipage:"Multiple pages",exportingPage:({currentPage:u,totalPages:e})=>`Exporting page ${u}/${e}`},MultiPageVerticalExporter:{multipagevertical:"Multiple pages (vertical)",exportingPage:({currentPage:u,totalPages:e})=>`Exporting page ${u}/${e}`},RowExpander:{loading:"Loading",expand:"Expand",collapse:"Collapse"}};Ie.publishLocale(ap);const Ua=new Promise(u=>u()),Es="GridBase:store",dp={block:"nearest",inline:"nearest"},cp={dataset:1,pageLoad:1,filter:1};class Mn extends Ke.mixin(ld,Bs,Wm,Gm,Km,Xm,Zm,rp,lp,am){static get $name(){return"GridBase"}static get type(){return"gridbase"}static get delayable(){return{onGridVerticalScroll:{type:"raf"},bufferedAfterColumnsResized:250,bufferedElementResize:250}}static get configurable(){return{autoHeight:null,enableSticky:null,enableTextSelection:null,fillLastColumn:!0,positionMode:"translate",showDirty:null,subGridConfigs:{normal:{flex:1}},store:{value:{},$config:"nullify"},rowManager:{value:{},$config:["nullify","lazy"]},scrollManager:{value:{},$config:["nullify","lazy"]},columns:{value:[],$config:"nullify"},minHeight:"10em",hideFooters:!0,contentElMutationObserver:!1,trapFocus:!1,ariaElement:"bodyElement",cellTabIndex:-1,rowCls:{value:"b-grid-row",$config:{merge:this.mergeCls}},cellCls:{value:"b-grid-cell",$config:{merge:this.mergeCls}},emptyText:"L{noRows}",sortFeatureStore:"store"}}static get defaultConfig(){return{rowHeight:null,fixedRowHeight:null,defaultRowHeight:45,fullRowRefresh:!0,hideHeaders:null,preserveScrollOnDatasetChange:null,preserveFocusOnDatasetChange:!0,data:null,defaultRegion:"normal",destroyStore:null,maskDefaults:{cover:"body",target:"element"},columnLines:!0,resizeToFitIncludesHeader:!0,animateRemovingRows:!0,disableGridRowModelWarning:null,headerClass:yl,footerClass:vl,testPerformance:!1,rowScrollMode:"move",monitorResize:!0,features:!0,scrollable:{overflowY:!0},scrollerClass:Mc,refreshSuspended:0,transitionDuration:500,contextMenuTriggerEvent:"contextmenu",localizableProperties:["emptyText"],asyncEventSuffix:"",testConfig:{transitionDuration:50}}}static get properties(){return{_selectedRecords:[],_verticalScrollHeight:0,virtualScrollHeight:0,_scrollTop:null}}finishConfigure(e){const t=this,{initScroll:i}=t;t.initScroll=()=>!t.scrollInitialized&&i.call(t),super.finishConfigure(e),Te.ion({locale:"onBeforeLocaleChange",prio:1,thisObj:t}),Te.ion({locale:"onLocaleChange",prio:-1,thisObj:t}),te.ion({theme:"onThemeChange",thisObj:t}),t.ion({subGridExpand:"onSubGridExpand",prio:-1,thisObj:t}),t.bufferedFixElementHeights=t.buffer("fixElementHeights",350,t),t.setGridClassList(t.element.classList)}onSubGridExpand(){this.renderContents()}onBeforeLocaleChange(){this._suspendRenderContentsOnColumnsChanged=!0}onLocaleChange(){this._suspendRenderContentsOnColumnsChanged=!1,this.isPainted&&this.renderContents()}finalizeInit(){super.finalizeInit(),this.store.isLoading&&this.onStoreBeforeRequest()}changeScrollManager(e,t){return t?.destroy(),e?Zs.new({element:this.element,owner:this},e):null}doDestroy(){var e;const t=this;t.detachListeners(Es),(e=t.scrollManager)===null||e===void 0||e.destroy();for(const r of Object.values(t.features)){var i;(i=r.destroy)===null||i===void 0||i.call(r)}t._focusedCell=null,t.columns.destroy(),super.doDestroy()}setGridClassList(e){Object.values(this.features).forEach(i=>{if(i.disabled)return;let r;Object.prototype.hasOwnProperty.call(i.constructor,"featureClass")?r=i.constructor.featureClass:r=`b-${i instanceof $?i.$$name:i.constructor.name}`,r&&e.add(r.toLowerCase())})}compose(){const{autoHeight:e,enableSticky:t,enableTextSelection:i,fillLastColumn:r,positionMode:n,showDirty:s}=this;return{class:{[`b-grid-${n}`]:1,"b-enable-sticky":t,"b-grid-notextselection":!i,"b-autoheight":e,"b-fill-last-column":r,"b-show-dirty":s}}}get cellCls(){const{_cellCls:e}=this;return e.value||e}get bodyConfig(){const{autoHeight:e,hideFooters:t,hideHeaders:i}=this;return{reference:"bodyElement",className:{"b-autoheight":e,"b-grid-panel-body":1},[this.hasHeader?"ariaLabelledBy":""]:`${this.id}-panel-title`,children:{headerContainer:{tag:"header",role:"row","aria-rowindex":1,className:{"b-grid-header-container":1,"b-hidden":i}},bodyContainer:{className:"b-grid-body-container",tabIndex:-1,role:"presentation",children:{verticalScroller:{className:"b-grid-vertical-scroller"}}},virtualScrollers:{className:"b-virtual-scrollers b-hide-display",style:W.isFirefox&&b.scrollBarWidth?{height:`${b.scrollBarWidth}px`}:void 0},footerContainer:{tag:"footer",className:{"b-grid-footer-container":1,"b-hidden":t}}}}}get contentElement(){return this.verticalScroller}get overflowElement(){return this.bodyContainer}updateHideFooters(e){var t;(t=this.footerContainer)===null||t===void 0||t.classList[e?"add":"remove"]("b-hidden")}changeColumns(e,t){const i=this;if(!e&&t)return i.isDestroying?t.owner===i&&t.destroy():t.removeAll(),t;if(e.isStore)return t?.owner===i&&t.destroy(),e.grid=i,e;if(Array.isArray(e)){if(t){i._suspendRenderContentsOnColumnsChanged=!0;const r=t.allRecords.filter(n=>!e.includes(n)&&n!==i.checkboxSelectionColumn);return t.remove(t.allRecords,!0),r.forEach(n=>{var s;return(s=n.destroy)===null||s===void 0?void 0:s.call(n)}),t.data=e,i._suspendRenderContentsOnColumnsChanged=!1,t}e={data:e}}if(t)throw new Error("Replacing ColumnStore is not supported");return Ce.new({grid:i,owner:i},e)}updateColumns(e,t){var i,r;const n=this;(i=super.updateColumns)===null||i===void 0||i.call(this,e,t),e.ion({refresh:n.onColumnsChanged,change:n.onColumnsChanged,sort:n.onColumnsChanged,thisObj:n}),e.ion(Om(n.onColumnsResized,n)),W.isTouchDevice&&(n.touch=!0,e.forEach(s=>{const{touchConfig:l}=s;l&&s.applyState(l)})),(r=n.bodyElement)===null||r===void 0||r.setAttribute("aria-colcount",e.visibleColumns.length)}onColumnsChanged({type:e,action:t,changes:i,record:r,records:n,isMove:s}){const l=i&&Object.keys(i).length===1;if(e==="refresh"&&t!=="batch"||t==="update"&&l&&"parentIndex"in i)return;const o=this,{columns:a,checkboxSelectionColumn:d}=o;if(!(!o.isPainted||s&&t==="remove")){if(t==="add")for(const c of n){const{region:h}=c;o.subGrids[h]||o.add(o.createSubGrid(h,o.subGridConfigs[h]))}if(t==="update"){if("width"in i||"minWidth"in i||"maxWidth"in i||"flex"in i){const c=r.region;a.visibleColumns.forEach(h=>{h.region===c&&h.repaintOnResize&&o.refreshColumn(h)}),o.afterColumnsChange({action:t,changes:i,column:r});return}if("text"in i&&l){r.subGrid.refreshHeader();return}if("hidden"in i){const c=o.getSubGridFromColumn(r.id);c.header.fixHeaderWidths(),c.footer.fixFooterWidths(),c.updateHasFlex()}}if(t==="dataset"||t==="batch"||t==="update"&&"region"in i){const c=a.getDistinctValues("region"),{toRemove:h,toAdd:g}=B.delta(c,o.regions,!0);o.remove(h.map(f=>o.getSubGrid(f))),o.add(g.map(f=>o.createSubGrid(f)))}if(d&&!a.includes(d)){const c=a.indexOf(a.findRecord("type","rownumber"))+1;a.insert(c,d,!0)}o._suspendRenderContentsOnColumnsChanged||o.renderContents(),o.syncFlexedSubCols(),o.bodyElement.setAttribute("aria-colcount",a.visibleColumns.length),o.afterColumnsChange({action:t,changes:i,column:r})}}onColumnsResized({changes:e,record:t}){const i=this;if(i.isConfiguring)return;const r=b.setLength(t.width),n=b.setLength(t.minWidth),s=b.setLength(t.maxWidth),l=i.getSubGridFromColumn(t.id);if(l.header.fixHeaderWidths(),l.footer.fixFooterWidths(),l.updateHasFlex(),!(t.flex&&t.childLevel)){(!i.cellEls||t!==i.lastColumnResized)&&(i.cellEls=b.children(i.element,`.b-grid-cell[data-column-id="${t.id}"]`),i.lastColumnResized=t);for(const a of i.cellEls)if("width"in e&&(a.style.width=r),"minWidth"in e&&(a.style.minWidth=n),"maxWidth"in e&&(a.style.maxWidth=s),"flex"in e){var o;a.style.flex=(o=t.flex)!==null&&o!==void 0?o:null}}i.resizingColumns||i.afterColumnsResized(t),i.syncFlexedSubCols()}afterColumnsResized(e){const t=this;t.eachSubGrid(i=>{!i.collapsed&&(!e||e.region===i.region)&&(i.fixWidths(),i.fixRowWidthsInSafariEdge())}),t.lastColumnResized=t.cellEls=null,t.bufferedAfterColumnsResized(e),t.onHeightChange()}syncFlexedSubCols(){const e=this.columns.query(t=>t.flex&&t.childLevel&&t.element);if(e)for(const t of e){const i=t.element.getBoundingClientRect().width,r=b.children(this.element,`.b-grid-cell[data-column-id="${t.id}"]`);for(const n of r)n.style.flex=`0 0 ${i}px`}}bufferedAfterColumnsResized(e){this.columns.usesAutoHeight&&this.refreshRows(),this.refreshVirtualScrollbars(),this.eachSubGrid(t=>{!t.collapsed&&(!e||e.region===t.region)&&t.refreshFakeScroll()})}bufferedElementResize(){this.refreshRows()}onInternalResize(e,t,i,r,n){b.scrollBarWidth&&t<r&&this.eachSubGrid(s=>{s.flex&&s.onElementResize(s.element)}),super.onInternalResize(...arguments),this.isPainted&&t!==r&&this.columns.usesFlexAutoHeight&&this.bufferedElementResize()}changeRowManager(e,t){const i=this;if(i._isRowMeasured||i.measureRowHeight(),t?.destroy(),e){const r=bl.new({grid:i,rowHeight:i.rowHeight,rowScrollMode:i.rowScrollMode||"move",autoHeight:i.autoHeight,fixedRowHeight:i.fixedRowHeight,internalListeners:{changeTotalHeight:"onRowManagerChangeTotalHeight",requestScrollChange:"onRowManagerRequestScrollChange",thisObj:i}},e);return i.relayEvents(r,["beforeRenderRow","renderRow"]),i._rowManager=null,r}}getRowHeight(e){return e.rowHeight}processRowHeight(e,t){}bindStore(e){const t=this.asyncEventSuffix;e.ion({name:Es,[`refresh${t}`]:"onStoreDataChange",[`add${t}`]:"onStoreAdd",[`remove${t}`]:"onStoreRemove",[`replace${t}`]:"onStoreReplace",[`removeAll${t}`]:"onStoreRemoveAll",[`move${t}`]:e.tree?null:"onFlatStoreMove",change:"relayStoreDataChange",idChange:"onStoreRecordIdChange",update:"onStoreUpdateRecord",beforeRequest:"onStoreBeforeRequest",afterRequest:"onStoreAfterRequest",exception:"onStoreException",commit:"onStoreCommit",thisObj:this}),super.bindStore(e)}unbindStore(e){this.detachListeners(Es),this.destroyStore&&e.destroy()}changeStore(e){if(e==null)return null;if(typeof e=="string"&&(e=ue.getStore(e)),!e.isStore){var t;e=x.assign({data:this.data,tree:Boolean((t=this.initialConfig.features)===null||t===void 0?void 0:t.tree)},e),e.data||delete e.data,e.modelClass||(e.modelClass=sn),e=new(e.readUrl?cn:ue)(e)}return e}updateStore(e,t){var i;const r=this;if((i=super.updateStore)===null||i===void 0||i.call(this,e,t),t&&r.unbindStore(t),e&&(t&&r.deselectAll(),r.bindStore(e)),r.trigger("bindStore",{store:e,oldStore:t}),!r.isDestroying&&r.isPainted&&!r.refreshSuspended){var n;(n=r._rowManager)===null||n===void 0||n.reinitialize()}}onStoreUpdateRecord({source:e,record:t,changes:i}){const r=this;if(!r.refreshSuspended)if(r.forceFullRefresh)r.rowManager.refresh(),r.forceFullRefresh=!1;else{let n;if(t.isFieldModified("id")&&(n=r.getRowFor(t.meta.modified.id)),n=n||r.getRowFor(t),!n)return;if(r.fullRowRefresh||t.isSpecialRow){const s=e.indexOf(t);s!==-1&&n.render(s,t)}else r.columns.visibleColumns.forEach(s=>{const l=s.field;if(!(s.constructor.simpleRenderer&&!Object.prototype.hasOwnProperty.call(s.data,"renderer"))||i[l]){const a=n.getCell(l);a&&n.renderCell(a)}})}}refreshFromRowOnStoreAdd(e,t){const i=this,{rowManager:r}=i;r.renderFromRow(e),r.trigger("changeTotalHeight",{totalHeight:r.totalHeight}),i.store.count===1&&i.callEachSubGrid("refreshFakeScroll")}onMaskAutoClose(e){super.onMaskAutoClose(e),this.toggleEmptyText()}onStoreAdd({source:e,records:t,index:i,oldIndex:r,isChild:n,oldParent:s,parent:l,isMove:o,isExpandAll:a}){if(!this.isPainted||a||this.refreshSuspended)return;const d=o&&t.some(w=>{if(o[w.id]){const S=e.getById(w.meta.modified.parentId);return S?.isExpanded(e)&&S?.ancestorsExpanded(e)}});if(n&&!t[0].ancestorsExpanded(e)&&!d){if(!l.isLeaf){const w=this.rowManager.getRowById(l);w&&this.rowManager.renderRows([w])}return}this.rowManager.calculateRowCount(!1,!0,!0),e.isFiltered&&(i=e.indexOf(t[0]));const c=this,{rowManager:h}=c,{topIndex:g,rows:f,rowCount:m}=h,p=h.topIndex+h.rowCount-1,v=i,y=i+t.length-1,C=p>=e.count-t.length-1;s||r>-1||n&&o?h.refresh():v>=g&&v<g+m?c.refreshFromRowOnStoreAdd(f[v-g],...arguments):y>=g&&y<g+m?h.refresh():(C&&i>p&&h.fillBelow(c._scrollTop||0),h.estimateTotalHeight(!0))}onStoreException({action:e,type:t,response:i,exceptionType:r,error:n}){var s;const l=this;let o;switch(t){case"server":o=i.message||l.L("L{unspecifiedFailure}");break;case"exception":o=r==="network"?l.L("L{networkFailure}"):n?.message||(i==null||(s=i.parsedJson)===null||s===void 0?void 0:s.message)||l.L("L{parseFailure}");break}l.applyMaskError(`<div class="b-grid-load-failure">
                <div class="b-grid-load-fail">${l.L(e==="read"?"L{loadFailedMessage}":"L{syncFailedMessage}")}</div>
                ${i!=null&&i.url?`<div class="b-grid-load-fail">${i.url}</div>`:""}
                <div class="b-grid-load-fail">${l.L("L{serverResponse}")}</div>
                <div class="b-grid-load-fail">${o}</div>
            </div>`)}onStoreDataChange({action:e,changes:t,source:i,syncInfo:r}){var n,s;if(this.refreshSuspended||!this.rowManager)return;const l=this,o=i.isGrouped&&t&&i.groupers.some(a=>a.field in t);(n=super.onStoreDataChange)===null||n===void 0||n.call(this,...arguments),e==="batch"&&r!==null&&r!==void 0&&(s=r.removed)!==null&&s!==void 0&&s.length?l.rowManager.renderFromRow(l.topRow):(e==="dataset"&&l.rowManager.clearKnownHeights(),l.isPainted&&!o&&l.renderRows(Boolean(!(e in cp)||l.preserveScrollOnDatasetChange))),l.toggleEmptyText()}onStoreRecordIdChange(){super.onStoreRecordIdChange&&super.onStoreRecordIdChange(...arguments)}onStoreBeforeRequest(){this.applyLoadMask()}onStoreAfterRequest(e){this.loadMask&&!e.exception&&(this.masked=null,this.toggleEmptyText())}needsFullRefreshOnStoreRemove({isCollapse:e}){const t=this._features;return t?.group&&!t.group.disabled||t?.groupSummary&&!t.groupSummary.disabled||this.store.tree&&!e&&this.store.modelClass.convertEmptyParentToLeaf}onStoreRemove({records:e,isCollapse:t,isChild:i,isMove:r,isCollapseAll:n}){if(!this.isPainted||r||n)return;super.onStoreRemove&&super.onStoreRemove(...arguments);const s=this,{rowManager:l}=s;if(l.invalidateKnownHeight(e),s.animateRemovingRows&&!t&&!i){const o=e.reduce((a,d)=>{const c=l.getRowById(d.id);return c&&a.push(c),a},[]);if(o.length){const a=o[0];s.isAnimating=!0,A.onTransitionEnd({element:a._elementsArray[0],property:"left",duration:s.transitionDuration,thisObj:s,handler:()=>{s.isAnimating=!1,o.forEach(d=>!d.isDestroyed&&d.removeCls("b-removing")),l.refresh(),s.trigger("rowRemove"),s.afterRemove(arguments[0])}}),o.forEach(d=>d.addCls("b-removing"));return}}if(s.needsFullRefreshOnStoreRemove(...arguments))l.refresh(),s.afterRemove(arguments[0]);else{const o=l.topIndex;if(l.calculateRowCount(!1,!0,!0),l.topIndex!==o)l.renderFromRow(l.topRow);else{const{rows:a}=l,d=e.reduce((c,h)=>{const g=l.getRowById(h.id);return g&&(c=Math.min(c,a.indexOf(g))),c},a.length);a[d]?!s.refreshSuspended&&l.renderFromRow(a[d]):l.trigger("changeTotalHeight",{totalHeight:l.totalHeight})}s.trigger("rowRemove",{isCollapse:t}),s.afterRemove(arguments[0])}}onFlatStoreMove({from:e,to:t}){const{rowManager:i}=this,{topIndex:r,rowCount:n}=i,[s,l]=[e,t].sort((o,a)=>o-a);s>=r&&s<r+n?i.renderFromRow(i.rows[s-r]):l>=r&&l<r+n&&i.refresh()}onStoreReplace({records:e,all:t}){const{rowManager:i}=this;if(t)i.clearKnownHeights(),i.refresh();else{const r=e.reduce((n,[,s])=>{const l=this.getRowFor(s);return l&&n.push(l),n},[]);i.invalidateKnownHeight(e),i.renderRows(r)}}relayStoreDataChange(e){if(this.ariaElement.setAttribute("aria-rowcount",this.store.count+1),!this.project)return this.trigger("dataChange",F(F({},e),{},{store:e.source,source:this}))}onStoreRemoveAll(){super.onStoreRemoveAll&&super.onStoreRemoveAll(...arguments),this.isPainted&&(this.rowManager.clearKnownHeights(),this.renderRows(!1),this.toggleEmptyText())}onStoreCommit({changes:e}){if(this.showDirty&&e.modified.length){const t=[];e.modified.forEach(i=>{const r=this.rowManager.getRowFor(i);r&&t.push(r)}),this.rowManager.renderRows(t)}}get data(){return this._store?this._store.records:this._data}set data(e){this._store?this._store.data=e:this._data=e}populateHeaderMenu({column:e,items:t}){const i=this,{subGrids:r,regions:n}=i,{parent:s}=e;let l=!0;Object.entries(r).forEach(([o,a])=>{if(!a.sealedColumns&&e.draggable&&o!==e.region&&(!s&&r[e.region].columns.count>1||s&&s.children.length>1)){const d=a.element.compareDocumentPosition(r[e.region].element)===document.DOCUMENT_POSITION_PRECEDING,c=i.rtl?!d:d,h=n.length>2?i.L("L{moveColumnTo}",i.optionalL(o)):i.L(c?"L{moveColumnRight}":"L{moveColumnLeft}");t[`${o}Region`]={targetSubGrid:o,text:h,icon:"b-fw-icon b-icon-column-move-"+(c?"right":"left"),separator:l,onItem:({item:g})=>{e.traverse(f=>f.region=o),i.columns.insert(i.columns.indexOf(r[g.targetSubGrid].columns.last)+1,e),i.scrollColumnIntoView(e)}},l=!1}})}populateCellMenu({record:e,items:t}){}getColumnDragToolbarItems(e,t){return t}normalizeCellContext(e){const t=this,{columns:i}=t;return e.isLocation?e:e.isModel?new K({grid:t,id:e.id,columnId:i.visibleColumns[0].id}):new K(x.assign({grid:t},e))}getCell(e){const{store:t,columns:i}=this,{visibleColumns:r}=this.columns,n=isNaN(e.row)?isNaN(e.rowIndex)?t.indexOf(e.record||e.id):e.rowIndex:e.row,s=isNaN(e.column)?isNaN(e.columnIndex)?r.indexOf(e.column||i.getById(e.columnId)||i.get(e.field)||r[0]):e.columnIndex:e.column;return n>-1&&n<t.count&&s>-1&&s<r.length&&this.normalizeCellContext(e).cell||null}getHeaderElement(e){return e.isModel&&(e=e.id),this.fromCache(`.b-grid-header[data-column-id="${e}"]`)}getHeaderElementByField(e){const t=this.columns.get(e);return t?this.getHeaderElement(t):null}get bodyHeight(){return this._bodyHeight}get headerHeight(){const e=this;return e.isPainted&&!e._headerHeight&&(e._headerHeight=e.headerContainer.offsetHeight),e._headerHeight}get footerHeight(){const e=this;return e.isPainted&&!e._footerHeight&&(e._footerHeight=e.footerContainer.offsetHeight),e._footerHeight}get isTreeGrouped(){var e;return Boolean((e=this.features.treeGroup)===null||e===void 0?void 0:e.isGrouped)}getRecordFromElement(e){const t=e.closest(".b-grid-row");return t?this.store.getAt(t.dataset.index):null}getColumnFromElement(e){const t=e.closest(".b-grid-cell, .b-grid-header");if(!t)return null;if(t.matches(".b-grid-header"))return this.columns.getById(t.dataset.columnId);const i=Ae.get(t);return this.columns.getById(i.columnId)}updateAutoHeight(e){x.assertBoolean(e,"autoHeight")}get columnLines(){return this._columnLines}set columnLines(e){x.assertBoolean(e,"columnLines"),b.toggleClasses(this.element,"b-no-column-lines",!e),this._columnLines=e}get keyMapElement(){return this.bodyElement}fixSizes(){this.callEachSubGrid("fixWidths");const e=this.headerContainer.querySelectorAll(".b-grid-header.b-depth-0");for(let t=0,{length:i}=e;t<i;t++)e[t].setAttribute("aria-colindex",t+1)}onRowManagerChangeTotalHeight({totalHeight:e,immediate:t}){return this.refreshTotalHeight(e,t)}refreshTotalHeight(e=this.rowManager.totalHeight,t=!1){const i=this;if(i.renderingRows||!i.isVisible)return!1;const r=i.scrollable,n=Math.abs(i.virtualScrollHeight-e),s=i._bodyRectangle.height,l=e-s;if(n){const o=l-i._scrollTop<s*2||i._verticalScrollHeight&&i._verticalScrollHeight-s<i._scrollTop;r.scrollHeight=i.virtualScrollHeight=e,i.isPainted&&(i.scrolling&&!o||n<100)&&!t?i.bufferedFixElementHeights():(i.virtualScrollHeightDirty&&i.virtualScrollHeightDirty(),i.bufferedFixElementHeights.cancel(),i.fixElementHeights())}}fixElementHeights(){const e=this,t=e.virtualScrollHeight,i=`${t}px`;e._verticalScrollHeight=t,e.verticalScroller.style.height=i,e.virtualScrollHeightDirty=!1,e.autoHeight&&(e.bodyContainer.style.height=i,e._bodyHeight=t,e.refreshBodyRectangle()),e.refreshVirtualScrollbars()}refreshBodyRectangle(){return this._bodyRectangle=O.client(this.bodyContainer)}set scrolling(e){this._scrolling=e}get scrolling(){return this._scrolling}enableScrollingCloseToEdges(e){this.scrollManager.startMonitoring({scrollables:[{element:this.scrollable.element,direction:"vertical"},...B.asArray(e||[]).map(t=>({element:(typeof t=="string"?this.subGrids[t]:t).scrollable.element}))],direction:"horizontal"})}disableScrollingCloseToEdges(e){this.scrollManager.stopMonitoring([this.scrollable.element,...B.asArray(e||[]).map(t=>(typeof t=="string"?this.subGrids[t]:t).element)])}onRowManagerRequestScrollChange({bottom:e}){this.scrollable.y=e-this.bodyHeight}initScroll(){const e=this,{scrollable:t}=e;e.scrollInitialized||(e.scrollInitialized=!0,t.contentElement=e.contentElement,t.ion({scroll:"onGridVerticalScroll",scrollend:"onGridVerticalScrollEnd",thisObj:e}),e.callEachSubGrid("initScroll"),W.isMobileSafari&&(t.element.style.transform="translate3d(0, 0, 0)"))}onGridVerticalScroll({source:e}){const t=this,{y:i}=e;i!==t._scrollTop&&(t._scrollTop=i,t.scrolling||(t.scrolling=!0,t.eachSubGrid(r=>r.suspendResizeMonitor=!0)),t.rowManager.updateRenderedRows(i),t.afterScroll({scrollTop:i}),t.trigger("scroll",{scrollTop:i}))}onGridVerticalScrollEnd(){this.scrolling=!1,this.eachSubGrid(e=>e.suspendResizeMonitor=!1)}async scrollRowIntoView(e,t=dp){const i=this,r=t.block||"nearest",{rowManager:n}=i,s=i.store.getById(e);if(s){let o;if(i.store.indexOf(s)===-1)return Ua;let a=i.scrollable,d=i.getRecordCoords(s);const c=O.from(a.element);if(d.virtual){const h=d.block,g=r!=="nearest"?t:{block:h};if(o=a.scrollIntoView(d,{block:"center"}),n.scrollTargetRecordId=s,n.updateRenderedRows(a.y,!0),d=i.getRecordCoords(s),n.lastScrollTop=a.y,d.virtual)return Ua;if(t.animate)a.suspendEvents(),r==="end"||r==="nearest"&&h==="end"?a.y-=c.bottom-d.bottom:(r==="start"||r==="nearest"&&h==="start")&&(a.y+=d.y-c.y),n.updateRenderedRows(a.y,!1,!0),h==="end"?a.y-=n.appendRowBuffer*n.rowHeight-1:a.y+=n.prependRowBuffer*n.rowHeight-1,a.scrollIntoView(i.getRecordCoords(s),Object.assign({},t,g)),a.resumeEvents();else{var l;t.recursive||await o,await((l=i.scrollRowIntoView)===null||l===void 0?void 0:l.call(i,s,Object.assign({recursive:!0},t,g)))}}else{let{column:h}=t;if(h){if(h.isModel||(h=i.columns.getById(h)||i.columns.get(h)),h){a=i.getSubGridFromColumn(h).scrollable;const g=O.from(n.getRowFor(s).getCell(h.id));d.x=g.x,d.width=g.width}}else t.x=!1;return a.scrollIntoView(d,t)}}}scrollColumnIntoView(e,t){return e=e instanceof se?e:this.columns.get(e)||this.columns.getById(e)||this.columns.getAt(e),this.getSubGridFromColumn(e).scrollColumnIntoView(e,t)}scrollCellIntoView(e,t){return this.scrollRowIntoView(e.id,Object.assign({column:e.columnId},typeof t=="boolean"?{animate:t}:t))}scrollToBottom(e){return this.scrollRowIntoView(this.store.last,e)}scrollToTop(e){return this.scrollable.scrollBy(0,-this.scrollable.y,e)}storeScroll(){const e=this,t=e.storedScrollState={scrollTop:e.scrollable.y,scrollLeft:{}};return e.eachSubGrid(i=>{t.scrollLeft[i.region]=i.scrollable.x}),t}restoreScroll(e=this.storedScrollState){const t=this;t.eachSubGrid(i=>{const r=e.scrollLeft[i.region];if(r!=null){var n;i.scrollable.updateX(r),i.header.scrollable.updateX(r),i.footer.scrollable.updateX(r),(n=i.fakeScroller)===null||n===void 0||n.updateX(r)}}),t.scrollable.updateY(e.scrollTop)}beginGridMeasuring(){const e=this;if(e.$measureCellElements||(e.$measureCellElements=b.createElement({className:"b-grid-subgrid "+(!e._isRowMeasured&&e.hasFeature("stripe")?"b-stripe":""),reference:"subGridElement",style:{position:"absolute",top:"-10000px",left:"-100000px",visibility:"hidden",contain:"strict"},children:[{className:"b-grid-row",reference:"rowElement",children:[{className:"b-grid-cell",reference:"cellElement",style:{width:"auto",contain:W.isFirefox?"layout paint":"layout style paint"}}]}]})),e.getConfig("element"),e.verticalScroller.appendChild(e.$measureCellElements.subGridElement),!e.rendered){const t=e.appendTo||e.insertBefore||document.body,i=b.getRootElement(typeof t=="string"?document.getElementById(t):t);(!e.adopt||!i.contains(e.element))&&(i.appendChild(e.element),e.$removeAfterMeasuring=!0)}return e.$measureCellElements}endGridMeasuring(){this.$removeAfterMeasuring&&(this.element.remove(),this.$removeAfterMeasuring=!1),this.$measureCellElements.subGridElement.remove()}measureRowHeight(){const e=this,{rowElement:t}=e.beginGridMeasuring(),i=b.getStyleValue(t,["height","border-top-width","border-bottom-width"]),r=parseInt(i.height),n=W.isFirefox?globalThis.devicePixelRatio/Math.max(Math.trunc(globalThis.devicePixelRatio),1):1,s=i["border-top-width"]?Math.round(n*parseFloat(i["border-top-width"])):0,l=i["border-bottom-width"]?Math.round(n*parseFloat(i["border-bottom-width"])):0;(e.rowHeight==null||e.rowHeight===e._rowHeightFromStyle)&&(e.rowHeight=!isNaN(r)&&r?r:e.defaultRowHeight,e._rowHeightFromStyle=e.rowHeight),e._rowBorderHeight=s+l,e._isRowMeasured=!0,e.endGridMeasuring()}onThemeChange({theme:e}){this.whenVisible("measureRowHeight"),this.trigger("theme",{theme:e})}refreshRows(e=!1){const{element:t,rowManager:i}=this;t.classList.add("b-notransition"),e?i.returnToTop():i.refresh(),t.classList.remove("b-notransition")}refreshColumn(e){e.isVisible&&(e.isLeaf?this.rowManager.forEach(t=>t.renderCell(t.getCell(e.id))):e.children.forEach(t=>this.refreshColumn(t)))}refreshVirtualScrollbars(){const e=this,{headerContainer:t,footerContainer:i,virtualScrollers:r,scrollable:n,hasVerticalOverflow:s}=e,{classList:l}=r,o=!l.contains("b-hide-display"),a=Object.values(e.subGrids).some(c=>c.overflowingHorizontally),d=a!==o;if(d&&r.classList.toggle("b-hide-display",!a),b.scrollBarWidth){const c=s||n.overflowY==="scroll";t.classList.toggle("b-show-yscroll-padding",c),i.classList.toggle("b-show-yscroll-padding",c),r.classList.toggle("b-show-yscroll-padding",c),d&&(a&&e.callEachSubGrid("refreshFakeScroll"),e.onHeightChange())}}get hasVerticalOverflow(){return this.scrollable.hasOverflow("y")}get contentHeight(){const e=this.rowManager;return Math.max(e.totalHeight,e.bottomRow?e.bottomRow.bottom:0)}onContentChange(){const e=this,t=e.rowManager;e.isVisible?(t.estimateTotalHeight(),e.paintListener=null,e.refreshTotalHeight(e.contentHeight),e.callEachSubGrid("refreshFakeScroll"),e.onHeightChange()):e.paintListener||(e.paintListener=e.ion({paint:"onContentChange",once:!0,thisObj:e}))}triggerPaint(){this.isPainted||this.refreshBodyRectangle(),super.triggerPaint()}onHeightChange(){const e=this;e.refreshBodyRectangle(),e._bodyHeight=e.autoHeight?e.contentHeight:e.bodyContainer.offsetHeight}suspendRefresh(){this.refreshSuspended++}resumeRefresh(e){this.refreshSuspended&&!--this.refreshSuspended&&(e&&this.refreshRows(),this.trigger("resumeRefresh",{trigger:e}))}renderRows(e=!0){const t=this,i=e&&t.storeScroll();t.refreshSuspended||(t.trigger("beforeRenderRows"),t.renderingRows=!0,t.element.classList.add("b-grid-refreshing"),e||(t.scrollable.y=t._scrollTop=0),t.rowManager.reinitialize(!e),t.trigger("renderRows"),t.renderingRows=!1,t.onContentChange(),e&&t.restoreScroll(i),t.element.classList.remove("b-grid-refreshing"))}renderContents(){const e=this,{element:t,headerContainer:i,footerContainer:r,rowManager:n}=e;if(e.emptyCache(),e.isPainted){e._headerHeight=null,e.callEachSubGrid("refreshHeader",i),e.callEachSubGrid("refreshFooter",r),e.renderHeader(i,t),e.renderFooter(r,t),e.fixSizes();const s=n.removeAllRows();n.calculateRowCount(!1,!0,!0),n.rowCount&&(n.setPosition(s),e.renderRows())}}onPaintOverride(){}onPaint({firstPaint:e}){var t;const i=this;if(i.ariaElement.setAttribute("aria-rowcount",i.store.count+1),(t=super.onPaint)===null||t===void 0||t.call(this,...arguments),i.onPaintOverride()||!e)return;const{rowManager:r,store:n,element:s,headerContainer:l,bodyContainer:o,footerContainer:a}=i,d=b.scrollBarPadElement;let c,h=0;i.role=n!=null&&n.isTree?"treegrid":"grid",i.columns.ion({change:()=>c=!0,once:!0}),i.updateResponsive(i.width,0),c&&(i.callEachSubGrid("refreshHeader",l),i.callEachSubGrid("refreshFooter",a)),i.renderHeader(l,s),i.renderFooter(a,s),b.append(l,d),b.append(a,d),b.append(i.virtualScrollers,d),i.refreshBodyRectangle();const g=i.bodyContainer.offsetHeight;if(i.autoHeight?(i._bodyHeight=r.initWithHeight(s.offsetHeight-l.offsetHeight-a.offsetHeight,!0),o.style.height=i.bodyHeight+"px"):(i._bodyHeight=g,r.initWithHeight(i._bodyHeight,!0)),i.eachSubGrid(f=>{f.header.maxDepth>h&&(h=f.header.maxDepth)}),l.dataset.maxDepth=h,i.fixSizes(),(n.count||!n.isLoading)&&i.renderRows(),i.columns.usesAutoHeight){const{fonts:f}=document;f?.status!=="loaded"&&f.ready.then(()=>!i.isDestroyed&&i.refreshRows())}i.initScroll(),i.initInternalEvents()}render(){const e=this;e.requireSize=Boolean(e.owner),super.render(...arguments),e.autoHeight||(e.headerContainer.offsetHeight&&!e.bodyContainer.offsetHeight&&console.warn("Grid element not sized correctly, please check your CSS styles and review how you size the widget"),!("minHeight"in e.initialConfig)&&!("height"in e.initialConfig)&&parseInt(globalThis.getComputedStyle(e.element).minHeight)===e.height&&console.warn(`The ${e.$$name} is sized by its predefined minHeight, likely this is not intended. Please check your CSS and review how you size the widget, or assign a fixed height in the config. For more information, see the "Basics/Sizing the component" guide in docs.`))}renderHeader(e,t){}renderFooter(e,t){}beforeRenderCell(){}beforeRenderRow(){}afterRenderRow(){}afterScroll(){}processCellEditor(e){}afterColumnsChange(){}afterRemove(e){}afterToggleGroup(){}afterToggleSubGrid(){}syncMaskCover(e=this.masked){if(e){const t=e.cover==="body"&&this.rectangleOf("bodyContainer"),i=t&&this.rectangleOf("virtualScrollers"),{style:r}=e.element;r.marginTop=t?`${t.y}px`:"",r.height=t?`${t.height+(i?.height||0)}px`:""}}maskBody(e){let t;return this.bodyContainer&&(this.masked=Pe.mergeConfigs(this.loadMaskDefaults,e),t=this.masked),t}unmaskBody(){this.masked=null}updateEmptyText(e){var t,i;(t=this.emptyTextEl)===null||t===void 0||t.remove(),this.emptyTextEl=b.createElement({parent:(i=this.firstItem)===null||i===void 0?void 0:i.element,className:"b-empty-text",[e!=null&&e.includes("<")?"html":"text"]:e})}toggleEmptyText(){const{bodyContainer:e,store:t}=this;e?.classList.toggle("b-grid-empty",!(t.count>0||t.isLoading||t.isCommitting))}updateReadOnly(e,t){if(super.updateReadOnly(e,t),!this.isConfiguring)for(const r of this.columns.bottomColumns){var i;(i=r.updateReadOnly)===null||i===void 0||i.call(r,e)}}getCurrentConfig(e){const t=super.getCurrentConfig(e),{store:i}=this,r=i.getInlineData(e),n=i.getCurrentConfig(e)||t.store;return r.length&&(t.data=r),n&&i.originalModelClass===sn&&delete n.modelClass,x.isEmpty(n)||(t.store=n),t.store&&delete t.store.data,t}}Mn.initClass();re.setVersion("grid","5.3.0");Mn._$name="GridBase";class Cl extends Mn{static get $name(){return"Grid"}static get type(){return"grid"}}Cl.initClass();Cl._$name="Grid";class Fc extends Cl{static get $name(){return"TreeGrid"}static get type(){return"treegrid"}static get configurable(){return{store:{tree:!0}}}updateStore(e,t){if(e&&!e.tree)throw new Error("TreeGrid requires a Store configured with tree : true");super.updateStore(e,t)}}Fc.initClass();Fc._$name="TreeGrid";class br extends kt{configure(e){super.configure(e);const t=this;t.ion({change(){t.picker.selectedRecords=t.value}})}changePicker(e,t){const i=this;return super.changePicker(x.assign({},e,{type:"treegrid",minWidth:"35em",readOnly:i.readOnly,disableGridRowModelWarning:!0,selectedRecords:i.value.map(r=>i.store.getById(r)),selectionMode:{row:!0,multiSelect:i.multiSelect,rowCheckboxSelection:!0},internalListeners:{selectionChange({selection:r}){i.value=r}}}),t)}}T(br,"$name","TreeCombo");T(br,"type","treecombo");T(br,"configurable",{multiSelect:!0,chipView:{itemTpl(u){return _.xss`${u.name}`},scrollable:{overflowX:"hidden-scroll"}}});br.initClass();br._$name="TreeCombo";export{Ys as B,Ce as C,E as D,At as F,Cl as G,vt as L,Pe as M,gi as P,O as R,ue as S,me as T,lr as W,_ as a,k as b,ot as c,Zs as d,ui as e,fe as f,K as g,sn as h,ze as i,li as j};
