import{d as te,l as oe,cp as O,dd as le,s as E,bO as ne,j as t,y as se,at as re,a1 as A,e as ue,aW as ie,r as u,o as de,c as ce,g as o,w as s,a as i,I as b,aX as D,A as fe,u as pe,a2 as me,aY as ve,ax as _e,ay as ye,_ as be}from"./index.611fe570.js";import{u as he}from"./timeOffPlanStore.16eb3c13.js";import{D as ge}from"./darkThemeModal.c38e7d4c.js";import{F as Ve}from"./FormField.7af7663e.js";import{u as R}from"./onboardingStore.b8199798.js";const q=p=>(_e("data-v-b9a26b03"),p=p(),ye(),p),we={key:0,ref:"container"},Ce={class:"py-3 header d-flex justify-content-between align-items-center"},Te=q(()=>i("div",{class:"hq-pg__title"},"Vacation Plan",-1)),Fe={class:"button-group"},Ie={class:"d-flex"},Se=q(()=>i("h5",null,[b(" Are you sure you want to leave this page? "),i("br"),b(" You have unsaved changes, your data will be lost. ")],-1)),Me=te({__name:"onboardingVacation",setup(p){oe.add(O,le);const w=he(),{vacationPlanName:B,vacationType:U,dataOnboardingVacation:Y}=E(w),{fetchVacationList:$,getListVacationPlan:ke,fetchFormPayrollInformation:j,updateOnboardingVacation:z}=w,{setLoading:m}=ne(),C=R(),{onboardingSideNavItem:T}=E(R()),l=t({}),F=t({}),d=t(),I=t(new Array),v=t(new Array),S=t(null),M=t(!0),_=t(!1),h=se(),r=t(!1),k=t(""),g=t(!1),V=t(!1),y=h.currentRoute.value.params.id,x=t(null),L=t(null),X=!0,G=re(),K=async()=>{await $(G.params.id,X),I.value=U.value.map(e=>({id:e.id,name:e.name})),v.value=B.value.map(e=>({id:e.id,name:e.planName,planTypeId:e.planTypeId})),S.value=v.value,await j(Number(y),Ve.Vacation),d.value=Y.value,W(),r.value=!1},W=()=>{const e=d.value.fieldModels.reduce((a,{fieldKey:n,fieldValue:c})=>(c!==void 0&&(a[n]=c),a),{});l.value=e,F.value={...l.value}},H=()=>{const e=d.value.fieldModels.map(a=>{const n=l.value[a.fieldKey]||"";return{...a,fieldValue:n}});d.value.fieldModels=e},N=async e=>{const{valid:a}=await x.value.validate();!a||(m(!0),await H(),await z(Number(y),d.value),await C.markOnboardingSidenavItemAsDone(L.value.progressSidebarId,!0,Number(y)),r.value=!1,e&&h.push({name:"onboardingEmploymentInformation"}),m(!1))};A(()=>l.value.planType,async e=>{e!==null&&(v.value=S.value.filter(a=>a.planTypeId===e.id),M.value=!1)},{deep:!0}),A(()=>l.value,()=>{V.value&&(ve.exports.isEqual(l.value,F.value)?r.value=!1:r.value=!0)},{deep:!0}),ue(async()=>{m(!0),await K(),T.value.length==0&&await C.getOnboardingSideNavItems(Number(y)),L.value=T.value.find(e=>e.progressSidebarUrl.trim().toLowerCase()==="onboardingVacation".trim().toLocaleLowerCase()),V.value=!0,m(!1)}),ie((e,a,n)=>{if(r.value)return _.value=!0,k.value=e.fullPath,g.value?(n(),!0):(n(!1),!1);n()});const J=()=>{_.value=!1,g.value=!0,h.push(k.value)},Q=()=>{_.value=!1,g.value=!1};return(e,a)=>{const n=u("font-awesome-icon"),c=u("fs-button"),P=u("fs-col"),Z=u("fs-row"),ee=u("VeeForm"),ae=u("fs-container");return V.value?(de(),ce("div",we,[o(ae,{fluid:"",class:"overflow-auto px-4",style:{paddingBottom:"100px"}},{default:s(()=>[i("div",Ce,[Te,i("div",Fe,[o(c,{disabled:!r.value,onClick:a[0]||(a[0]=f=>N(!1)),variant:"outline-info",form:"form",type:"submit"},{default:s(()=>[o(n,{class:"mr-8",icon:["fal","floppy-disk"]}),b("SAVE")]),_:1},8,["disabled"]),o(c,{disabled:!r.value,onClick:a[1]||(a[1]=f=>N(!0)),variant:"info",form:"form",type:"submit"},{default:s(()=>[b(" SAVE & NEXT")]),_:1},8,["disabled"])])]),o(ee,{ref_key:"formVacation",ref:x},{default:s(()=>[o(Z,null,{default:s(()=>[o(P,null,{default:s(()=>[o(D,{type:"fsMultiselectList",label:"Plan Type",modelValue:l.value.planType,"onUpdate:modelValue":a[2]||(a[2]=f=>l.value.planType=f),typeaheaddata:I.value,typeaheadkey:"name",typeaheadvalueattribute:"id",name:"Plan Type",showClear:!0,rules:{required:!0},required:!0},null,8,["modelValue","typeaheaddata"])]),_:1}),o(P,null,{default:s(()=>[o(D,{modelValue:l.value.plan,"onUpdate:modelValue":a[3]||(a[3]=f=>l.value.plan=f),label:"Plan",type:"fsMultiselectList",typeaheadkey:"name",rules:"required",typeaheadvalueattribute:"id",name:"Plan",showClear:!0,typeaheaddata:v.value,disabled:M.value,required:!0},null,8,["modelValue","typeaheaddata","disabled"])]),_:1})]),_:1})]),_:1},512),o(ge,{ref:"leaveDialog",showModal:_.value,title:"Unsaved Changes",okText:"YES, LEAVE",okTextVariant:"danger",cancelText:"stay",cancelBtnVariant:"light",onClose:Q,onOk:J},{content:s(()=>[i("span",Ie,[o(n,{class:fe(["me-2","text-danger"]),icon:pe(O),size:"lg"},null,8,["icon"]),Se])]),_:1},8,["showModal"])]),_:1})],512)):me("",!0)}}});const Ee=be(Me,[["__scopeId","data-v-b9a26b03"]]);export{Ee as default};
