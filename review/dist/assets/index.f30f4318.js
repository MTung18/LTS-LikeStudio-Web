import{d as D,l as V,af as L,a_ as z,cf as G,j as h,a1 as B,r as g,o as p,f as O,w as d,a as l,D as S,g as i,u as _,C as F,bm as I,I as k,c as w,A as P,B as E,a2 as T,z as H,F as J,_ as M,bx as q,s as R,aU as U,Q as W,e as Q,a3 as Y}from"./index.611fe570.js";import{B as K}from"./bryntumSearchBar.3bdd630f.js";import{S as X,i as Z,T as ee}from"./grid.module.3b00878a.js";import{B as te}from"./BryntumGrid.2c4be387.js";import{f as $}from"./gridConfigDefaults.8c72c19b.js";import{u as ae}from"./categoryStore.0bb8b876.js";import"./foundationCompanyCasConnectionStore.b3301598.js";import"./debounce.cf77a06e.js";import"./isObject.c4ad145e.js";const oe={class:"d-flex justify-content-between py-1"},se={class:"select-color"},re={class:"label",for:"title"},ne={class:"grid"},le=["onClick"],ie={class:"p-3 d-flex justify-content-between"},ce=D({__name:"addOrEdit",props:{isOpen:{type:Boolean},type:null,category:null,error:null},emits:["save","close"],setup(b,{emit:s}){const r=b;V.add(L,z,G);const t=h(null),f=["#425AFB","#0376F2","#039BB1","#12CBC4","#27CA37","#C43D97","#A03AFF","#D980FA","#F63057","#FF5094","#FF6600","#F79F1F"],o=h({categoryName:"",categoryColor:"#425AFB"});function x(){s("save",o.value)}B(()=>r.category,y=>{r.type==="edit"?o.value=JSON.parse(JSON.stringify(y)):v()},{deep:!0}),B(()=>r.error,y=>{y&&t.value.setFieldError("Category Name",r.error)});function v(){o.value.categoryColor="#425AFB",t.value.resetForm()}function u(){r.type==="add"&&v(),o.value=JSON.parse(JSON.stringify(r.category)),s("close")}return(y,c)=>{const C=g("fs-link"),A=g("fs-input"),e=g("VeeForm"),a=g("fs-button"),n=g("fs-sidebar");return p(),O(n,{visible:b.isOpen,id:"publishPostForm-right",class:"publishPostForm",right:"","sidebar-class":"fsi-sidebar help-center","body-class":"help-center__body","no-close-on-esc":"","no-close-on-backdrop":"","bg-variant":"white",width:"392px",shadow:"","header-class":"border-bottom","footer-class":"border-top","no-header-close":""},{title:d(()=>[l("div",oe,[l("span",null,S(b.type==="add"?"Add":"Edit")+" Category",1),i(C,{class:"text-secondary",tag:"a",onClick:c[0]||(c[0]=I(N=>u(),["prevent"]))},{default:d(()=>[i(_(F),{icon:["fal","times"],size:"sm"})]),_:1})])]),footer:d(()=>[l("div",ie,[i(a,{type:"button",variant:"outline-secondary",onClick:c[2]||(c[2]=N=>u())},{default:d(()=>[k(" CANCEL ")]),_:1}),i(a,{variant:"info",type:"submit",form:"form"},{default:d(()=>[k(" SAVE ")]),_:1})])]),default:d(()=>[l("div",null,[i(e,{onSubmit:x,ref_key:"form",ref:t,class:"form",id:"form"},{default:d(({errors:N})=>[i(A,{required:!0,type:"fsTextInput",label:"Category name",maxlength:200,modelValue:o.value.categoryName,"onUpdate:modelValue":c[1]||(c[1]=m=>o.value.categoryName=m),name:"Category Name",rules:"required|max:255"},null,8,["modelValue"]),o.value.categoryName?(p(),w("div",{key:0,class:P(["category mt-1",{"mt-3":N["Category Name"]}]),style:E({"background-color":o.value.categoryColor})},S(o.value.categoryName),7)):T("",!0),l("div",se,[l("label",re,[k("Select a Color "),i(_(F),{class:"text-danger ms-1",icon:["fas","asterisk"]})]),l("div",ne,[(p(),w(J,null,H(f,(m,j)=>l("div",{class:"item",key:j,style:E({"background-color":m}),onClick:fe=>o.value.categoryColor=m},[o.value.categoryColor===m?(p(),O(_(F),{key:0,class:"text-white",icon:["fal","check"],size:"lg"})):T("",!0)],12,le)),64))])])]),_:1},512)])]),_:1},8,["visible"])}}});const de=M(ce,[["__scopeId","data-v-19042340"]]),ue={id:"bulletin-board-settings",class:"hq-pg list"},ye={class:"list__table"},Ae=D({__name:"index",setup(b){V.add(q);const s=ae(),{categoryList:r}=R(s),t=U({isOpen:!1,type:"add",category:{categoryName:"",categoryColor:"#424987"},error:""}),{notifySuccess:f}=W(),o=e=>`<div class="category" style="background-color:${e.categoryColor};">${e.categoryName}</div>`,x=e=>{const a=["General","Announcement","Event","Holiday"];let n="";return(e.isActive||a.includes(e.categoryName))&&(n="disabled-btn"),c(),`<div class="b-action-item b-fa b-fa-trash-alt btn-delete deleteBulletinBtn ms-2 ${n}">
    </div>`},v=h({...$.gridConfig,minHeight:"80vh",emptyText:"",columns:[{flex:8,text:"Category",id:"category",field:"categoryName",htmlEncode:!1,renderer:({record:e})=>`${o(e.data)}`},{flex:2,text:"Actions",type:"action",cellCls:"b-action-cell--hover",actions:[{renderer:({action:e,record:a})=>`
                <div class="b-action-item b-fa b-fa-edit btn-edit updateBulletinBtn btn-link"></div>`,onClick:({record:e})=>C("edit",e.data)},{renderer:({action:e,record:a})=>x(a.data),onClick:({record:e})=>y(e)}]}]}),u=h(new X({...$.gridStoreConfig}));Q(async()=>{await s.fetchCategories(),u.value.data=r.value});function y(e){const a=["General","Announcement","Event","Holiday"];if(e.data.isActive||a.includes(e.data.categoryName))return;t.category.categoryName=e.data.categoryName;const n=new Z({header:"Delete Category",autoShow:!1,centered:!0,closeAction:"destroy",closable:!0,autoClose:!1,width:"500px",cls:"popup-delete",modal:!0,bbar:{items:{cancel:{text:"CANCEL",minWidth:100,onAction:()=>{n.close()}},delete:{text:"DELETE",minWidth:100,cls:"b-raised b-red",onAction:async()=>{await s.deleteCategory(e.data.postCategoryId),f("Category deleted."),await s.fetchCategories(),u.value={data:r.value},n.close()}}}},html:`<i class="b-fa b-fa-exclamation-circle icon-exclamation-circle"></i>
                    <div class="item-text">
                      <p>Are you sure you want to delete the <b>${t.category.categoryName}</b> category?</p>
                    </div>`});n.show()}function c(e){new ee({forSelector:".disabled-btn",html:"Cannot delete. There are posts under this category.",hideDelay:0,bodyCls:{"tooltip-category":1}})}function C(e="add",a=null){t.isOpen=!0,t.type=e,e=="edit"?t.category=a:t.category={categoryName:"",categoryColor:"#425AFB"}}async function A(e){if(t.error="",t.type==="add"){const a=await s.createCategory(e);a.status===400?t.error=a.detail:(f("Category added."),t.isOpen=!1)}else if(t.type==="edit"){const a=await s.editCategory(e);a.status===400?t.error=a.detail:(f("Category edited."),t.isOpen=!1)}await s.fetchCategories(),u.value={data:r.value}}return(e,a)=>(p(),w("div",ue,[l("div",ye,[i(K,{title:"Category Management"},{buttons:d(()=>[l("button",{onClick:a[0]||(a[0]=n=>C("add")),class:"btn btn-add"}," ADD CATEGORY ")]),_:1}),i(_(te),Y(v.value,{store:u.value,ref:"grid"}),null,16,["store"]),i(de,{error:t.error,type:t.type,isOpen:t.isOpen,category:t.category,onSave:A,onClose:a[1]||(a[1]=n=>{t.isOpen=!1,t.error=""})},null,8,["error","type","isOpen","category"])])]))}});export{Ae as default};
